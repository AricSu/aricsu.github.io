---
title: Google OAuth (Workspace)
description: Extension login and serverless domain enforcement
---

## Extension login

`tihc` uses `chrome.identity.launchWebAuthFlow`.

The sidepanel shows:

- `Redirect: https://<EXTENSION_ID>.chromiumapp.org/oauth2`

Add it to your Google Cloud Console OAuth Client “Authorized redirect URIs”.

## Serverless enforcement

`tihc-serverless` env vars:

- `GOOGLE_CLIENT_ID`
- `GOOGLE_WORKSPACE_DOMAIN` (e.g. `pingcap.com`)
- `REQUIRE_AUTH=true` (optional)

Validation flow:

- Each request sends `Authorization: Bearer <token>`
- Serverless calls Google `tokeninfo` to validate the token
- Validate `aud` matches `GOOGLE_CLIENT_ID` (if configured)
- Validate `hd` or `email@domain` matches `GOOGLE_WORKSPACE_DOMAIN`
