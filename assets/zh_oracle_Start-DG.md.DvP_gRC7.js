import{_ as a,c as n,j as s,a5 as l,o as p}from"./chunks/framework.PytyN_aB.js";const g=JSON.parse('{"title":"Start--11g物理DG部署","description":"","frontmatter":{"sidebar_position":203,"title":"Start--11g物理DG部署"},"headers":[],"relativePath":"zh/oracle/Start-DG.md","filePath":"zh/oracle/Start-DG.md"}'),h={name:"zh/oracle/Start-DG.md"};function k(t,i,e,F,r,d){return p(),n("div",null,i[0]||(i[0]=[s("blockquote",null,[s("p",null,[s("a",{href:"https://www.bilibili.com/video/BV1Ep4y197JA?from=search&seid=17237800447886927935&spm_id_from=333.337.0.0",target:"_blank",rel:"noreferrer"},"DBNEST -- Bilibili DataGuard 基础搭建视频地址"),s("br"),s("a",{href:"./Oracle11gRAC%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA%E6%89%8B%E5%86%8C.pdf"},"DBNEST -- 旧版文档 “点击” 直接浏览或下载 PDF")])],-1),s("iframe",{src:"//player.bilibili.com/player.html?aid=968019810&bvid=BV1Ep4y197JA&cid=187553574&page=1",scrolling:"no",border:"0",frameborder:"no",framespacing:"0",allowfullscreen:"true",height:"560",width:"780"},null,-1),l(`<h2 id="一、安装前提" tabindex="-1">一、安装前提 <a class="header-anchor" href="#一、安装前提" aria-label="Permalink to &quot;一、安装前提&quot;">​</a></h2><h3 id="_1-1-物理dg参数" tabindex="-1">1.1 物理DG参数 <a class="header-anchor" href="#_1-1-物理dg参数" aria-label="Permalink to &quot;1.1 物理DG参数&quot;">​</a></h3><table tabindex="0"><thead><tr><th>HOSTNAME</th><th>IP</th><th>DB_NAME</th><th>DB_UNIQUE_NAME</th><th>INSTANCE_NAME</th><th>SERVICE_NAME</th><th>TNSNAME</th></tr></thead><tbody><tr><td>dg1</td><td>192.168.169.220</td><td>prod</td><td>uni_dg1</td><td>prod</td><td>dg1</td><td>uni_dg1</td></tr><tr><td>dg2</td><td>192.168.169.221</td><td>prod</td><td>uni_dg2</td><td>Prod_stdby</td><td>dg2</td><td>uni_dg2</td></tr></tbody></table><h3 id="_1-2-文件物理路径" tabindex="-1">1.2 文件物理路径 <a class="header-anchor" href="#_1-2-文件物理路径" aria-label="Permalink to &quot;1.2 文件物理路径&quot;">​</a></h3><table tabindex="0"><thead><tr><th>datafile</th><th>controlfile</th><th>logfile</th><th>archivelog</th><th>auditfile</th></tr></thead><tbody><tr><td>/u01/oradata/prod</td><td>/u01/oradata/prod /u01/fast_recovery_area/prod</td><td>/u01/oradata/prod</td><td>/u01/arch</td><td>/u01/admin/prod/adump</td></tr><tr><td>/u01/oradata/prod_stdby</td><td>/u01/oradata/prod_stdby /u01/fast_recovery_area/prod</td><td>/u01/oradata/prod_stdby</td><td>/u01/arch</td><td>/u01/admin/prod_stdby/adump</td></tr></tbody></table><h2 id="二、服务器配置修改" tabindex="-1">二、服务器配置修改 <a class="header-anchor" href="#二、服务器配置修改" aria-label="Permalink to &quot;二、服务器配置修改&quot;">​</a></h2><h3 id="_2-1-配置网络" tabindex="-1">2.1 配置网络 <a class="header-anchor" href="#_2-1-配置网络" aria-label="Permalink to &quot;2.1 配置网络&quot;">​</a></h3><p>主库dg1:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@dg1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]# vi /etc/hosts</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@dg1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]# scp /etc/hosts dg2:/etc/</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">The</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> authenticity</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> host</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;dg2 (192.168.169.201)&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> can&#39;t be established.</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">RSA key fingerprint is 26:5c:d2:36:66:2b:e2:b3:12:0d:c4:fb:a6:44:97:7b.</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Are you sure you want to continue connecting (yes/no)? yes</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Warning: Permanently added &#39;dg2,192.168.169.201&#39; (RSA) to the list of known hosts.</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">root@dg2&#39;s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> password:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 123456</span></span></code></pre></div><h3 id="_2-2-修改备库实例名" tabindex="-1">2.2 修改备库实例名 <a class="header-anchor" href="#_2-2-修改备库实例名" aria-label="Permalink to &quot;2.2 修改备库实例名&quot;">​</a></h3><p>备库dg2:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@dg2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]# cat /etc/hosts</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">127.0.0.1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   localhost</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> localhost.localdomain</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> localhost4</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> localhost4.localdomain4</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">192.168.169.200</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dg1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">192.168.169.201</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dg2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@dg2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]# su - oracle</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[oracle@dg2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]$ vi .bash_profile </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[oracle@dg2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]$ source .bash_profile </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[oracle@dg2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]$ env </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> SID</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ORACLE_SID</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">prod_stdby</span></span></code></pre></div><h3 id="_2-3-建立备库目录" tabindex="-1">2.3 建立备库目录 <a class="header-anchor" href="#_2-3-建立备库目录" aria-label="Permalink to &quot;2.3 建立备库目录&quot;">​</a></h3><p>备库dg2:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[oracle@dg2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]$ mkdir -p /u01/oradata/prod_stdby</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[oracle@dg2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]$ mkdir -p /u01/arch</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[oracle@dg2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]$ mkdir -p /u01/fast_recovery_area/prod_stdby/</span></span></code></pre></div><h2 id="三、建立物理dg" tabindex="-1">三、建立物理DG <a class="header-anchor" href="#三、建立物理dg" aria-label="Permalink to &quot;三、建立物理DG&quot;">​</a></h2><h3 id="_3-1-主库强制记录日志" tabindex="-1">3.1 主库强制记录日志 <a class="header-anchor" href="#_3-1-主库强制记录日志" aria-label="Permalink to &quot;3.1 主库强制记录日志&quot;">​</a></h3><p>主库dg1:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[oracle@dg1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]$ sqlplus / as sysdba</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">select</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> log_mode,force_logging</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> v</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$database;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">LOG_MODE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     FOR</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">------------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   ---</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NOARCHIVELOG</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> NO</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">alter</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> database</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> force</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> logging</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">select</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> log_mode,force_logging</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> v</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$database;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">LOG_MODE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     FOR</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">------------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   ---</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NOARCHIVELOG</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> YES</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">shutdown</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> immediate</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">startup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mount</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">alter</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> database</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> archivelog</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">alter</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> database</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> open</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">select</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> log_mode,force_logging</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> v</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$database;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">LOG_MODE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     FOR</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">------------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   ---</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ARCHIVELOG</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    YES</span></span></code></pre></div><h3 id="_3-2-配置主备监听" tabindex="-1">3.2 配置主备监听 <a class="header-anchor" href="#_3-2-配置主备监听" aria-label="Permalink to &quot;3.2 配置主备监听&quot;">​</a></h3><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[oracle@dg1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]$ cd /u01/oracle/network/admin/</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[oracle@dg1 admin]$ vi tnsnames.ora </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                    </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">uni_dg1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> =</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">DESCRIPTION</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> =</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ADDRESS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (PROTOCOL </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> TCP</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">HOST</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dg1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">PORT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1521</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">CONNECT_DATA</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> =</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SERVER</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEDICATED</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SERVICE_NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> uni_dg1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    )</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  )</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">uni_dg2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> =</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">DESCRIPTION</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> =</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ADDRESS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (PROTOCOL </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> TCP</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">HOST</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dg2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">PORT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1521</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">CONNECT_DATA</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> =</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SERVER</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEDICATED</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SERVICE_NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> uni_dg2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    )</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  )</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[oracle@dg1 admin]$ scp ./tnsnames.ora dg2:/u01/oracle/network/admin/</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">The</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> authenticity</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> host</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;dg2 (192.168.169.221)&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> can&#39;t be established.</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">RSA key fingerprint is 26:5c:d2:36:66:2b:e2:b3:12:0d:c4:fb:a6:44:97:7b.</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Are you sure you want to continue connecting (yes/no)? yes</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Warning: Permanently added &#39;dg2,192.168.169.221&#39; (RSA) to the list of known hosts.</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">oracle@dg2&#39;s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> password:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Permission</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> denied,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> please</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> try</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> again.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">oracle@dg2</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&#39;s password: </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Permission denied, please try again.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">oracle@dg2&#39;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> password:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tnsnames.ora</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[oracle@dg2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]$ cd /u01/oracle/network/admin/</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[oracle@dg2 admin]$ cat tnsnames.ora</span></span></code></pre></div><h3 id="_3-3-配置主库信息" tabindex="-1">3.3 配置主库信息 <a class="header-anchor" href="#_3-3-配置主库信息" aria-label="Permalink to &quot;3.3 配置主库信息&quot;">​</a></h3><p>主库dg1:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>SQL&gt; create pfile=&#39;/home/oracle/dg1_spfile&#39; from spfile;</span></span>
<span class="line"><span>SQL&gt; exit</span></span>
<span class="line"><span>[oracle@dg1 ~]$ vi dg1_spfile </span></span>
<span class="line"><span>DB_UNIQUE_NAME=uni_dg1 LOG_ARCHIVE_CONFIG=&#39;DG_CONFIG=(uni_dg1,uni_dg2)&#39;</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>LOG_ARCHIVE_DEST_1=&#39;LOCATION=/u01/arch/ VALID_FOR=(ALL_LOGFILES,ALL_ROLES) DB_UNIQUE_NAME=uni_dg1&#39;</span></span>
<span class="line"><span>LOG_ARCHIVE_DEST_2=&#39;SERVICE=uni_dg2 ASYNC VALID_FOR=(ONLINE_LOGFILES,PRIMARY_ROLE) DB_UNIQUE_NAME=uni_dg2&#39;</span></span>
<span class="line"><span>LOG_ARCHIVE_DEST_STATE_1=ENABLE</span></span>
<span class="line"><span>LOG_ARCHIVE_DEST_STATE_2=ENABLE</span></span>
<span class="line"><span></span></span>
<span class="line"><span>FAL_SERVER=uni_dg2</span></span>
<span class="line"><span>DB_FILE_NAME_CONVERT=&#39;/u01/oradata/prod_stdby&#39;,&#39;/u01/oradata/prod&#39;</span></span>
<span class="line"><span>LOG_FILE_NAME_CONVERT=&#39;/u01/oradata/prod_stdby&#39;,&#39;/u01/oradata/prod&#39;</span></span>
<span class="line"><span>STANDBY_FILE_MANAGEMENT=AUTO</span></span>
<span class="line"><span>[oracle@dg1 ~]$ cd /u01/</span></span>
<span class="line"><span>[oracle@dg1 u01]$ mkdir arch</span></span>
<span class="line"><span>[oracle@dg1 u01]$ ll  |grep arch</span></span>
<span class="line"><span>drwxr-xr-x  2 oracle oinstall 4096 Apr 22 18:19 arch</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[oracle@dg1 u01]$ sqlplus / as sysdba</span></span>
<span class="line"><span>SQL&gt; shutdown immediate</span></span>
<span class="line"><span>[oracle@dg1 u01]$ sqlplus / as sysdba</span></span>
<span class="line"><span>SQL&gt; startup force nomount pfile=/home/oracle/dg1_spfile</span></span>
<span class="line"><span>ORACLE instance started.</span></span>
<span class="line"><span>Total System Global Area  521936896 bytes</span></span>
<span class="line"><span>SQL&gt; show parameter name</span></span>
<span class="line"><span></span></span>
<span class="line"><span>NAME         TYPE                             VALUE</span></span>
<span class="line"><span>-------------------------   -------------------------------    ---------------------------------------</span></span>
<span class="line"><span>cell_offloadgroup_name   string</span></span>
<span class="line"><span>db_file_name_convert        string                        /u01/oradata/prod_stdby, /u01/oradata/prod</span></span>
<span class="line"><span>db_name           string     prod</span></span>
<span class="line"><span>db_unique_name    string     uni_dg1</span></span>
<span class="line"><span>global_names          boolean    FALSE</span></span>
<span class="line"><span>instance_name          string     prod</span></span>
<span class="line"><span>lock_name_space          string</span></span>
<span class="line"><span>log_file_name_convert         string     /u01/oradata/prod_stdby, /u01/oradata/prod</span></span>
<span class="line"><span>processor_group_name   string</span></span>
<span class="line"><span>service_names          string     uni_dg1</span></span>
<span class="line"><span>SQL&gt; create spfile from pfile=&#39;/home/oracle/dg1_spfile&#39;;</span></span>
<span class="line"><span>SQL&gt; startup force</span></span>
<span class="line"><span>Database opened.</span></span>
<span class="line"><span>SQL&gt; show parameter name</span></span>
<span class="line"><span></span></span>
<span class="line"><span>NAME         TYPE  VALUE</span></span>
<span class="line"><span>------------------------------------ ----------- ------------------------------</span></span>
<span class="line"><span>cell_offloadgroup_name       string</span></span>
<span class="line"><span>db_file_name_convert       string  /u01/oradata/prod_stdby, /u01/oradata/prod</span></span>
<span class="line"><span>db_name         string  prod</span></span>
<span class="line"><span>db_unique_name       string  uni_dg1</span></span>
<span class="line"><span>global_names        boolean  FALSE</span></span>
<span class="line"><span>instance_name        string  prod</span></span>
<span class="line"><span>lock_name_space        string</span></span>
<span class="line"><span>log_file_name_convert       string  /u01/oradata/prod_stdby, /u01/oradata/prod</span></span>
<span class="line"><span>processor_group_name      string</span></span>
<span class="line"><span>service_names        string  uni_dg1</span></span>
<span class="line"><span>SQL&gt; alter database create standby controlfile as &#39;/home/oracle/stdby_ctrl_file.bak&#39;;</span></span>
<span class="line"><span>Database altered.</span></span>
<span class="line"><span>SQL&gt; exit</span></span>
<span class="line"><span>Disconnected from Oracle Database 11g Enterprise Edition Release 11.2.0.4.0 - 64bit Production</span></span>
<span class="line"><span>With the Partitioning, OLAP, Data Mining and Real Application Testing options</span></span>
<span class="line"><span>[oracle@dg1 u01]$ cd</span></span>
<span class="line"><span>[oracle@dg1 ~]$ ll |grep ctrl</span></span>
<span class="line"><span>-rw-r----- 1 oracle oinstall 9748480 Apr 22 18:34 stdby_ctrl_file.bak</span></span>
<span class="line"><span>[oracle@dg1 ~]$ cd /u01/oradata/prod/</span></span>
<span class="line"><span>[oracle@dg1 prod]$ ll</span></span>
<span class="line"><span>total 3531072</span></span>
<span class="line"><span>-rw-r----- 1 oracle oinstall    9748480 Apr 22 18:36 control01.ctl</span></span>
<span class="line"><span>-rw-r----- 1 oracle oinstall  363077632 Apr 22 18:32 example01.dbf</span></span>
<span class="line"><span>-rw-r----- 1 oracle oinstall   52429312 Apr 22 18:36 redo01.log</span></span>
<span class="line"><span>-rw-r----- 1 oracle oinstall   52429312 Apr 22 18:32 redo02.log</span></span>
<span class="line"><span>-rw-r----- 1 oracle oinstall   52429312 Apr 22 18:32 redo03.log</span></span>
<span class="line"><span>-rw-r----- 1 oracle oinstall  702554112 Apr 22 18:32 sysaux01.dbf</span></span>
<span class="line"><span>-rw-r----- 1 oracle oinstall  796925952 Apr 22 18:32 system01.dbf</span></span>
<span class="line"><span>-rw-r----- 1 oracle oinstall   38805504 Apr 22 18:32 temp01.dbf</span></span>
<span class="line"><span>-rw-r----- 1 oracle oinstall 1428103168 Apr 22 18:32 test01.dbf</span></span>
<span class="line"><span>-rw-r----- 1 oracle oinstall  110108672 Apr 22 18:32 undotbs01.dbf</span></span>
<span class="line"><span>-rw-r----- 1 oracle oinstall    9183232 Apr 22 18:32 users01.dbf</span></span>
<span class="line"><span>[oracle@dg1 prod]$ scp * dg2:/u01/oradata/prod_stdby/</span></span>
<span class="line"><span>[oracle@dg1 dbs]$  scp orapwprod /u01/oracle/dbs/orapwprod_stdby </span></span>
<span class="line"><span>[oracle@dg1 dbs]$  scp orapwprod oracle@dg2:/u01/oracle/dbs/orapwprod_stdby</span></span></code></pre></div><p>备库dg2：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[oracle@dg2 prod_stdby]$ cd /u01/oradata/prod_stdby/</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[oracle@dg2 prod_stdby]$ ll </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> control</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-rw-r-----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> oinstall</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    9748480</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Apr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 22</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 18:39</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> control01.ctl</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[oracle@dg2 prod_stdby]$ rm control01.ctl</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[oracle@dg2 prod_stdby]$ cd /u01/fast_recovery_area/prod/ PROD/ </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[oracle@dg2 prod_stdby]$ cd /u01/fast_recovery_area/prod/</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[oracle@dg2 prod]$ ll</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">total</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 9520</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-rw-r-----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> oinstall</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 9748480</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Apr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 22</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 17:30</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> control02.ctl</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[oracle@dg2 prod]$ rm control02.ctl</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[oracle@dg1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]$ sqlplus / as sysdba</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">shutdown</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> immediate</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ORACLE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> instance</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> shut</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> down.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[oracle@dg1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]$ scp stdby_ctrl_file.bak dg2:/u01/oradata/prod_stdby/control01.ctl</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[oracle@dg1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]$ cd /u01/oradata/prod/ </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[oracle@dg1 prod]$ scp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dg2:/u01/oradata/prod_stdby/</span></span></code></pre></div><p>备库dg2:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[oracle@dg2 prod_stdby]$ ll</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">total</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3521564</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-rw-r--r--</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> oinstall</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">       1168</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Apr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 22</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 18:44</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> control01.ctl</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-rw-r--r--</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> oinstall</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">       1168</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Apr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 22</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 18:44</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dg1_spfile</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-rw-r-----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> oinstall</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  363077632</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Apr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 22</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 18:39</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> example01.dbf</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-rw-r-----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> oinstall</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   52429312</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Apr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 22</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 18:39</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> redo01.log</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-rw-r-----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> oinstall</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   52429312</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Apr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 22</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 18:39</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> redo02.log</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-rw-r-----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> oinstall</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   52429312</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Apr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 22</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 18:39</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> redo03.log</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-rw-r-----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> oinstall</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  702554112</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Apr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 22</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 18:39</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sysaux01.dbf</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-rw-r-----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> oinstall</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  796925952</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Apr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 22</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 18:39</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> system01.dbf</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-rw-r-----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> oinstall</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   38805504</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Apr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 22</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 18:39</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> temp01.dbf</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-rw-r-----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> oinstall</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1428103168</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Apr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 22</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 18:40</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> test01.dbf</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-rw-r-----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> oinstall</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  110108672</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Apr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 22</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 18:40</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> undotbs01.dbf</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-rw-r-----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> oinstall</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    9183232</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Apr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 22</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 18:40</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> users01.d</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[oracle@dg1 prod]$ cd</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[oracle@dg1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]$ scp stdby_ctrl_file.bak dg2:/u01/oradata/prod_stdby/control01.ctl</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">oracle@dg2</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&#39;s password: </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">stdby_ctrl_file.bak                           100% 9520KB   9.3MB/s   00:00</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">[oracle@dg1 ~]$ scp stdby_ctrl_file.bak dg2:/u01/fast_recovery_area/prod_stdby/control02.ctl</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">oracle@dg2&#39;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> password:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">stdby_ctrl_file.bak</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                                   100%</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 9520KB</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   9.3MB/s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   00:00</span></span></code></pre></div><h3 id="_3-4-配置备库信息" tabindex="-1">3.4 配置备库信息 <a class="header-anchor" href="#_3-4-配置备库信息" aria-label="Permalink to &quot;3.4 配置备库信息&quot;">​</a></h3><p>备库dg2:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[oracle@dg2 dbs]$ cd</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[oracle@dg2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]$ vi .bash_profile </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[oracle@dg2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]$ env </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> SID</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ORACLE_SID</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">prod_stdby</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[oracle@dg2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]$ cd $ORACLE_HOME/dbs</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[oracle@dg2 dbs]$ ll</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">total</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 24</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-rw-rw----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> oinstall</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1544</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Apr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 22</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 17:38</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> hc_prod.dat</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-rw-r--r--</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> oinstall</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2851</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> May</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 15</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  2009</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> init.ora</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-rw-r--r--</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> oinstall</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  896</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Apr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 16</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 22:31</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> initprod.ora</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-rw-r-----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> oinstall</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   24</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Mar</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  8</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 08:50</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> lkPROD</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-rw-r-----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> oinstall</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1536</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Mar</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  8</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 08:53</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> orapwprod</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-rw-r-----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> oinstall</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2560</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Apr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 22</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 17:30</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> spfileprod.ora</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[oracle@dg2 dbs]$ cp initprod.ora initprod_stdby.ora </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[oracle@dg2 dbs]$ vi initprod_stdby.ora</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.db_recovery_file_dest</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/u01/fast_recovery_area&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.db_recovery_file_dest_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">4385144832</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.diagnostic_dest</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/u01&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.dispatchers</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;(PROTOCOL=TCP) (SERVICE=prodXDB)&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.memory_target</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">511705088</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.nls_language</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;SIMPLIFIED CHINESE&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.nls_territory</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;CHINA&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.open_cursors</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">300</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.processes</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">150</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.remote_login_passwordfile</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;EXCLUSIVE&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.undo_tablespace</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;UNDOTBS1&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">DB_UNIQUE_NAME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">uni_dg2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">LOG_ARCHIVE_CONFIG</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;DG_CONFIG=(uni_dg1,uni_dg2)&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">LOG_ARCHIVE_DEST_1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> &#39;LOCATION=/u01/arch/</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  VALID_FOR=(ALL_LOGFILES,ALL_ROLES)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  DB_UNIQUE_NAME=uni_dg2&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">LOG_ARCHIVE_DEST_2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> &#39;SERVICE=uni_dg1 ASYNC</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  VALID_FOR=(ONLINE_LOGFILES,PRIMARY_ROLE)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  DB_UNIQUE_NAME=uni_dg1&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">LOG_ARCHIVE_DEST_STATE_1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">ENABLE</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">LOG_ARCHIVE_DEST_STATE_2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">ENABLE</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">FAL_SERVER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">uni_dg1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">DB_FILE_NAME_CONVERT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/u01/oradata/prod&#39;,&#39;/u01/oradata/prod_stdby&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">LOG_FILE_NAME_CONVERT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/u01/oradata/prod&#39;,&#39;/u01/oradata/prod_stdby&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">STANDBY_FILE_MANAGEMENT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">AUTO</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">alter</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> system</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> log_archive_dest_1=&#39;LOCATION=/u01/ora_arch VALID_FOR=(ALL_LOGFILES,ALL_ROLES) DB_UNIQUE_NAME=primary&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> scope=both</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> db_unique_name=primary</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[oracle@dg2 prod_stdby]$ cd /u01/</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[oracle@dg2 u01]$ ll </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ^d</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> arch</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">drwxr-xr-x</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> oinstall</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 4096</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Apr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 22</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 19:03</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> arch</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[oracle@dg2 u01]$ sqlplus / as sysdba</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">startup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> force</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nomount</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pfile=/u01/oracle/dbs/initprod_stdby.ora</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ORACLE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> instance</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> started.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Total</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> System</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Global</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Area</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  509411328</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bytes</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Fixed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Size</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      2254704</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bytes</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Variable</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Size</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    377489552</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bytes</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Database</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Buffers</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   121634816</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bytes</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Redo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Buffers</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      8032256</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bytes</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">create</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> spfile</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pfile</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">File</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> created.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">startup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> force</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mount</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ORACLE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> instance</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> st</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> SQ</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">L</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> arted.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Total</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> System</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Global</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Area</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  509411328</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bytes</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Fixed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Size</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      2254704</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bytes</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Variable</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Size</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    377489552</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bytes</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Database</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Buffers</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   121634816</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bytes</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Redo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Buffers</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      8032256</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bytes</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Database</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mounted.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">startup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> force</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">alter</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> database</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> open</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;   </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">recover</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> managed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> standby</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> database</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> disconnect</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> session</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><h3 id="_3-4-测试日志切换" tabindex="-1">3.4 测试日志切换 <a class="header-anchor" href="#_3-4-测试日志切换" aria-label="Permalink to &quot;3.4 测试日志切换&quot;">​</a></h3><p>主库dg1:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">select</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tablespace_name,file_name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dba_data_files</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TABLESPACE_NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                FILE_NAME</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">------------------------------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --------------------------------------------------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">EXAMPLE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                        /u01/oradata/prod/example01.dbf</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">USERS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                          /u01/oradata/prod/users01.dbf</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">UNDOTBS1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                       /u01/oradata/prod/undotbs01.dbf</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SYSAUX</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                         /u01/oradata/prod/sysaux01.dbf</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SYSTEM</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                         /u01/oradata/prod/system01.dbf</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">create</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tablespace</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> test1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> datafile</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;/u01/oradata/prod/test101.dbf&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> size</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 5m</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">create</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> table</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> scott.test</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">id</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">tablespace</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> test1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">insert</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> into</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> scott.test</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> values</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">commit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">alter</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> system</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> switch</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> logfile</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><p>备库dg2:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">select</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tablespace_name,file_name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dba_data_files</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> where</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tablespace_name=’TEST1’</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">select</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> scott.test</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div>`,36)]))}const y=a(h,[["render",k]]);export{g as __pageData,y as default};
