import{_ as i,a,b as t,c as n}from"./chunks/04haierzhijia_share.uzHudAo9.js";import{_ as h,c as k,o as l,a4 as p}from"./chunks/framework.CGsRFzUA.js";const c=JSON.parse('{"title":"Usage Background","description":"","frontmatter":{},"headers":[],"relativePath":"en/work/tidb/TiDB-EcosystematicTools/TiCDC/TiCDC Overview.md","filePath":"en/work/tidb/TiDB-EcosystematicTools/TiCDC/TiCDC Overview.md"}'),e={name:"en/work/tidb/TiDB-EcosystematicTools/TiCDC/TiCDC Overview.md"};function r(F,s,d,o,g,y){return l(),k("div",null,s[0]||(s[0]=[p('<h1 id="usage-background" tabindex="-1">Usage Background <a class="header-anchor" href="#usage-background" aria-label="Permalink to &quot;Usage Background&quot;">​</a></h1><h2 id="_1-project-background" tabindex="-1">1. Project Background <a class="header-anchor" href="#_1-project-background" aria-label="Permalink to &quot;1. Project Background&quot;">​</a></h2><p>As described on the <a href="https://docs.pingcap.com/zh/tidb/stable/ticdc-overview" target="_blank" rel="noreferrer">PingCAP official website</a>, the main use cases of TiCDC are <strong>&quot;database disaster recovery&quot;</strong> and <strong>&quot;data integration&quot;</strong>. Enthusiasts familiar with the TiDB ecosystem might know about <strong>&quot;TiDB Binlog&quot;</strong>, a tool with similar functionality to TiCDC. <strong>So why reinvent the wheel?</strong><br> The answer lies in the limitations of &quot;TiDB Binlog,&quot; which cannot address the following (not exhaustive) issues. For those unfamiliar with &quot;TiDB Binlog,&quot; refer to the <a href="https://docs.pingcap.com/zh/tidb/stable/tidb-binlog-overview" target="_blank" rel="noreferrer">TiDB Binlog Overview</a>:</p><ol><li>Poor scalability of &quot;TiDB Binlog,&quot; such as the &quot;single point&quot; and &quot;performance&quot; issues of Drainer. Splitting Drainer cannot ensure &quot;row change order.&quot;</li><li>Low performance of &quot;TiDB Binlog,&quot; such as only supporting single Kafka single partition writes, which limits Kafka throughput.</li><li>Poor generality of &quot;TiDB Binlog,&quot; such as requiring Reparo to parse SQL statements when writing binlog files, and not supporting general protocols like Maxwell or Canal.</li><li>Synchronization pain points of &quot;TiDB Binlog,&quot; such as being limited by GRPC max message size, e.g., <a href="https://docs.pingcap.com/zh/tidb/stable/handle-tidb-binlog-errors#%E5%BD%93%E4%B8%8A%E6%B8%B8%E4%BA%8B%E5%8A%A1%E8%BE%83%E5%A4%A7%E6%97%B6pump-%E6%8A%A5%E9%94%99-rpc-error-code--resourceexhausted-desc--trying-to-send-message-larger-than-max-2191430008-vs-2147483647" target="_blank" rel="noreferrer">Pump&#39;s gRPC message exceeds limit</a>.</li><li>Poor availability of &quot;TiDB Binlog,&quot; such as synchronization interruptions when the single-point Drainer fails, with no self-healing capabilities.</li></ol><p>Thus, TiCDC was born. By directly capturing TiKV Change Logs, TiCDC uses tables as split units to schedule data synchronization to various Captures, solving scalability issues. It supports multi-partition Kafka writes and general protocols like Maxwell and Canal, addressing synchronization performance and ecosystem compatibility issues. When synchronization times out, Capture has uneven table distribution, or Capture crashes, TiCDC&#39;s scheduling mechanism and &quot;At Least Once&quot; guarantee ensure data integrity and self-healing.</p><figure><img src="'+i+'" alt="01BinlogAndTiCDC" tabindex="0"><figcaption>01BinlogAndTiCDC</figcaption></figure><h2 id="_2-tool-position" tabindex="-1">2. Tool Position <a class="header-anchor" href="#_2-tool-position" aria-label="Permalink to &quot;2. Tool Position&quot;">​</a></h2><p>To understand how to use TiCDC, one must first clarify its position and role in the TiDB ecosystem.<br><strong>1. In terms of role</strong>: If a database is a &quot;one-way street,&quot; it will inevitably be abandoned by the market, becoming a so-called <strong>&quot;data island.&quot;</strong> TiCDC balances synchronization performance, data integrity, consistency, and ecosystem compatibility, creating a closed loop of <strong>&quot;data inflow -&gt; TiDB -&gt; data outflow.&quot;</strong> Additionally, discussing performance without considering scenarios is meaningless. No product can excel in all scenarios, and TiDB has its comfort zones and pain points. <strong>With TiCDC, users can easily enable data flow and use TiDB in its optimal scenarios.</strong></p><p><strong>2. In terms of position</strong>: TiCDC sits between TiDB and downstream destinations, which include all products and platforms compatible with MySQL communication protocols (e.g., TiDB, MySQL, RDS, third-party cloud platforms). Users can also develop custom solutions based on general message queue output protocols. Currently, TiCDC supports protocols like Open Protocol, Canal-JSON, Canal, Avro, and Maxwell. Some protocols are only partially supported. For details, refer to --&gt; <a href="https://github.com/pingcap/tiflow/blob/master/docs/design/2020-11-04-ticdc-protocol-list.md#protocols-%E5%88%86%E5%8D%8F%E8%AE%AE%E4%BB%8B%E7%BB%8D" target="_blank" rel="noreferrer">TiCDC Supported Protocols Guide</a>.<br> Additionally, TiCDC covers almost all mainstream &quot;data synchronization&quot; use cases. The diagram below illustrates the classic combination of &quot;MySQL --&gt; TiDB --&gt; Others.&quot; For other protocol databases (Oracle, PG), the method to flow into TiDB is equivalent to flowing into MySQL, as TiDB is compatible with MySQL communication protocols, ensuring mature solutions exist.</p><figure><img src="'+a+'" alt="02UpstreamAndDownstream" tabindex="0"><figcaption>02UpstreamAndDownstream</figcaption></figure><h2 id="_3-usage-scenarios" tabindex="-1">3. Usage Scenarios <a class="header-anchor" href="#_3-usage-scenarios" aria-label="Permalink to &quot;3. Usage Scenarios&quot;">​</a></h2><p><strong>Note: The following companies were identified through articles on AskTUG, where shared articles mentioned their use of TiCDC. These companies are only those discoverable through search. Many commercial customers either request confidentiality or have not yet disclosed their usage.</strong></p><h3 id="_3-1-xiaohongshu" tabindex="-1"><strong>3.1 Xiaohongshu</strong> <a class="header-anchor" href="#_3-1-xiaohongshu" aria-label="Permalink to &quot;**3.1 Xiaohongshu**&quot;">​</a></h3><p>From <code>Zhang Yihao</code>&#39;s sharing in <a href="https://www.bilibili.com/video/BV1bD4y1o7qU?spm_id_from=333.337.search-card.all.click" target="_blank" rel="noreferrer">【PingCAP Infra Meetup】No.131 TiCDC&#39;s Ecosystem and Community Development</a>, Xiaohongshu uses TiCDC for content review, note tag recommendations, and growth audits. The architecture is as follows: &quot;TiDB --&gt; TiCDC --&gt; Kafka --&gt; Flink --&gt; TiDB,&quot; enabling aggregation with other data sources.</p><figure><img src="'+t+'" alt="03xiaohongshu_share" tabindex="0"><figcaption>03xiaohongshu_share</figcaption></figure><h3 id="_3-2-haier-smart-home" tabindex="-1"><strong>3.2 Haier Smart Home</strong> <a class="header-anchor" href="#_3-2-haier-smart-home" aria-label="Permalink to &quot;**3.2 Haier Smart Home**&quot;">​</a></h3><p>From <code>Yao Xiang</code>&#39;s sharing in <a href="https://www.bilibili.com/video/BV1bD4y1o7qU?spm_id_from=333.337.search-card.all.click" target="_blank" rel="noreferrer">【PingCAP Infra Meetup】No.131 TiCDC&#39;s Ecosystem and Community Development</a>, Haier Smart Home uses TiCDC for search and recommendations. User data and smart home information are processed through &quot;TiDB --&gt; TiCDC --&gt; Kafka --&gt; ES,&quot; achieving near real-time search functionality with Kafka consuming approximately 3 million messages daily. As of the 2019-09-19 sharing, <strong>TiCDC&#39;s synchronization boundary under normal conditions is in the &quot;millisecond&quot; range, and under jitter conditions, it is within &quot;seconds&quot; (less than 10s).</strong><br> Additionally, from <a href="https://github.com/pingcap/tiflow/projects/13" target="_blank" rel="noreferrer">Github -- Question and Bug Reports</a>, TiCDC has a roadmap for improving synchronization performance, such as <code>mqSink flushes data synchronously, causing low performance</code> and <code>improve performance of syncer.</code> TiCDC&#39;s synchronization performance is a continuous optimization process.</p><figure><img src="'+n+`" alt="04haierzhijia_share" tabindex="0"><figcaption>04haierzhijia_share</figcaption></figure><h3 id="_3-3-360" tabindex="-1"><strong>3.3 360</strong> <a class="header-anchor" href="#_3-3-360" aria-label="Permalink to &quot;**3.3 360**&quot;">​</a></h3><p>From <code>Dai Xiaolei</code>&#39;s sharing in <a href="https://tidb.net/blog/2fa9cf6a" target="_blank" rel="noreferrer">BLOG - TiCDC Application Scenarios Analysis</a>, 360 uses TiCDC to meet the needs of incremental data extraction, same-city dual-cluster hot backup, and stream processing.</p><h2 id="_4-usage-methods" tabindex="-1">4. Usage Methods <a class="header-anchor" href="#_4-usage-methods" aria-label="Permalink to &quot;4. Usage Methods&quot;">​</a></h2><h3 id="_4-1-deploying-ticdc" tabindex="-1">4.1 Deploying TiCDC <a class="header-anchor" href="#_4-1-deploying-ticdc" aria-label="Permalink to &quot;4.1 Deploying TiCDC&quot;">​</a></h3><p>The following test environment sets up TiCDC for testing and learning its synchronization capabilities. The CDC components on <code>172.16.6.155:8300</code> and <code>172.16.6.196:8300</code> will appear after scaling.</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[tidb@Linux-Hostname </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]$ tiup cluster display tidb-test</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ID</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                  Role</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          Host</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          Ports</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        OS/Arch</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">       Status</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Data</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Dir</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                                     Deploy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Dir</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                  ----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">          ----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">          -----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        -------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">       ------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                                     ----------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">172.16.6.155:9093</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   alertmanager</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  172.16.6.155</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  9093/9094</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Up</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      /home/data/tidb-home/data/alertmanager-9093</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /home/data/tidb-deploy/alertmanager-9093</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">172.16.6.155:8300</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   cdc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">           172.16.6.155</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  8300</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Up</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      /data/deploy/install/data/cdc-8300</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">           /home/data/tidb-deploy/cdc-8300</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">172.16.6.196:8300</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   cdc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">           172.16.6.196</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  8300</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Up</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      /data/deploy/install/data/cdc-8300</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">           /home/data/tidb-deploy/cdc-8300</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">172.16.6.155:3000</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   grafana</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">       172.16.6.155</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  3000</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Up</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                                            /home/data/tidb-deploy/grafana-3000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">172.16.6.155:2379</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   pd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            172.16.6.155</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  2379/2380</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Up</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">UI</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   /home/data/tidb-home/data/pd-2379</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            /home/data/tidb-deploy/pd-2379</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">172.16.6.194:2379</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   pd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            172.16.6.194</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  2379/2380</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Up</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      /home/data/tidb-home/data/pd-2379</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            /home/data/tidb-deploy/pd-2379</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">172.16.6.196:2379</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   pd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            172.16.6.196</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  2379/2380</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Up</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">L</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    /home/data/tidb-home/data/pd-2379</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            /home/data/tidb-deploy/pd-2379</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">172.16.6.155:9090</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   prometheus</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    172.16.6.155</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  9090/12020</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Up</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      /home/data/tidb-home/data/prometheus-9090</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    /home/data/tidb-deploy/prometheus-9090</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">172.16.6.155:4000</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   tidb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">          172.16.6.155</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  4000/10080</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Up</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                                            /home/data/tidb-deploy/tidb-4000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">172.16.6.196:4000</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   tidb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">          172.16.6.196</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  4000/10080</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Up</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                                            /home/data/tidb-deploy/tidb-4000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">172.16.6.155:20160</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  tikv</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">          172.16.6.155</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  20160/20180</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Up</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      /home/data/tidb-home/data/tikv-20160</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         /home/data/tidb-deploy/tikv-20160</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">172.16.6.194:20160</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  tikv</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">          172.16.6.194</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  20160/20180</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Up</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      /home/data/tidb-home/data/tikv-20160</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         /home/data/tidb-deploy/tikv-20160</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">172.16.6.196:20160</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  tikv</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">          172.16.6.196</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  20160/20180</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Up</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      /home/data/tidb-home/data/tikv-20160</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         /home/data/tidb-deploy/tikv-20160</span></span></code></pre></div><p><strong>TiCDC reached GA in version 4.0.6, and it is recommended to use version 4.0.6 and above.</strong> For details, refer to the --&gt; <a href="https://docs.pingcap.com/zh/tidb/stable/scale-tidb-using-tiup#%E6%89%A9%E5%AE%B9-ticdc-%E8%8A%82%E7%82%B9" target="_blank" rel="noreferrer">TiCDC Official Documentation</a>. The scaling steps are as follows.</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[tidb@Linux-Hostname </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]$ cat scale-out-cdc.yaml </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cdc_servers:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> host:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 172.16.6.155</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    gc-ttl:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 86400</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    data_dir:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /data/deploy/install/data/cdc-8300</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> host:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 172.16.6.196</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    gc-ttl:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 86400</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    data_dir:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /data/deploy/install/data/cdc-8300</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[tidb@Linux-Hostname </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]$ tiup cluster scale-out tidb-test scale-out-cdc.yaml</span></span></code></pre></div><h3 id="_4-2-synchronization-to-kafka" tabindex="-1">4.2 Synchronization to Kafka <a class="header-anchor" href="#_4-2-synchronization-to-kafka" aria-label="Permalink to &quot;4.2 Synchronization to Kafka&quot;">​</a></h3><p>As I had no prior experience with Kafka, I referred to the <a href="https://kafka.apache.org/quickstart" target="_blank" rel="noreferrer">Kafka Quickstart</a> to set up a Kafka environment on <code>172.16.6.155</code> and <code>172.16.6.196</code> for testing. The goal was to parse messages sent to Kafka by TiCDC.</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Install Java Runtime Environment</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[tidb@kafka1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]$ yum install java-1.8.0-openjdk.x86_64</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[tidb@kafka1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]$ java -version</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openjdk</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> version</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;1.8.0_322&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Set up Kafka on 172.16.6.155 and 172.16.6.196</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[tidb@kafka1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]$  wget https://dlcdn.apache.org/kafka/3.1.0/kafka_2.13-3.1g/kafka/3.1.0/kafka_2.13-3.1.0.tgz --no-check-certificate</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[tidb@kafka1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]$  tar -xzf kafka_2.13-3.1.0.tgz</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[tidb@kafka1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]$  cd kafka_2.13-3.1.0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[tidb@kafka1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]$  bin/zookeeper-server-start.sh config/zookeeper.properties</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[tidb@kafka1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]$  bin/kafka-server-start.sh config/server.properties</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Create a topic named tidb-test with 2 partitions</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[tidb@kafka1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]$  bin/kafka-topics.sh --create --topic tidb-test </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    --bootstrap-server</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  172.16.6.155:9092,172.16.6.196:9092</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    --partitions</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Created</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> topic</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> quickstart-events.</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Describe the tidb-test topic to verify its configuration</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[tidb@kafka1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]$ bin/kafka-topics.sh --describe --topic tidb-test </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    --bootstrap-server</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 172.16.6.155:9092,172.16.6.196:9092</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Topic:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tidb-test</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> TopicId:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> OjM6FFrBQtqyEB4sVWmYCQ</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> PartitionCount:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ReplicationFactor:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Configs:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> segment.bytes=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1073741824</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Topic:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tidb-test</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Partition:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Leader:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Replicas:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Isr:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Topic:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tidb-test</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Partition:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Leader:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Replicas:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Isr:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Create a changefeed in TiCDC to synchronize data to Kafka, using the manually created tidb-test topic</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[tidb@kafka1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]$ tiup cdc cli changefeed create --pd</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">http://172.16.6.155:2379</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    --sink-uri=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;kafka://172.16.6.155:9092/tidb-test?protocol=canal-json&amp;kafka-version=2.4.0&amp;partition-num=2&amp;max-message-bytes=67108864&amp;replication-factor=1&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tiup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> checking</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> updates</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> component</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cdc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> component</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> \`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cdc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\`</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /home/tidb/.tiup/components/cdc/v6.0.0/cdc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /home/tidb/.tiup/components/cdc/v6.0.0/cdc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cli</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> changefeed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> create</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --pd=http://172.16.6.155:2379</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --sink-uri=kafka://172.16.6.155:9092/tidb-test</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">protocol=canal-json</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&amp;kafka-version</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">2.4.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&amp;partition-num</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&amp;max-message-bytes</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">67108864</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&amp;replication-factor</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[2022/05/12 16:37:09.667 +08:00] [WARN] [kafka.go:416] [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;topic&#39;s \`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">max.message.bytes</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\` less than the \`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">max-message-bytes</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\`,use topic&#39;s \`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">max.message.bytes</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\` to initialize the Kafka producer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] [max.message.bytes</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">1048588] [max-message-bytes</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">67108864]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[2022/05/12 16:37:09.667 +08:00] [WARN] [kafka.go:425] [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;topic already exist, TiCDC will not create the topic&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] [topic</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">tidb-test] [detail</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;{</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">NumPartitions</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">:2,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">ReplicationFactor</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">:1,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">ReplicaAssignment</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">:{</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">:[0],</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">:[0]},</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">ConfigEntries</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">:{</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">segment.bytes</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">1073741824</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}}&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Create</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> changefeed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> successfully!</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">......</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Use sysbench to insert 2 rows into jan.sbtest1   </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[tidb@kafka1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]$ sysbench oltp_read_write --mysql-host</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">127.0.0.1</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    --mysql-port=4000</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    --mysql-db=jan</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    --mysql-user=root</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    --mysql-password=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    --table_size=2</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    --tables=1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  prepare</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Parse the data changes in Kafka as follows   </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[tidb@kafka1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]$ bin/kafka-console-consumer.sh --topic tidb-test </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    --from-beginning</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --bootstrap-server</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 172.16.6.155:9092,172.16.6.196:9092</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;id&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">:0,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;database&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;jan&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;table&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;sbtest1&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;pkNames&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;id&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">],</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;isDdl&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">:false,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;type&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;INSERT&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;es&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">:1652344970654,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;ts&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">:1652344977538,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;sql&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;sqlType&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">c</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:1,&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">id</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:4,&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">k</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:4,&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pad</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:1},&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mysqlType</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:{&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">c</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">char</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;,&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">id</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;,&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">k</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;,&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pad</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">char</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;},&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">data</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:[{&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">c</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">83868641912-28773972837-60736120486-75162659906-27563526494-20381887404-41576422241-93426793964-56405065102-33518432330</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;,&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">id</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">1</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;,&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">k</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">1</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;,&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pad</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">67847967377-48000963322-62604785301-91415491898-96926520291</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;}],&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">old</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:null}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">{&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">id</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:0,&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">database</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">jan</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;,&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">table</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sbtest1</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;,&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pkNames</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:[&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">id</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;],&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">isDdl</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:false,&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">INSERT</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;,&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">es</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:1652344970654,&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ts</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:1652344977538,&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sql</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:&quot;&quot;,&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlType</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:{&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">c</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:1,&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">id</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:4,&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">k</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:4,&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pad</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:1},&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mysqlType</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:{&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">c</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">char</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;,&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">id</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;,&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">k</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;,&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pad</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">char</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;},&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">data</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:[{&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">c</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">38014276128-25250245652-62722561801-27818678124-24890218270-18312424692-92565570600-36243745486-21199862476-38576014630</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;,&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">id</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;,&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">k</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;,&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pad</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">23183251411-36241541236-31706421314-92007079971-60663066966</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;}],&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">old</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:null}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">{&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">id</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:0,&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">database</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">jan</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;,&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">table</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:&quot;&quot;,&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pkNames</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:null,&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">isDdl</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:true,&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">QUERY</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;,&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">es</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:1652344966953,&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ts</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:1652344969305,&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sql</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">CREATE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DATABASE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> \`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">jan</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;,&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlType</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:null,&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mysqlType</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:null,&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">data</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:null,&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">old</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:null}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">{&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">id</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:0,&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">database</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">jan</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;,&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">table</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sbtest1</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;,&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pkNames</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:null,&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">isDdl</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:true,&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">CREATE</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;,&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">es</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:1652344970604,&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ts</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:1652344975305,&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sql</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;:&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">CREATE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> TABLE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> \`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sbtest1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">id</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> INT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> NOT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> NULL</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> AUTO_INCREMENT,\`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">k</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> INT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEFAULT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> _UTF8MB4&#39;0&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> NOT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> NULL,\`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> CHAR(120</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">DEFAULT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> _UTF8MB4&#39;&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> NOT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> NULL,\`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pad</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> CHAR(60</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) DEFAULT _UTF8MB4</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> NOT NULL,PRIMARY KEY(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">id</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)) ENGINE = innodb&quot;,&quot;sqlType&quot;:null,&quot;mysqlType&quot;:null,&quot;data&quot;:null,&quot;old&quot;:null}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;id&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">:0,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;database&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;jan&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;table&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;sbtest1&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;pkNames&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">:null,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;isDdl&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">:true,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;type&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;CINDEX&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;es&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">:1652344973455,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;ts&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">:1652344978504,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;sql&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;CREATE INDEX </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">k_1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ON </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sbtest1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">k</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">)&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;sqlType&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">:null,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;mysqlType&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">:null,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;data&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">:null,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;old&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">:null}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Clean up the Kafka environment set up on 172.16.6.155 and 172.16.6.196</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># First, use ctrl + c to close all foreground processes started in terminals</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[tidb@kafka1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]$ rm -rf /tmp/kafka-logs /tmp/zookeeper</span></span></code></pre></div><h3 id="_4-3-synchronization-to-mysql" tabindex="-1">4.3 Synchronization to MySQL <a class="header-anchor" href="#_4-3-synchronization-to-mysql" aria-label="Permalink to &quot;4.3 Synchronization to MySQL&quot;">​</a></h3><p>To synchronize data to MySQL, install MySQL on <code>172.16.6.155:3306</code>. After configuring the relevant parameters, a subscription task with the ID simple-replication-task can be created. The synchronization progress can be monitored on the Grafana dashboard. MySQL is a familiar tool for DBAs, so the steps for verifying synchronization are not elaborated here.</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[tidb@Linux-Hostname </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]$ tiup cdc cli changefeed create --pd</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">http://172.16.6.155:2379</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --sink-uri=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;mysql://jan:123123@172.16.6.155:3306/?time-zone=&amp;worker-count=16&amp;max-txn-row=5000&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --changefeed-id=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;simple-replication-task&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --sort-engine=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;unified&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --config=changefeed.toml</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tiup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> checking</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> updates</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> component</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cdc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> component</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> \`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cdc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\`</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /home/tidb/.tiup/components/cdc/v6.0.0/cdc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /home/tidb/.tiup/components/cdc/v6.0.0/cdc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cli</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> changefeed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> create</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --pd=http://172.16.6.155:2379</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --sink-uri=mysql://jan:123123@172.16.6.155:3306/</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">time-zone=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&amp;worker-count</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&amp;max-txn-row</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">5000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> --changefeed-id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">simple-replication-task</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> --sort-engine</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">unified</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> --config</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">changefeed.toml</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[2022/04/12 16:58:40.954 +08:00] [WARN] [mysql_params.go:143] [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;max-txn-row too large&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] [original</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">5000] [override</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">2048]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Create</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> changefeed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> successfully!</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">......</span></span></code></pre></div><h2 id="_5-referenced-articles" tabindex="-1">5. Referenced Articles <a class="header-anchor" href="#_5-referenced-articles" aria-label="Permalink to &quot;5. Referenced Articles&quot;">​</a></h2><p><a href="https://www.bilibili.com/video/BV1HT4y1A7mh?spm_id_from=333.337.search-card.all.click" target="_blank" rel="noreferrer">1. 【PingCAP Infra Meetup】No.131 Why and how we build TiCDC</a><br><a href="https://www.bilibili.com/video/BV1bD4y1o7qU?spm_id_from=333.337.search-card.all.click" target="_blank" rel="noreferrer">2. 【PingCAP Infra Meetup】No.131 TiCDC 的生态和社区建设</a><a href="https://docs.pingcap.com/zh/tidb/stable/ticdc-overview" target="_blank" rel="noreferrer">3. 官方文档 -- TiCDC</a><br><a href="https://docs.pingcap.com/zh/tidb/stable/tidb-binlog-overview" target="_blank" rel="noreferrer">4. 官方文档 -- TiDB Binlog</a><br><a href="https://docs.pingcap.com/zh/tidb/stable/handle-tidb-binlog-errors#%E5%BD%93%E4%B8%8A%E6%B8%B8%E4%BA%8B%E5%8A%A1%E8%BE%83%E5%A4%A7%E6%97%B6pump-%E6%8A%A5%E9%94%99-rpc-error-code--resourceexhausted-desc--trying-to-send-message-larger-than-max-2191430008-vs-2147483647" target="_blank" rel="noreferrer">5. 官方 FAQ -- Pump 的 gRPC message 超过限值</a><br><a href="https://github.com/pingcap/tiflow/blob/master/docs/design/2020-11-04-ticdc-protocol-list.md#protocols-%E5%88%86%E5%8D%8F%E8%AE%AE%E4%BB%8B%E7%BB%8D" target="_blank" rel="noreferrer">6. Github Design Doc -- TiCDC 支持的消息队列输出协议指南</a><br><a href="https://github.com/pingcap/tiflow/projects/13" target="_blank" rel="noreferrer">7. Github Question and Bug Reports -- TiCDC 提升性能规划路径</a><br><a href="https://tidb.net/blog/2fa9cf6a" target="_blank" rel="noreferrer">8. AskTUG Blog -- 代晓磊 TiCDC 应用场景解析</a><br><a href="https://kafka.apache.org/intro" target="_blank" rel="noreferrer">9. 官方文档 -- Kafka</a></p><p>Additionally, AskTUG, as the official support community for the TiDB ecosystem, is recommended for discussions <a href="https://tidb.net/blog/70588c4c" target="_blank" rel="noreferrer">here https://tidb.net/blog/70588c4c</a>.</p>`,35)]))}const u=h(e,[["render",r]]);export{c as __pageData,u as default};
