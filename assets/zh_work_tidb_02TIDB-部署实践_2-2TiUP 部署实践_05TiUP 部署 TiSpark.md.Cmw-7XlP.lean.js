import{_ as i,c as a,a4 as n,o as p}from"./chunks/framework.C3yiUNUH.js";const g=JSON.parse('{"title":"TiDB-TiSpark依靠TiUP工具协助部署集群","description":"","frontmatter":{},"headers":[],"relativePath":"zh/work/tidb/02TIDB-部署实践/2-2TiUP 部署实践/05TiUP 部署 TiSpark.md","filePath":"zh/work/tidb/02TIDB-部署实践/2-2TiUP 部署实践/05TiUP 部署 TiSpark.md"}'),k={name:"zh/work/tidb/02TIDB-部署实践/2-2TiUP 部署实践/05TiUP 部署 TiSpark.md"};function l(h,s,t,e,r,F){return p(),a("div",null,s[0]||(s[0]=[n(`<h1 id="tidb-tispark依靠tiup工具协助部署集群" tabindex="-1">TiDB-TiSpark依靠TiUP工具协助部署集群 <a class="header-anchor" href="#tidb-tispark依靠tiup工具协助部署集群" aria-label="Permalink to &quot;TiDB-TiSpark依靠TiUP工具协助部署集群&quot;">​</a></h1><p>时间：2021-01-16</p><blockquote><ul><li><a href="#TiSpark原理讲解">TiSpark原理讲解</a></li><li><a href="#TiSpark与Spark下载">TiSpark与Spark下载</a></li><li><a href="#Spark环境部署与检验">Spark环境部署与检验</a></li><li><a href="#拓展TiSpark与spark-shell验证">拓展TiSpark与spark-shell验证</a></li><li><a href="#参考文章">参考文章</a></li></ul></blockquote><h2 id="tispark原理讲解" tabindex="-1">TiSpark原理讲解 <a class="header-anchor" href="#tispark原理讲解" aria-label="Permalink to &quot;TiSpark原理讲解&quot;">​</a></h2><ul><li>TiSpark是构建在 Spark Catalyst 引擎之上的，使用 TiSpark 之前需要安装并运行 Spark 集群；</li><li>TiSpark 实现了如 TiDB 一样的多种计算下推到 TiKV 层面计算，减少 Spark 需要处理数据加速查询；</li><li>TiSpark 可以利用 TiDB 的内建的统计信息选择更优的查询计划;</li><li>TiSpark 直接操作 TiKV，相比使用 Spark 结合 JDBC 的方式写入，不仅可以实现事务而且写入速度会更快; <img src="https://download.pingcap.com/images/docs-cn/tispark-architecture.png" alt="TiSpark"></li></ul><h2 id="tispark与spark下载" tabindex="-1">TiSpark与Spark下载 <a class="header-anchor" href="#tispark与spark下载" aria-label="Permalink to &quot;TiSpark与Spark下载&quot;">​</a></h2><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># tiup 安装 spark</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[tidb@tiup-tidb41 conf]$ tiup install spark</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># tiup 安装 tispark</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[tidb@tiup-tidb41 conf]$ tiup install tispark</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 查看安装结果</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[tidb@tiup-tidb41 conf]$ tiup list --installed</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Available</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> components:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            Owner</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    Description</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            -----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    -----------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">spark</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">           pingcap</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Spark</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> fast</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> and</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> general</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> computing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tispark</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         pingcap</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  tispark</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">......</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">......</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 进入到 tiup 隐藏目录下，查找相关镜像文件</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[tidb@tiup-tidb41 spark-2.4.3-bin-hadoop2.7]$ cd </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/.tiup/components/</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[tidb@tiup-tidb41 components]$ ll </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> spark</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">drwxr-xr-x</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  3</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tidb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tidb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 20</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Jan</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 16</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 05:40</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> spark</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">drwxr-xr-x</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  3</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tidb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tidb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 21</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Jan</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 11</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 07:51</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tispark</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 复制 Spark 到目录 TiDB 部署目录下，统一部署路径，方便以后运维</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[tidb@tiup-tidb41 components]$ cd spark/v2.4.3/</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[tidb@tiup-tidb41 v2.4.3]$ ll</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">drwxr-xr-x</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 13</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tidb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tidb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 211</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Jan</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 16</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 05:40</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> spark-2.4.3-bin-hadoop2.7</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[tidb@tiup-tidb41 v2.4.3]$ cp -rp spark-2.4.3-bin-hadoop2.7 /data/tidb-deploy/</span></span></code></pre></div><h2 id="spark环境部署与检验" tabindex="-1">Spark环境部署与检验 <a class="header-anchor" href="#spark环境部署与检验" aria-label="Permalink to &quot;Spark环境部署与检验&quot;">​</a></h2><ul><li>在正式使用 TiSpark 之前需要先部署 Spark 集群，因为 TiSpark 仅是是一个 Jar 包，实现了 Spark 的扩展</li><li>本例仅使用一个 Spark Master 和一个 Spark Slave 来完成演示(Stand alone)，大家可以一句自己需求搭建完整的 Spark 集群</li></ul><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 进入部署路径 conf 路径下</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[tidb@tiup-tidb41 conf]$ cd /data/tidb-deploy/spark-2.4.3-bin-hadoop2.7/conf/</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[tidb@tiup-tidb41 conf]$ cp spark-defaults.conf.template spark-defaults.conf</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 编写 spark-defaults 配置文件，加入 PD 集群信息、TiSpark 扩展</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[tidb@tiup-tidb41 conf]$ vi spark-defaults.conf</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[tidb@tiup-tidb41 conf]$ cat spark-defaults.conf</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">spark.tispark.pd.addresses</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 192.168.169.41:2379,192.168.169.42:2379,192.168.169.43:2379</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">spark.sql.extensions</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> org.apache.spark.sql.TiExtensions</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[tidb@tiup-tidb41 conf]$ cp spark-env.sh.template spark-env.sh</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 编写 Spark-env 扩展文件</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[tidb@tiup-tidb41 conf]$ vi spark-env.sh</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[tidb@tiup-tidb41 conf]$ cat spark-env.sh</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SPARK_MASTER_IP</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">192.168.169.41</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SPARK_LOCAL_IP</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">192.168.169.41</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SPARK_EXECUTOR_MEMORY</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">1G           </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># SPARK EXECUTOR 所能使用的内存</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SPARK_EXECUTOR_cores</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">             # SPARK EXECUTOR 所能使用的核心数</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SPARK_WORKER_CORES</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">               # SPARK WORKER 所能使用的核心数</span></span></code></pre></div><ul><li>启动 Spark Master 和 Spark Slave</li></ul><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 启动 Spark Master</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[tidb@tiup-tidb41 sbin]$ cd /data/tidb/deploy/spark/sbin</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[tidb@tiup-tidb41 sbin]$ sh start-master.sh</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 启动 Spark Slave（在tikv上操作）</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[tidb@tiup-tidb41 sbin]$ cd /data/tidb-deploy/spark-2.4.3-bin-hadoop2.7/sbin</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[tidb@tiup-tidb41 sbin]$ ./start-slave.sh spark://192.168.169.41:7077</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 检查 Spark Master 和 Slave 是否均已启动</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[tidb@tiup-tidb41 conf]$ ps -ef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> spark</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tidb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      10091</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 06:10</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pts/0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    00:00:27</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/lib/jvm/java-1.8.0-openjdk-1.8.0.275.b01-0.el7_9.x86_64/jre/bin/java</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -cp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /data/tidb-deploy/spark-2.4.3-bin-hadoop2.7/conf/:/data/tidb-deploy/spark-2.4.3-bin-hadoop2.7/jars/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Xmx1g</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> org.apache.spark.deploy.master.Master</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --host</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tiup-tidb41</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --port</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 7077</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --webui-port</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 8080</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tidb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      10155</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 06:12</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pts/0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    00:00:21</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/lib/jvm/java-1.8.0-openjdk-1.8.0.275.b01-0.el7_9.x86_64/jre/bin/java</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -cp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /data/tidb-deploy/spark-2.4.3-bin-hadoop2.7/conf/:/data/tidb-deploy/spark-2.4.3-bin-hadoop2.7/jars/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Xmx1g</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> org.apache.spark.deploy.worker.Worker</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --webui-port</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 8081</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> spark://192.168.169.41:7077</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tidb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      11487</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   8542</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 08:25</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pts/0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    00:00:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> grep</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --color=auto</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> spark</span></span></code></pre></div><p>至此，tidb+spark集群就搭建完成</p><h2 id="拓展tispark与spark-shell验证" tabindex="-1">拓展TiSpark与spark-shell验证 <a class="header-anchor" href="#拓展tispark与spark-shell验证" aria-label="Permalink to &quot;拓展TiSpark与spark-shell验证&quot;">​</a></h2><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 进入 spark 命令行客户端，并执行 spark.sql(&quot;show databases&quot;).show 查看 TiDB 中所有数据库</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">scala</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; [tidb@tiup-tidb41 </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">conf]</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$ </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">spark-shell</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">21/01/16</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 07:13:55</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> WARN</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> NativeCodeLoader:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Unable</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> load</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> native-hadoop</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> library</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> your</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> platform...</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> using</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> builtin-java</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> classes</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> where</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> applicable</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Setting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> default</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> log</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> level</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;WARN&quot;.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">To</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> adjust</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> logging</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> level</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> use</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sc.setLogLevel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">newLevel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> For</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> SparkR,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> use</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> setLogLevel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">newLevel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">21/01/16</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 07:14:11</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> INFO</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> TiSparkInfo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Supported</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Spark</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Version:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2.3</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2.4</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Current</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Spark</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Version:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2.4.3</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Current</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Spark</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Major</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Version:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2.4</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Spark</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> context</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Web</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> UI</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> available</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> at</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> http://tiup-tidb41:4040</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Spark</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> context</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> available</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> as</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;sc&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (master </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> local[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">],</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> app</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> id</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> local-1610799251405</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Spark</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> session</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> available</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> as</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;spark&#39;.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Welcome</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      ____</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">              __</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">     /</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> __/__</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  ___</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> _____/</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /__</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    _\\</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\/</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> _</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\/</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> _</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> \`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> __/  &#39;_/</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   /___/ .__/\\_,_/_/ /_/\\_\\   version 2.4.3</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      /_/</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Using Scala version 2.11.12 (OpenJDK 64-Bit Server VM, Java 1.8.0_275)</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Type in expressions to have them evaluated.</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Type :help for more information.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">scala&gt; spark.sql(&quot;show databases&quot;).show</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">21/01/16 07:14:34 INFO ReflectionUtil$: tispark class url: file:/data/tidb-deploy/spark-2.4.3-bin-hadoop2.7/jars/tispark-assembly-2.3.11.jar</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">21/01/16 07:14:34 INFO ReflectionUtil$: spark wrapper class url: jar:file:/data/tidb-deploy/spark-2.4.3-bin-hadoop2.7/jars/tispark-assembly-2.3.11.jar!/resources/spark-wrapper-spark-2_4/</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">21/01/16 07:14:50 WARN ObjectStore: Version information not found in metastore. hive.metastore.schema.verification is not enabled so recording the schema version 1.2.0</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">21/01/16 07:14:50 WARN ObjectStore: Failed to get database default, returning NoSuchObjectException</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">+------------+</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">|databaseName|</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">+------------+</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">|     default|</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">|   dumptest2|</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">|   user_east|</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">|         jan|</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">+------------+</span></span></code></pre></div><h2 id="参考文章" tabindex="-1">参考文章 <a class="header-anchor" href="#参考文章" aria-label="Permalink to &quot;参考文章&quot;">​</a></h2><ul><li><p><a href="https://www.cndba.cn/Marvinn/article/3283" target="_blank" rel="noreferrer">TiSpark 混合部署以及使用: https://www.cndba.cn/Marvinn/article/3283</a></p></li><li><p><a href="https://blog.csdn.net/weixin_30814319/article/details/95494841" target="_blank" rel="noreferrer">9栋108-tispark部署步骤：https://blog.csdn.net/weixin_30814319/article/details/95494841</a></p></li><li><p><a href="https://github.com/tidb-incubator/tidb-in-action/blob/master/session1/chapter11/tispark-in-action.md" target="_blank" rel="noreferrer">TiSpark 的使用:https://github.com/tidb-incubator/tidb-in-action/blob/master/session1/chapter11/tispark-in-action.md</a></p></li></ul>`,17)]))}const y=i(k,[["render",l]]);export{g as __pageData,y as default};
