<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/">
    <channel>
        <title>Ask Aric</title>
        <link>https://askaric.com</link>
        <description>undefined</description>
        <lastBuildDate>Sun, 29 Jun 2025 01:27:02 GMT</lastBuildDate>
        <docs>https://validator.w3.org/feed/docs/rss2.html</docs>
        <generator>https://github.com/jpmonette/feed</generator>
        <copyright>Copyright (c) 2016-present, Ask Aric</copyright>
        <item>
            <title><![CDATA[About Aric]]></title>
            <link>https://askaric.com/en/about.html</link>
            <guid>https://askaric.com/en/about.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[# About Aric

![header](../images/header.jpg)

- Bilibili: [askAric](https://space.bilibili.com/318184941?spm_id_from=333.1007.0.0)
- Github: <https://github.com/aricSu>
- Email: jan-su-dev@outlook.com
- Wechat: xh9836 `(Please state your purpose and where get my info)`

## Blog content

1. **What**: mainly records of personal knowledge database in **TiDB Series**,**Oracle Series**, **English Learning notes**, and **worth sharing content**.
2. **Why**: Hope in the form of blog, to overcome my own forgetting, and to like-minded partners to provide information, and also correct my own mistakes in my notes.
3. **How**: In the navigation bar **"Docs"**, record the learning process, also welcome everyone to leave your comments and questions in **"community"**.

## Technical origin

1. When I was in junior high school, I read a book called `Jack Ma's Entrepreneurial Revelation` (PS: Although the content in the book has little to do with technology), which made me see the changes that the Internet has brought to China. Subsequently, I also opened several online stores and earned some pocket money üòÅ, which led to my resolute decision to major in IT when I was in college. During my college years, I assisted teachers in using **Python + Scrapy + chrome-driver + phantomjs** to obtain Boss Zhiping, 51 job and other information for analysis, and the direction of school curriculum reform matched the market demand.

2. Upon graduation, I entered the database industry at the recommendation of my teacher. When I first entered the industry, I chose Oracle, which was stable and surrounded by sound ecology, to study. However, I worked as a database administrator (DBA) at that time. Personally, I think I should go deep into the database (code layer) to learn more about it. Just like **'What I cannot create, I do not understand.' -- Richard Phillips Feynman** said, cannot make cannot really understand. Then had the opportunity to come to work [PingCAP](https://baike.baidu.com/item/PingCAP/60056692?fr=aladdin), learning a new generation of distributed HTAP database.

3. Follow the idea of in-depth kernel learning, and gradually get to know Golang, Rust, NodeJs and other languages in the process. The technology road is very interesting and is an important force to push the world forward.

]]></description>
            <content:encoded><![CDATA[<h1 id="about-aric" tabindex="-1">About Aric <a class="header-anchor" href="#about-aric" aria-label="Permalink to &quot;About Aric&quot;"></a></h1>
<figure><img src="./../images/header.jpg" alt="header" tabindex="0"><figcaption>header</figcaption></figure>
<ul>
<li>Bilibili: <a href="https://space.bilibili.com/318184941?spm_id_from=333.1007.0.0" target="_blank" rel="noreferrer">askAric</a></li>
<li>Github: <a href="https://github.com/aricSu" target="_blank" rel="noreferrer">https://github.com/aricSu</a></li>
<li>Email: <a href="mailto:jan-su-dev@outlook.com" target="_blank" rel="noreferrer">jan-su-dev@outlook.com</a></li>
<li>Wechat: xh9836 <code>(Please state your purpose and where get my info)</code></li>
</ul>
<h2 id="blog-content" tabindex="-1">Blog content <a class="header-anchor" href="#blog-content" aria-label="Permalink to &quot;Blog content&quot;"></a></h2>
<ol>
<li><strong>What</strong>: mainly records of personal knowledge database in <strong>TiDB Series</strong>,<strong>Oracle Series</strong>, <strong>English Learning notes</strong>, and <strong>worth sharing content</strong>.</li>
<li><strong>Why</strong>: Hope in the form of blog, to overcome my own forgetting, and to like-minded partners to provide information, and also correct my own mistakes in my notes.</li>
<li><strong>How</strong>: In the navigation bar <strong>&quot;Docs&quot;</strong>, record the learning process, also welcome everyone to leave your comments and questions in <strong>&quot;community&quot;</strong>.</li>
</ol>
<h2 id="technical-origin" tabindex="-1">Technical origin <a class="header-anchor" href="#technical-origin" aria-label="Permalink to &quot;Technical origin&quot;"></a></h2>
<ol>
<li>
<p>When I was in junior high school, I read a book called <code>Jack Ma's Entrepreneurial Revelation</code> (PS: Although the content in the book has little to do with technology), which made me see the changes that the Internet has brought to China. Subsequently, I also opened several online stores and earned some pocket money üòÅ, which led to my resolute decision to major in IT when I was in college. During my college years, I assisted teachers in using <strong>Python + Scrapy + chrome-driver + phantomjs</strong> to obtain Boss Zhiping, 51 job and other information for analysis, and the direction of school curriculum reform matched the market demand.</p>
</li>
<li>
<p>Upon graduation, I entered the database industry at the recommendation of my teacher. When I first entered the industry, I chose Oracle, which was stable and surrounded by sound ecology, to study. However, I worked as a database administrator (DBA) at that time. Personally, I think I should go deep into the database (code layer) to learn more about it. Just like <strong>'What I cannot create, I do not understand.' -- Richard Phillips Feynman</strong> said, cannot make cannot really understand. Then had the opportunity to come to work <a href="https://baike.baidu.com/item/PingCAP/60056692?fr=aladdin" target="_blank" rel="noreferrer">PingCAP</a>, learning a new generation of distributed HTAP database.</p>
</li>
<li>
<p>Follow the idea of in-depth kernel learning, and gradually get to know Golang, Rust, NodeJs and other languages in the process. The technology road is very interesting and is an important force to push the world forward.</p>
</li>
</ol>
<hr>
<h2 id="video-speech" tabindex="-1">Video speech <a class="header-anchor" href="#video-speech" aria-label="Permalink to &quot;Video speech&quot;"></a></h2>
<ol>
<li><a href="https://asktug.com/t/topic/998896#h-2" target="_blank" rel="noreferrer">„Äê2022Âπ¥„ÄëTiDB Á§æÂå∫Âπ¥Â∫¶ÊÄªÁªì - Áâà‰∏ª - ËãèÂøóÈπèÔºàjansu-devÔºâ</a></li>
</ol>
<hr>
<h2 id="certificate-honors" tabindex="-1">Certificate honors <a class="header-anchor" href="#certificate-honors" aria-label="Permalink to &quot;Certificate honors&quot;"></a></h2>
<ol>
<li>
<p>Oracle OCP
<img src="./../images/oracle_ocp.jpg" alt="oracle_ocp"></p>
</li>
<li>
<p>TiDB PTCP(chinese version)
<img src="./../images/tidb_ptcp_chinest.jpg" alt="tidb_ptcp_chinest"></p>
</li>
<li>
<p>TiDB PTCA(english/global version 6)
<img src="./../images/tidb_ptca_global.jpg" alt="tidb_ptca_global"></p>
</li>
<li>
<p>TiDB PTCP(english/global version 6)
<img src="./../images/tidb_ptcp_global.jpg" alt="tidb_ptcp_global"></p>
</li>
<li>
<p>PostgreSQL PGCA
<img src="./../images/pg_pgca.jpg" alt="pg_pgca"></p>
</li>
<li>
<p>PostgreSQL PGCE
<img src="./../images/pg_pgce.jpg" alt="pg_pgce"></p>
</li>
<li>
<p>AskTUG MVA: <a href="https://asktug.com/t/topic/273501" target="_blank" rel="noreferrer">related link</a>
<img src="./../images/asktug_mva.jpg" alt="asktug_mva"></p>
</li>
</ol>
<hr>
<p>ÁΩëÁ´ôÂ§áÊ°àÂè∑<a href="https://beian.miit.gov.cn" target="_blank" rel="noreferrer">Ôºà Ôºâ</a></p>
]]></content:encoded>
            <enclosure url="https://askaric.com/images/header.jpg" length="0" type="image/jpg"/>
        </item>
        <item>
            <link>https://askaric.com/en/life/coffee/20250214 my coffee.html</link>
            <guid>https://askaric.com/en/life/coffee/20250214 my coffee.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[123123123]]></description>
            <content:encoded><![CDATA[<p>123123123</p>
<figure><img src="./../../../images/coffee-machine.jpg" alt="coffee-machine" tabindex="0"><figcaption>coffee-machine</figcaption></figure>
<figure><img src="./../../../images/coffee.jpg" alt="coffee-machine" tabindex="0"><figcaption>coffee-machine</figcaption></figure>
]]></content:encoded>
            <enclosure url="https://askaric.com/images/coffee-machine.jpg" length="0" type="image/jpg"/>
        </item>
        <item>
            <title><![CDATA[This's life.]]></title>
            <link>https://askaric.com/en/life/</link>
            <guid>https://askaric.com/en/life/</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="this-s-life" tabindex="-1">This's life. <a class="header-anchor" href="#this-s-life" aria-label="Permalink to &quot;This's life.&quot;"></a></h1>
]]></content:encoded>
        </item>
        <item>
            <link>https://askaric.com/en/life/motor/20250213 my motor.html</link>
            <guid>https://askaric.com/en/life/motor/20250213 my motor.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[123123123]]></description>
            <content:encoded><![CDATA[<p>123123123</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Learn about skiing]]></title>
            <link>https://askaric.com/en/life/skiing/20250212 learn about skiing.html</link>
            <guid>https://askaric.com/en/life/skiing/20250212 learn about skiing.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[2025 
&lt;iframe width="560" height="315" src="https://www.youtube.com/embed/Zm8ckWZdcYA?si=TZ5vVVJF]]></description>
            <content:encoded><![CDATA[<h1 id="learn-about-skiing" tabindex="-1">Learn about skiing <a class="header-anchor" href="#learn-about-skiing" aria-label="Permalink to &quot;Learn about skiing&quot;"></a></h1>
<h2 id="_2025" tabindex="-1">2025 <a class="header-anchor" href="#_2025" aria-label="Permalink to &quot;2025&quot;"></a></h2>
<iframe width="560" height="315" src="https://www.youtube.com/embed/Zm8ckWZdcYA?si=TZ5vVVJFgbF-2oA7" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>]]></content:encoded>
        </item>
        <item>
            <link>https://askaric.com/en/life/tennis/20250213 my tennis.html</link>
            <guid>https://askaric.com/en/life/tennis/20250213 my tennis.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[123123123]]></description>
            <content:encoded><![CDATA[<p>123123123</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[docdb]]></title>
            <link>https://askaric.com/en/tihc/collect/docdb.html</link>
            <guid>https://askaric.com/en/tihc/collect/docdb.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[# docdb

Use the `tihc collect docdb` command to collect TOPSQL storaged in DocDB of TiDB cluster.

## Quick Start

```bash
# Collect TopSQL data for the last 5 minutes
tihc collect docdb --instance 127.0.0.1:10080 --storage topsql.json

# Collect data for a specific time range
tihc collect docdb \
    --instance 127.0.0.1:10080 \
    --start 1744195176 \
    --end 1744195476 \
    --storage custom_topsql.json
```

## Main Options

| Option | Description | Default Value |
|]]></description>
            <content:encoded><![CDATA[<h1 id="docdb" tabindex="-1">docdb <a class="header-anchor" href="#docdb" aria-label="Permalink to &quot;docdb&quot;"></a></h1>
<p>Use the <code>tihc collect docdb</code> command to collect TOPSQL storaged in DocDB of TiDB cluster.</p>
<h2 id="quick-start" tabindex="-1">Quick Start <a class="header-anchor" href="#quick-start" aria-label="Permalink to &quot;Quick Start&quot;"></a></h2>
<div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Collect TopSQL data for the last 5 minutes</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tihc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> collect</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> docdb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --instance</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 127.0.0.1:10080</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --storage</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> topsql.json</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Collect data for a specific time range</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tihc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> collect</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> docdb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    --instance</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 127.0.0.1:10080</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    --start</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1744195176</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    --end</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1744195476</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    --storage</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> custom_topsql.json</span></span></code></pre>
</div><h2 id="main-options" tabindex="-1">Main Options <a class="header-anchor" href="#main-options" aria-label="Permalink to &quot;Main Options&quot;"></a></h2>
<table tabindex="0">
<thead>
<tr>
<th>Option</th>
<th>Description</th>
<th>Default Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>--instance &lt;INSTANCE&gt;</code></td>
<td>Instance address, format is ip:port</td>
<td>127.0.0.1:10080</td>
</tr>
<tr>
<td><code>--ngurl &lt;NGURL&gt;</code></td>
<td>NG Monitor address</td>
<td>127.0.0.1:12020</td>
</tr>
<tr>
<td><code>--start &lt;START&gt;</code></td>
<td>Start timestamp</td>
<td>1744195176</td>
</tr>
<tr>
<td><code>--end &lt;END&gt;</code></td>
<td>End timestamp</td>
<td>1744195476</td>
</tr>
<tr>
<td><code>--window &lt;WINDOW&gt;</code></td>
<td>Time window size</td>
<td>2s</td>
</tr>
<tr>
<td><code>--top &lt;TOP&gt;</code></td>
<td>Limit of returned results</td>
<td>10000</td>
</tr>
<tr>
<td><code>--storage &lt;STORAGE&gt;</code></td>
<td>Data storage file path</td>
<td>topsql.json</td>
</tr>
</tbody>
</table>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Collect Pprof]]></title>
            <link>https://askaric.com/en/tihc/collect/pprof.html</link>
            <guid>https://askaric.com/en/tihc/collect/pprof.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[# Collect Pprof

Use the `tihc collect pprof` command to collect pprof information from various components in a TiDB cluster.

## Quick Start

```bash
tihc collect pprof -a IP_ADDRESS:2379 \
    -c pd \
    -t goroutine \
    -o /tmp/pd_goroutine
```

## Main Options

| Option | Description | Default Value |
|]]></description>
            <content:encoded><![CDATA[<h1 id="collect-pprof" tabindex="-1">Collect Pprof <a class="header-anchor" href="#collect-pprof" aria-label="Permalink to &quot;Collect Pprof&quot;"></a></h1>
<p>Use the <code>tihc collect pprof</code> command to collect pprof information from various components in a TiDB cluster.</p>
<h2 id="quick-start" tabindex="-1">Quick Start <a class="header-anchor" href="#quick-start" aria-label="Permalink to &quot;Quick Start&quot;"></a></h2>
<div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tihc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> collect</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> pprof</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> IP_ADDRESS:2379</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    -c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> pd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    -t</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> goroutine</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /tmp/pd_goroutine</span></span></code></pre>
</div><h2 id="main-options" tabindex="-1">Main Options <a class="header-anchor" href="#main-options" aria-label="Permalink to &quot;Main Options&quot;"></a></h2>
<table tabindex="0">
<thead>
<tr>
<th>Option</th>
<th>Description</th>
<th>Default Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-a, --address &lt;IP:PORT&gt;</code></td>
<td>Instance address (required for tidb/tikv/pd components), format is ip:port, e.g.: 127.0.0.1:2379</td>
<td>-</td>
</tr>
<tr>
<td><code>-c, --component &lt;COMPONENT&gt;</code></td>
<td>Component to collect from, available values: tidb, tikv, pd, br</td>
<td>-</td>
</tr>
<tr>
<td><code>-t, --collection-type &lt;COLLECTION_TYPE&gt;</code></td>
<td>Collection type, available values: config, profile, mutex, heap, goroutine</td>
<td>-</td>
</tr>
<tr>
<td><code>-o, --output &lt;OUTPUT&gt;</code></td>
<td>Path to store collected data (optional for goroutine collection)</td>
<td>-</td>
</tr>
<tr>
<td><code>-P, --processid &lt;PROCESSID&gt;</code></td>
<td>Process ID (required for br component)</td>
<td>-</td>
</tr>
<tr>
<td><code>-s, --seconds &lt;SECONDS&gt;</code></td>
<td>Duration of profiling in seconds</td>
<td>60</td>
</tr>
<tr>
<td><code>-l, --log-file &lt;LOG_FILE&gt;</code></td>
<td>Log file path</td>
<td>tihc_started_at_20250320_143949.log</td>
</tr>
<tr>
<td><code>-L, --log-level &lt;LOG_LEVEL&gt;</code></td>
<td>Log level (trace, debug, info, warn, error)</td>
<td>info</td>
</tr>
</tbody>
</table>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[TiHC (TiDB Health Checker)]]></title>
            <link>https://askaric.com/en/tihc/</link>
            <guid>https://askaric.com/en/tihc/</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[TiHC is a command-line toolkit designed by Aric specifically for TiDB distributed database, aiming t]]></description>
            <content:encoded><![CDATA[<h1 id="tihc-tidb-health-checker" tabindex="-1">TiHC (TiDB Health Checker) <a class="header-anchor" href="#tihc-tidb-health-checker" aria-label="Permalink to &quot;TiHC (TiDB Health Checker)&quot;"></a></h1>
<p>TiHC is a command-line toolkit designed by <a href="./../about.html">Aric</a> specifically for TiDB distributed database, aiming to simplify daily operations, problem diagnosis, and performance analysis of TiDB. As a professional database health check tool, TiHC helps DBAs and developers quickly identify and resolve potential issues in TiDB clusters.</p>
<h2 id="üöÄ-key-features" tabindex="-1">üöÄ Key Features <a class="header-anchor" href="#üöÄ-key-features" aria-label="Permalink to &quot;üöÄ Key Features&quot;"></a></h2>
<ul>
<li><strong>Lightweight</strong>: The software itself is lightweight, non-intrusive to the database, and can run safely in any environment</li>
<li><strong>Ease of Use</strong>: Quickly locate and solve common problems through the command-line interface without complex configuration</li>
</ul>
<h2 id="üí°-use-cases" tabindex="-1">üí° Use Cases <a class="header-anchor" href="#üí°-use-cases" aria-label="Permalink to &quot;üí° Use Cases&quot;"></a></h2>
<h2 id="üì¶-installation-and-usage" tabindex="-1">üì¶ Installation and Usage <a class="header-anchor" href="#üì¶-installation-and-usage" aria-label="Permalink to &quot;üì¶ Installation and Usage&quot;"></a></h2>
<h3 id="building-from-source" tabindex="-1">Building from Source <a class="header-anchor" href="#building-from-source" aria-label="Permalink to &quot;Building from Source&quot;"></a></h3>
<div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Clone the repository</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> clone</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> https://github.com/AricSu/tihc.git</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Compile</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tihc</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">make</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Run</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">./tihc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --help</span></span></code></pre>
</div><h3 id="binary-download" tabindex="-1">Binary Download <a class="header-anchor" href="#binary-download" aria-label="Permalink to &quot;Binary Download&quot;"></a></h3>
<p>Download pre-compiled binary files from the GitHub release page:</p>
<ol>
<li>
<p>Visit the <a href="https://github.com/aricsu/tihc/releases" target="_blank" rel="noreferrer">TiHC Releases</a> page</p>
</li>
<li>
<p>Download the binary file for your operating system:</p>
<ul>
<li>macOS: <code>tihc-darwin-amd64.tar.gz</code></li>
</ul>
</li>
<li>
<p>Extract the downloaded file:</p>
</li>
</ol>
<div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tar</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -xvf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tihc-darwin-amd64.tar.gz</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">chmod</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> +x</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tihc</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">./tihc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --help</span></span></code></pre>
</div><h3 id="quick-install-macos" tabindex="-1">Quick Install (macOS) <a class="header-anchor" href="#quick-install-macos" aria-label="Permalink to &quot;Quick Install (macOS)&quot;"></a></h3>
<div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -fsSL</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> https://raw.githubusercontent.com/AricSu/tihc/master/scripts/install.sh</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> bash</span></span></code></pre>
</div><h2 id="üîç-user-guide" tabindex="-1">üîç User Guide <a class="header-anchor" href="#üîç-user-guide" aria-label="Permalink to &quot;üîç User Guide&quot;"></a></h2>
<h3 id="basic-usage" tabindex="-1">Basic Usage <a class="header-anchor" href="#basic-usage" aria-label="Permalink to &quot;Basic Usage&quot;"></a></h3>
<div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># View help information</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">./tihc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --help</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Output</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tihc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1.0.0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Author:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Aric</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">TiHC</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> CLI</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Tool</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Email:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> askaric@gmail.com</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Doc:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> https://www.askaric.com/en/tihc</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">USAGE:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    tihc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [OPTIONS] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">&#x3C;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">SUBCOMMAND</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">OPTIONS:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    -h,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --help</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                     Print</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> help</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> information</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    -l,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --log-file</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> &#x3C;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">LOG_FIL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">E</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      Log</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> file</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> path</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [default: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">tihc_started_at_20250320_142358.log]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    -L,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --log-level</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> &#x3C;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">LOG_LEVE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">L</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    Log</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> level</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (trace, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">debug,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> info,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> warn,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) [default: info]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    -V,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --version</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                  Print</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> version</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> information</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SUBCOMMANDS:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    collect</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    Collect</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> info</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> TiDB</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> components</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (tidb, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">tikv,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> pd,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> br</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    help</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       Print</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> this</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> message</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> or</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> help</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> given</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> subcommand</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">s</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span></code></pre>
</div><h2 id="ü§ù-contribution-and-support" tabindex="-1">ü§ù Contribution and Support <a class="header-anchor" href="#ü§ù-contribution-and-support" aria-label="Permalink to &quot;ü§ù Contribution and Support&quot;"></a></h2>
<ul>
<li>Issue Feedback: <a href="https://github.com/aricsu/tihc/issues" target="_blank" rel="noreferrer">GitHub Issues</a></li>
<li>Documentation: <a href="https://www.askaric.com/en/tihc" target="_blank" rel="noreferrer">Complete Documentation</a></li>
<li>Contact the Author: <a href="mailto:ask.aric.su@gmail.com" target="_blank" rel="noreferrer">ask.aric.su@gmail.com</a></li>
</ul>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Parse Slow Log]]></title>
            <link>https://askaric.com/en/tihc/tools/slowlog.html</link>
            <guid>https://askaric.com/en/tihc/tools/slowlog.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[# Parse Slow Log

Use the `tihc tools slowlog` command to parse TiDB cluster's slow query log files and asynchronously import them into any MySQL-compatible database for analysis.

## Scenarios

When analyzing TiDB performance issue, TiDB slow logs are crucial for performance analysis. Normally we can analyze slow queries using [TiDB Dashboard](https://docs.pingcap.com/tidb/v7.5/dashboard-slow-query/) , which provides a graphical interface for real-time slow query analysis:

![TiDB Dashboard](https://docs-download.pingcap.com/media/images/docs-cn/dashboard/dashboard-slow-queries-list1-v620.png)

In the following scenarios, a more flexible analysis approach is needed:
- Cannot access Dashboard
- Cannot connect to database to query [information_schema.cluster_slow_query](https://docs.pingcap.com/tidb/v7.5/information-schema-slow-query/#cluster_slow_query-table)
- Need to analyze historical data offline
- Need complex statistical analysis (e.g., analyzing time distribution of specific slow SQL types)

The `tihc tools slowlog` command can parse slow query logs and import them into a database, enabling flexible SQL queries and statistical analysis.

## Quick Start

1. Prepare TiDB Cluster

```bash
curl --proto '=https' --tlsv1.2 -sSf https://tiup-mirrors.pingcap.com/install.sh | sh

source ${your_shell_profile}

tiup playground
```

2. Locate Slow Query Logs

```bash
cd /Downloads/tidb_slow_query-2025-03
ll
total 821464
-rw-r--r--@ 1 aric  staff   38140064  3 27 15:52 tidb.log
-rw-r--r--@ 1 aric  staff  314572718  3 26 00:57 tidb_slow_query-2025-03-25T16-57-07.979.log
-rw-r--r--@ 1 aric  staff   67874170  4  7 17:27 tidb_slow_query.log
```

3. Parse and Import Slow Logs

```bash
tihc tools slowlog \
    --host 127.0.0.1:4000 \
    --log-dir /Downloads/tidb_slow_query-2025-03 \
    --pattern "tidb_.*.log"
==================================================
Command: slowlog
Status: Success
Duration: 15.974513708s
==================================================
```

4. Check Import Results

```sql
aric@MacBook Downloads % mysql --comments --host 127.0.0.1 --port 4000 -u root                         

mysql> use tihc

mysql> show tables;
+]]></description>
            <content:encoded><![CDATA[<h1 id="parse-slow-log" tabindex="-1">Parse Slow Log <a class="header-anchor" href="#parse-slow-log" aria-label="Permalink to &quot;Parse Slow Log&quot;"></a></h1>
<p>Use the <code>tihc tools slowlog</code> command to parse TiDB cluster's slow query log files and asynchronously import them into any MySQL-compatible database for analysis.</p>
<h2 id="scenarios" tabindex="-1">Scenarios <a class="header-anchor" href="#scenarios" aria-label="Permalink to &quot;Scenarios&quot;"></a></h2>
<p>When analyzing TiDB performance issue, TiDB slow logs are crucial for performance analysis. Normally we can analyze slow queries using <a href="https://docs.pingcap.com/tidb/v7.5/dashboard-slow-query/" target="_blank" rel="noreferrer">TiDB Dashboard</a> , which provides a graphical interface for real-time slow query analysis:</p>
<figure><img src="https://docs-download.pingcap.com/media/images/docs-cn/dashboard/dashboard-slow-queries-list1-v620.png" alt="TiDB Dashboard" tabindex="0"><figcaption>TiDB Dashboard</figcaption></figure>
<p>In the following scenarios, a more flexible analysis approach is needed:</p>
<ul>
<li>Cannot access Dashboard</li>
<li>Cannot connect to database to query <a href="https://docs.pingcap.com/tidb/v7.5/information-schema-slow-query/#cluster_slow_query-table" target="_blank" rel="noreferrer">information_schema.cluster_slow_query</a></li>
<li>Need to analyze historical data offline</li>
<li>Need complex statistical analysis (e.g., analyzing time distribution of specific slow SQL types)</li>
</ul>
<p>The <code>tihc tools slowlog</code> command can parse slow query logs and import them into a database, enabling flexible SQL queries and statistical analysis.</p>
<h2 id="quick-start" tabindex="-1">Quick Start <a class="header-anchor" href="#quick-start" aria-label="Permalink to &quot;Quick Start&quot;"></a></h2>
<ol>
<li>Prepare TiDB Cluster</li>
</ol>
<div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --proto</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> '=https'</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --tlsv1.2</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -sSf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> https://tiup-mirrors.pingcap.com/install.sh</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> sh</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">source</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ${your_shell_profile}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tiup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> playground</span></span></code></pre>
</div><ol start="2">
<li>Locate Slow Query Logs</li>
</ol>
<div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /Downloads/tidb_slow_query-2025-03</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ll</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">total</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 821464</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">-rw-r--r--@</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> aric</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  staff</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   38140064</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  3</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 27</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 15:52</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb.log</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">-rw-r--r--@</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> aric</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  staff</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  314572718</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  3</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 26</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 00:57</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb_slow_query-2025-03-25T16-57-07.979.log</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">-rw-r--r--@</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> aric</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  staff</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   67874170</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  4</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  7</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 17:27</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb_slow_query.log</span></span></code></pre>
</div><ol start="3">
<li>Parse and Import Slow Logs</li>
</ol>
<div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tihc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tools</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> slowlog</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    --host</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 127.0.0.1:4000</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    --log-dir</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /Downloads/tidb_slow_query-2025-03</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    --pattern</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "tidb_.*.log"</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">==================================================</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Command:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> slowlog</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Status:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Success</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Duration:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 15.974513708s</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">==================================================</span></span></code></pre>
</div><ol start="4">
<li>Check Import Results</li>
</ol>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">aric@MacBook Downloads % mysql </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">--comments --host 127.0.0.1 --port 4000 -u root                         </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">mysql</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> tihc</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">mysql</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> show tables;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">--------------------+</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| Tables_in_tihc     |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">--------------------+</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| CLUSTER_SLOW_QUERY |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">--------------------+</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> row</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> in</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> sec)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">mysql</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> select</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> CLUSTER_SLOW_QUERY;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">----------+</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">----------+</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">|    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">88522</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">----------+</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> row</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> in</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> sec)</span></span></code></pre>
</div><ol start="5">
<li>Analyze Slow Queries</li>
</ol>
<p>Example: Analyzing time distribution of a specific SQL by its digest:</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    DATE_FORMAT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">Time</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'%Y-%m-%d %H:00:00'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> hour_time,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    COUNT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> frequency,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    AVG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(Query_time) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> avg_query_time,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    MAX</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(Query_time) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> max_query_time,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    MIN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">LEFT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(Query, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> query_sample</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">FROM</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> tihc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">CLUSTER_SLOW_QUERY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    Digest</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> '12aee6550cdb84e9b42b0bdafff971ed4f4917faa7509129c56a0341fc127050'</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">GROUP BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    DATE_FORMAT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">Time</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'%Y-%m-%d %H:00:00'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    hour_time </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">ASC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">---------------------+-----------+---------------------+----------------+----------------------+</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| hour_time           | frequency | avg_query_time      | max_query_time | query_sample         |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">---------------------+-----------+---------------------+----------------+----------------------+</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">18</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 21</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |        </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">19</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">4493804775789474</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">606918439</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_id,base_ |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">19</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 18</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |         </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |          </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">32581528</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">338701305</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_id,base_ |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">19</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 21</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |         </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |        </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">3377161814</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |     </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">34657984</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_id,base_ |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 02</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |         </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |          </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">33664294</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">355553451</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_id,base_ |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 13</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |         </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |         </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">314235047</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">314235047</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_id,base_ |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 18</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |         </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |          </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">47384816</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |     </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">47384816</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_id,base_ |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 23</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |         </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |         </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">344667988</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">360696473</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_id,base_ |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">22</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 15</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |         </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |         </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">325766261</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">325766261</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_id,base_ |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">22</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 19</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |         </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |         </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">364963524</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">364963524</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_id,base_ |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">24</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 11</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |         </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">35267484299999996</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">387675187</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_id,base_ |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">25</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 15</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |         </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">5252397500000001</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">550156766</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_id,base_ |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">26</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |         </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |         </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">303821168</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">303821168</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_id,base_ |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">26</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 15</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |        </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">19</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">3894580074210525</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">486571348</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_id,base_ |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">26</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 16</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |        </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">12</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">6510478335833334</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">736003024</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_id,base_ |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">26</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 17</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |        </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">24</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">7259553074999999</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">322673489</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_id,base_ |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">26</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 18</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |        </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">22</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">9133352314545455</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">009928439</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_id,base_ |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">26</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 19</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |        </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">12</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">35154566491666667</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">505610509</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_id,base_ |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">26</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |         </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">9</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">3434320862222227</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">374194282</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_id,base_ |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">26</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 21</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |        </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">96</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">9793197923125003</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">519375406</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_id,base_ |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">26</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 23</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |        </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">39</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">4582763911025642</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">269301483</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_id,base_ |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">27</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |        </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">34</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">8496621455294118</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">047704387</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_id,base_ |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">27</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 01</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |        </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">16</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |     </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">8533504235625</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">043561618</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_id,base_ |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">27</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 02</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |        </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">13</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">5850548099230768</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |      </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">6326255</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_id,base_ |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">27</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 03</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |        </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">40</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">6741900960500005</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">825635187</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_id,base_ |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">27</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 05</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |        </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">29</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">4251187663793108</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">882324567</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_id,base_ |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">27</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 06</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |        </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">12</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">5653918619166668</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">602165939</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_id,base_ |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">27</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 07</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |        </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">25</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">8880253696799998</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">409791623</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_id,base_ |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">27</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 13</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |        </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">12</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">6974716397499999</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">749698881</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_id,base_ |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">27</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 14</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |        </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">15</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">8890294175333332</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">939996461</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_id,base_ |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">27</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 15</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |        </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">54</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">9239673954629628</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">684070904</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_id,base_ |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">---------------------+-----------+---------------------+----------------+----------------------+</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">30</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> rows</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> in</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">09</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> sec)</span></span></code></pre>
</div><h2 id="main-options" tabindex="-1">Main Options <a class="header-anchor" href="#main-options" aria-label="Permalink to &quot;Main Options&quot;"></a></h2>
<table tabindex="0">
<thead>
<tr>
<th>Option</th>
<th>Description</th>
<th>Default Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-a, --host &lt;HOST:PORT&gt;</code></td>
<td>TiDB server address (e.g., 127.0.0.1:4000)</td>
<td>-</td>
</tr>
<tr>
<td><code>-b, --batch-size &lt;BATCH_SIZE&gt;</code></td>
<td>Number of records to process in each batch</td>
<td>64</td>
</tr>
<tr>
<td><code>-d, --database &lt;DATABASE&gt;</code></td>
<td>Target database name for importing slow query data</td>
<td>tihc</td>
</tr>
<tr>
<td><code>-D, --log-dir &lt;DIR&gt;</code></td>
<td>Directory containing TiDB slow query log files</td>
<td>-</td>
</tr>
<tr>
<td><code>-p, --password &lt;PASSWORD&gt;</code></td>
<td>TiDB password</td>
<td>&quot;&quot;</td>
</tr>
<tr>
<td><code>-u, --user &lt;USER&gt;</code></td>
<td>TiDB username</td>
<td>root</td>
</tr>
<tr>
<td><code>-t, --pattern &lt;PATTERN&gt;</code></td>
<td>Slow query log filename pattern (e.g., &quot;tidb-slow*.log&quot;)</td>
<td>-</td>
</tr>
<tr>
<td><code>--timezone &lt;TIMEZONE&gt;</code></td>
<td>Your timezone (e.g., UTC+8) for correct timestamp parsing</td>
<td>UTC</td>
</tr>
<tr>
<td><code>-l, --log-file &lt;LOG_FILE&gt;</code></td>
<td>Log file path</td>
<td>tihc_started_at_*.log</td>
</tr>
<tr>
<td><code>-L, --log-level &lt;LOG_LEVEL&gt;</code></td>
<td>Log level (trace/debug/info/warn/error)</td>
<td>info</td>
</tr>
</tbody>
</table>
<h2 id="cluster-slow-query" tabindex="-1">CLUSTER_SLOW_QUERY <a class="header-anchor" href="#cluster-slow-query" aria-label="Permalink to &quot;CLUSTER_SLOW_QUERY&quot;"></a></h2>
<p>The tihc.CLUSTER_SLOW_QUERY table corresponds to TiDB slow query log fields, <strong>except for the INSTANCE field which is not recorded in slow logs</strong>.</p>
<p>For more information, refer to:</p>
<ol>
<li><a href="https://docs.pingcap.com/tidb/v7.5/identify-slow-queries" target="_blank" rel="noreferrer">TiDB Slow Query Log</a></li>
<li><a href="https://docs.pingcap.com/tidb/stable/information-schema-slow-query/#cluster_slow_query-table" target="_blank" rel="noreferrer">CLUSTER_SLOW_QUERY Table</a></li>
</ol>
]]></content:encoded>
            <enclosure url="https://docs-download.pingcap.com/media/images/docs-cn/dashboard/dashboard-slow-queries-list1-v620.png" length="0" type="image/png"/>
        </item>
        <item>
            <title><![CDATA[scernario the way we are]]></title>
            <link>https://askaric.com/en/work/english/01waystage_english/1-1scernario_thewayweare.html</link>
            <guid>https://askaric.com/en/work/english/01waystage_english/1-1scernario_thewayweare.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[First of all

1. Talk about people's behavior using manner adverbs and adjectives  
2. Describe p]]></description>
            <content:encoded><![CDATA[<h1 id="scernario-the-way-we-are" tabindex="-1">scernario the way we are <a class="header-anchor" href="#scernario-the-way-we-are" aria-label="Permalink to &quot;scernario the way we are&quot;"></a></h1>
<h2 id="first-of-all" tabindex="-1">First of all <a class="header-anchor" href="#first-of-all" aria-label="Permalink to &quot;First of all&quot;"></a></h2>
<ol>
<li>Talk about people's behavior using manner adverbs and adjectives</li>
<li>Describe people's personalities using adverbs before adjectives</li>
<li>Use always with a countinuous verb to describe habits</li>
<li>Use at least to point out the positive side of a situation</li>
</ol>
<h2 id="about-grammar" tabindex="-1">About grammar <a class="header-anchor" href="#about-grammar" aria-label="Permalink to &quot;About grammar&quot;"></a></h2>
<ol>
<li>
<p>Adjective + noun<br>
a. It's a patient person.</p>
</li>
<li>
<p>Verb + manner adverb<br>
a. I wait patiently in lines.</p>
</li>
<li>
<p>Regularly adverbs<br>
a. Patient --&gt; patiently.</p>
</li>
<li>
<p>Irrgular adverbs<br>
a. good --&gt; well<br>
b. late --&gt; late<br>
c. fast --&gt; hard<br>
d. hard --&gt; hard</p>
</li>
<li>
<p>be, feel, get, etc + adjective<br>
a. I'm patient<br>
b. His voice sounds terrible.<br>
c. He gets reckless sometimes.</p>
</li>
</ol>
<h2 id="about-content" tabindex="-1">About content <a class="header-anchor" href="#about-content" aria-label="Permalink to &quot;About content&quot;"></a></h2>
<h2 id="new-words" tabindex="-1">New words <a class="header-anchor" href="#new-words" aria-label="Permalink to &quot;New words&quot;"></a></h2>
<ol>
<li>reckless</li>
<li>considerate</li>
<li>impeccable</li>
</ol>
<h2 id="new-phrases" tabindex="-1">New Phrases <a class="header-anchor" href="#new-phrases" aria-label="Permalink to &quot;New Phrases&quot;"></a></h2>
<ol>
<li>honk your horn</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Scenario of experiences]]></title>
            <link>https://askaric.com/en/work/english/01waystage_english/1-2scenario_experiences.html</link>
            <guid>https://askaric.com/en/work/english/01waystage_english/1-2scenario_experiences.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[First of all

1. Talk about experiences and secret dreams using the present perfect.
2. Ask about]]></description>
            <content:encoded><![CDATA[<h1 id="scenario-of-experiences" tabindex="-1">Scenario of experiences <a class="header-anchor" href="#scenario-of-experiences" aria-label="Permalink to &quot;Scenario of experiences&quot;"></a></h1>
<h2 id="first-of-all" tabindex="-1">First of all <a class="header-anchor" href="#first-of-all" aria-label="Permalink to &quot;First of all&quot;"></a></h2>
<ol>
<li>Talk about experiences and secret dreams using the present perfect.</li>
<li>Ask about unusual expersionces using present perfect questions.</li>
<li>keep a conversation going.</li>
<li>Use Do you? Have you? etc to show interest.</li>
</ol>
<h2 id="about-grammar" tabindex="-1">About grammar <a class="header-anchor" href="#about-grammar" aria-label="Permalink to &quot;About grammar&quot;"></a></h2>
<ol>
<li>
<p>Use the present perfect for events at an indefinite time before now.
a. I've been to Europe.<br>
b. We've had a lot of fun.</p>
</li>
<li>
<p>The present perfect is often used with these frequency expressions.
a. I've always wanted to study acting.
b. We've gone sailing once/twice/many times.</p>
</li>
<li>
<p>Notice how people use been and gone to talk about travel destinations.
a. I've been to paris.
b. She's gone to Paris.</p>
</li>
<li>
<p>Use the simple past for sepcific events or times in the past.
a. Did you have good time? --&gt; Yes, I did, but I fell off the raft.</p>
</li>
</ol>
<h2 id="about-content" tabindex="-1">About content <a class="header-anchor" href="#about-content" aria-label="Permalink to &quot;About content&quot;"></a></h2>
<h2 id="new-words" tabindex="-1">New words <a class="header-anchor" href="#new-words" aria-label="Permalink to &quot;New words&quot;"></a></h2>
<ol>
<li>raft</li>
</ol>
<h2 id="new-phrases" tabindex="-1">New Phrases <a class="header-anchor" href="#new-phrases" aria-label="Permalink to &quot;New Phrases&quot;"></a></h2>
<ol>
<li>fell off</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Scenario of managing life]]></title>
            <link>https://askaric.com/en/work/english/01waystage_english/1-3scenario_managinglife.html</link>
            <guid>https://askaric.com/en/work/english/01waystage_english/1-3scenario_managinglife.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[Scenario of managing life

 First of all

1. Talk about future plans and schedulers using will, ]]></description>
            <content:encoded><![CDATA[<h1 id="scenario-of-managing-life" tabindex="-1">Scenario of managing life <a class="header-anchor" href="#scenario-of-managing-life" aria-label="Permalink to &quot;Scenario of managing life&quot;"></a></h1>
<h2 id="first-of-all" tabindex="-1">First of all <a class="header-anchor" href="#first-of-all" aria-label="Permalink to &quot;First of all&quot;"></a></h2>
<ol>
<li>Talk about future plans and schedulers using will, be going tom the present continuous, and the simple present</li>
<li>Discuss problems and solutions using ought to, have got to, would rather, had better, tec</li>
<li>Use expressions like I'd better go to end phone conversations</li>
<li>Use expressions like call you later to say good-bye</li>
</ol>
<h2 id="about-grammar" tabindex="-1">About grammar <a class="header-anchor" href="#about-grammar" aria-label="Permalink to &quot;About grammar&quot;"></a></h2>
<ol>
<li>
<p>Use will when you decide to do something as you are speaking.
a. I'll just stop by my apartment to get changed and then i'll come right over to meet you.</p>
</li>
<li>
<p>Use will or be going to for factual information or predications based on what you know.
a. You're goning to out of town, bu you'll be back Friday?</p>
</li>
<li>
<p>Use the present continous or <code>be going to(not will)</code> for decisions you've made and fixed plans.
a. I'm meeting Anna after my kickboaxing class.</p>
</li>
<li>
<p>Use the simple present for schedulers.
a. I have my kickboxing class tomorrow, It stats at 7:00.</p>
</li>
<li>
<p>What's advisable.  You'd better do something quickly.</p>
</li>
<li>
<p>What's nessary. I'm going to have to do something about it.</p>
</li>
<li>
<p>What's preferable. I'd rather stay in my current job.</p>
</li>
<li>
<p>In friently or informal phone conversations, you can use shaort expressions like these to say goo-bye or dropped.
a. Talk to you later
b. Catch you later
c. See you later
d. Got to go<br>
e. better go
f. nice talking to you</p>
</li>
</ol>
<h2 id="about-content" tabindex="-1">About content <a class="header-anchor" href="#about-content" aria-label="Permalink to &quot;About content&quot;"></a></h2>
<h2 id="new-words" tabindex="-1">New words <a class="header-anchor" href="#new-words" aria-label="Permalink to &quot;New words&quot;"></a></h2>
<ol>
<li>parentheses</li>
</ol>
<h2 id="new-phrases" tabindex="-1">New Phrases <a class="header-anchor" href="#new-phrases" aria-label="Permalink to &quot;New Phrases&quot;"></a></h2>
<ol>
<li>come right over to do</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[First of all]]></title>
            <link>https://askaric.com/en/work/english/01waystage_english/1-4scenario_techsavvy.html</link>
            <guid>https://askaric.com/en/work/english/01waystage_english/1-4scenario_techsavvy.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[First of all
1. Talk about problems with technology using quesitons within sentences.   
2. Descri]]></description>
            <content:encoded><![CDATA[<h2 id="first-of-all" tabindex="-1">First of all <a class="header-anchor" href="#first-of-all" aria-label="Permalink to &quot;First of all&quot;"></a></h2>
<ol>
<li>Talk about problems with technology using quesitons within sentences.</li>
<li>Describe how things work using separable phrasal verbs like turn on an plug in.</li>
<li>Ask for help with technology using how to + verb, where to + verb, etc.</li>
<li>Give different opinions with expressions like on the other hand.</li>
<li>Use you know what i mean? to ask someone to agree with you.</li>
</ol>
<h2 id="about-grammar" tabindex="-1">About grammar <a class="header-anchor" href="#about-grammar" aria-label="Permalink to &quot;About grammar&quot;"></a></h2>
<ol>
<li>
<p>Direct questions<br>
a. What's the problem?</p>
</li>
<li>
<p>Questions within questions<br>
a. Do you know what the problem is?</p>
</li>
<li>
<p>Question within statments<br>
a. I don;t know what the problem is.</p>
</li>
<li>
<p>Separable phrasal verbs with objects<br>
a. How do you turn on the game controller?</p>
</li>
<li>
<p>Question word + to + verb<br>
a. Let me show you what to do<br>
b. Can you show me how to turn it on?<br>
c. Do you know where to plug it in?</p>
</li>
</ol>
<h2 id="about-content" tabindex="-1">About content <a class="header-anchor" href="#about-content" aria-label="Permalink to &quot;About content&quot;"></a></h2>
<h2 id="new-words" tabindex="-1">New words <a class="header-anchor" href="#new-words" aria-label="Permalink to &quot;New words&quot;"></a></h2>
<ol>
<li>antivirus</li>
<li>separable</li>
<li>phrasal</li>
</ol>
<h2 id="new-phrases" tabindex="-1">New Phrases <a class="header-anchor" href="#new-phrases" aria-label="Permalink to &quot;New Phrases&quot;"></a></h2>
<ol>
<li>hook it up</li>
<li>look it up</li>
<li>pick it up</li>
<li>put it down</li>
<li>print it out</li>
<li>put them on</li>
<li>take them off</li>
<li>take it apart</li>
<li>throw it away</li>
<li>turn it down</li>
<li>turn it up</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[First of all]]></title>
            <link>https://askaric.com/en/work/english/01waystage_english/1-5scenario_impressions.html</link>
            <guid>https://askaric.com/en/work/english/01waystage_english/1-5scenario_impressions.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[First of all
1. Sepculate using must, may, might, can;t, and could. 
2. Describe situations and fe]]></description>
            <content:encoded><![CDATA[<h2 id="first-of-all" tabindex="-1">First of all <a class="header-anchor" href="#first-of-all" aria-label="Permalink to &quot;First of all&quot;"></a></h2>
<ol>
<li>Sepculate using must, may, might, can;t, and could.</li>
<li>Describe situations and feeling with adjectives ending in ing and ed.</li>
<li>Show you understand another person;s deeling or situation.</li>
<li>Use you see to explain a sitatusion and I see to show you understand.</li>
</ol>
<h2 id="about-grammar" tabindex="-1">About grammar <a class="header-anchor" href="#about-grammar" aria-label="Permalink to &quot;About grammar&quot;"></a></h2>
<ol>
<li>Here's an table describing possibilities of different words.</li>
</ol>
<table tabindex="0">
<thead>
<tr>
<th>modal verb</th>
<th>possibility</th>
</tr>
</thead>
<tbody>
<tr>
<td>must</td>
<td>100%</td>
</tr>
<tr>
<td>bet</td>
<td>100%</td>
</tr>
<tr>
<td>can</td>
<td>80%</td>
</tr>
<tr>
<td>may</td>
<td>50%</td>
</tr>
<tr>
<td>could</td>
<td>50%</td>
</tr>
<tr>
<td>might</td>
<td>30%</td>
</tr>
</tbody>
</table>
<ol start="2">
<li>
<p>Adjectives ending in -ed can describe how you feel about someone or something.<br>
a. I'm bored with my job.<br>
b. That means I am feeling bored when doing my job.</p>
</li>
<li>
<p>Adjectives ending in -ing can describe someone or something.<br>
a. My job is very boring.<br>
b. That means  I think job is boring.</p>
</li>
</ol>
<h2 id="about-content" tabindex="-1">About content <a class="header-anchor" href="#about-content" aria-label="Permalink to &quot;About content&quot;"></a></h2>
<h2 id="new-words" tabindex="-1">New words <a class="header-anchor" href="#new-words" aria-label="Permalink to &quot;New words&quot;"></a></h2>
<ol>
<li>fascinated</li>
<li>embarrassed</li>
<li>annoyed</li>
<li>frustrating</li>
<li>shocked</li>
<li>anxious</li>
<li>spill</li>
<li>jealous</li>
</ol>
<h2 id="new-phrases" tabindex="-1">New Phrases <a class="header-anchor" href="#new-phrases" aria-label="Permalink to &quot;New Phrases&quot;"></a></h2>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Scenario of law and order]]></title>
            <link>https://askaric.com/en/work/english/02threshold_english/2-10scenario_lawandorder.html</link>
            <guid>https://askaric.com/en/work/english/02threshold_english/2-10scenario_lawandorder.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[First of all

1. Talk about the legal age for activities using the passive of modal verbs.  
2. T]]></description>
            <content:encoded><![CDATA[<h1 id="scenario-of-law-and-order" tabindex="-1">Scenario of law and order <a class="header-anchor" href="#scenario-of-law-and-order" aria-label="Permalink to &quot;Scenario of law and order&quot;"></a></h1>
<h2 id="first-of-all" tabindex="-1">First of all <a class="header-anchor" href="#first-of-all" aria-label="Permalink to &quot;First of all&quot;"></a></h2>
<ol>
<li>Talk about the legal age for activities using the passive of modal verbs.</li>
<li>Tablk about crime and punishment using the get passive.</li>
<li>Organize your views with <code>First of all</code>, etc.</li>
<li>Show someone has a valid argument with expressions like <code>That's a good point.</code> .</li>
</ol>
<h2 id="about-grammar" tabindex="-1">About grammar <a class="header-anchor" href="#about-grammar" aria-label="Permalink to &quot;About grammar&quot;"></a></h2>
<ol>
<li>
<p>The passive of modal verbs for the present is modal verb + be + past participle.
a. R-rated movies should be banned.
b. The law ought to be changed.</p>
</li>
<li>
<p>THe passive is usaually formed with be, but sometimes you can use get.<br>
a. Like : people who speed don't usually get arrested.</p>
</li>
<li>
<p>After should, the be passive is more common.<br>
a. People who speed should be arrested if they cause an accident.</p>
</li>
<li>
<p>Notice : Use catch + person + verb + ing.
a. Like : What happens if they catch you shoplifting.</p>
</li>
<li>
<p>Orgnization ideas
a. Well,Basically ... The point/thing is ...
b. Adding ideas : Another thing is ...
c. Introducing a list : There are two problems ... or ... for a couple of reasons.
d. Ordinal numbers : First of all, Second of all, ...<br>
e. Numbers or letters : One, Two, ... or A, B, ...</p>
</li>
</ol>
<h2 id="about-content" tabindex="-1">About content <a class="header-anchor" href="#about-content" aria-label="Permalink to &quot;About content&quot;"></a></h2>
<h2 id="new-words" tabindex="-1">New words <a class="header-anchor" href="#new-words" aria-label="Permalink to &quot;New words&quot;"></a></h2>
<ol>
<li>penalty</li>
<li>jaywalking</li>
<li>vandals</li>
<li>kidnapping</li>
<li>robbing</li>
<li>shoplifting</li>
<li>convicted of burglary</li>
<li>graffiti</li>
<li>murderer</li>
<li>knife</li>
</ol>
<h2 id="new-phrases" tabindex="-1">New Phrases <a class="header-anchor" href="#new-phrases" aria-label="Permalink to &quot;New Phrases&quot;"></a></h2>
<ol>
<li>catch someone doing</li>
<li>convict of(get sentenced to)</li>
<li>life in prison</li>
<li>lose your license</li>
<li>against the law</li>
<li>get enforced</li>
<li>put on probation</li>
<li>take someone captive</li>
<li>go to jail</li>
<li>get arrested</li>
<li>for a couple of reasons</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Scenario of strange events]]></title>
            <link>https://askaric.com/en/work/english/02threshold_english/2-11scenario_strangeevents.html</link>
            <guid>https://askaric.com/en/work/english/02threshold_english/2-11scenario_strangeevents.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[First of all

1. Talk about conincedences using the past perfect.
2. Talk about supersitions.
3.]]></description>
            <content:encoded><![CDATA[<h1 id="scenario-of-strange-events" tabindex="-1">Scenario of strange events <a class="header-anchor" href="#scenario-of-strange-events" aria-label="Permalink to &quot;Scenario of strange events&quot;"></a></h1>
<h2 id="first-of-all" tabindex="-1">First of all <a class="header-anchor" href="#first-of-all" aria-label="Permalink to &quot;First of all&quot;"></a></h2>
<ol>
<li>Talk about conincedences using the past perfect.</li>
<li>Talk about supersitions.</li>
<li>SHow things in common in responses with So and Neither.</li>
<li>Repeat ideas to make your meaning clear.</li>
</ol>
<h2 id="about-grammar" tabindex="-1">About grammar <a class="header-anchor" href="#about-grammar" aria-label="Permalink to &quot;About grammar&quot;"></a></h2>
<ol>
<li>
<p>Use the past perfect to talk about things that happened before and event in the past.
a. I had set up my camp and was cooking, and this van appeared out of nowhere.
b. From sentences above, we could know that i seted up my camp happened before something about van.</p>
</li>
<li>
<p>The past perfect is often used to give explanations or resaons why things happended.
a. It was nice to have company beacuse i hadn't spoken to anyone in days.</p>
</li>
<li>
<p>Responses with So and Neither
a. Present of be : I'm hungary --&gt; So am I
b. SImple present : I wlk around ladders --&gt; So do I<br>
c. Simple past : I knew that --&gt; So did I</p>
</li>
</ol>
<h2 id="about-content" tabindex="-1">About content <a class="header-anchor" href="#about-content" aria-label="Permalink to &quot;About content&quot;"></a></h2>
<h2 id="new-words" tabindex="-1">New words <a class="header-anchor" href="#new-words" aria-label="Permalink to &quot;New words&quot;"></a></h2>
<ol>
<li>scary</li>
<li>husband-to-be</li>
<li>coincidence</li>
<li>deja vu</li>
<li>telepathy</li>
</ol>
<h2 id="new-phrases" tabindex="-1">New Phrases <a class="header-anchor" href="#new-phrases" aria-label="Permalink to &quot;New Phrases&quot;"></a></h2>
<ol>
<li>call out of the blue</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Scenario of fame]]></title>
            <link>https://askaric.com/en/work/english/02threshold_english/2-12scenario_fame.html</link>
            <guid>https://askaric.com/en/work/english/02threshold_english/2-12scenario_fame.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[First of all

1. Talk about celebrities's rise to fame  
2. Use if clauses to say how things migh]]></description>
            <content:encoded><![CDATA[<h1 id="scenario-of-fame" tabindex="-1">Scenario of fame <a class="header-anchor" href="#scenario-of-fame" aria-label="Permalink to &quot;Scenario of fame&quot;"></a></h1>
<h2 id="first-of-all" tabindex="-1">First of all <a class="header-anchor" href="#first-of-all" aria-label="Permalink to &quot;First of all&quot;"></a></h2>
<ol>
<li>Talk about celebrities's rise to fame</li>
<li>Use if clauses to say how things might have been different</li>
<li>Talk about achiveing and losing fame</li>
<li>Use tag questions to give opinions or check information</li>
<li>Use tag questions to soften advice and give encouragement</li>
<li>Answer difficult questions with expressions like It's har to say</li>
</ol>
<h2 id="about-grammar" tabindex="-1">About grammar <a class="header-anchor" href="#about-grammar" aria-label="Permalink to &quot;About grammar&quot;"></a></h2>
<ol>
<li>
<p>You can use sentences with if to talk hypothetically about past. And, use the past perfect form in the if clause and a past modal in the main clause.
a. If + past perfect,past modal would have, could have, might have, etc
b. If he hadn't won the talent contest, maybe he would've done something entirely different.</p>
</li>
<li>
<p>Hypothetical questions about the past.
a. What would've happended if he'd stayed in school?
b. Would he have become a singer?</p>
</li>
<li>
<p>Affirmative statement + negative tag.<br>
a. It's amazing, isn't it?
b. That was a dumb thing to do, wasn't it?<br>
c. She won the talent show, didn't she?
d. he's dropped out of sight, hasn't she?</p>
</li>
<li>
<p>Negative statement + affirmative tag.
a. It's not easy to become famous, is it?<br>
b. That wasn't too smart, was it?<br>
c. She didn't have connections, did she?<br>
d. His career hasn't taken off, has it?</p>
</li>
</ol>
<h2 id="about-content" tabindex="-1">About content <a class="header-anchor" href="#about-content" aria-label="Permalink to &quot;About content&quot;"></a></h2>
<h2 id="new-words" tabindex="-1">New words <a class="header-anchor" href="#new-words" aria-label="Permalink to &quot;New words&quot;"></a></h2>
<ol>
<li>hypothetically</li>
<li>affirmative</li>
<li>up-and-coming</li>
<li>in the headlines</li>
<li>making headlines</li>
</ol>
<h2 id="new-phrases" tabindex="-1">New Phrases <a class="header-anchor" href="#new-phrases" aria-label="Permalink to &quot;New Phrases&quot;"></a></h2>
<ol>
<li>have connections</li>
<li>get discovered</li>
<li>in the right place at the right time</li>
<li>drop out of sight</li>
<li>get bad press</li>
<li>go downhill</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Scenario of lives]]></title>
            <link>https://askaric.com/en/work/english/02threshold_english/2-1scenario_lives.html</link>
            <guid>https://askaric.com/en/work/english/02threshold_english/2-1scenario_lives.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[First of all

This topic will teach me something below :

1. how to use simple and continuous ve]]></description>
            <content:encoded><![CDATA[<h1 id="scenario-of-lives" tabindex="-1">Scenario of lives <a class="header-anchor" href="#scenario-of-lives" aria-label="Permalink to &quot;Scenario of lives&quot;"></a></h1>
<h2 id="first-of-all" tabindex="-1">First of all <a class="header-anchor" href="#first-of-all" aria-label="Permalink to &quot;First of all&quot;"></a></h2>
<p>This topic will teach me something below :</p>
<ol>
<li>how to use simple and continuous vers to get to classmates.</li>
<li>Tell life story using <code>verb + ing</code> or <code>to + verb</code>.</li>
<li>Highlight key moments in a story with the present tense.</li>
<li>Use <code>this/these</code> to highlight info.</li>
</ol>
<h2 id="about-grammar" tabindex="-1">About grammar <a class="header-anchor" href="#about-grammar" aria-label="Permalink to &quot;About grammar&quot;"></a></h2>
<ol>
<li>
<p>Simple verbs are for <code>complete actions</code> or <code>permanent actions</code>:
a. Present : what kind of music do you listen to? I love jazz and blue music. I listen to it a lot.<br>
b. Present perfect : Have you ever lived in another country? No, I've never lived anywhere else.
c. Past : what did you do for your last brithday? I went to home and had a big party.</p>
</li>
<li>
<p>Countinuous verbs are for <code>ongoing actions</code> or <code>temporary situations</code>:<br>
a. Present : what kind of music are you listening to currently? I'm listening to a lot of Latin right now.
b. Present perfect : How long have you been living here? I've been living here for five years.<br>
c. Past : What were you doing at ths time yesterday? I was sitting on bus.</p>
</li>
<li>
<p>Fixed comparing expressions :
a. <code>Verb + verb + ing</code>
b. <code>Verb + particle/preposition + verb + ing</code>
c. <code>Verb + to + verb</code>
d. <code>Verb + ing</code> or <code>to verb</code> with the same meaning<br>
e. <code>Verb + ing</code> or <code>to verb</code> with a different meaning</p>
</li>
</ol>
<h2 id="about-content" tabindex="-1">About content <a class="header-anchor" href="#about-content" aria-label="Permalink to &quot;About content&quot;"></a></h2>
<h2 id="new-words" tabindex="-1">New words <a class="header-anchor" href="#new-words" aria-label="Permalink to &quot;New words&quot;"></a></h2>
<h2 id="new-phrases" tabindex="-1">New Phrases <a class="header-anchor" href="#new-phrases" aria-label="Permalink to &quot;New Phrases&quot;"></a></h2>
<ol>
<li>we walked off the trail.</li>
<li>consider doing</li>
<li>finish doing</li>
<li>imagine doing</li>
<li>miss doing</li>
<li>mind doing</li>
<li>spend(time) doing</li>
<li>end up doing</li>
<li>deep on doiong</li>
<li>think about doing</li>
<li>plan on doing</li>
<li>decide to do</li>
<li>hapen to do</li>
<li>offer to do</li>
<li>seem to do</li>
<li>intend to do</li>
<li>expect to do</li>
<li>begin doing/to do</li>
<li>bother to do/doing</li>
<li>continue to do/doing</li>
<li>start to do/doing</li>
<li>like doing/to do</li>
<li>love to do/love doing</li>
<li>hate to do/doing</li>
<li>remember to do</li>
<li>remember doing</li>
<li>stop to do</li>
<li>stop doing</li>
<li>try doing</li>
<li>try to do</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Scenario of socializing]]></title>
            <link>https://askaric.com/en/work/english/02threshold_english/2-2scenario_socializing.html</link>
            <guid>https://askaric.com/en/work/english/02threshold_english/2-2scenario_socializing.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[First of all

This topic will tablk about something below :

1. say what should happen with be s]]></description>
            <content:encoded><![CDATA[<h1 id="scenario-of-socializing" tabindex="-1">Scenario of socializing <a class="header-anchor" href="#scenario-of-socializing" aria-label="Permalink to &quot;Scenario of socializing&quot;"></a></h1>
<h2 id="first-of-all" tabindex="-1">First of all <a class="header-anchor" href="#first-of-all" aria-label="Permalink to &quot;First of all&quot;"></a></h2>
<p>This topic will tablk about something below :</p>
<ol>
<li>say what should happen with be supposed to</li>
<li>talk about weekend plans useing was/were going to</li>
<li>talk about going out and formal events using get expressions</li>
<li>use so to start or close topics, pause, or check understanding</li>
</ol>
<h2 id="about-grammar" tabindex="-1">About grammar <a class="header-anchor" href="#about-grammar" aria-label="Permalink to &quot;About grammar&quot;"></a></h2>
<ol>
<li><code>be supposed to</code> can mean <code>They say</code>, <code>have to</code> and <code>should</code>
a. it's supposed to be a barbecue.</li>
<li><code>be supposed to</code> can also mean ``have to<code>and</code>should`
a. I'm supposed to eat chocalate.</li>
<li>It can contrast with waht should happen with what does or will happen.
a. I'm supposed to stay out late(but I guess I will).</li>
<li>with the verbs, the object always comes after the particle or preposition<br>
a. Verb + particle + object, like : I'm not sure she'll get over it.
b. Verb + particle + preposition + object, like : Can I get away with wearing pants?</li>
</ol>
<h2 id="about-content" tabindex="-1">About content <a class="header-anchor" href="#about-content" aria-label="Permalink to &quot;About content&quot;"></a></h2>
<p>We can use <code>So</code> in many ways, including :</p>
<ol>
<li>To start a topic, often with a question. Like : So, there's another work party on Friday.</li>
<li>To check your understanding. Like : So perties aren't your things.</li>
<li>To pause or let the other person draw a conclusion. Like : I'd rather talk one on one, So ...</li>
<li>To close a topic. Like So, yeah. I'l just say I have other plans.</li>
</ol>
<h2 id="new-words" tabindex="-1">New words <a class="header-anchor" href="#new-words" aria-label="Permalink to &quot;New words&quot;"></a></h2>
<ol>
<li>get out of</li>
<li>get off</li>
<li>get over</li>
<li>get going</li>
<li>get away with</li>
<li>get used to doing</li>
<li>get home</li>
<li>get the feeling</li>
<li>get through</li>
<li>get to know</li>
<li>get around to</li>
</ol>
<h2 id="new-phrases" tabindex="-1">New Phrases <a class="header-anchor" href="#new-phrases" aria-label="Permalink to &quot;New Phrases&quot;"></a></h2>
<ol>
<li>I don't get it.</li>
<li>I'm one of people who ...</li>
<li>When I go out, I always ...</li>
<li>If I'm late for something, I usually ...</li>
<li>If a friend cancels plans we made, ...</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Scenario of material world]]></title>
            <link>https://askaric.com/en/work/english/02threshold_english/2-3scenario_materialworld.html</link>
            <guid>https://askaric.com/en/work/english/02threshold_english/2-3scenario_materialworld.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[First of all

This tpoic will talk about something below :

1. Talk about possessions.
2. Repor]]></description>
            <content:encoded><![CDATA[<h1 id="scenario-of-material-world" tabindex="-1">Scenario of material world <a class="header-anchor" href="#scenario-of-material-world" aria-label="Permalink to &quot;Scenario of material world&quot;"></a></h1>
<h2 id="first-of-all" tabindex="-1">First of all <a class="header-anchor" href="#first-of-all" aria-label="Permalink to &quot;First of all&quot;"></a></h2>
<p>This tpoic will talk about something below :</p>
<ol>
<li>Talk about possessions.</li>
<li>Report things that people said.</li>
<li>Disscuss money mangement</li>
</ol>
<h2 id="about-grammar" tabindex="-1">About grammar <a class="header-anchor" href="#about-grammar" aria-label="Permalink to &quot;About grammar&quot;"></a></h2>
<ol>
<li>When you report the things people said, the tense often &quot;shifts back&quot;
a. direct speech : My goal is to destroy all my prosessions.<br>
b. report speech : His goal was to destroy all his prosessions.<br>
c. direct speech : I haven't found the right shopping center.<br>
d. report speech : He hadn't found the right shopping center.</li>
</ol>
<h2 id="about-content" tabindex="-1">About content <a class="header-anchor" href="#about-content" aria-label="Permalink to &quot;About content&quot;"></a></h2>
<h2 id="new-words" tabindex="-1">New words <a class="header-anchor" href="#new-words" aria-label="Permalink to &quot;New words&quot;"></a></h2>
<ol>
<li>possession</li>
<li>debt</li>
</ol>
<h2 id="new-phrases" tabindex="-1">New Phrases <a class="header-anchor" href="#new-phrases" aria-label="Permalink to &quot;New Phrases&quot;"></a></h2>
<ol>
<li>make a credit card/a budget/ a living/ ends meet</li>
<li>apply for a job/ a credit card/ a bill</li>
<li>open a saving account/ a restaurant/ a debt</li>
<li>pay off a debt/ a budget/ a load</li>
<li>invest in loads/ bounds/ stocks</li>
<li>get out of debt</li>
<li>inverst money in</li>
<li>pay good interests</li>
<li>set aside money</li>
<li>get an allowance</li>
<li>have a budget</li>
<li>keep track of</li>
<li>pay in cash</li>
<li>take out a loan</li>
<li>take out a subscription to</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[scenario of trends]]></title>
            <link>https://askaric.com/en/work/english/02threshold_english/2-4scenario_trends.html</link>
            <guid>https://askaric.com/en/work/english/02threshold_english/2-4scenario_trends.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[First of all

somethig had been talked as below :

1. Talk about social changes using the passiv]]></description>
            <content:encoded><![CDATA[<h1 id="scenario-of-trends" tabindex="-1">scenario of trends <a class="header-anchor" href="#scenario-of-trends" aria-label="Permalink to &quot;scenario of trends&quot;"></a></h1>
<h2 id="first-of-all" tabindex="-1">First of all <a class="header-anchor" href="#first-of-all" aria-label="Permalink to &quot;First of all&quot;"></a></h2>
<p>somethig had been talked as below :</p>
<ol>
<li>Talk about social changes using the passive of the present continuous and present prefect.</li>
<li>Use expreseeions like although, because of, in order to, and instead.</li>
<li>Use expressions like As I said to refer back in a conversation.</li>
<li>Use vague expressions like <code>and so forth</code>.</li>
</ol>
<h2 id="about-grammar" tabindex="-1">About grammar <a class="header-anchor" href="#about-grammar" aria-label="Permalink to &quot;About grammar&quot;"></a></h2>
<ol>
<li>
<p>Use passive active form of verb to focus on the &quot;doer&quot; or cause of the action.
a. Companies are recruiting workers overseas.</p>
</li>
<li>
<p>Use the passive form to focus on the &quot;reveiver&quot; of the action.<br>
a. Workers are being recruited overseas.</p>
</li>
<li>
<p>Link ideas<br>
a. Contrast : Although / Even though, inspite of/ despite
b. Reason : because of / as result of / due to / so that
c. Purpose : in order to
d. Alternative : instead of</p>
</li>
</ol>
<h2 id="new-words" tabindex="-1">New words <a class="header-anchor" href="#new-words" aria-label="Permalink to &quot;New words&quot;"></a></h2>
<ol>
<li>air pollution</li>
<li>drought</li>
<li>environmentally friendly</li>
<li>a landfill</li>
<li>toxic chemicals</li>
<li>bigdegradeable</li>
<li>energy-saving</li>
<li>global warming</li>
<li>natural resources</li>
<li>water consumption</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Scenario of problem solving]]></title>
            <link>https://askaric.com/en/work/english/02threshold_english/2-5scenario_problemsolving.html</link>
            <guid>https://askaric.com/en/work/english/02threshold_english/2-5scenario_problemsolving.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[First of all

There are some something below :

1. Talk about things others do for you using get]]></description>
            <content:encoded><![CDATA[<h1 id="scenario-of-problem-solving" tabindex="-1">Scenario of problem solving <a class="header-anchor" href="#scenario-of-problem-solving" aria-label="Permalink to &quot;Scenario of problem solving&quot;"></a></h1>
<h2 id="first-of-all" tabindex="-1">First of all <a class="header-anchor" href="#first-of-all" aria-label="Permalink to &quot;First of all&quot;"></a></h2>
<p>There are some something below :</p>
<ol>
<li>Talk about things others do for you using get and have.</li>
<li>Describe household problems using need + passive infinitive or need + verb + ing.</li>
<li>Speak informally in &quot;shorter sentences&quot;.</li>
<li>Use experssions like Uh-oh and Ouch when things go wrong.</li>
</ol>
<h2 id="about-grammar" tabindex="-1">About grammar <a class="header-anchor" href="#about-grammar" aria-label="Permalink to &quot;About grammar&quot;"></a></h2>
<ol>
<li>
<p>When you want to show who you ask, you can use <code>get + someone + to + verb</code> or <code>have + someone + verb</code>.
a. I get my brother to fix my car.
b. I didn't pay to have someone repair my dishwasher.</p>
</li>
<li>
<p>When who you ask is not important, use get or have + something + past particle.<br>
a. I get my car fixed at my uncle's garage once a year.</p>
</li>
<li>
<p>You can use need to talk about things that should be done.<br>
a. need + passive infinitive. Like : The TV needs to be fixed.
b. need + verb + ing. Like : The screen needs adjusting.</p>
</li>
<li>
<p>Strategy plus
a. Ooh! = when you see a problem.<br>
b. Uh-oh! = when you suddenly discover a problem.<br>
c. Oops!/Whoops! = when you make a small mistake.<br>
d. Ow!/Ouch! = &quot;That hurt.&quot; / &quot;It sounds like that hurt&quot;.
e. Shoot! = &quot;Oh, no!&quot;(a general reaction)
f. Ugh!/Yuck! = &quot;It's disgusting.&quot;</p>
</li>
</ol>
<h2 id="new-words" tabindex="-1">New words <a class="header-anchor" href="#new-words" aria-label="Permalink to &quot;New words&quot;"></a></h2>
<ol>
<li>interior designer</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Scenario of behavior]]></title>
            <link>https://askaric.com/en/work/english/02threshold_english/2-6scenario_behavior.html</link>
            <guid>https://askaric.com/en/work/english/02threshold_english/2-6scenario_behavior.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[First of all

Here are something which will be talked below:  

1. Talk hypothetically about the]]></description>
            <content:encoded><![CDATA[<h1 id="scenario-of-behavior" tabindex="-1">Scenario of behavior <a class="header-anchor" href="#scenario-of-behavior" aria-label="Permalink to &quot;Scenario of behavior&quot;"></a></h1>
<h2 id="first-of-all" tabindex="-1">First of all <a class="header-anchor" href="#first-of-all" aria-label="Permalink to &quot;First of all&quot;"></a></h2>
<p>Here are something which will be talked below:</p>
<ol>
<li>Talk hypothetically about the past using <code>would have</code>,<code>should have</code>,<code>could have</code>.</li>
<li>Describe emotions and personal qualities.</li>
<li>Speculate about the past using <code>must have</code>, <code>may have</code>, <code>might have</code>, <code>could have</code>.</li>
</ol>
<h2 id="about-grammar" tabindex="-1">About grammar <a class="header-anchor" href="#about-grammar" aria-label="Permalink to &quot;About grammar&quot;"></a></h2>
<p>You can use would/should/could + have + past participle to talk hypothetically about the past.</p>
<ol>
<li>imageine your behavior in a situation : What would you have done? I'd have said no politely.</li>
<li>Say what was the right thing to do : What should she have done? She shouldn't have yelled at him.</li>
<li>Say waht other possiblities there were :  What else could she have done? She could have told him not to call again.</li>
<li>You could also use above grammer to speculate past things using modal verber, like :
a. must/coud/may/might + have + past participate
b. They must have gotten tied up in traffic.<br>
c. And, different modal verbs have different precent probability.</li>
</ol>
<h2 id="about-content" tabindex="-1">About content <a class="header-anchor" href="#about-content" aria-label="Permalink to &quot;About content&quot;"></a></h2>
<h2 id="new-words" tabindex="-1">New words <a class="header-anchor" href="#new-words" aria-label="Permalink to &quot;New words&quot;"></a></h2>
<ol>
<li>aggressive</li>
<li>decisive</li>
<li>impulsive</li>
<li>jealousy</li>
<li>guilty</li>
<li>ashmaed</li>
<li>depressed</li>
<li>sympathetic</li>
<li>felxible</li>
<li>honesty</li>
<li>grief</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Scenario of career]]></title>
            <link>https://askaric.com/en/work/english/02threshold_english/2-7scenario_careers.html</link>
            <guid>https://askaric.com/en/work/english/02threshold_english/2-7scenario_careers.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[First of all

You will learn things below :

1. Discuss career planning using what clasues and l]]></description>
            <content:encoded><![CDATA[<h1 id="scenario-of-career" tabindex="-1">Scenario of career <a class="header-anchor" href="#scenario-of-career" aria-label="Permalink to &quot;Scenario of career&quot;"></a></h1>
<h2 id="first-of-all" tabindex="-1">First of all <a class="header-anchor" href="#first-of-all" aria-label="Permalink to &quot;First of all&quot;"></a></h2>
<p>You will learn things below :</p>
<ol>
<li>Discuss career planning using what clasues and long noun phrases.</li>
<li>Tablk about you career plan using thre future perfect.</li>
</ol>
<h2 id="about-grammar" tabindex="-1">About grammar <a class="header-anchor" href="#about-grammar" aria-label="Permalink to &quot;About grammar&quot;"></a></h2>
<ol>
<li>
<p>This part would be used to introduce important information.
a. What you need is lots of info.(what clauses)
b. The main things you need is information.(long noun phrases)</p>
</li>
<li>
<p>I think this part is equal to verb + ing as subject. what difference is just that we could be able to use less words or clauses to describe the What or Long noun phrases and let them be abundant.</p>
</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Scenario of personal tastes]]></title>
            <link>https://askaric.com/en/work/english/02threshold_english/2-8scenario_personaltastes.html</link>
            <guid>https://askaric.com/en/work/english/02threshold_english/2-8scenario_personaltastes.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[First of all

1. Talk about fashion and makeovers.  
2. Make comparisons with(not) as ... as.  
]]></description>
            <content:encoded><![CDATA[<h1 id="scenario-of-personal-tastes" tabindex="-1">Scenario of personal tastes <a class="header-anchor" href="#scenario-of-personal-tastes" aria-label="Permalink to &quot;Scenario of personal tastes&quot;"></a></h1>
<h2 id="first-of-all" tabindex="-1">First of all <a class="header-anchor" href="#first-of-all" aria-label="Permalink to &quot;First of all&quot;"></a></h2>
<ol>
<li>Talk about fashion and makeovers.</li>
<li>Make comparisons with(not) as ... as.</li>
<li>Ask negative questions when you except someone to agree.</li>
<li>Describe clothing.</li>
<li>Show understanding by summarizing what people say.</li>
</ol>
<h2 id="about-grammar" tabindex="-1">About grammar <a class="header-anchor" href="#about-grammar" aria-label="Permalink to &quot;About grammar&quot;"></a></h2>
<ol>
<li>
<p>you can comparisons with(not) as ... as with adjectives, nouns, adverbs.
a. Adjectives : THe pants are just as comfortable as my jeans.<br>
b. Nouns : She spends as little time as posible on her makeup.<br>
c. Adverbs : I tried as hard as I could to find the right style for her.</p>
</li>
<li>
<p>When you want or expect someone to agree with you, you can use negative questions.
a. To express an opinion : Don't you think it's great? or Isn't this Jacket great?
b. To suggest an idea : Aren't they a little expensive? or It'd look good, don't you think?
c. To show suprise : Isn't it on sale? or Don't you like it?</p>
</li>
</ol>
<h2 id="about-content" tabindex="-1">About content <a class="header-anchor" href="#about-content" aria-label="Permalink to &quot;About content&quot;"></a></h2>
<ol>
<li>Notice,you can summarize the things someine has said just now. It shows she's incolcved in the conversation and is following what someone is saying.</li>
</ol>
<h2 id="new-words" tabindex="-1">New words <a class="header-anchor" href="#new-words" aria-label="Permalink to &quot;New words&quot;"></a></h2>
<ol>
<li>scruffy</li>
<li>pastel shirt</li>
<li>bright</li>
<li>neon</li>
<li>neon green</li>
<li>leather</li>
<li>encyclopedia</li>
</ol>
<h2 id="new-phrases" tabindex="-1">New Phrases <a class="header-anchor" href="#new-phrases" aria-label="Permalink to &quot;New Phrases&quot;"></a></h2>
<ol>
<li>broad tastes</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Scenario of world culture]]></title>
            <link>https://askaric.com/en/work/english/02threshold_english/2-9scenario_worldclutures.html</link>
            <guid>https://askaric.com/en/work/english/02threshold_english/2-9scenario_worldclutures.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[First of all

1. Talk about your culture using the simple present passive.
2. Talk about customs ]]></description>
            <content:encoded><![CDATA[<h1 id="scenario-of-world-culture" tabindex="-1">Scenario of world culture <a class="header-anchor" href="#scenario-of-world-culture" aria-label="Permalink to &quot;Scenario of world culture&quot;"></a></h1>
<h2 id="first-of-all" tabindex="-1">First of all <a class="header-anchor" href="#first-of-all" aria-label="Permalink to &quot;First of all&quot;"></a></h2>
<ol>
<li>Talk about your culture using the simple present passive.</li>
<li>Talk about customs and manners using verb + ing and to + verb.</li>
<li>Use expressions like <code>to be honst</code> to sound more direct.</li>
<li>Use <code>of course</code> to give information that is not surprising, or to agree.</li>
</ol>
<h2 id="about-grammar" tabindex="-1">About grammar <a class="header-anchor" href="#about-grammar" aria-label="Permalink to &quot;About grammar&quot;"></a></h2>
<ol>
<li>
<p>Use the passive when the &quot;doer&quot; of action is not known or not important.
a. Active, How do they make kimpap?  They make it with rice and vegetables.<br>
b. Passive : How is kimpap made? It's made with rice and vegetables.</p>
</li>
<li>
<p>If the &quot;doer&quot; of action is important, you can introduce it with by.
a. THe sculptures are carved by teams from all over the world.</p>
</li>
<li>
<p>Verb + ing as a subject
a. Eating in public is bad manners.</p>
</li>
<li>
<p>Verb + ing after prepositions
a. You can offend people by eating in public.</p>
</li>
<li>
<p>To + verb after It's ...<br>
a. It's bad manners to eat in public.</p>
</li>
<li>
<p>Preposition of not
a. Not comes before the word it negates. Like : be careful not to point at people.
b. That are difference meanings between <code>be careful not to</code> and <code>not becareful to</code>.</p>
</li>
<li>
<p>Of course usually means that the idea isn't suprising. It's what you expect.</p>
</li>
<li>
<p>You can also use <code>Of course</code> in responses to show you agree or understand.
a. When you are living here, do you miss your home? --&gt; Of course or I really miss my home.</p>
</li>
</ol>
<h2 id="new-words" tabindex="-1">New words <a class="header-anchor" href="#new-words" aria-label="Permalink to &quot;New words&quot;"></a></h2>
<ol>
<li>dish(foods or tools for carrying foods)</li>
<li>handicraft</li>
<li>earrings</li>
<li>tip(give a fee)</li>
<li>negates(negative)</li>
<li>concise</li>
<li>decisive</li>
</ol>
<h2 id="new-phrases" tabindex="-1">New Phrases <a class="header-anchor" href="#new-phrases" aria-label="Permalink to &quot;New Phrases&quot;"></a></h2>
<ol>
<li>carved out of</li>
<li>cut in line</li>
<li>keep your voice down</li>
<li>bowing or shaking hands</li>
<li>walk around barefoot</li>
<li>take off your shoes</li>
<li>showing affection</li>
<li>point at</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[What's basic_englihs part? ]]></title>
            <link>https://askaric.com/en/work/english/02threshold_english/</link>
            <guid>https://askaric.com/en/work/english/02threshold_english/</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[`basic_englihs` is a part which let me could talk to native speakers, though not very fluent.


]]></description>
            <content:encoded><![CDATA[<h2 id="what-s-basic-englihs-part" tabindex="-1">What's basic_englihs part? <a class="header-anchor" href="#what-s-basic-englihs-part" aria-label="Permalink to &quot;What's basic_englihs part?&quot;"></a></h2>
<p><code>basic_englihs</code> is a part which let me could talk to native speakers, though not very fluent.</p>
<h2 id="what-does-it-focus-on" tabindex="-1">What does It focus on? <a class="header-anchor" href="#what-does-it-focus-on" aria-label="Permalink to &quot;What does It focus on?&quot;"></a></h2>
<p>Actually, It'll focus on the speaking naturally, and emphasize combinding pronunciation, and phrases and new words.</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[scenario of success and happiness]]></title>
            <link>https://askaric.com/en/work/english/03vantage_english/3-10scenario_success+happiness.html</link>
            <guid>https://askaric.com/en/work/english/03vantage_english/3-10scenario_success+happiness.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[About content
1. talk about success and happiness
2. use all, both, each, every, neither, none of, n]]></description>
            <content:encoded><![CDATA[<h1 id="scenario-of-success-and-happiness" tabindex="-1">scenario of success and happiness <a class="header-anchor" href="#scenario-of-success-and-happiness" aria-label="Permalink to &quot;scenario of success and happiness&quot;"></a></h1>
<h2 id="about-content" tabindex="-1">About content <a class="header-anchor" href="#about-content" aria-label="Permalink to &quot;About content&quot;"></a></h2>
<ol>
<li>talk about success and happiness</li>
<li>use all, both, each, every, neither, none of, no</li>
<li>learn more uses of -ing forms</li>
<li>give opinions with expressions like As far as I'm concerned, ...</li>
</ol>
<h2 id="about-grammar" tabindex="-1">About grammar <a class="header-anchor" href="#about-grammar" aria-label="Permalink to &quot;About grammar&quot;"></a></h2>
<ol>
<li>
<p>Singular nouns<br>
a. each entrepreneur was successful.<br>
b. Every restaurant rejected the recipe.<br>
c. No entrepreneur wants to fail.<br>
d. No restaurant accepted the recipe.</p>
</li>
<li>
<p>Both(= two)<br>
a. Both products got off to a good start.<br>
b. Both (of) these men become billionaires.<br>
c. Neither product was a success as first.<br>
d. Neither of the men let failure get them down.</p>
</li>
<li>
<p>Plural nouns<br>
a. All successful people have vision.<br>
b. All (of) these people were successful.<br>
c. No successful people get ahead easily.<br>
d. None of these people graduated from college.</p>
</li>
<li>
<p>Uncountable nouns<br>
a. All(of) their hard work paid off.<br>
b. None of their hard work was wasted.</p>
</li>
<li>
<p>You can use the passive to make the receiver of an action the focus<br>
a. Experts expect the population to rise.<br>
b. the population is expected to rise.</p>
</li>
<li>
<p>Verb + object + verb(help, let, make)<br>
a. Blueberries are said to help you concentrate.<br>
b. Make the pain go away with cherries.</p>
</li>
<li>
<p>Verb + object + infinitive(allow, cause, enable, help)<br>
a. Eating too much salt may cause your blood pressure to rise.<br>
b. Researchers say chili preppers enable you to lose weight.</p>
</li>
<li>
<p>Verb + object + form + -ing form(keep, prevent, protect, stop, all of these verbs can also be used with from)<br>
a. Avocado may prevent / stop your skin (from) aging.<br>
b. Kiwis are said to keep your eyesight from deteriorating.</p>
</li>
<li>
<p>How to use expressions like these below.<br>
a. As far as (success) is concerned, ...<br>
c. As far as (careers) go, ...<br>
d. When it comes to happiness / being happy, ...<br>
e. ... in terms of ...</p>
</li>
<li>
<p>In conversation, we can use expressions below to express <code>In my opinion</code>.<br>
a. As far as I'm concerned(frequency == üåüüåüüåü)<br>
b. As far as I know(frequency == üåüüåü)<br>
c. As far as I can tell(frequency == üåü)</p>
</li>
<li>
<p>Adding information(-ing form)<br>
a. An -ing form can be a reduced relative clause. Like: There are some people digging for clams.<br>
b. An -ing form can describe one event that happens at the same time as another. Notice the commas. Like: We'd run around, playing in the sand, not caring ...<br>
c. An -ing form can come before or after be. It can be the subject or object of a verb. Like: My happinest moments were playing on this beach. Or, being successful is good. Or, I remember sitting outside.</p>
</li>
</ol>
<h2 id="new-words" tabindex="-1">New words <a class="header-anchor" href="#new-words" aria-label="Permalink to &quot;New words&quot;"></a></h2>
<ol>
<li>pursue/seek/devote oneself to</li>
<li>nevertheless</li>
<li>recipe/secret (of success)</li>
<li>culinary/cooked</li>
<li>setback/suffering</li>
<li>deteriorate/getting worse</li>
<li>jointÔºàconjunct(adj.)/collaborate(v.)Ôºâ</li>
<li>cohesionÔºàsufferingÔºâ</li>
<li>tortureÔºàsufferingÔºâ</li>
</ol>
<h2 id="new-phrases" tabindex="-1">New Phrases <a class="header-anchor" href="#new-phrases" aria-label="Permalink to &quot;New Phrases&quot;"></a></h2>
<ol>
<li>get anywhere/to be successful</li>
<li>get off the ground/take off</li>
<li>get it under way/start</li>
<li>got to be one of the most XXX/become</li>
<li>got off to a good start</li>
<li>get them down</li>
<li>get in their way</li>
<li>get on with/restart/continue</li>
<li>get ahead</li>
<li>got to the top</li>
<li>go as far as you can in your career</li>
<li>direct ratio</li>
<li>inverse ratio</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Sceranrio of going places]]></title>
            <link>https://askaric.com/en/work/english/03vantage_english/3-11scenario_goingplaces.html</link>
            <guid>https://askaric.com/en/work/english/03vantage_english/3-11scenario_goingplaces.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[About content
1. talk about travel and vacations.  
2. learn more about reported speech and reported]]></description>
            <content:encoded><![CDATA[<h1 id="sceranrio-of-going-places" tabindex="-1">Sceranrio of going places <a class="header-anchor" href="#sceranrio-of-going-places" aria-label="Permalink to &quot;Sceranrio of going places&quot;"></a></h1>
<h2 id="about-content" tabindex="-1">About content <a class="header-anchor" href="#about-content" aria-label="Permalink to &quot;About content&quot;"></a></h2>
<ol>
<li>talk about travel and vacations.</li>
<li>learn more about reported speech and reported thought.</li>
<li>draw conclusions from things people say.</li>
<li>use in what way? to ask for details.</li>
</ol>
<h2 id="about-grammar" tabindex="-1">About grammar <a class="header-anchor" href="#about-grammar" aria-label="Permalink to &quot;About grammar&quot;"></a></h2>
<ol>
<li>
<p>When you report things people said in the past, the verb tense often shifts back.<br>
a. &quot;The plane's just a 16-seater&quot; --&gt; The agent explained the plane was just a 16-seater.<br>
b. &quot;The last bus has left.&quot; --&gt; She informed me the last bus had left.</p>
</li>
<li>
<p>These modal verbs change in reported speech:<br>
a. &quot;There may be a delay.&quot; --&gt; She said there might be a delay.</p>
</li>
<li>
<p>Time expressions often change, too. But, these modal verbs don't change, like: could, should, would, might, used to<br>
a. &quot;The flights are full today and tomorrow.&quot; --&gt; He said the flights were full that day and the next day.</p>
</li>
<li>
<p>Reported questions use the word order of statements. They do not have question marks.<br>
a. &quot;Are you married?&quot; --&gt; People often ask me whether/if I'm married.<br>
b. &quot;What do you take with you?&quot; --&gt; We asked people what they take/took with them.<br>
c. &quot;Why shouldn't I use hotel shampoo&quot; --&gt; She asked me why she shouldn't use hotel shampoo.</p>
</li>
<li>
<p>You ndo't need to &quot;shift back&quot; the verb tense when you report information about the present or future that is still true or relevant.<br>
a. &quot;Do you have any kids?&quot; &quot;I have two.&quot; --&gt; A woman asked me if I have kids. I told her I have two.<br>
b. &quot;Where are you going on your next trip?&quot; --&gt; He wanted to know where I'm going on my next trip.</p>
</li>
<li>
<p>Use an infinitive after ask, tell, order, advise to report a request, a suggestion, or an instruction.<br>
a. &quot;Can you lend me a flashlight?&quot; --&gt; My sister asked me to lend her a flashlight.<br>
b. &quot;Don't use hotel shampoo.&quot; --&gt; A friend told/advised me not to use hotel shampoo.</p>
</li>
<li>
<p>You can use <code>in what way?</code> to ask for more details about someone's ideas or opinions.</p>
</li>
<li>
<p>How to draw conclusions from what the other one says using expressions like these.<br>
a. (So) you're saying (that) ...<br>
b. (So) what you're saying is ...<br>
c. (so) I guess ... (then)<br>
d. you mean</p>
</li>
</ol>
<h2 id="problems-i-have-to-overcome" tabindex="-1">Problems I have to overcome <a class="header-anchor" href="#problems-i-have-to-overcome" aria-label="Permalink to &quot;Problems I have to overcome&quot;"></a></h2>
<ol>
<li>distinguish pronunciation and meaning of words below:<br>
a. plane/plan/explan/planet/planet/plant<br>
b. candle and candy<br>
c. clams and claim</li>
</ol>
<h2 id="new-words" tabindex="-1">New words <a class="header-anchor" href="#new-words" aria-label="Permalink to &quot;New words&quot;"></a></h2>
<ol>
<li>suburb/environs</li>
<li>climb/crawl up</li>
<li>meant</li>
<li>scented/ a scented candle</li>
<li>flashlight</li>
<li>earplugs</li>
<li>shampoo</li>
<li>conditioner</li>
<li>streetlight</li>
<li>hairstylist/hairdresser</li>
<li>galaxy/milky way</li>
<li>frightening/awful</li>
<li>prospect/view/possiblity/investigate</li>
<li>sensation/feeling</li>
<li>floating/weightless</li>
<li>voyage</li>
<li>fantasy</li>
<li>roller coasters</li>
</ol>
<h2 id="new-phrases" tabindex="-1">New Phrases <a class="header-anchor" href="#new-phrases" aria-label="Permalink to &quot;New Phrases&quot;"></a></h2>
<ol>
<li>It energizes you(though it's a sentence)</li>
<li>someone could live longer lives(though it's a sentence)</li>
<li>Weird in what way?</li>
<li>upside down</li>
<li>blast off/take off</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Sceranrio of culture]]></title>
            <link>https://askaric.com/en/work/english/03vantage_english/3-12scenario_culture.html</link>
            <guid>https://askaric.com/en/work/english/03vantage_english/3-12scenario_culture.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[About content
1. talk about weddings, gifts, and traditions.  
2. use relative clauses with when, wh]]></description>
            <content:encoded><![CDATA[<h1 id="sceranrio-of-culture" tabindex="-1">Sceranrio of culture <a class="header-anchor" href="#sceranrio-of-culture" aria-label="Permalink to &quot;Sceranrio of culture&quot;"></a></h1>
<h2 id="about-content" tabindex="-1">About content <a class="header-anchor" href="#about-content" aria-label="Permalink to &quot;About content&quot;"></a></h2>
<ol>
<li>talk about weddings, gifts, and traditions.</li>
<li>use relative clauses with when, where, whose.</li>
<li>use verbs with two objects.</li>
<li>soften comments with expressions like a little.</li>
<li>say Yeah, no to agress and make a comment.</li>
</ol>
<h2 id="about-grammar" tabindex="-1">About grammar <a class="header-anchor" href="#about-grammar" aria-label="Permalink to &quot;About grammar&quot;"></a></h2>
<ol>
<li>
<p>When, where, and whose can introduce defining and non-defining relative clauses.<br>
a. Time -  when<br>
b. e.g. : There's a touching moment when the bride walks down the aisle.<br>
c. Place - where<br>
d. e.g. : There are places in the U.S. where a celebrity look-alike peforms the ceremony.<br>
e. Possessopm - whose<br>
f. e.g. : I have lots of friends whose parents used a matchmaker.</p>
</li>
<li>
<p>Notice the patterns wirh verbs like bring, buy, give, lend, make, offer, send.</p>
<table tabindex="0">
<thead>
<tr>
<th></th>
<th>indirect object</th>
<th>direct object</th>
</tr>
</thead>
<tbody>
<tr>
<td>I never give</td>
<td>my friends / them</td>
<td>money</td>
</tr>
<tr>
<td>She lent</td>
<td>someone</td>
<td>her book</td>
</tr>
<tr>
<td>A friend sent</td>
<td>my monther</td>
<td>a gift</td>
</tr>
<tr>
<td>I bought / made</td>
<td>his monther</td>
<td>something / one</td>
</tr>
</tbody>
</table>
<table tabindex="0">
<thead>
<tr>
<th></th>
<th>object</th>
<th>prepositional phrase</th>
</tr>
</thead>
<tbody>
<tr>
<td>I never give</td>
<td>money</td>
<td>to my friends / them</td>
</tr>
<tr>
<td>She lent</td>
<td>her book / it</td>
<td>to someone</td>
</tr>
<tr>
<td>A friend sent</td>
<td>a gift</td>
<td>to my monther</td>
</tr>
<tr>
<td>I bought / made</td>
<td>something / one</td>
<td>for his monther</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>We use words below soften our comments using expressions.<br>
a. kind of, a(little) bit, not really, sort of, slightly, not quite, a little, somewhat<br>
b. Kind of, a little and sort of are the most common expressions.<br>
c. Somewhat and slightly are more common in formal speaking.<br>
d. People often use not quite with sure, right, true, clear and certain.</p>
</li>
<li>
<p>Use <code>Yeah, no</code> to agree with someone and then make a comment of your own.<br>
a. Yeah : you're talking/ I agree with you.<br>
b. no : no, that's not good.</p>
</li>
</ol>
<h2 id="problem-of-mine" tabindex="-1">Problem of mine <a class="header-anchor" href="#problem-of-mine" aria-label="Permalink to &quot;Problem of mine&quot;"></a></h2>
<ol>
<li>Notice pronounication of words below:<br>
a. two special words : 20th and 30th</li>
</ol>
<h2 id="new-words" tabindex="-1">New words <a class="header-anchor" href="#new-words" aria-label="Permalink to &quot;New words&quot;"></a></h2>
<ol>
<li>fortune-teller</li>
<li>aisle</li>
<li>bride/groom</li>
<li>symbolize/stand for</li>
<li>newlyweds</li>
<li>prosperity</li>
<li>western-style ceremonies</li>
<li>rehearsal/repeating</li>
<li>bachelor</li>
<li>bachelorette</li>
<li>bridesmaid(s)</li>
<li>groomsmen</li>
<li>exchange vows</li>
<li>obliged</li>
<li>punch you</li>
<li>bizarre/eccentric</li>
<li>costume/clothe</li>
</ol>
<h2 id="new-phrases" tabindex="-1">New Phrases <a class="header-anchor" href="#new-phrases" aria-label="Permalink to &quot;New Phrases&quot;"></a></h2>
<ol>
<li>go to reception</li>
<li>walks down the aisle</li>
<li>parents of the groom host a dinner</li>
<li>tear off</li>
<li>out of tune(with)/weird/odd</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Sceranrio of ability]]></title>
            <link>https://askaric.com/en/work/english/03vantage_english/3-13scenario_ability.html</link>
            <guid>https://askaric.com/en/work/english/03vantage_english/3-13scenario_ability.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[About content
1. talk about intelligence, skills, and abilities.  
2. use adverbs and adjectives to ]]></description>
            <content:encoded><![CDATA[<h1 id="sceranrio-of-ability" tabindex="-1">Sceranrio of ability <a class="header-anchor" href="#sceranrio-of-ability" aria-label="Permalink to &quot;Sceranrio of ability&quot;"></a></h1>
<h2 id="about-content" tabindex="-1">About content <a class="header-anchor" href="#about-content" aria-label="Permalink to &quot;About content&quot;"></a></h2>
<ol>
<li>talk about intelligence, skills, and abilities.</li>
<li>use adverbs and adjectives to describe and compare.</li>
<li>use vague expressions when you don't need to be precise.</li>
<li>agree with someone using responses like No doubt.</li>
</ol>
<h2 id="about-grammar" tabindex="-1">About grammar <a class="header-anchor" href="#about-grammar" aria-label="Permalink to &quot;About grammar&quot;"></a></h2>
<ol>
<li>
<p>You can use adverbs like these before adjectives and adverbs to introduce these ideas.<br>
a. Degree -- extremely, highly, relatively  -- They're extremely literate and highly skilled.<br>
b. Type -- scientifically, linguistically -- Linguistically intelligent people are good at languages.<br>
c. Opinion -- incredibly, remarkably -- They seem to solve problems incredibly easily.<br>
d. Focus -- especially, particularly -- People with logical intelligence are especially good at math.</p>
</li>
<li>
<p>Comparative and superlative,adjectives and adverbs</p>
<table tabindex="0">
<thead>
<tr>
<th></th>
<th>Comparatives and as ... as</th>
<th>Superlatives</th>
</tr>
</thead>
<tbody>
<tr>
<td>Adjectives</td>
<td>I feel <strong>happier</strong>, and I've gotten better at it.</td>
<td>The race is my biggest and best challenge.</td>
</tr>
<tr>
<td></td>
<td>I'm <strong>more confident</strong> and <strong>less nervous</strong>.</td>
<td>Talking a course was <strong>the most sensible</strong> idea.</td>
</tr>
<tr>
<td></td>
<td>I'm not <strong>as fast as</strong> I'd like to be.</td>
<td>I was <strong>the least experienced</strong> presenter.</td>
</tr>
<tr>
<td>Adverbs</td>
<td>I'm training <strong>harder</strong> than ever.</td>
<td>We all train hard, but I <strong>train</strong> hardest.</td>
</tr>
<tr>
<td></td>
<td>I'm improving <strong>more slowly</strong> than I'd hoped.</td>
<td>I train <strong>(the) most often</strong> on weekends.</td>
</tr>
<tr>
<td></td>
<td>I practice <strong>less often</strong> than I should.</td>
<td></td>
</tr>
<tr>
<td></td>
<td>I don't play <strong>as often as</strong> I should.</td>
<td><strong>(Superlative adverbs with least are not common)</strong></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>vague expressions</p>
<table tabindex="0">
<thead>
<tr>
<th>less common in formal</th>
<th>more common in formal</th>
</tr>
</thead>
<tbody>
<tr>
<td>... and things (like that)/ and stuff (like that)</td>
<td>and so on</td>
</tr>
<tr>
<td>... and all/ and all that</td>
<td>and all that</td>
</tr>
<tr>
<td>... and that kind of thing / and that sort of thing</td>
<td>and things</td>
</tr>
<tr>
<td>... and everything</td>
<td>and stuff</td>
</tr>
</tbody>
</table>
</li>
</ol>
<h2 id="new-words" tabindex="-1">New words <a class="header-anchor" href="#new-words" aria-label="Permalink to &quot;New words&quot;"></a></h2>
<ol>
<li>rookie/noob</li>
<li>imprecise/inadequate</li>
<li>articulate(talking fluently)</li>
<li>literate(people who can read and write)</li>
<li>logical-mathematical</li>
<li>bodily</li>
<li>spatial/spacial/dimensional</li>
<li>interpersonal(interpersonal communication)</li>
<li>intrapersonal</li>
<li>vague/unclear</li>
<li>unscramble</li>
</ol>
<h2 id="new-phrases" tabindex="-1">New Phrases <a class="header-anchor" href="#new-phrases" aria-label="Permalink to &quot;New Phrases&quot;"></a></h2>
<ol>
<li>be adequate for</li>
<li>be sensitive to</li>
<li>be skilled at</li>
<li>be scientifically minded</li>
<li>have a capacity for</li>
<li>be efficient at</li>
<li>have a talent for</li>
<li>be particularly adept at</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Sceranrio of going places]]></title>
            <link>https://askaric.com/en/work/english/03vantage_english/3-1scenario_speedfriending.html</link>
            <guid>https://askaric.com/en/work/english/03vantage_english/3-1scenario_speedfriending.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[About content

 About grammar

 New words

 New Phrases]]></description>
            <content:encoded><![CDATA[<h1 id="sceranrio-of-going-places" tabindex="-1">Sceranrio of going places <a class="header-anchor" href="#sceranrio-of-going-places" aria-label="Permalink to &quot;Sceranrio of going places&quot;"></a></h1>
<h2 id="about-content" tabindex="-1">About content <a class="header-anchor" href="#about-content" aria-label="Permalink to &quot;About content&quot;"></a></h2>
<h2 id="about-grammar" tabindex="-1">About grammar <a class="header-anchor" href="#about-grammar" aria-label="Permalink to &quot;About grammar&quot;"></a></h2>
<h2 id="new-words" tabindex="-1">New words <a class="header-anchor" href="#new-words" aria-label="Permalink to &quot;New words&quot;"></a></h2>
<h2 id="new-phrases" tabindex="-1">New Phrases <a class="header-anchor" href="#new-phrases" aria-label="Permalink to &quot;New Phrases&quot;"></a></h2>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[scernario celebrity]]></title>
            <link>https://askaric.com/en/work/english/03vantage_english/3-2scenario_celebrity.html</link>
            <guid>https://askaric.com/en/work/english/03vantage_english/3-2scenario_celebrity.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[First of all

This tpoic is about `Celebrities`.For this conversation, we can see he ask me focus ]]></description>
            <content:encoded><![CDATA[<h1 id="scernario-celebrity" tabindex="-1">scernario celebrity <a class="header-anchor" href="#scernario-celebrity" aria-label="Permalink to &quot;scernario celebrity&quot;"></a></h1>
<h2 id="first-of-all" tabindex="-1">First of all <a class="header-anchor" href="#first-of-all" aria-label="Permalink to &quot;First of all&quot;"></a></h2>
<p>This tpoic is about <code>Celebrities</code>.For this conversation, we can see he ask me focus on <code>grammar</code> and <code>why is it normal to be interested in celebrities?</code> in <a href="https://dogwood.xdfsjj.com/pc/audioDetail.html?id=51352&amp;pcrId=12680494&amp;resId=14718879&amp;resSign=c76b28&amp;type=14" target="_blank" rel="noreferrer">radios address about celebrities - Track 1.16</a>.</p>
<h2 id="about-grammar" tabindex="-1">About grammar <a class="header-anchor" href="#about-grammar" aria-label="Permalink to &quot;About grammar&quot;"></a></h2>
<p>for grammar part, we can see below points:</p>
<ol>
<li>Defining clauses :<br>
a. we can use <code>that/which</code> to define, identify ,or give essential information about noun.<br>
b. it would be meaningless without the clause.<br>
c. for example : <code>there are shows that/which pay for plastic suergery.</code></li>
<li>Non-defining clauses :<br>
a. non-defining clauses are used to adding extra information about the noun or the clause before it.<br>
b. what common in use is to use <code>which</code>.<br>
c. for example : <code>Celebrity magazines,which outnumber news magazines are everywhere.</code></li>
</ol>
<h2 id="about-content" tabindex="-1">About content <a class="header-anchor" href="#about-content" aria-label="Permalink to &quot;About content&quot;"></a></h2>
<p>for content part,we can see that in the below, here are three questions i should foucus on:</p>
<ol>
<li>
<p>why is it normal to be insterested in celebrities normal?<br>
a. firstly, celebrity obssession is normal, we can see celebrity magazines, which outnumber over news magazines are on every newstand. we love to read about people that celebrity's date, clothes they ware and especially their problems which the media will often invent.<br>
b. secondly, there's reality TV. Million of viewers avidly follow reality and telant shows, which makes ordinary people into instant celebrities.</p>
</li>
<li>
<p>why are we so obssessed?<br>
a. firstly, That a scentific reason for it is that which will make you feel good about your own interest in celebrity's gossip.<br>
b. secondly, Psychologists say it's normal to imitate people who are successful in our society.<br>
c. thirdly, with TV, celebrity seems could be able to come right into our home and be sort of part of our family.</p>
</li>
</ol>
<h2 id="problem-of-mine" tabindex="-1">Problem of mine <a class="header-anchor" href="#problem-of-mine" aria-label="Permalink to &quot;Problem of mine&quot;"></a></h2>
<ol>
<li>
<p>not easy to distinguish defining and non-defining clauses, like:<br>
a. in fact : <code>we love to read about people that celebrity's date, clothes they ware and especially their problems, which the media will often invent.</code><br>
b. i head : <code>we love to read about people that celebrity's date, clothes they ware and especially their problems which the media will often invent.</code><br>
c. importance of problem : it's not every important for me, now.</p>
</li>
<li>
<p>usually being lost when there appear out of a new words, like:<br>
a. i suddenly lost when the word of <code>avidly</code> came into my mind in <code>Million of viewers avidly follow reality and telant shows</code>.
b. how to overcome : i think i should notice the structure of whole sentence instead of meaning.However, it's hard without enough knlowledges about words and grammars.<br>
c. importance of problem : important, i have to overcome it ASAP.</p>
</li>
</ol>
<h2 id="new-words-for-me" tabindex="-1">New words for me <a class="header-anchor" href="#new-words-for-me" aria-label="Permalink to &quot;New words for me&quot;"></a></h2>
<ol>
<li><code>mimic</code></li>
<li><code>pay for</code></li>
<li><code>outnumber</code></li>
<li><code>athlete</code></li>
<li><code>reassuring</code></li>
<li><code>vary</code></li>
<li><code>bully</code></li>
</ol>
<h2 id="phrases" tabindex="-1">Phrases <a class="header-anchor" href="#phrases" aria-label="Permalink to &quot;Phrases&quot;"></a></h2>
<ol>
<li><code>increase in ... of ...</code></li>
<li><code>impact ... on ...</code></li>
<li><code>research on</code></li>
<li><code>effect on</code></li>
<li><code>advertisement for</code></li>
<li><code>reason for</code></li>
<li><code>rise in</code></li>
<li><code>problem with</code></li>
<li><code>link between ... and ...</code></li>
<li><code>cause of</code></li>
<li><code>concern about</code></li>
<li><code>influence on</code></li>
<li><code>relationship between ... and ...</code></li>
<li><code>pick on</code></li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[scernario comment]]></title>
            <link>https://askaric.com/en/work/english/03vantage_english/3-3scenario_comment.html</link>
            <guid>https://askaric.com/en/work/english/03vantage_english/3-3scenario_comment.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[First of all

This's topic is about `you know what ...` expression and I should learn how to add c]]></description>
            <content:encoded><![CDATA[<h1 id="scernario-comment" tabindex="-1">scernario comment <a class="header-anchor" href="#scernario-comment" aria-label="Permalink to &quot;scernario comment&quot;"></a></h1>
<h2 id="first-of-all" tabindex="-1">First of all <a class="header-anchor" href="#first-of-all" aria-label="Permalink to &quot;First of all&quot;"></a></h2>
<p>This's topic is about <code>you know what ...</code> expression and I should learn how to add comments. Here is a conversation about the clip opinions, in <a href="https://dogwood.xdfsjj.com/pc/audioDetail.html?id=51352&amp;pcrId=12680494&amp;resId=14718879&amp;resSign=c76b28&amp;type=14" target="_blank" rel="noreferrer">radios address about celebrities - Track 1.22</a>.</p>
<h2 id="about-grammar" tabindex="-1">About grammar <a class="header-anchor" href="#about-grammar" aria-label="Permalink to &quot;About grammar&quot;"></a></h2>
<ol>
<li>
<p>Sometimes,the statement structure of <code>you know what ...</code> is used to comment your/my points.<br>
a. question : you know what i like?</p>
</li>
<li>
<p>On the other hand, which also can be treat as a conjunctive structure, for example <code>statement-X,you know what ... ? statement-Y</code> just uses it to connect <code>statement-X</code> and <code>statement-Y</code>, and a real example here below.<br>
a. People do really dangrous things and video it - like rifing bikes off walls.<br>
b. Which is stupid, I know.<br>
c. You know what gets me, too. Some of the home videos people post. They're so boring.</p>
</li>
</ol>
<h2 id="about-content" tabindex="-1">About content <a class="header-anchor" href="#about-content" aria-label="Permalink to &quot;About content&quot;"></a></h2>
<ol>
<li>what are the opinions between he and she?<br>
a. background : she emailed him a clip and ask how would he feel.<br>
b. his opinion : he don't usually tend to watch clips which were sent by people. And he thinks mostly which are boring, dangerous like riding bake off the wall, and couldn't get the points.<br>
c. her opinion : she know his comments and are suppresing in the hits of that clips are so much, like millions.</li>
</ol>
<h2 id="problem-of-mine" tabindex="-1">Problem of mine <a class="header-anchor" href="#problem-of-mine" aria-label="Permalink to &quot;Problem of mine&quot;"></a></h2>
<ol>
<li>because of combinding pronunciation, I feel a little confused, but not lost.<br>
a. in fact : Did you see that clip I emaild you?
b. I heard : Did you see that clip <code>by email</code> you?<br>
c. because of the new word and combinding pronunciation, I don't know what asking for is the whole question.
d. importance of problem : important, becasue that without enough context would let me confused or even lost the main idea.<br>
e. how to overcome : foucusing on every accurate pronunication.</li>
</ol>
<h2 id="new-words-for-me" tabindex="-1">New words for me <a class="header-anchor" href="#new-words-for-me" aria-label="Permalink to &quot;New words for me&quot;"></a></h2>
<ol>
<li>hilarious</li>
<li>clip</li>
<li>conduct</li>
</ol>
<h2 id="phrases" tabindex="-1">Phrases <a class="header-anchor" href="#phrases" aria-label="Permalink to &quot;Phrases&quot;"></a></h2>
<ol>
<li>you know what gets me?</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[scernario stories]]></title>
            <link>https://askaric.com/en/work/english/03vantage_english/3-4scenario_stories.html</link>
            <guid>https://askaric.com/en/work/english/03vantage_english/3-4scenario_stories.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[First of all

1. talk about life lessions and experiences  
2. use the past tense, the present pe]]></description>
            <content:encoded><![CDATA[<h1 id="scernario-stories" tabindex="-1">scernario stories <a class="header-anchor" href="#scernario-stories" aria-label="Permalink to &quot;scernario stories&quot;"></a></h1>
<h2 id="first-of-all" tabindex="-1">First of all <a class="header-anchor" href="#first-of-all" aria-label="Permalink to &quot;First of all&quot;"></a></h2>
<ol>
<li>talk about life lessions and experiences</li>
<li>use the past tense, the present perfect, and the past perfect.</li>
<li>make comments when telling a story.</li>
<li>use (It's) no wonder ... to say something is not surprising.</li>
</ol>
<h2 id="about-grammar" tabindex="-1">About grammar <a class="header-anchor" href="#about-grammar" aria-label="Permalink to &quot;About grammar&quot;"></a></h2>
<ol>
<li>
<p>What's the difference between present prefect and present prefect continous.<br>
a. present prefect : until now, I might turn to the other thing or keep on doing the same thing.<br>
b. present perfect continous : until now, I might continously keep on the same thing.</p>
</li>
<li>
<p>Use the past tense for situations and events that are part of a completed past time, not connected to now.<br>
a. I lived in Italy a few years ago.(I'm not there now).</p>
</li>
<li>
<p>Use past present perfect for situations and events that are part of a past time that continues up to now.<br>
a. Life has been interesting so far. (It still is)</p>
</li>
<li>
<p>Use simple verbs for completed events or permanent situations.<br>
a. Marco's band broke up.</p>
</li>
<li>
<p>Use continuous verbs for background, on going, or temporary events or situations.<br>
a. He's been coaching a soccer team.</p>
</li>
</ol>
<h2 id="about-content" tabindex="-1">About content <a class="header-anchor" href="#about-content" aria-label="Permalink to &quot;About content&quot;"></a></h2>
<h2 id="new-words" tabindex="-1">New words <a class="header-anchor" href="#new-words" aria-label="Permalink to &quot;New words&quot;"></a></h2>
<ol>
<li>miserable</li>
<li>penalty</li>
<li>hall</li>
<li>ethics</li>
<li>deterrent</li>
<li>anecdote</li>
<li>gymnastics</li>
<li>pervasive</li>
<li>evolve</li>
<li>spot</li>
<li>determine</li>
<li>convention</li>
<li>bartenders</li>
<li>sibling</li>
<li>literal</li>
<li>rigidly</li>
<li>infer</li>
<li>anonymous</li>
<li>analogous</li>
<li>jargon</li>
<li>abbreviation</li>
<li>facilitate</li>
<li>amortize</li>
</ol>
<h2 id="new-phrases" tabindex="-1">New Phrases <a class="header-anchor" href="#new-phrases" aria-label="Permalink to &quot;New Phrases&quot;"></a></h2>
<ol>
<li>woke/waked up(woke's more common in use)</li>
<li>life's ups and downs</li>
<li>cheer you up/make you happy</li>
<li>break up(end up)</li>
<li>count toward our final grade</li>
<li>struggling with the class</li>
<li>fall behind on my work</li>
<li>caught up on</li>
<li>turn in(hand on)</li>
<li>left the question blank</li>
<li>raised his hand</li>
<li>affect my grade</li>
<li>complete that questions</li>
<li>count towards</li>
<li>turn to(going to)</li>
<li>turn into (water turns into tea and is changed totally)</li>
<li>be convicted of (get sentenced to)</li>
<li>right before ... + clause with simple past</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[scernario working lives]]></title>
            <link>https://askaric.com/en/work/english/03vantage_english/3-5scenario_workinglives.html</link>
            <guid>https://askaric.com/en/work/english/03vantage_english/3-5scenario_workinglives.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[First of all

1. talk about work and finding a job
2. use countable and unaccountable nouns
3. g]]></description>
            <content:encoded><![CDATA[<h1 id="scernario-working-lives" tabindex="-1">scernario working lives <a class="header-anchor" href="#scernario-working-lives" aria-label="Permalink to &quot;scernario working lives&quot;"></a></h1>
<h2 id="first-of-all" tabindex="-1">First of all <a class="header-anchor" href="#first-of-all" aria-label="Permalink to &quot;First of all&quot;"></a></h2>
<ol>
<li>talk about work and finding a job</li>
<li>use countable and unaccountable nouns</li>
<li>generalize and specify with articles</li>
<li>use -ly adverbs to express your attitude</li>
<li>use As a matter of fact and In fact to give or correct information</li>
</ol>
<h2 id="about-grammar" tabindex="-1">About grammar <a class="header-anchor" href="#about-grammar" aria-label="Permalink to &quot;About grammar&quot;"></a></h2>
<ol>
<li>
<p>countable nouns can be singluar with <code>a/an</code>.<br>
a. Give an example of how you achieved a goal.</p>
</li>
<li>
<p>Singular countable nouns take a singular verb and plural countable nouns take a plural verb.<br>
a. An impressive resume is important.<br>
b. Candidates face stiff competition.</p>
</li>
<li>
<p>Uncountable nouns are only singular.<br>
a. Explain how your work can save money.</p>
</li>
<li>
<p>Uncountable nouns take a singular verb.<br>
a. Feedback from a counselor is invaluable.<br>
b. Research shows what employers look for.</p>
</li>
<li>
<p>Use <code>a/an</code> with a singular countable noun to make a generalization, or when you don't mean a specific person or thing.<br>
a. I want to work for a company that has a salon.</p>
</li>
<li>
<p>Do not use <code>the</code> to make generalizations with a plural countable noun or an uncountable noun.<br>
a. Classes after work are a great idea.</p>
</li>
<li>
<p>Use <code>the</code> when the idea is known to the reader or listener, or when it's clear which specific person or thing you mean.<br>
a. I'd like to take the kids to the office.</p>
</li>
<li>
<p>Use <code>the</code> when you are specific about which thing you mean.<br>
a. The classes that I take are very expensive.</p>
</li>
<li>
<p>Uncountable nouns are usually names of materals or of groups of things. You can use <code>a piece of</code> to refer to an example or a part of these uncountable nouns:<br>
a. a piece of jewelry/funiture/music/equipment/information/software/advice/evidence</p>
</li>
<li>
<p>With some uncountable nouns, you need to use a different countable noun to refer to an example or a part:<br>
a. travel - trips<br>
b. cash - coin or bill<br>
c. feedback - comment<br>
d. luggage - bag<br>
e. work - job or position</p>
</li>
<li>
<p>Academic subjects and sports that including news end in -s are usually singluar:<br>
a. economics, genetics, mathematics physics, politics, aerobics, gymnastics</p>
</li>
<li>
<p>Some nouns are both countable and uncountable but they have different meanings, eg:<br>
a. bussiness, competition, experience, paper, time, work</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    1.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> chinese</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> business</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> seems</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> has</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> taken</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> off.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    2.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> new</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> business</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> thrives</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> this</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> area.</span></span></code></pre>
</div><p>b. competition</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    1.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> competitions</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> job</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> acute.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    2.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> competition</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> job</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> acute</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> marketplace</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> now.</span></span></code></pre>
</div><p>c. experience</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    1.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> managing</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> experence</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> such</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> important.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    2.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> we</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> all</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> learn</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> by</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> experence.</span></span></code></pre>
</div><p>d. paper</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    1.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> there</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> any</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> news</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> today's papers?  </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    2. can you give me a piece of paper?</span></span></code></pre>
</div><p>e. time</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    1.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> you've paid it 2 times.  </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    2. do you have any time?</span></span></code></pre>
</div><p>f. work</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    1.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> heard</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> you</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> are</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> looking</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> work.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    2.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> i've lots of works about database.</span></span></code></pre>
</div></li>
<li>
<p>Use the with these common locations, especially after the prepositions at and to: the office, the factory, the store, the mall, the gym, the library, the park, the pool, the post office, the bank.<br>
a. I'd like to have exercise quipment at the office. I never have time to go to the gym.<br>
b. Some companies install ATMs so that employees don't have to go to the bank.</p>
</li>
<li>
<p>Don't use the with these common locations,especially after the prepositions at, to, in, before, and after: home, bed, work, school, college, class, prison, jail.<br>
a. I arrive at work early so that I can leave early to pick up my children after school.<br>
b. Some companies offer special training programs for people who have been in prison.<br>
c. Many employees work during the day and go to college at night.</p>
</li>
<li>
<p>Don't use the before meals. You can use an article when you describe a particular meal.<br>
a. I had breakfeast late, so I didn't eat much for lunch.<br>
b. The lunch we had at that new cafe wan't very good. It was an expensive lunch, too.</p>
</li>
</ol>
<h2 id="about-content" tabindex="-1">About content <a class="header-anchor" href="#about-content" aria-label="Permalink to &quot;About content&quot;"></a></h2>
<h2 id="problem-of-mine" tabindex="-1">Problem of mine <a class="header-anchor" href="#problem-of-mine" aria-label="Permalink to &quot;Problem of mine&quot;"></a></h2>
<ol>
<li>Pronunciation : Something aren't very accurate.<br>
a. how<br>
b. explain<br>
c. path<br>
d. as well as --&gt; <code>as well las</code><br>
e. poll<br>
f. desirable</li>
<li>Rarelly use adverb when I'm talking.<br>
a. fortunatlly, luckily, stangely, obviously, suprisinglyÔºå seriously</li>
</ol>
<h2 id="new-words" tabindex="-1">New words <a class="header-anchor" href="#new-words" aria-label="Permalink to &quot;New words&quot;"></a></h2>
<ol>
<li>stiff</li>
<li>plural</li>
<li>perk</li>
<li>poll</li>
<li>subsidize(sponsor)</li>
<li>rate --&gt; how do you rate them?</li>
<li>nap</li>
<li>reimburse</li>
<li>tuition</li>
<li>demanding</li>
<li>genre</li>
<li>aerobics</li>
<li>therMometer</li>
<li>cold medicine</li>
<li>rewarding</li>
<li>tempt / atract</li>
<li>fabulous</li>
</ol>
<h2 id="new-phrases" tabindex="-1">New Phrases <a class="header-anchor" href="#new-phrases" aria-label="Permalink to &quot;New Phrases&quot;"></a></h2>
<ol>
<li>achieve a goal</li>
<li>acquire skill or knowledge</li>
<li>face stiff in school or at work</li>
<li>follow someone's suggestion, advice, instruction</li>
<li>make a progress/ improvement with a project</li>
<li>meet a deadline</li>
<li>save or make money</li>
<li>show interests in a job</li>
<li>submit a job application</li>
<li>a piece of jewelry/funiture/music/equipment/information/software/advice/evidence</li>
<li>travel(uncountable) - trip(countable)</li>
<li>cash - coin or bill</li>
<li>feedback - comment</li>
<li>luggage - bag</li>
<li>work - job or position</li>
<li>stand out from the crowd</li>
<li>as a matter of fact</li>
<li>in fact</li>
<li>i have a fever</li>
<li>i have a headache</li>
<li>i have a sore throat</li>
<li>i have a runny nose</li>
<li>i have to blow my nose</li>
<li>i feel sore all over</li>
<li>i feel chilly as well</li>
<li>i have a really bad cough</li>
<li>i sneeze all the time</li>
<li>4 pills / tablets after a meal</li>
<li>i'm testd / i got tested postitive</li>
<li>i feel dizzy</li>
<li>have second thoughts about it</li>
<li>being stuck in a lab all day</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[scernario challenge]]></title>
            <link>https://askaric.com/en/work/english/03vantage_english/3-6scenario_challenges.html</link>
            <guid>https://askaric.com/en/work/english/03vantage_english/3-6scenario_challenges.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[About grammar

1. the + adj == people who have adjectival characteristics
2. you can use `if` cla]]></description>
            <content:encoded><![CDATA[<h1 id="scernario-challenge" tabindex="-1">scernario challenge <a class="header-anchor" href="#scernario-challenge" aria-label="Permalink to &quot;scernario challenge&quot;"></a></h1>
<h2 id="about-grammar" tabindex="-1">About grammar <a class="header-anchor" href="#about-grammar" aria-label="Permalink to &quot;About grammar&quot;"></a></h2>
<ol>
<li>the + adj == people who have adjectival characteristics</li>
<li>you can use <code>if</code> clasues to talk about hypothetical events in the present or past.<br>
a. Present : <code>if + past form; modal + verb</code><br>
b. e.g. : What would you do if you saw a homeless person on the street?<br>
c. Past : <code>if + past perfect form</code><br>
d. e.g. : if you'd been in the car with Jan, what would you have done?<br>
e. Mixed present and past<br>
f. e.g. : If they still lived in their big house, would they have raised any money? Maybe. But they might not be so close now if they had stayed there.</li>
<li>wish and hope<br>
a. Use wish + past form to imagine a different situation in the present.<br>
b. e.g. Aya wishes we could eradicate poverty. She wishes the gap between rich and poor was smaller.<br>
c. Use wish + would + verb for things you want other people to do or for things you can't control.<br>
d. e.g. Pin wishes someone would solve the hunger problem.<br>
e. Use wish + past perfect to imagine the past.<br>
f. e.g. Luis wishes everywhere hadn't gotten so polluted.<br>
g. Use hope to talk about things that you want to be ture about the future, present, or past.<br>
h. e.g. Tom hopes they will create more new jobs. or, I hope that makes sense/ I didn't say anything silly.</li>
<li><code>what if</code> clauses are the most common of these expressions, which is mostly used in follow-up questions. It's doesn't usually start a conversation.<br>
a. e.g. : what if I adopted a polar bear for him?</li>
<li>You can use <code>I suppose</code> to show another person;s idea is right, like <code>I suppose you it is</code> means what you said maybe right.</li>
</ol>
<h2 id="problem-of-mine" tabindex="-1">Problem of mine <a class="header-anchor" href="#problem-of-mine" aria-label="Permalink to &quot;Problem of mine&quot;"></a></h2>
<ol>
<li>when I'm reading some sentences, I discover suddenly that I couldn't figure out what kind of meaning does it means.<br>
a. analyze result : Grammar is only being used when I'm expressing something after thinking in my brain.<br>
b. analyze result : However, when I'm reading, grammar isn't a main part of what I'd check.<br>
c. analyze result : I'm not familliar with common phrases and combinding expressions in use, like <code>a lot less cash</code>.</li>
<li>my accuratcy isn't good<br>
a. like <code>fashion --&gt; fashionable --&gt; fashionably --&gt; fashionmonger</code><br>
b. solution : in new words of every note, I'm just gonna write synonyms and different word classes.</li>
<li>Not familiar with word group or word family<br>
a. analyze result : I'll append a new sector named necessary sentences which means I have to recite all of them, so that I can speak smoothly or fluently.</li>
</ol>
<h2 id="new-words" tabindex="-1">New words <a class="header-anchor" href="#new-words" aria-label="Permalink to &quot;New words&quot;"></a></h2>
<ol>
<li>eradicate --&gt; eradication</li>
<li>poverty --&gt; poor</li>
<li>wealth --&gt; wealthy</li>
<li>nephew</li>
<li>polar --&gt; polarity --&gt; polarize --&gt; polarization</li>
</ol>
<h2 id="new-phrases" tabindex="-1">New Phrases <a class="header-anchor" href="#new-phrases" aria-label="Permalink to &quot;New Phrases&quot;"></a></h2>
<ol>
<li>the economy the way it is</li>
<li>I suppose there's no point in doing somthing</li>
<li>last-minute panic</li>
<li>time from now --&gt; 20 years from now</li>
<li>vending machine</li>
</ol>
<h2 id="necessary-sentences" tabindex="-1">Necessary sentences <a class="header-anchor" href="#necessary-sentences" aria-label="Permalink to &quot;Necessary sentences&quot;"></a></h2>
<ol>
<li>there's not point in somthing</li>
<li>I suppose</li>
<li>someone's gonna be doing</li>
<li>someone won't be doing somthing/won't do somthing</li>
<li>someone'll probably be doing something</li>
<li>I just don't have any change</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[scernario into the future]]></title>
            <link>https://askaric.com/en/work/english/03vantage_english/3-7scenario_intothefuture.html</link>
            <guid>https://askaric.com/en/work/english/03vantage_english/3-7scenario_intothefuture.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[About grammar

1. Use a continuous form after be going to, will, may, and might for events you exp]]></description>
            <content:encoded><![CDATA[<h1 id="scernario-into-the-future" tabindex="-1">scernario into the future <a class="header-anchor" href="#scernario-into-the-future" aria-label="Permalink to &quot;scernario into the future&quot;"></a></h1>
<h2 id="about-grammar" tabindex="-1">About grammar <a class="header-anchor" href="#about-grammar" aria-label="Permalink to &quot;About grammar&quot;"></a></h2>
<ol>
<li>Use a continuous form after be going to, will, may, and might for events you expect to be in progress at a future time.<br>
a. you can use <code>be gonna</code> when there's evidence noe for a future event.<br>
b. e.g. : Everyone's going to use cards more in the future.<br>
c. you can use will, may, or might in predictions <code>will</code> is more certain than may or might.<br>
d. e.g. : Every cell phone will(probably) have a chip.<br>
e. use the present form in <code>if</code> or time clauses that refer to the future.<br>
f. e.g. : if we use cards, what are kids going to do?</li>
</ol>
<h2 id="problem-of-mine" tabindex="-1">Problem of mine <a class="header-anchor" href="#problem-of-mine" aria-label="Permalink to &quot;Problem of mine&quot;"></a></h2>
<ol>
<li>
<p>when I'm reading some sentences, I discover suddenly that I couldn't figure out what kind of meaning does it means.<br>
a. analyze result : Grammar is only being used when I'm expressing something in my brain.<br>
b. analyze result : However, when I'm reading, grammar isn't a main part of what I'd check.<br>
c. analyze result : I'm not familliar with common phrases and combinding expressions in use, like <code>a lot less cash</code>.</p>
</li>
<li>
<p>Modal verbs can express a range of meaning.</p>
<table tabindex="0">
<thead>
<tr>
<th>Scenario</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td>Expectations</td>
<td>There should /ought to be a handout going around</td>
</tr>
<tr>
<td>Guesses</td>
<td>The projector must be warming up. It might /could / may be broken</td>
</tr>
<tr>
<td>Necessity</td>
<td>I should /ought to/have to /need to /'d better stop.('d = had')</td>
</tr>
<tr>
<td>Suggestions/advice</td>
<td>You might want to check out the articles on the handout</td>
</tr>
<tr>
<td>Ability</td>
<td>Can you see all the screen</td>
</tr>
<tr>
<td>Failure(tp operate)</td>
<td>The projector won't connect to my laptop</td>
</tr>
<tr>
<td>Requests</td>
<td>Could/ Would/ Can someboday turn the lights off, please?</td>
</tr>
<tr>
<td>Offers</td>
<td>I'll make the screen bigger. I can/ could turn it up</td>
</tr>
<tr>
<td>Permission</td>
<td>May/ Could/ Can I ask a question? Yes, you may(more formal)/ can</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>soften your idea<br>
a. would/'d + do<br>
b. I would say</p>
</li>
</ol>
<h2 id="new-words" tabindex="-1">New words <a class="header-anchor" href="#new-words" aria-label="Permalink to &quot;New words&quot;"></a></h2>
<ol>
<li>fraud --&gt; fraudulent --&gt; fraudulence</li>
<li>scam --&gt; scammer</li>
<li>theft --&gt; robbery(synonym)</li>
<li>chip --&gt; chipper --&gt; chiping</li>
<li>projecter</li>
</ol>
<h2 id="new-phrases" tabindex="-1">New Phrases <a class="header-anchor" href="#new-phrases" aria-label="Permalink to &quot;New Phrases&quot;"></a></h2>
<ol>
<li>the economy the way it is</li>
</ol>
<h2 id="necessary-sentences" tabindex="-1">Necessary sentences <a class="header-anchor" href="#necessary-sentences" aria-label="Permalink to &quot;Necessary sentences&quot;"></a></h2>
<ol>
<li>Can you all see the screen?</li>
<li>there should be a handout going around.</li>
<li>let's get started</li>
<li>I wanna look at</li>
<li>I'll be talking about</li>
<li>I'll allow time for questitons and commetns at the end</li>
<li>I'd like to begin by doing</li>
<li>As you;ll see on the slide</li>
<li>let's move and look at</li>
<li>Anyway, that's all I have time for</li>
<li>I'd better stop</li>
<li>Does anyone have any querstions or comments</li>
<li>I'll just conclude by saying thank you for your listening</li>
<li>I'll turn it over to John</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[scernario of getting along]]></title>
            <link>https://askaric.com/en/work/english/03vantage_english/3-8scenario_getalong.html</link>
            <guid>https://askaric.com/en/work/english/03vantage_english/3-8scenario_getalong.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[About grammar
1. infintives(to + verb)  
    a. After adjectives, you can use infinitives, especiall]]></description>
            <content:encoded><![CDATA[<h1 id="scernario-of-getting-along" tabindex="-1">scernario of getting along <a class="header-anchor" href="#scernario-of-getting-along" aria-label="Permalink to &quot;scernario of getting along&quot;"></a></h1>
<h2 id="about-grammar" tabindex="-1">About grammar <a class="header-anchor" href="#about-grammar" aria-label="Permalink to &quot;About grammar&quot;"></a></h2>
<ol>
<li>
<p>infintives(to + verb)<br>
a. After adjectives, you can use infinitives, especially in it clauses, This is common in generalizations.<br>
b. e.g. : It was impossible for her to have time for herself.<br>
c. Afeter nouns or pronouns, use infinitives to add more details or say how you use them.<br>
d. e.g. : We always has nice clothes to wear.</p>
</li>
<li>
<p>-ing forms(verb + -ing)<br>
a. You can also use -ing forms. This's common when people describe an actual experience.<br>
b. e.g. : I was a bit lonely being by myseld all the time.<br>
c. After these expressions, use -ing forms : have fun, have trouble/problem(s); be worth.<br>
d. e.g. : I had fun/no problems growing up in my family.</p>
</li>
</ol>
<h2 id="about-content" tabindex="-1">About content <a class="header-anchor" href="#about-content" aria-label="Permalink to &quot;About content&quot;"></a></h2>
<ol>
<li>talk about getting along with people.</li>
<li>use phrasal verbs.</li>
<li>use infinitives and -ing forms.</li>
<li>learn how to make your point clear.</li>
<li>use <code>I have to say</code> to make a strong point.</li>
</ol>
<h2 id="new-words" tabindex="-1">New words <a class="header-anchor" href="#new-words" aria-label="Permalink to &quot;New words&quot;"></a></h2>
<ol>
<li>infinitives</li>
<li>boomerang child</li>
<li>frankly</li>
<li>friction</li>
</ol>
<h2 id="new-phrases" tabindex="-1">New phrases <a class="header-anchor" href="#new-phrases" aria-label="Permalink to &quot;New phrases&quot;"></a></h2>
<ol>
<li>name calling</li>
<li>put up with</li>
<li>put off</li>
<li>come up/show up</li>
<li>go over</li>
<li>run out of</li>
<li>have friends over for dinner</li>
<li>wake up</li>
<li>give it back</li>
<li>clean up</li>
<li>put up with</li>
<li>look forward to</li>
<li>right away</li>
<li>desire for/yearn for</li>
<li>get on my feet</li>
</ol>
<h2 id="necessary-sentences" tabindex="-1">Necessary sentences <a class="header-anchor" href="#necessary-sentences" aria-label="Permalink to &quot;Necessary sentences&quot;"></a></h2>
<ol>
<li>I used to long for somewhere quiet to study.</li>
<li>move back in with my parents</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[scernario of a great read]]></title>
            <link>https://askaric.com/en/work/english/03vantage_english/3-9scenario_agreatread.html</link>
            <guid>https://askaric.com/en/work/english/03vantage_english/3-9scenario_agreatread.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[First of all
In this unit, I'll learn something below:
1. talk about literature, reading habits, and]]></description>
            <content:encoded><![CDATA[<h1 id="scernario-of-a-great-read" tabindex="-1">scernario of a great read <a class="header-anchor" href="#scernario-of-a-great-read" aria-label="Permalink to &quot;scernario of a great read&quot;"></a></h1>
<h2 id="first-of-all" tabindex="-1">First of all <a class="header-anchor" href="#first-of-all" aria-label="Permalink to &quot;First of all&quot;"></a></h2>
<p>In this unit, I'll learn something below:</p>
<ol>
<li>talk about literature, reading habits, and favorite authors.</li>
<li>avoid repeating words by using auxiliary verbs, to, and one(s).</li>
<li>use auxiliary verbs for emphasis.</li>
<li>use if so and if not instead of repeating ideas.</li>
</ol>
<h2 id="about-grammar" tabindex="-1">About grammar <a class="header-anchor" href="#about-grammar" aria-label="Permalink to &quot;About grammar&quot;"></a></h2>
<ol>
<li>
<p>You can avoid repeating words by using auxiliary verbs (e.g., be, have, do).<br>
a. The auxiliary can be in the same tense as the first verb.<br>
b. He's obviously enjoying it - as I am. (= am enjoying it)<br>
c. I think it's a great idea, but my family doesn't. (= doesn't think it's a great idea)<br>
d. I haven't been aboard. My friends haven't either. (= haven't been aboard)</p>
</li>
<li>
<p>The auxiliary can also be in a different tense.<br>
a. She obviously changed careers - a lot of people do theese days. (= change careers)<br>
b. I hope it works out. It did for me. (= worked out)</p>
</li>
<li>
<p>More on auxiliary verbs to avoid repetition.<br>
a. <strong>Simple present or past</strong> : I don't often take risks, but my best friend does all the time.<br>
b. <strong>Present or past continuous</strong> : I was hoping to graduate last year. One of my friends was, too.<br>
c. <strong>Present perfect (or continuous)</strong> : I've been thinking about settling down, but my friends haven't.<br>
d. <strong>Past perfect (or continuous)</strong> : I'd never has straight A's till this year, though my friends all had.<br>
e. <strong>Modal verbs</strong> : My dad can't understand why I want to travel, but my mom can.</p>
</li>
<li>
<p>You can use auxiliaries wirh too, witherm so, and neither to show similarity.<br>
a. I'm saving for a trip, and my best friend is, too. Or ... and so is my best friend.<br>
b. She doesn't enjoy her work, and I don't, either. Or ... and neither do I.<br>
c. She can't afford to go away next year, and I can't, either. Or ... and neither can I.</p>
</li>
<li>
<p>Use (to) do so to avoid repeating a verb + object or complement.<br>
a. Learning to play sports has given me confidence and will continue to do so for many years.<br>
b. Many people want to buy their own homw but are not in a position to do so.<br>
c. A lot of people want to publish novels but are unable to do do.<br>
d. Anyone who wishes to take a career break can do so if they plan it carefully.</p>
</li>
<li>
<p>Delete words or use one / ones.<br>
a. You can avoid repeating infinitive verb phrases by using <code>to</code> when it's clear what you mean.  (I would like to write like her, but I'll never be able to. I mean, I'd like to write like her --&gt; I mean, I'd like to.)<br>
b. Notice the negatives with try and prefer.  (I shouldn't read trashy novels, and I try not to read trashy novels --&gt; I try not to.)<br>
c. You can use one or ones to avoid repeating countbale nouns. Don't use them after my, your, his, etc., some, any, or both useless there is an adjective.  (I've read all her books, Her best one is ... or Of the books I read, the ones I like best are nonfiction)</p>
</li>
</ol>
<h2 id="new-words" tabindex="-1">New words <a class="header-anchor" href="#new-words" aria-label="Permalink to &quot;New words&quot;"></a></h2>
<ol>
<li>lucrative</li>
<li>dye</li>
<li>contemplate</li>
<li>dentistry</li>
<li>autobiography</li>
<li>memoir</li>
<li>wear --&gt; worn</li>
<li>contradictory</li>
<li>fabulous</li>
<li>uproot</li>
</ol>
<h2 id="new-phrases" tabindex="-1">New phrases <a class="header-anchor" href="#new-phrases" aria-label="Permalink to &quot;New phrases&quot;"></a></h2>
<ol>
<li>on the tip of my tongue</li>
<li>couldn't make heads or tails of them</li>
<li>get your head around</li>
<li>come to grips (with)</li>
<li>learned by heart (recite)</li>
<li>off the top of my head</li>
<li>nothing to come to mind</li>
<li>get something out of it</li>
<li>It's beyond me</li>
<li>stick in my mind</li>
<li>lost my train of thought</li>
</ol>
<h2 id="necessary-sentences" tabindex="-1">Necessary sentences <a class="header-anchor" href="#necessary-sentences" aria-label="Permalink to &quot;Necessary sentences&quot;"></a></h2>
<ol>
<li>I'm a bit confused.</li>
<li>I don't understand it clearly.</li>
<li>It's one I learned by heart when I was a kid.</li>
<li>It's beyound me why people think you should read the classic.</li>
<li>I don't see the point of it</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[How to prepare a IELTS exam]]></title>
            <link>https://askaric.com/en/work/english/04IELTS_exam/4-1week1_rules.html</link>
            <guid>https://askaric.com/en/work/english/04IELTS_exam/4-1week1_rules.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[Rules
 My Oral Problems
1. You are not willing to actively express yourself
2. You have trouble with]]></description>
            <content:encoded><![CDATA[<h1 id="how-to-prepare-a-ielts-exam" tabindex="-1">How to prepare a IELTS exam <a class="header-anchor" href="#how-to-prepare-a-ielts-exam" aria-label="Permalink to &quot;How to prepare a IELTS exam&quot;"></a></h1>
<h2 id="rules" tabindex="-1">Rules <a class="header-anchor" href="#rules" aria-label="Permalink to &quot;Rules&quot;"></a></h2>
<figure><img src="./../../../../images/english/04IELTS_exam/day1-IELTS-english.jpeg" alt="day1-IELTS" tabindex="0"><figcaption>day1-IELTS</figcaption></figure>
<h2 id="my-oral-problems" tabindex="-1">My Oral Problems <a class="header-anchor" href="#my-oral-problems" aria-label="Permalink to &quot;My Oral Problems&quot;"></a></h2>
<ol>
<li>You are not willing to actively express yourself</li>
<li>You have trouble with fluency</li>
<li>Pronunciation is not a problem</li>
<li>Not being sensitive to the tenses or accuracy of questions</li>
</ol>
<h2 id="plans" tabindex="-1">Plans <a class="header-anchor" href="#plans" aria-label="Permalink to &quot;Plans&quot;"></a></h2>
<ol>
<li>Besides the oral part, I also tested the <code>listening</code> and felt so bad, because of just finished part of them and right ratio is just 1/14.</li>
<li>So, I need put much more energy in <code>listening</code>, <code>reading</code> and <code>writing</code>. For oral part, the main aim should be keeping the feeling in oral part as usual, and trying to reach the fluent level.</li>
<li>I think my aimed score is 7 at oral part of IELTS.</li>
</ol>
<p>So, I wanna use 4 months to improve english, and everyday I'll put 2h, at the end day, adding up all of time, it should be 240h.</p>
<h2 id="tests" tabindex="-1">Tests <a class="header-anchor" href="#tests" aria-label="Permalink to &quot;Tests&quot;"></a></h2>
<p>I's my first time to test my oral english score for IELTS, which was powered by <code>liulishuo.IELTS</code>. And the result's showed below :</p>
<figure><img src="./../../../../images/english/04IELTS_exam/day1_oral_english_result_2023_04_04.jpeg" alt="day1_oral_english_result_2023_04_04" tabindex="0"><figcaption>day1_oral_english_result_2023_04_04</figcaption></figure>
<h2 id="progress" tabindex="-1">Progress <a class="header-anchor" href="#progress" aria-label="Permalink to &quot;Progress&quot;"></a></h2>
<ol>
<li>
<p>Week schedule</p>
<table tabindex="0">
<thead>
<tr>
<th></th>
<th>Saturday</th>
<th>Sunday</th>
<th>Monday</th>
<th>Tuesday</th>
<th>Wednesday</th>
<th>Thursday</th>
<th>Friday</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td></td>
<td></td>
<td>1.ÂæóÂà∞ÈõÖÊÄùÂê¨ÂäõÂíåÂè£ËØ≠ÁöÑÊµãËØïÁªìÊûú 2. ÂÆåÊàêÂè£ËØ≠ÁªÉ‰π†ÔºåÂú® <code>ÈõÖÊÄùËÄÉÊª°ÂàÜ</code></td>
<td>1. ÁúãÂπ∂ÊäÑÂΩï‰∏Ä‰ªΩ 7min ÁöÑ<a href="https://www.bilibili.com/video/BV1Rt411U7Ve" target="_blank" rel="noreferrer">‰πîÂ∏ÉÊñØÂÜÖÈÉ®ËßÜÈ¢ë</a>,ÁõÆÁöÑÊòØÂÖàÂê¨ 3 ÈÅçÔºåÂÜçËÉå‰∏ãÊù•ÔºåÂÜçÂê¨ÁúãÂØπÂê¨ÂäõÊòØÂê¶ÊúâÊîπÂñÑ(ÊúâÈÉ®ÂàÜÊîπÂñÑ) 2. ÁøªËØë‰πãÂâçÁöÑËã±ËØ≠Á¨îËÆ∞Êàê‰∏≠ÊñáÔºåÂπ∂Â§ç‰π†ÂÖ∂‰∏≠ÂÜÖÂÆπÔºàËØ≠Ê≥ïÔºåÂçïËØçÔºåËØçÁªÑÔºâ3. ÂÆåÊàê‰∏Ä‰∏™Âè£ËØ≠ÁªÉ‰π†Âú® <code>ÈõÖÊÄùËÄÉÊª°ÂàÜ</code></td>
<td>1. finish oral english homework. 2. finish one practice on <code>ÈõÖÊÄùËÄÉÊª°ÂàÜ</code></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Ëä±Ë¥πÊó∂Èó¥</td>
<td>None</td>
<td>None</td>
<td>3h(11:00 A.M.-2:00 A.M.)</td>
<td>5h(11:00 P.M.-5:00 A.M.)</td>
<td>1.5h(19:00 P.M.-20:30 P.M.)</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Daily progress</p>
<table tabindex="0">
<thead>
<tr>
<th>Date</th>
<th>Model Text</th>
<th>BestScore , BestTimeConsuming , MyBestScore , MyTimeConsuming</th>
</tr>
</thead>
<tbody>
<tr>
<td>2023-04-03</td>
<td>forgot to record</td>
<td>N/A</td>
</tr>
<tr>
<td>2023-04-04</td>
<td>Do you have patience? --&gt; I will be lying if I say I have patient. Even though I know that patient is one of the most important virtue that one can have. I'm not a patient person, I am always want to rush things no matter it's for work, or in my personal life, even a minute more, I'll consider it as a waste of time.</td>
<td>93, 35s,91,27s</td>
</tr>
<tr>
<td>2023-04-05</td>
<td>1. Do you have patience? --&gt; <a href="https://ielts.kmf.com/speaking/wechat/speakinfo?exam_unique=168069586533056514&amp;by_name=%25E5%25AD%25A6%25E5%2591%2598vQStk1" target="_blank" rel="noreferrer">My answer</a>, 2. What may distract you when you're trying to stay foucused? --&gt; <a href="https://ielts.kmf.com/speaking/wechat/speakinfo?exam_unique=168069625066321730&amp;by_name=%25E5%25AD%25A6%25E5%2591%2598vQStk1" target="_blank" rel="noreferrer">My answer</a>, 3. What do you do to help you concentrate? --&gt; <a href="https://ielts.kmf.com/speaking/wechat/speakinfo?exam_unique=168069661875421160&amp;by_name=%25E5%25AD%25A6%25E5%2591%2598vQStk1" target="_blank" rel="noreferrer">My answer</a>, 4. Is it difficult for you to stay focused on something? --&gt; <a href="https://ielts.kmf.com/speaking/wechat/speakinfo?exam_unique=168069700793308542&amp;by_name=%25E5%25AD%25A6%25E5%2591%2598vQStk1" target="_blank" rel="noreferrer">My answer</a></td>
<td>N/A</td>
</tr>
</tbody>
</table>
</li>
</ol>
<h2 id="new-words-phrase-sentences" tabindex="-1">New Words, Phrase, Sentences <a class="header-anchor" href="#new-words-phrase-sentences" aria-label="Permalink to &quot;New Words, Phrase, Sentences&quot;"></a></h2>
<p>This part is about new word I haven't seen and misunderstanding.</p>
<ol>
<li>monologue Áã¨ÁôΩ</li>
<li>interpret ËØ¥Êòé</li>
<li>corridor ÈÄöÈÅì</li>
<li>entrance to somewhere ÊüêÂú∞ÁöÑÂÖ•Âè£</li>
<li>look out onto ÂêëÂ§ñÁúãÂêë</li>
<li>be moved by Ë¢´ÊÑüÂä®</li>
<li>put out Âá∫Áâà</li>
<li>put out of Ê∂àÁÅ≠</li>
<li>it's what we are ËøôÂ∞±ÊòØÊàë‰ª¨ÔºàÂè£ËØ≠‰∏≠Áî®ÁöÑÊå∫È¢ëÁπÅÁöÑÂè•ÂûãÔºâ + about + doing/clause</li>
<li>intention --&gt; ÁõÆÁöÑ</li>
<li>deliberate --&gt; Ê∑±ÊÄùÁÜüËôëÁöÑÔºåÊïÖÊÑèÁöÑ</li>
<li>manifesto --&gt; Â£∞ÊòéÔºåÂÆ£Ë®Ä</li>
<li>phenomenal --&gt; Êù∞Âá∫ÁöÑÔºåÂèØÊÑüÁü•ÁöÑ</li>
<li>billboards --&gt; ÂπøÂëäÁâå</li>
<li>turn around --&gt; ËΩ¨ÂêëÂèçÊñπÂêëÔºå(ÁîüÊÑèÊàñÁªèÊµé) Â•ΩËΩ¨</li>
<li>estate --&gt; ÈÅó‰∫ß</li>
<li>representative --&gt; ÂÖ∏ÂûãÁöÑÔºåÊúâ‰ª£Ë°®ÊÄßÁöÑÔºå‰ª£Ë°®Ôºå‰ª£ÁêÜ‰∫∫</li>
<li>videotape --&gt; ÂΩïÂÉèÂ∏¶</li>
</ol>
<h2 id="puzzled-part" tabindex="-1">Puzzled Part <a class="header-anchor" href="#puzzled-part" aria-label="Permalink to &quot;Puzzled Part&quot;"></a></h2>
<p>This part isn't relevent to classes or plan I've made in daily life, but, which is the thing I feel puzzled when I was learning.</p>
<ol>
<li>Difference between <code>think about</code> and <code>consider doing</code><br>
In short, &quot;think about&quot; is more general and can refer to any kind of thought process, while &quot;consider doing&quot; usually implies a more focused thought process with the intention of making a decision.</li>
<li>Difference between <code>intention</code> and <code>aim</code>
The difference is that <code>intention</code> refers to objective thought process or actions, meanwhile, <code>aim</code> is more revelent to their subjective part of though process. For example of <code>aim</code>, I can make a sentence which's <code>I'm warring about if I can achieve my goal in the future</code>. If the scenario is I'am thinking about something in turly wold, the best choice should be <code>intention</code>.</li>
<li>Difference between <code>catastrophe</code> and <code>disaster</code><br>
Catastrophe is any large and disastrous event of great significance while disaster is an unexpected natural or man-made catastrophe of substantial extent</li>
<li>When do we use solve or resolve?<br>
This difference means that solve and resolve are often used in slightly different contexts. To generalise, we tend to solve something objective, and resolve something subjective.</li>
</ol>
]]></content:encoded>
            <enclosure url="https://askaric.com/images/english/04IELTS_exam/day1-IELTS-english.jpeg" length="0" type="image/jpeg"/>
        </item>
        <item>
            <title><![CDATA[Review what I've learned]]></title>
            <link>https://askaric.com/en/work/english/04IELTS_exam/4-2week2_review4B.html</link>
            <guid>https://askaric.com/en/work/english/04IELTS_exam/4-2week2_review4B.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[Progress
1. Week schedule
    | | Saturday | Sunday | Monday | Tuesday | Wednesday | Thursday | Frid]]></description>
            <content:encoded><![CDATA[<h1 id="review-what-i-ve-learned" tabindex="-1">Review what I've learned <a class="header-anchor" href="#review-what-i-ve-learned" aria-label="Permalink to &quot;Review what I've learned&quot;"></a></h1>
<h2 id="progress" tabindex="-1">Progress <a class="header-anchor" href="#progress" aria-label="Permalink to &quot;Progress&quot;"></a></h2>
<ol>
<li>
<p>Week schedule</p>
<table tabindex="0">
<thead>
<tr>
<th></th>
<th>Saturday</th>
<th>Sunday</th>
<th>Monday</th>
<th>Tuesday</th>
<th>Wednesday</th>
<th>Thursday</th>
<th>Friday</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td>1. listened some speeches of Elon Musk and Jack Ma and find out what sentences I should remember in my mind</td>
<td>1. recited every conversation of 4B book I've learned. 2. finished 2 topics in <code>ÈõÖÊÄùËÄÉÊª°ÂàÜ</code></td>
<td>1. reviewed what I've reviewed yestday of the 4B book. 2. finished 1 topics in <code>ÈõÖÊÄùËÄÉÊª°ÂàÜ</code></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Ëä±Ë¥πÊó∂Èó¥</td>
<td>3h</td>
<td>4h</td>
<td>2h(1:30 A.M.~3:30 A.M.)</td>
<td>3h(11:30 P.M.~2:30 A.M.)</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Daily progress</p>
<table tabindex="0">
<thead>
<tr>
<th>Date</th>
<th>Model Text</th>
<th>BestScore , BestTimeConsuming , MyBestScore , MyTimeConsuming</th>
</tr>
</thead>
<tbody>
<tr>
<td>2023-04-08</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr>
<td>2023-04-09</td>
<td><a href="https://ielts.kmf.com/speaking/wechat/speakinfo?exam_unique=168106106657616818&amp;by_name=%25E5%25AD%25A6%25E5%2591%2598vQStk1" target="_blank" rel="noreferrer">Topic-1 When do people smile to others? --&gt; My Answer</a>, <a href="https://ielts.kmf.com/speaking/wechat/speakinfo?exam_unique=168106178767317770&amp;by_name=%25E5%25AD%25A6%25E5%2591%2598vQStk1" target="_blank" rel="noreferrer">Topic-1 Do you smile when someone takes photos for you? --&gt; My Answer</a>, <a href="https://ielts.kmf.com/speaking/wechat/speakinfo?exam_unique=168106240036624335&amp;by_name=%25E5%25AD%25A6%25E5%2591%2598vQStk1" target="_blank" rel="noreferrer">Topic-1 Can you feel it when someone`s smile is fake? --&gt; My Answer</a>, <a href="https://ielts.kmf.com/speaking/wechat/speakinfo?exam_unique=168106258407798647&amp;by_name=%25E5%25AD%25A6%25E5%2591%2598vQStk1" target="_blank" rel="noreferrer">Topic-1 When was the last time you saw many people laughing? --&gt; My Answer</a>, <a href="https://ielts.kmf.com/speaking/wechat/speakinfo?exam_unique=168106276426192642&amp;by_name=%25E5%25AD%25A6%25E5%2591%2598vQStk1" target="_blank" rel="noreferrer">Topic-1 Do you like smiling? --&gt; My Answer</a>, <a href="https://ielts.kmf.com/speaking/wechat/speakinfo?exam_unique=168106314754511315&amp;by_name=%25E5%25AD%25A6%25E5%2591%2598vQStk1" target="_blank" rel="noreferrer">Topic-2 Do you think patience is important? --&gt; My Answer</a>, <a href="https://ielts.kmf.com/speaking/wechat/speakinfo?exam_unique=168106346585831496&amp;by_name=%25E5%25AD%25A6%25E5%2591%2598vQStk1" target="_blank" rel="noreferrer">Topic-2 Do you have patience? --&gt; My Answer</a>, <a href="https://ielts.kmf.com/speaking/wechat/speakinfo?exam_unique=168106390144226300&amp;by_name=%25E5%25AD%25A6%25E5%2591%2598vQStk1" target="_blank" rel="noreferrer">Topic-2 How to improve patience? --&gt; My Answer</a>, <a href="https://ielts.kmf.com/speaking/wechat/speakinfo?exam_unique=168106404944697395&amp;by_name=%25E5%25AD%25A6%25E5%2591%2598vQStk1" target="_blank" rel="noreferrer">Topic-2 Do you think you're more patient than before? --&gt; My Answer</a></td>
<td>N/A</td>
</tr>
<tr>
<td>2023-04-10</td>
<td><a href="https://ielts.kmf.com/speaking/wechat/speakinfo?exam_unique=168115414262822864&amp;by_name=%25E5%25AD%25A6%25E5%2591%2598vQStk1" target="_blank" rel="noreferrer">Topic-1 What do you think makes a good friend? --&gt; My Answer</a>, <a href="https://ielts.kmf.com/speaking/wechat/speakinfo?exam_unique=168115537707492161&amp;by_name=%25E5%25AD%25A6%25E5%2591%2598vQStk1" target="_blank" rel="noreferrer">Topic-1 Do you think you are a good friend to others? --&gt; My Answer</a>, <a href="https://ielts.kmf.com/speaking/wechat/speakinfo?exam_unique=168115479823260505&amp;by_name=%25E5%25AD%25A6%25E5%2591%2598vQStk1" target="_blank" rel="noreferrer">Topic-1 What kinds of people do you like to make friends with? --&gt; My Answer</a>, <a href="https://ielts.kmf.com/speaking/wechat/speakinfo?exam_unique=168115452839393063&amp;by_name=%25E5%25AD%25A6%25E5%2591%2598vQStk1" target="_blank" rel="noreferrer">Topic-1 Do you keep in touch with friends from your childhood? --&gt; My Answer</a></td>
<td>N/A</td>
</tr>
<tr>
<td>2023-04-11</td>
<td>1. reviewed 4A book. 2. finished homework 3. tested there extra topics: Chocolate, Small Bussiness, Weekends</td>
<td>N/A</td>
</tr>
</tbody>
</table>
</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[How to use grammars to present you are worth rewarding in TELTS]]></title>
            <link>https://askaric.com/en/work/english/04IELTS_exam/4-3week3_stragegy.html</link>
            <guid>https://askaric.com/en/work/english/04IELTS_exam/4-3week3_stragegy.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[Progress
1. Week schedule
    | | Saturday | Sunday | Monday | Tuesday | Wednesday | Thursday | Frid]]></description>
            <content:encoded><![CDATA[<h1 id="how-to-use-grammars-to-present-you-are-worth-rewarding-in-telts" tabindex="-1">How to use grammars to present you are worth rewarding in TELTS <a class="header-anchor" href="#how-to-use-grammars-to-present-you-are-worth-rewarding-in-telts" aria-label="Permalink to &quot;How to use grammars to present you are worth rewarding in TELTS&quot;"></a></h1>
<h2 id="progress" tabindex="-1">Progress <a class="header-anchor" href="#progress" aria-label="Permalink to &quot;Progress&quot;"></a></h2>
<ol>
<li>
<p>Week schedule</p>
<table tabindex="0">
<thead>
<tr>
<th></th>
<th>Saturday</th>
<th>Sunday</th>
<th>Monday</th>
<th>Tuesday</th>
<th>Wednesday</th>
<th>Thursday</th>
<th>Friday</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td></td>
<td></td>
<td>1. have seen the second season of „ÄäOld Friends„Äã 2. recited tense grammar skill of IELTS speaking</td>
<td>have seen a half of the first season of „ÄäOld Friends„Äã</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Time Consuming</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Daily progress</p>
<table tabindex="0">
<thead>
<tr>
<th>Date</th>
<th>Model Text</th>
<th>BestScore , BestTimeConsuming , MyBestScore , MyTimeConsuming</th>
</tr>
</thead>
<tbody>
<tr>
<td>2023-04-22</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr>
<td>2023-04-23</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr>
<td>2023-04-24</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr>
<td>2023-04-25</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr>
<td>2023-04-26</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr>
<td>2023-04-27</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr>
<td>2023-04-28</td>
<td>N/A</td>
<td>N/A</td>
</tr>
</tbody>
</table>
</li>
</ol>
<h2 id="new-words" tabindex="-1">New Words <a class="header-anchor" href="#new-words" aria-label="Permalink to &quot;New Words&quot;"></a></h2>
<ol>
<li>anecdote</li>
<li>astonishing</li>
<li>nuisance/peeve</li>
<li>pet peeve</li>
<li>tacitly/ tacitly imply</li>
<li>discern</li>
<li>advocate</li>
<li>aim to</li>
</ol>
<h2 id="speaking-grammar-stragegy" tabindex="-1">Speaking grammar stragegy <a class="header-anchor" href="#speaking-grammar-stragegy" aria-label="Permalink to &quot;Speaking grammar stragegy&quot;"></a></h2>
<ol>
<li>
<p>Which one restaurant do you usually go? --&gt; I've been going to an Italian restaurant. Actually, I've been there at least 10 times. I remember the first time I went there was last year. I was looking forward to a place to have dinner. I checked reviews online and found it. Let's have it a try/shot. Finally, It turned out to be amazing.</p>
</li>
<li>
<p>As a matter of fact, this pattern uses three tense to response, that's more likely to get high score, though without hard and abundant words.</p>
</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[How to prepare part 2 of IELTS]]></title>
            <link>https://askaric.com/en/work/english/04IELTS_exam/4-4week4_IELTS_part2.html</link>
            <guid>https://askaric.com/en/work/english/04IELTS_exam/4-4week4_IELTS_part2.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[Progress
1. Week schedule
2. Daily progress
 New Words
1. loads of
2. a wide variety of
3. range fro]]></description>
            <content:encoded><![CDATA[<h1 id="how-to-prepare-part-2-of-ielts" tabindex="-1">How to prepare part 2 of IELTS <a class="header-anchor" href="#how-to-prepare-part-2-of-ielts" aria-label="Permalink to &quot;How to prepare part 2 of IELTS&quot;"></a></h1>
<h2 id="progress" tabindex="-1">Progress <a class="header-anchor" href="#progress" aria-label="Permalink to &quot;Progress&quot;"></a></h2>
<ol>
<li>
<p>Week schedule</p>
</li>
<li>
<p>Daily progress</p>
</li>
</ol>
<h2 id="new-words" tabindex="-1">New Words <a class="header-anchor" href="#new-words" aria-label="Permalink to &quot;New Words&quot;"></a></h2>
<ol>
<li>loads of</li>
<li>a wide variety of</li>
<li>range from</li>
<li>phonic</li>
<li>imparts</li>
<li>have time to myself</li>
<li>common english expressions</li>
<li>demanding</li>
<li>arouse</li>
<li>interpretation and explanation</li>
<li>tabs and sub-catagories</li>
<li>the arrival of my parcel</li>
<li>no sign of</li>
<li>representative</li>
<li>alternatively/ who listened alternatively to my compaint</li>
<li>empathy/sympathy/enthusiasm/hypotheticalÔºàthough the're not the sameÔºâ</li>
<li>I was consistently surprised by</li>
<li>take a load off my mind</li>
<li>If you want to reach somebody, call him / reach up to/ up to/ reach up</li>
<li>I was valued as a customer</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Record your English learning process]]></title>
            <link>https://askaric.com/en/work/english/</link>
            <guid>https://askaric.com/en/work/english/</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[Previously on this story
 Spoken English learning
I maintained my oral English learning at the rate ]]></description>
            <content:encoded><![CDATA[<h1 id="record-your-english-learning-process" tabindex="-1">Record your English learning process <a class="header-anchor" href="#record-your-english-learning-process" aria-label="Permalink to &quot;Record your English learning process&quot;"></a></h1>
<h2 id="previously-on-this-story" tabindex="-1">Previously on this story <a class="header-anchor" href="#previously-on-this-story" aria-label="Permalink to &quot;Previously on this story&quot;"></a></h2>
<h2 id="spoken-english-learning" tabindex="-1">Spoken English learning <a class="header-anchor" href="#spoken-english-learning" aria-label="Permalink to &quot;Spoken English learning&quot;"></a></h2>
<p>I maintained my oral English learning at the rate of one hour a week, and took some study notes here, which is helpful for future review.</p>
<h2 id="ielts-exam" tabindex="-1">IELTS Exam <a class="header-anchor" href="#ielts-exam" aria-label="Permalink to &quot;IELTS Exam&quot;"></a></h2>
<p>On March 25, 2023, I am desperate to get a phased result for my English learning process, so I have dedicated my English course to &quot;IELTS&quot;. You can see some of my progress in the <strong>&quot;[IELTS_exam]&quot;</strong> directory!</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Optmizer Implmentations]]></title>
            <link>https://askaric.com/en/work/optimizer/01Optimizer Implementation.html</link>
            <guid>https://askaric.com/en/work/optimizer/01Optimizer Implementation.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[History
1. Time Line : Heuristics --
2. Top-down and Bottom-up Optimization
    - 123
    - sdf
 Sou]]></description>
            <content:encoded><![CDATA[<h1 id="optmizer-implmentations" tabindex="-1">Optmizer Implmentations <a class="header-anchor" href="#optmizer-implmentations" aria-label="Permalink to &quot;Optmizer Implmentations&quot;"></a></h1>
<h2 id="history" tabindex="-1">History <a class="header-anchor" href="#history" aria-label="Permalink to &quot;History&quot;"></a></h2>
<ol>
<li>Time Line : Heuristics --&gt; Heuristics + Cost-based Join Search --&gt; Randomized Search --&gt; Stratified Search --&gt; Unified Search</li>
<li>Top-down and Bottom-up Optimization
<ul>
<li>123</li>
<li>sdf</li>
</ul>
</li>
</ol>
<h2 id="sources" tabindex="-1">Sources <a class="header-anchor" href="#sources" aria-label="Permalink to &quot;Sources&quot;"></a></h2>
<ol>
<li><a href="https://www.youtube.com/watch?v=PXS49-tFLcI" target="_blank" rel="noreferrer">Query Optimizer Implementations</a></li>
<li><a href="http://accelazh.github.io/images/query-optimizer-volcano-cascades.pdf" target="_blank" rel="noreferrer">query-optimizer-volcano-cascades</a></li>
</ol>
<h2 id="tidb-implmentation" tabindex="-1">TiDB Implmentation <a class="header-anchor" href="#tidb-implmentation" aria-label="Permalink to &quot;TiDB Implmentation&quot;"></a></h2>
<h2 id="pg-implmentation" tabindex="-1">PG Implmentation <a class="header-anchor" href="#pg-implmentation" aria-label="Permalink to &quot;PG Implmentation&quot;"></a></h2>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[It just has chinese version and I've stop updating doc about Oracle.]]></title>
            <link>https://askaric.com/en/work/oracle/</link>
            <guid>https://askaric.com/en/work/oracle/</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="it-just-has-chinese-version-and-i-ve-stop-updating-doc-about-oracle" tabindex="-1">It just has chinese version and I've stop updating doc about Oracle. <a class="header-anchor" href="#it-just-has-chinese-version-and-i-ve-stop-updating-doc-about-oracle" aria-label="Permalink to &quot;It just has chinese version and I've stop updating doc about Oracle.&quot;"></a></h1>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[It just has chinese version and I've stop updating doc about SQL Server.]]></title>
            <link>https://askaric.com/en/work/sqlserver/</link>
            <guid>https://askaric.com/en/work/sqlserver/</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="it-just-has-chinese-version-and-i-ve-stop-updating-doc-about-sql-server" tabindex="-1">It just has chinese version and I've stop updating doc about SQL Server. <a class="header-anchor" href="#it-just-has-chinese-version-and-i-ve-stop-updating-doc-about-sql-server" aria-label="Permalink to &quot;It just has chinese version and I've stop updating doc about SQL Server.&quot;"></a></h1>
]]></content:encoded>
        </item>
        <item>
            <link>https://askaric.com/en/work/tidb/03TiDB-Maintaining/TiDB Metrics/TIDB Panel - KV Backoff OPS.html</link>
            <guid>https://askaric.com/en/work/tidb/03TiDB-Maintaining/TiDB Metrics/TIDB Panel - KV Backoff OPS.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
        </item>
        <item>
            <link>https://askaric.com/en/work/tidb/03TiDB-Maintaining/TiDB Metrics/TiDB Panel - Disconnection Count.html</link>
            <guid>https://askaric.com/en/work/tidb/03TiDB-Maintaining/TiDB Metrics/TiDB Panel - Disconnection Count.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
        </item>
        <item>
            <title><![CDATA[The Prometheus of TiDB]]></title>
            <link>https://askaric.com/en/work/tidb/03TiDB-Maintaining/TiDB Metrics/TiDB-Prometheus.html</link>
            <guid>https://askaric.com/en/work/tidb/03TiDB-Maintaining/TiDB Metrics/TiDB-Prometheus.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[# The Prometheus of TiDB

If you need 100% accuracy, such as billing on request, Prometheus is not a good choice because the data collected may not be detailed and complete enough. In this case, you are better off using other systems to collect and analyze the billing data, and using Prometheus for the rest of the monitoring.

## 1. Prometheus Feature Definition

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; On the basis of the definition of [the Prometheus's official website](https://prometheus.io/docs/introduction/overview/#what-is-prometheus), Prometheus Is an open source, system monitoring and alert toolkit. It has the following characteristics:

1. **Multi-dimensional sequential data:** Prometheus provides a multi-dimensional data model based on time series by appending key-value pairs.
2. **Query Statement support:** Prometheus Support PromQL allows slicing of time series data to generate charts, tables, and alerts. PromQL, similar to SQL, is a declarative query language; Prometheus provides a variety of functional implementations, aggregation of timing data such as rate, irate, delta, and so on.
3. **Excellent visual quality:** Prometheus supports a variety of visual modes, such as a built-in Dashboard browser or an integrated Grafana.
4. **Efficient storage:** Prometheus stores time series in memory and local disks in a custom format, scaled by sharding and union. Since v2, Prometheus has implemented LSM database-like structures such as blocks, WAL, and Compaction. Compaction prevents random reads and writes and compacts read and write faster.
5. **Easy to deploy:** Prometheus is written in Go, each server relies only on local storage, independent, reliable, and easy to deploy.
6. **Alarm system accuracy:** Prometheus alarms are handled by alertManager according to PromQL definition.
7. **Multi-client support:** Prometheus supports over a dozen language client libraries, allowing lightweight detection services and easy implementation of custom libraries.
8. **Numerous third-party integrations:** Prometheus makes it easy to connect with third party exporter data. Such as system information, Docker, HAProxy, JMX and other indicators. The TiDB monitoring system uses the three open source exporters, such as Node_exporter and Blackbox_exporter, to monitor the operating system and network status.

## Prometheus Logical Structure

```yaml
Time Series Data  

Data Schema : idnetifier -> (t0, v0),(t1, v1),(t3, v3)...
Prometheus Data Model : <metric name{<label name>=<label value>, ...}
Typical set of identifiers :  
```

| Merics Name | Labels | Timestamp | Sample Value |
| - | - | - | - |
| {__name__}="" |  | @143417561287 | 94934 |
| {__name__}="" |  | @143417561287 | 94934 |
| {__name__}="" |  | @143417561287 | 94934 |

![Prometheus01](../../../../../images/tidb/03TiDB-Maintaining/Prometheus01.png)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The Prometheus Metric with the Label is broken up into a finite number of metrics, reflected as points on a two-dimensional plane, and aggregated by 'intersection' or 'union' during computation. The change of each indicator value over time is saved in a file, which realizes parallel read and write and greatly improves performance.

## 3. Prometheus Time Filtering

Instantaneous vector filter: select the time series of a group of labels and the corresponding single sample value within the specified time stamp;

Like Ôºö`tidb_server_handle_query_duration_seconds_bucket{tidb_cluster="$tidb_cluster",type="select"}`, which means that the tidb_server_handle_query_duration_seconds index in TiDB obtains the instantaneous sample value of the current time under the combination of the `tidb_cluster` and `type` tags.

Interval vector filter: define the index time range through '[]' to obtain the single sample value of the index within all time ranges of 'instantaneous vector filter';

Â¶ÇÔºö`tidb_server_handle_query_duration_seconds_bucket{tidb_cluster="$tidb_cluster",type="select"}`, Specifies all the values of the tidb_server_handle_query_duration_seconds_bucket index in the TIDB time range.

Time shift operation: specify the time offset from the current time by `offset`;
Like : `tidb_server_handle_query_duration_seconds_bucket offset 5m`, Specifies the instantaneous value of the tidb_server_handle_query_duration_seconds_bucket index in the TIDB 5 minutes earlier.

## 4. Prometheus Aggregation Operation

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For example, tidb_server_handle_query_duration_seconds_bucket Metric, which consists of Label instance, job, le, and sql_type, is used.

```json
{ 
    name = "tidb_server_handle_query_duration_seconds_bucket", # Metric Name : __name__
    instance = "172.16.6.155:10080",                           # Label : instance
    job = "tidb",                                              # Label : job
    le = "+Inf",                                               # Label : le
    sql_type = "Select"                                        # Label : sql_type
}
```

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Assume that `tidb_server_handle_query_duration_seconds_bucket {instance = "172.16.6.155:10080", sql_type = "Select", le = "+Inf"} [2m]`'s instantaneous value. The first step is to reconstruct the data from the prometheus storage after intercepting the data for the corresponding period. The second step, take the intersection file results Metric all values within 2 min.
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**NoticeÔºö**The purpose of the first inversion is to achieve fast merge lookup in an ordered array, which is a performance-based operation.

![Prometheus02](../../../../../images/tidb/03TiDB-Maintaining/prometheus02.png)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Converge the results in the Prometheus Dashboard, as shown in the following figure.

![Prometheus03](../../../../../images/tidb/03TiDB-Maintaining/prometheus03.jpg)

## ‰∫î„ÄÅPrometheus Indicator Type

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;According to the website [promehteus](https://prometheus.fuckcloudnative.io/di-er-zhang-gai-nian/metric_types) index type is confined to the client side, On the server side, indicator types are not distinguished and are regarded as unordered time sequence data. So why distinguish between different indicator types?  

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The data flow after Prometheus encapsulated in TiDB is shown below;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;![Prometheus04](../../../../../images/tidb/03TiDB-Maintaining/prometheus04.png)

### 5.1 Counter

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Counter Á±ªÂûãË°®Á§∫Ê†∑Êú¨Êï∞ÊçÆÂçïË∞ÉÈÄíÂ¢ûÔºåÂç≥Âè™Â¢û‰∏çÂáèÔºåÈô§ÈùûÁõëÊéßÁ≥ªÁªüÂèëÁîü‰∫ÜÈáçÁΩÆ„ÄÇ‰æãÂ¶ÇÔºösql statement operation per second„ÄÇ

### 5.2 Gauge

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gauge Á±ªÂûãË°®Á§∫Ê†∑Êú¨Êï∞ÊçÆÂèØ‰ª•‰ªªÊÑèÂèòÂåñÁöÑÊåáÊ†áÔºåÂç≥ÂèØÂ¢ûÂèØÂáè„ÄÇ‰æãÂ¶ÇÔºötikv region ÁöÑÊï∞ÈáèÔºõ

### 5.3 Histogram

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Histogram Á±ªÂûãÂú®‰∏ÄÊÆµÊó∂Èó¥ËåÉÂõ¥ÂÜÖÂØπÊï∞ÊçÆËøõË°åÈááÊ†∑ÔºåÂ∞ÜÂÖ∂ËÆ∞ÂÖ•Ëá™ÂÆö‰πâÈÖçÁΩÆÁöÑ bucket ‰∏≠ÔºåÂêéÁª≠ÂèØÈÄöËøáÂà∂ÂÆöÂå∫Èó¥ÂØπÁ≠õÈÄâÊï∞ÊçÆ„ÄÅÁªüËÆ°Ê†∑Êú¨Êï∞ÈáèÔºåÊúÄÂêéÂëàÁé∞Âá∫Áõ¥ÊñπÂõæÁöÑË°®Áé∞ÂΩ¢Âºè„ÄÇ

### 5.4 Summary

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Summary ‰∏é Histogram ÁöÑÂäüËÉΩÁ±ª‰ººÔºåË°®Á§∫‰∏ÄÊÆµÊó∂Èó¥ÂÜÖÁöÑÊï∞ÊçÆÊ†∑Êú¨ÁªìÊûúÔºåÂå∫Âà´‰ΩìÁé∞Âú®ËÆ°ÁÆóÂàÜ‰ΩçÊï∞Êó∂ summary Áõ¥Êé•Âü∫‰∫é client Á´ØÂ≠òÂÇ®ÁöÑÊ†∑Êú¨Êï∞ÊçÆËÆ°ÁÆóÂá∫ÁôæÂàÜ‰ΩçÁªìÊûúÂÄºÔºåÂæÖ prometheus ÂÆöÊúü pull Êï∞ÊçÆÊó∂__Â≠òÂÇ®ÁôæÂàÜ‰ΩçÁªìÊûúÂÄº__„ÄÇËÄå Histogram ÂàôÊòØÂ∞Ü__Â≠òÂÇ®ÁöÑÊ†∑Êú¨Êï∞ÊçÆ__Â≠òÂÇ®Âà∞ prometheus ‰∏≠„ÄÇ

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__Ê≥®ÊÑè__ÔºöÊ†πÊçÆ Breezewish Âú® [TiKV Ê∫êÁ†ÅËß£ÊûêÁ≥ªÂàóÊñáÁ´†Ôºà‰∏âÔºâPrometheusÔºà‰∏äÔºâ](https://pingcap.com/zh/blog/tikv-source-code-reading-3) ‰∏≠‰ªãÁªçÁöÑ __‚Äúrust-prometheus Â∫ìÁõÆÂâçËøòÂè™ÂÆûÁé∞‰∫ÜÂâç‰∏âÁßç„ÄÇTiKV Â§ßÈÉ®ÂàÜÊåáÊ†áÈÉΩÊòØ Counter Âíå HistogramÔºåÂ∞ëÈÉ®ÂàÜÊòØ Gauge‚Äù__ ÔºåÂèØ‰ª•ÂèëÁé∞ rust prometheus client Âπ∂Ê≤°ÊúâÂÆûÁé∞ summary Á±ªÂûãÔºåÂπ∂‰∏îÂú® tikv ‰∏≠‰∏ªË¶ÅÊòØÁî®ÂÖ∂‰ªñ‰∏âÁßçÁ±ªÂûã„ÄÇSummary Á±ªÂûãÂú® [rust prometheus client doc](https://docs.rs/prometheus/latest/prometheus/proto/enum.MetricType.html?search=summary#variant.SUMMARY) Âè™ÊúâÂØπÂ∫îÁöÑ protocol type ÂÆö‰πâÔºåËÄåÊ≤°ÊúâÂØπÂ∫îÁöÑ struct ÂÆûÁé∞„ÄÇ

## ÂÖ≠„ÄÅprometheus ËÅöÂêàÂáΩÊï∞

### 6.1 Rate

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‰ªé‰ª£Á†ÅÁúã [Rate](https://github.com/prometheus/prometheus/blob/9fcf0b3d46cc3cdff96e6e7baabfaf63d89a5a9d/promql/functions.go#L134-L146) ÂáΩÊï∞ÂÜÖÈÉ®Ë∞ÉÁî® [extrapolatedRate](https://github.com/prometheus/prometheus/blob/9fcf0b3d46cc3cdff96e6e7baabfaf63d89a5a9d/promql/functions.go#L59) ËÆ°ÁÆóÔºåÁªèËøáÁÆÄÂåñÂêé‰ª£Á†ÅÂ¶Ç‰∏ãÔºõ

```go
func extrapolatedRate(vals []parser.Value, args parser.Expressions, enh *EvalNodeHelper, isCounter, isRate bool) Vector {
 ms := args[0].(*parser.MatrixSelector)
 vs := ms.VectorSelector.(*parser.VectorSelector)
 var (
  samples    = vals[0].(Matrix)[0]                                        // Ê†∑Êú¨ÁõëÊéßÊï∞ÊçÆ
  rangeStart = enh.Ts - durationMilliseconds(ms.Range+vs.Offset)          // Ê†∑Êú¨ÂºÄÂßãÊó∂Èó¥
  rangeEnd   = enh.Ts - durationMilliseconds(vs.Offset)                   // Ê†∑Êú¨ÁªàÊ≠¢Êó∂Èó¥
 )
    resultValue := samples.Points[len(samples.Points)-1].V - samples.Points[0].V// ÁªàÊ≠¢Êó∂Èó¥Ê†∑Êú¨Êï∞ÊçÆÂáèÂºÄÂßãÊó∂Èó¥Ê†∑Êú¨Êï∞ÊçÆ
 if isCounter {
  var lastValue float64                                                   // Counter Á±ªÂûã‰ºöÂæ™ÁéØÊó∂Èó¥Âå∫Èó¥ÂÜÖÊï∞ÊçÆ
  for _, sample := range samples.Points {                                 // ÔºåÂ¶ÇÊûú‰∏ã‰∏Ä‰∏™ÂÄºÊØî‰∏ä‰∏Ä‰∏™ÂÄºÂ§ßÔºåËØ¥ÊòéÂèë
   if sample.V < lastValue {                                           // Áîü‰∫ÜËÆ°Êï∞Âô®ÈáçÁΩÆÔºåÂ¶Ç: ËøõÁ®ã crash Êï∞
    resultValue += lastValue                                        // ÊçÆ‰∏¢Â§±Ôºå‰ºöË°•‰∏ä crash ÂêéÈù¢ÁöÑÂ¢ûÈáè„ÄÇ
   }
   lastValue = sample.V
  }
 }
    // Ê†∑Êú¨ÂºÄÂßãÊó∂Èó¥ÁÇπÊåÅÁª≠ÁöÑÊó∂Èó¥Âà∞ÔºåÂΩìÂâçÊó∂Èó¥ÂâçÊé®ÂêéÁöÑÊó∂Èó¥Ë∑ùÁ¶ªÔºåÂ¶Ç: ÊåáÊ†á X[1m] ‰∏∫ X ÂâçÊé® 1minÔºåÂΩìÂâçÊó∂Èó¥ 02:03:02 ÔºåÈÇ£‰πàÂâçÊé®ÁªìÊûú‰∏∫
    // 02:02:02Ôºå‰πüÂ∞±ÊòØÂèñ 02:02:02 --> 02:03:02 Âå∫Èó¥ÂÜÖÁöÑÊâÄÊúâÊï∞ÊçÆ„ÄÇÂÅáËÆæÊåáÊ†áÊØè 15s Èáá‰∏ÄÊ¨°ÔºåÂç≥: ÈááÈõÜÊó∂Èó¥ÁÇπ‰∏∫ [02:02:16„ÄÅ02:0
    // 2:31„ÄÅ02:02:46„ÄÅ02:03:01];
    // ÈÇ£‰πà durationToStart ‰∏∫ 02:02:16 - 02:02:02 = 00:00:14;
    // ÂêåÁêÜ durationToEnd   ‰∏∫ 02:03:02 - 02:03:01 = 00:00:01;    
    durationToStart := float64(samples.Points[0].T-rangeStart) / 1000           
 durationToEnd := float64(rangeEnd-samples.Points[len(samples.Points)-1].T) / 1000 // 
                                                     
    // sampledInterval Ë°®Á§∫Ê†∑Êú¨Êï∞ÊçÆÁöÑÁ¨¨‰∏Ä‰∏™ÁÇπÂíåÊúÄÂêé‰∏Ä‰∏™ÁÇπÈó¥ÁöÑÊó∂Èó¥Èó¥Èöî;
 sampledInterval := float64(samples.Points[len(samples.Points)-1].T-samples.Points[0].T) / 1000
    // averageDurationBetweenSamples Ë°®Á§∫Ê†∑Êú¨Êï∞ÊçÆÂú®Âå∫Èó¥ÂÜÖÊØè‰∏™ÁÇπÁöÑÊó∂Èó¥Èó¥ÈöîÔºåÈªòËÆ§ÊòØ 15s;
 averageDurationBetweenSamples := sampledInterval / float64(len(samples.Points)-1)

    if isCounter && resultValue > 0 && samples.Points[0].V >= 0 {
        // Âú® Counter ÊåáÊ†áÁ±ªÂûãÊó∂ÔºåÁî®ÊñúÁéáÂÖ¨Âºè ‚ÄúÈõ∂ÁÇπÊó∂Èó¥/Âå∫Èó¥Êó∂Èó¥ = ÂºÄÂßãÊó∂Èó¥Ê†∑Êú¨ÂÄº/ÁªìÊùüÊó∂Èó¥Âà∞ÂºÄÂßãÊó∂Èó¥Ê†∑Êú¨Â¢ûÈáè‚Äù ÁÆóÂá∫ Êé®Êñ≠ÁöÑÂ§ñÂª∂Êó∂Èó¥ÁÇπ
        durationToZero := sampledInterval * (samples.Points[0].V / resultValue)
        // Â¶ÇÊûú durationToZero ‰Ωé‰∫é durationToStartÔºåÈÄâÂèñËÆ°Êó∂Âô®ÈáçÁΩÆÁöÑÊó∂Èó¥ÁÇπÂà∞Á¨¨‰∏Ä‰∏™ÈááÊ†∑Êó∂Èó¥ÁÇπÁöÑÊó∂Èó¥Âå∫Èó¥‰Ωú‰∏∫ durationToStart
        if durationToZero < durationToStart {
            durationToStart = durationToZero
        }
 }

    extrapolationThreshold := averageDurationBetweenSamples * 1.1
 extrapolateToInterval := sampledInterval

    // Êé®Êñ≠ÂäüËÉΩ‰∏ªË¶ÅËß£ÂÜ≥ÔºåÊúÄÂêé‰∏Ä‰∏™ÈááÊ†∑ÁÇπÂèëÁîüÊó∂Èó¥Âà∞Êü•ËØ¢Êó∂Èó¥Â≠òÂú®‰∏ÄÂÆöË∑ùÁ¶ªÔºåÂç≥ÔºöÊü•ËØ¢ÁöÑÊòØ 02:03:02 ÁöÑÁªìÊûúÔºå‰ΩÜ prometheus ÊúÄÂêé‰∏ÄÊ¨°ÊãâÊï∞ÊçÆ‰∏∫ 02:03:01
    // Âõ†‰∏∫ËÆæÂÆö‰∫Ü‰∏Ä‰∏™ÈòàÂÄº extrapolationThresholdÔºåÂ¶ÇÊûúË∂ÖËøáËøõË°å‰∏ÄÂÆöËøΩÂä†ÔºåËææÂà∞Âª∂ÈïøÊó∂Èó¥ÈááÊ†∑ÁÇπËá≥Êü•ËØ¢ÁõÆÂú∞Êó∂Èó¥ÁöÑÁõÆÁöÑÔºõ
    // ÊúÄÂêéÔºåÈÄöËøáÂÖ¨Âºè ‚ÄúÊé®Êñ≠ÁªìÊûú/ÁúüÂÆûÁªìÊûú = Êé®Êñ≠Ê†∑Êú¨Êó∂Èó¥/ÁúüÂÆûÊ†∑Êú¨Êó∂Èó¥‚Äù Ëß£Âá∫ ‚ÄúÊü•ËØ¢Êó∂Èó¥ÔºåÂ¶Ç 02:03:02 ÁöÑÊé®Êñ≠ÁªìÊûú‚ÄùÔºõ
    // ‰ª£Á†Å‰∏∫ resultValue = resultValue * (extrapolateToInterval / sampledInterval)
 if durationToStart < extrapolationThreshold {                   
  extrapolateToInterval += durationToStart                    
 } else {
  extrapolateToInterval += averageDurationBetweenSamples / 2  
 }
 if durationToEnd < extrapolationThreshold {
  extrapolateToInterval += durationToEnd                      
 } else {
  extrapolateToInterval += averageDurationBetweenSamples / 2  
 }
 resultValue = resultValue * (extrapolateToInterval / sampledInterval) 
 if isRate {
  resultValue = resultValue / ms.Range.Seconds()             
 }

 return append(enh.Out, Sample{
  Point: Point{V: resultValue},
 })
```

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ÂáΩÊï∞ÊÑè‰πâÔºöËÆ°ÁÆóÂå∫Èó¥ÊåáÊ†áÊó∂Èó¥Á™óÂè£ÂÜÖÂπ≥ÂùáÂ¢ûÈïøÈÄüÁéá„ÄÇ

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‰ªé‰ª£Á†ÅÁúã [funcRate](https://github.com/prometheus/prometheus/blob/9fcf0b3d46cc3cdff96e6e7baabfaf63d89a5a9d/promql/functions.go#L139) Ë∞ÉÁî®ËøîÂõû `extrapolatedRate(vals, args, enh, true, true)`„ÄÇ‰æùÊçÆ‰∏äÊñáËß£ËØªÔºå‰ºöËøîÂõûÊ†∑Êú¨Âå∫Èó¥ÂÜÖ (ÊúÄÂ§ßÂÄº-ÊúÄÂ∞èÂÄº)/Êó∂Èó¥Âå∫Èó¥ÁöÑÁªìÊûúÔºåÂõ†‰∏∫ counter Êàñ histogram(ÂÜÖÈÉ®Â∞ÅË£Ö‰∫Ü counter) ÊòØÁ¥ØËÆ°ÂÄºÔºåÊÑèÂë≥ÁùÄÈöèÊó∂Èó¥Â¢ûÈïøÁõëÊéßÊåáÊ†áÂßãÁªàÂ¢ûÈïø„ÄÇÈÄöËøáËÆ°ÁÆóÈááÊ†∑Êó∂Èó¥ÁöÑÂ¢ûÈáè‰ª£Ë°®ÈááÊ†∑Êó∂Èó¥ÂÜÖÁöÑÊåáÊ†áÂÄºÔºåÂÜçÈô§‰ª•Êó∂Èó¥ÂæóÂá∫ ‚ÄúÊØèÁßíÊåáÊ†áÁöÑÂ¢ûÈïø‚ÄùÔºåÁªèËøáÊé®Êñ≠ËÆ°ÁÆóÂá∫Êü•ËØ¢Êó∂Èó¥ÁÇπÁöÑÂπ≥ÂùáÂ¢ûÈïøÁéá„ÄÇ

### 6.2 increase

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÂáΩÊï∞ÊÑè‰πâÔºöÊ†∑Êú¨ÈááÈõÜÂå∫Èó¥ÂÜÖÔºåÊåáÊ†áÊ†∑Êú¨ÁöÑÁ¨¨‰∏Ä‰∏™ÂÄºÂíåÊúÄÂêé‰∏Ä‰∏™ÂÄº‰πãÈó¥ÁöÑÂ¢ûÈïøÈáè„ÄÇ

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‰ªé‰ª£Á†ÅÁúã [funcIncrease](https://github.com/prometheus/prometheus/blob/9fcf0b3d46cc3cdff96e6e7baabfaf63d89a5a9d/promql/functions.go#L144) `extrapolatedRate(vals, args, enh, true, false)`„ÄÇ‰æùÊçÆ‰∏äÊñáËß£ËØªÔºå‰ºöËøîÂõûÊ†∑Êú¨Âå∫Èó¥ (ÊúÄÂ§ßÂÄº-ÊúÄÂ∞èÂÄº) ÁöÑÁªìÊûúÔºåÂêåÁêÜÂõ†‰∏∫ Counter ÊòØÁ¥ØËÆ°ÂÄºÔºå‰ª£Ë°®Ê†∑Êú¨Â¢ûÈáèÔºåÁªèËøáÊé®Êñ≠ËÆ°ÁÆóÂá∫Êü•ËØ¢Êó∂Èó¥ÁÇπÁöÑÊ†∑Êú¨Â¢ûÈáè„ÄÇ

### 6.3 delta

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÂáΩÊï∞ÊÑè‰πâÔºöËÆ°ÁÆóÊ†∑Êú¨Âå∫Èó¥ÂÜÖÔºåÊåáÊ†áÁöÑÁ¨¨‰∏Ä‰∏™ÂÖÉÁ¥†ÂíåÊúÄÂêé‰∏Ä‰∏™ÂÖÉÁ¥†ÁöÑÂ∑ÆÂÄº„ÄÇ

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‰ªé‰ª£Á†ÅÁúã [funcDelta](https://github.com/prometheus/prometheus/blob/9fcf0b3d46cc3cdff96e6e7baabfaf63d89a5a9d/promql/functions.go#L134) `extrapolatedRate(vals, args, enh, false, false)`„ÄÇÂÖ∂ÂÆûÊú¨Ë¥®‰∏äÂäüËÉΩ‰∏é increase ÂáΩÊï∞Á±ª‰ººÔºåÂè™ÊòØÂ∞ë‰∫ÜËÆ°Êï∞Âô®ÈáçÁΩÆÊñπÈù¢ÁöÑËÄÉÈáè„ÄÇ

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Áî±‰∫éËøô‰∏™ÂÄºË¢´Â§ñÊé®Âà∞ÊåáÂÆöÁöÑÊï¥‰∏™Êó∂Èó¥ËåÉÂõ¥ÔºåÊâÄ‰ª•Âç≥‰ΩøÊ†∑Êú¨ÂÄºÈÉΩÊòØÊï¥Êï∞Ôºå‰Ω†‰ªçÁÑ∂ÂèØËÉΩ‰ºöÂæóÂà∞‰∏Ä‰∏™ÈùûÊï¥Êï∞ÂÄº„ÄÇ

### 6.4 irate

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÂáΩÊï∞ÊÑè‰πâÔºöÊ†∑Êú¨ÈááÈõÜÂå∫Èó¥ÂÜÖÔºåÊåáÊ†áÊ†∑Êú¨ÁöÑÊúÄÂêé‰∏Ä‰∏™ÂÄºÂíåÂÄíÊï∞Á¨¨‰∫å‰∏™ÂÄº‰πãÈó¥ÁöÑÂ¢ûÈïøÈáè„ÄÇ

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‰ªé‰ª£Á†ÅÁúã [funcIrate](https://github.com/prometheus/prometheus/blob/87ffac3e9d2104cd368d2e8962723d9fc3ee126f/promql/functions.go#L149) `instantValue(vals, enh.Out, true)`„ÄÇÂáΩÊï∞ÂÜÖÈÉ®Ë∞ÉÁî® [instantValue](https://github.com/prometheus/prometheus/blob/87ffac3e9d2104cd368d2e8962723d9fc3ee126f/promql/functions.go#L158)  

### 6.5 histogram_quantile

ÂØπ‰∫é histogram ÔºåÂèñ `rate + []` Ë°®Á§∫Êó∂Èó¥Âå∫Èó¥ÂÜÖÊåáÊ†áÁöÑÂπ≥ÂùáÂ¢ûÈáèÔºå

## ‰∏É„ÄÅTiDB Duration ËÅöÂêàËß£ËØª

### 7.1 Ëé∑ÂèñÂÆö‰πâ

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Âú® Grafana ÂèØÂèëÁé∞ Duration 999 Á∫øÁöÑÂÆö‰πâÔºåÂ¶Ç‰∏ã‰ª£Á†ÅÂùó„ÄÇ  

```sql
histogram_quantile(0.999, sum(rate(tidb_server_handle_query_duration_seconds_bucket{k8s_cluster="$k8s_cluster", tidb_cluster="$tidb_cluster"}[1m])) by (le))
```

![Prometheus05](../../../../../images/tidb/03TiDB-Maintaining/prometheus05.jpg)  

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ëá≥‰∫é {k8s_cluster="$k8s_cluster", tidb_cluster="$tidb_cluster"} Ê†áÁ≠æËøáÊª§ÂèØ‰ª•ÊöÇÊó∂ÂøΩÁï•Ôºå‰ªñÊòØÈÄöËøá Grafana ÂèòÈáèÊú∫Âà∂ÂÆûÁé∞ÁöÑËøáÊª§ TiDB Cluster Áõ∏ÂÖ≥ÊåáÊ†áÁöÑÊú∫Âà∂„ÄÇËøôÈáå‰∏ªË¶ÅÂÖ≥Ê≥® Prometheus Â¶ÇÊûúÂÆûÁé∞Êï∞ÊçÆÁöÑËÅöÂêàÔºåÊöÇÊó∂ÂøΩÁï•Â§öÈõÜÁæ§Êï∞ÊçÆÁöÑÈóÆÈ¢ò„ÄÇÂØπËØ•ÈóÆÈ¢òÔºåËØ¶ÊÉÖÂèÇËÄÉ [grafana ÂèòÈáèÊú∫Âà∂](https://www.mianshigee.com/tutorial/prometheus-book/grafana-templating.md) Ê∑±ÂÖ•Á†îÁ©∂„ÄÇ

![Prometheus06](../../../../../images/tidb/03TiDB-Maintaining/prometheus06.jpg)  

### 7.2 Metric Âå∫Èó¥

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÁªèËøáÁÆÄÂåñÂ¶Ç‰∏ãÊâÄÁ§∫Ôºå‰∏ãÈù¢ÂºÄÂßã __‚ÄúÁúüÊ≠£‚Äù__ ËøõÂÖ•ËÅöÂêàËøáÁ®ãÂàÜÊûê„ÄÇ

```sql
tidb_server_handle_query_duration_seconds_bucket[1m]  
```

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÈõÜÂêàËøáÁ®ã‰∏≠ÔºåÊúÄÂÜÖÂ±ÇÂÖàÂØπÊåáÊ†á tidb_server_handle_query_duration_seconds_bucket ÈÄöËøá __‚ÄúÂå∫Èó¥ÂêëÈáèËøáÊª§Âô®‚Äù__ ËøáÊª§Âá∫ 1min ÂÜÖËØ•ÊåáÊ†áÁöÑÊâÄÊúâÊï∞ÊçÆ„ÄÇÁªèËøáÊó∂Èó¥Êà≥ËΩ¨ËØëÁªìÊûú,Â¶Ç‰∏ã‰ª£Á†ÅÂùóÊâÄÁ§∫„ÄÇ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‰ªéÁúüÂÆû‰∏ñÁïåÊó∂Èó¥ÁúãÔºåÊØèË°åÊï∞ÊçÆ‰∏é‰∏ä‰∏ÄË°åÁõ∏ÊØîÂàöÂ•ΩÂ¢ûÂä† 15sÔºåÂõ†‰∏∫Âú® TiDB ‰∏≠ÈªòËÆ§ÈÖçÁΩÆÊØèÈöî 15s prometheus ‰ªé TiDB„ÄÅTiKV„ÄÅPD ‰∏≠ÊãâÂèñÁºìÂ≠òÁöÑÊï∞ÊçÆ„ÄÇ 4 * 15 = 60s ÂàöÂ•Ω‰ª£Ë°® 1min ÂÜÖÊâÄÊúâÁöÑÊï∞ÊçÆ„ÄÇ

```yaml
            131 @ 1650531198.144           131 @ 2022-04-21 16:53:18   
            131 @ 1650531213.144   ]]></description>
            <content:encoded><![CDATA[<h1 id="the-prometheus-of-tidb" tabindex="-1">The Prometheus of TiDB <a class="header-anchor" href="#the-prometheus-of-tidb" aria-label="Permalink to &quot;The Prometheus of TiDB&quot;"></a></h1>
<p>If you need 100% accuracy, such as billing on request, Prometheus is not a good choice because the data collected may not be detailed and complete enough. In this case, you are better off using other systems to collect and analyze the billing data, and using Prometheus for the rest of the monitoring.</p>
<h2 id="_1-prometheus-feature-definition" tabindex="-1">1. Prometheus Feature Definition <a class="header-anchor" href="#_1-prometheus-feature-definition" aria-label="Permalink to &quot;1. Prometheus Feature Definition&quot;"></a></h2>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; On the basis of the definition of <a href="https://prometheus.io/docs/introduction/overview/#what-is-prometheus" target="_blank" rel="noreferrer">the Prometheus's official website</a>, Prometheus Is an open source, system monitoring and alert toolkit. It has the following characteristics:</p>
<ol>
<li><strong>Multi-dimensional sequential data:</strong> Prometheus provides a multi-dimensional data model based on time series by appending key-value pairs.</li>
<li><strong>Query Statement support:</strong> Prometheus Support PromQL allows slicing of time series data to generate charts, tables, and alerts. PromQL, similar to SQL, is a declarative query language; Prometheus provides a variety of functional implementations, aggregation of timing data such as rate, irate, delta, and so on.</li>
<li><strong>Excellent visual quality:</strong> Prometheus supports a variety of visual modes, such as a built-in Dashboard browser or an integrated Grafana.</li>
<li><strong>Efficient storage:</strong> Prometheus stores time series in memory and local disks in a custom format, scaled by sharding and union. Since v2, Prometheus has implemented LSM database-like structures such as blocks, WAL, and Compaction. Compaction prevents random reads and writes and compacts read and write faster.</li>
<li><strong>Easy to deploy:</strong> Prometheus is written in Go, each server relies only on local storage, independent, reliable, and easy to deploy.</li>
<li><strong>Alarm system accuracy:</strong> Prometheus alarms are handled by alertManager according to PromQL definition.</li>
<li><strong>Multi-client support:</strong> Prometheus supports over a dozen language client libraries, allowing lightweight detection services and easy implementation of custom libraries.</li>
<li><strong>Numerous third-party integrations:</strong> Prometheus makes it easy to connect with third party exporter data. Such as system information, Docker, HAProxy, JMX and other indicators. The TiDB monitoring system uses the three open source exporters, such as Node_exporter and Blackbox_exporter, to monitor the operating system and network status.</li>
</ol>
<h2 id="prometheus-logical-structure" tabindex="-1">Prometheus Logical Structure <a class="header-anchor" href="#prometheus-logical-structure" aria-label="Permalink to &quot;Prometheus Logical Structure&quot;"></a></h2>
<div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">Time Series Data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">Data Schema</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> : </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">idnetifier -> (t0, v0),(t1, v1),(t3, v3)...</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">Prometheus Data Model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> : </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">&#x3C;metric name{&#x3C;label name>=&#x3C;label value>, ...}</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">Typical set of identifiers</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> :</span></span></code></pre>
</div><table tabindex="0">
<thead>
<tr>
<th>Merics Name</th>
<th>Labels</th>
<th>Timestamp</th>
<th>Sample Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>{<strong>name</strong>}=&quot;&quot;</td>
<td></td>
<td>@143417561287</td>
<td>94934</td>
</tr>
<tr>
<td>{<strong>name</strong>}=&quot;&quot;</td>
<td></td>
<td>@143417561287</td>
<td>94934</td>
</tr>
<tr>
<td>{<strong>name</strong>}=&quot;&quot;</td>
<td></td>
<td>@143417561287</td>
<td>94934</td>
</tr>
</tbody>
</table>
<figure><img src="./../../../../../images/tidb/03TiDB-Maintaining/Prometheus01.png" alt="Prometheus01" tabindex="0"><figcaption>Prometheus01</figcaption></figure>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The Prometheus Metric with the Label is broken up into a finite number of metrics, reflected as points on a two-dimensional plane, and aggregated by 'intersection' or 'union' during computation. The change of each indicator value over time is saved in a file, which realizes parallel read and write and greatly improves performance.</p>
<h2 id="_3-prometheus-time-filtering" tabindex="-1">3. Prometheus Time Filtering <a class="header-anchor" href="#_3-prometheus-time-filtering" aria-label="Permalink to &quot;3. Prometheus Time Filtering&quot;"></a></h2>
<p>Instantaneous vector filter: select the time series of a group of labels and the corresponding single sample value within the specified time stamp;</p>
<p>Like Ôºö<code>tidb_server_handle_query_duration_seconds_bucket{tidb_cluster=&quot;$tidb_cluster&quot;,type=&quot;select&quot;}</code>, which means that the tidb_server_handle_query_duration_seconds index in TiDB obtains the instantaneous sample value of the current time under the combination of the <code>tidb_cluster</code> and <code>type</code> tags.</p>
<p>Interval vector filter: define the index time range through '[]' to obtain the single sample value of the index within all time ranges of 'instantaneous vector filter';</p>
<p>Â¶ÇÔºö<code>tidb_server_handle_query_duration_seconds_bucket{tidb_cluster=&quot;$tidb_cluster&quot;,type=&quot;select&quot;}</code>, Specifies all the values of the tidb_server_handle_query_duration_seconds_bucket index in the TIDB time range.</p>
<p>Time shift operation: specify the time offset from the current time by <code>offset</code>;
Like : <code>tidb_server_handle_query_duration_seconds_bucket offset 5m</code>, Specifies the instantaneous value of the tidb_server_handle_query_duration_seconds_bucket index in the TIDB 5 minutes earlier.</p>
<h2 id="_4-prometheus-aggregation-operation" tabindex="-1">4. Prometheus Aggregation Operation <a class="header-anchor" href="#_4-prometheus-aggregation-operation" aria-label="Permalink to &quot;4. Prometheus Aggregation Operation&quot;"></a></h2>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For example, tidb_server_handle_query_duration_seconds_bucket Metric, which consists of Label instance, job, le, and sql_type, is used.</p>
<div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{ </span></span>
<span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">    name</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> "tidb_server_handle_query_duration_seconds_bucket"</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">,</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic"> #</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic"> Metric</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic"> Name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> : </span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">__name__</span></span>
<span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">    instance</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "172.16.6.155:10080"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,                           </span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">#</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic"> Label</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> : </span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">instance</span></span>
<span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">    job</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "tidb"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,                                              </span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">#</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic"> Label</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> : </span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">job</span></span>
<span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">    le</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "+Inf"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,                                               </span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">#</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic"> Label</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> : </span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">le</span></span>
<span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">    sql_type</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "Select"</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">                                        #</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic"> Label</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic"> :</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic"> sql_type</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
</div><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Assume that <code>tidb_server_handle_query_duration_seconds_bucket {instance = &quot;172.16.6.155:10080&quot;, sql_type = &quot;Select&quot;, le = &quot;+Inf&quot;} [2m]</code>'s instantaneous value. The first step is to reconstruct the data from the prometheus storage after intercepting the data for the corresponding period. The second step, take the intersection file results Metric all values within 2 min.
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**NoticeÔºö**The purpose of the first inversion is to achieve fast merge lookup in an ordered array, which is a performance-based operation.</p>
<figure><img src="./../../../../../images/tidb/03TiDB-Maintaining/prometheus02.png" alt="Prometheus02" tabindex="0"><figcaption>Prometheus02</figcaption></figure>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Converge the results in the Prometheus Dashboard, as shown in the following figure.</p>
<figure><img src="./../../../../../images/tidb/03TiDB-Maintaining/prometheus03.jpg" alt="Prometheus03" tabindex="0"><figcaption>Prometheus03</figcaption></figure>
<h2 id="‰∫î„ÄÅprometheus-indicator-type" tabindex="-1">‰∫î„ÄÅPrometheus Indicator Type <a class="header-anchor" href="#‰∫î„ÄÅprometheus-indicator-type" aria-label="Permalink to &quot;‰∫î„ÄÅPrometheus Indicator Type&quot;"></a></h2>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;According to the website <a href="https://prometheus.fuckcloudnative.io/di-er-zhang-gai-nian/metric_types" target="_blank" rel="noreferrer">promehteus</a> index type is confined to the client side, On the server side, indicator types are not distinguished and are regarded as unordered time sequence data. So why distinguish between different indicator types?</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The data flow after Prometheus encapsulated in TiDB is shown below;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="./../../../../../images/tidb/03TiDB-Maintaining/prometheus04.png" alt="Prometheus04"></p>
<h3 id="_5-1-counter" tabindex="-1">5.1 Counter <a class="header-anchor" href="#_5-1-counter" aria-label="Permalink to &quot;5.1 Counter&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Counter Á±ªÂûãË°®Á§∫Ê†∑Êú¨Êï∞ÊçÆÂçïË∞ÉÈÄíÂ¢ûÔºåÂç≥Âè™Â¢û‰∏çÂáèÔºåÈô§ÈùûÁõëÊéßÁ≥ªÁªüÂèëÁîü‰∫ÜÈáçÁΩÆ„ÄÇ‰æãÂ¶ÇÔºösql statement operation per second„ÄÇ</p>
<h3 id="_5-2-gauge" tabindex="-1">5.2 Gauge <a class="header-anchor" href="#_5-2-gauge" aria-label="Permalink to &quot;5.2 Gauge&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gauge Á±ªÂûãË°®Á§∫Ê†∑Êú¨Êï∞ÊçÆÂèØ‰ª•‰ªªÊÑèÂèòÂåñÁöÑÊåáÊ†áÔºåÂç≥ÂèØÂ¢ûÂèØÂáè„ÄÇ‰æãÂ¶ÇÔºötikv region ÁöÑÊï∞ÈáèÔºõ</p>
<h3 id="_5-3-histogram" tabindex="-1">5.3 Histogram <a class="header-anchor" href="#_5-3-histogram" aria-label="Permalink to &quot;5.3 Histogram&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Histogram Á±ªÂûãÂú®‰∏ÄÊÆµÊó∂Èó¥ËåÉÂõ¥ÂÜÖÂØπÊï∞ÊçÆËøõË°åÈááÊ†∑ÔºåÂ∞ÜÂÖ∂ËÆ∞ÂÖ•Ëá™ÂÆö‰πâÈÖçÁΩÆÁöÑ bucket ‰∏≠ÔºåÂêéÁª≠ÂèØÈÄöËøáÂà∂ÂÆöÂå∫Èó¥ÂØπÁ≠õÈÄâÊï∞ÊçÆ„ÄÅÁªüËÆ°Ê†∑Êú¨Êï∞ÈáèÔºåÊúÄÂêéÂëàÁé∞Âá∫Áõ¥ÊñπÂõæÁöÑË°®Áé∞ÂΩ¢Âºè„ÄÇ</p>
<h3 id="_5-4-summary" tabindex="-1">5.4 Summary <a class="header-anchor" href="#_5-4-summary" aria-label="Permalink to &quot;5.4 Summary&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Summary ‰∏é Histogram ÁöÑÂäüËÉΩÁ±ª‰ººÔºåË°®Á§∫‰∏ÄÊÆµÊó∂Èó¥ÂÜÖÁöÑÊï∞ÊçÆÊ†∑Êú¨ÁªìÊûúÔºåÂå∫Âà´‰ΩìÁé∞Âú®ËÆ°ÁÆóÂàÜ‰ΩçÊï∞Êó∂ summary Áõ¥Êé•Âü∫‰∫é client Á´ØÂ≠òÂÇ®ÁöÑÊ†∑Êú¨Êï∞ÊçÆËÆ°ÁÆóÂá∫ÁôæÂàÜ‰ΩçÁªìÊûúÂÄºÔºåÂæÖ prometheus ÂÆöÊúü pull Êï∞ÊçÆÊó∂__Â≠òÂÇ®ÁôæÂàÜ‰ΩçÁªìÊûúÂÄº__„ÄÇËÄå Histogram ÂàôÊòØÂ∞Ü__Â≠òÂÇ®ÁöÑÊ†∑Êú¨Êï∞ÊçÆ__Â≠òÂÇ®Âà∞ prometheus ‰∏≠„ÄÇ</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>Ê≥®ÊÑè</strong>ÔºöÊ†πÊçÆ Breezewish Âú® <a href="https://pingcap.com/zh/blog/tikv-source-code-reading-3" target="_blank" rel="noreferrer">TiKV Ê∫êÁ†ÅËß£ÊûêÁ≥ªÂàóÊñáÁ´†Ôºà‰∏âÔºâPrometheusÔºà‰∏äÔºâ</a> ‰∏≠‰ªãÁªçÁöÑ <strong>‚Äúrust-prometheus Â∫ìÁõÆÂâçËøòÂè™ÂÆûÁé∞‰∫ÜÂâç‰∏âÁßç„ÄÇTiKV Â§ßÈÉ®ÂàÜÊåáÊ†áÈÉΩÊòØ Counter Âíå HistogramÔºåÂ∞ëÈÉ®ÂàÜÊòØ Gauge‚Äù</strong> ÔºåÂèØ‰ª•ÂèëÁé∞ rust prometheus client Âπ∂Ê≤°ÊúâÂÆûÁé∞ summary Á±ªÂûãÔºåÂπ∂‰∏îÂú® tikv ‰∏≠‰∏ªË¶ÅÊòØÁî®ÂÖ∂‰ªñ‰∏âÁßçÁ±ªÂûã„ÄÇSummary Á±ªÂûãÂú® <a href="https://docs.rs/prometheus/latest/prometheus/proto/enum.MetricType.html?search=summary#variant.SUMMARY" target="_blank" rel="noreferrer">rust prometheus client doc</a> Âè™ÊúâÂØπÂ∫îÁöÑ protocol type ÂÆö‰πâÔºåËÄåÊ≤°ÊúâÂØπÂ∫îÁöÑ struct ÂÆûÁé∞„ÄÇ</p>
<h2 id="ÂÖ≠„ÄÅprometheus-ËÅöÂêàÂáΩÊï∞" tabindex="-1">ÂÖ≠„ÄÅprometheus ËÅöÂêàÂáΩÊï∞ <a class="header-anchor" href="#ÂÖ≠„ÄÅprometheus-ËÅöÂêàÂáΩÊï∞" aria-label="Permalink to &quot;ÂÖ≠„ÄÅprometheus ËÅöÂêàÂáΩÊï∞&quot;"></a></h2>
<h3 id="_6-1-rate" tabindex="-1">6.1 Rate <a class="header-anchor" href="#_6-1-rate" aria-label="Permalink to &quot;6.1 Rate&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‰ªé‰ª£Á†ÅÁúã <a href="https://github.com/prometheus/prometheus/blob/9fcf0b3d46cc3cdff96e6e7baabfaf63d89a5a9d/promql/functions.go#L134-L146" target="_blank" rel="noreferrer">Rate</a> ÂáΩÊï∞ÂÜÖÈÉ®Ë∞ÉÁî® <a href="https://github.com/prometheus/prometheus/blob/9fcf0b3d46cc3cdff96e6e7baabfaf63d89a5a9d/promql/functions.go#L59" target="_blank" rel="noreferrer">extrapolatedRate</a> ËÆ°ÁÆóÔºåÁªèËøáÁÆÄÂåñÂêé‰ª£Á†ÅÂ¶Ç‰∏ãÔºõ</p>
<div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">func</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> extrapolatedRate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">vals</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> []</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">parser</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">args</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> parser</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Expressions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">enh</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> *</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">EvalNodeHelper</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">isCounter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">isRate</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> bool</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Vector</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ms </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> args[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">].(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">parser</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">MatrixSelector</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> vs </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ms.VectorSelector.(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">parser</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">VectorSelector</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  samples    </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> vals[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">].(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Matrix</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]                                        </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// Ê†∑Êú¨ÁõëÊéßÊï∞ÊçÆ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  rangeStart </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> enh.Ts </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> durationMilliseconds</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(ms.Range</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">vs.Offset)          </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// Ê†∑Êú¨ÂºÄÂßãÊó∂Èó¥</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  rangeEnd   </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> enh.Ts </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> durationMilliseconds</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(vs.Offset)                   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// Ê†∑Êú¨ÁªàÊ≠¢Êó∂Èó¥</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> )</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    resultValue </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> samples.Points[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(samples.Points)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">].V </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> samples.Points[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">].V</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// ÁªàÊ≠¢Êó∂Èó¥Ê†∑Êú¨Êï∞ÊçÆÂáèÂºÄÂßãÊó∂Èó¥Ê†∑Êú¨Êï∞ÊçÆ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> isCounter {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> lastValue </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">float64</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">                                                   // Counter Á±ªÂûã‰ºöÂæ™ÁéØÊó∂Èó¥Âå∫Èó¥ÂÜÖÊï∞ÊçÆ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> _, sample </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> range</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> samples.Points {                                 </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// ÔºåÂ¶ÇÊûú‰∏ã‰∏Ä‰∏™ÂÄºÊØî‰∏ä‰∏Ä‰∏™ÂÄºÂ§ßÔºåËØ¥ÊòéÂèë</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">   if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> sample.V </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">&#x3C;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> lastValue {                                           </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// Áîü‰∫ÜËÆ°Êï∞Âô®ÈáçÁΩÆÔºåÂ¶Ç: ËøõÁ®ã crash Êï∞</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    resultValue </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> lastValue                                        </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// ÊçÆ‰∏¢Â§±Ôºå‰ºöË°•‰∏ä crash ÂêéÈù¢ÁöÑÂ¢ûÈáè„ÄÇ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   lastValue </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> sample.V</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> }</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    // Ê†∑Êú¨ÂºÄÂßãÊó∂Èó¥ÁÇπÊåÅÁª≠ÁöÑÊó∂Èó¥Âà∞ÔºåÂΩìÂâçÊó∂Èó¥ÂâçÊé®ÂêéÁöÑÊó∂Èó¥Ë∑ùÁ¶ªÔºåÂ¶Ç: ÊåáÊ†á X[1m] ‰∏∫ X ÂâçÊé® 1minÔºåÂΩìÂâçÊó∂Èó¥ 02:03:02 ÔºåÈÇ£‰πàÂâçÊé®ÁªìÊûú‰∏∫</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    // 02:02:02Ôºå‰πüÂ∞±ÊòØÂèñ 02:02:02 --> 02:03:02 Âå∫Èó¥ÂÜÖÁöÑÊâÄÊúâÊï∞ÊçÆ„ÄÇÂÅáËÆæÊåáÊ†áÊØè 15s Èáá‰∏ÄÊ¨°ÔºåÂç≥: ÈááÈõÜÊó∂Èó¥ÁÇπ‰∏∫ [02:02:16„ÄÅ02:0</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    // 2:31„ÄÅ02:02:46„ÄÅ02:03:01];</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    // ÈÇ£‰πà durationToStart ‰∏∫ 02:02:16 - 02:02:02 = 00:00:14;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    // ÂêåÁêÜ durationToEnd   ‰∏∫ 02:03:02 - 02:03:01 = 00:00:01;    </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    durationToStart </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> float64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(samples.Points[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">].T</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">rangeStart) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">           </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> durationToEnd </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> float64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(rangeEnd</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">samples.Points[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(samples.Points)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">].T) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1000</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"> // </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                                     </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    // sampledInterval Ë°®Á§∫Ê†∑Êú¨Êï∞ÊçÆÁöÑÁ¨¨‰∏Ä‰∏™ÁÇπÂíåÊúÄÂêé‰∏Ä‰∏™ÁÇπÈó¥ÁöÑÊó∂Èó¥Èó¥Èöî;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> sampledInterval </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> float64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(samples.Points[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(samples.Points)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">].T</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">samples.Points[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">].T) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1000</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    // averageDurationBetweenSamples Ë°®Á§∫Ê†∑Êú¨Êï∞ÊçÆÂú®Âå∫Èó¥ÂÜÖÊØè‰∏™ÁÇπÁöÑÊó∂Èó¥Èó¥ÈöîÔºåÈªòËÆ§ÊòØ 15s;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> averageDurationBetweenSamples </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> sampledInterval </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> float64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(samples.Points)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> isCounter </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">&#x26;&#x26;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> resultValue </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> &#x26;&#x26;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> samples.Points[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">].V </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">        // Âú® Counter ÊåáÊ†áÁ±ªÂûãÊó∂ÔºåÁî®ÊñúÁéáÂÖ¨Âºè ‚ÄúÈõ∂ÁÇπÊó∂Èó¥/Âå∫Èó¥Êó∂Èó¥ = ÂºÄÂßãÊó∂Èó¥Ê†∑Êú¨ÂÄº/ÁªìÊùüÊó∂Èó¥Âà∞ÂºÄÂßãÊó∂Èó¥Ê†∑Êú¨Â¢ûÈáè‚Äù ÁÆóÂá∫ Êé®Êñ≠ÁöÑÂ§ñÂª∂Êó∂Èó¥ÁÇπ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        durationToZero </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> sampledInterval </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (samples.Points[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">].V </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> resultValue)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">        // Â¶ÇÊûú durationToZero ‰Ωé‰∫é durationToStartÔºåÈÄâÂèñËÆ°Êó∂Âô®ÈáçÁΩÆÁöÑÊó∂Èó¥ÁÇπÂà∞Á¨¨‰∏Ä‰∏™ÈááÊ†∑Êó∂Èó¥ÁÇπÁöÑÊó∂Èó¥Âå∫Èó¥‰Ωú‰∏∫ durationToStart</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> durationToZero </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">&#x3C;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> durationToStart {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">            durationToStart </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> durationToZero</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    extrapolationThreshold </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> averageDurationBetweenSamples </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1.1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> extrapolateToInterval </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> sampledInterval</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    // Êé®Êñ≠ÂäüËÉΩ‰∏ªË¶ÅËß£ÂÜ≥ÔºåÊúÄÂêé‰∏Ä‰∏™ÈááÊ†∑ÁÇπÂèëÁîüÊó∂Èó¥Âà∞Êü•ËØ¢Êó∂Èó¥Â≠òÂú®‰∏ÄÂÆöË∑ùÁ¶ªÔºåÂç≥ÔºöÊü•ËØ¢ÁöÑÊòØ 02:03:02 ÁöÑÁªìÊûúÔºå‰ΩÜ prometheus ÊúÄÂêé‰∏ÄÊ¨°ÊãâÊï∞ÊçÆ‰∏∫ 02:03:01</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    // Âõ†‰∏∫ËÆæÂÆö‰∫Ü‰∏Ä‰∏™ÈòàÂÄº extrapolationThresholdÔºåÂ¶ÇÊûúË∂ÖËøáËøõË°å‰∏ÄÂÆöËøΩÂä†ÔºåËææÂà∞Âª∂ÈïøÊó∂Èó¥ÈááÊ†∑ÁÇπËá≥Êü•ËØ¢ÁõÆÂú∞Êó∂Èó¥ÁöÑÁõÆÁöÑÔºõ</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    // ÊúÄÂêéÔºåÈÄöËøáÂÖ¨Âºè ‚ÄúÊé®Êñ≠ÁªìÊûú/ÁúüÂÆûÁªìÊûú = Êé®Êñ≠Ê†∑Êú¨Êó∂Èó¥/ÁúüÂÆûÊ†∑Êú¨Êó∂Èó¥‚Äù Ëß£Âá∫ ‚ÄúÊü•ËØ¢Êó∂Èó¥ÔºåÂ¶Ç 02:03:02 ÁöÑÊé®Êñ≠ÁªìÊûú‚ÄùÔºõ</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    // ‰ª£Á†Å‰∏∫ resultValue = resultValue * (extrapolateToInterval / sampledInterval)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> durationToStart </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">&#x3C;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> extrapolationThreshold {                   </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  extrapolateToInterval </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> durationToStart                    </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  extrapolateToInterval </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> averageDurationBetweenSamples </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> durationToEnd </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">&#x3C;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> extrapolationThreshold {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  extrapolateToInterval </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> durationToEnd                      </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  extrapolateToInterval </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> averageDurationBetweenSamples </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> resultValue </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> resultValue </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (extrapolateToInterval </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> sampledInterval) </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> isRate {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  resultValue </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> resultValue </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ms.Range.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Seconds</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">()             </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> append</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(enh.Out, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Sample</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  Point: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Point</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{V: resultValue},</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> })</span></span></code></pre>
</div><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ÂáΩÊï∞ÊÑè‰πâÔºöËÆ°ÁÆóÂå∫Èó¥ÊåáÊ†áÊó∂Èó¥Á™óÂè£ÂÜÖÂπ≥ÂùáÂ¢ûÈïøÈÄüÁéá„ÄÇ</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‰ªé‰ª£Á†ÅÁúã <a href="https://github.com/prometheus/prometheus/blob/9fcf0b3d46cc3cdff96e6e7baabfaf63d89a5a9d/promql/functions.go#L139" target="_blank" rel="noreferrer">funcRate</a> Ë∞ÉÁî®ËøîÂõû <code>extrapolatedRate(vals, args, enh, true, true)</code>„ÄÇ‰æùÊçÆ‰∏äÊñáËß£ËØªÔºå‰ºöËøîÂõûÊ†∑Êú¨Âå∫Èó¥ÂÜÖ (ÊúÄÂ§ßÂÄº-ÊúÄÂ∞èÂÄº)/Êó∂Èó¥Âå∫Èó¥ÁöÑÁªìÊûúÔºåÂõ†‰∏∫ counter Êàñ histogram(ÂÜÖÈÉ®Â∞ÅË£Ö‰∫Ü counter) ÊòØÁ¥ØËÆ°ÂÄºÔºåÊÑèÂë≥ÁùÄÈöèÊó∂Èó¥Â¢ûÈïøÁõëÊéßÊåáÊ†áÂßãÁªàÂ¢ûÈïø„ÄÇÈÄöËøáËÆ°ÁÆóÈááÊ†∑Êó∂Èó¥ÁöÑÂ¢ûÈáè‰ª£Ë°®ÈááÊ†∑Êó∂Èó¥ÂÜÖÁöÑÊåáÊ†áÂÄºÔºåÂÜçÈô§‰ª•Êó∂Èó¥ÂæóÂá∫ ‚ÄúÊØèÁßíÊåáÊ†áÁöÑÂ¢ûÈïø‚ÄùÔºåÁªèËøáÊé®Êñ≠ËÆ°ÁÆóÂá∫Êü•ËØ¢Êó∂Èó¥ÁÇπÁöÑÂπ≥ÂùáÂ¢ûÈïøÁéá„ÄÇ</p>
<h3 id="_6-2-increase" tabindex="-1">6.2 increase <a class="header-anchor" href="#_6-2-increase" aria-label="Permalink to &quot;6.2 increase&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÂáΩÊï∞ÊÑè‰πâÔºöÊ†∑Êú¨ÈááÈõÜÂå∫Èó¥ÂÜÖÔºåÊåáÊ†áÊ†∑Êú¨ÁöÑÁ¨¨‰∏Ä‰∏™ÂÄºÂíåÊúÄÂêé‰∏Ä‰∏™ÂÄº‰πãÈó¥ÁöÑÂ¢ûÈïøÈáè„ÄÇ</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‰ªé‰ª£Á†ÅÁúã <a href="https://github.com/prometheus/prometheus/blob/9fcf0b3d46cc3cdff96e6e7baabfaf63d89a5a9d/promql/functions.go#L144" target="_blank" rel="noreferrer">funcIncrease</a> <code>extrapolatedRate(vals, args, enh, true, false)</code>„ÄÇ‰æùÊçÆ‰∏äÊñáËß£ËØªÔºå‰ºöËøîÂõûÊ†∑Êú¨Âå∫Èó¥ (ÊúÄÂ§ßÂÄº-ÊúÄÂ∞èÂÄº) ÁöÑÁªìÊûúÔºåÂêåÁêÜÂõ†‰∏∫ Counter ÊòØÁ¥ØËÆ°ÂÄºÔºå‰ª£Ë°®Ê†∑Êú¨Â¢ûÈáèÔºåÁªèËøáÊé®Êñ≠ËÆ°ÁÆóÂá∫Êü•ËØ¢Êó∂Èó¥ÁÇπÁöÑÊ†∑Êú¨Â¢ûÈáè„ÄÇ</p>
<h3 id="_6-3-delta" tabindex="-1">6.3 delta <a class="header-anchor" href="#_6-3-delta" aria-label="Permalink to &quot;6.3 delta&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÂáΩÊï∞ÊÑè‰πâÔºöËÆ°ÁÆóÊ†∑Êú¨Âå∫Èó¥ÂÜÖÔºåÊåáÊ†áÁöÑÁ¨¨‰∏Ä‰∏™ÂÖÉÁ¥†ÂíåÊúÄÂêé‰∏Ä‰∏™ÂÖÉÁ¥†ÁöÑÂ∑ÆÂÄº„ÄÇ</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‰ªé‰ª£Á†ÅÁúã <a href="https://github.com/prometheus/prometheus/blob/9fcf0b3d46cc3cdff96e6e7baabfaf63d89a5a9d/promql/functions.go#L134" target="_blank" rel="noreferrer">funcDelta</a> <code>extrapolatedRate(vals, args, enh, false, false)</code>„ÄÇÂÖ∂ÂÆûÊú¨Ë¥®‰∏äÂäüËÉΩ‰∏é increase ÂáΩÊï∞Á±ª‰ººÔºåÂè™ÊòØÂ∞ë‰∫ÜËÆ°Êï∞Âô®ÈáçÁΩÆÊñπÈù¢ÁöÑËÄÉÈáè„ÄÇ</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Áî±‰∫éËøô‰∏™ÂÄºË¢´Â§ñÊé®Âà∞ÊåáÂÆöÁöÑÊï¥‰∏™Êó∂Èó¥ËåÉÂõ¥ÔºåÊâÄ‰ª•Âç≥‰ΩøÊ†∑Êú¨ÂÄºÈÉΩÊòØÊï¥Êï∞Ôºå‰Ω†‰ªçÁÑ∂ÂèØËÉΩ‰ºöÂæóÂà∞‰∏Ä‰∏™ÈùûÊï¥Êï∞ÂÄº„ÄÇ</p>
<h3 id="_6-4-irate" tabindex="-1">6.4 irate <a class="header-anchor" href="#_6-4-irate" aria-label="Permalink to &quot;6.4 irate&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÂáΩÊï∞ÊÑè‰πâÔºöÊ†∑Êú¨ÈááÈõÜÂå∫Èó¥ÂÜÖÔºåÊåáÊ†áÊ†∑Êú¨ÁöÑÊúÄÂêé‰∏Ä‰∏™ÂÄºÂíåÂÄíÊï∞Á¨¨‰∫å‰∏™ÂÄº‰πãÈó¥ÁöÑÂ¢ûÈïøÈáè„ÄÇ</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‰ªé‰ª£Á†ÅÁúã <a href="https://github.com/prometheus/prometheus/blob/87ffac3e9d2104cd368d2e8962723d9fc3ee126f/promql/functions.go#L149" target="_blank" rel="noreferrer">funcIrate</a> <code>instantValue(vals, enh.Out, true)</code>„ÄÇÂáΩÊï∞ÂÜÖÈÉ®Ë∞ÉÁî® <a href="https://github.com/prometheus/prometheus/blob/87ffac3e9d2104cd368d2e8962723d9fc3ee126f/promql/functions.go#L158" target="_blank" rel="noreferrer">instantValue</a></p>
<h3 id="_6-5-histogram-quantile" tabindex="-1">6.5 histogram_quantile <a class="header-anchor" href="#_6-5-histogram-quantile" aria-label="Permalink to &quot;6.5 histogram_quantile&quot;"></a></h3>
<p>ÂØπ‰∫é histogram ÔºåÂèñ <code>rate + []</code> Ë°®Á§∫Êó∂Èó¥Âå∫Èó¥ÂÜÖÊåáÊ†áÁöÑÂπ≥ÂùáÂ¢ûÈáèÔºå</p>
<h2 id="‰∏É„ÄÅtidb-duration-ËÅöÂêàËß£ËØª" tabindex="-1">‰∏É„ÄÅTiDB Duration ËÅöÂêàËß£ËØª <a class="header-anchor" href="#‰∏É„ÄÅtidb-duration-ËÅöÂêàËß£ËØª" aria-label="Permalink to &quot;‰∏É„ÄÅTiDB Duration ËÅöÂêàËß£ËØª&quot;"></a></h2>
<h3 id="_7-1-Ëé∑ÂèñÂÆö‰πâ" tabindex="-1">7.1 Ëé∑ÂèñÂÆö‰πâ <a class="header-anchor" href="#_7-1-Ëé∑ÂèñÂÆö‰πâ" aria-label="Permalink to &quot;7.1 Ëé∑ÂèñÂÆö‰πâ&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Âú® Grafana ÂèØÂèëÁé∞ Duration 999 Á∫øÁöÑÂÆö‰πâÔºåÂ¶Ç‰∏ã‰ª£Á†ÅÂùó„ÄÇ</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">histogram_quantile(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">999</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">sum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(rate(tidb_server_handle_query_duration_seconds_bucket{k8s_cluster</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"$k8s_cluster"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, tidb_cluster</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"$tidb_cluster"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}[1m])) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">by</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (le))</span></span></code></pre>
</div><figure><img src="./../../../../../images/tidb/03TiDB-Maintaining/prometheus05.jpg" alt="Prometheus05" tabindex="0"><figcaption>Prometheus05</figcaption></figure>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ëá≥‰∫é {k8s_cluster=&quot;$k8s_cluster&quot;, tidb_cluster=&quot;$tidb_cluster&quot;} Ê†áÁ≠æËøáÊª§ÂèØ‰ª•ÊöÇÊó∂ÂøΩÁï•Ôºå‰ªñÊòØÈÄöËøá Grafana ÂèòÈáèÊú∫Âà∂ÂÆûÁé∞ÁöÑËøáÊª§ TiDB Cluster Áõ∏ÂÖ≥ÊåáÊ†áÁöÑÊú∫Âà∂„ÄÇËøôÈáå‰∏ªË¶ÅÂÖ≥Ê≥® Prometheus Â¶ÇÊûúÂÆûÁé∞Êï∞ÊçÆÁöÑËÅöÂêàÔºåÊöÇÊó∂ÂøΩÁï•Â§öÈõÜÁæ§Êï∞ÊçÆÁöÑÈóÆÈ¢ò„ÄÇÂØπËØ•ÈóÆÈ¢òÔºåËØ¶ÊÉÖÂèÇËÄÉ <a href="https://www.mianshigee.com/tutorial/prometheus-book/grafana-templating.md" target="_blank" rel="noreferrer">grafana ÂèòÈáèÊú∫Âà∂</a> Ê∑±ÂÖ•Á†îÁ©∂„ÄÇ</p>
<figure><img src="./../../../../../images/tidb/03TiDB-Maintaining/prometheus06.jpg" alt="Prometheus06" tabindex="0"><figcaption>Prometheus06</figcaption></figure>
<h3 id="_7-2-metric-Âå∫Èó¥" tabindex="-1">7.2 Metric Âå∫Èó¥ <a class="header-anchor" href="#_7-2-metric-Âå∫Èó¥" aria-label="Permalink to &quot;7.2 Metric Âå∫Èó¥&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÁªèËøáÁÆÄÂåñÂ¶Ç‰∏ãÊâÄÁ§∫Ôºå‰∏ãÈù¢ÂºÄÂßã <strong>‚ÄúÁúüÊ≠£‚Äù</strong> ËøõÂÖ•ËÅöÂêàËøáÁ®ãÂàÜÊûê„ÄÇ</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">tidb_server_handle_query_duration_seconds_bucket[1m]</span></span></code></pre>
</div><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÈõÜÂêàËøáÁ®ã‰∏≠ÔºåÊúÄÂÜÖÂ±ÇÂÖàÂØπÊåáÊ†á tidb_server_handle_query_duration_seconds_bucket ÈÄöËøá <strong>‚ÄúÂå∫Èó¥ÂêëÈáèËøáÊª§Âô®‚Äù</strong> ËøáÊª§Âá∫ 1min ÂÜÖËØ•ÊåáÊ†áÁöÑÊâÄÊúâÊï∞ÊçÆ„ÄÇÁªèËøáÊó∂Èó¥Êà≥ËΩ¨ËØëÁªìÊûú,Â¶Ç‰∏ã‰ª£Á†ÅÂùóÊâÄÁ§∫„ÄÇ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‰ªéÁúüÂÆû‰∏ñÁïåÊó∂Èó¥ÁúãÔºåÊØèË°åÊï∞ÊçÆ‰∏é‰∏ä‰∏ÄË°åÁõ∏ÊØîÂàöÂ•ΩÂ¢ûÂä† 15sÔºåÂõ†‰∏∫Âú® TiDB ‰∏≠ÈªòËÆ§ÈÖçÁΩÆÊØèÈöî 15s prometheus ‰ªé TiDB„ÄÅTiKV„ÄÅPD ‰∏≠ÊãâÂèñÁºìÂ≠òÁöÑÊï∞ÊçÆ„ÄÇ 4 * 15 = 60s ÂàöÂ•Ω‰ª£Ë°® 1min ÂÜÖÊâÄÊúâÁöÑÊï∞ÊçÆ„ÄÇ</p>
<div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">            131 @ 1650531198.144           131 @ 2022-04-21 16:53:18</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">            131 @ 1650531213.144   ---->   131 @ 2022-04-21 16:53:33      Â¢ûÂä† 15s</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">            131 @ 1650531228.144   ---->   131 @ 2022-04-21 16:53:48      Â¢ûÂä† 15s</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">            131 @ 1650531243.144           131 @ 2022-04-21 16:54:03      Â¢ûÂä† 15s</span></span></code></pre>
</div><figure><img src="./../../../../../images/tidb/03TiDB-Maintaining/prometheus07.jpg" alt="Prometheus07" tabindex="0"><figcaption>Prometheus07</figcaption></figure>
<h3 id="_7-3-rete-ËøêÁÆó" tabindex="-1">7.3 Rete ËøêÁÆó <a class="header-anchor" href="#_7-3-rete-ËøêÁÆó" aria-label="Permalink to &quot;7.3 Rete ËøêÁÆó&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ËøõÂÖ•Á¨¨‰∫åÂ±ÇËøêÁÆóÔºåÂ¶Ç‰∏ã‰ª£Á†ÅÂùóÊâÄÁ§∫„ÄÇ</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">rate(tidb_server_handle_query_duration_seconds_bucket[1m])</span></span></code></pre>
</div><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rate ÂáΩÊï∞Ë°®Á§∫Êï∞ÊçÆÁÇπÂÅöÂ∑ÆÔºåÂáΩÊï∞ÂéüÁêÜÂèÇËÄÉ‰∏äÊñá„ÄÇÁªìÊûúÊòæÁ§∫ 1min ÂÜÖÊ†áÁ≠æ‰∏∫ {instance=&quot;172.16.6.155:10080&quot;, job=&quot;tidb&quot;, le=&quot;+Inf&quot;, sql_type=&quot;Begin&quot;} ÁöÑÊåáÊ†áËÅöÂêàÁªìÊûúÁöÑÂ¢ûÈáè‰∏∫ 0ÔºåÂèàÂõ†‰∏∫ prometheus ‰∏≠‰øùÂ≠òÁöÑÊòØÁ¥ØËÆ°ÂÄºÔºåÂú® rate ÂÅöÂ∑ÆÂêéÔºåÂàöÂ•ΩË°®Á§∫Ëøô 1min ÂÜÖÁ¨¶Âêà Lable ÁöÑÊåáÊ†áËÅöÂêàÁöÑÂ¢ûÈáè„ÄÇ</p>
<figure><img src="./../../../../../images/tidb/03TiDB-Maintaining/prometheus08.jpg" alt="Prometheus08" tabindex="0"><figcaption>Prometheus08</figcaption></figure>
<h3 id="_7-4-sum-ËøêÁÆó" tabindex="-1">7.4 Sum ËøêÁÆó <a class="header-anchor" href="#_7-4-sum-ËøêÁÆó" aria-label="Permalink to &quot;7.4 Sum ËøêÁÆó&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ËøõÂÖ•Á¨¨‰∏âÂ±ÇËøêÁÆóÔºåÂ¶Ç‰∏ã‰ª£Á†ÅÂùóÊâÄÁ§∫„ÄÇ</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">sum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(rate(tidb_server_handle_query_duration_seconds_bucket[1m])) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">by</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (le)</span></span></code></pre>
</div><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<code>sum( Metric_XXX ) by (le)</code> ËøêÁÆóÁõÆÁöÑÊòØ‰∏∫‰∫ÜÔºåËÅöÂêàÈô§ le Ê†áÁ≠æÂ§ñÁöÑÊâÄÊúâÂÖ∂‰ªñÊåáÊ†áÁªìÊûúÔºå‰πüÂ∞±ÊòØÂ±èËîΩ sql_type„ÄÅjob„ÄÅinstance ÁöÑ Label Â∑ÆÂºÇÔºåÁªìÊûúÂ¶Ç‰∏ãÔºö</p>
<figure><img src="./../../../../../images/tidb/03TiDB-Maintaining/prometheus09.jpg" alt="Prometheus09" tabindex="0"><figcaption>Prometheus09</figcaption></figure>
<h3 id="_7-5-histogram-quantile-ËøêÁÆó" tabindex="-1">7.5 Histogram_quantile ËøêÁÆó <a class="header-anchor" href="#_7-5-histogram-quantile-ËøêÁÆó" aria-label="Permalink to &quot;7.5 Histogram_quantile ËøêÁÆó&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ËøõÂÖ•Á¨¨ÂõõÂ±ÇËøêÁÆóÔºåÂ¶Ç‰∏ã‰ª£Á†ÅÂùóÊâÄÁ§∫„ÄÇ</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">histogram_quantile(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">999</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">sum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(rate(tidb_server_handle_query_duration_seconds_bucket[1m])) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">by</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (le))</span></span></code></pre>
</div><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;È¶ñÂÖàÔºåÂü∫‰∫éÊâÄÊúâ le ÂÅö sortÔºåle Ë°®Á§∫ÊØè‰∏™ bucket ÁöÑ‰∏äËæπÁïåÔºå‰∏ãËæπÁïåÁî± Âà´ÁöÑ le ÂÜ≥ÂÆö„ÄÇÈ¶ñÂÖàÂà§ÂÆöÁ¨¨ 99.9% ‰∏™Êï∞ËΩΩÂì™‰∏™ bucket Âå∫Èó¥ÔºåÂú®Áî®‰∫åÂÖÉ‰∏ÄÊ¨°ÊñπÁ®ãÊé®Êñ≠Âá∫ËØ•Âå∫Èó¥ÁöÑÁ¨¨ 99.9% ÁöÑÊï∞ÂÄº„ÄÇ</p>
<h2 id="ÂÖ´„ÄÅreference" tabindex="-1">ÂÖ´„ÄÅReference <a class="header-anchor" href="#ÂÖ´„ÄÅreference" aria-label="Permalink to &quot;ÂÖ´„ÄÅReference&quot;"></a></h2>
<p><a href="https://www.bilibili.com/video/BV1a64y1X7ys?from=search&amp;seid=16358382673192401481&amp;spm_id_from=333.337.0.0" target="_blank" rel="noreferrer">Prometheus ÊòØÊÄé‰πàÂ≠òÂÇ®Êï∞ÊçÆÁöÑÔºàÈôàÁöìÔºâ</a>
<a href="https://prometheus.fuckcloudnative.io/di-er-zhang-gai-nian/metric_types" target="_blank" rel="noreferrer">Prometheus ÊåáÊ†áÁ±ªÂûã</a><br>
<a href="https://zhuanlan.zhihu.com/p/348863302" target="_blank" rel="noreferrer">prometheus‰∏§ÁßçÂàÜ‰ΩçÂÄºhistogramÂíåsummaryÂØπÊØîhistogramÁ∫øÊÄßÊèíÂÄºÊ≥ïÂéüÁêÜ</a><br>
<a href="https://www.infoq.cn/article/Prometheus-theory-source-code" target="_blank" rel="noreferrer">Prometheus ÂéüÁêÜÂíåÊ∫êÁ†ÅÂàÜÊûê</a><br>
<a href="https://www.bianchengquan.com/article/559917.html" target="_blank" rel="noreferrer">PrometheusÂéüÁêÜÂíåÊ∫êÁ†ÅÂàÜÊûê</a></p>
]]></content:encoded>
            <enclosure url="https://askaric.com/images/tidb/03TiDB-Maintaining/Prometheus01.png" length="0" type="image/png"/>
        </item>
        <item>
            <title><![CDATA[Deploy TiDB Cluster on the TiDB Operator of Macbook M1]]></title>
            <link>https://askaric.com/en/work/tidb/08TiDB-Cloud-K8S/8-1TiDB-Deployment/01TiDB-Operator deploys TiDB.html</link>
            <guid>https://askaric.com/en/work/tidb/08TiDB-Cloud-K8S/8-1TiDB-Deployment/01TiDB-Operator deploys TiDB.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[# Deploy TiDB Cluster on the TiDB Operator of Macbook M1

> **This document has been released, which means the original documents's been moved to the period of maintenance. [Please comment anything you want at the topic](http://forum.dbnest.net/t/topic/21).**

## 1. Content guide

1. Personally, I think the fault self-healing of TiDB Operator, and TiDB itself is a database product with cloud native attributes, which can be said to be a perfect match and also a feasible way to realize the real concept of "cloud". Otherwise, TiDB can only achieve a certain degree of self-healing, which is not perfect. Therefore, decided to build a set of tidb cluster on k8s experimental environment on the notebook.

2. As I am using macbook pro m1 pro, m1 itself is an arm chip, the experimental test shows that TiDB supports deployment. Even if you don't use [the arm64 mirror installation guide](https://docs.pingcap.com/zh/tidb-in-kubernetes/dev/deploy-cluster-on-arm64).

3. Before this, Docker Desktop and kubernetes need to be installed on the laptop. The interface operation is not explained, for details, please refer to [Article: Install docker and k8s macbook (M1) - zhihu](https://zhuanlan.zhihu.com/p/381569200).

## 2. Storage preparation

1. If you do not use the self-created pv, skip the following steps because the pvc corresponding to tidb-cluster uses hostPath to create the pv.
2. If you want to build your own PVS, change the storage in addition to applying the following PVS.

  ```yaml
  jan@Jan-M1-Pro tidb-config % cat tidb-pvs.yaml
  apiVersion: v1
  kind: PersistentVolume
  metadata:
    name: local-ssd
  spec:
    capacity:
      storage: 5Gi
    accessModes:
      - ReadWriteOnce
    persistentVolumeReclaimPolicy: Retain
    storageClassName: local-storage
    local:
      path: /Users/jan/Database/k8s/data_tidb/ssd
    nodeAffinity:
      required:
        nodeSelectorTerms:
        - matchExpressions:
          - key: kubernetes.io/hostname
            operator: In
            values:
            - localhost
  ]]></description>
            <content:encoded><![CDATA[<h1 id="deploy-tidb-cluster-on-the-tidb-operator-of-macbook-m1" tabindex="-1">Deploy TiDB Cluster on the TiDB Operator of Macbook M1 <a class="header-anchor" href="#deploy-tidb-cluster-on-the-tidb-operator-of-macbook-m1" aria-label="Permalink to &quot;Deploy TiDB Cluster on the TiDB Operator of Macbook M1&quot;"></a></h1>
<blockquote>
<p><strong>This document has been released, which means the original documents's been moved to the period of maintenance. <a href="http://forum.dbnest.net/t/topic/21" target="_blank" rel="noreferrer">Please comment anything you want at the topic</a>.</strong></p>
</blockquote>
<h2 id="_1-content-guide" tabindex="-1">1. Content guide <a class="header-anchor" href="#_1-content-guide" aria-label="Permalink to &quot;1. Content guide&quot;"></a></h2>
<ol>
<li>
<p>Personally, I think the fault self-healing of TiDB Operator, and TiDB itself is a database product with cloud native attributes, which can be said to be a perfect match and also a feasible way to realize the real concept of &quot;cloud&quot;. Otherwise, TiDB can only achieve a certain degree of self-healing, which is not perfect. Therefore, decided to build a set of tidb cluster on k8s experimental environment on the notebook.</p>
</li>
<li>
<p>As I am using macbook pro m1 pro, m1 itself is an arm chip, the experimental test shows that TiDB supports deployment. Even if you don't use <a href="https://docs.pingcap.com/zh/tidb-in-kubernetes/dev/deploy-cluster-on-arm64" target="_blank" rel="noreferrer">the arm64 mirror installation guide</a>.</p>
</li>
<li>
<p>Before this, Docker Desktop and kubernetes need to be installed on the laptop. The interface operation is not explained, for details, please refer to <a href="https://zhuanlan.zhihu.com/p/381569200" target="_blank" rel="noreferrer">Article: Install docker and k8s macbook (M1) - zhihu</a>.</p>
</li>
</ol>
<h2 id="_2-storage-preparation" tabindex="-1">2. Storage preparation <a class="header-anchor" href="#_2-storage-preparation" aria-label="Permalink to &quot;2. Storage preparation&quot;"></a></h2>
<ol>
<li>If you do not use the self-created pv, skip the following steps because the pvc corresponding to tidb-cluster uses hostPath to create the pv.</li>
<li>If you want to build your own PVS, change the storage in addition to applying the following PVS.</li>
</ol>
<div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">jan@Jan-M1-Pro tidb-config % cat tidb-pvs.yaml</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">apiVersion</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">v1</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">kind</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">PersistentVolume</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">metadata</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">  name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">local-ssd</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">spec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">  capacity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">    storage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">5Gi</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">  accessModes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">ReadWriteOnce</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">  persistentVolumeReclaimPolicy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">Retain</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">  storageClassName</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">local-storage</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">  local</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">    path</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">/Users/jan/Database/k8s/data_tidb/ssd</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">  nodeAffinity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">    required</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">      nodeSelectorTerms</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">matchExpressions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">kubernetes.io/hostname</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">          operator</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">In</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">          values</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">          - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">localhost</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">---</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">apiVersion</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">v1</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">kind</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">PersistentVolume</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">metadata</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">  name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">local-sharedssd</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">spec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">  capacity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">    storage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">5Gi</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">  accessModes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">ReadWriteOnce</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">  persistentVolumeReclaimPolicy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">Retain</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">  storageClassName</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">local-storage</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">  local</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">    path</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">/Users/jan/Database/k8s/data_tidb/sharedssd</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">  nodeAffinity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">    required</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">      nodeSelectorTerms</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">matchExpressions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">kubernetes.io/hostname</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">          operator</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">In</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">          values</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">          - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">localhost</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">---</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">apiVersion</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">v1</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">kind</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">PersistentVolume</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">metadata</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">  name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">local-backup</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">spec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">  capacity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">    storage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">5Gi</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">  accessModes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">ReadWriteOnce</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">  persistentVolumeReclaimPolicy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">Retain</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">  storageClassName</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">local-storage</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">  local</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">    path</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">/Users/jan/Database/k8s/data_tidb/backup</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">  nodeAffinity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">    required</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">      nodeSelectorTerms</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">matchExpressions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">kubernetes.io/hostname</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">          operator</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">In</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">          values</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">          - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">localhost</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">---</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">apiVersion</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">v1</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">kind</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">PersistentVolume</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">metadata</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">  name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">local-monitoring</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">spec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">  capacity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">    storage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">5Gi</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">  accessModes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">ReadWriteOnce</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">  persistentVolumeReclaimPolicy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">Retain</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">  storageClassName</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">local-storage</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">  local</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">    path</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">/Users/jan/Database/k8s/data_tidb/monitoring</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">  nodeAffinity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">    required</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">      nodeSelectorTerms</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">matchExpressions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">kubernetes.io/hostname</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">          operator</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">In</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">          values</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">          - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">localhost</span></span></code></pre>
</div><h2 id="_3-deployment-guidelines" tabindex="-1">3. Deployment Guidelines <a class="header-anchor" href="#_3-deployment-guidelines" aria-label="Permalink to &quot;3. Deployment Guidelines&quot;"></a></h2>
<ol>
<li>
<p>The steps of TiDB Operator are very detailed. In the &quot;Getting Started&quot; section, the steps are as follows: <strong>Deploy TiDB Operator, deploy TiDB cluster, monitor and connect TiDB cluster</strong>, you can pull up a tidb cluster on k8s on macbook m1.</p>
</li>
<li>
<p><strong>Note:</strong> It is OK not to use arm64 mirroring, and it can run normally on my computer.</p>
</li>
<li>
<p>Since the network is not very good, I will first teach the corresponding yaml to download it to the local through wget and then apply. The steps are as follows:</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> create</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> crd.yaml</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">helm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> repo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> add</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> pingcap</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> https://charts.pingcap.org/</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> create</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> namespace</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-admin</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">helm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --namespace</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-admin</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-operator</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> pingcap/tidb-operator</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --version</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> v1.4.0</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> pods</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --namespace</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-admin</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -l</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> app.kubernetes.io/instance=tidb-operator</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> create</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> namespace</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">kubectl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> apply</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster.yaml</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">kubectl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> apply</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-dashboard.yaml</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">kubectl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> apply</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-monitor.yaml</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> pod</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                   READY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   STATUS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    RESTARTS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   AGE</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">basic-discovery-5db6c75657-h4c2p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">          27h</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">basic-monitor-0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                        4/4</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">          23h</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">basic-pd-0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                             1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">          27h</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">basic-tidb-0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                           2/2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">          27h</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">basic-tikv-0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                           1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">          27h</span></span></code></pre>
</div></li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Deploy DM Cluster on the TiDB Operator of Macbook M1]]></title>
            <link>https://askaric.com/en/work/tidb/08TiDB-Cloud-K8S/8-1TiDB-Deployment/02TiDB-Operator deploys DM.html</link>
            <guid>https://askaric.com/en/work/tidb/08TiDB-Cloud-K8S/8-1TiDB-Deployment/02TiDB-Operator deploys DM.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[# Deploy DM Cluster on the TiDB Operator of Macbook M1

> **This document has been released, which means the original documents's been moved to the period of maintenance. [Please comment anything you want at the topic](http://forum.dbnest.net/t/topic/18).**

## 1. Install and configure MySQL

1. To find the mysql configuration, I select `/opt/homebrew/etc/my.cnf` and fill in the binlog configuration information.
  
    ```shell
    jan@Jan-M1-Pro tidb-config % brew install mysql

    jan@Jan-M1-Pro tidb-config % mysql --help --verbose | grep my.cnf
                          order of preference, my.cnf, $MYSQL_TCP_PORT,
    /etc/my.cnf /etc/mysql/my.cnf /opt/homebrew/etc/my.cnf ~/.my.cnf 

    jan@Jan-M1-Pro tidb-config % vim /opt/homebrew/etc/my.cnf  

    [mysqld]
    ......
    log_bin = mysql-bin #config binlog
    binlog_format = ROW #select row-mode
    server_id = 1

    jan@Jan-M1-Pro tidb-config % sudo chown _mysql:_mysql /Users/jan/Database/k8s/data_tidb/mysql-binlog
    
    jan@Jan-M1-Pro tidb-config % brew services restart mysql
    
    jan@Jan-M1-Pro tidb-config % brew services list |grep mysql
    mysql         started         jan  ~/Library/LaunchAgents/homebrew.mxcl.mysql.plist
    ```

2. Enable binlog and configure an independent path

    ```sql
    mysql> show variables like '%log_bin%';
    +]]></description>
            <content:encoded><![CDATA[<h1 id="deploy-dm-cluster-on-the-tidb-operator-of-macbook-m1" tabindex="-1">Deploy DM Cluster on the TiDB Operator of Macbook M1 <a class="header-anchor" href="#deploy-dm-cluster-on-the-tidb-operator-of-macbook-m1" aria-label="Permalink to &quot;Deploy DM Cluster on the TiDB Operator of Macbook M1&quot;"></a></h1>
<blockquote>
<p><strong>This document has been released, which means the original documents's been moved to the period of maintenance. <a href="http://forum.dbnest.net/t/topic/18" target="_blank" rel="noreferrer">Please comment anything you want at the topic</a>.</strong></p>
</blockquote>
<h2 id="_1-install-and-configure-mysql" tabindex="-1">1. Install and configure MySQL <a class="header-anchor" href="#_1-install-and-configure-mysql" aria-label="Permalink to &quot;1. Install and configure MySQL&quot;"></a></h2>
<ol>
<li>
<p>To find the mysql configuration, I select <code>/opt/homebrew/etc/my.cnf</code> and fill in the binlog configuration information.</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> brew</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysql</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysql</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --help</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --verbose</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> my.cnf</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                      order</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> preference,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> my.cnf,</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> $MYSQL_TCP_PORT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">/etc/my.cnf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /etc/mysql/my.cnf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /opt/homebrew/etc/my.cnf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ~/.my.cnf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> vim</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /opt/homebrew/etc/my.cnf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[mysqld]</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">log_bin</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysql-bin</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"> #config binlog</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">binlog_format</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ROW</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"> #select row-mode</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">server_id</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> chown</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> _mysql:_mysql</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /Users/jan/Database/k8s/data_tidb/mysql-binlog</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> brew</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> services</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> restart</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysql</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> brew</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> services</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> list</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysql</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">mysql</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">         started</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">         jan</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  ~/Library/LaunchAgents/homebrew.mxcl.mysql.plist</span></span></code></pre>
</div></li>
<li>
<p>Enable binlog and configure an independent path</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">mysql</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> show variables </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">like</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> '%log_bin%'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">---------------------------------+------------------------------------------------------+</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| Variable_name                   | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">Value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                                |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">---------------------------------+------------------------------------------------------+</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| log_bin                         | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">ON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                                   |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| log_bin_basename                | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">opt</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">homebrew</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">var</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">mysql</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">mysql</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">bin                    |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| log_bin_index                   | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">Users</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">jan</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/Database/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">k8s</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">data_tidb</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">mysql</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">binlog</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">index</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| log_bin_trust_function_creators | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">OFF</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                                  |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| log_bin_use_v1_row_events       | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">OFF</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                                  |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| sql_log_bin                     | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">ON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                                   |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">---------------------------------+------------------------------------------------------+</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">mysql</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> show </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">master</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> status</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">------------------+----------+--------------+------------------+-------------------+</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">File</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">             | Position | Binlog_Do_DB | Binlog_Ignore_DB | Executed_Gtid_Set |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">------------------+----------+--------------+------------------+-------------------+</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| mysql</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">bin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">000008</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |      </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">157</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |              |                  |                   |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">------------------+----------+--------------+------------------+-------------------+</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> row</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> in</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">01</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> sec)</span></span></code></pre>
</div></li>
</ol>
<h2 id="_2-configure-the-dm-using-tidb-operator" tabindex="-1">2. Configure the DM using TiDB Operator <a class="header-anchor" href="#_2-configure-the-dm-using-tidb-operator" aria-label="Permalink to &quot;2. Configure the DM using TiDB Operator&quot;"></a></h2>
<ol>
<li>
<p><a href="https://docs.pingcap.com/zh/tidb-in-kubernetes/stable/deploy-tidb-dm#%E5%9C%A8-kubernetes-%E4%B8%8A%E9%83%A8%E7%BD%B2-dm" target="_blank" rel="noreferrer">TiDB on kubernetes  Official document</a> written in detail, follow the steps to deploy will not be too much of a problem.</p>
<blockquote>
<p>Modify variables to suit your deployment environment</p>
</blockquote>
<table tabindex="0">
<thead>
<tr>
<th>variable name note</th>
<th>variable values</th>
<th>comments</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>jan -dm</td>
<td>DM cluster name</td>
</tr>
<tr>
<td>namespace</td>
<td>tidb - cluster</td>
<td>namespace, and tidb cluster under a space</td>
</tr>
<tr>
<td>storageSize</td>
<td>10Gi</td>
<td></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>ÈÉ®ÁΩ≤ DM Master</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> less</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-dm-master.yaml</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">apiVersion:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> pingcap.com/v1alpha1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">kind:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> DMCluster</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">metadata:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">name:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> jan-dm</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">namespace:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">spec:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">version:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> v6.5.0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">configUpdateStrategy:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> RollingUpdate</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">pvReclaimPolicy:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Retain</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">discovery:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> {}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">master:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">baseImage:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> pingcap/dm</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">maxFailoverCount:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">imagePullPolicy:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> IfNotPresent</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">service:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">type</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> NodePort</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># When the DM-master service needs to be exposed to a fixed NodePort</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># masterNodePort: 30020</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">replicas:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">storageSize:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "10Gi"</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">requests:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">cpu:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">config:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">rpc-timeout</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "40s"</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> apply</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-dm-master.yaml</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span></span></code></pre>
</div></li>
<li>
<p>Deploying DM Worker</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> less</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-dm-worker.yaml</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">apiVersion:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> pingcap.com/v1alpha1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">kind:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> DMCluster</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">metadata:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">name:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> jan-dm</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">namespace:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">spec:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">version:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> v6.5.0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">configUpdateStrategy:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> RollingUpdate</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">pvReclaimPolicy:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Retain</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">discovery:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> {}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">worker:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">baseImage:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> pingcap/dm</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">maxFailoverCount:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">replicas:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">storageSize:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "20Gi"</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">requests:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">cpu:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">config:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">keepalive-ttl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 15</span></span></code></pre>
</div></li>
<li>
<p>Official document not introduce integrated DM monitoring method, from <a href="https://github.com/pingcap/tidb-operator/pull/3528" target="_blank" rel="noreferrer">tidb-operator github repo</a> to find the related description, The following code blocks are the actual steps.</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> vim</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-monitor.yaml</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Add the following information to the deployment file (tidb-monitor.yaml) of the monitor that previously deployed the TiDB Cluster </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">spec:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">dm:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    clusters:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> name:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> basicdm</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    initializer:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    baseImage:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> pingcap/dm-monitor-initializer</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    version:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> v2.0.0</span></span></code></pre>
</div></li>
<li>
<p>Check the DM pod status and monitoring</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> pod</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan-dm-dm-discovery-5c84866d6c-cwcx6</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">          14d</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan-dm-dm-master-0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                     1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">          14d</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan-dm-dm-worker-0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                     1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">          14d</span></span></code></pre>
</div></li>
</ol>
<h2 id="_3-configure-dm-task" tabindex="-1">3. Configure DM task <a class="header-anchor" href="#_3-configure-dm-task" aria-label="Permalink to &quot;3. Configure DM task&quot;"></a></h2>
<ol>
<li>
<p>After the DM Master and Worker are deployed, log in to the Master pod and use the ctl to create synchronization tasks.</p>
</li>
<li>
<p>Note: host uses' host.docker.internal 'because you need to access MySQL locally deployed on the MacBook via brew inside k8s, which is equivalent to configuring <code>127.0.0.1</code>.</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> exec</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -it</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> jan-dm-dm-master-0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> sh</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">/</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"> # ls |grep dmctl</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">dmctl</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">/mkdir</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> conf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> &#x26; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> conf</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">/conf</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"> # vim source1.yaml</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">source-id:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "mysql-replica-01"</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">enable-gtid:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> false</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">from:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">host:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "host.docker.internal"</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">user:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "root"</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">password:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ""</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">port:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 3306</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">/conf</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"> # ../dmctl --master-addr jan-dm-dm-master-0:8261 operate-source create  source1.yaml</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    "msg"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    "sources"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "msg"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "source"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "mysql-replica-01",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "worker"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "jan-dm-dm-worker-0"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
</div></li>
</ol>
<h2 id="_4-prepare-dm-loader-pv" tabindex="-1">4. Prepare DM loader PV <a class="header-anchor" href="#_4-prepare-dm-loader-pv" aria-label="Permalink to &quot;4. Prepare DM loader PV&quot;"></a></h2>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ÔΩû</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> vim</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-dm-loader-pv.yaml</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">apiVersion:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> v1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">kind:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> PersistentVolume</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">metadata:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    name:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm-loader-dir</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">spec:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    capacity:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    storage:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 5Gi</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    accessModes:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ReadWriteOnce</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    persistentVolumeReclaimPolicy:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Retain</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    storageClassName:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> local-storage</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    local:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    path:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /Users/jan/Database/k8s/data_tidb/loader-mysql-dir</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    nodeAffinity:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    required:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">        nodeSelectorTerms:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">        -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> matchExpressions:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">        -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> key:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> kubernetes.io/hostname</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            operator:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> In</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            values:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> localhost</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> apply</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-dm-loader-pv.yaml</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> pv</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm-loader-dir</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">dm-loader-dir</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                              5Gi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">        RWO</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">            Retain</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">           Available</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                               local-storage</span></span></code></pre>
</div><h2 id="_5-craete-table-data-on-mysql" tabindex="-1">5. Craete table data on MySQL <a class="header-anchor" href="#_5-craete-table-data-on-mysql" aria-label="Permalink to &quot;5. Craete table data on MySQL&quot;"></a></h2>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> brew</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> instal</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> sysbench</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> sysbench</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oltp_read_write</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --mysql-host=127.0.0.1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    --mysql-port=3306</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --mysql-db=test</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    --mysql-user=root</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --mysql-password=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    --table_size=5000</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --tables=10</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  --events=10000</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    --report-interval=10</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> prepare</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Creating</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> table</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'sbtest1'...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Inserting</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 5000</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> records</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> into</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'sbtest1'</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Creating</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> secondary</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> index</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> on</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'sbtest1'...</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">...</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Creating</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> table</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'sbtest10'...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Inserting</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 5000</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> records</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> into</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'sbtest10'</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Creating</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> secondary</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> index</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> on</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'sbtest10'...</span></span></code></pre>
</div><h2 id="import-dm-data" tabindex="-1">Import DM data <a class="header-anchor" href="#import-dm-data" aria-label="Permalink to &quot;Import DM data&quot;"></a></h2>
<p>Manually create table structures from <code>sbtest1-sbtest10</code> separately in TiDB, otherwise COLLATE=utf8mb4_0900_ai_ci is incompatible.</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sbtest1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">` (</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sbtest2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">` (</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">......</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">/*!40101 SET NAMES binary*/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sbtest10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">` (</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  `id`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> int</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> NOT NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> AUTO_INCREMENT,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  `k`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> int</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> NOT NULL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> DEFAULT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> '0'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  `c`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> char</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">120</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">NOT NULL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> DEFAULT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ''</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  `pad`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> char</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">60</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">NOT NULL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> DEFAULT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ''</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  PRIMARY KEY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`id`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">),</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  KEY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `k_6`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`k`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) ENGINE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">InnoDB AUTO_INCREMENT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">5001</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> DEFAULT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> CHARSET</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">utf8mb4;</span></span></code></pre>
</div><h2 id="_7-start-task" tabindex="-1">7. Start task <a class="header-anchor" href="#_7-start-task" aria-label="Permalink to &quot;7. Start task&quot;"></a></h2>
<ol>
<li>
<p>If the table is not manually created and <code>utf8mb4_0900_ai_ci</code> is incompatible, you need to use the <code>--remove-meta</code> command to restart the synchronization task. Otherwise, this parameter is omitted.</p>
</li>
<li>
<p>The synchronization status is not expected</p>
<div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">/conf</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"> # ../dmctl --master-addr jan-dm-dm-master-0:8261 start-task ./task.yaml --remove-meta</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    "result"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    "msg"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">""</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    "sources"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">            "result"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">            "msg"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">""</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">            "source"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"mysql-replica-01"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">            "worker"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"jan-dm-dm-worker-0"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    ],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    "checkResult"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"fail to check synchronization configuration with type: no errors but some warnings</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">        detail: {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                "results"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                        {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                "id"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                "name"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"mysql_version"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                "desc"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"check whether mysql version is satisfied"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                "state"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"warn"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                "errors"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                        {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                                "severity"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"warn"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                                "short_error"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"version suggested earlier than 8.0.0 but got 8.0.32"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                ],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                "instruction"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"It is recommended that you select a database version that meets the requirements before performing data migration. Otherwise data inconsistency or task exceptions might occur."</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                "extra"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"address of db instance - host.docker.internal:3306"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                        },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                        {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                "id"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">9</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                "name"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"table structure compatibility check"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                "desc"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"check compatibility of table structure"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                "state"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"warn"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                "errors"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                        {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                                "severity"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"warn"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                                "short_error"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"table `test`.`sbtest9` collation is not same, upstream: (sbtest9 utf8mb4_0900_ai_ci), downstream: (sbtest9 utf8mb4_bin)"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                        },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                        {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                                "severity"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"warn"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                                "short_error"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"table `test`.`sbtest5` collation is not same, upstream: (sbtest5 utf8mb4_0900_ai_ci), downstream: (sbtest5 utf8mb4_bin)"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                        },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                        {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                                "severity"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"warn"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                                "short_error"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"table `test`.`sbtest7` collation is not same, upstream: (sbtest7 utf8mb4_0900_ai_ci), downstream: (sbtest7 utf8mb4_bin)"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                        },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                        {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                                "severity"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"warn"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                                "short_error"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"table `test`.`sbtest3` collation is not same, upstream: (sbtest3 utf8mb4_0900_ai_ci), downstream: (sbtest3 utf8mb4_bin)"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                        },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                        {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                                "severity"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"warn"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                                "short_error"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"table `test`.`sbtest8` collation is not same, upstream: (sbtest8 utf8mb4_0900_ai_ci), downstream: (sbtest8 utf8mb4_bin)"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                        },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                        {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                                "severity"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"warn"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                                "short_error"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"table `test`.`sbtest10` collation is not same, upstream: (sbtest10 utf8mb4_0900_ai_ci), downstream: (sbtest10 utf8mb4_bin)"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                        },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                        {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                                "severity"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"warn"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                                "short_error"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"table `test`.`sbtest2` collation is not same, upstream: (sbtest2 utf8mb4_0900_ai_ci), downstream: (sbtest2 utf8mb4_bin)"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                        },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                        {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                                "severity"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"warn"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                                "short_error"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"table `test`.`sbtest6` collation is not same, upstream: (sbtest6 utf8mb4_0900_ai_ci), downstream: (sbtest6 utf8mb4_bin)"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                        },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                        {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                                "severity"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"warn"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                                "short_error"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"table `test`.`sbtest1` collation is not same, upstream: (sbtest1 utf8mb4_0900_ai_ci), downstream: (sbtest1 utf8mb4_bin)"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                ],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                "instruction"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"Ensure that you use the same collations for both upstream and downstream databases. Otherwise the query results from the two databases might be inconsistent.; "</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                ],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                "summary"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                        "passed"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                        "total"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                        "successful"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                        "failed"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                        "warning"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        }</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">}</span></span></code></pre>
</div></li>
<li>
<p>The synchronization status is not expected</p>
<div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">/conf</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"> # ../dmctl --master-addr jan-dm-dm-master-0:8261 query-status local-mysql-test</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    "result"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    "msg"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">""</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    "sources"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">            "result"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">            "msg"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">""</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">            "sourceStatus"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                "source"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"mysql-replica-01"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                "worker"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"jan-dm-dm-worker-0"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                "result"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                "relayStatus"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">null</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">            },</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">            "subTaskStatus"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                    "name"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"local-mysql-test"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                    "stage"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"Running"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                    "unit"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"Sync"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                    "result"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                    "unresolvedDDLLockID"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">""</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                    "sync"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                        "totalEvents"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"0"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                        "totalTps"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"0"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                        "recentTps"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"0"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                        "masterBinlog"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"(mysql-bin.000009, 9552368)"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                        "masterBinlogGtid"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">""</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                        "syncerBinlog"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"(mysql-bin.000009, 9552368)"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                        "syncerBinlogGtid"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">""</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                        "blockingDDLs"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                        ],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                        "unresolvedGroups"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                        ],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                        "synced"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                        "binlogType"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"remote"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                        "secondsBehindMaster"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"0"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                        "blockDDLOwner"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">""</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                        "conflictMsg"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">""</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                        "totalRows"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"0"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                        "totalRps"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"0"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                        "recentRps"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"0"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                    },</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                    "validation"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">null</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">            ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
</div></li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Deploy Lightning on the TiDB Operator of Macbook M1]]></title>
            <link>https://askaric.com/en/work/tidb/08TiDB-Cloud-K8S/8-1TiDB-Deployment/03TiDB-Operator deploys Lightning.html</link>
            <guid>https://askaric.com/en/work/tidb/08TiDB-Cloud-K8S/8-1TiDB-Deployment/03TiDB-Operator deploys Lightning.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[# Deploy Lightning on the TiDB Operator of Macbook M1

> **This document has been released, which means the original documents's been moved to the period of maintenance. [Please comment anything you want at the topic](http://forum.dbnest.net/t/topic/34).**

## ‰∏Ä„ÄÅÂâçË®Ä

1. The reason why it is necessary to learn K8S Lightning is that it is difficult to meet expectations when a large number of derivatives are simply based on mapping ports. There is a big difference in the import speed between tidb backend and local backend. [Reference TiDB website](https://docs.pingcap.com/tidb/v4.0/tidb-lightning-backends) see the table below.

    ![03-lightning-speed-in-mode](../../../../../images/tidb/08TiDB-Cloud-K8S/8-1TiDB-Deployment/03-lightning-speed-in-mode.jpeg)

2. Lighting is special, it's just an executable, and in exploring ways to use Lightning in Found 2, namely: **[k8s outside the cluster call tidb-Lightning binary](#3call-lightning-on-the-physical-machine)** and **[Use helm to create import task recommended by TiDB official website](#2-deploy-lightning-on-tidb-operator)**.

## 2. Deploy Lightning on TiDB-Operator

1. [TiDB import cluster data recommended by the official website](https://docs.pingcap.com/zh/tidb-in-kubernetes/stable/restore-data-using-tidb-lightning) is perfect, The following are specific steps.
2. Prepare the PV and deploy lightning.

    ```shell
    jan@Jan-M1-Pro tidb-config % vim tidb-lightning-values.yaml
    ......
    # For `local` backend, an extra PV is needed for local KV sorting.
    sortedKV:
      storageClassName: local-storage
      storage: 5Gi
    ......


    jan@Jan-M1-Pro tidb-config % helm search repo -l tidb-operator

    jan@Jan-M1-Pro tidb-config % helm inspect values pingcap/tidb-lightning --version=v1.4.0 > tidb-lightning-values.yaml
                                              local-storage            12d

    jan@Jan-M1-Pro tidb-config % kubectl get nodes --show-labels
    NAME             STATUS   ROLES           AGE   VERSION   LABELS
    docker-desktop   Ready    control-plane   13d   v1.25.4   beta.kubernetes.io/arch=arm64,beta.kubernetes.io/os=linux,kubernetes.io/arch=arm64,kubernetes.io/hostname=docker-desktop,kubernetes.io/os=linux,node-role.kubernetes.io/control-plane=,node.kubernetes.io/exclude-from-external-load-balancers=

    # find specific Node Name(such asÔºödocker-desktop)
    jan@Jan-M1-Pro tidb-config % vim tidb-lightning-pv.yaml
    apiVersion: v1
    kind: PersistentVolume
    metadata:
      name: local-sharedssd
    spec:
      capacity:
        storage: 5Gi
      accessModes:
        - ReadWriteOnce
      persistentVolumeReclaimPolicy: Retain
      storageClassName: local-storage
      local:
        path: /Users/jan/Database/k8s/data_tidb/sharedssd
      nodeAffinity:
        required:
          nodeSelectorTerms:
          - matchExpressions:
            - key: kubernetes.io/hostname
              operator: In
              values:
              - docker-desktop

    jan@Jan-M1-Pro tidb-config % kubectl apply -f tidb-lightning-pv.yaml

    jan@Jan-M1-Pro tidb-config % kubectl get pv |grep -B 10 Available
    NAME                                       CAPACITY   ACCESS MODES   RECLAIM POLICY   STATUS      CLAIM                                       STORAGECLASS    REASON   AGE local-sharedssd                            5Gi        RWO            Retain           Available    

    jan@Jan-M1-Pro tidb-config % helm install jan-lightning pingcap/tidb-lightning --namespace=tidb-cluster --set failFast=true -f tidb-lightning-values.yaml --version=v1.4.0

    NAME: jan-lightning
    LAST DEPLOYED: Wed Mar 29 17:18:45 2023
    NAMESPACE: tidb-cluster
    STATUS: deployed
    REVISION: 1
    TEST SUITE: None
    NOTES:
    1. Check tidb-lightning status
      kubectl get job -n tidb-cluster -l app.kubernetes.io/name=jan-lightning-tidb-lightning
      kubectl get po -n tidb-cluster -l app.kubernetes.io/name=jan-lightning-tidb-lightning
    2. Check tidb-lightning logs
      kubectl logs -n tidb-cluster -l app.kubernetes.io/name=jan-lightning-tidb-lightning
    3. View tidb-lightning status page
      kubectl port-forward -n tidb-cluster svc/jan-lightning-tidb-lightning 8289:8289
      View http://localhost:8289 in web browser

    jan@Jan-M1-Pro tidb-config % kubectl logs -n tidb-cluster -l app.kubernetes.io/name=jan-lightning-tidb-lightning --tail=-1 |grep "successfully"
    tidb lightning exit successfully
    ```

3. Wait for the import to complete

    ```shell
    jan@Jan-M1-Pro tidb-config % kubectl get pod -n tidb-cluster |grep lightning
    jan-lightning-tidb-lightning-7ssfc     0/1     Completed   0          22h
    ```

## 3„ÄÅCall Lightning on the physical machine

1. Since Lightning requires the operation port and status port of tikv, tidb and pd, they all need to be exposed to the local physical machine.

    ```shell
    jan@Jan-M1-Pro ~ % kubectl port-forward svc/basic-tidb 6000:4000 -n tidb-cluster
    Forwarding from 127.0.0.1:6000 -> 4000
    Forwarding from [::1]:6000 -> 4000
    Handling connection for 6000
    
    jan@Jan-M1-Pro ~ % kubectl port-forward svc/basic-tidb 10080:10080 -n tidb-cluster
    Forwarding from 127.0.0.1:10080 -> 10080
    Forwarding from [::1]:10080 -> 10080
    
    jan@Jan-M1-Pro ~ % kubectl port-forward svc/basic-pd 2379:2379 -n tidb-cluster
    Forwarding from 127.0.0.1:2379 -> 2379
    Forwarding from [::1]:2379 -> 2379
    
    
    jan@Jan-M1-Pro ~ % kubectl port-forward svc/basic-tikv-peer 20160:20160 -n tidb-cluster
    Forwarding from 127.0.0.1:20160 -> 20160
    Forwarding from [::1]:20160 -> 20160
    Handling connection for 20160
    ```

2. Even exposed ports still report errors, we can see from the error message which's ```\"transport: Error while dialing dial tcp: lookup basic-pd-0.basic-pd-peer.tidb-cluster.svc: no such host\"``` the tidb cluster returned the internal routing information of k8s to lightning.

      ```shell
      jan@Jan-M1-Pro tidb-config % tiup tidb-lightning -c ./lightning-config.yaml --log-file ./lightning.log
      tiup is checking updates for component tidb-lightning ...
      Starting component `tidb-lightning`: /Users/jan/.tiup/components/tidb-lightning/v6.6.0/tidb-lightning -c ./lightning-config.yaml --log-file ./lightning.log
      Verbose debug logs will be written to ./lightning.log
      
      {"level":"warn","ts":"2023-03-30T02:20:19.463+0800","logger":"etcd-client","caller":"v3@v3.5.2/retry_interceptor.go:62","msg":"retrying of unary invoker failed","target":"etcd-endpoints://0x14000d78000/127.0.0.1:2379","attempt":0,"error":"rpc error: code = DeadlineExceeded desc = latest balancer error: last connection error: connection error: desc = \"transport: Error while dialing dial tcp: lookup basic-pd-0.basic-pd-peer.tidb-cluster.svc: no such host\""}
      {"level":"info","ts":"2023-03-30T02:20:19.464+0800","logger":"etcd-client","caller":"v3@v3.5.2/client.go:207","msg":"Auto sync endpoints failed.","error":"context deadline exceeded"}
      tidb lightning encountered error: [Lightning:KV:ErrCreateKVClient]create kv client error: [PD:client:ErrClientCreateTSOStream]create TSO stream failed, retry timeout
      ```

3. The way around this is to add the domain name mapping of all SVCs to host

    ```shell
    jan@Jan-M1-Pro ~ % cat /etc/hosts
    ......
    127.0.0.1 basic-pd-0.basic-pd-peer.tidb-cluster.svc
    127.0.0.1 basic-tikv-0.basic-tikv-peer.tidb-cluster.svc
    ```

4. Import and verify

      ```sql
      mysql> show tables;
      Empty set (0.01 sec)
      
      // Specify a lightning import task and wait for it to complete
      
      mysql> show tables;
      +]]></description>
            <content:encoded><![CDATA[<h1 id="deploy-lightning-on-the-tidb-operator-of-macbook-m1" tabindex="-1">Deploy Lightning on the TiDB Operator of Macbook M1 <a class="header-anchor" href="#deploy-lightning-on-the-tidb-operator-of-macbook-m1" aria-label="Permalink to &quot;Deploy Lightning on the TiDB Operator of Macbook M1&quot;"></a></h1>
<blockquote>
<p><strong>This document has been released, which means the original documents's been moved to the period of maintenance. <a href="http://forum.dbnest.net/t/topic/34" target="_blank" rel="noreferrer">Please comment anything you want at the topic</a>.</strong></p>
</blockquote>
<h2 id="‰∏Ä„ÄÅÂâçË®Ä" tabindex="-1">‰∏Ä„ÄÅÂâçË®Ä <a class="header-anchor" href="#‰∏Ä„ÄÅÂâçË®Ä" aria-label="Permalink to &quot;‰∏Ä„ÄÅÂâçË®Ä&quot;"></a></h2>
<ol>
<li>
<p>The reason why it is necessary to learn K8S Lightning is that it is difficult to meet expectations when a large number of derivatives are simply based on mapping ports. There is a big difference in the import speed between tidb backend and local backend. <a href="https://docs.pingcap.com/tidb/v4.0/tidb-lightning-backends" target="_blank" rel="noreferrer">Reference TiDB website</a> see the table below.</p>
<figure><img src="./../../../../../images/tidb/08TiDB-Cloud-K8S/8-1TiDB-Deployment/03-lightning-speed-in-mode.jpeg" alt="03-lightning-speed-in-mode" tabindex="0"><figcaption>03-lightning-speed-in-mode</figcaption></figure>
</li>
<li>
<p>Lighting is special, it's just an executable, and in exploring ways to use Lightning in Found 2, namely: <strong><a href="#3call-lightning-on-the-physical-machine">k8s outside the cluster call tidb-Lightning binary</a></strong> and <strong><a href="#2-deploy-lightning-on-tidb-operator">Use helm to create import task recommended by TiDB official website</a></strong>.</p>
</li>
</ol>
<h2 id="_2-deploy-lightning-on-tidb-operator" tabindex="-1">2. Deploy Lightning on TiDB-Operator <a class="header-anchor" href="#_2-deploy-lightning-on-tidb-operator" aria-label="Permalink to &quot;2. Deploy Lightning on TiDB-Operator&quot;"></a></h2>
<ol>
<li>
<p><a href="https://docs.pingcap.com/zh/tidb-in-kubernetes/stable/restore-data-using-tidb-lightning" target="_blank" rel="noreferrer">TiDB import cluster data recommended by the official website</a> is perfect, The following are specific steps.</p>
</li>
<li>
<p>Prepare the PV and deploy lightning.</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> vim</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-lightning-values.yaml</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># For `local` backend, an extra PV is needed for local KV sorting.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sortedKV:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  storageClassName:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> local-storage</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  storage:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 5Gi</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> helm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> search</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> repo</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -l</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-operator</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> helm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> inspect</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> values</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> pingcap/tidb-lightning</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --version=v1.4.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> ></span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-lightning-values.yaml</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                                          local-storage</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">            12d</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> nodes</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --show-labels</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">             STATUS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   ROLES</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">           AGE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   VERSION</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   LABELS</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">docker-desktop</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   Ready</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    control-plane</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   13d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   v1.25.4</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   beta.kubernetes.io/arch=arm64,beta.kubernetes.io/os=linux,kubernetes.io/arch=arm64,kubernetes.io/hostname=docker-desktop,kubernetes.io/os=linux,node-role.kubernetes.io/control-plane=,node.kubernetes.io/exclude-from-external-load-balancers=</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># find specific Node Name(such asÔºödocker-desktop)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> vim</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-lightning-pv.yaml</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">apiVersion:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> v1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">kind:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> PersistentVolume</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">metadata:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  name:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> local-sharedssd</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">spec:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  capacity:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    storage:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 5Gi</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  accessModes:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ReadWriteOnce</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  persistentVolumeReclaimPolicy:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Retain</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  storageClassName:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> local-storage</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  local:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    path:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /Users/jan/Database/k8s/data_tidb/sharedssd</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  nodeAffinity:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    required:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">      nodeSelectorTerms:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">      -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> matchExpressions:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">        -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> key:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> kubernetes.io/hostname</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">          operator:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> In</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">          values:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">          -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> docker-desktop</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> apply</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-lightning-pv.yaml</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> pv</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">grep</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -B</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 10</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Available</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                       CAPACITY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   ACCESS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> MODES</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   RECLAIM</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> POLICY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   STATUS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      CLAIM</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                       STORAGECLASS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    REASON</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   AGE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> local-sharedssd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                            5Gi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">        RWO</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">            Retain</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">           Available</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> helm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> jan-lightning</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> pingcap/tidb-lightning</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --namespace=tidb-cluster</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> failFast=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">true</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-lightning-values.yaml</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --version=v1.4.0</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">NAME:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> jan-lightning</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">LAST</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> DEPLOYED:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Wed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Mar</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 29</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 17:18:45</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 2023</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">NAMESPACE:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">STATUS:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> deployed</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">REVISION:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">TEST</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> SUITE:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">NOTES:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">1.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Check</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-lightning</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> status</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> job</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -l</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> app.kubernetes.io/name=jan-lightning-tidb-lightning</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> po</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -l</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> app.kubernetes.io/name=jan-lightning-tidb-lightning</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">2.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Check</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-lightning</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> logs</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> logs</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -l</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> app.kubernetes.io/name=jan-lightning-tidb-lightning</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">3.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> View</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-lightning</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> status</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> page</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> port-forward</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> svc/jan-lightning-tidb-lightning</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 8289:8289</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  View</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> http://localhost:8289</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> web</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> browser</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> logs</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -l</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> app.kubernetes.io/name=jan-lightning-tidb-lightning</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --tail=-1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "successfully"</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tidb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> lightning</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> exit</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> successfully</span></span></code></pre>
</div></li>
<li>
<p>Wait for the import to complete</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> pod</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> lightning</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan-lightning-tidb-lightning-7ssfc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     0/1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     Completed</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">          22h</span></span></code></pre>
</div></li>
</ol>
<h2 id="_3„ÄÅcall-lightning-on-the-physical-machine" tabindex="-1">3„ÄÅCall Lightning on the physical machine <a class="header-anchor" href="#_3„ÄÅcall-lightning-on-the-physical-machine" aria-label="Permalink to &quot;3„ÄÅCall Lightning on the physical machine&quot;"></a></h2>
<ol>
<li>
<p>Since Lightning requires the operation port and status port of tikv, tidb and pd, they all need to be exposed to the local physical machine.</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ~</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> port-forward</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> svc/basic-tidb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 6000:4000</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Forwarding</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 127.0.0.1:6000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 4000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Forwarding</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [::1]:6000 -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> 4000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Handling</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> connection</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> for</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 6000</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ~</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> port-forward</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> svc/basic-tidb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 10080:10080</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Forwarding</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 127.0.0.1:10080</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 10080</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Forwarding</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [::1]:10080 -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> 10080</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ~</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> port-forward</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> svc/basic-pd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 2379:2379</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Forwarding</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 127.0.0.1:2379</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 2379</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Forwarding</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [::1]:2379 -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> 2379</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ~</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> port-forward</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> svc/basic-tikv-peer</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 20160:20160</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Forwarding</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 127.0.0.1:20160</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 20160</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Forwarding</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [::1]:20160 -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> 20160</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Handling</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> connection</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> for</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 20160</span></span></code></pre>
</div></li>
<li>
<p>Even exposed ports still report errors, we can see from the error message which's <code>\&quot;transport: Error while dialing dial tcp: lookup basic-pd-0.basic-pd-peer.tidb-cluster.svc: no such host\&quot;</code> the tidb cluster returned the internal routing information of k8s to lightning.</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tiup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-lightning</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ./lightning-config.yaml</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --log-file</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ./lightning.log</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tiup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> checking</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> updates</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> component</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-lightning</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> component</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tidb-lightning</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /Users/jan/.tiup/components/tidb-lightning/v6.6.0/tidb-lightning</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ./lightning-config.yaml</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --log-file</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ./lightning.log</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Verbose</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> debug</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> logs</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> will</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> be</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> written</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ./lightning.log</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"level"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"warn"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"ts"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"2023-03-30T02:20:19.463+0800"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"logger"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"etcd-client"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"caller"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"v3@v3.5.2/retry_interceptor.go:62"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"msg"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"retrying of unary invoker failed"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"target"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"etcd-endpoints://0x14000d78000/127.0.0.1:2379"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"attempt"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">:0,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"error"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"rpc error: code = DeadlineExceeded desc = latest balancer error: last connection error: connection error: desc = </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">transport: Error while dialing dial tcp: lookup basic-pd-0.basic-pd-peer.tidb-cluster.svc: no such host</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"level"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"info"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"ts"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"2023-03-30T02:20:19.464+0800"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"logger"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"etcd-client"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"caller"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"v3@v3.5.2/client.go:207"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"msg"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"Auto sync endpoints failed."</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"error"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"context deadline exceeded"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tidb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> lightning</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> encountered</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> error:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [Lightning:KV:ErrCreateKVClient]create kv client error: [PD:client:ErrClientCreateTSOStream]create TSO stream failed, retry timeout</span></span></code></pre>
</div></li>
<li>
<p>The way around this is to add the domain name mapping of all SVCs to host</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ~</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /etc/hosts</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">127.0.0.1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> basic-pd-0.basic-pd-peer.tidb-cluster.svc</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">127.0.0.1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> basic-tikv-0.basic-tikv-peer.tidb-cluster.svc</span></span></code></pre>
</div></li>
<li>
<p>Import and verify</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">mysql</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> show tables;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">Empty</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">01</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> sec)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">//</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Specify a lightning import task </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">and</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> wait </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> it </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">to</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> complete</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">mysql</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> show tables;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">----------------+</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| Tables_in_test |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">----------------+</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| sbtest1        |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| sbtest10       |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| sbtest2        |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| sbtest3        |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| sbtest4        |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| sbtest5        |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| sbtest6        |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| sbtest7        |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| sbtest8        |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| sbtest9        |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">----------------+</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">10</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> rows</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> in</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">01</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> sec)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">mysql</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> select</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> sbtest10 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">limit</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">----+------+-------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------+</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| id | k    | c                                                                                                                       | pad                                                         |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">----+------+-------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------+</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">|  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2506</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">77825755741</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">57613716249</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">41363434969</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">61943511716</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">24253397196</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">16456423243</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">71719660127</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">90287149046</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">57007239064</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">51092775305</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">22380089381</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03483981033</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">98305230683</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">44627144526</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">67135627326</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">----+------+-------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------+</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> row</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> in</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">01</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> sec)</span></span></code></pre>
</div></li>
</ol>
]]></content:encoded>
            <enclosure url="https://askaric.com/images/tidb/08TiDB-Cloud-K8S/8-1TiDB-Deployment/03-lightning-speed-in-mode.jpeg" length="0" type="image/jpeg"/>
        </item>
        <item>
            <title><![CDATA[Deploy TiCDC Cluster on the TiDB Operator of Macbook M1]]></title>
            <link>https://askaric.com/en/work/tidb/08TiDB-Cloud-K8S/8-1TiDB-Deployment/04TiDB-Operator deploys TiCDC.html</link>
            <guid>https://askaric.com/en/work/tidb/08TiDB-Cloud-K8S/8-1TiDB-Deployment/04TiDB-Operator deploys TiCDC.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[# Deploy TiCDC Cluster on the TiDB Operator of Macbook M1

> **This document has been released, which means the original documents's been moved to the period of maintenance. [Please comment anything you want at the topic](http://forum.dbnest.net/t/topic/26).**

## 1. Summary

1. Add pods to the TiDB Cluster on the deployed k8s. If you are not familiar with deploying TiDB, see [**"Macbook M1 Experience the Operator deploys TiDB Cluster"**](http://www.dbnest.net/zh/tidb/08TiDB-Cloud-K8S/8-1TiDB-%E5%BA%94%E7%94%A8%E5%AE%9E%E8%B7%B5/01TiDB-Operator%20%E9%83%A8%E7%BD%B2%20TiDB.html).
2. For details, see [TiDB website -- Deploy TiCDC on Kubernetes](https://docs.pingcap.com/zh/tidb-in-kubernetes/stable/deploy-ticdc#%E5%9C%A8-kubernetes-%E4%B8%8A%E9%83%A8%E7%BD%B2-ticdc), the following is the procedure.

## 2. Deploy downstream MySQL

This time, MySQL is selected as the downstream, and a MySQL is directly deployed on k8s. The steps are as follows:

```shell
jan@Jan-M1-Pro tidb-config % vim mysql.yaml
apiVersion: v1
kind: PersistentVolumeClaim
apiVersion: v1
metadata:
  name: ticdc-to-mysql-pvc
  namespace: tidb-cluster
spec:
  accessModes:
    - ReadWriteMany
  resources:
    requests:
      storage: 5Gi
]]></description>
            <content:encoded><![CDATA[<h1 id="deploy-ticdc-cluster-on-the-tidb-operator-of-macbook-m1" tabindex="-1">Deploy TiCDC Cluster on the TiDB Operator of Macbook M1 <a class="header-anchor" href="#deploy-ticdc-cluster-on-the-tidb-operator-of-macbook-m1" aria-label="Permalink to &quot;Deploy TiCDC Cluster on the TiDB Operator of Macbook M1&quot;"></a></h1>
<blockquote>
<p><strong>This document has been released, which means the original documents's been moved to the period of maintenance. <a href="http://forum.dbnest.net/t/topic/26" target="_blank" rel="noreferrer">Please comment anything you want at the topic</a>.</strong></p>
</blockquote>
<h2 id="_1-summary" tabindex="-1">1. Summary <a class="header-anchor" href="#_1-summary" aria-label="Permalink to &quot;1. Summary&quot;"></a></h2>
<ol>
<li>Add pods to the TiDB Cluster on the deployed k8s. If you are not familiar with deploying TiDB, see <a href="http://www.dbnest.net/zh/tidb/08TiDB-Cloud-K8S/8-1TiDB-%E5%BA%94%E7%94%A8%E5%AE%9E%E8%B7%B5/01TiDB-Operator%20%E9%83%A8%E7%BD%B2%20TiDB.html" target="_blank" rel="noreferrer"><strong>&quot;Macbook M1 Experience the Operator deploys TiDB Cluster&quot;</strong></a>.</li>
<li>For details, see <a href="https://docs.pingcap.com/zh/tidb-in-kubernetes/stable/deploy-ticdc#%E5%9C%A8-kubernetes-%E4%B8%8A%E9%83%A8%E7%BD%B2-ticdc" target="_blank" rel="noreferrer">TiDB website -- Deploy TiCDC on Kubernetes</a>, the following is the procedure.</li>
</ol>
<h2 id="_2-deploy-downstream-mysql" tabindex="-1">2. Deploy downstream MySQL <a class="header-anchor" href="#_2-deploy-downstream-mysql" aria-label="Permalink to &quot;2. Deploy downstream MySQL&quot;"></a></h2>
<p>This time, MySQL is selected as the downstream, and a MySQL is directly deployed on k8s. The steps are as follows:</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> vim</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysql.yaml</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">apiVersion:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> v1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">kind:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> PersistentVolumeClaim</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">apiVersion:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> v1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">metadata:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  name:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ticdc-to-mysql-pvc</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  namespace:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">spec:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  accessModes:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ReadWriteMany</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  resources:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    requests:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">      storage:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 5Gi</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">---</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">apiVersion:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> v1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">kind:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Service</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">metadata:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  name:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ticdc-to-mysql-svc</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  namespace:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">spec:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  ports:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> name:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysql</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    port:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 3306</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    targetPort:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 3306</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  selector:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    app:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysql</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  clusterIP:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> None</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">---</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">apiVersion:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> apps/v1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">kind:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Deployment</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">metadata:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  name:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ticdc-to-mysql-deploy</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  namespace:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">spec:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  replicas:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  selector:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    matchLabels:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">      app:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysql</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  template:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    metadata:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">      labels:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">        app:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysql</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    spec:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">      containers:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">        -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> name:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysql</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">          image:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysql:8.0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">          imagePullPolicy:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> IfNotPresent</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">          env:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">          -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> name:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> MYSQL_ROOT_PASSWORD</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            value:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "123123"</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">          ports:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> containerPort:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 3306</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">          volumeMounts:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> name:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysql-pvc</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">              mountPath:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /var/lib/mysql</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">      volumes:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">        -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> name:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysql-pvc</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">          persistentVolumeClaim:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            claimName:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ticdc-to-mysql-pvc</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> apply</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysql.yaml</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> pod</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -A</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ticdc</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tidb-cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   ticdc-to-mysql-deploy-85d5d498bc-wwcvb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                  28s</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> pv</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ticdc</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">pvc-00bdbc50-2be7-4525-8626-dc64ff8c1ef6</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   5Gi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">        RWX</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">            Delete</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">           Bound</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    tidb-cluster/ticdc-to-mysql-pvc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                       hostpath</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                 38s</span></span></code></pre>
</div><h2 id="_3-scaling-out-ticdc-pod" tabindex="-1">3. Scaling out TiCDC POD <a class="header-anchor" href="#_3-scaling-out-ticdc-pod" aria-label="Permalink to &quot;3. Scaling out TiCDC POD&quot;"></a></h2>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    READY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   PD</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                  STORAGE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   READY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   DESIRE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   TIKV</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                  STORAGE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   READY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   DESIRE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   TIDB</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                  READY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   DESIRE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   AGE</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">basic</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   True</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    pingcap/pd:v6.5.0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   1Gi</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">       1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">       1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">        pingcap/tikv:v6.5.0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   1Gi</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">       1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">       1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">        pingcap/tidb:v6.5.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">       1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">        14d</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> edit</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">spec:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  ticdc:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    baseImage:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> pingcap/ticdc</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    replicas:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 2</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> pod</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -A</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ticdc</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tidb-cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   basic-ticdc-0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                            1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                19s</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tidb-cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   basic-ticdc-1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                            1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                18s</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tidb-cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   ticdc-to-mysql-deploy-85d5d498bc-wwcvb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                7m5s</span></span></code></pre>
</div><h2 id="_4-create-changefeed" tabindex="-1">4. Create changefeed <a class="header-anchor" href="#_4-create-changefeed" aria-label="Permalink to &quot;4. Create changefeed&quot;"></a></h2>
<ol>
<li>
<p>Go to the deployed ticdc pod and synchronize TiDB table data from the DM import <a href="http://www.dbnest.net/zh/tidb/08TiDB-Cloud-K8S/8-1TiDB-%E5%BA%94%E7%94%A8%E5%AE%9E%E8%B7%B5/02TiDB-Operator%20%E9%83%A8%E7%BD%B2%20DM.html" target="_blank" rel="noreferrer">test.sbtest1 ~ test.sbtest10</a>.</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> exec</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -it</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> basic-ticdc-0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> sh</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">/</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"> # ps -ef|grep cdc</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> root</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      3h36</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /cdc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> server</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --addr=0.0.0.0:8301</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --advertise-addr=basic-ticdc-0.basic-ticdc-peer.tidb-cluster.svc:8301</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --gc-ttl=86400</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --log-file=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --log-level=info</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --pd=http://basic-pd:2379</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  91</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> root</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      0:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> cdc</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">/</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"> # mkdir config &#x26; cd config</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">/</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"> # vim changefeed-test.toml</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[filter]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">rules</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'test.*'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">/</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"> # /cdc cli changefeed create --server=http://basic-ticdc-0.basic-ticdc-peer.tidb-cluster.svc:8301 --sink-uri="mysql://root:123123@ticdc-to-mysql-svc:3307/" --changefeed-id="jan</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">-task</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Create changefeed successfully!</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ID: jan-task</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Info: {"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">upstream_id</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":7211019554206462790,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">namespace</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">default</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">id</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan-task</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sink_uri</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">mysql://root:xxxxx@ticdc-to-mysql-svc:3307/</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">create_time</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">2023-03-23T05:00:06.050107131Z</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">start_ts</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":440283327592660995,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">engine</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">unified</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">config</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":{"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">case_sensitive</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":true,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">enable_old_value</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":true,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">force_replicate</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":false,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ignore_ineligible_table</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":false,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">check_gc_safe_point</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":true,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">enable_sync_point</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":false,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">bdr_mode</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":false,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sync_point_interval</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":600000000000,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sync_point_retention</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":86400000000000,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">filter</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":{"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">rules</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":["</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">*.*</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"],"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">event_filters</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":null},"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">mounter</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":{"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">worker_num</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":16},"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sink</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":{"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">protocol</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">schema_registry</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">csv</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":{"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">delimiter</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">quote</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">\</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">""</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"null"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\\</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">N"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"include_commit_ts"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">:false},</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"column_selectors"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">:null,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"transaction_atomicity"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"none"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"encoder_concurrency"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">:16,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"terminator"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"\r\n"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"date_separator"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"none"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"enable_partition_separator"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">:false},</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"consistent"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">level</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">none</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">max_log_size</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":64,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">flush_interval</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":2000,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">storage</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":""}},"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">state</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">normal</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">creator_version</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">v6.5.0</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"}</span></span></code></pre>
</div></li>
<li>
<p>Check whether TiCDC monitoring and downstream data are properly synchronized.</p>
</li>
</ol>
<h2 id="_5-destroy-ticdc" tabindex="-1">5. Destroy TiCDC <a class="header-anchor" href="#_5-destroy-ticdc" aria-label="Permalink to &quot;5. Destroy TiCDC&quot;"></a></h2>
<ol>
<li>
<p>Delete a synchronization changefeed</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> exec</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -it</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> basic-ticdc-0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> sh</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">/</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"> # /cdc cli changefeed remove --server=http://basic-ticdc-0.basic-ticdc-peer.tidb-cluster.svc:8301 --changefeed-id="jan-task"</span></span></code></pre>
</div></li>
<li>
<p>Scaling in TiCDC pods</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> edit</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  ......</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  ticdc:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    baseImage:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> pingcap/ticdc</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    replicas:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 0</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  ......</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> pod</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -A</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ticdc</span></span></code></pre>
</div></li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[BR Overview]]></title>
            <link>https://askaric.com/en/work/tidb/TiDB-EcosystematicTools/5-2BR/01BR Overview.html</link>
            <guid>https://askaric.com/en/work/tidb/TiDB-EcosystematicTools/5-2BR/01BR Overview.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[What's BR
 How does it work
1. The part that can be tuned --
  a. num_threads : Âú®‰∫ã‰ª∂È©±Âä® pool ÁöÑ worker ]]></description>
            <content:encoded><![CDATA[<h1 id="br-overview" tabindex="-1">BR Overview <a class="header-anchor" href="#br-overview" aria-label="Permalink to &quot;BR Overview&quot;"></a></h1>
<h2 id="what-s-br" tabindex="-1">What's BR <a class="header-anchor" href="#what-s-br" aria-label="Permalink to &quot;What's BR&quot;"></a></h2>
<h2 id="how-does-it-work" tabindex="-1">How does it work <a class="header-anchor" href="#how-does-it-work" aria-label="Permalink to &quot;How does it work&quot;"></a></h2>
<ol>
<li>The part that can be tuned --&gt; <a href="https://github.com/tikv/tikv/blob/b5262299604df88711d9ed4b84d43e9c507749a2/src/config.rs#L2217" target="_blank" rel="noreferrer">https://github.com/tikv/tikv/blob/b5262299604df88711d9ed4b84d43e9c507749a2/src/config.rs#L2217</a>
a. num_threads : Âú®‰∫ã‰ª∂È©±Âä® pool ÁöÑ worker Êï∞ÈáèÔºå‰πüÂ∞±ÊòØÂ§á‰ªΩÂπ∂ÂèëÂ∫¶Ôºõ
b. spawn_backup_worker : ÂéªÂ§á‰ªΩÊï∞ÊçÆÔºõ
c. save_backup_file_worker Ôºö Ë∞ÉÁî® external storage Âéª‰øùÂ≠òÊï∞ÊçÆ Ôºõ</li>
<li>save_backup_file_worker ÊòØÊåâÁÖß region Âéª backup --&gt; <a href="https://github.com/tikv/tikv/blob/b5262299604df88711d9ed4b84d43e9c507749a2/components/backup/src/endpoint.rs#L836" target="_blank" rel="noreferrer">https://github.com/tikv/tikv/blob/b5262299604df88711d9ed4b84d43e9c507749a2/components/backup/src/endpoint.rs#L836</a>
a. batch_size Â∞±ÊòØ‰∏ÄÊ¨°Â§á‰ªΩÂ§öÂ∞ë‰∏™ regionÔºõ</li>
<li>brange.backup Áî® tokio future Êâ´ region Âπ∂ËêΩÂà∞Á£ÅÁõò‰∏ä--&gt; <a href="https://github.com/tikv/tikv/blob/b5262299604df88711d9ed4b84d43e9c507749a2/components/backup/src/endpoint.rs#L891" target="_blank" rel="noreferrer">https://github.com/tikv/tikv/blob/b5262299604df88711d9ed4b84d43e9c507749a2/components/backup/src/endpoint.rs#L891</a>
a. Êñá‰ª∂ÂêçÂ∫îËØ•ÈÅµÂæ™ÁöÑÊòØ format!(&quot;{}<em>{}</em>{}<em>{}</em>{}&quot;,store_id,region.get_id(),region.get_region_epoch().get_version(),k,since_the_epoch.as_millis()) Ê†ºÂºè‰øùÂ≠ò --&gt; <a href="https://github.com/tikv/tikv/blob/b5262299604df88711d9ed4b84d43e9c507749a2/components/backup/src/endpoint.rs#L862" target="_blank" rel="noreferrer">https://github.com/tikv/tikv/blob/b5262299604df88711d9ed4b84d43e9c507749a2/components/backup/src/endpoint.rs#L862</a></li>
<li>Áî® rust ÂÜô‰∫Ü‰∏™ mbr Áî®‰∫éÊ®°‰ªø br ÁöÑ‰∏Ä‰∫õÂäüËÉΩ --&gt; <a href="https://github.com/jansu-dev/mbr" target="_blank" rel="noreferrer">https://github.com/jansu-dev/mbr</a>
a. ÁõÆÂâçÂèØ‰ª•ÁøªËØëÈÉ®ÂàÜ backupmeta
b. ÊâãÂä®ÊåáÂÆö backupRange ÊûÑÈÄ† backupRequest ÂèØËÆ© tikv Â§á‰ªΩ sst Êñá‰ª∂
c. ‰ΩÜ restore ÈúÄË¶ÅËØªÂèñ backupmetaÔºårust ËøôÂùóÁº∫Â∞ëÂèØÁî®Áé∞ÊàêÂ∫ìÔºåÂ¶ÇÔºöparser.table_info„ÄÅparser.schema_info Á≠â‰ø°ÊÅØÔºåÊöÇÊó∂ËøòÊó†Ê≥ïÂÆûÁé∞„ÄÇÔºàÈôÜÁª≠ÂÆûÁé∞‰∏≠...Ôºâ</li>
</ol>
<h2 id="what-s-the-repo-of-yatp" tabindex="-1">what's the repo of yatp <a class="header-anchor" href="#what-s-the-repo-of-yatp" aria-label="Permalink to &quot;what's the repo of yatp&quot;"></a></h2>
<ol start="2">
<li>How does it work:</li>
<li>yatp encapsulates the repo of crossbeam-deque which is used to construct scheduler using deque structure and looks simple.</li>
<li>Here are some important concepts about yatp
1. TaskInjector:it's a global queue for new tasks . When a new task is injected into yatp,firstly, it will past the prepare_before_push to adjust the priority level. Secondly, push task into that level queue.
2. thread::Builder::new().name(name) will construct the thread number of local_queues in LazyBuilder::build.
3.</li>
</ol>
<p>LazyWorker --&gt; Worker --&gt; Builder --&gt; YatpPoolBuilder --&gt; yatp::Builder(build_single_level_pool)
init_servers --&gt; unified_read_pool --&gt; build_yatp_read_pool --&gt; build_multi_level_pool</p>
<p>In TiKV :</p>
<ol>
<li>
<p>We can see Worker::create is used to create a yatp thread pool,and Worker::lazy_build is to build some worker aiming for a specific function,like backup-endpoint ,which is a very important gate to see more details about the backup worker.</p>
</li>
<li>
<p>Worker : A worker that can schedule time consuming tasks, including some functions like new, start, start_with_timer, lazy_build ...</p>
</li>
<li>
<p>Builder : the main function is to init some yapt threads and return a struct of Worker.</p>
</li>
<li>
<p>Function start and start_with_timer:  the main functions are to init different schedulers with different functions,like timer or tick(ping).in short,it's used to add channel to communicate and exchange messages.</p>
</li>
<li>
<p>Function start_impl and start_with_timer_impl` : they are the actual actions to spawn a thread and commit tasks into it.</p>
</li>
<li>
<p>There's an important trait named Runnable for Endpoint and one of functions named Run() representing how to run a task for a specific worker.</p>
</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[BR tuning]]></title>
            <link>https://askaric.com/en/work/tidb/TiDB-EcosystematicTools/5-2BR/02BR Tuning.html</link>
            <guid>https://askaric.com/en/work/tidb/TiDB-EcosystematicTools/5-2BR/02BR Tuning.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[4.1 Parameter ratelimit can't limit the effect on TiKV
    1. Appearance Ôºö Both SQL duration and Txn]]></description>
            <content:encoded><![CDATA[<h1 id="br-tuning" tabindex="-1">BR tuning <a class="header-anchor" href="#br-tuning" aria-label="Permalink to &quot;BR tuning&quot;"></a></h1>
<p>4.1 Parameter ratelimit can't limit the effect on TiKV
1. Appearance Ôºö Both SQL duration and Txn duration will increase when
2. Ticket : TICKET-367 br Â§á‰ªΩËøáÁ®ã‰∏≠ÊúâÊä•Èîô‰∫ßÁîü  Resolved
3. Why can't ratelimt of parameter control the impact on SQL duration?
1. From here(ratelimit encapsulated in reader), we know that ratelimit limits speed of writing sst file from Mem into Disk. So, the backup tasks in TiKV wouldn't be limited, that means a lot of backup tasks could still be running and the scan-options will cost resources. And web doc also comments function and theory of ratelimt.
4. What's auto_tune feature in TiKV and how can it  fix this problem?
1. Feature from : BR: allow backup to restrict itself when cluster is in use by YuJuncen ¬∑ Pull Request #11132 ¬∑ tikv/
2. How it was created : From SoftLimitInner, we can see SoftLimit is a token controller expostulated Semaphore of tokio.
3. Why is it useful? : in this model, just task(concurrency) which has got token can be execute.
[Image]
5. Why can num-threads control the impact?
1. backup.num-threads controls the size of the backup thread pool.
2. From here, we see TiKV'll create the number of backup threads of num_threads(tokio::task) value for backup.
3. By num-threads,we can directly decrease concurrency of ScanValue.</p>
<p>4.2 what's the difference between concurrency and num-threads ?
1. Appearance : appear fetch pending tso requests error out of backup log.
2. Ticket : TICKET-367 br Â§á‰ªΩËøáÁ®ã‰∏≠ÊúâÊä•Èîô‰∫ßÁîü  Resolved
3. About BR backup principle :
1. BR is written by GO(BR backup client) and Rust(backup component in TiKV).
2. Their relationship is that BR-go is responsible for sending backup ranges of tables, and BR-Rust are the receivers which receive table ranges,  and doers(many stores) which scan tables and save the sst_files into external storage,like local, S3, etc.
3. What's concurrency?
1. From here, Web Doc tells us to add this number without TiKV bottleneck. And in code, we know that concurrency parameter is the  goroutine number to send backup task or backup ranges ,which are the table ranges(such as 8-concurrency == 8-range == 8 table), to TiKV. So it represents the concurrency of BR-go(or BR client).
4. What's num-threads?
1. From here, we know that num-threads parameter is the backup pool size in spawn_backup_worker function.So it's the concurrency in TiKV side.
4.3 what kind of impact does backup no leader have on BR backup and why?</p>
<ol>
<li>Appearance : [BR:Backup:ErrBackupNoLeader]backup no leader‚Äù]</li>
<li>Ticket : TICKET-679 Asktug - v5.1.4 - brÂ§á‰ªΩÊä•ErrBackupNoLeader]backup no leaderÁöÑÈîôËØØ   Resolved</li>
<li>About the Error:
1. From here, we can see the first step in function handleFineGrained,which is responsible for sending incomplete backup range of tables to retry backup tasks, is function findRegionLeader aiming for getting region leader.if it'has tried 5 times and still failed,this error will appear.
2. Why BR has function handleFineGrained?
<ol>
<li>Normal status, BR-go will send table backup range,which encode table_prefix and infinite range, to TiKV in the concurrency parameter value.</li>
<li>abnormal status. Sometimes, BR or TiKV will appear recoverable errors,which will crash backup tasks in TiKV side. So handleFineGrained is used to get the incomplete range from resend them to TiKV.</li>
</ol>
</li>
</ol>
<pre><code>3. Because of handleFineGrained mechanism, and it will get region leader. So, backup no leader will appear.
4. In short, if this error didn't cause an error or crash,it would be OK.
</code></pre>
<p>4.4 what's checksum of BR and what's checksum-concurrency?</p>
<ol>
<li>Appearance : appear &quot;[pd] failed updateLeader&quot; and &quot;[tikv:9002]TiKV server timeout&quot; out of nowhere.</li>
<li>Ticket : TICKET-768 ÂçéÊ≥∞ËØÅÂà∏ - v4.0.14 - BRÂ§á‰ªΩÊä•Èîô  Resolved</li>
<li>What mechanism is checksum of BR?
1. The checksum is equal to TiDB checksum for every backup table. and finally, the checksum values returned by TiKV will be stored in backup_metafile.
2. From here, we know every backup file also has a checksum value,but it's not the same as checksum of BR backup patameter. Every BACKUP_BATCH_LIMIT(1024 entry), which's also the size of sst_file entries ,will calculate a crc64 value and return to BR-go.</li>
<li>What's checksum-concurrency?
1. Default checksum-concurrency : 15 (equal to DistSQLScanConcurrency)
2. It's the concurrency of TiDB checksum of all backup tables.</li>
<li>Why appear TiKV server timeout and failed updateLeader?
1. Because one store arrived at threashould of unifiedReadPool upper bound when tikv was doing checksum computing.
4.5 Just a bug</li>
<li>TICKET-254 AskTUG--v5.4.0--BR ÊÅ¢Â§çÊä•ÈîôError: [kv:1062]Duplicate entry  Resolved</li>
<li><a href="https://github.com/pingcap/br/issues/1471" target="_blank" rel="noreferrer">https://github.com/pingcap/br/issues/1471</a></li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Dumpling QuickStart]]></title>
            <link>https://askaric.com/en/work/tidb/TiDB-EcosystematicTools/5-3Dumpling/01Dumpling QuickStart.html</link>
            <guid>https://askaric.com/en/work/tidb/TiDB-EcosystematicTools/5-3Dumpling/01Dumpling QuickStart.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[# Dumpling QuickStart

## Tiup manages Dumpling

```shell
[tidb@tiup-tidb41 ~]$ tiup install dumpling

[tidb@tiup-tidb41 ~]$ tiup list --installed
Available components:
Name      Owner    Description
]]></description>
            <content:encoded><![CDATA[<h1 id="dumpling-quickstart" tabindex="-1">Dumpling QuickStart <a class="header-anchor" href="#dumpling-quickstart" aria-label="Permalink to &quot;Dumpling QuickStart&quot;"></a></h1>
<h2 id="tiup-manages-dumpling" tabindex="-1">Tiup manages Dumpling <a class="header-anchor" href="#tiup-manages-dumpling" aria-label="Permalink to &quot;Tiup manages Dumpling&quot;"></a></h2>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ tiup install dumpling</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ tiup list --installed</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Available</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> components:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      Owner</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    Description</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">      -----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    -----------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">dumpling</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  pingcap</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Dumpling</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> CLI</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tool</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> that</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> helps</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> you</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dump</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> MySQL/TiDB</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> data</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span></code></pre>
</div><h2 id="test-dumping-on-mysql" tabindex="-1">Test Dumping on MySQL <a class="header-anchor" href="#test-dumping-on-mysql" aria-label="Permalink to &quot;Test Dumping on MySQL&quot;"></a></h2>
<ol>
<li>
<p>Prepare ENV</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">-- Create database for testing</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">mysql</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> database</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> jan_db;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">mysql</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> jan_db</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">mysql</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> table</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> jan_test (id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">DEFAULT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> CHARACTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> SET</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> utf8;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">mysql</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> insert into</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> jan_test </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">values</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'jan_1'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">),(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'jan_2'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">),(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'jan_3'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">),(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'jan_4'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">);</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">-- create and grant previlages</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> user</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> '</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">'@</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'tidb04-44'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> identified </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">by</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> '123123'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">grant</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> reload,replication client </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">on</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> *</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'jan'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">@</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'tidb04-44'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">grant</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> lock tables </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">on</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> jan_db.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'jan'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">@</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'tidb04-44'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">grant</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> select</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> on</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> jan_db.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'jan'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">@</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'tidb04-44'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">flush privileges;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"># </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">grant</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> select</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> on</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">tidb</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'jan'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">@</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'%'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span></code></pre>
</div></li>
<li>
<p>Dump MySQL Data</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># successfully dump mysql data using Dumpling</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[root@tidb04-44 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]# dumpling -h192.168.1.44 -ujan -p123123 -P 3306 -T </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"jan_db.jan_test"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> -o /</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[2021/01/05 09:12:23.633 -05:00] [INFO] [config.go:139] [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"detect server type"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">] [type</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">MySQL]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[2021/01/05 09:12:23.633 -05:00] [INFO] [config.go:157] [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"detect server version"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">] [version</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">5.6.50]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[2021/01/05 09:12:23.634 -05:00] [INFO] [sql.go:419] [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"session variable is not supported by db"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">] [variable</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">tidb_mem_quota_query] [value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">34359738368]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[2021/01/05 09:12:23.643 -05:00] [INFO] [main.go:195] [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"dump data successfully, dumpling will exit now"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># list file dumped</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[root@tidb04-44 dumpdir]# ll</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">total</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 16</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">-rwxr-xr-x.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> root</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> root</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 111</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Jan</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  5</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 09:12</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> jan_db.jan_test.0.sql</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">       #  ÂØºÂá∫ÁöÑÈÄªËæëÊï∞ÊçÆsqlÊñá‰ª∂</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">-rwxr-xr-x.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> root</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> root</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 129</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Jan</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  5</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 09:12</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> jan_db.jan_test-schema.sql</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">  #  ÂØºÂá∫ÁöÑË°®schemaÈÄªËæëËØ≠Âè•Êñá‰ª∂</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">-rwxr-xr-x.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> root</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> root</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  67</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Jan</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  5</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 09:12</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> jan_db-schema-create.sql</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    #  ÂØºÂá∫ÁöÑÊï∞ÊçÆÂ∫ìschemaÈÄªËæëËØ≠Âè•Êñá‰ª∂</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">-rwxr-xr-x.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> root</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> root</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  95</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Jan</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  5</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 09:12</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> metadata</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">                    #  ÂØºÂá∫ÁöÑÂÖÉÊï∞ÊçÆËÆ∞ÂΩïÊñá‰ª∂</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># load all using source command</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[root@tidb04-44 dumpdir]# mysql -uroot -p123123 </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">use</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> jan_db</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">rename</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> table</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> jan_test</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> jan_test_bak</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">source</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> jan_db.jan_test-schema.sql</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">source</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> jan_db.jan_test.0.sql</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">show</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tables</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+------------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Tables_in_jan_db</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+------------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> jan_test</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">         |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> jan_test_bak</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">     |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+------------------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> rows</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">select</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> jan_test</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+----------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> count(*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+----------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">        4</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+----------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> row</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">select</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> jan_test_bak</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+----------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> count(*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+----------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">        4</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+----------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> row</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span></code></pre>
</div></li>
</ol>
<h2 id="dump-tidb-data-as-sql-format" tabindex="-1">Dump TiDB Data as SQL format <a class="header-anchor" href="#dump-tidb-data-as-sql-format" aria-label="Permalink to &quot;Dump TiDB Data as SQL format&quot;"></a></h2>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># ÊâßË°ådumplingÂØºÂá∫ÂëΩ‰ª§</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tidb01-41 soft]$ dumpling </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> root</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  -P</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 4000</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  -h</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 192.168.1.41</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /home/tidb/dumpdir/sqlexp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  --sql</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'select * from `jan`.`sbtest1` where id &#x3C; 100'</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[2021/01/04 09:11:00.450 -05:00] [INFO] [config.go:139] [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"detect server type"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">] [type</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">TiDB]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[2021/01/04 09:11:00.451 -05:00] [INFO] [config.go:157] [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"detect server version"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">] [version</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">3.0.1]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[2021/01/04 09:11:00.451 -05:00] [WARN] [dump.go:95] [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"If the amount of data to dump is large, criteria: (data more than 60GB or dumped time more than 10 minutes)\nyou'd better adjust the tikv_gc_life_time to avoid export failure due to TiDB GC during the dump process.\nBefore dumping: run sql `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">update</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysql.tidb set VARIABLE_VALUE = '720h' where VARIABLE_NAME = 'tikv_gc_life_time';` in tidb.\nAfter dumping: run sql `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">update</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysql.tidb set VARIABLE_VALUE = '10m' where VARIABLE_NAME = 'tikv_gc_life_time';` in tidb.\n"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[2021/01/04 09:11:00.580 -05:00] [INFO] [main.go:195] [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"dump data successfully, dumpling will exit now"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># look at the dumped files</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tidb01-41 soft]$ cd ../dumpdir/sqlexp</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tidb01-41 dumpdir]$ pwd</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">/home/tidb/dumpdir</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tidb01-41 sqlexp]$ ll</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">total</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 24</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">-rwxr-xr-x</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   140</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Jan</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  4</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 09:26</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> metadata</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">-rwxr-xr-x</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 19368</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Jan</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  4</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 09:26</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> result.0.sql</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># cat metadata</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tidb01-41 sqlexp]$ cat metadata </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Started</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dump</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> at:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 2021-01-04</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 09:26:42</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SHOW</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> MASTER</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> STATUS:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  Log:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-binlog</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">        #  binlogÊó•ÂøóÂêçÁß∞</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  Pos:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 421991652309860365</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"> #  master binary log ÁöÑ‰ΩçÁΩÆ</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Finished</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dump</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> at:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 2021-01-04</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 09:26:42</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">   #  ÂØºÂá∫ÁöÑËµ∑ÂßãÊó∂Èó¥</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># cat a little number of rows</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tidb01-41 sqlexp]$ head -5 result.0.sql</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">/*!40101</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> SET</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> NAMES</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> binary</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">*</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">INSERT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> INTO</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ``</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">id</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">k</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">pad</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">VALUES</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">1,2494,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">'31451373586-15688153734-79729593694-96509299839-83724898275-86711833539-78981337422-35049690573-51724173961-87474696253'</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">'98996621624-36689827414-04092488557-09587706818-65008859162'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">2,2489,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">'21472970079-70972780322-70018558993-71769650003-09270326047-32417012031-10768856803-14235120402-93989080412-18690312264'</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">'04776826683-45880822084-77922711547-29057964468-76514263618'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">3,2495,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">'49376827441-24903985029-56844662308-79012577859-40518387141-60588419212-24399130405-42612257832-29494881732-71506024440'</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">'26843035807-96849339132-53943793991-69741192222-48634174017'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tidb01-41 sqlexp]$ vi result.0.sql </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tidb01-41 sqlexp]$ cat ./result.0.sql </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">wc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -l</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">101</span></span></code></pre>
</div><h2 id="dump-tidb-data-as-csv-format" tabindex="-1">Dump TiDB Data as CSV format <a class="header-anchor" href="#dump-tidb-data-as-csv-format" aria-label="Permalink to &quot;Dump TiDB Data as CSV format&quot;"></a></h2>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># ÊâßË°ådumplingÂØºÂá∫ÂëΩ‰ª§</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tidb01-41 soft]$ dumpling </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> root</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  -P</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 4000</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  -h</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 192.168.1.41</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /home/tidb/dumpdir</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  --filetype</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> csv</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  --sql</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'select * from `jan`.`sbtest1` where id &#x3C; 100'</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[2021/01/04 09:11:00.450 -05:00] [INFO] [config.go:139] [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"detect server type"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">] [type</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">TiDB]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[2021/01/04 09:11:00.451 -05:00] [INFO] [config.go:157] [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"detect server version"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">] [version</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">3.0.1]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[2021/01/04 09:11:00.451 -05:00] [WARN] [dump.go:95] [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"If the amount of data to dump is large, criteria: (data more than 60GB or dumped time more than 10 minutes)\nyou'd better adjust the tikv_gc_life_time to avoid export failure due to TiDB GC during the dump process.\nBefore dumping: run sql `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">update</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysql.tidb set VARIABLE_VALUE = '720h' where VARIABLE_NAME = 'tikv_gc_life_time';` in tidb.\nAfter dumping: run sql `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">update</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysql.tidb set VARIABLE_VALUE = '10m' where VARIABLE_NAME = 'tikv_gc_life_time';` in tidb.\n"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[2021/01/04 09:11:00.580 -05:00] [INFO] [main.go:195] [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"dump data successfully, dumpling will exit now"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># look at the dumped files</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tidb01-41 soft]$ cd ../dumpdir/</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tidb01-41 dumpdir]$ pwd</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">/home/tidb/dumpdir</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tidb01-41 dumpdir]$ ll</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">total</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 24</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">-rwxr-xr-x</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   140</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Jan</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  4</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 09:11</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> metadata</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">-rwxr-xr-x</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 19018</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Jan</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  4</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 09:11</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> result.0.csv</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># cat metadata</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tidb01-41 dumpdir]$ cat metadata </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Started</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dump</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> at:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 2021-01-04</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 09:11:00</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SHOW</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> MASTER</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> STATUS:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  Log:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-binlog</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">        #  binlogÊó•ÂøóÂêçÁß∞</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  Pos:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 421991405435486213</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"> #  master binary log ÁöÑ‰ΩçÁΩÆ</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Finished</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dump</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> at:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 2021-01-04</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 09:11:00</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">   # ÂØºÂá∫ÁöÑËµ∑ÂßãÊó∂Èó¥</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># cat a little number of rows</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tidb01-41 dumpdir]$ head -5 result.0.csv </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"id"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"k"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"c"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"pad"</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">1,2494,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"31451373586-15688153734-79729593694-96509299839-83724898275-86711833539-78981337422-35049690573-51724173961-87474696253"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"98996621624-36689827414-04092488557-09587706818-65008859162"</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">2,2489,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"21472970079-70972780322-70018558993-71769650003-09270326047-32417012031-10768856803-14235120402-93989080412-18690312264"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"04776826683-45880822084-77922711547-29057964468-76514263618"</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">3,2495,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"49376827441-24903985029-56844662308-79012577859-40518387141-60588419212-24399130405-42612257832-29494881732-71506024440"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"26843035807-96849339132-53943793991-69741192222-48634174017"</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">4,2594,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"85762858421-36258200885-10758669419-44272723583-12529521893-95630803635-53907705724-07005352902-43001596772-53048338959"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"37979424284-37912826784-31868864947-42903702727-96097885121"</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># In earlier version</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># If the exported data is very large, for example, the data volume exceeds 60GB or the exported data usually takes more than 10 minutes;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Recommended to adjust tikv_gc_life_time to avoid failure due to TiDB GC;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">update</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysql.tidb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> VARIABLE_VALUE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> '720h'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> where</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> VARIABLE_NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'tikv_gc_life_time'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;           </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">update</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysql.tidb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> VARIABLE_VALUE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> '10m'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> where</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> VARIABLE_NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'tikv_gc_life_time'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;            </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">MySQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [(none)]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> * from mysql.tidb where variable_name like </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'tikv_gc_life_time'</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\G</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">           </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">***************************</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> 1. row </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">***************************</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> VARIABLE_NAME:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tikv_gc_life_time</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">VARIABLE_VALUE:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 720h</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">       COMMENT:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> All</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> versions</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> within</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> life</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> time</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> will</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> not</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> be</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> collected</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> by</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> GC,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> at</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> least</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 10m,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Go</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> format.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> row</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (0.01 </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span></code></pre>
</div><h2 id="references" tabindex="-1">References <a class="header-anchor" href="#references" aria-label="Permalink to &quot;References&quot;"></a></h2>
<ol>
<li><a href="https://docs.pingcap.com/zh/tidb/stable/dumpling-overview" target="_blank" rel="noreferrer">TiDBÂÆòÁΩë-Dumpling ‰ΩøÁî®ÊñáÊ°£</a></li>
<li><a href="https://docs.pingcap.com/zh/tidb/stable/download-ecosystem-tools#dumpling" target="_blank" rel="noreferrer">TiDBÂÆòÁΩë-Â∑•ÂÖ∑‰∏ãËΩΩ</a></li>
<li><a href="https://www.bilibili.com/video/BV1kK4y1Z7tE?from=search&amp;seid=8438422389068483544" target="_blank" rel="noreferrer">BÁ´ô-yi888longÂØπdumplingÁöÑËÆ≤Ëß£Ôºöhttps://www.bilibili.com/video/BV1kK4y1Z7tE?from=search&amp;seid=8438422389068483544</a></li>
<li><a href="https://www.bilibili.com/video/BV1D5411L7z5" target="_blank" rel="noreferrer">BÁ´ô-„ÄêHigh Performance TiDB„ÄëLesson 12 ÁîüÊÄÅÂ∑•ÂÖ∑‰ºòÂåñ</a></li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Dumpling Aachitecture]]></title>
            <link>https://askaric.com/en/work/tidb/TiDB-EcosystematicTools/5-3Dumpling/02Dumpling Architecture.html</link>
            <guid>https://askaric.com/en/work/tidb/TiDB-EcosystematicTools/5-3Dumpling/02Dumpling Architecture.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[# Dumpling Aachitecture

## Basic info about it

1. REPO : Oringally, the project existed as in single project, but now it'as been merged into [TiDB Repo](https://github.com/pingcap/tidb/tree/master/dumpling).

2. Investigate : I've gotta to say Dumpling is such simple, but in most cases, something wrong with TiDB Cluster usually happens. Although, all of tools have this kind of issues, in my opnion, Dumpling is much more.

3. How to work : In short, Dumpling connects TiDB Cluster parallelly, uses SQLs to get results concurrently and finally writes results into linux files.

## How does it init?

1. [Startup steps](https://github.com/pingcap/tidb/blob/eb35c773b512e4e00c42caf7f04ea7397d00c127/dumpling/export/dump.go#L124-L137) is a serious of things below:

    ```go
    err = runSteps(d,
    initLogger,
    createExternalStore,
    startHTTPService,
    openSQLDB,
    detectServerInfo,
    resolveAutoConsistency,

    validateResolveAutoConsistency,
    tidbSetPDClientForGC,
    tidbGetSnapshot,
    tidbStartGCSavepointUpdateService,

    setSessionParam)
    ```

2. I'll just focus on main steps and components, which's (createExternalStore, startHTTPServer, openSQLDB, resolveAutoConsistency, validateResolveAutoConsistency, tidbSetPDClientForGC, tidbStartGCSavepointUpdateService) and the others are just coordinater parts. For `createExternalStore`, due to dumpling supplied already Local, Hdfs, S3, Azure. So they have different config items totally and main idea is to get enough info to read/write. **I just focus on `Local`, which is the basic implmented logic behind the other storage.** The [LocalStorage](https://github.com/pingcap/tidb/blob/eb35c773b512e4e00c42caf7f04ea7397d00c127/br/pkg/storage/local.go#L161) is just an struct encapsulated path of export to.

3. For [`startHTTPServer`](https://github.com/pingcap/tidb/blob/eb35c773b512e4e00c42caf7f04ea7397d00c127/dumpling/export/http_handler.go#L21), in one single goroutine, it's used to construct related things about metrics and go debug inside, which's very useful when something worng with the Dumpling binary for investigating. For [`openSQLDB`], just inits a connection to the database aimed for dumping data.

4. For [validateResolveAutoConsistency](https://github.com/pingcap/tidb/blob/eb35c773b512e4e00c42caf7f04ea7397d00c127/dumpling/export/dump.go#L1429), check if there's an scenario that can't specify --snapshot when --consistency isn't snapshot.

5. For [tidbSetPDClientForGC](https://github.com/pingcap/tidb/blob/eb35c773b512e4e00c42caf7f04ea7397d00c127/dumpling/export/dump.go#L1438), if the downstream was TiDB, it'd havet to set GC, however in this step, just inits and prepares engough info to have pd-client communicate with PD inside Dumpling.

6. For [tidbGetSnapshot](https://github.com/pingcap/tidb/blob/eb35c773b512e4e00c42caf7f04ea7397d00c127/dumpling/export/dump.go#L1466), just uses `show master status` to get the Position, like below, that's actually the same as `select tidb_current_tso()` just in tidb;

    ```sql
    mysql> begin;
    Query OK, 0 rows affected (0.00 sec)

    mysql> Show Master Status;
    +]]></description>
            <content:encoded><![CDATA[<h1 id="dumpling-aachitecture" tabindex="-1">Dumpling Aachitecture <a class="header-anchor" href="#dumpling-aachitecture" aria-label="Permalink to &quot;Dumpling Aachitecture&quot;"></a></h1>
<h2 id="basic-info-about-it" tabindex="-1">Basic info about it <a class="header-anchor" href="#basic-info-about-it" aria-label="Permalink to &quot;Basic info about it&quot;"></a></h2>
<ol>
<li>
<p>REPO : Oringally, the project existed as in single project, but now it'as been merged into <a href="https://github.com/pingcap/tidb/tree/master/dumpling" target="_blank" rel="noreferrer">TiDB Repo</a>.</p>
</li>
<li>
<p>Investigate : I've gotta to say Dumpling is such simple, but in most cases, something wrong with TiDB Cluster usually happens. Although, all of tools have this kind of issues, in my opnion, Dumpling is much more.</p>
</li>
<li>
<p>How to work : In short, Dumpling connects TiDB Cluster parallelly, uses SQLs to get results concurrently and finally writes results into linux files.</p>
</li>
</ol>
<h2 id="how-does-it-init" tabindex="-1">How does it init? <a class="header-anchor" href="#how-does-it-init" aria-label="Permalink to &quot;How does it init?&quot;"></a></h2>
<ol>
<li>
<p><a href="https://github.com/pingcap/tidb/blob/eb35c773b512e4e00c42caf7f04ea7397d00c127/dumpling/export/dump.go#L124-L137" target="_blank" rel="noreferrer">Startup steps</a> is a serious of things below:</p>
<div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> runSteps</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(d,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">initLogger,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">createExternalStore,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">startHTTPService,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">openSQLDB,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">detectServerInfo,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">resolveAutoConsistency,</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">validateResolveAutoConsistency,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">tidbSetPDClientForGC,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">tidbGetSnapshot,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">tidbStartGCSavepointUpdateService,</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">setSessionParam)</span></span></code></pre>
</div></li>
<li>
<p>I'll just focus on main steps and components, which's (createExternalStore, startHTTPServer, openSQLDB, resolveAutoConsistency, validateResolveAutoConsistency, tidbSetPDClientForGC, tidbStartGCSavepointUpdateService) and the others are just coordinater parts. For <code>createExternalStore</code>, due to dumpling supplied already Local, Hdfs, S3, Azure. So they have different config items totally and main idea is to get enough info to read/write. <strong>I just focus on <code>Local</code>, which is the basic implmented logic behind the other storage.</strong> The <a href="https://github.com/pingcap/tidb/blob/eb35c773b512e4e00c42caf7f04ea7397d00c127/br/pkg/storage/local.go#L161" target="_blank" rel="noreferrer">LocalStorage</a> is just an struct encapsulated path of export to.</p>
</li>
<li>
<p>For <a href="https://github.com/pingcap/tidb/blob/eb35c773b512e4e00c42caf7f04ea7397d00c127/dumpling/export/http_handler.go#L21" target="_blank" rel="noreferrer"><code>startHTTPServer</code></a>, in one single goroutine, it's used to construct related things about metrics and go debug inside, which's very useful when something worng with the Dumpling binary for investigating. For [<code>openSQLDB</code>], just inits a connection to the database aimed for dumping data.</p>
</li>
<li>
<p>For <a href="https://github.com/pingcap/tidb/blob/eb35c773b512e4e00c42caf7f04ea7397d00c127/dumpling/export/dump.go#L1429" target="_blank" rel="noreferrer">validateResolveAutoConsistency</a>, check if there's an scenario that can't specify --snapshot when --consistency isn't snapshot.</p>
</li>
<li>
<p>For <a href="https://github.com/pingcap/tidb/blob/eb35c773b512e4e00c42caf7f04ea7397d00c127/dumpling/export/dump.go#L1438" target="_blank" rel="noreferrer">tidbSetPDClientForGC</a>, if the downstream was TiDB, it'd havet to set GC, however in this step, just inits and prepares engough info to have pd-client communicate with PD inside Dumpling.</p>
</li>
<li>
<p>For <a href="https://github.com/pingcap/tidb/blob/eb35c773b512e4e00c42caf7f04ea7397d00c127/dumpling/export/dump.go#L1466" target="_blank" rel="noreferrer">tidbGetSnapshot</a>, just uses <code>show master status</code> to get the Position, like below, that's actually the same as <code>select tidb_current_tso()</code> just in tidb;</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">mysql</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> begin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">Query OK, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> rows</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> affected (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> sec)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">mysql</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Show </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">Master</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> Status</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">-------------+--------------------+--------------+------------------+-------------------+</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">File</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        | Position           | Binlog_Do_DB | Binlog_Ignore_DB | Executed_Gtid_Set |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">-------------+--------------------+--------------+------------------+-------------------+</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| tidb</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">binlog | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">441037036439732234</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |              |                  |                   |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">-------------+--------------------+--------------+------------------+-------------------+</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> row</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> in</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">01</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> sec)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">mysql</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> tidb_current_tso();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">--------------------+</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| tidb_current_tso() |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">--------------------+</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">441037036439732234</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">--------------------+</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> row</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> in</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">01</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> sec)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">mysql</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> commit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">Query OK, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> rows</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> affected (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">01</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> sec)</span></span></code></pre>
</div></li>
<li>
<p>For <a href="https://github.com/pingcap/tidb/blob/eb35c773b512e4e00c42caf7f04ea7397d00c127/dumpling/export/dump.go#L1497" target="_blank" rel="noreferrer">tidbStartGCSavepointUpdateService</a>, It uses the snapshot got from <code>tidbGetSnapshot</code> to set <a href="https://github.com/pingcap/dumpling/issues/95" target="_blank" rel="noreferrer">TiKV GC safe point</a> with a ttl. So, in this way, higher version Dumpling could be able to prevent TiKV GC the data which's being needed.</p>
</li>
<li>
<p>For <a href="https://github.com/pingcap/tidb/blob/eb35c773b512e4e00c42caf7f04ea7397d00c127/dumpling/export/dump.go#L1559" target="_blank" rel="noreferrer">setSessionParam</a>, because of supporting in <code>dumpling --params</code> extra session variables used while dumping, here's the main logic to process. I've gotta to say that's very important to interact with TiDB as the reason of, I mentioned on the top of page, <strong><code>something wrong with TiDB Cluster usually happens</code></strong>.</p>
</li>
</ol>
<h2 id="how-does-it-work" tabindex="-1">How does it work? <a class="header-anchor" href="#how-does-it-work" aria-label="Permalink to &quot;How does it work?&quot;"></a></h2>
<ol>
<li>
<p>After init steps, <a href="https://github.com/pingcap/tidb/blob/eb35c773b512e4e00c42caf7f04ea7397d00c127/dumpling/export/dump.go#L143" target="_blank" rel="noreferrer">Dump()</a> is the main logic to dump table from database.</p>
</li>
<li>
<p>Inside Dump(), there's a logic choosing dump-by-sql or dump-database by wether you configured <code>--sql</code> parameter.</p>
</li>
<li>
<p>The <a href="https://github.com/pingcap/tidb/blob/eb35c773b512e4e00c42caf7f04ea7397d00c127/dumpling/export/dump.go#L267" target="_blank" rel="noreferrer">func startWrite</a> will create groutines in the number of <code>Threads</code>. The created groutines are used to deal with tasks parallelly. And from the logic of the <a href="https://github.com/pingcap/tidb/blob/eb35c773b512e4e00c42caf7f04ea7397d00c127/dumpling/export/writer.go#L102" target="_blank" rel="noreferrer">func Write.handleTask</a>, there's a serious of functions like <code>WriteDatabaseMeta</code>, <code>WriteTableMeta</code>, <code>WriteTableData</code>, etc. Which mainly is execute the SQL query and write result into different externalStorage files.</p>
</li>
</ol>
<h2 id="dump-sql" tabindex="-1">Dump SQL <a class="header-anchor" href="#dump-sql" aria-label="Permalink to &quot;Dump SQL&quot;"></a></h2>
<ol>
<li>
<p>There's afunction named <a href="https://github.com/pingcap/tidb/blob/eb35c773b512e4e00c42caf7f04ea7397d00c127/dumpling/export/dump.go#L1261" target="_blank" rel="noreferrer">detectEstimateRows</a> to get the estimateRows using <code>fmt.Sprintf(&quot;EXPLAIN %s&quot;, &quot;select * from table_a a left join table_b b on a.id = b.id where ...&quot;)</code>, but, it's just used to record as the value of dumpling_dump_estimate_total_rows metric. Until now, there hasn't had any finished opensource service about Dumpling. I guess in the future there'll be a <a href="https://github.com/pingcap/tidb/issues/34948" target="_blank" rel="noreferrer">Dataflow Engine</a> runing Dumpling as a backend service.</p>
</li>
<li>
<p>Also as I mentioned above, the Writer component will execute query and save results as files. A noticable thing is that , <a href="https://github.com/pingcap/tidb/blob/eb35c773b512e4e00c42caf7f04ea7397d00c127/dumpling/export/dump.go#L1260" target="_blank" rel="noreferrer">from the logic</a> using Dumpling by <code>--sql</code> is a single there way to execute query. Because the totalChunks is hardcoded as just <code>1</code> here.</p>
</li>
</ol>
<h2 id="dump-databases" tabindex="-1">Dump Databases <a class="header-anchor" href="#dump-databases" aria-label="Permalink to &quot;Dump Databases&quot;"></a></h2>
<ol>
<li>
<p>First of all, there's <a href="https://github.com/pingcap/tidb/blob/eb35c773b512e4e00c42caf7f04ea7397d00c127/dumpling/export/dump.go#L420-L484" target="_blank" rel="noreferrer">many LOOPs</a> to prepare eache table schema and table data as task and sent them to Write to be waiting for handle.</p>
</li>
<li>
<p>Inside the <a href="https://github.com/pingcap/tidb/blob/eb35c773b512e4e00c42caf7f04ea7397d00c127/dumpling/export/dump.go#L624-L627" target="_blank" rel="noreferrer">func dumpTableData</a> has a main logics to adjust wether to use concurrency. If you have <code>--rows</code> configured, concurrency would be used. If not the whole table will be exported use just one query to get result, like <code>select column_a, column_b, column_c ... from database_a.table_a order by XXX</code>. However, the concurrent way is firstly that <a href="https://github.com/pingcap/tidb/blob/eb35c773b512e4e00c42caf7f04ea7397d00c127/dumpling/export/dump.go#L731" target="_blank" rel="noreferrer">the func concurrentDumpTable</a> tries to split table into several chunks to dump</p>
</li>
<li>
<p>The single table dump is executed in concurrent by steps below:<br>
a. First, <a href="https://github.com/pingcap/tidb/blob/eb35c773b512e4e00c42caf7f04ea7397d00c127/dumpling/export/sql.go#L439" target="_blank" rel="noreferrer">func orderByClause</a> decides to use <code>_tidb_rowid</code> or <code>Primary key</code> to sort.<br>
b. Second, [func pickupPossibleField] decides to use <code>_tidb_rowid</code> or <code>Numeric PK</code> or <code>UK Index</code> or <code>no proper index</code> in the priority of order I wrote.
c. Third, <a href="https://github.com/pingcap/tidb/blob/eb35c773b512e4e00c42caf7f04ea7397d00c127/dumpling/export/sql.go#L1175" target="_blank" rel="noreferrer">func estimateCount</a> to get estimate RowNumber using <code>EXPLAIN SELECT * FROM DATABASE_XXX.TABLE_XXX</code>.<br>
d. If the estimateCount &lt; <code>--rows</code>, it'll directly dump table using just one single sql.<br>
e. If pickupPossibleField can output sutiable fields(single or plural), it'll get max and min value using <code>SELECT MIN(field_xxx),MAX(field_xxx) FROM database_a.table_a</code>. if there's any error or can not get max or min, it also directly dumps table using one sql.<br>
f. Then, uses <code>estimatedChunks := count / conf.Rows</code> to split into some chunks and parallelly execute them as tasks.</p>
</li>
</ol>
<h2 id="the-end" tabindex="-1">The End <a class="header-anchor" href="#the-end" aria-label="Permalink to &quot;The End&quot;"></a></h2>
<p>After took a look at source code quickly, we know something below:</p>
<ol>
<li><code>--row</code> is the switch to control if table table could be able to be split into different chunks and parallely executed.</li>
<li><code>--thread</code> is the switch to control concurrency between differen tables.</li>
<li>And there's some scenarios we couldn't split chunks, though, we've configured <code>--rows</code>.</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[DM Architecture Overview]]></title>
            <link>https://askaric.com/en/work/tidb/TiDB-EcosystematicTools/5-4DM/01TiDB-DM Overview.html</link>
            <guid>https://askaric.com/en/work/tidb/TiDB-EcosystematicTools/5-4DM/01TiDB-DM Overview.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[What's DM
1. I think you are already familiar with DM if find out my doc first time. Without that, I]]></description>
            <content:encoded><![CDATA[<h1 id="dm-architecture-overview" tabindex="-1">DM Architecture Overview <a class="header-anchor" href="#dm-architecture-overview" aria-label="Permalink to &quot;DM Architecture Overview&quot;"></a></h1>
<h2 id="what-s-dm" tabindex="-1">What's DM <a class="header-anchor" href="#what-s-dm" aria-label="Permalink to &quot;What's DM&quot;"></a></h2>
<ol>
<li>
<p>I think you are already familiar with DM if find out my doc first time. Without that, I think you can take a look at the <a href="https://docs.pingcap.com/zh/tidb/stable/dm-arch" target="_blank" rel="noreferrer">DM offical website</a>.</p>
</li>
<li>
<p>As we can see the architecture below, in short, it used to countinuously migrate date from MySQL single instance or sharding MySQL cluster into TiDB Cluster. And DM-worker has a  1  to 1 relationship to the number of MySQL instance, what DM actually does is reading the MySQL binlog and transfering all of them into DML(types of insert, update, delete) and DDL queries at the journey of replication in TiDB Cluster.</p>
<figure><img src="https://download.pingcap.com/images/docs-cn/dm/dm-architecture-2.0.png" alt="architecture" tabindex="0"><figcaption>architecture</figcaption></figure>
</li>
</ol>
<h2 id="the-purpose" tabindex="-1">The purpose <a class="header-anchor" href="#the-purpose" aria-label="Permalink to &quot;The purpose&quot;"></a></h2>
<ol>
<li>
<p>Based on pages of <code>Master</code>, <code>Worker</code>, <code>Syncer</code> and <code>SourceWorker</code>, I wanna give a brief introduction for DM. So, after reading all of them, you could know how DM works and what each critical component means and are responsible for.</p>
</li>
<li>
<p>For the page of <code>Metrics</code>, It seems to be more useful when a critical bug happens or something goes wrong in a production environment. Which includes every introduction of metrics, how they are calculated and when they are triggered to do the calculation.</p>
</li>
</ol>
<h2 id="what-i-ve-done" tabindex="-1">What I've done <a class="header-anchor" href="#what-i-ve-done" aria-label="Permalink to &quot;What I've done&quot;"></a></h2>
<ol>
<li>
<p>For the DM tool, as an supporter role, fistly I'm highly gree with that you should've learned the aritechture of a tool when you're trying to fix or investigate some problem. All because product env is such important to your customer's application. And a main idea or knowledge about how the tool runs is something seriously important with troubleshooting. In that way, you could be able to fix it ASAP which's bigger and faster than normal.</p>
</li>
<li>
<p>And, also, I tried spilting some main steps about how DM's running into just one picture, which's useful when you're learning daily life, or directly search the function name in source code dir when you're troubleshooting. In relevent pages, I'm gonna explain more details on each component I've carved in the picture which are <a href="./03TiDB-DM Master.html"><code>DM master</code></a>, <a href="./04TiDB-DM Worker.html"><code>DM Worker</code></a> and <a href="./05TiDB-DM syncer.html"><code>DM Syncer</code></a>.</p>
<figure><img src="./../../../../../images/tidb/05TiDB-EcosystematicTools/5-4DM/01-ALL_DM_Components.jpeg" alt="ALL_DM_Components" tabindex="0"><figcaption>ALL_DM_Components</figcaption></figure>
</li>
<li>
<p>At the end of this series of DM pages, I wroted meaning of metrics and the way they are calculated of every metrics. Which would be useful for your investigating.</p>
</li>
</ol>
<h2 id="keys-inside-etcd" tabindex="-1">Keys inside Etcd <a class="header-anchor" href="#keys-inside-etcd" aria-label="Permalink to &quot;Keys inside Etcd&quot;"></a></h2>
<p><a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/common/common.go#L26" target="_blank" rel="noreferrer">The Code location</a>, I' think it'd be useful when you wanna get info deeply which you couldn't get easily using OpenAPI or dm-ctl. Like <code>ClusterIDKey = &quot;/dm-cluster/id&quot;</code> and <code>StageSubTaskKeyAdapter KeyAdapter = keyHexEncoderDecoder(&quot;/dm-master/stage/subtask/&quot;)</code> ...</p>
]]></content:encoded>
            <enclosure url="https://download.pingcap.com/images/docs-cn/dm/dm-architecture-2.0.png" length="0" type="image/png"/>
        </item>
        <item>
            <title><![CDATA[TiDB-DM Quick Start]]></title>
            <link>https://askaric.com/en/work/tidb/TiDB-EcosystematicTools/5-4DM/02TiDB-DM QuickStart.html</link>
            <guid>https://askaric.com/en/work/tidb/TiDB-EcosystematicTools/5-4DM/02TiDB-DM QuickStart.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[# TiDB-DM Quick Start

## Something you have to know

This's a quickstart step by step on permise, you can also do it on docker if you're more familiar with the one. And I've prepared another content for that, [PTAL this one.](./../../../tidb/08TiDB-Cloud-K8S/8-1TiDB-Deployment/02TiDB-Operator%20deploys%20DM.md)

## Install MySQL5.7

```shell
# Get rpm package
wget https://dev.mysql.com/get/mysql57-community-release-el7-11.noarch.rpm

# Insatll mysql package
 yum localinstall mysql57-community-release-el7-11.noarch.rpm

# Check wether it's success
yum repolist enabled | grep "mysql.*-community.*"
yum install mysql-server
systemctl start mysqld
systemctl status mysqld
systemctl enable mysqld

# Get init password from mysqld.log
grep 'temporary password' /var/log/mysqld.log
mysql -uroot -p

# Change into a new password
ALTER USER 'root'@'localhost' IDENTIFIED BY 'MyNewPass4!'

# Now, it's time to create a more simple password
SHOW VARIABLES LIKE 'validate_password%';
set global validate_password_policy=LOW; 
set global validate_password_length=6; 
ALTER USER 'root'@'localhost' IDENTIFIED BY '123123';
grant all privileges on *.* to root@'%' identified by '123123' with grant option;

# In this way, we could be able to access MySQL Server by port 3306 without forbidden from firewall of Linux
firewall-cmd --state
firewall-cmd --zone=public --add-port=3306/tcp --permanent
firewall-cmd --reload
```

## Deploy DM

```shell
[tidb@tiup-tidb41 dumpling_dir]$ tiup install dm

[tidb@tiup-tidb41 dumpling_dir]$ tiup list --installed
Available components:
Name      Owner    Description
]]></description>
            <content:encoded><![CDATA[<h1 id="tidb-dm-quick-start" tabindex="-1">TiDB-DM Quick Start <a class="header-anchor" href="#tidb-dm-quick-start" aria-label="Permalink to &quot;TiDB-DM Quick Start&quot;"></a></h1>
<h2 id="something-you-have-to-know" tabindex="-1">Something you have to know <a class="header-anchor" href="#something-you-have-to-know" aria-label="Permalink to &quot;Something you have to know&quot;"></a></h2>
<p>This's a quickstart step by step on permise, you can also do it on docker if you're more familiar with the one. And I've prepared another content for that, <a href="./../../../tidb/08TiDB-Cloud-K8S/8-1TiDB-Deployment/02TiDB-Operator deploys DM.html">PTAL this one.</a></p>
<h2 id="install-mysql5-7" tabindex="-1">Install MySQL5.7 <a class="header-anchor" href="#install-mysql5-7" aria-label="Permalink to &quot;Install MySQL5.7&quot;"></a></h2>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Get rpm package</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">wget</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> https://dev.mysql.com/get/mysql57-community-release-el7-11.noarch.rpm</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Insatll mysql package</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> localinstall</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysql57-community-release-el7-11.noarch.rpm</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Check wether it's success</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> repolist</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> enabled</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "mysql.*-community.*"</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysql-server</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysqld</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> status</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysqld</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> enable</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysqld</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Get init password from mysqld.log</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'temporary password'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /var/log/mysqld.log</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">mysql</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -uroot</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -p</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Change into a new password</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ALTER</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> USER</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'root'@'localhost'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> IDENTIFIED</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> BY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'MyNewPass4!'</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Now, it's time to create a more simple password</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SHOW</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> VARIABLES</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> LIKE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'validate_password%'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> global</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> validate_password_policy=LOW</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">; </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> global</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> validate_password_length=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">; </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ALTER</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> USER</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'root'@'localhost'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> IDENTIFIED</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> BY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> '123123'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">grant</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> all</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> privileges</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> on</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> *</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">*</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> root@'%'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> identified</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> by</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> '123123'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> with</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> grant</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> option</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># In this way, we could be able to access MySQL Server by port 3306 without forbidden from firewall of Linux</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">firewall-cmd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --state</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">firewall-cmd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --zone=public</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --add-port=3306/tcp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --permanent</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">firewall-cmd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --reload</span></span></code></pre>
</div><h2 id="deploy-dm" tabindex="-1">Deploy DM <a class="header-anchor" href="#deploy-dm" aria-label="Permalink to &quot;Deploy DM&quot;"></a></h2>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 dumpling_dir]$ tiup install dm</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 dumpling_dir]$ tiup list --installed</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Available</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> components:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      Owner</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    Description</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">      -----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    -----------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">dm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">        pingcap</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Data</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Migration</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Platform</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> manager</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">dm-master</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  pingcap</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  dm-master</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> component</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Data</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Migration</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Platform</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">dm-worker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  pingcap</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  dm-worker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> component</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Data</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Migration</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Platform</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ mkdir dm</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ cd dm/</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 dm]$ ll</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">total</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 dm]$ vi topology.yaml </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 dm]$ tiup dm deploy dm-test v2.0.1 /home/tidb/dm/topology.yaml --user root -p</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> component</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">dm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /home/tidb/.tiup/components/dm/v1.3.1/tiup-dm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> deploy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm-test</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> v2.0.1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /home/tidb/dm/topology.yaml</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --user</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> root</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -p</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Please</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> confirm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> your</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> topology:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> type:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    dm</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> name:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    dm-test</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> version:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> v2.0.1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Type</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       Host</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">            Ports</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      OS/Arch</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       Directories</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">       ----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">            -----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">      -------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">       -----------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">dm-master</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  192.168.169.41</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  8261/8291</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  /data/tidb-deploy/dm/dm-master-8261,/data/tidb-data/dm/dm-master-8261</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">dm-master</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  192.168.169.42</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  8261/8291</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  /data/tidb-deploy/dm/dm-master-8261,/data/tidb-data/dm/dm-master-8261</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">dm-master</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  192.168.169.43</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  8261/8291</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  /data/tidb-deploy/dm/dm-master-8261,/data/tidb-data/dm/dm-master-8261</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">dm-worker</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  192.168.169.41</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  8262</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  /data/tidb-deploy/dm/dm-worker-8262,/data/tidb-data/dm/dm-worker-8262</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">dm-worker</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  192.168.169.42</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  8262</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  /data/tidb-deploy/dm/dm-worker-8262,/data/tidb-data/dm/dm-worker-8262</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">dm-worker</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  192.168.169.43</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  8262</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  /data/tidb-deploy/dm/dm-worker-8262,/data/tidb-data/dm/dm-worker-8262</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Attention:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    1.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> If</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> topology</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> not</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> what</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> you</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> expected,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> check</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> your</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> yaml</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> file.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    2.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Please</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> confirm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> there</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> no</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> port/directory</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> conflicts</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> same</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> host.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Do</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> you</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> want</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> continue?</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [y/N]:  y</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Input</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> SSH</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> password:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Generate</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> SSH</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> keys</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ...</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Done</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Download</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> TiDB</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> components</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Download</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm-master:v2.0.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (linux/amd64) ... Done</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Download</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm-worker:v2.0.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (linux/amd64) ... Done</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Initialize</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> target</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> host</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> environments</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Prepare</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 192.168.169.41:22</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ...</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Done</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Prepare</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 192.168.169.42:22</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ...</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Done</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Prepare</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 192.168.169.43:22</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ...</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Done</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Copy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> files</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Copy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm-master</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 192.168.169.41</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ...</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Done</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Copy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm-master</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 192.168.169.42</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ...</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Done</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Copy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm-master</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 192.168.169.43</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ...</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Done</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Copy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm-worker</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 192.168.169.41</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ...</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Done</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Copy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm-worker</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 192.168.169.42</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ...</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Done</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Copy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm-worker</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 192.168.169.43</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ...</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Done</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">dm-test</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> deployed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> successfully,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> you</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> can</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> it</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> with</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> command:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tiup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm start dm-test`</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 dm]</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tiup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> list</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> component</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">dm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /home/tidb/.tiup/components/dm/v1.3.1/tiup-dm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> list</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     User</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Version</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Path</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                          PrivateKey</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">     ----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  -------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  ----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">                                          ----------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">dm-test</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  tidb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  v2.0.1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   /home/tidb/.tiup/storage/dm/clusters/dm-test</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  /home/tidb/.tiup/storage/dm/clusters/dm-test/ssh/id_rsa</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 dm]$ tiup dm display dm-test</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> component</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">dm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /home/tidb/.tiup/components/dm/v1.3.1/tiup-dm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> display</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm-test</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> type:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       dm</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> name:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       dm-test</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> version:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    v2.0.1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SSH</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> type:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">           builtin</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ID</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                   Role</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       Host</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">            Ports</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      OS/Arch</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       Status</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Data</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Dir</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                           Deploy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Dir</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">--</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">                   ----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">       ----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">            -----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">      -------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">       ------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  --------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">                           ----------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">192.168.169.41:8261</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  dm-master</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  192.168.169.41</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  8261/8291</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Down</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    /data/tidb-data/dm/dm-master-8261</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  /data/tidb-deploy/dm/dm-master-8261</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">192.168.169.42:8261</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  dm-master</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  192.168.169.42</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  8261/8291</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Down</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    /data/tidb-data/dm/dm-master-8261</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  /data/tidb-deploy/dm/dm-master-8261</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">192.168.169.43:8261</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  dm-master</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  192.168.169.43</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  8261/8291</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Down</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    /data/tidb-data/dm/dm-master-8261</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  /data/tidb-deploy/dm/dm-master-8261</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">192.168.169.41:8262</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  dm-worker</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  192.168.169.41</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  8262</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  N/A</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     /data/tidb-data/dm/dm-worker-8262</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  /data/tidb-deploy/dm/dm-worker-8262</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">192.168.169.42:8262</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  dm-worker</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  192.168.169.42</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  8262</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  N/A</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     /data/tidb-data/dm/dm-worker-8262</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  /data/tidb-deploy/dm/dm-worker-8262</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">192.168.169.43:8262</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  dm-worker</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  192.168.169.43</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  8262</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  N/A</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     /data/tidb-data/dm/dm-worker-8262</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  /data/tidb-deploy/dm/dm-worker-8262</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Total</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> nodes:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 6</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 dm]$ tiup dm start dm-test</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> component</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">dm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /home/tidb/.tiup/components/dm/v1.3.1/tiup-dm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm-test</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm-test...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [ </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">Serial</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ]</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> SSHKeySet:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> privateKey=/home/tidb/.tiup/storage/dm/clusters/dm-test/ssh/id_rsa,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> publicKey=/home/tidb/.tiup/storage/dm/clusters/dm-test/ssh/id_rsa.pub</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [Parallel] - UserSSH: user</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">tidb,</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> host</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">192.168.169.43</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [Parallel] - UserSSH: user</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">tidb,</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> host</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">192.168.169.41</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [Parallel] - UserSSH: user</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">tidb,</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> host</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">192.168.169.42</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [Parallel] - UserSSH: user</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">tidb,</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> host</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">192.168.169.41</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [Parallel] - UserSSH: user</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">tidb,</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> host</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">192.168.169.43</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [Parallel] - UserSSH: user</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">tidb,</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> host</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">192.168.169.42</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [ </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">Serial</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ]</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> StartCluster</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> component</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm-master</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> instance</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm-master</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 192.168.169.41:8261</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> instance</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm-master</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 192.168.169.43:8261</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> instance</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm-master</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 192.168.169.42:8261</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm-master</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 192.168.169.42:8261</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> success</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm-master</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 192.168.169.43:8261</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> success</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm-master</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 192.168.169.41:8261</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> success</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> component</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm-worker</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> instance</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm-worker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 192.168.169.43:8262</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> instance</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm-worker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 192.168.169.41:8262</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> instance</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm-worker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 192.168.169.42:8262</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm-worker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 192.168.169.42:8262</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> success</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm-worker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 192.168.169.41:8262</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> success</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm-worker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 192.168.169.43:8262</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> success</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Started</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">dm-test</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> successfully</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 dm]$ tiup dm display dm-test</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> component</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">dm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /home/tidb/.tiup/components/dm/v1.3.1/tiup-dm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> display</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm-test</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> type:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       dm</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> name:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       dm-test</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> version:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    v2.0.1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SSH</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> type:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">           builtin</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ID</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                   Role</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       Host</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">            Ports</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      OS/Arch</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       Status</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     Data</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Dir</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                           Deploy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Dir</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">--</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">                   ----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">       ----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">            -----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">      -------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">       ------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">     --------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">                           ----------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">192.168.169.41:8261</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  dm-master</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  192.168.169.41</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  8261/8291</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Healthy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    /data/tidb-data/dm/dm-master-8261</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  /data/tidb-deploy/dm/dm-master-8261</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">192.168.169.42:8261</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  dm-master</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  192.168.169.42</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  8261/8291</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Healthy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">L</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  /data/tidb-data/dm/dm-master-8261</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  /data/tidb-deploy/dm/dm-master-8261</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">192.168.169.43:8261</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  dm-master</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  192.168.169.43</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  8261/8291</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Healthy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    /data/tidb-data/dm/dm-master-8261</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  /data/tidb-deploy/dm/dm-master-8261</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">192.168.169.41:8262</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  dm-worker</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  192.168.169.41</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  8262</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Free</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       /data/tidb-data/dm/dm-worker-8262</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  /data/tidb-deploy/dm/dm-worker-8262</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">192.168.169.42:8262</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  dm-worker</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  192.168.169.42</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  8262</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Free</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       /data/tidb-data/dm/dm-worker-8262</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  /data/tidb-deploy/dm/dm-worker-8262</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">192.168.169.43:8262</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  dm-worker</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  192.168.169.43</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  8262</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Free</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       /data/tidb-data/dm/dm-worker-8262</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  /data/tidb-deploy/dm/dm-worker-8262</span></span></code></pre>
</div><h2 id="prepare-upstream-data" tabindex="-1">Prepare Upstream Data <a class="header-anchor" href="#prepare-upstream-data" aria-label="Permalink to &quot;Prepare Upstream Data&quot;"></a></h2>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> database</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> user</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> database</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> database</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> table</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> information</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">int</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> primary key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">));</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> table</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">int</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> primary key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">use</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> table</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> messages</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">int</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> primary key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"># </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">192</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">168</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">169</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">44</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> store;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> table</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store_bj</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">int</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> primary key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">));</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> table</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store_tj</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">int</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> primary key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">));</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">insert into</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> store</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">store_bj</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> values</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'store_bj_01'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">),(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'store_bj_02'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">insert into</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> store</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">store_tj</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> values</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'store_tj_01'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">),(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'store_tj_02'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"># </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">192</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">168</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">169</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">45</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> store;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> table</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store_sh</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">int</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> primary key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">));</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> table</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store_sz</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">int</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> primary key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">));</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">insert into</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> store</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">store_sh</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> values</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'store_sh_01'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">),(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'store_sh_02'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">insert into</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> store</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">store_sz</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> values</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'store_suzhou_01'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">),(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'store_suzhou_02'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"># </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">192</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">168</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">169</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">46</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> store;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> table</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store_gz</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">int</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> primary key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">));</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> table</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store_sz</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">int</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> primary key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">));</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">insert into</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> store</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">store_gz</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> values</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'store_gz_01'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">),(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'store_gz_02'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">insert into</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> store</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">store_sz</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> values</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'store_shenzhen_01'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">),(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'store_shenzhen_02'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">);</span></span></code></pre>
</div><h2 id="prepare-downstream-schemas" tabindex="-1">Prepare Downstream Schemas <a class="header-anchor" href="#prepare-downstream-schemas" aria-label="Permalink to &quot;Prepare Downstream Schemas&quot;"></a></h2>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> database</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> user_north</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> database</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> user_east</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> database</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> user_south</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_north;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> table</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> information</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">int</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> primary key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> table</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">int</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> primary key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_east;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> table</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> information</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">int</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> primary key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> table</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">int</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> primary key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_south;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> table</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> information</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">int</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> primary key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> table</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">int</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> primary key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">));</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> database</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> store;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> table</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store_bj</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">int</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> primary key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">));</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> table</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store_tj</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">int</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> primary key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">));</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> table</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store_sh</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">int</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> primary key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">));</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> table</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store_gz</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">int</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> primary key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">));</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> table</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store_suzhou</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   (id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">int</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> primary key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">));</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> table</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store_shenzhen</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">int</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> primary key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">));</span></span></code></pre>
</div><h2 id="createsource-to-worker" tabindex="-1">Createsource to worker <a class="header-anchor" href="#createsource-to-worker" aria-label="Permalink to &quot;Createsource to worker&quot;"></a></h2>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 conf]$ tiup dmctl --master-addr</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">192.168.169.41:8261</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> operate-source</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> create</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> source1.yaml</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> component</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">dmctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /home/tidb/.tiup/components/dmctl/v2.0.1/dmctl/dmctl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --master-addr=192.168.169.41:8261</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> operate-source</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> create</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> source1.yaml</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    "msg"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    "sources"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "msg"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "source"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "mysql-replica-01",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "worker"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "dm-192.168.169.41-8262"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 conf]$ tiup dmctl --master-addr</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">192.168.169.41:8261</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> operate-source</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> create</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> source2.yaml</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> component</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">dmctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /home/tidb/.tiup/components/dmctl/v2.0.1/dmctl/dmctl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --master-addr=192.168.169.41:8261</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> operate-source</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> create</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> source2.yaml</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    "msg"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    "sources"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "msg"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "source"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "mysql-replica-02",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "worker"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "dm-192.168.169.42-8262"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 conf]$ tiup dmctl --master-addr</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">192.168.169.41:8261</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> operate-source</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> create</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> source3.yaml</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> component</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">dmctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /home/tidb/.tiup/components/dmctl/v2.0.1/dmctl/dmctl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --master-addr=192.168.169.41:8261</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> operate-source</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> create</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> source3.yaml</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    "msg"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    "sources"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "msg"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "source"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "mysql-replica-03",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "worker"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "dm-192.168.169.43-8262"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
</div><h2 id="check-member-by-dmctl" tabindex="-1">Check member by dmctl <a class="header-anchor" href="#check-member-by-dmctl" aria-label="Permalink to &quot;Check member by dmctl&quot;"></a></h2>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 conf]$ tiup dmctl --master-addr</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">192.168.169.41:8261</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> list-member</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> component</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">dmctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /home/tidb/.tiup/components/dmctl/v2.0.1/dmctl/dmctl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --master-addr=192.168.169.41:8261</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> list-member</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    "msg"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    "members"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "leader"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "msg"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "name"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "dm-192.168.169.41-8261",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "addr"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "192.168.169.41:8261"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">            }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "master"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "msg"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "masters"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                    {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "name"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "dm-192.168.169.41-8261",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "memberID"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "11955134185808625835",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "alive"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "peerURLs"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                            "http://192.168.169.41:8291"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                        ],</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "clientURLs"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                            "http://192.168.169.41:8261"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                        ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                    },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                    {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "name"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "dm-192.168.169.42-8261",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "memberID"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "16647128463965627029",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "alive"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "peerURLs"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                            "http://192.168.169.42:8291"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                        ],</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "clientURLs"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                            "http://192.168.169.42:8261"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                        ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                    },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                    {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "name"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "dm-192.168.169.43-8261",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "memberID"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "7578209210746128387",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "alive"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "peerURLs"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                            "http://192.168.169.43:8291"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                        ],</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "clientURLs"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                            "http://192.168.169.43:8261"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                        ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">            }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "worker"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "msg"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "workers"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                    {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "name"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "dm-192.168.169.41-8262",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "addr"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "192.168.169.41:8262",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "stage"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "bound",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "source"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "mysql-replica-01"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                    },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                    {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "name"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "dm-192.168.169.42-8262",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "addr"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "192.168.169.42:8262",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "stage"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "bound",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "source"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "mysql-replica-02"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                    },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                    {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "name"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "dm-192.168.169.43-8262",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "addr"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "192.168.169.43:8262",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "stage"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "bound",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "source"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "mysql-replica-03"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">            }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
</div><h2 id="start-task-by-dmctl" tabindex="-1">Start task by dmctl <a class="header-anchor" href="#start-task-by-dmctl" aria-label="Permalink to &quot;Start task by dmctl&quot;"></a></h2>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 dm]$ tiup dmctl -master-addr 192.168.169.42:8261 start-task task.yml</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># look status of task</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 dm]$ tiup dmctl --master-addr 192.168.169.42:8261 query-status one-tidb-slave</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> component</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">dmctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /home/tidb/.tiup/components/dmctl/v2.0.1/dmctl/dmctl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --master-addr</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 192.168.169.42:8261</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> query-status</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> one-tidb-slave</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    "msg"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    "sources"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "msg"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "sourceStatus"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "source"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "mysql-replica-01",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "worker"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "dm-192.168.169.41-8262",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> null,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "relayStatus"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> null</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">            },</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "subTaskStatus"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "name"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "one-tidb-slave",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "stage"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "Running",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "unit"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "Sync",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> null,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "unresolvedDDLLockID"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "sync"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "totalEvents"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "0",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "totalTps"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "0",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "recentTps"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "0",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "masterBinlog"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "(mysql-bin.000001, 6633)",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "masterBinlogGtid"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "581426c4-563a-11eb-8eea-000c2972c98a:1-35",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "syncerBinlog"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "(mysql-bin.000001, 6633)",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "syncerBinlogGtid"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "581426c4-563a-11eb-8eea-000c2972c98a:1-35",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "blockingDDLs"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                        ],</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "unresolvedGroups"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                        ],</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "synced"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "binlogType"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "remote"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">            ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "msg"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "sourceStatus"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "source"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "mysql-replica-02",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "worker"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "dm-192.168.169.42-8262",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> null,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "relayStatus"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> null</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">            },</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "subTaskStatus"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "name"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "one-tidb-slave",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "stage"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "Running",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "unit"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "Sync",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> null,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "unresolvedDDLLockID"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "sync"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "totalEvents"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "0",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "totalTps"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "0",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "recentTps"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "0",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "masterBinlog"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "(mysql-bin.000001, 7957)",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "masterBinlogGtid"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "8b923309-5644-11eb-a36c-000c29d3567e:1-41",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "syncerBinlog"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "(mysql-bin.000001, 7957)",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "syncerBinlogGtid"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "8b923309-5644-11eb-a36c-000c29d3567e:1-41",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "blockingDDLs"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                        ],</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "unresolvedGroups"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                        ],</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "synced"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "binlogType"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "remote"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">            ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "msg"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "sourceStatus"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "source"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "mysql-replica-03",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "worker"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "dm-192.168.169.43-8262",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> null,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "relayStatus"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> null</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">            },</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "subTaskStatus"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "name"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "one-tidb-slave",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "stage"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "Running",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "unit"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "Sync",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> null,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "unresolvedDDLLockID"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "sync"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "totalEvents"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "0",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "totalTps"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "0",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "recentTps"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "0",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "masterBinlog"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "(mysql-bin.000001, 9273)",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "masterBinlogGtid"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "9d33b95a-5644-11eb-a720-000c290d4084:1-47",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "syncerBinlog"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "(mysql-bin.000001, 9273)",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "syncerBinlogGtid"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "9d33b95a-5644-11eb-a720-000c290d4084:1-47",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "blockingDDLs"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                        ],</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "unresolvedGroups"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                        ],</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "synced"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "binlogType"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "remote"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">            ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
</div><h2 id="resume-task-by-dmctl" tabindex="-1">Resume task by dmctl <a class="header-anchor" href="#resume-task-by-dmctl" aria-label="Permalink to &quot;Resume task by dmctl&quot;"></a></h2>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 dm]$ tiup dmctl --master-addr 192.168.169.42:8261 resume-task one-tidb-slave</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> component</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">dmctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /home/tidb/.tiup/components/dmctl/v2.0.1/dmctl/dmctl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --master-addr</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 192.168.169.42:8261</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> resume-task</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> one-tidb-slave</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    "op"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "Resume",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    "msg"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    "sources"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "msg"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "source"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "mysql-replica-01",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "worker"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "dm-192.168.169.41-8262"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "msg"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "source"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "mysql-replica-02",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "worker"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "dm-192.168.169.42-8262"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "msg"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "source"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "mysql-replica-03",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "worker"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "dm-192.168.169.43-8262"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 dm]$ tiup dmctl --master-addr 192.168.169.42:8261 query-status one-tidb-slave</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> component</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">dmctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /home/tidb/.tiup/components/dmctl/v2.0.1/dmctl/dmctl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --master-addr</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 192.168.169.42:8261</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> query-status</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> one-tidb-slave</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    "msg"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    "sources"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "msg"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "sourceStatus"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "source"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "mysql-replica-01",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "worker"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "dm-192.168.169.41-8262",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> null,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "relayStatus"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> null</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">            },</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "subTaskStatus"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "name"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "one-tidb-slave",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "stage"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "Running",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "unit"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "Sync",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> null,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "unresolvedDDLLockID"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "sync"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "totalEvents"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "0",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "totalTps"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "0",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "recentTps"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "0",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "masterBinlog"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "(mysql-bin.000001, 6633)",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "masterBinlogGtid"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "581426c4-563a-11eb-8eea-000c2972c98a:1-35",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "syncerBinlog"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "(mysql-bin.000001, 6633)",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "syncerBinlogGtid"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "581426c4-563a-11eb-8eea-000c2972c98a:1-35",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "blockingDDLs"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                        ],</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "unresolvedGroups"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                        ],</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "synced"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "binlogType"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "remote"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">            ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "msg"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "sourceStatus"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "source"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "mysql-replica-02",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "worker"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "dm-192.168.169.42-8262",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> null,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "relayStatus"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> null</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">            },</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "subTaskStatus"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "name"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "one-tidb-slave",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "stage"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "Running",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "unit"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "Sync",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> null,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "unresolvedDDLLockID"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "sync"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "totalEvents"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "0",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "totalTps"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "0",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "recentTps"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "0",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "masterBinlog"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "(mysql-bin.000001, 7957)",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "masterBinlogGtid"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "8b923309-5644-11eb-a36c-000c29d3567e:1-41",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "syncerBinlog"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "(mysql-bin.000001, 7957)",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "syncerBinlogGtid"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "8b923309-5644-11eb-a36c-000c29d3567e:1-41",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "blockingDDLs"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                        ],</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "unresolvedGroups"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                        ],</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "synced"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "binlogType"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "remote"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">            ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "msg"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "sourceStatus"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "source"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "mysql-replica-03",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "worker"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "dm-192.168.169.43-8262",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> null,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "relayStatus"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> null</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">            },</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "subTaskStatus"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "name"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "one-tidb-slave",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "stage"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "Running",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "unit"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "Sync",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> null,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "unresolvedDDLLockID"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "sync"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "totalEvents"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "0",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "totalTps"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "0",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "recentTps"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "0",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "masterBinlog"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "(mysql-bin.000001, 9273)",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "masterBinlogGtid"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "9d33b95a-5644-11eb-a720-000c290d4084:1-47",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "syncerBinlog"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "(mysql-bin.000001, 9273)",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "syncerBinlogGtid"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "9d33b95a-5644-11eb-a720-000c290d4084:1-47",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "blockingDDLs"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                        ],</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "unresolvedGroups"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                        ],</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "synced"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "binlogType"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "remote"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">            ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
</div><h2 id="check-downstram-replication" tabindex="-1">Check Downstram Replication <a class="header-anchor" href="#check-downstram-replication" aria-label="Permalink to &quot;Check Downstram Replication&quot;"></a></h2>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 dm]$ mysql -uroot -P4000 -h192.168.169.41</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Welcome</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> MariaDB</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> monitor.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Commands</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> end</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> with</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">or</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \g</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Your</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> MySQL</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> connection</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> id</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> is</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 429</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Server</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> version:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 5.7.25-TiDB-v4.0.9</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> TiDB</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Server</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (Apache </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">License</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 2.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) Community Edition, MySQL 5.7 compatible</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Copyright</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Type</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'help;'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> or</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> '\h'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> help.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Type</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> '\c'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> clear</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> current</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> input</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> statement.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">MySQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [(none)]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> show databases;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+--------------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Database</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">           |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+--------------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> INFORMATION_SCHEMA</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> METRICS_SCHEMA</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">     |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> PERFORMANCE_SCHEMA</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> dm_meta</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">            |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> dump_test</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">          |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> dumptest1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">          |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> dumptest2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">          |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> jan</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">                |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> mysql</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">              |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">              |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> user_east</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">          |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> user_north</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">         |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> user_south</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">         |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+--------------------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">13</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> rows</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">MySQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [(none)]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> use store</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Reading</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> table</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> information</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> completion</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> table</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> and</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> column</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> names</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">You</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> can</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> turn</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> off</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> this</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> feature</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> quicker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> startup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> with</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -A</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Database</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> changed</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">MySQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [store]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> show tales;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ERROR</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1064</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (42000): You have an error in your SQL syntax; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">check</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> manual</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> that</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> corresponds</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> your</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> TiDB</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> version</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> right</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> syntax</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> use</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> line</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> column</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 10</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> near</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "tales"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">MySQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [store]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> show tables;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+-----------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Tables_in_store</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+-----------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store_bj</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">        |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store_gz</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">        |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store_sh</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">        |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store_shenzhen</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store_suzhou</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store_tj</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">        |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+-----------------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">6</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> rows</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">MySQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [store]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> * from store_bj;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+------+-------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">        |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+------+-------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store_bj_01</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store_bj_02</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+------+-------------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> rows</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (0.01 </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">MySQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [store]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> * from store_gz;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+------+-------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">        |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+------+-------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store_gz_01</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store_gz_02</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+------+-------------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> rows</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (0.25 </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">MySQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [store]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> * from store_shenzhen;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+------+-------------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">              |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+------+-------------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store_shenzhen_01</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store_shenzhen_02</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+------+-------------------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> rows</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (0.01 </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">MySQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [store]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> * from store_suzhou;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+------+-----------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">            |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+------+-----------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store_suzhou_01</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store_suzhou_02</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+------+-----------------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> rows</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span></code></pre>
</div><h2 id="incremental-replication-checking" tabindex="-1">Incremental Replication Checking <a class="header-anchor" href="#incremental-replication-checking" aria-label="Permalink to &quot;Incremental Replication Checking&quot;"></a></h2>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># MySQL</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">insert</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> into</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> store_bj</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> values</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (3,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'incremental_bj_03'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Query</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> OK,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> row</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> affected</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">select</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> *</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> store_bj</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+----+-------------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">              |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+----+-------------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store_bj_01</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">       |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store_bj_02</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">       |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  3</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> incremental_bj_03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+----+-------------------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">3</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> rows</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># TiDB</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">MySQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [store]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> * from store_bj;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+------+-------------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">              |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+------+-------------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store_bj_01</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">       |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store_bj_02</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">       |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    3</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> incremental_bj_03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+------+-------------------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">3</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> rows</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (0.01 </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span></code></pre>
</div><h2 id="reference" tabindex="-1">Reference <a class="header-anchor" href="#reference" aria-label="Permalink to &quot;Reference&quot;"></a></h2>
<p><a href="https://www.bookstack.cn/read/tidb-data-migration-1.0-zh/zh-get-started.md" target="_blank" rel="noreferrer">TiDB Data Migration (DM) Áî®Êà∑ÊñáÊ°£ v1.0://www.bookstack.cn/read/tidb-data-migration-1.0-zh/zh-get-started.md</a></p>
<p><a href="https://docs.pingcap.com/zh/tidb-data-migration/stable/usage-scenario-simple-migration" target="_blank" rel="noreferrer">Data Migration ÁÆÄÂçï‰ΩøÁî®Âú∫ÊôØ:https://docs.pingcap.com/zh/tidb-data-migration/stable/usage-scenario-simple-migration</a></p>
<p><a href="https://docs.pingcap.com/zh/tidb-data-migration/stable/migrate-data-using-dm#%E7%AC%AC-4-%E6%AD%A5%E9%85%8D%E7%BD%AE%E4%BB%BB%E5%8A%A1" target="_blank" rel="noreferrer">‰ΩøÁî® DM ËøÅÁßªÊï∞ÊçÆ:https://docs.pingcap.com/zh/tidb-data-migration/stable/migrate-data-using-dm#%E7%AC%AC-4-%E6%AD%A5%E9%85%8D%E7%BD%AE%E4%BB%BB%E5%8A%A1</a></p>
<p><a href="https://docs.pingcap.com/zh/tidb-data-migration/stable/quick-start-with-dm" target="_blank" rel="noreferrer">TiDB Data Migration Âø´ÈÄü‰∏äÊâãÊåáÂçó:https://docs.pingcap.com/zh/tidb-data-migration/stable/quick-start-with-dm</a></p>
<p><a href="https://docs.pingcap.com/zh/tidb-data-migration/stable/quick-start-create-task" target="_blank" rel="noreferrer">ÂàõÂª∫Êï∞ÊçÆËøÅÁßª‰ªªÂä°:https://docs.pingcap.com/zh/tidb-data-migration/stable/quick-start-create-task</a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[DM Master]]></title>
            <link>https://askaric.com/en/work/tidb/TiDB-EcosystematicTools/5-4DM/03TiDB-DM Master.html</link>
            <guid>https://askaric.com/en/work/tidb/TiDB-EcosystematicTools/5-4DM/03TiDB-DM Master.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[What's DM Master
 Etcd
How does DM Master high availability work. Mostly, It's due to the avaliable ]]></description>
            <content:encoded><![CDATA[<h1 id="dm-master" tabindex="-1">DM Master <a class="header-anchor" href="#dm-master" aria-label="Permalink to &quot;DM Master&quot;"></a></h1>
<h2 id="what-s-dm-master" tabindex="-1">What's DM Master <a class="header-anchor" href="#what-s-dm-master" aria-label="Permalink to &quot;What's DM Master&quot;"></a></h2>
<figure><img src="./../../../../../images/tidb/05TiDB-EcosystematicTools/5-4DM/02-DM_Master_Components.jpeg" alt="DM_Master_Components" tabindex="0"><figcaption>DM_Master_Components</figcaption></figure>
<h2 id="etcd" tabindex="-1">Etcd <a class="header-anchor" href="#etcd" aria-label="Permalink to &quot;Etcd&quot;"></a></h2>
<p><strong>How does DM Master high availability work.</strong> Mostly, It's due to the avaliable characteristics of ectd, which's stored all persist data in DM Cluster. Meanwhile, by <a href="#election">the Election</a>, only the leader of DM Master is able to start working components and work with etcd,and the leader also periodically, checks if there's something seriously wrong with DM. Do the recover action right now at the right time.</p>
<h2 id="openapihandles" tabindex="-1">OpenapiHandles <a class="header-anchor" href="#openapihandles" aria-label="Permalink to &quot;OpenapiHandles&quot;"></a></h2>
<p>DM provids <a href="https://docs.pingcap.com/tidb/stable/dm-open-api" target="_blank" rel="noreferrer">OpenAPI</a> to operate/create tasks, sources, etc. Just like you use it in dm-ctl commands. Mainly it's implmented by OpenapiHandler encapsulated in DM Master. And it works when the DM Master leader started. At the same time, DM Worker peer will redirect request to the leader to deal with if the one receives OpenAPI requests.</p>
<h2 id="agentpool" tabindex="-1">AgentPool <a class="header-anchor" href="#agentpool" aria-label="Permalink to &quot;AgentPool&quot;"></a></h2>
<ol>
<li>
<p>This component was added dut to <a href="https://github.com/pingcap/dm/pull/157" target="_blank" rel="noreferrer">this PR</a>, mainly looking forward to add rate limit and rpc client manage in dm-master. Though, it's the key component in the entire DM Master components, Why I decided to introducte the one is all because it appears inside the <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/master/server.go#L127" target="_blank" rel="noreferrer">Server</a> struct.</p>
</li>
<li>
<p>And the way it was implmented is just encapsulate the package of <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/master/agent_pool.go#L60" target="_blank" rel="noreferrer">golang rate.Limit</a> to filter.</p>
</li>
</ol>
<h2 id="election" tabindex="-1">Election <a class="header-anchor" href="#election" aria-label="Permalink to &quot;Election&quot;"></a></h2>
<ol>
<li><strong>First</strong>, It's a comman package encapsulated to implment functionality of leader election based on etcd.</li>
<li><strong>Second</strong>, The function <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/pkg/election/election.go#L200" target="_blank" rel="noreferrer">compaignLoop</a> is the key to understand how the logical concept is continuously running. Periodically, it'll recampaign leader of DM master instances and <strong>the leader'll start</strong> some components including <code>Scheduler</code>, <code>Pessimist</code> and <code>Optimist</code>. The followers don't care about how to run the ones.</li>
<li><strong>Third,</strong> It also splits task into subtasks which represents only one source(or on worker) in one migration subtask(<strong>The conceptal fomuler : 1 worker VS 1 source VS 1 subtask</strong>).</li>
</ol>
<h2 id="scheduler" tabindex="-1">Scheduler <a class="header-anchor" href="#scheduler" aria-label="Permalink to &quot;Scheduler&quot;"></a></h2>
<ol>
<li><strong>First</strong>, Scheduler is part of Master, which's responsible for tasks of DM worker, such as <code>register/unregister</code>, <code>observe the online/offline</code>, <code>observe add/remove source config</code>, <code>schedule upstream sources</code>, <code>schedule data migration subtask</code> and so forth, more details at <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/master/scheduler/scheduler.go#L44" target="_blank" rel="noreferrer">here</a>.</li>
<li><strong>Second</strong>, what scheduler actully does is that, on the one hand, some background gorountines are countinuous running after starting the master instance like <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/master/scheduler/scheduler.go#L2081" target="_blank" rel="noreferrer"><code>observeWorkerEvent</code></a> is going to reveive the keepalive status triggerd by DM Worker, on the other hand, the others will be triggered when dmctl or openAPI sends some operations, like: <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/master/scheduler/scheduler.go#L441" target="_blank" rel="noreferrer"><code>RemoveSourceCfg</code></a>. Mostly, the functions were embended in GRPC defining.</li>
<li><strong>Third</strong>, It also generates subTasks from one replication task and persist them on etcd.</li>
</ol>
<h2 id="pessimist" tabindex="-1">Pessimist <a class="header-anchor" href="#pessimist" aria-label="Permalink to &quot;Pessimist&quot;"></a></h2>
<ol>
<li>
<p>First, we can see pessmist is come up with two parts of <code>DM Master</code> and <code>syncer</code> from the picture above. This part will focus on what the DM Master does inside. From <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/master/shardddl/pessimist.go#L464" target="_blank" rel="noreferrer">the function handleInfoPut of DM Master</a>, we can make sure the one Info is handled by DM Master when the it receives enough Infos from etcd. Actually, dm-ctl also can generate operations ,like something seriously worng with DDL Lock, when you use <code>unlock-ddl-lock</code> inside using the logic of <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/master/shardddl/pessimist.go#L343" target="_blank" rel="noreferrer"><code>waitOwnerToBeDone</code></a>. From code, <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/ddl.go#L641" target="_blank" rel="noreferrer">shardOp.Exec</a> will be true when it's the owner of shard DDL Lock and written by <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/master/shardddl/pessimist.go#L605" target="_blank" rel="noreferrer">putOpForOwner</a> of DM master leader. What I mean is that this's the logic to implment actually the owner to execute the only one DDL to downstream. And in the <code>Syncer</code> of worker, what DM-worker does is just put info to etcd of DM-Master when <code>the HandleDDL function</code> receives any DDL MySQL binlog event, meanwhile, if it's the owner or first worker meets the DDL , it's also responsible for executing.</p>
</li>
<li>
<p>Second, PTAL at the conceptal logic of <a href="https://docs.pingcap.com/zh/tidb-data-migration/v5.3/feature-shard-merge-pessimistic#%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86" target="_blank" rel="noreferrer">shard-merge-pessimistic</a>. The <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/pkg/shardddl/pessimism/doc.go" target="_blank" rel="noreferrer">implement detail</a>. In short, what it actually does is keeping every DML in a DM Cluster before a specific DDL timestamp which hasn't been synced, till the end of the DDL finished. In short, if there is DDL replication in a sharding group(multi MySQL sharding tables into one TiDB table), the worker which's the first thing to meet the DDL query will notify DM-Master to generate a lock then block related DDL and DML queries. Till all the DDL of sources have been reported to DM-Master, the one worker which's already been chose as owner starts to execute the DDL. if the DDL was executed successfully, it'll replay the DDL and DML queries blocked and replay replication as usual.</p>
<figure><img src="https://download.pingcap.com/images/tidb-data-migration/shard-ddl-flow.png" alt="pessimism" tabindex="0"><figcaption>pessimism</figcaption></figure>
</li>
<li>
<p><code>LockKeeper</code> which encapsulates <code>Lock</code> used to keep and handle DDL lock conveniently, and lock has a 1 on 1 relationship with DDL at a specific time in a replication task. Both also don't need to be presistent. Because it can be re-constructed from the shard DDL info which were persisited in to etcd of DM-Master by DM-Worker. And, this strcut has a key founction named <code>TrySync</code>, which's to sync the lock <strong>by increasing the number of remain</strong>, which number is equal to the number of sources(related workers) if it's received the DDL event from MySQL Binlog.</p>
<div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Lock</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">mu </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sync</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">RWMutex</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">ID     </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">   // lock's ID</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">Task   </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">   // lock's corresponding task name</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">Owner  </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">   // Owner's source ID (not DM-worker's name)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">DDLs   []</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"> // DDL statements</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">remain </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">int</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">      // remain count of sources needed to receive DDL info</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// whether the DDL info received from the source.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// if all of them have been ready, then we call the lock `synced`.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">ready </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">bool</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// whether the operations have done (exec/skip the shard DDL).</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// if all of them have done, then we call the lock `resolved`.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">done </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">bool</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> LockKeeper</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">mu    </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sync</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">RWMutex</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">locks </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Lock</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"> // lockID -> Lock</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
</div></li>
<li>
<p><code>Info</code> represents the shard DDL information and <code>Operation</code> represents a shard DDL coordinate operation ,which all of information should be persistent in etcd. Another key defference between <code>Info</code> and <code>Operation</code> we have to know is something that the DM Worker just sends the Lock or DDL Info to the DM Master, and watch Operations from etcd of the one. So, DM Master will use <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/master/shardddl/pessimist.go#L601" target="_blank" rel="noreferrer"><code>func putOpForOwner</code></a> to put operation into etcd to executed the DDL.</p>
<div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Info</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    Task   </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   `json:"task"`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">   // data migration task name</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    Source </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   `json:"source"`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"> // upstream source ID</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    Schema </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   `json:"schema"`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"> // schema name of the DDL</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    Table  </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   `json:"table"`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">  // table name of the DDL</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    DDLs   []</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `json:"ddls"`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">   // DDL statements</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Operation</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    ID     </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   `json:"id"`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">     // the corresponding DDL lock ID</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    Task   </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   `json:"task"`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">   // data migration task name</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    Source </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   `json:"source"`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"> // upstream source ID</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    DDLs   []</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `json:"ddls"`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">   // DDL statements</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    Exec   </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">bool</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     `json:"exec"`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">   // execute or skip the DDL statements</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    Done   </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">bool</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     `json:"done"`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">   // whether the `Exec` operation has done</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    // only used to report to the caller of the watcher, do not marsh it.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    // if it's true, it means the Operation has been deleted in etcd.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    IsDeleted </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">bool</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `json:"-"`</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
</div></li>
<li>
<p>At the end, I wanna claim here there're lots of key functions relevent to persist data like <code>handleInfoPut</code>, <code>handleOperationPut</code> and so forth. All of them are acting with the etcd of DM Master. But, in my main-step-pic, all didn't be carved clearly.</p>
</li>
<li>
<p>If you wanna more details, I recommand you to read this <a href="https://tidb.net/blog/ebc3d5e6" target="_blank" rel="noreferrer">content</a>, which describes more info about how Lock is resolved, and how DMLs are resynced(I mentioned above the concept is block, actually it's ignored) at <a href="https://tidb.net/blog/80c41c9d" target="_blank" rel="noreferrer">here</a>. These content don't have english version, please use other translating tools to solve that problem.</p>
</li>
</ol>
<h2 id="optimist" tabindex="-1">Optimist <a class="header-anchor" href="#optimist" aria-label="Permalink to &quot;Optimist&quot;"></a></h2>
<ol>
<li>
<p>There'a also an important <a href="https://docs.pingcap.com/zh/tidb-data-migration/v5.3/feature-shard-merge-optimistic#%E5%8E%9F%E7%90%86" target="_blank" rel="noreferrer">conceptal logic</a> you have to know fist. I'll also take a summarize for the mode, the key tuning is that DDL doesn't blocking DML replication comparing with pessmistic mode.</p>
</li>
<li>
<p>LockKeeper and Lock are used to keep and handle DDL lock conveniently. The conceptally logical function is equal to Lock in pessimism. This's highly equal to part of pessmist.</p>
</li>
<li>
<p>And also there's a <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/pkg/shardddl/optimism/doc.go#L16" target="_blank" rel="noreferrer">doc</a> just simply saying different from pessmist. Actually I think you could read this page which's equal to the one or even more info you can get <a href="https://docs.pingcap.com/tidb-data-migration/v5.3/feature-shard-merge-optimistic#restrictions" target="_blank" rel="noreferrer">here</a>. Let's get started to look what the DM Master does about sharding DDL replication in optimistic.</p>
<figure><img src="https://download.pingcap.com/images/tidb-data-migration/optimistic-ddl-flow.png" alt="optimistic" tabindex="0"><figcaption>optimistic</figcaption></figure>
</li>
<li>
<p>We can simply get that the Info and the Operation differ from pessmist by their structs. The info operatied by optimist includes many more things than pessmist like <code>TableInfoBefore</code>, <code>TableInfosAfter</code>, <code>DownTable</code> and so on, which are used to calculate how DDL should be converted.</p>
<div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Info</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">Task       </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   `json:"task"`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">        // data migration task name</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">Source     </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   `json:"source"`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">      // upstream source ID</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">UpSchema   </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   `json:"up-schema"`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">   // upstream/source schema name, different sources can have the same schema name</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">UpTable    </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   `json:"up-table"`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    // upstream/source table name, different sources can have the same table name</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">DownSchema </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   `json:"down-schema"`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"> // downstream/target schema name</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">DownTable  </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   `json:"down-table"`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">  // downstream/target table name</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">DDLs       []</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `json:"ddls"`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">        // DDL statements</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">TableInfoBefore </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">TableInfo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   `json:"table-info-before"`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"> // the tracked table schema before applying the DDLs</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">TableInfosAfter []</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">TableInfo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `json:"table-info-after"`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">  // the tracked table schema after applying the DDLs</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// only used to report to the caller of the watcher, do not marsh it.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// if it's true, it means the Info has been deleted in etcd.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">IsDeleted </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">bool</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `json:"-"`</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// only set it when get/watch from etcd</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">Version </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">int64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `json:"-"`</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// only set it when get from etcd</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// use for sort infos in recoverlock</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">Revision </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">int64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `json:"-"`</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// use to resolve conflict</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">IgnoreConflict </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">bool</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `json:"ignore-conflict"`</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Operation</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">ID            </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">        `json:"id"`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">               // the corresponding DDL lock ID</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">Task          </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">        `json:"task"`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">             // data migration task name</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">Source        </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">        `json:"source"`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">           // upstream source ID</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">UpSchema      </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">        `json:"up-schema"`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">        // upstream/source schema name, different sources can have the same schema name</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">UpTable       </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">        `json:"up-table"`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">         // upstream/source table name, different sources can have the same table name</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">DDLs          []</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      `json:"ddls"`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">             // DDL statements need to apply to the downstream.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">ConflictStage </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ConflictStage</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `json:"conflict-stage"`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">   // current conflict stage.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">ConflictMsg   </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">        `json:"conflict-message"`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"> // current conflict message</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">Done          </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">bool</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">          `json:"done"`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">             // whether the operation has done</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">Cols          []</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      `json:"cols"`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">             // drop columns' name</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// only set it when get from etcd</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// use for sort infos in recovering locks</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">Revision </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">int64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `json:"-"`</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
</div></li>
<li>
<p><strong>How DM Master converts DDL info or schema info</strong> is just trying to detect if there's any DDL conflict and allow every DML sync to downstream ASAP. And if there's an error or conflict, it'll be reported.</p>
</li>
</ol>
]]></content:encoded>
            <enclosure url="https://askaric.com/images/tidb/05TiDB-EcosystematicTools/5-4DM/02-DM_Master_Components.jpeg" length="0" type="image/jpeg"/>
        </item>
        <item>
            <title><![CDATA[DM Worker]]></title>
            <link>https://askaric.com/en/work/tidb/TiDB-EcosystematicTools/5-4DM/04TiDB-DM Worker.html</link>
            <guid>https://askaric.com/en/work/tidb/TiDB-EcosystematicTools/5-4DM/04TiDB-DM Worker.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[What's DM Worker
DM Worker starts from the func start then starts a series of componnets including `]]></description>
            <content:encoded><![CDATA[<h1 id="dm-worker" tabindex="-1">DM Worker <a class="header-anchor" href="#dm-worker" aria-label="Permalink to &quot;DM Worker&quot;"></a></h1>
<h2 id="what-s-dm-worker" tabindex="-1">What's DM Worker <a class="header-anchor" href="#what-s-dm-worker" aria-label="Permalink to &quot;What's DM Worker&quot;"></a></h2>
<p>DM Worker starts from the <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/worker/server.go#L106-L108" target="_blank" rel="noreferrer">func start</a> then starts a series of componnets including <code>startKeepAlive</code>, <code>RelayHandler</code>, <code>SubTasks</code>, <code>Syncer</code>. About the relay config, there's a <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/worker/server.go#L160-L164" target="_blank" rel="noreferrer">logic</a> to adjust wether use remote MySQL Binlog or Local relay log.</p>
<figure><img src="./../../../../../images/tidb/05TiDB-EcosystematicTools/5-4DM/03-DM_Worker_Components.jpeg" alt="DM_Worker_Components" tabindex="0"><figcaption>DM_Worker_Components</figcaption></figure>
<h2 id="keepalive" tabindex="-1">KeepAlive <a class="header-anchor" href="#keepalive" aria-label="Permalink to &quot;KeepAlive&quot;"></a></h2>
<ol>
<li>
<p><strong>What's the functionality.</strong> DM Worker keepalive with master. If worker loses connect from master, it would stop all task and try to connect master again.</p>
</li>
<li>
<p><strong>How does it work.</strong> The <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/worker/join.go#L103" target="_blank" rel="noreferrer">defaultKeepAliveTTL</a> is 1 minutes, which periodically use <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/pkg/ha/keepalive.go#L116" target="_blank" rel="noreferrer">etcd cli.Grant</a> to put kv with TTL to etcd. In that way, DM Master could be able to transter subtask into another alive DM Worker if there's something seriously wrong with the worker which already has bounded with one specific MySQL Binlog.</p>
</li>
</ol>
<h2 id="relay" tabindex="-1">Relay <a class="header-anchor" href="#relay" aria-label="Permalink to &quot;Relay&quot;"></a></h2>
<ol>
<li>
<p><strong>How to detect if it's configed.</strong> When configuration cannot be obtained from DM Master, which means the task was already deleted or hasn't been configed, that starting <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/worker/server.go#L183-L185" target="_blank" rel="noreferrer">logic</a> goes inside the <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/worker/server.go#L686-L688" target="_blank" rel="noreferrer">func enableHandleSubtasks</a> to justify wether to use Realy log.</p>
</li>
<li>
<p><strong>How to work if it's configed.</strong> I recommend you to have more relay implmented info in <a href="https://cn.pingcap.com/blog/dm-source-code-reading-6" target="_blank" rel="noreferrer">this article - DM Ê∫êÁ†ÅÈòÖËØªÁ≥ªÂàóÊñáÁ´†ÔºàÂÖ≠Ôºârelay log ÁöÑÂÆûÁé∞</a> (BTW: you need english version might  changing by yourself). In short, Relay log is a bridge function avoiding suddenly remote MySQL Binlog disappearing, and it's implmented by that firstly read every useful binlog, like insert/update... using <a href="https://github.com/pingcap/dm/blob/f6f0566424/relay/reader/reader.go#L128" target="_blank" rel="noreferrer">GetEvent</a>, then write into relay log dir as below. DM Worker uses relay when enabled, and calls <a href="https://github.com/pingcap/dm/blob/f6f0566424/pkg/streamer/reader.go#L244" target="_blank" rel="noreferrer">func parseFile</a> to parse Relay log to syncer.<br>
<strong>a. server-uuid.index</strong> : An index already organized binglog events to provide a structure to index where to read.<br>
<strong>b. 842965eb-091c-11e9-9e45-9a3bff03fa39</strong> : Dir generated by the <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/relay/meta.go#L279" target="_blank" rel="noreferrer">func utils.AddSuffixForUUID</a> in format of <code>fmt.Sprintf(&quot;%s%s%06d&quot;, uuid, uuidIndexSeparator, id)</code>.<br>
<strong>c. relay.meta</strong> : Record current prorocess or progress.<br>
<strong>d. mysql-bin.00000X</strong> : The max number of X is the newest file which's being written.</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">&#x3C;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">deploy_dir</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">/relay_log/</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">--</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 7e427cc0-091c-11e9-9e45-72b7c59d52d7.000001</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">--</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysql-bin.000001</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">--</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysql-bin.000002</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">--</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysql-bin.000003</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">--</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysql-bin.000004</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">--</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> relay.meta</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">--</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 842965eb-091c-11e9-9e45-9a3bff03fa39.000002</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">--</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysql-bin.000001</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">--</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> relay.meta</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">--</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  server-uuid.index</span></span></code></pre>
</div></li>
</ol>
<h2 id="subtasks" tabindex="-1">SubTasks <a class="header-anchor" href="#subtasks" aria-label="Permalink to &quot;SubTasks&quot;"></a></h2>
<ol>
<li>
<p><strong>What does it mean.</strong> SubTask represents a sub task of data migration. In other words, the number of subtasks is equal to MySQL Binlog number. All because they have 1-1 replationship. we can see the one by <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/worker/subtask.go#L77" target="_blank" rel="noreferrer">it's struct</a> below. As we all know, one working worker has only one binlog till now.  One noticeable feature is PingCAP is trying to decouple the 1-1 replationship, you can flow the progress by the tracking <a href="https://github.com/pingcap/tiflow/issues/4687" target="_blank" rel="noreferrer">Issue</a>.</p>
<div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> SubTask</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">cfg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SubTaskConfig</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">......</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">workerName </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">validator </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">syncer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">DataValidator</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
</div></li>
<li>
<p><strong>How does it be created.</strong> The mainly places to generate subTask from task is in <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/master/openapi_controller.go#L386" target="_blank" rel="noreferrer">OpenAPITaskToSubTaskConfigs</a> and <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/master/server.go#L510" target="_blank" rel="noreferrer">StartTask</a>. Noticable, not just the only two, but also <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/master/server.go#L725" target="_blank" rel="noreferrer">UpdateTask</a>. But we're just foucsing on normally where it comes from. So, you can explore it by yourself if you're interested in.</p>
</li>
</ol>
<h2 id="sourceworker" tabindex="-1">SourceWorker <a class="header-anchor" href="#sourceworker" aria-label="Permalink to &quot;SourceWorker&quot;"></a></h2>
<ol>
<li>
<p><strong>What does it responsible for.</strong> SourceWorker manages a source(upstream) which is mainly related to subtasks and relay. It has lots of functions such as <code>updateSourceStatus</code>, <code>fetchSubTasksAndAdjust</code>, <code>operateRelay</code> and <code>PurgeRelay</code> ..., we can see what the functionality is.</p>
</li>
<li>
<p><strong>How does it work.</strong> Just focusing on the main part(StartSubTask), I think, of SourceWorker functionalities. As mentioned before, when one DM Worker has been started, it'd gotten subTask config and Bound relationship by requesting to etcd. So following the calling chain of <code>EnableHandleSubtasks--&gt;w.StartSubTask--&gt;st.Run--&gt;initUnits--&gt;createUnits</code>, a working logic will be showed clearly. And, in <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/worker/subtask.go#L52" target="_blank" rel="noreferrer">func createRealUnits</a>, there're some steps to adjust wether <code>ModeAll</code> or <code>ModeIncrement</code>. PLZ learn it by yourself if very interested in.</p>
</li>
</ol>
<h2 id="syncer" tabindex="-1">Syncer <a class="header-anchor" href="#syncer" aria-label="Permalink to &quot;Syncer&quot;"></a></h2>
<p>I've gotta say <code>Syncer</code> is the most important component of DM Worker, or even DM. So, It was splited into a single content to explain how it works. At <a href="./05TiDB-DM syncer.html">here</a>.</p>
]]></content:encoded>
            <enclosure url="https://askaric.com/images/tidb/05TiDB-EcosystematicTools/5-4DM/03-DM_Worker_Components.jpeg" length="0" type="image/jpeg"/>
        </item>
        <item>
            <title><![CDATA[DM syncer]]></title>
            <link>https://askaric.com/en/work/tidb/TiDB-EcosystematicTools/5-4DM/05TiDB-DM syncer.html</link>
            <guid>https://askaric.com/en/work/tidb/TiDB-EcosystematicTools/5-4DM/05TiDB-DM syncer.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[What's syncer
1. Syncer can sync your MySQL data to another MySQL database.
    
 Pessimist
1. I've ]]></description>
            <content:encoded><![CDATA[<h1 id="dm-syncer" tabindex="-1">DM syncer <a class="header-anchor" href="#dm-syncer" aria-label="Permalink to &quot;DM syncer&quot;"></a></h1>
<h2 id="what-s-syncer" tabindex="-1">What's syncer <a class="header-anchor" href="#what-s-syncer" aria-label="Permalink to &quot;What's syncer&quot;"></a></h2>
<ol>
<li>
<p>Syncer can sync your MySQL data to another MySQL database.</p>
<figure><img src="./../../../../../images/tidb/05TiDB-EcosystematicTools/5-4DM/03-DM_Worker_Components.jpeg" alt="DM_Worker_Components" tabindex="0"><figcaption>DM_Worker_Components</figcaption></figure>
</li>
</ol>
<h2 id="pessimist" tabindex="-1">Pessimist <a class="header-anchor" href="#pessimist" aria-label="Permalink to &quot;Pessimist&quot;"></a></h2>
<ol>
<li>
<p>I've talked a little bit what the worker does in the pessmistic DDL machinism, PTAL at <a href="./03TiDB-DM Master.html">the pessmist content</a> first in DM Master.</p>
</li>
<li>
<p>From this <code>DM Syncer Main Steps</code> part of DM worker, we can see the syncer inside of DM Worker just put his DDL info and watch operation generated by DM Master, then put the query job to the <code>DDL job queue</code> if it's the owner of DDL Lock. It's pretty simple to do the work DM worker should do.</p>
</li>
</ol>
<h2 id="optimist" tabindex="-1">Optimist <a class="header-anchor" href="#optimist" aria-label="Permalink to &quot;Optimist&quot;"></a></h2>
<ol>
<li>
<p>Also PLZ take a look on the one I've written <a href="./../5-4DM/03TiDB-DM Master.html">here</a>, all because you may be confused without the pre-reading. Mostly there're relevent.</p>
</li>
<li>
<p>The pic on the top of this page, the only different processing step is just <code>switch op.ConflictStage</code> after <code>GetOperation</code>, though. They put totaly different info to etcd between pessmist and and optimist. I mean, after puting info to DM Master in optimist, DM Worker get and justify if there's conflict and to deal with next steps in a different way. At <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/ddl.go#L883" target="_blank" rel="noreferrer">here</a> after adjusting conflict, what DM Worker actually get is gotten from DM Master.</p>
</li>
</ol>
<h2 id="streamcontroller" tabindex="-1">streamController <a class="header-anchor" href="#streamcontroller" aria-label="Permalink to &quot;streamController&quot;"></a></h2>
<ol>
<li>
<p>StreamerController including some items like <code>retryStrategy</code>, <code>syncCfg</code>, <code>fromDB</code> and so on in <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/binlogstream/streamer_controller.go#L131" target="_blank" rel="noreferrer">it's struct</a>, controls the streamer for read binlog, include reset streamer to a binlog position or GTID, read next binlog event, transfer from local streamer to remote streamer.</p>
</li>
<li>
<p>From the interface of <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/binlogstream/streamer_controller.go#L54-L83" target="_blank" rel="noreferrer"><code>GenerateStreamFrom</code></a> and <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/binlogstream/streamer_controller.go#L337" target="_blank" rel="noreferrer">func GetEvent</a>, can see it encapsulates status info of getting MySQL Binlog to the next one Event continuously.</p>
</li>
</ol>
<h2 id="runningloop" tabindex="-1">RunningLoop <a class="header-anchor" href="#runningloop" aria-label="Permalink to &quot;RunningLoop&quot;"></a></h2>
<ol>
<li>
<p>Actually, <code>RunnLoop</code> is a name I created and it should be <code>func (s *Syncer) Run</code>. The reason I changed the name is make it more meaningful, because the key logic refer to <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/syncer.go#L1968-L1969" target="_blank" rel="noreferrer">this for-loop</a> I've refered to inside the 694-rows-function.</p>
</li>
<li>
<p>As the pic showed, streamController will continuously send MySQL Binlog and the running dealing with everyone by <code>handleRotateEvent</code>,<code>HandleQueryEvent</code> and so on. I think that's the most important.</p>
</li>
<li>
<p>Inside <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/syncer.go#L2535" target="_blank" rel="noreferrer">func handleRowsEvent</a>, there're too many event defined by MySQL and DM just needs to transform part of them, like <code>UPDATE_ROWS_EVENT</code>,<code>DELETE_ROWS_EVENT</code>,<code>WRITE_ROWS_EVENT</code> and so on. Syncer could be able to do that by <a href="https://github.com/go-mysql-org/go-mysql" target="_blank" rel="noreferrer">the package mysql-go</a> and some event defining info you can get at <a href="https://dev.mysql.com/doc/dev/mysql-server/latest/page_protocol_replication_binlog_event.html" target="_blank" rel="noreferrer">the page_protocol_replication_binlog_event</a>.</p>
</li>
</ol>
<h2 id="syncdml" tabindex="-1">syncDML <a class="header-anchor" href="#syncdml" aria-label="Permalink to &quot;syncDML&quot;"></a></h2>
<ol>
<li>
<p>What this <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/syncer.go#L1534" target="_blank" rel="noreferrer">func</a> does is just gets dmlJob continuously from dmlJobCh, and outputs it to compactor or causality. It varies according to if you configed <code>compact</code> as true, which's a tuning to accelerate the replicating speed. The <a href="https://docs.pingcap.com/zh/tidb/stable/dm-dml-replication-logic#compactor" target="_blank" rel="noreferrer">compact</a> is a new feature, which's used to compact some DMLs into only one DML, like : <code>INSERT + UPDATE =&gt; INSERT</code>, <code>INSERT + DELETE =&gt; DELETE</code>, etc. As we all know, some queries like <code>insert into XXX values (),() ...;</code> is pretty fast than the format like <code>insert into XXX values(); insert into XXX values(); ...</code> .</p>
</li>
<li>
<p>Meanwhile, the <code>Causality</code> couldn't be ignored, because the functionality is used to detect DML conflict instead of just replicating DML orderly„ÄÇMore info about the parallel algorithm of Causality at <a href="https://cn.pingcap.com/blog/tidb-binlog-source-code-reading-8#%E5%B9%B6%E8%A1%8C%E6%89%A7%E8%A1%8CDML" target="_blank" rel="noreferrer">this blog</a>, in short, every event'll be dispatched to different group of <code>Causality Tree</code> by PK or UK, if the key of later event has a conflict with the former. Such as the conflict could be <code>Event-1 : INSERT INTO table_name (pk, uk) VALUES (1, 2);</code> and <code>Event-4 : DELETE FROM table_name WHERE pk = 1;</code> must be executed in time order, vice versa, there'll be a conflict. DM, in that way, could able to sync DML parallely between different groups of <code>Causality Tree</code>. So, if Causality's detected any conflit, there must fistly sync queries already existed in the group to downstream(TiDB Cluster).</p>
</li>
</ol>
<h2 id="syncddl" tabindex="-1">syncDDL <a class="header-anchor" href="#syncddl" aria-label="Permalink to &quot;syncDDL&quot;"></a></h2>
<ol>
<li>
<p>IMHO, It's just a dispath component func which's aiming for DDL shard logic and record metrics. if be configured as <code>ShardPessimistic</code>,</p>
</li>
<li>
<p>Inside the <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/syncer.go#L1356" target="_blank" rel="noreferrer">func syncDDL</a>. It'll check config mode of <a href="https://docs.pingcap.com/tidb/stable/dm-shard-merge#configure-parameters" target="_blank" rel="noreferrer">shardMode</a> to do total different behaviours. For pessimistÔºåPLZ look <a href="#pessimist">the pessimist component in syncer</a> and <a href="./03TiDB-DM Master.html">the pessimist component in DM Masrer</a>. While, for optimist, PLZ look <a href="./03TiDB-DM Master.html">the optimist component in DM Masrer</a> and <a href="#optimist">the optimist component in syncer</a>. I think it's the most complex and important logic in the entire DM.</p>
</li>
</ol>
<h2 id="ddlworker" tabindex="-1">DDLWorker <a class="header-anchor" href="#ddlworker" aria-label="Permalink to &quot;DDLWorker&quot;"></a></h2>
<ol>
<li>
<p>Well, It's just a component to do work about DDL, also there're some key functions such as <code>HandleQueryEvent</code>, <code>skipQueryEvent</code>, <code>processOneDDL</code> and <code>handleDDL</code> of normal DDL, Optimist DDL and Pessimist DDL.</p>
</li>
<li>
<p>While, <code>HandleQueryEvent</code> connects the functions I metioned above. It'll record metrics and be responsible for split the type of DDL compacted multi DDLs in one SQL into some single ddls. because , until now, TiDB doesn't support the <a href="https://docs.pingcap.com/tidb/stable/dm-faq#if-a-statement-executed-upstream-contains-multiple-ddl-operations-does-dm-support-such-migration" target="_blank" rel="noreferrer">one</a>.</p>
</li>
</ol>
<h2 id="dmlworker" tabindex="-1">DMLWorker <a class="header-anchor" href="#dmlworker" aria-label="Permalink to &quot;DMLWorker&quot;"></a></h2>
<ol>
<li>
<p>Also the main functions are <code>dmlWorkerWrap</code>, <code>sendJobToAllDmlQueue</code>, <code>executeJobs</code>, <code>genSQLs</code>. DM has one config parameter named <a href="https://docs.pingcap.com/zh/tidb/stable/dm-tune-configuration#worker-count" target="_blank" rel="noreferrer">worker-count</a> accelerated DML replication speed. At <code>dmlWorkerWrap</code>, the step creates the number of the worker-count as concurrency to sync DMLs. DMLs were splited by <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/dml_worker.go#L138" target="_blank" rel="noreferrer">hashing every DML Key</a> inside <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/dml_worker.go#L101" target="_blank" rel="noreferrer">func run</a>. By that, every queue executes in a batch way with parameter of <a href="https://docs.pingcap.com/tidb/stable/dm-tune-configuration#batch" target="_blank" rel="noreferrer">DM batch</a>. In short, DMLWorker transforms job into SQL and flush them into downstream.</p>
</li>
<li>
<p>More details you can find at <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/dml_worker.go#L33" target="_blank" rel="noreferrer">here</a>.</p>
</li>
</ol>
<h2 id="checkpointworker" tabindex="-1">checkpointWorker <a class="header-anchor" href="#checkpointworker" aria-label="Permalink to &quot;checkpointWorker&quot;"></a></h2>
<ol>
<li>
<p>Well, checkPoint represents checkpoints status for syncer including global binlog's checkpoint and every table's checkpoint, when save checkpoint, we must differ saving in memory from saving (flushing) to DB (or file) permanently. for sharding merging, we must save checkpoint in memory to support skip when re-syncing for the special streamer, but before all DDLs for a sharding group to be synced and executed, we should not save checkpoint permanently. Because, when restarting to continue the sync, all sharding DDLs must try-sync again. Here's the key <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/checkpoint.go#L227" target="_blank" rel="noreferrer">interface</a> for you to know how it does work.</p>
</li>
<li>
<p>In Syncer, <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/syncer.go#L1187" target="_blank" rel="noreferrer">flushCheckPoints</a> and <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/syncer.go#L1223" target="_blank" rel="noreferrer">flushCheckPointsAsync</a> call <code>checkpointFlushWorker.Add(task)</code> to push checkpoint task into checkpointWorker. There's also a loop <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/checkpoint_flush_worker.go#L91" target="_blank" rel="noreferrer">func Run</a> to dispatch into sync/async logic and flush global checkpint using FlushPointsExcept into downstream checkpoint-table permantly. Untill now, async flush checkpoint hasn't been released, more info at the <a href="https://github.com/pingcap/tiflow/blob/master/dm/docs/RFCS/20211012_async_checkpoint_flush.md" target="_blank" rel="noreferrer">RFC</a>.</p>
</li>
<li>
<p>There're four scenarios needing to flush checkpoint. A half of them are included in <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/syncer.go#L1048" target="_blank" rel="noreferrer">func handleJob</a>, and the others are in <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/syncer.go#L1654" target="_blank" rel="noreferrer">func Syncer.Run</a>.<br>
a. <strong>DDL executed</strong> : when every DDL exists in DM, the flushing action'll be triggered at <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/syncer.go#L1101-L1142" target="_blank" rel="noreferrer">func handleJob</a>.<br>
b. <strong>pausing / stopping the sync (driven by <code>s.flushJobs</code>)</strong> : flush all jobs before exit, at <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/syncer.go#L1870" target="_blank" rel="noreferrer">func s.flushJobs()</a>. Or there's any error solving using <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/syncer.go#L2174-L2203" target="_blank" rel="noreferrer">skip-error methord</a>.<br>
c. <strong>IsFreshTask return true</strong> : if streamController successfully started or the Mode configed as <code>ALL</code>, the checkpoint loaded from the dump metafile should be flushed.<br>
d. <strong>Heartbeat event received</strong> : At <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/syncer.go#L1030" target="_blank" rel="noreferrer">func flushIfOutdated</a>, when every event from MySQL Binlog is dispatched into DML Job queues, <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/syncer.go#L2614" target="_blank" rel="noreferrer">here</a>.</p>
</li>
<li>
<p>In short, checkpoint is an item to make sure the final consistency in data replication. What I mean is the one let DM could be able to continuous replicate after recovering from error, though, if there's any error.</p>
</li>
</ol>
]]></content:encoded>
            <enclosure url="https://askaric.com/images/tidb/05TiDB-EcosystematicTools/5-4DM/03-DM_Worker_Components.jpeg" length="0" type="image/jpeg"/>
        </item>
        <item>
            <title><![CDATA[Metrics]]></title>
            <link>https://askaric.com/en/work/tidb/TiDB-EcosystematicTools/5-4DM/06TiDB-DM Metrics.html</link>
            <guid>https://askaric.com/en/work/tidb/TiDB-EcosystematicTools/5-4DM/06TiDB-DM Metrics.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[# Metrics

## Overview

## operate error

## HA

1. **number of dm-masters start leader components per minute**  
    **a. Meaning** : number of dm-masters try to start leader components per minute
    **b. Colculation** :

2. **number of workers in different state**  
    **a. Meaning** : number of workers in different state
    **b. Colculation** :

3. **workers' state**  
    **a. Meaning** : workers' state  
    **b. Colculation** :

4. **number of worker event error**  
    **a. Meaning** : number of worker event error  
    **b. Colculation** :

5. **shard ddl error per minute**  
    **a. Meaning** : number of shard DDL lock/operation error in one minute  
    **b. Colculation** : In `pressimism`,

6. . **number of pending shard ddl**  
    **a. Meaning** : number of pending shard DDL in different states, Un-synced (waiting all upstream), Synced (all upstream finished, waiting all downstream). It has three different types of DDL job, including `None`, `Un-synced`, `Synced`. The metrics will change the one type when every new Lock generates(`None` --> `Un-synced`, like `NewLock` in [pessimism](https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/pkg/shardddl/pessimism/lock.go#L45)) or releases(`Un-synced` --> `Synced`).  
    **b. Colculation** : In `pressimism`, when every etcd-input trigged by DM-Workers is captured, if `remian of Lock >0`,which means there are at least one source who hasn't received the DDL from MySQL Binlog, the "OperationPut - LockUnSyncedError" will be added,[details at here](https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/master/shardddl/pessimist.go#L525). if the DDL lock has synced ,first it will be marked as done and try to remove the operation for the source, meanwhile, if the delete failed, a "OperationPut - RemoveLockError" will be added, [more detail](https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/master/shardddl/pessimist.go#L538). In `pressimism`,

## task

1. **task state**  
    **a. Meaning** :The current state of the subtask in the instance  
    **b. Colculation** :  

## load dump files

1. **load progress**  
    **a. Meaning** : The data import process percentage of Loader. The value range is 0% ~ 100%.
    **b. Colculation** :

2. **data file size**  
    **a. Meaning** : The total size of the data files in the full data imported by Loader (including the `INSERT INTO` statement).
    **b. Colculation** :

3. **dump process exits with error**  
    **a. Meaning** : Dumper encounters an error within the DM-worker and exits.
    **b. Colculation** :

4. **load process exits with error**  
    **a. Meaning** : Loader encounters an error within the DM-worker and exits.
    **b. Colculation** :

5. **table count**  
    **a. Meaning** : The total number of tables in the full data imported by Loader.
    **b. Colculation** :

6. **data file count**  
    **a. Meaning** : The total number of data files in the full data imported by Loader (including the `INSERT INTO` statement).
    **b. Colculation** :

7. **transaction execution latency**  
    **a. Meaning** : The duration that Loader executes a transaction (in seconds).
    **b. Colculation** :

8. **statement execution latency - 90**  
    **a. Meaning** : The time it takes loader to execute every statement to the downstream (in seconds).
    **b. Colculation** :

## binlog replication

1. **remaining time to sync**  
    **a. Meaning** :  
    **b. Colculation** : it's calculated by expr below:  

    ```yaml
                        remainingSize =
    remainingSeconds = ]]></description>
            <content:encoded><![CDATA[<h1 id="metrics" tabindex="-1">Metrics <a class="header-anchor" href="#metrics" aria-label="Permalink to &quot;Metrics&quot;"></a></h1>
<h2 id="overview" tabindex="-1">Overview <a class="header-anchor" href="#overview" aria-label="Permalink to &quot;Overview&quot;"></a></h2>
<h2 id="operate-error" tabindex="-1">operate error <a class="header-anchor" href="#operate-error" aria-label="Permalink to &quot;operate error&quot;"></a></h2>
<h2 id="ha" tabindex="-1">HA <a class="header-anchor" href="#ha" aria-label="Permalink to &quot;HA&quot;"></a></h2>
<ol>
<li>
<p><strong>number of dm-masters start leader components per minute</strong><br>
<strong>a. Meaning</strong> : number of dm-masters try to start leader components per minute
<strong>b. Colculation</strong> :</p>
</li>
<li>
<p><strong>number of workers in different state</strong><br>
<strong>a. Meaning</strong> : number of workers in different state
<strong>b. Colculation</strong> :</p>
</li>
<li>
<p><strong>workers' state</strong><br>
<strong>a. Meaning</strong> : workers' state<br>
<strong>b. Colculation</strong> :</p>
</li>
<li>
<p><strong>number of worker event error</strong><br>
<strong>a. Meaning</strong> : number of worker event error<br>
<strong>b. Colculation</strong> :</p>
</li>
<li>
<p><strong>shard ddl error per minute</strong><br>
<strong>a. Meaning</strong> : number of shard DDL lock/operation error in one minute<br>
<strong>b. Colculation</strong> : In <code>pressimism</code>,</p>
</li>
<li>
<p>. <strong>number of pending shard ddl</strong><br>
<strong>a. Meaning</strong> : number of pending shard DDL in different states, Un-synced (waiting all upstream), Synced (all upstream finished, waiting all downstream). It has three different types of DDL job, including <code>None</code>, <code>Un-synced</code>, <code>Synced</code>. The metrics will change the one type when every new Lock generates(<code>None</code> --&gt; <code>Un-synced</code>, like <code>NewLock</code> in <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/pkg/shardddl/pessimism/lock.go#L45" target="_blank" rel="noreferrer">pessimism</a>) or releases(<code>Un-synced</code> --&gt; <code>Synced</code>).<br>
<strong>b. Colculation</strong> : In <code>pressimism</code>, when every etcd-input trigged by DM-Workers is captured, if <code>remian of Lock &gt;0</code>,which means there are at least one source who hasn't received the DDL from MySQL Binlog, the &quot;OperationPut - LockUnSyncedError&quot; will be added,<a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/master/shardddl/pessimist.go#L525" target="_blank" rel="noreferrer">details at here</a>. if the DDL lock has synced ,first it will be marked as done and try to remove the operation for the source, meanwhile, if the delete failed, a &quot;OperationPut - RemoveLockError&quot; will be added, <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/master/shardddl/pessimist.go#L538" target="_blank" rel="noreferrer">more detail</a>. In <code>pressimism</code>,</p>
</li>
</ol>
<h2 id="task" tabindex="-1">task <a class="header-anchor" href="#task" aria-label="Permalink to &quot;task&quot;"></a></h2>
<ol>
<li><strong>task state</strong><br>
<strong>a. Meaning</strong> :The current state of the subtask in the instance<br>
<strong>b. Colculation</strong> :</li>
</ol>
<h2 id="load-dump-files" tabindex="-1">load dump files <a class="header-anchor" href="#load-dump-files" aria-label="Permalink to &quot;load dump files&quot;"></a></h2>
<ol>
<li>
<p><strong>load progress</strong><br>
<strong>a. Meaning</strong> : The data import process percentage of Loader. The value range is 0% ~ 100%.
<strong>b. Colculation</strong> :</p>
</li>
<li>
<p><strong>data file size</strong><br>
<strong>a. Meaning</strong> : The total size of the data files in the full data imported by Loader (including the <code>INSERT INTO</code> statement).
<strong>b. Colculation</strong> :</p>
</li>
<li>
<p><strong>dump process exits with error</strong><br>
<strong>a. Meaning</strong> : Dumper encounters an error within the DM-worker and exits.
<strong>b. Colculation</strong> :</p>
</li>
<li>
<p><strong>load process exits with error</strong><br>
<strong>a. Meaning</strong> : Loader encounters an error within the DM-worker and exits.
<strong>b. Colculation</strong> :</p>
</li>
<li>
<p><strong>table count</strong><br>
<strong>a. Meaning</strong> : The total number of tables in the full data imported by Loader.
<strong>b. Colculation</strong> :</p>
</li>
<li>
<p><strong>data file count</strong><br>
<strong>a. Meaning</strong> : The total number of data files in the full data imported by Loader (including the <code>INSERT INTO</code> statement).
<strong>b. Colculation</strong> :</p>
</li>
<li>
<p><strong>transaction execution latency</strong><br>
<strong>a. Meaning</strong> : The duration that Loader executes a transaction (in seconds).
<strong>b. Colculation</strong> :</p>
</li>
<li>
<p><strong>statement execution latency - 90</strong><br>
<strong>a. Meaning</strong> : The time it takes loader to execute every statement to the downstream (in seconds).
<strong>b. Colculation</strong> :</p>
</li>
</ol>
<h2 id="binlog-replication" tabindex="-1">binlog replication <a class="header-anchor" href="#binlog-replication" aria-label="Permalink to &quot;binlog replication&quot;"></a></h2>
<ol>
<li>
<p><strong>remaining time to sync</strong><br>
<strong>a. Meaning</strong> :<br>
<strong>b. Colculation</strong> : it's calculated by expr below:</p>
<div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                    remainingSize =</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">remainingSeconds = ---------------------------------------------------------------</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                    bytesPerSec  =  (totalBinlogSize - lastBinlogSize) / seconds</span></span></code></pre>
</div></li>
<li>
<p><strong>replicate lag</strong><br>
<strong>a. Meaning</strong> : The latency time it takes to replicate the binlog from master to Syncer (in seconds)<br>
<strong>b. Colculation</strong> : In this <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/syncer.go#L890" target="_blank" rel="noreferrer">func updateReplicationLagMetric</a>, the metric is updated by ticking per 100ms. the <code>lag</code> is calculated in an expression of <code>time.Now().Unix() - s.tsOffset.Load() - headerTS</code>. which <code>tsOffset</code> represents time range between upstream and syncer, DM's timestamp - MySQL's timestamp, and <code>headerTS</code> is minior timestamp,which is binlog <code>EventHeader Timestamp</code> parsed by <a href="https://github.com/go-mysql-org/go-mysql/tree/master/replication" target="_blank" rel="noreferrer">go-mysql-org/go-mysql/replication</a>, of every DM worker MySQL.</p>
</li>
<li>
<p><strong>process exits with error</strong><br>
<strong>a. Meaning</strong> : The binlog replication unit process encounters an error within the DM-worker and exits<br>
<strong>b. Colculation</strong> : 1</p>
</li>
<li>
<p><strong>binlog file gap between master and syncer</strong><br>
<strong>a. Meaning</strong> : The number of binlog files in binlog replication unit that are behind the master.<br>
<strong>b. Colculation</strong> : <strong>For <code>master</code></strong>,</p>
</li>
<li>
<p><strong>binlog file gap between relay and syncer</strong></p>
</li>
<li>
<p><strong>binlog event QPS</strong></p>
</li>
<li>
<p><strong>skipped binlog event QPS</strong></p>
</li>
<li>
<p><strong>read binlog event duration</strong></p>
</li>
<li>
<p><strong>transform binlog event duration</strong><br>
<strong>a. Meaning</strong> : The time it takes binlog replication unit to parse and transform the binlog into SQL statements (in seconds)<br>
<strong>b. Colculation</strong> : At <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/syncer.go#L1504" target="_blank" rel="noreferrer">func successFunc</a>, every job will have calculated the duration in DDLWorker and DMLWorker executing <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/dml_worker.go#L200" target="_blank" rel="noreferrer">func executeBatchJobs</a>, since raw binlog had tranformed into Syncer dealing loop function. And It has 90%, 95% and 99% quantile curve.</p>
</li>
<li>
<p><strong>dispatch binlog event duration</strong></p>
</li>
<li>
<p><strong>transaction execution latency</strong></p>
</li>
<li>
<p><strong>binlog event size</strong><br>
<strong>a. Meaning</strong> : The size of a single binlog event that the binlog replication unit reads from relay log or upstream master.<br>
<strong>b. Colculation</strong> : At <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/syncer.go#L2159" target="_blank" rel="noreferrer">here</a>, Syncer'll record every binlog event_size in event header from <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/binlogstream/streamer_controller.go#L131" target="_blank" rel="noreferrer">binlogstream</a>. So, in grafana, DM uses a type of histogram to draw a quantile curve, including 90%, 95%, 99%.</p>
</li>
<li>
<p><strong>DML queue remain length</strong><br>
<strong>a. Meaning</strong> : The remain length of DML job queues, which have <code>causality_input</code>, <code>compactor_input</code>, <code>dml_worker_input</code>, <code>q_number</code>,number is calculated in <code>queueID%defaultBucketCount</code>.<br>
<strong>b. Colculation</strong> : <strong>For <code>causality_input</code></strong> : Causality provides a simple mechanism to improve the concurrency of SQLs execution under the premise of ensuring correctness, which groups sqls that maybe contain causal relationships, and syncer executes them linearly, <a href="https://github.com/pingcap/tiflow/blob/211e6e7d5fa0944d1f5e0ad585cb8549d5604395/dm/docs/RFCS/20211012_async_checkpoint_flush.md#causality-optimization" target="_blank" rel="noreferrer">more details</a>. So, it records the number of causality component is keeping about rows.  <strong>For <code>dml_worker_input</code></strong> : which means how many jobs were sent to DMWorker. <strong>For <code>compactor_input</code></strong> : it'll equal to the function of causality_input if you config <a href="https://docs.pingcap.com/zh/tidb/v6.6/dm-dml-replication-logic#compactor" target="_blank" rel="noreferrer">this feature</a>. <strong>For <code>q_number</code></strong> : all DMLs at <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/dml_worker.go#L100" target="_blank" rel="noreferrer">here</a> will be distributed into different queues(default 8) and when they are executed in <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/dml_worker.go#L159" target="_blank" rel="noreferrer">DMLWorker's executeJobs</a>, it'll be recorded by the queue name.</p>
</li>
<li>
<p><strong>total SQL jobs</strong><br>
<strong>a. Meaning</strong> : Is waiting shard DDL lock to be resolved, &gt;0 means waiting.<br>
<strong>b. Colculation</strong> :</p>
</li>
<li>
<p><strong>finished SQL jobs</strong><br>
<strong>a. Meaning</strong> : The number of finished jobs per unit of time.<br>
<strong>b. Colculation</strong> :</p>
</li>
<li>
<p><strong>statement execution latency - 90</strong><br>
<strong>a. Meaning</strong> : The time it takes binlog replication unit to execute every statement to the downstream (in seconds).<br>
<strong>b. Colculation</strong> :</p>
</li>
<li>
<p><strong>add job duration</strong><br>
<strong>a. Meaning</strong> : The time it takes binlog replication unit to add a job to the queue (in seconds).<br>
<strong>b. Colculation</strong> :</p>
</li>
<li>
<p><strong>DML conflict detect duration</strong><br>
<strong>a. Meaning</strong> : The time it takes binlog replication unit to detect conflicts between DMLs (in seconds).<br>
<strong>b. Colculation</strong> :</p>
</li>
<li>
<p><strong>skip event duration</strong><br>
<strong>a. Meaning</strong> : The time it takes binlog replication unit to skip a binlog event (in seconds).<br>
<strong>b. Colculation</strong> :</p>
</li>
<li>
<p><strong>unsynced tables</strong><br>
<strong>a. Meaning</strong> : The number of unsynced tables in the subtask.<br>
<strong>b. Colculation</strong> : Also at <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/ddl.go#L567" target="_blank" rel="noreferrer">here</a>, It shows that after the <code>ShardingGroupKeeper's TrySync</code> function, if it's related to sharding group tables repliation, the metrics'll be update only when you use pessmistic strategy.</p>
</li>
<li>
<p><strong>shard lock resolving</strong><br>
<strong>a. Meaning</strong> : Is waiting shard DDL lock to be resolved, &gt;0 means waiting.<br>
<strong>b. Colculation</strong> : This metrics is meaningful only when DM uses pessmistic shard strategy to sync a group of tables into one. At <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/ddl.go#L632" target="_blank" rel="noreferrer">here</a>, the Guage'll plus one which means the worker is blocking and waitting for DDL lock to be synced. And there'll create another goroutine to watch the <code>PUT</code> operation. I mean the stage of resolving is gonna be closed(actually It does the minus operation in the Guage).</p>
</li>
<li>
<p><strong>heartbeat update error</strong><br>
<strong>a. Meaning</strong> : Number of error happens when update heartbeat.<br>
<strong>b. Colculation</strong> :</p>
</li>
</ol>
<h2 id="relay-log" tabindex="-1">relay log <a class="header-anchor" href="#relay-log" aria-label="Permalink to &quot;relay log&quot;"></a></h2>
<ol>
<li>
<p><strong>storage capacity</strong><br>
<strong>a. Meaning</strong> : The storage capacity of the disk occupied by the relay log.<br>
<strong>b. Colculation</strong> :</p>
</li>
<li>
<p><strong>storage remain</strong><br>
<strong>a. Meaning</strong> : The remaining storage capacity of the disk occupied by the relay log.<br>
<strong>b. Colculation</strong> :</p>
</li>
<li>
<p><strong>process exits with error</strong><br>
<strong>a. Meaning</strong> : The relay log encounters an error within the DM-worker and exits.<br>
<strong>b. Colculation</strong> :</p>
</li>
<li>
<p><strong>relay log data corruption</strong><br>
<strong>a. Meaning</strong> : The number of corrupted relay log files.<br>
<strong>b. Colculation</strong> :</p>
</li>
<li>
<p><strong>fail to read binlog from master</strong><br>
<strong>a. Meaning</strong> : The number of errors encountered when the relay log reads the binlog from the upstream MySQL.<br>
<strong>b. Colculation</strong> :</p>
</li>
<li>
<p><strong>fail to write relay log</strong><br>
<strong>a. Meaning</strong> : The number of errors encountered when the relay log writes the binlog to disks.<br>
<strong>b. Colculation</strong> :</p>
</li>
<li>
<p><strong>write relay log duration</strong><br>
<strong>a. Meaning</strong> : The duration that the relay log writes binlog event into the disks each time (in seconds).<br>
<strong>b. Colculation</strong> :</p>
</li>
<li>
<p><strong>binlog file gap between master and relay</strong><br>
<strong>a. Meaning</strong> : The number of binlog files in the relay log that are behind the upstream master.<br>
<strong>b. Colculation</strong> :</p>
</li>
<li>
<p><strong>binlog pos</strong><br>
<strong>a. Meaning</strong> : The write offset of the latest relay log file.<br>
<strong>b. Colculation</strong> :</p>
</li>
<li>
<p><strong>read binlog event duration</strong><br>
<strong>a. Meaning</strong> : The duration that the relay log reads binlog event from the upstream MySQL (in seconds).<br>
<strong>b. Colculation</strong> :</p>
</li>
<li>
<p><strong>binlog event size</strong><br>
<strong>a. Meaning</strong> : The size of a single binlog event that the relay log writes into the disks.<br>
<strong>b. Colculation</strong> :</p>
</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[TiDB-Lightning Quick Start]]></title>
            <link>https://askaric.com/en/work/tidb/TiDB-EcosystematicTools/5-7TiDB-Lightning/01Quick Start.html</link>
            <guid>https://askaric.com/en/work/tidb/TiDB-EcosystematicTools/5-7TiDB-Lightning/01Quick Start.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[123]]></description>
            <content:encoded><![CDATA[<h1 id="tidb-lightning-quick-start" tabindex="-1">TiDB-Lightning Quick Start <a class="header-anchor" href="#tidb-lightning-quick-start" aria-label="Permalink to &quot;TiDB-Lightning Quick Start&quot;"></a></h1>
<h2 id="_123" tabindex="-1">123 <a class="header-anchor" href="#_123" aria-label="Permalink to &quot;123&quot;"></a></h2>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[TiDB-Lighting Architecture]]></title>
            <link>https://askaric.com/en/work/tidb/TiDB-EcosystematicTools/5-7TiDB-Lightning/02Lighting Architecture.html</link>
            <guid>https://askaric.com/en/work/tidb/TiDB-EcosystematicTools/5-7TiDB-Lightning/02Lighting Architecture.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[1. Overview
1. If you wanna some older things or designs about TiDB-Lighting, and now It's been merg]]></description>
            <content:encoded><![CDATA[<h1 id="tidb-lighting-architecture" tabindex="-1">TiDB-Lighting Architecture <a class="header-anchor" href="#tidb-lighting-architecture" aria-label="Permalink to &quot;TiDB-Lighting Architecture&quot;"></a></h1>
<h2 id="_1-overview" tabindex="-1">1. Overview <a class="header-anchor" href="#_1-overview" aria-label="Permalink to &quot;1. Overview&quot;"></a></h2>
<ol>
<li>
<p>If you wanna some older things or designs about <a href="https://github.com/pingcap/tidb-lightning" target="_blank" rel="noreferrer">TiDB-Lighting</a>, and now It's been merged into <a href="https://github.com/pingcap/tidb/tree/master/br/cmd/tidb-lightning" target="_blank" rel="noreferrer">BR as the part of  TiDB repo</a>.</p>
</li>
<li>
<p>Also tidb-lightning can be divided into two parts frontend and backend, more details from <a href="https://www.bilibili.com/video/BV1D5411L7z5/" target="_blank" rel="noreferrer">a video sharing</a>.</p>
<figure><img src="./../../../../../images/tidb/05TiDB-EcosystematicTools/5-7TiDB-Lightning/01tidb-lightning-arch.jpeg" alt="01tidb-lightning-arch" tabindex="0"><figcaption>01tidb-lightning-arch</figcaption></figure>
</li>
<li>
<p>Here's a simple steps to guide you how tidb-lightning runs. Inside the <code>run</code> function, every Options'll be executed steps by steps including a range of things code block below.</p>
<blockquote>
<p>Startup step Chain : main() --&gt; app.RunOnceWithOptions --&gt; lightning.run --&gt; restore.NewRestoreController --&gt; Controller.run.</p>
</blockquote>
<div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">opts </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> []</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">func</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">rc.setGlobalVariables,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">rc.restoreSchema,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">rc.preCheckRequirements,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">rc.initCheckpoint,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">rc.restoreTables,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">rc.fullCompact,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">rc.cleanCheckpoints,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
</div></li>
<li>
<p>Let's get started deeply on <code>preCheckRequirements</code>, <code>initCheckpoint</code>, <code>restoreTables</code> and <code>fullCompact</code>. Because, IMHO, It's the most useful for me/us to unsterstand how it works.</p>
</li>
</ol>
<h2 id="_2-main-steps" tabindex="-1">2. Main Steps <a class="header-anchor" href="#_2-main-steps" aria-label="Permalink to &quot;2. Main Steps&quot;"></a></h2>
<ol>
<li>
<p>For <code>preCheckRequirements</code>,</p>
</li>
<li>
<p>For <code>initCheckpoint</code>,</p>
<ul>
<li><a href="https://github.com/pingcap/tidb/blob/eb35c773b512e4e00c42caf7f04ea7397d00c127/br/pkg/lightning/checkpoints/checkpoints.go#L511" target="_blank" rel="noreferrer">type DB interface</a> is a key interface to be familiar with what functions the checkpoint have.</li>
</ul>
</li>
<li>
<p>For <code>restoreTables</code>, in short, it's the most important, pivotal to see how lightning does restore and responsible for somethings like <code>init concurrent thread pools</code>, <code>pause schedulers in PD</code>, <code>Restore engines</code> and so forth.</p>
<ul>
<li>The two parameters including table-concurrency and index-concurrency can take effect in both tidb-bakcend and local-backend mode.
<ul>
<li>table-concurrency : represent how many threads to import <strong>table data</strong> parallely inside the <a href="https://github.com/pingcap/tidb/blob/eb35c773b512e4e00c42caf7f04ea7397d00c127/br/pkg/lightning/restore/restore.go#L1440" target="_blank" rel="noreferrer">Controller.restoreTables</a>.</li>
<li>index-concurrency : the same as <code>table-concurrency</code> just serving for index parallely.</li>
</ul>
</li>
<li>If in local-backend mode, there're a couple of special operations needed to be done and compared with tidb-backend mode.
<ul>
<li><strong>firstly</strong>, <a href="https://github.com/pingcap/tidb/blob/eb35c773b512e4e00c42caf7f04ea7397d00c127/br/pkg/lightning/restore/restore.go#L1468-L1475" target="_blank" rel="noreferrer">pauses schedulers</a> existing in PD. And there's a tune named <code>CanPauseSchedulerByKeyRange</code>, after v6.1.0 version, which detects whether the scheduler can pause by the key range. If not, all existed schedulers in pd are gonna be deleted and saved in tidb-lightning, untill everthing is ok or tidb-lightning crashs, it'll be restored.</li>
<li><strong>Secondly</strong>, disables GC of tidb cluster by calling <code>tikv://PdAddr?disableGC=true</code>.</li>
<li><strong>Thirdly</strong>, builds a checksum handler encapsulated a db connection inside.</li>
</ul>
</li>
<li>The other logics inside the function are being shared by two tidb or local beckend mode. Builds threads in the number of <code>index-concurrency</code> to receive index tasks and in the same way to receive table tasks with <code>table-concurrency</code>. Every task including two key info <code>TableRestore</code> and <code>Checkpoint</code> will be constructed by looping every table in meta, be put to allTasks channel and be processed by the two pools.</li>
<li><a href="https://github.com/pingcap/tidb/blob/eb35c773b512e4e00c42caf7f04ea7397d00c127/br/pkg/lightning/restore/table_restore.go#L97" target="_blank" rel="noreferrer"><code>populateChunks</code></a> will split source files into region size in the concurrency of Max(region-concurrency, 2). In short there's an inside <a href="https://github.com/pingcap/tidb/blob/eb35c773b512e4e00c42caf7f04ea7397d00c127/br/pkg/lightning/mydump/region.go#L149" target="_blank" rel="noreferrer">fun MarkTableRegion</a> belonged to MyDump, which's responsible for creating a new source file region. <strong>So, if your sourfile is very big, It'll have a bad impact on concurrent executing</strong>. In this case, a warn message will be here called <code>file is too big to be processed efficiently; we suggest splitting it at 256 MB each ...</code>.</li>
<li>There're some some special and important processes all named postProcess needed to execute rebase-auto-id/checksum/analyze according to the task config inside the <a href="https://github.com/pingcap/tidb/blob/eb35c773b512e4e00c42caf7f04ea7397d00c127/br/pkg/lightning/restore/restore.go#L1574-L1584" target="_blank" rel="noreferrer">func Controller.restoreTables</a>. Untill all engines are already restored, the postProcesses will be executed in <code>table-concurrency</code> concurrently.</li>
</ul>
</li>
<li>
<p>For <code>fullCompact</code>, I've gotta say it's for an orginal problem which'll cause performance ingesting data, but now this feature has <strong>been deprecated</strong>. The <a href="https://github.com/pingcap/tidb-lightning/pull/119/commits" target="_blank" rel="noreferrer">&quot;do not do compact after engine file imported&quot;</a> pointed that TiKV had supported <code>auto compaction</code> during importing data. Since then, there was no need to do compaction. That means, in higher version , TiKV is capable of compacting during importing whatever local-backen or tidb-backend mode you are using.</p>
</li>
</ol>
<h2 id="_3-frontend-and-backend" tabindex="-1">3. Frontend and Backend <a class="header-anchor" href="#_3-frontend-and-backend" aria-label="Permalink to &quot;3. Frontend and Backend&quot;"></a></h2>
<h3 id="_3-1-frontend" tabindex="-1">3.1 Frontend <a class="header-anchor" href="#_3-1-frontend" aria-label="Permalink to &quot;3.1 Frontend&quot;"></a></h3>
<ul>
<li>
<p><a href="https://github.com/pingcap/tidb/blob/5d2030e1d19629b71811c3f14514bad7ed63261a/br/pkg/lightning/restore/table_restore.go#L494" target="_blank" rel="noreferrer">newChunkRestore</a> is gonna generate a parser to encode csv/sql/parquent into kvs.</p>
</li>
<li>
<p><a href="https://github.com/pingcap/tidb/blob/5d2030e1d19629b71811c3f14514bad7ed63261a/dumpling/export/ir.go#L16" target="_blank" rel="noreferrer">IR</a> represents an intermediate representation.</p>
</li>
</ul>
<h3 id="_3-2-backend" tabindex="-1">3.2 Backend <a class="header-anchor" href="#_3-2-backend" aria-label="Permalink to &quot;3.2 Backend&quot;"></a></h3>
<h2 id="_4-parameters" tabindex="-1">4. Parameters <a class="header-anchor" href="#_4-parameters" aria-label="Permalink to &quot;4. Parameters&quot;"></a></h2>
]]></content:encoded>
            <enclosure url="https://askaric.com/images/tidb/05TiDB-EcosystematicTools/5-7TiDB-Lightning/01tidb-lightning-arch.jpeg" length="0" type="image/jpeg"/>
        </item>
        <item>
            <title><![CDATA[CDC Component in TiKV]]></title>
            <link>https://askaric.com/en/work/tidb/TiDB-EcosystematicTools/TiCDC/03TiKV CDC Component.html</link>
            <guid>https://askaric.com/en/work/tidb/TiDB-EcosystematicTools/TiCDC/03TiKV CDC Component.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[Lazy worker of cdc component

1. lazy_build ‰∏∫‰ªÄ‰πàÊòØ lazy_build?
lazy_worker Ê∫êËá™‰∫éË∞ÉÁî® worker ÁöÑ lazy_buil]]></description>
            <content:encoded><![CDATA[<h1 id="cdc-component-in-tikv" tabindex="-1">CDC Component in TiKV <a class="header-anchor" href="#cdc-component-in-tikv" aria-label="Permalink to &quot;CDC Component in TiKV&quot;"></a></h1>
<h2 id="lazy-worker-of-cdc-component" tabindex="-1">Lazy worker of cdc component <a class="header-anchor" href="#lazy-worker-of-cdc-component" aria-label="Permalink to &quot;Lazy worker of cdc component&quot;"></a></h2>
<ol>
<li>lazy_build ‰∏∫‰ªÄ‰πàÊòØ lazy_build?
lazy_worker Ê∫êËá™‰∫éË∞ÉÁî® worker ÁöÑ lazy_buildÔºåË°®Á§∫Âª∂ËøüÊâßË°å„ÄÇÂª∂ËøüË°®Á§∫‰ªÖ spwan ‰∏Ä‰∏™ taskÔºåÁî±ÂÖ∂Ëá™Ë∫´Ë∞ÉÂ∫¶Êú∫Âà∂ÂÜ≥ÂÆö‰ΩïÊó∂ËøêË°å„ÄÇ</li>
<li>tikv_util ‰∏≠ÁöÑ Worker ÊòØ‰ªÄ‰πàÔºü
‰ªéÂÖ∂ÁªìÊûÑ‰Ωì‰∏≠ÂèØ‰ª•ÁúãÂá∫ÔºåÂ∞ÅË£Ö‰∫Ü yatp Á∫øÁ®ãÊ±†ÔºåÂèäÁõ∏ÂÖ≥ÊéßÂà∂ÂèÇÊï∞„ÄÅÈù¢ÊùøÊï∞ÊçÆ„ÄÇ
a. pool Âèä Remote Ë°®Á§∫ yatp ‰∏≠ÁöÑ‰ªªÂä°ÂèäÈòüÂàóÁ±ªÂûãÔºõ
b. pending_capacity Ë°®Á§∫ÊúÄÂ§öÂèØ‰ª•‰∫ßÁîüÂ§öÂ∞ë taskÔºåËØ•ÈôêÂà∂ÊòØËΩØÈôêÂà∂ÔºåÂ¶ÇÊûúË∂ÖËøáÊâìÂç∞Êä•ÈîôÔºå‰ΩÜËøòÊòØ‰ºöÁîüÊàê taskÔºõ</li>
<li>counter Ë°®Á§∫ task ÁöÑËÆ°Êï∞ÔºåÊØèÂΩì task Ë¢´Ë∞ÉÂ∫¶(schedule_force)ÁöÑÊó∂ÂÄô‰ºöÂ¢ûÂä†ÔºåÂèç‰πã‰∫¶ÁÑ∂Ôºõ</li>
<li>stop Ë°®Á§∫ÊòØÂê¶ÂÅúÊ≠¢ÂΩìÂâç worker ÁöÑÁä∂ÊÄÅÂÄºÔºõ</li>
<li>thread_count Ë°®Á§∫ worker ÂèØ‰ΩøÁî®ÁöÑÁ∫øÁ®ãÊï∞ÈáèÔºåÁî®‰∫é‰∏é counter ‰∏≠Êï∞ÈáèÊØîËæÉÔºåÈò≤Ê≠¢ËøáËΩΩÔºõ</li>
</ol>
<div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">pub </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Worker {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    pool: Arc</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">&#x3C;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">Mutex</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">&#x3C;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">Option</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">&#x3C;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">ThreadPool</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">&#x3C;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">yatp::task::future::TaskCell</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">>>>></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    remote: Remote</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">&#x3C;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">yatp::task::future::TaskCell</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    pending_capacity: usize,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    counter: Arc</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">&#x3C;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">AtomicUsize</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    stop: Arc</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">&#x3C;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">AtomicBool</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    thread_count: usize,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
</div><h2 id="what-is-lazy-worker" tabindex="-1">What is lazy_worker <a class="header-anchor" href="#what-is-lazy-worker" aria-label="Permalink to &quot;What is lazy_worker&quot;"></a></h2>
<ol>
<li>‰ªÄ‰πàÊòØ lazy worker
‰ªéÁªìÊûÑ‰ΩìÂèØ‰ª•ÁúãÂá∫ÔºåÈ¶ñÂÖàÔºålazy_worker ÊòØ‰∏Ä‰∏™Â∞ÅË£Ö‰∫Ü worker ÁªìÊûÑÁöÑ worker„ÄÇ
scheduler Ë°®Á§∫ Â∞ÅË£Ö‰∫Ü channel sender ÁöÑË∞ÉÂ∫¶Âô®Ôºõ
receiver Ë°®Á§∫ Â∞ÅË£Ö‰∫Ü channel receiver ÁöÑÊé•Êî∂Âô®ÔºåÊé•ÂèóÊù•Ëá™ scheduler ÁöÑ MsgÔºåÂêë‰∏ãË∞ÉÁî®Â§ÑÁêÜÔºõ
metrics_pending_task_count Ë°®Á§∫ pending task ËÆ°Êï∞ÔºåÁî®‰∫éÁõëÊéß‰ø°ÊÅØÔºõ</li>
</ol>
<div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">pub </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> LazyWorker</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">&#x3C;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">T: Display </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Send </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> '</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">static> {</span></span>
<span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">    scheduler: Scheduler&#x3C;T>,</span></span>
<span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">    worker: Worker,</span></span>
<span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">    receiver: Option&#x3C;UnboundedReceiver&#x3C;Msg&#x3C;T>>>,</span></span>
<span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">    metrics_pending_task_count: IntGauge,</span></span>
<span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">}</span></span></code></pre>
</div><h2 id="what-is-task-homework-in-cdc-endpoint" tabindex="-1">What is task(homework) in cdc endpoint <a class="header-anchor" href="#what-is-task-homework-in-cdc-endpoint" aria-label="Permalink to &quot;What is task(homework) in cdc endpoint&quot;"></a></h2>
<ol>
<li>
<p>Âú® <a href="https://github.com/tikv/tikv/blob/7861f56f6249ea6b4cc19a6b2ba7d7dbd2a63c25/components/server/src/server.rs#L1077" target="_blank" rel="noreferrer">https://github.com/tikv/tikv/blob/7861f56f6249ea6b4cc19a6b2ba7d7dbd2a63c25/components/server/src/server.rs#L1077</a> ÂêØÂä®‰∏Ä‰∏™ cdc workerÔºåÂπ∂Ë∞ÉÁî® fn start_with_timer ‰∏ÄÁõ¥ÔºàÂ±ÇÂ±ÇÂ∞ÅË£ÖÔºâ‰º†ÈÄíÂà∞ tikv_util worker ÁöÑ fn start_with_timerÔºõ</p>
</li>
<li>
<p>Receiver ‰ªé channel ‰∏≠Êé•Êî∂ taskÔºåhandle.inner.run(task) ‰ºöË∞ÉÁî®ÂØπÂ∫îÁöÑ innerÔºàÂç≥ÔºöÂØπÂ∫î worker ÁöÑ runnerÔºàcdc_worker Âú®ËøôÈáåÂ∞±ÊòØ innerÔºâÔºåÂÜÖÈÉ®Â∞ÅË£Ö‰∫ÜËá™Â∑±ÁöÑÊñπÊ≥ïÂ§ÑÁêÜÔºõ</p>
</li>
<li>
<p>Cdc endpoint ÁöÑ Runnable trait impl Âú®ËøôÈáå <a href="https://github.com/tikv/tikv/blob/7861f56f6249ea6b4cc19a6b2ba7d7dbd2a63c25/components/cdc/src/endpoint.rs#L1289" target="_blank" rel="noreferrer">https://github.com/tikv/tikv/blob/7861f56f6249ea6b4cc19a6b2ba7d7dbd2a63c25/components/cdc/src/endpoint.rs#L1289</a> ÔºåCDC ‰∏≠ÊâÄÊúâÁöÑ Task Á±ªÂûãÈÉΩÂú®Â¶Ç‰∏ã‰ª£Á†ÅÂùóÔºö
a. RegionUpdated ÔºöÂØπÊØî observer Ê£ÄÂØüÁöÑ region ÂíåÂèëÊù•ÁöÑ region ÁöÑ versionÔºåÁõ∏ÂêåËØ¥ÊòéÊòØ peer change ÂØºËá¥ÔºåÊó†ÈúÄ DeRegisterÔºõ
b. RegionDestroyed ÔºöÂØπÂ∫î RegionDestroyed eventÔºåÂÖàÂØπÊØî Region Epoch Ê≠£Á°ÆÂêéÔºåÂÜçËøõË°å destroy;
c. RegisterRegionÔºöÊ≥®ÂÜåÂØπÂ∫î region_id Ëá≥ mapÔºåÂπ∂ÈíàÂØπËØ• region ÁöÑ spawn_task Âà∞Á∫øÁ®ãÊ±†Ôºõ
c. DeRegisterRegionÔºöRegisterRegion ÁöÑÂèçÂêëÊìç‰ΩúÔºõ
d. RegisterAdvanceEvent Ôºö‰ª• advance_ts_interval ‰∏∫Âë®ÊúüÊé®ËøõÊâÄÊúâ region ÁöÑ ResolvedTsÔºõ
e. AdvanceResolvedTs : Ëø≠‰ª£ region map ‰∏≠ÊâÄÊúâ regionÔºåÈÄöËøá Resolver Ê£ÄÊµã Region Áä∂ÊÄÅÔºåready Ë°®Á§∫ÊòØ leaderÔºåÂÜçÊâ´ LockCF ‰∏≠ÁöÑ‰ø°ÊÅØÊé®ËøõËØ• Region ÁöÑ minTsÔºõ
f. ChangeLog ÔºöË°®Á§∫Ëé∑Âèñ CmdBatch ‰∏≠ÁöÑ Region ÁöÑ change logÔºõ
g. ScanLocks ÔºöÊâ´Êèè Region ‰∏≠ÊåáÂÆö apply_index ‰ΩçÁΩÆÔºåÂØπÂ∫î entries ÁöÑÈîÅ‰ø°ÊÅØÔºõ
h. ChangeConfigÔºöÂ§ÑÁêÜÂä®ÊÄÅÈÖçÁΩÆÁöÑ‰ø°ÊÅØÔºõ</p>
<div class="language-rust vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">pub</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> enum</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Task</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&#x3C;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">S</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Snapshot</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    RegionUpdated</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Region</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">),</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    RegionDestroyed</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Region</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">),</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    RegisterRegion</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        region</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Region</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    },</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    DeRegisterRegion</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        region_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> u64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    },</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    ReRegisterRegion</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        region_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> u64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        observe_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> ObserveID</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        cause</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    },</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    RegisterAdvanceEvent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        cfg_version</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> usize</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    },</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    AdvanceResolvedTs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        regions</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Vec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&#x3C;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">u64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">>,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        ts</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> TimeStamp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    },</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    ChangeLog</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        cmd_batch</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Vec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&#x3C;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">CmdBatch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">>,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        snapshot</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Option</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&#x3C;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">RegionSnapshot</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&#x3C;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">S</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">>>,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    },</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    ScanLocks</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        region_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> u64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        observe_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> ObserveID</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        entries</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Vec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&#x3C;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ScanEntry</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">>,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        apply_index</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> u64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    },</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    ChangeConfig</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        change</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> ConfigChange</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
</div></li>
</ol>
<p>Qs:</p>
<ol>
<li>ÁúãÂà∞ lazy_worker ÁöÑ implÔºåÊó¢Êúâ start fn ÂèàÊúâ start_with_timer fnÔºåÂ¶Ç‰ΩïÂå∫ÂàÜÊàëÊÉ≥ÁúãÁöÑÈÉ®ÂàÜ‰ΩøÁî®ÁöÑÊòØÂì™‰∏™Ôºü Áúã‰ªñÁöÑ‰∏ä‰∏ãÊñáË∞ÉÁî®ÊúâÊó∂ÂÄôÁúã‰∏çÂá∫Êù•ÊÄé‰πàÂäûÔºü
ÊàëÈÄâÁöÑÊñπÊ≥ïÊòØÔºåÁõ¥Êé•ÂÖ®ÊñáÊêúÁ¥¢ÊØè‰∏™Áúã‰∏ÄÈÅçÔºåÁÑ∂ÂêéÂú® server.rs ‰∏≠ÁúãÂà∞ cdc_worker Êúâ‰∏™ start_with_timer ÂÆûÁé∞ÔºåÊâçÁ°ÆÂÆö‰∏éÊú¨ÈóÆÈ¢òÁõ∏ÂÖ≥Ôºå‰ΩÜËøôÁßçÊñπÊ≥ïÂú®ÂÖ∂ÂÆûÈù†ËøêÊ∞îÂíåÁåúÊµãÔºåÊúâÊõ¥Â•ΩÁöÑÊñπÊ≥ïÂêóÔºü</li>
<li>ÊúâÁöÑÊó∂ÂÄô ‚Äúvscode ËØ≠Ë®ÄÂä©Êâã rust-analyzer‚Äù Âè™ËÉΩÁúãÂà∞‰∏ÄÈÉ®ÂàÜÂºïÁî®ÔºåÊØîÂ¶ÇÔºö <code>counter arc&lt;automic&gt;</code>ÔºåÂè™ËÉΩÁúãÂà∞ loadÔºåÁúã‰∏çÂà∞ store Âíå fetch_addÔºåÂè™ËÉΩÂÖ®Â±ÄÊêúÊúâÁöÑÊó∂ÂÄô ‚Äúvscode ËØ≠Ë®ÄÂä©Êâã rust-analyzer‚Äù Âè™ËÉΩÁúãÂà∞‰∏ÄÈÉ®ÂàÜÂºïÁî®ÔºåÊØîÂ¶ÇÔºö <code>counter arc&lt;automic&gt;</code>ÔºåÂè™ËÉΩÁúãÂà∞ loadÔºåÁúã‰∏çÂà∞ store Âíå fetch_addÔºåÂè™ËÉΩÂÖ®Â±ÄÊêúÁ¥¢ÂêóÔºåÂÖ®ÊñáÊêúÁ¥¢ÊàëÂæóÂÖàÁü•ÈÅìÊúâ fetch_addÔºåÊâçËÉΩÂÖ®ÊñáÊêúÁ¥¢ <code>counter.fetch_add</code> ÂÖ≥ÈîÆÂ≠óÔºüËøòÊòØÊàëÊâìÂºÄÁöÑÊñπÊ≥ï‰∏çÂØπÔºüÂõ†‰∏∫ÊàëÂè™ÊúâÁúãÂà∞Ëøô‰∏™ÂÄº‰ªÄ‰πàÊó∂ÂÄôÊîπÂèòÔºåÊâçËÉΩÁü•ÈÅì‰ªñÁöÑ‰ΩúÁî®Ôºå‰πüÊõ¥Âà©‰∫éÊéíÊü•ÈóÆÈ¢ò„ÄÇÁ¥¢ÂêóÔºåÂÖ®ÊñáÊêúÁ¥¢ÊàëÂæóÂÖàÁü•ÈÅìÊúâ fetch_addÔºåÊâçËÉΩÂÖ®ÊñáÊêúÁ¥¢ <code>counter.fetch_add</code> ÂÖ≥ÈîÆÂ≠óÔºüËøòÊòØÊàëÊâìÂºÄÁöÑÊñπÊ≥ï‰∏çÂØπÔºüÂõ†‰∏∫ÊàëÂè™ÊúâÁúãÂà∞Ëøô‰∏™ÂÄº‰ªÄ‰πàÊó∂ÂÄôÊîπÂèòÔºåÊâçËÉΩÁü•ÈÅì‰ªñÁöÑ‰ΩúÁî®Ôºå‰πüÊõ¥Âà©‰∫éÊéíÊü•ÈóÆÈ¢ò„ÄÇ</li>
<li>Rust Clone Âíå Copy ÁöÑÂå∫Âà´ÔºàËÆ§ËØÜÂØπÂêóÔºüÔºâÔºö<br>
a. ÈªòËÆ§ rust ËÉΩ Copy ÁöÑÂÖ∂ÂÆûÂ∞±ÊòØ ‚ÄúÂÜÖÂ≠òÊµÖÊã∑Ë¥ùÔºåÂç≥ÔºöÂè™ÁßªÂä®Ê†àÊåáÈíàÔºåÊåáÂêëÂ†ÜÁ©∫Èó¥Âú∞ÂùÄÔºåÂ†Ü‰∏çÂä®‚Äù„ÄÇ<br>
b. Clone ÂäüËÉΩ‰∏é Copy Áõ∏ÂêåÔºå‰ΩÜÂ≠òÂú®‰∏Ä‰∫õÈôêÂà∂Ôºå‰∏ªË¶Å‰ΩúÁî®ÊòØ‰∏∫‰∫ÜÂº•Ë°•Êó†ÈªòËÆ§ÂÆûÁé∞ Copy Á±ªÂûãÁöÑÂú∞Êñπ„ÄÇÂÖ∑‰ΩìÊòØÊ∑±Êã∑Ë¥ùËøòÊòØÊµÖÊã∑Ë¥ù‰æùËµñ‰∫éÂÖ∑‰ΩìÁ±ªÂûãÔºåÈúÄË¶Å developer ÊâãÂä®ÂÆûÁé∞„ÄÇ</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Analysis of monitoring principle]]></title>
            <link>https://askaric.com/en/work/tidb/TiDB-EcosystematicTools/TiCDC/04All metrics in TiCDC.html</link>
            <guid>https://askaric.com/en/work/tidb/TiDB-EcosystematicTools/TiCDC/04All metrics in TiCDC.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[# Analysis of monitoring principle

## Meaning of the article

## Reading preface

1. Prometheus was used for monitoring as described in [TiDB website Storage](https://docs.pingcap.com/tidb/stable/tidb-monitoring-framework), scrape_interval is 15s by default, the following changes all refer to the change logic of monitoring indicators in TiCDC memory, **namely, ignoring the logic of the persistence part of the memory, and focusing on the analysis of the significance of indicators.**
2. **"prometheus client Function"**, indicated in the following paragraph. For example, the process collector and Go collector are registered to collect basic Linux process information, such as CPU, memory, file descriptor usage, and startup time, and to collect Go runtime information, such as GC, gouroutine, and the number of OS threads. **To avoid redundant articles, this group is collectively referred to as the "prometheus client Function"**. If these indicators are inaccurate, you can view them on the Prometheus Github Repo or create an Issue to discuss them.
3. Prometheus is packaged within TiDB components (including TiCDC) using Counter, Gauge, and Histogram. For more details, please refer to Prometheus Document or My Blog. metrics are initialized when the process starts, so we'll focus on the change, demise, and role of Metrics.
4. The Tick mechanism has been mentioned several times in the following paragraphs. The logic is roughly as follows: Essentially, it is a constant action with a fixed frequency, and its action includes update Metrics operation.

    ```yaml
    Owner.Tick --> changefeed.Tick --> schedulerV2.Tick --> ScheduleDispatcher.Tick
                                                |]]></description>
            <content:encoded><![CDATA[<h1 id="analysis-of-monitoring-principle" tabindex="-1">Analysis of monitoring principle <a class="header-anchor" href="#analysis-of-monitoring-principle" aria-label="Permalink to &quot;Analysis of monitoring principle&quot;"></a></h1>
<h2 id="meaning-of-the-article" tabindex="-1">Meaning of the article <a class="header-anchor" href="#meaning-of-the-article" aria-label="Permalink to &quot;Meaning of the article&quot;"></a></h2>
<h2 id="reading-preface" tabindex="-1">Reading preface <a class="header-anchor" href="#reading-preface" aria-label="Permalink to &quot;Reading preface&quot;"></a></h2>
<ol>
<li>
<p>Prometheus was used for monitoring as described in <a href="https://docs.pingcap.com/tidb/stable/tidb-monitoring-framework" target="_blank" rel="noreferrer">TiDB website Storage</a>, scrape_interval is 15s by default, the following changes all refer to the change logic of monitoring indicators in TiCDC memory, <strong>namely, ignoring the logic of the persistence part of the memory, and focusing on the analysis of the significance of indicators.</strong></p>
</li>
<li>
<p><strong>&quot;prometheus client Function&quot;</strong>, indicated in the following paragraph. For example, the process collector and Go collector are registered to collect basic Linux process information, such as CPU, memory, file descriptor usage, and startup time, and to collect Go runtime information, such as GC, gouroutine, and the number of OS threads. <strong>To avoid redundant articles, this group is collectively referred to as the &quot;prometheus client Function&quot;</strong>. If these indicators are inaccurate, you can view them on the Prometheus Github Repo or create an Issue to discuss them.</p>
</li>
<li>
<p>Prometheus is packaged within TiDB components (including TiCDC) using Counter, Gauge, and Histogram. For more details, please refer to Prometheus Document or My Blog. metrics are initialized when the process starts, so we'll focus on the change, demise, and role of Metrics.</p>
</li>
<li>
<p>The Tick mechanism has been mentioned several times in the following paragraphs. The logic is roughly as follows: Essentially, it is a constant action with a fixed frequency, and its action includes update Metrics operation.</p>
<div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">Owner.Tick --> changefeed.Tick --> schedulerV2.Tick --> ScheduleDispatcher.Tick</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">                                            |-</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">---------->feedStateManager.Tick</span></span></code></pre>
</div></li>
</ol>
<h2 id="server-panel" tabindex="-1">Server panel <a class="header-anchor" href="#server-panel" aria-label="Permalink to &quot;Server panel&quot;"></a></h2>
<p>Most indicators on this panel are related to process status and operating system resource consumption.</p>
<ol>
<li>Uptime</li>
</ol>
<p><strong>Changed:</strong> When the node process is normal (start_time value is unchanged), the panel value increases continuously. When restart occurs, the panel value will be reset to zero and a new round of cumulative increment will be started.
<strong>Death:</strong> The process restarts start_time changes.
<strong>Action:</strong> Time that the TiKV and TiCDC nodes have been running, including Capture, PD, and TiKV nodes since the last process start. When used for problem diagnosis, analyze the correlation between the build process restart and the current problem.
<strong>Principle:</strong> The data is from /proc/stat. The current time minus start_time minus USER_HZ is the value in seconds.</p>
<ol start="2">
<li>Goroutine count</li>
</ol>
<p>ÂèòÊõ¥ÔºöËøõÁ®ãËøêË°åÊó∂Ôºågo profile ÈááÁî®ÁªüËÆ°ËÆ∞ÂΩïÔºõ
Ê∂à‰∫°ÔºöËøõÁ®ãÁªìÊùüÊó∂ prometheus client ‰∏≠ÁöÑ go Êî∂ÈõÜÂô®ÈÄÄÂá∫Ôºå‰∏çÂú®ËÆ∞ÂΩïÂØπÂ∫îÊåáÊ†á‰ø°ÊÅØÔºõ
‰ΩúÁî®ÔºöTiCDC ËäÇÁÇπ Goroutine ÁöÑ‰∏™Êï∞ÔºåÁî®‰∫éÈóÆÈ¢òËØäÊñ≠Êó∂ÔºåÂàÜÊûêÁªÑÂª∫ËøõÁ®ãÈáçÂêØ‰∏éÂΩìÂâçÈóÆÈ¢òÁöÑÁõ∏ÂÖ≥ÊÄß„ÄÇ
ÂéüÁêÜÔºöÔºà‰∏ãÈù¢Êúâ‰∏™ÈöêËóèÊåáÊ†áÔºågo_threads ‰∏é go_goroutines ÂäüËÉΩÁ±ª‰ººÔºåcdc process Âú® linux ÂàõÂª∫ÁöÑÁ∫øÁ®ãÊï∞Ôºå‰∏ªË¶ÅÁî®‰∫éÊÄßËÉΩË∞É‰ºòÔºåÂ¶ÇÔºögoroutine ËøáÂ§öÁ≠âÈóÆÈ¢ò„ÄÇÔºâ</p>
<p>Open FD count
‰∫ßÁîüÔºöÈááÁî® Prometheus Guage Á±ªÂûãÁªüËÆ°ÔºåÊâìÂºÄÁöÑÊñá‰ª∂ÊèèËø∞Á¨¶Êï∞ÈáèÔºõ
ÂèòÊõ¥Ôºö‰ª•ÈªòËÆ§ 15s ‰∏∫Èó¥ÈöîÊõ¥Êñ∞ÊåáÊ†áÂÄºÔºõ
Ê∂à‰∫°ÔºöËøõÁ®ãÁªìÊùüÊó∂ÊåáÊ†áÂÄºÂΩíÈõ∂Ôºõ
‰ΩúÁî®ÔºöTiCDC ËäÇÁÇπÊâìÂºÄÁöÑÊñá‰ª∂Âè•ÊüÑ‰∏™Êï∞ÔºåÁî®‰∫éÈóÆÈ¢òËØäÊñ≠Êó∂ÔºåÂàÜÊûêÊìç‰ΩúÁ≥ªÁªüÂ±ÇÈù¢Êñá‰ª∂Âè•ÊüÑÊâìÂºÄÊï∞Èáè‰∏éÂΩìÂâçÈóÆÈ¢òÁöÑÁõ∏ÂÖ≥ÊÄßÔºõ
ÂéüÁêÜÔºöËØ•‰ø°ÊÅØÊ∫êËá™ /proc/PID/fd„ÄÇ</p>
<p>Ownership
‰∫ßÁîüÔºöÈááÁî® Prometheus Guage Á±ªÂûãÁªüËÆ°ÔºåËøõÁ®ãËøêË°åÊó∂ÊåáÊ†áÂÄºÂàùÂßãÂåñÂÆåÊØïÔºõ
ÂèòÊõ¥Ôºö‰ª• owner-flush-interval  ‰∏∫Âë®ÊúüÔºåÂú®ËøõÁ®ã Tick Êó∂‰∫éÂÜÖÂ≠ò‰∏≠Êõ¥Êñ∞Ôºõ
Ê∂à‰∫°ÔºöËøõÁ®ãÁªìÊùüÊó∂ÊåáÊ†áÂÄºÂΩíÈõ∂Ôºõ
‰ΩúÁî®ÔºöTiCDC ÈõÜÁæ§‰∏≠ËäÇÁÇπÁöÑÂΩìÂâçÁä∂ÊÄÅÔºåÊåáÊ†áÂÄºÂåÖÂê´ InstanceÔºàIP:portÔºâ Âèä Role(Processor Êàñ Owner)„ÄÇÁî®‰∫éÈóÆÈ¢òËØäÊñ≠Êó∂ÔºåÂàÜÊûêÂΩìÂâçÈóÆÈ¢ò‰∏é Owner Áõ∏ÂÖ≥ÊÄßÔºåÂ¶ÇÔºöÊòØÂê¶ÂêåÊó∂Â≠òÂú® 2 ‰∏™ Owner Á≠â„ÄÇ
ÂéüÁêÜÔºö‰æùÊçÆ CDC ÁöÑ Tick Êú∫Âà∂ÔºåÂú®ÊØèÊ¨° Tick Êó∂ Owner ÁöÑ updateMetrics ‰ºö‰ª• ownershipCounter.Add(float64(now.Sub(o.lastTickTime)) / float64(time.Second)) ËÆ°ÁÆóÂä†ÂíåÁªüËÆ°„ÄÇ‰ª• owner-flush-interval Âú® Process ÂêØÂä®Êó∂ÊûÑÈÄ†‰∏Ä‰∏™ goroutine ÔºåÂë®ÊúüÊÄßÁöÑÂÆåÊàê Tick Êìç‰ΩúÔºåTick ËØ¶ÁªÜËøêË°åÊú∫Âà∂ÂèÇËÄÉ --&gt; What is tick in cdc</p>
<p>Ownership history
‰∫ßÁîüÔºöÂêå Ownership Èù¢ÊùøÔºõ
ÂèòÊõ¥ÔºöÂêå Ownership Èù¢ÊùøÔºõ
Ê∂à‰∫°ÔºöÂêå Ownership Èù¢ÊùøÔºõ
‰ΩúÁî®ÔºöÂèòÊç¢ËÆ°ÁÆóÊñπÂºèÔºåÁî®‰∫éÂàÜÊûê Owner ÁöÑÊºîËøõÂéÜÂè≤ÔºåÊúâÂà©‰∫éÈóÆÈ¢òÊ†πÂõ†‰∏éËØ•ÊåáÊ†áÁõ∏ÂÖ≥ÊÄßÂàÜÊûê„ÄÇ
CPU usage
ÂèòÊõ¥ÔºöÈááÁî® Prometheus Guage Á±ªÂûãÁªüËÆ°Ôºå‰ªéÊìç‰ΩúÁ≥ªÁªüÂ±ÇËé∑ÂèñÂΩìÂâçËøõÁ®ãÁöÑ CPU UsageÔºõ
Ê∂à‰∫°ÔºöËøõÁ®ãÁªìÊùüÊó∂ÊåáÊ†áÂÄºÂΩíÈõ∂Ôºõ
‰ΩúÁî®ÔºöTiCDC ËäÇÁÇπ‰ΩøÁî®ÁöÑ CPU„ÄÇinstance-MaxProcs Ë°®Á§∫ Capture ËøõÁ®ãÂèØÂêåÊó∂‰ΩøÁî®Êìç‰ΩúÁ≥ªÁªü CPU Ê†∏Êï∞ÔºàÁõÆÂâç hard code Âú®‰ª£Á†Å‰∏≠ÔºåÂèØ 100% Âç†Áî®Êìç‰ΩúÁ≥ªÁªü CPU Ê†∏Êï∞ÔºâÔºåinstance Ë°®Á§∫ÂΩìÂâçËøõÁ®ãÂ∑≤Ê∂àËÄóÁöÑ CPU Ê†∏ÂøÉ‰ΩøÁî®Áéá„ÄÇÁî®‰∫éÈóÆÈ¢òËØäÊñ≠Êó∂ÔºåÂàÜÊûêÊìç‰ΩúÁ≥ªÁªüÂ±ÇÈù¢ËøõÁ®ã‰ΩøÁî®ÊÉÖÂÜµ‰∏éÂΩìÂâçÈóÆÈ¢òÁöÑÁõ∏ÂÖ≥ÊÄßÔºõ
ÂéüÁêÜÔºöËØ•‰ø°ÊÅØÊ∫êËá™ /proc/PID/status „ÄÇ
Memory usage
ÂèòÊõ¥ÔºöÈááÁî® Prometheus Guage Á±ªÂûãÁªüËÆ°Ôºå‰ªéÊìç‰ΩúÁ≥ªÁªüÂ±ÇÈù¢Ëé∑ÂèñËøõÁ®ãÂÜÖÂ≠òÊ∂àËÄóÔºõ
Ê∂à‰∫°ÔºöËøõÁ®ãÁªìÊùüÊó∂ÊåáÊ†áÂÄºÂΩíÈõ∂Ôºõ
‰ΩúÁî®ÔºöTiCDC ËäÇÁÇπ‰ΩøÁî®ÁöÑÂÜÖÂ≠ò„ÄÇprocess-instance Ë°®Á§∫ËøõÁ®ãÂÆûÈôÖ‰ΩøÁî®ÁöÑÂÜÖÂ≠òÔºàÂç≥ÔºöÂ∏∏È©ªÂÜÖÂ≠òÈõÜ Resident Set SizeÔºâÔºå‰∏çÂåÖÊã¨ÂàÜÈÖç‰ΩÜÊú™‰ΩøÁî®ÁöÑÂÜÖÂ≠òÔºå‰πü‰∏çÂåÖÊã¨Êç¢Âá∫ÁöÑÂÜÖÂ≠òÈ°µÈù¢Ôºå‰ΩÜÂåÖÂê´ÂÖ±‰∫´ÂÜÖÂ≠ò„ÄÇheap-instance Ë°®Á§∫ Capture ËøõÁ®ãÂ∑≤ÂàÜÈÖç‰∏î‰ªçÂú®‰ΩøÁî®ÁöÑ heap Â≠óËäÇÊï∞ÔºåÂåÖÊã¨ÊâÄÊúâÂèØËææÂ†ÜÂØπË±°Âíå‰∏çÂèØËææÁöÑÂØπË±°(GCÂ∞öÊú™ÈáäÊîæÁöÑÔºâÂç†Áî®ÁöÑÂÜÖÂ≠ò„ÄÇÁî®‰∫éÈóÆÈ¢òËØäÊñ≠Êó∂ÔºåÂàÜÊûêÊìç‰ΩúÁ≥ªÁªüÂ±ÇÈù¢ËøõÁ®ãÂÜÖÂ≠òÊ∂àËÄó‰∏éÂΩìÂâçÈóÆÈ¢òÁöÑÁõ∏ÂÖ≥ÊÄßÔºõ
ÂéüÁêÜÔºöËØ•Á±ª‰ø°ÊÅØÊù•Ëá™ Go Êî∂ÈõÜÂô® ÔºåÈùûÊìç‰ΩúÁ≥ªÁªü„ÄÇ
PD leader history
ÂèòÊõ¥ÔºöÈááÁî® Prometheus Guage Á±ªÂûãÁªüËÆ°ÔºåÊ∫êËá™ PD ÁªÑ‰ª∂ÔºåPD ËøõÁ®ãÂàáÊç¢ Leader Êó∂ÂèëÁîüÂèòÊõ¥Ôºõ
Ê∂à‰∫°ÔºöÂΩì PD leader Âèò‰∏∫ follower Êó∂ÔºåÊåáÊ†áÂÄºÂΩíÈõ∂„ÄÇPD ËøõÁ®ãÁªìÊùüÊó∂ÔºåÊåáÊ†áÂÄº‰∏∫Á©∫Ôºõ
‰ΩúÁî®ÔºöË°®Á§∫ PD Leader ÊºîËøõÂéÜÂè≤ÔºåÂõ†‰∏∫ PD Cluster  ‰∏∫ TiCDC Cluster Êèê‰æõ‰∏ÄÂÆöÊåÅ‰πÖÂåñÂäüËÉΩÔºå‰∫åËÄÖÊòØÂº∫ÁªëÂÆöÂÖ≥Á≥ªÔºåÊâÄ‰ª•ËØ•Èù¢ÊùøÊúâÂà©‰∫éÂàÜÊûêÂΩìÂâçÈóÆÈ¢ò‰∏é PD Leader ÂèòÂåñÁöÑÁõ∏ÂÖ≥ÊÄß„ÄÇ</p>
<p>Changefeed Èù¢Êùø
Changefeed table count
‰∫ßÁîüÔºöÈááÁî® Prometheus Guage Á±ªÂûãÁªüËÆ°ÔºåÂú® Processor ÂàõÂª∫Êó∂ËØ•ÊåáÊ†áÂàùÂßãÂåñÔºõ
ÂèòÊõ¥ÔºöÂú® TablePipeline ÂçèÁ®ãÂàõÂª∫ÊàêÂäüÂêéÔºåÊåáÊ†áÂÄºÂ¢ûÂä†ÔºåÂú® TablePipeline ÂçèÁ®ãÈÄÄÂá∫ÂêéÔºåÊåáÊ†áÂÄºÂáèÂ∞ëÔºõ
Ê∂à‰∫°ÔºöÂú® Processor ÁîüÂëΩÂë®ÊúüÁªìÊùüÊó∂ÔºåÂà†Èô§ÊåáÊ†áÔºõ
‰ΩúÁî®Ôºö‰∏Ä‰∏™ÂêåÊ≠•‰ªªÂä°‰∏≠ÂàÜÈÖçÂà∞ÂêÑ‰∏™ TiCDC ËäÇÁÇπÂêåÊ≠•ÁöÑÊï∞ÊçÆË°®‰∏™Êï∞ÔºåÂΩìÂâç TiCDC Cluster ÂêÑ Capture ÂàÜÈÖçÁöÑÂêåÊ≠•Ë°®Êï∞ÈáèÊòØÂê¶ÂùáË°°„ÄÇ
Table count maintained by owner
‰∫ßÁîüÔºöÈááÁî® Prometheus Guage Á±ªÂûãÁªüËÆ°ÔºåÂú® Capture ËøêË°åÊó∂ËØ•ÊåáÊ†áÂàùÂßãÂåñÔºõ
ÂèòÊõ¥Ôºö‰ª• owner-flush-interval ‰∏∫Âë®Êúü Tick Êó∂ÔºåÂæ™ÁéØÊü•ÊâæÊØè‰∏™ Changefeeds ÊâÄÁî®ÁöÑ CaptureÔºåÂπ∂Ê±áÊÄªÁªüËÆ°ÂΩìÂâç Owner ÊâÄÁÆ°ÁêÜÁöÑË°®Êï∞ÈáèÔºõ
Ê∂à‰∫°ÔºöËøõÁ®ãÁªìÊùüÊó∂ÊåáÊ†áÂÄºÂΩíÈõ∂Ôºõ
‰ΩúÁî®ÔºöTiCDC Owner Áª¥Êä§ÁöÑÂ§çÂà∂Ë°®ÁöÑÊï∞Èáè„ÄÇcapture-total Ë°®Á§∫ÂØπÂ∫î Capture ‰∏äÁª¥Êä§ÁöÑË°®Êï∞ÈáèÔºåcapture-wip Ë°®Á§∫Ë°®Ê≠£Â§Ñ‰∫éËøÅÁßªË∞ÉÂ∫¶Áä∂ÊÄÅÁöÑÊï∞Èáè„ÄÇÁî®‰∫éÈóÆÈ¢òËØäÊñ≠Êó∂ÔºåÂàÜÊûê Owner Ë°®Ë∞ÉÂ∫¶‰∏éÂΩìÂâçÈóÆÈ¢òÁöÑÁõ∏ÂÖ≥ÊÄß„ÄÇ
Min resolved table ID
‰∫ßÁîüÔºöÈááÁî® Prometheus Guage Á±ªÂûãÁªüËÆ°ÔºåÂú® Capture ËøêË°åÊó∂ËØ•ÊåáÊ†áÂàùÂßãÂåñÔºõ
ÂèòÊõ¥Ôºö‰ª• processor-flush-interval ‰∏∫Âë®Êúü Tick Êó∂ÔºåÈÅçÂéÜÂΩìÂâç Processor ÊâÄË¥üË¥£ÁöÑË°®ÊâæÂá∫ÊúÄÂ∞è TableID ËÆ∞ÂΩïÔºõ
Ê∂à‰∫°ÔºöÂú® Processor Â£∞ÊòéÂë®ÊúüÁªìÊùüÊó∂‰∏çÂÜçËÆ∞ÂΩïÔºõ
‰ΩúÁî®ÔºöÊØè‰∏™ Changefeed ÊâÄÂú®ÁöÑ Capture ÁöÑÊúÄÂ∞è ResolvedTs ÁöÑË°®ÁöÑ TableIDÔºå‰ª• instance-changefeed-table-id Ê†ºÂºèÂàíÂàÜÊåáÊ†á„ÄÇÁî®‰∫éÈóÆÈ¢òËØäÊñ≠Êó∂ÔºåÂ∞ÜÊï¥‰ΩìÂª∂Êó∂Âú® ResolvedTs Â±ÇÈù¢ÁªÜÂàÜÂà∞Ë°®Á∫ß„ÄÇ
Min checkpoint table ID
‰∫ßÁîüÔºöÂêå Min resolved table ID ÊåáÊ†áÔºõ
ÂèòÊõ¥ÔºöÂêå Min resolved table ID ÊåáÊ†áÔºõ
Ê∂à‰∫°ÔºöÂêå Min resolved table ID ÊåáÊ†áÔºõ
‰ΩúÁî®ÔºöÊØè‰∏™ Changefeed ÊâÄÂú®ÁöÑ Capture ÁöÑÊúÄÂ∞è CheckpointTs ÁöÑË°®ÁöÑ TableIDÔºå‰ª• instance-changefeed-table-id Ê†ºÂºèÂàíÂàÜÊåáÊ†á„ÄÇÁî®‰∫éÈóÆÈ¢òËØäÊñ≠Êó∂ÔºåÂ∞ÜÊï¥‰ΩìÂª∂Êó∂Âú® CheckpointTs Â±ÇÈù¢ÁªÜÂàÜÂà∞Ë°®Á∫ß„ÄÇ
Changefeed checkpoint
‰∫ßÁîüÔºöapproximate current time (s) Ê∫êËá™ PD ÔºåÂèñÂΩìÂâç PD Áî≥ËØ∑ÁöÑÊúÄÂ§ß TSO Ë°®Á§∫ÈõÜÁæ§ÂΩìÂâçÊó∂Èó¥„ÄÇchangefeed„ÄÅinstance-changefeed„ÄÅchangefeed-barrierTs ÂùáÈááÁî® Prometheus Guage Á±ªÂûãÁªüËÆ°ÔºåÂú® Capture ËøêË°åÊó∂ËØ•ÊåáÊ†áÂàùÂßãÂåñÔºõ
ÂèòÊõ¥Ôºö</p>
<ol>
<li>changefeed Âú® Changefeed ÂàùÂßãÂåñÊó∂ÔºåËÆ∞ÂΩï‰∏ãÂØπÂ∫îÁöÑ ChangefeedIDÔºåÈöèÁùÄ Owner Tick ‰ºöËß¶Âèë Changefeed Tick ÔºåÂπ∂Âú® Changefeed Tick ‰∏≠Â∞ÜÂΩìÂâç Changefeed CheckpointTs Êõ¥Êñ∞„ÄÇ</li>
<li>instance-changefeed Âú® Processor ÂàùÂßãÂåñÊó∂ÔºåËÆ∞ÂΩï‰∏ãÂØπÂ∫î changefeedID Âèä advertiseAddrÔºåÂπ∂Âú® Processor Tick ‰∏≠Â∞ÜÂΩìÂâç Processor Ë¥üË¥£ÁöÑÂ§çÂà∂Ë°®ÁöÑÊúÄÂ∞è CheckpointTs ‰Ωú‰∏∫ minCheckpointTs„ÄÇ</li>
<li>changefeed-barrierTs Âú® Changefeed ÂàùÂßãÂåñÊó∂ÔºåËÆ∞ÂΩï‰∏ãÂØπÂ∫îÁöÑ ChangefeedIDÔºåÂú®ÊØèÊ¨°ÂèñÂ∞èÁöÑ BarrierTs ‰Ωú‰∏∫ÂΩìÂâç BarrierTs„ÄÇ
Ê∂à‰∫°Ôºö
changefeed„ÄÅchangefeed-barrierTs Âú® Changefeed ÈáäÊîæËµÑÊ∫êÊó∂ÔºåÂà†Èô§ÂØπÂ∫î ChangefeedIDÔºõ
instance-changefeed Âú® Processor ÈÄÄÂá∫Êó∂ÔºåÂà†Èô§ÂØπÂ∫î ChangefeedIDÔºõ
‰ΩúÁî®ÔºöÂàÜÂà´‰ªé changefeed „ÄÅÊØè‰∏™ Capture ‰∏äÁöÑ changefeed Áúã changefeed ÁöÑ minCheckpointTsÔºåË°®Á§∫ changefeed ÂêåÊ≠•Âà∞‰∏ãÊ∏∏ÁöÑÊúÄÂ∞èÊó∂Èó¥„ÄÇchangefeed-barrierTs Ë°®Á§∫ÂΩìÂâçÂêåÊ≠•ÁöÑ DDL Âèä syncPoint ÊúÄÂ∞èÊó∂Èó¥„ÄÇ
ÂéüÁêÜÔºöBarrierTs Ë¢´Â∞ÅË£ÖÂú® Changefeed struct ÂÜÖÈÉ®Ôºå‰∏ªË¶ÅÊúâ 3 Á±ªddlJobBarrier„ÄÅsyncPointBarrier„ÄÅfinishBarrierÔºåÊàëÁêÜËß£ ‰∏ªË¶ÅÊòØ‰∏∫‰∫ÜÂÆûÁé∞ exactly once Âä†ÁöÑÂ±ûÊÄßÔºåÂÖ∑‰ΩìÂÆûÁé∞Â∞±ÊòØÂÆûÈ™åÁâπÊÄß TiCDC syncpoint--&gt; <a href="https://pingcap.feishu.cn/wiki/wikcndyqbDagcVc99chsfkH5Rjf" target="_blank" rel="noreferrer">https://pingcap.feishu.cn/wiki/wikcndyqbDagcVc99chsfkH5Rjf</a></li>
</ol>
<p>Changefeed resolved ts
‰∫ßÁîüÔºöchangefeed„ÄÅinstance-changefeed ÈááÁî® Prometheus Guage Á±ªÂûãÁªüËÆ°ÔºåÂú® Capture ËøêË°åÊó∂ËØ•ÊåáÊ†áÂàùÂßãÂåñÔºõ
ÂèòÊõ¥Ôºö</p>
<ol>
<li>changefeed Âêå Changefeed checkpoint ÊåáÊ†áÔºõ</li>
<li>instance-changefeed Âêå Min resolved table ID ÊåáÊ†áÔºõ
Ê∂à‰∫°Ôºö</li>
<li>changefeed Âêå Changefeed checkpoint ÊåáÊ†áÔºõ</li>
<li>instance-changefeed Âêå Min resolved table ID ÊåáÊ†áÔºõ
‰ΩúÁî®ÔºöÂàÜÂà´‰ªé changefeed „ÄÅÊØè‰∏™ Capture ‰∏äÁöÑ changefeed Áúã changefeed ÁöÑ minResolvedTs„ÄÇ</li>
</ol>
<p>Changefeed checkpoint lag
‰∫ßÁîüÔºöchangefeed„ÄÅinstance-changefeed ÈááÁî® Prometheus Guage Á±ªÂûãÁªüËÆ°ÔºåÂú® Capture ËøêË°åÊó∂ËØ•ÊåáÊ†áÂàùÂßãÂåñÔºõ
ÂèòÊõ¥Ôºö</p>
<ol>
<li>changefeed Âêå Changefeed checkpoint ÊåáÊ†áÔºåÂîØ‰∏ÄÁöÑ‰∏çÂêåÊòØËÆ°ÁÆóÊñπÂºèÔºåOwner ‰ºö‰æøÂà©ÊâÄÊúâ Capture Âèñ minCheckpointTsÔºåÂèñ pd ÂΩìÂâç tso Áâ©ÁêÜ‰ΩçÂáè checkpointTsÔºõ</li>
<li>instance-changefeed Âêå Min resolved table ID ÊåáÊ†áÔºåÂîØ‰∏ÄÁöÑ‰∏çÂêåÊòØËÆ°ÁÆóÊñπÂºèÔºåÈÅçÂéÜË¥üË¥£ÁöÑÊâÄÊúâÂ§çÂà∂Ë°®ÂèñÂá∫ minCheckpointTsÔºåÂÜçÂèñ pd ÂΩìÂâç tso Áâ©ÁêÜ‰ΩçÂáè checkpointTs ÂæóÂá∫Âª∂ËøüÊó∂Èó¥Ôºõ
Ê∂à‰∫°Ôºö</li>
<li>changefeed Âêå Changefeed checkpoint ÊåáÊ†áÔºõ</li>
<li>instance-changefeed Âêå Min resolved table ID ÊåáÊ†áÔºõ
‰ΩúÁî®ÔºöÂàÜÂà´‰ªé changefeed „ÄÅÊØè‰∏™ Capture ‰∏äÁöÑ changefeed Áúã changefeed ÁöÑ minCheckpointTs„ÄÇ</li>
</ol>
<p>Changefeed resolved ts lag
‰∫ßÁîüÔºöchangefeed„ÄÅinstance-changefeed ÈááÁî® Prometheus Guage Á±ªÂûãÁªüËÆ°ÔºåÂú® Capture ËøêË°åÊó∂ËØ•ÊåáÊ†áÂàùÂßãÂåñÔºõ
ÂèòÊõ¥Ôºö</p>
<ol>
<li>changefeed Âêå Changefeed checkpoint ÊåáÊ†áÔºåÂîØ‰∏ÄÁöÑ‰∏çÂêåÊòØËÆ°ÁÆóÊñπÂºèÔºåOwner ‰ºö‰æøÂà©ÊâÄÊúâ Capture Âèñ minResolvedTsÔºåÂèñ pd ÂΩìÂâç tso Áâ©ÁêÜ‰ΩçÂáè checkpointTsÔºõ</li>
<li>instance-changefeed Âêå Min resolved table ID ÊåáÊ†áÔºåÂîØ‰∏ÄÁöÑ‰∏çÂêåÊòØËÆ°ÁÆóÊñπÂºèÔºåÈÅçÂéÜË¥üË¥£ÁöÑÊâÄÊúâÂ§çÂà∂Ë°®ÂèñÂá∫ minResolvedTsÔºåÂÜçÂèñ pd ÂΩìÂâç tso Áâ©ÁêÜ‰ΩçÂáè checkpointTs ÂæóÂá∫Âª∂ËøüÊó∂Èó¥Ôºõ
Ê∂à‰∫°Ôºö</li>
<li>changefeed Âêå Changefeed checkpoint ÊåáÊ†áÔºõ</li>
<li>instance-changefeed Âêå Min resolved table ID ÊåáÊ†áÔºõ
‰ΩúÁî®ÔºöÂàÜÂà´‰ªé changefeed „ÄÅÊØè‰∏™ Capture ‰∏äÁöÑ changefeed Áúã changefeed ÁöÑ minResolvedTs„ÄÇ</li>
</ol>
<p>Changefeed checkpoint derivative
Â§çÁî®ÁöÑ Changefeed checkpoint ÊåáÊ†áÔºåÊâÄ‰ª•‰∫ßÁîü„ÄÅÂèòÊõ¥„ÄÅÊ∂à‰∫°‰∏é Changefeed checkpoint Áõ∏ÂêåÔºå‰ΩÜÊîπÂèò‰∫Ü prometheus Ë°®ËææÂºèÔºå‰ΩøÁî® derive ÂáΩÊï∞Âèñ 1 ÂàÜÈíüÂÜÖÊó∂Â∫èÊï∞ÊçÆÁöÑÁÆÄÂçïÁöÑÁ∫øÊÄßÂõûÂΩíÂØºÊï∞Ôºõ
‰ΩúÁî®ÔºöÈ¢ÑÊµã Changefeed checkpoint ÁöÑÂèòÂåñË∂ãÂäø„ÄÇ
The status of changefeeds
‰∫ßÁîüÔºöÂêå Min resolved table ID ÊåáÊ†áÔºõ
ÂèòÊõ¥ÔºöÂú®ÊØèÊ¨° Owner Tick Êó∂ÔºåÂæ™ÁéØ‰æøÂà© changefeed Áä∂ÊÄÅÔºå0 Ë°®Á§∫ StateNormal„ÄÅ1 Ë°®Á§∫ StateError„ÄÅ2 Ë°®Á§∫ StateFailed„ÄÅ3 Ë°®Á§∫ StateStopped„ÄÅ4 Ë°®Á§∫ StateFinished„ÄÅ5 Ë°®Á§∫ StateRemoved„ÄÇ
Ê∂à‰∫°ÔºöÂú® resign owenr „ÄÅCapture ÈÄÄÂá∫Êàñ Capture ÈÉ®ÁΩ≤Êó∂‰ºöÈáçÁΩÆÔºõ
‰ΩúÁî®ÔºöÂà§Êñ≠ÊØè‰∏™ Changefeed ÁöÑÁä∂ÊÄÅ„ÄÇ</p>
<p>Changefeed checkpoint catch-up ETA
‰∫ßÁîüÔºöÂ§çÁî®ÁöÑ Changefeed checkpoint lag ÁöÑ changefeed Âèä Changefeed checkpoint derivative ÁöÑ changefeed ÊåáÊ†áÈ°π„ÄÇËÆ°ÁÆóÊñπÂºè‰∏∫ÔºåÂèñ checkpoint Âª∂ËøüÊúÄÂ§ßÂÄºÈô§ Changefeed checkpoint ÂèòÂåñÂ¢ûÈáèÔºõ
‰ΩúÁî®ÔºöËØÑ‰º∞ËøΩÂπ≥ÂêåÊ≠•Âª∂Êó∂ÁöÑÊó∂Èó¥„ÄÇ</p>
<p>Schema Storage GC progress
‰∫ßÁîüÔºöapproximate current time (s) Ê∫êËá™ PD ÔºåÂèñÂΩìÂâç PD Áî≥ËØ∑ÁöÑÊúÄÂ§ß TSO Ë°®Á§∫ÈõÜÁæ§ÂΩìÂâçÊó∂Èó¥„ÄÇchangefeed ÈááÁî® Prometheus Guage Á±ªÂûãÁªüËÆ°ÔºåÂú® Capture ËøêË°åÊó∂ËØ•ÊåáÊ†áÂàùÂßãÂåñÔºõ
ÂèòÊõ¥ÔºöÊØèÊ¨° Processor Tick Êó∂ÔºåÂèñ processor ÂØπÂ∫î changefeed ÁöÑ CheckpointTs - 1 ‰Ωú‰∏∫ÁõÆÊ†áÊó∂Èó¥„ÄÇprocessor Âª∫Á´ãÊó∂‰∫ßÁîü„ÄÇ
Ê∂à‰∫°Ôºöprocessor ÈÄÄÂá∫Êó∂Ê∂à‰∫°„ÄÇ
‰ΩúÁî®ÔºöÂú® Processor Âª∫Á´ãÊó∂‰ºöÂàõÂª∫‰∏Ä‰∏™ btree ÂÜÖÂ≠òÁª¥Êä§ Schema ÁöÑÂ§öÁâàÊú¨‰ø°ÊÅØÔºå‰ºöÂú® Tick Êó∂ÂÆöÊúü GCÔºåËØ•Èù¢Êùø‰∏ªË¶ÅÂèçÊò† GC ËøõÂ∫¶Ôºõ
Processor Memory Consumption Per Capture
‰∫ßÁîüÔºö
ÂèòÊõ¥ÔºöTablepipline ‰ºöËøΩË∏™ÊØè‰∏™ Table ÁöÑÂÜÖÂ≠òÊ∂àËÄóÔºåÂú®ÊØèÊ¨° Processor Tick Êó∂Ê±áÊÄªË¥üË¥£ÁöÑÂ§çÂà∂Ë°®ÂÜÖÂ≠òÊ∂àËÄóÔºåÂÜçÁî®ÊÄªÂÜÖÂ≠òÊ∂àËÄóÈô§Ë°®Êï∞ÈáèÔºåÂæóÂá∫ÊØè‰∏™Ë°®Ê∂àËÄóÂÜÖÂ≠òÂùáÂÄº„ÄÇ
‰ΩúÁî®ÔºöÂà§Êñ≠ÂΩìÂâçÂêåÊ≠•Ë°®ÁöÑÂπ≥ÂùáÂÜÖÂ≠òÊ∂àËÄóÊÉÖÂÜµ„ÄÇ
Processor Memory Consumption Per Changefeed
‰∫ßÁîüÔºö
ÂèòÊõ¥ÔºöÂ§çÁî® Processor Memory Consumption Per Capture ÊåáÊ†áÂÄºÔºå‰ΩÜËÆ°ÁÆóÊñπÂºèÊòØÁî®ÊÄªÂÜÖÂ≠òÊ∂àËÄóÈô§ Changefeed Êï∞ÈáèÔºåÂæóÂá∫ÊØè‰∏™ Changefeed Ê∂àËÄóÂÜÖÂ≠òÂùáÂÄº„ÄÇ
‰ΩúÁî®ÔºöÂà§Êñ≠ÂΩìÂâç Changefeed ÁöÑÂπ≥ÂùáÂÜÖÂ≠òÊ∂àËÄóÊÉÖÂÜµ„ÄÇ
PD etcd requests/s
‰∫ßÁîüÔºö
ÂèòÊõ¥ÔºöÊâÄÊúâÁöÑ Capture ‰∏é Etcd ‰∫§‰∫íÈÉΩ‰ºöÈÄöËøá EtcdWorkerÔºåÂú® Etcd ÂÜÖÈÉ®‰ºöËÆ∞ÂΩïÊâÄÊúâÊìç‰ΩúÊ¨°Êï∞ÔºåÊìç‰ΩúÁ±ªÂûãÂåÖÂê´ EtcdPut„ÄÅEtcdGet„ÄÅEtcdDel„ÄÅEtcdTxn„ÄÅEtcdGrant„ÄÅEtcdRevoke„ÄÇ
‰ΩúÁî®ÔºöËøΩË∏™ÊØè‰∏™ Captreure ‰∏é Etcd ‰∫§‰∫íÊÉÖÂÜµ„ÄÇ
Exit error count/m
‰∫ßÁîüÔºö
ÂèòÊõ¥ÔºöÂú®ÊØèÊ¨° Processor Tick ÁöÑÊó∂ÂÄôÔºåÂ¶ÇÊûúÈÅáËßÅ Processor ‰∏çÂèØÂøΩÁï•ÁöÑÈîôËØØÊó∂ Processor ‰æø‰ºöÈÄÄÂá∫Âπ∂Â∞ÜÂØπÂ∫îÂÄºÂä†‰∏Ä„ÄÇ
‰ΩúÁî®ÔºöËøΩË∏™ÊØè‰∏™ Changefeed Âú® Captreure ‰∏äÁöÑ Processor ÁöÑËøêË°åÊÉÖÂÜµ„ÄÇ
MySQL Sink Èù¢Êùø
MySQL sink write duration
‰∫ßÁîüÔºöHistogram Á±ªÂûã
ÂèòÊõ¥ÔºöMySQL Sink Worker Âêë‰∏ãÊ∏∏‰ª• Batch ÊâßË°åÊàêÂäüÁöÑËÄóÊó∂ÔºàÂåÖÂê´ÈáçËØïÁöÑÊó∂Èó¥ÔºâÔºåÊØèÊ¨° sink Âùá‰ºöÂèòÊõ¥ËØ•ÂÄº„ÄÇ
‰ΩúÁî®ÔºöTiCDC ÂºÇÊ≠•Âà∑ÂÜôÊï∞ÊçÆÂÖ•‰∏ãÊ∏∏ÁöÑËÄóÊó∂Áõ¥ÊñπÂõæ„ÄÇËøΩË∏™ MySQL sink ÁöÑËÄóÊó∂ÊÉÖÂÜµÔºàlike sql durationÔºå‰ΩÜ‰∏çÊòØ‰ª•Âçï‰∏™ SQL ‰∏∫Âçï‰ΩçÔºåËÄåÊòØ‰ª•‰∏Ä‰∏™ TxnBatch ‰∏∫Âçï‰ΩçÔºâ„ÄÇ
MySQL sink write duration percentile
Â§çÁî® Flush sink duration ÊåáÊ†áÔºå‰ª•ÂàÜ‰ΩçÂõæÂ±ïÁ§∫„ÄÇ
‰ΩúÁî®ÔºöÊØèÁßíÈíü‰∏≠ 95%„ÄÅ99% Âíå 99.9% ÁöÑÊÉÖÂÜµ‰∏ãÔºåTiCDC ÂºÇÊ≠•Âà∑ÂÜôÊï∞ÊçÆÂÖ•‰∏ãÊ∏∏ÊâÄËä±Ë¥πÁöÑÊó∂Èó¥„ÄÇ
MySQL sink write rows count/s
‰∫ßÁîüÔºö
ÂèòÊõ¥ÔºöÊØèÊ¨° Batch Âêë‰∏ãÊ∏∏ÊâßË°å DML Êó∂ÔºåBatch ‰∏≠ÁöÑË°åÊï∞Ôºõ
‰ΩúÁî®ÔºöÊØèÁßíÈíü‰∏≠ 95%„ÄÅ99% Âíå 99.9% ÁöÑÊÉÖÂÜµ‰∏ãÔºåTiCDC Â∞Ü‰∏Ä‰∏™‰∫ãÂä°ÁöÑ DML ÂàÜ Batch ÂÜôÂà∞‰∏ãÊ∏∏ÊâÄËä±Ë¥πÁöÑÊó∂Èó¥ÔºåÂÖ∂‰∏≠ÊØè‰∏™ Batch ÁöÑË°åÊï∞ËÆ°Êï∞„ÄÇ
MySQL sink write batch size percentile
Â§çÁî® MySQL sink write rows count/s ÊåáÊ†áÔºå‰ª•ÂàÜ‰ΩçÂõæÂ±ïÁ§∫„ÄÇ
‰ΩúÁî®ÔºöÊØèÁßíÈíü‰∏≠ 95%„ÄÅ99% Âíå 99.9% ÁöÑÊÉÖÂÜµ‰∏ãÔºåBatch ÁöÑÊÉÖÂÜµ„ÄÇ
MySQL sink conflict detect duration
‰∫ßÁîüÔºö
ÂèòÊõ¥Ôºö
‰ΩúÁî®ÔºöTiCDC ‰ºöÂ∞Ü‰∏äÊ∏∏‰∫ãÂä°ÊãÜÂàÜÔºåÂπ∂ÂàÜÂèëÁªô‰∏çÂêå worker ÊâßË°å‰ºöÈÄ†Êàê‰∫ãÂä°Èó¥ÁöÑÂÜ≤Á™ÅÔºåÂõ†Ê≠§‰ºöÂú®ÂàÜÂèë‰∫ãÂä°Êó∂ÊèêÂâçÊé¢ÊµãÂ≠òÂú®ÂÜ≤Á™Å„ÄÇÂ¶ÇÊûúÂàÜÂèëÁöÑ‰∫ãÂä°‰∏éÊú¨‰∏Ä‰∏™ worker Â≠òÂú®ÂÜ≤Á™ÅÔºåÂàôÂ∞ÜËØ•‰∫ãÂä°ÂèëÈÄÅÁªô‰∫ßÁîüÂÜ≤Á™ÅÁöÑ worker ÈòüÂàó„ÄÇÂ¶ÇÊûú‰∏éÂ§ö‰∏™ worker Â≠òÂú®ÂÜ≤Á™ÅÔºåÂàôÈúÄË¶ÅÁ≠âÂæÖÂÜ≤Á™ÅÁöÑ‰∫ãÂä°ÊâßË°åÂÆåÂÜçÊâßË°åÊú¨‰∫ãÂä°„ÄÇËØ•ÊåáÊ†áËÆ∞ÂΩïËØ•ËøáÁ®ãÂèëÁîüÁöÑÊó∂Èó¥ÔºåËØÑ‰º∞ÂΩìÂâç TiCDC ÂÜÖÈÉ®ÊòØÂê¶Â≠òÂú®Â§ßÈáè‰∫ãÂä°ÂÜ≤Á™ÅÔºå‰ª•ÁÉ≠ÂäõÂõæÂ±ïÁ§∫„ÄÇ
MySQL sink conflict detect duration percentile
Â§çÁî® MySQL sink conflict detect duration ÊåáÊ†á
‰ΩúÁî®ÔºöÊØèÁßíÈíü‰∏≠ 95%„ÄÅ99% Âíå 99.9% ÁöÑÊÉÖÂÜµ‰∏ãÔºåMySQL ÂÜôÂÖ•ÂÜ≤Á™ÅÊ£ÄÊµãËÄóÊó∂„ÄÇ
MySQL sink ddl execution duration percentile
‰∫ßÁîüÔºö
ÂèòÊõ¥ÔºöËÆ∞ÂΩïÊâßË°å DDL ËÄóÊó∂Ôºõ
‰ΩúÁî®ÔºöTiCDC ËäÇÁÇπ‰∏≠ÂÜô MySQL Á∫øÁ®ãÁöÑË¥üËΩΩÊÉÖÂÜµ„ÄÇ
MySQL sink worker load
‰∫ßÁîüÔºö
ÂèòÊõ¥ÔºöÂú® NewMySQLSink Êó∂ËÆ∞ÂΩïÊØè‰∏™ worker ÂèäÂØπÂ∫î changefeed„ÄÇ
‰ΩúÁî®Ôºösinkworker ÊØèÊâßË°åÊàêÂäü‰∏Ä‰∏™ DML txn ÔºåÈÉΩ‰ºöÂ∞ÜÂÖ∂ËÆ∞ÂΩïÂú® metricBucketSize ‰∏≠„ÄÇÂπ∂ÊåâÁÖß 0-2 row/s„ÄÅ2-10 row/s„ÄÅ10-100 row/s„ÄÅ&gt;100 row/s  ÁöÑÊ°£‰ΩçÂàíÂàÜÂΩìÂâç Sink Worker Ë¥üËΩΩÔºåÂå∫ÂàÜÊâÄÊúâ worker ÂΩìÂâçÁöÑË¥üËΩΩÊÉÖÂÜµ„ÄÇ
large data event size (MySQL)
‰∫ßÁîüÔºö
ÂèòÊõ¥ÔºöÂú® NewMySQLSink Êó∂ËÆ∞ÂΩïÊØè‰∏™ worker ÂèäÂØπÂ∫î changefeed„ÄÇ
‰ΩúÁî®ÔºöÊØèÁßíÈíü‰∏≠ 95%„ÄÅ99% Âíå 99.9% ÁöÑÊÉÖÂÜµ‰∏ãÔºåÂ§ß RowChangedEvent ÁöÑÁªüËÆ°ÊÉÖÂÜµ„ÄÇ
ÂéüÁêÜÔºöÊØèÊ¨°ÊâßË°å DML ‰πãÂâç Capture ‰ºöÊé¢Êµã protobuf Ê∂àÊÅØÂ§ßÂ∞èÔºåÂΩìË∂ÖËøá 128K Êó∂Â∞ÜÂÖ∂ËÆ∞ÂΩï‰ΩçÂ§ß‰∫ãÂä°„ÄÇ</p>
<p>Dataflow Èù¢Êùø
Puller output events/s
‰∫ßÁîüÔºöCounter
ÂèòÊõ¥Ôºö
‰ΩúÁî®Ôºö‰ª• changefeed, instance, type ÂàÜÁªÑÊòæÁ§∫ÔºåTiCDC ËäÇÁÇπ‰∏≠ Puller Ê®°ÂùóÊØèÁßíÊî∂Âà∞Êù•Ëá™ KV client Ê®°ÂùóÁöÑÊï∞ÊçÆÂèòÊõ¥‰∏™Êï∞„ÄÇËøΩË∏™ tikv Âà∞ Capture ÁöÑ event Êé®ÈÄÅÊÉÖÂÜµ„ÄÇ
ÂéüÁêÜÔºöTablepipline ‰ºöÁî≥ËØ∑ TableActor ÂàõÂª∫ÂØπÂ∫îÁöÑ pullerÔºåËÆ∞ÂΩï kv Âèä resolved 2 ÁßçÁ±ªÂûãÁöÑ RegionFeedEvent ÔºåÊØèÊé•Âà∞ 1 ÁªôÂØπÂ∫î‰∫ã‰ª∂‰æøËÆ∞ÂΩï„ÄÇ</p>
<p>Puller output events
Â§çÁî® Puller output events/s Èù¢Êùø</p>
<p>Sorter output events/s
‰∫ßÁîüÔºöCounter
ÂèòÊõ¥Ôºö
‰ΩúÁî®Ôºö‰ª• changefeed, instance, type ÂàÜÁªÑÊòæÁ§∫ÔºåTiCDC ËäÇÁÇπ‰∏≠ÁºìÂ≠òÂú® Sorter Ê®°Âùó‰∏≠ÁöÑÊï∞ÊçÆÂèòÊõ¥‰∏™Êï∞ÔºåÂè™Ë¶Å Actor Êé•Âà∞‰∫ÜËØªÂèñÊ∂àÊÅØ‰æø‰ºö‰ªé LevelDB ‰∏≠ËØªÂèñÂá∫ÂØπÂ∫îÁöÑ EventÔºåÂπ∂Â∞ÜÂÖ∂ËÆ∞ÂΩïÂà∞Â∫îËØ•Âà†Èô§Êï∞ÊçÆÁöÑ Buffer ‰∏≠„ÄÇ
ÂéüÁêÜÔºöTablepipline ‰ºöÁî≥ËØ∑ TableActor ÂàõÂª∫ÂØπÂ∫îÁöÑ sorterÔºåËÆ∞ÂΩï kv Âèä resolved 2 ÁßçÁ±ªÂûãÁöÑ RegionFeedEvent ÔºåÂπ∂Âú® Actor  Sorter Reader ÁöÑ Poll ÊñπÊ≥ï‰∏≠ÂèòÊõ¥ÁõëÊéß„ÄÇ</p>
<p>Puller output events
Â§çÁî® Sorter output events/s</p>
<p>Mounter output events/s
‰∫ßÁîüÔºöGuage
ÂèòÊõ¥Ôºö
‰ΩúÁî®Ôºö
ÂéüÁêÜÔºöÊØè‰∏™ TableActor ÂêØÂä®ÂêéÔºå‰ºöÂêØÂä®ÂØπÂ∫îÁöÑ TableSorterÔºåÊØè‰∏™ Sorter ‰∏≠‰ºöËÆ∞ÂΩï PUT Âíå DELETE Á±ªÂûãÔºàÊ≤°Êúâ Resolved Á±ªÂûãÔºâÁöÑ Event Ëß£Á†Å‰∫ã‰ª∂ÔºåÂú®ÊØè‰∏™ sorterNode ÂêØÂä®Âêé
Mounter output events
Â§çÁî® Mounter output events/s Èù¢Êùø</p>
<p>Table sink output events/s
‰∫ßÁîüÔºöGuage
ÂèòÊõ¥Ôºö
‰ΩúÁî®Ôºö
ÂéüÁêÜÔºöTable Actor ÊØèÊ¨° Poll ÁöÑÊó∂ÂÄôÔºå‰ª• sinkFlushInterval = 500 * time.Millisecond ‰∏∫Âë®ÊúüÂ∞ÜÁªìÊûÑ‰Ωì‰∏≠ËÆ∞ÂΩïÁöÑÂ≠óÊÆµÊõ¥Êñ∞Âà∞ÁõëÊéß‰∏≠ÔºåÂÖ∂Êï∞ÊçÆÁöÑ‰∫ßÁîüÊ∫êËá™ÊØèÊ¨°Âêë‰∏ãÊ∏∏ flush Êó∂ÔºåÂ∞ÜÂÖ∂Âä†ÂêàÂà∞ÁªìÊûÑ‰ΩìÁªüËÆ°Â≠óÊÆµ‰∏≠„ÄÇ
Table sink output events</p>
<p>Sink received events/s
‰ª• flushMetricsInterval = 5 * time.Second ‰∏∫Âë®ÊúüÔºåËÆ≤
Sink received events
Â§çÁî® Sink received events/s Èù¢Êùø</p>
<p>Sink flush rows/s
ÂêåÊ†∑ÊòØÁªìÊûÑ‰ΩìÂ≠óÊÆµ</p>
<p>Sink flush rows</p>
<p>DB Èù¢Êùø
On disk data size
ÂèòÊõ¥Ôºö‰ª• backgroundJobIntervalÔºà15sÔºâ‰∏∫Âë®ÊúüÔºåÂèòÊõ¥ÊåáÊ†áÂÄº„ÄÇ
Ê∂à‰∫°ÔºöCaptureÔºànewBackEndPoolÔºâ ÈÄÄÂá∫Êó∂ÔºåËØ•ÊåáÊ†á‰∏çÂÜçËÆ∞ÂΩïÊñ∞ÂÄº„ÄÇ
‰ΩúÁî®Ôºö‰ª• instance ÂàÜÁ±ªÂ±ïÁ§∫Á£ÅÁõòÂç†Áî®Á©∫Èó¥ÔºåÊúÄÊñ∞Áâà TiCDC ‰ΩøÁî® PebbelDBÔºàLevelDBÔºâ‰Ωú‰∏∫Êï∞ÊçÆÊåÅ‰πÖÂåñÂÆπÂô®Ôºå‰ΩúÁî®‰∏∫Ê£ÄÊµãËØ•ÂÆπÂô®ÂÜÖÊï∞ÊçÆÂ§ßÂ∞è„ÄÇ
ÂéüÁêÜÔºönewBackEndPool ‰∏≠‰ª• 0 ‰∏∫ id Ë¢´ÂàùÂßãÂåñ‰∏∫ metricSorterOnDiskDataSizeGauge ÔºåÊòØ‰∏Ä‰∏™ÂçïÁã¨ÁöÑ goroutine„ÄÇ‰Ωé‰∫é MaxMemoryConsumptionÔºà16GBÔºâ‰∏î‰Ωé‰∫é MaxMemoryPercentageÔºà30%ÔºâÊÉÖÂÜµ‰∏ãÂè™‰ΩøÁî® MemoryBackEndÔºåÂ∞±‰∏ç‰ºöÁî®Âà∞Á£ÅÁõòÁ©∫Èó¥„ÄÇ
In-memory data size
ÂèòÊõ¥Ôºö‰∏é On disk data size Áõ∏Âêå
Ê∂à‰∫°Ôºö‰∏é On disk data size Áõ∏Âêå
‰ΩúÁî®Ôºö‰ª• instance ÂàÜÁ±ªÂ±ïÁ§∫ÁõëÊéßÂÜÖÂ≠òÂç†Áî®ÊÉÖÂÜµ„ÄÇcache-hit-instance Âàô‰ª• instance ÂàÜÁ±ªÂ±ïÁ§∫ PebbleDB ‰∏≠ LRU BlockCache ÁöÑ hit ÊÉÖÂÜµ„ÄÇ
ÂéüÁêÜÔºömemoryBackEnd ÂÜÖÈÉ®Â∞ÅË£Ö‰∫Ü‰∏Ä‰∏™ model.PolymorphicEvent Á±ªÂûãÁöÑÂàáÁâáÔºåÁî®‰∫éÊéíÂ∫èÊï∞ÊçÆ„ÄÇticdc_db_block_cache_access_totalÔºàcache-hit-instanceÔºâ Ê∫êËá™‰∫é PebbleDB ÂÜÖÈÉ®ÔºåÁî®‰∫éÊ£ÄÊµãÁºìÂ≠òÂëΩ‰∏≠ÊÉÖÂÜµ„ÄÇ
Level files
ÂèòÊõ¥Ôºö‰∏é On disk data size Áõ∏Âêå
Ê∂à‰∫°Ôºö‰∏é On disk data size Áõ∏Âêå
‰ΩúÁî®Ôºö‰ª• instance-level ÂàÜÁ±ªÔºåË°®Á§∫ PebbleDB ÊØèÂ±ÇÁöÑÊñá‰ª∂‰∏™Êï∞Ôºå‰ªé Pebble ÁöÑ MetricsÔºàÔºâ Êé•Âè£ÂÆöÊúüÂèñÊï∞ÊçÆÊõ¥Êñ∞ÁõëÊéßÔºõ
ÂéüÁêÜÔºöÈªòËÆ§ÂºÄ 7 Â±ÇÔºåÈÉΩÊòØÁ°¨ÁºñÁ†ÅÁõÆÂâçÊó†Ê≥ïÊõ¥ÊîπÔºåÁ¨¨‰∏ÄÂ±Ç 8 MB Ôºå2~3 Â±ÇÈªòËÆ§‰∏∫Ââç‰∏ÄÂ±Ç 2 ÂÄçÂ§ßÂ∞èÔºåÂÖ∂‰ΩôÂ±ÇÈªòËÆ§ 2 MB„ÄÇ
Write duration
ÂèòÊõ¥ÔºöÊØèÊ¨°Âêë PebbleDB ÂèëÂÜôËØ∑Ê±ÇÊó∂ÔºåËÆ∞ÂΩïËØ∑Ê±ÇÊâßË°åÊó∂Èó¥„ÄÇ
Ê∂à‰∫°ÔºöÂØπÂ∫î Actor ÈÄÄÂá∫Êó∂ÂØπÂ∫îÊåáÊ†á‰∏çÂÜçËÆ∞ÂΩï„ÄÇ
‰ΩúÁî®Ôºö‰ΩøÁî®ÁÉ≠ÂäõÂõæÂ±ïÁ§∫ TiCDC Âú® PebbleDB ÂèëÂÜôËØ∑Ê±ÇÁöÑÊâßË°åÊó∂Èó¥ÔºåÁî®‰∫éÂà§Êñ≠Âú®ÂÜô‰∏äÊòØÂê¶Â≠òÂú®Áì∂È¢à„ÄÇ
ÂéüÁêÜÔºöÂú®Âêë PebbleDB ÂèëËµ∑ WriteÔºàforce writeÔºâ„ÄÅDeleteÔºànon-force writeÔºâ Êó∂ÔºåËÆ∞ÂΩïÊØèÊ¨°ËØ∑Ê±Ç‰ªéÂºÄÂßãÂà∞ÂÆåÊàêÁöÑÊó∂Èó¥„ÄÇNewDBActor ÂàõÂª∫Êó∂ÂØπÂ∫î ActorID ÊåáÊ†áË¢´ËÆ∞ÂΩïÔºåÂÖ≥Èó≠ÂØπÂ∫î DBActor Êó∂ÂØπÂ∫î ActorID ‰∏çÂÜçËÆ∞ÂΩïÔºåÊØèÊ¨°Ë∞ÉÁî® maybeWrite ËÆ∞ÂΩïÂèòÊõ¥„ÄÇ
Write speed
ÂèòÊõ¥ÔºöÂêå Write durationÔºõ
Ê∂à‰∫°ÔºöÂêå Write durationÔºõ
‰ΩúÁî®Ôºöinstance-sorter ‰ª• instance ‰∏∫ÂàÜÁ±ªÔºåÊòæÁ§∫ÂÜôÂÖ• Sorter Actor Êï∞ÊçÆÁöÑÂ§ßÂ∞èÔºõ
instance-amplification ‰ª• instance ‰∏∫ÂàÜÁ±ªÔºåÁî® histogram ÁöÑ total/sum ,Âç≥ÔºöÊØèÂàÜÈíüÂπ≥ÂùáÂÜôÂÖ• PebbelDB Â≠óËäÇÊï∞ Èô§ ÊØèÂàÜÈíüÂπ≥ÂùáÂÜôÂÖ•Ê¨°Êï∞ÔºåÊòæÁ§∫ÊØèÊ¨°Âπ≥ÂùáÂÜôÂÖ•Â≠óËäÇÊï∞ÔºåË°®Á§∫ Event Âú®ËêΩÁõòÊéíÂ∫èÊó∂ÊîæÂ§ßÊÉÖÂÜµÔºõ
instance-disk ‰ª• instance ÂàÜÁ±ªÔºåÊòæÁ§∫ÂÜôÂà∞ PebbleDB ‰∏≠ÁöÑÊï∞ÊçÆÂ§ßÂ∞èÔºõ
ÂéüÁêÜÔºö‰∏é Write duration ÂéüÁêÜÁõ∏ÂêåÔºåÂè™‰∏çËøáËÆ∞ÂΩïÁöÑÊï∞ÊçÆÂèòÊàê‰∫ÜËØ∑Ê±Ç‰∏≠Êï∞ÊçÆÁöÑÂ§ßÂ∞èÔºå‰∏äËø∞ 3 È°πÈÉΩÊòØ ticdc_sorter_db_write_bytes_total ÁöÑ‰∏çÂêåÁªÑÂêàÂèòÂåñÊâÄÂæó„ÄÇ
CPU Usage
ÂèòÊõ¥ÔºöÊØèÊ¨° Actor Á≥ªÁªüÊâßË°å Poll ËØ∑Ê±ÇÊó∂ËÆ∞ÂΩïÁ∫øÁ®ãËÄóÊó∂ÔºåÂèòÊõ¥ËØ•ËÆ∞ÂΩï„ÄÇ
Ê∂à‰∫°ÔºöCapture ÈÄÄÂá∫Êó∂Ôºõ
‰ΩúÁî®Ôºöinstance-name ‰ª• instance Âíå system name ‰∏∫ÂàÜÁ±ªÔºåÁªüËÆ°ÊòæÁ§∫ÊØè‰∏™ worker ÁöÑ CPU Á∫øÁ®ãÁöÑ‰ΩøÁî®ÁéáÔºõ
ÂéüÁêÜÔºöÈªòËÆ§ maxWorkerNum ‰∏∫ 64ÔºåÂ¶ÇÊûúÈÖçÁΩÆÁöÑ numberWorker &lt;= 0 ÂàôÁΩÆ‰∏∫ 1ÔºåÂ¶ÇÊûúÂ§ß‰∫é nunberWorker &gt; maxWorkerNumÔºåÂàôÁΩÆ‰∏∫ maxWorkerNum„ÄÇÂèØÈÖçÁΩÆ NumWorkerPoolGoroutine ‰øÆÊîπÔºå‰ΩÜË¢´ÊïÖÊÑèÈöêËóèÔºåÂç≥ÔºöÂÆòÁΩëÊú™ÁªôÂá∫ TiUP ÈÖçÁΩÆÊñπÊ≥ï„ÄÇÊØèÊ¨° Actor ÊâßË°å Poll ÁöÑÊó∂ÂÄôËÆ∞ÂΩïËøôÊ¨° Actor ÊâßË°å Poll ÁöÑÊó∂Èó¥„ÄÇ
Write bytes
Â§çÁî®ÁöÑ Write speed ÊåáÊ†áÔºå‰ª•ÁÉ≠ÂäõÂõæÁöÑÊñπÂºèÊï¥‰ΩìÊòæÁ§∫ÂÜôÂà∞ PebbleDB ÁöÑÂ§ßÂ∞è„ÄÇ
Write OPS
Â§çÁî®ÁöÑ Write speed ÊåáÊ†áÔºå‰ª•Êó∂Â∫èÂõæÁöÑÊñπÂºèÊï¥‰ΩìÊòæÁ§∫ÊØèÁßíÂÜôÂà∞ PebbleDB ÁöÑÊ¨°Êï∞„ÄÇ
Write delay
ÂèòÊõ¥Ôºö‰ª• 15s ‰∏∫Âë®ÊúüÊõ¥Êñ∞ Sorter Actor ÂèëÁîü WriteStall ÂØºËá¥ÂÜôÂª∂ËøüÁöÑÊó∂Èó¥ÂèäÊ¨°Êï∞„ÄÇ
Ê∂à‰∫°ÔºöPebbleDB ‰∏çÂèëÁîü WriteStall Êó∂‰∏çËÆ∞ÂΩï„ÄÇ
‰ΩúÁî®ÔºöPebbleDB ÂèëÁîü WriteStall Êó∂ËÆ∞ÂΩï„ÄÇ
instance-duration ‰ª• instance ÂàÜÁ±ªÔºåÊòæÁ§∫ TiCDC ÂèëÁîüÂÜôÂª∂ËøüÁöÑÊó∂Èó¥ÔºåÂç≥ÔºöËß¶Âèë PebbleDB WriteStall ÁöÑÂª∂ËøüÊó∂Èó¥„ÄÇ
instance-count ‰ª• instance ÂàÜÁ±ªÔºåÊòæÁ§∫ TICDC ÂèëÁîüÂπ≥ÂùáÊØèÁßíÂÜôÂª∂ËøüÁöÑÂèëÁîüÊ¨°Êï∞„ÄÇ
ÂéüÁêÜÔºöÈÄöËøá‰ª• backgroundJobInterval  Âë®ÊúüÊÄßË∞ÉÁî® p.metricWriteStall.duration.Load() Êü•ËØ¢ PebbleDB ÂèëÁîü WriteStall ÁöÑÊó∂Èó¥ÔºåËÆ∞ÂΩï‰∏∫ÂÜôÂª∂ËøüÁöÑÊó∂Èó¥„ÄÇ
Read duration - First
ÂèòÊõ¥ÔºöÂàõÂª∫ Sorter Êó∂ÔºåÂàùÂßãÂåñ first Ê†áÁ≠æÔºåActor ÊØèÊ¨°Â∞ùËØï‰ª• 0 ‰∏∫ TS Ëé∑ÂèñËø≠‰ª£Âô®Êó∂ÂèëÁîüÂèòÊõ¥ÔºåÂπ∂ËÆ∞ÂΩïÊ∂àËÄóÁöÑÊó∂Èó¥„ÄÇ
Ê∂à‰∫°ÔºöÂΩì Actor ‰∏çÂÜçËé∑ÂèñËø≠‰ª£Âô®ÔºåÊàñ Capture ÈÄÄÂá∫Êó∂‰∏çÂÜçËÆ∞ÂΩïÁ¨¨‰∏ÄÊ¨° Seek ÁöÑÊó∂Èó¥„ÄÇ
‰ΩúÁî®Ôºö‰ª• instance-sorter ‰∏∫ÂàÜÁ±ªÔºåÁî®ÁÉ≠ÂäõÂõæÂΩ¢ÂºèÂ±ïÁ§∫ÊØè‰∏™ instance Âπ≥ÂùáÊØèÂàÜÈíüËé∑ÂèñËø≠‰ª£Âô®ÁöÑËÄóÊó∂„ÄÇ
ÂéüÁêÜÔºöË°®Á§∫ Actor Ëé∑Âèñ‰ª• 0 ‰∏∫ TS Seek Êï¥‰∏™ PebbleDB ÊñπÂºèËé∑ÂèñËø≠‰ª£Âô®ÔºåÂõ†‰∏∫ TS ‰∏∫ 0ÔºåÊâÄ‰ª•‰ºöËø≠‰ª£ÊâÄÊúâÊï∞ÊçÆËæÉ‰∏∫ËÄóÊó∂ÔºåËÆ∞ÂΩïÁ¨¨‰∏ÄÊ¨°Ëø≠‰ª£Ê∂àËÄóÊó∂Èó¥„ÄÇ
Read duration - Next
ÂèòÊõ¥ÔºöÊØèÊ¨°Ëø≠‰ª£ÊéíÂ∫è key Êó∂ÔºåËÆ∞ÂΩïËø≠‰ª£ÊØè‰∏™ Key Êó∂Ê∂àËÄóÁöÑÊó∂Èó¥Ôºõ
Ê∂à‰∫°ÔºöÊ≤°ÊúâËø≠‰ª£ key Êó∂‰∏çÂú®ËÆ∞ÂΩïÔºåÊàñ Sorter ActorÔºàCaptureÔºâ ÈÄÄÂá∫‰∏çÂú®ËÆ∞ÂΩï„ÄÇ
‰ΩúÁî®Ôºö‰ª•ÁÉ≠ÂäõÂõæÂΩ¢ÂºèÔºåË°®Á§∫ÊØèÊ¨°Ëø≠‰ª£ PebbleDB ÁöÑ key ÁöÑËÄóÊó∂Ôºå‰ª•‰æøÊé¢Êü• Pebble Sorter ÊòØÂê¶Â≠òÂú®ÊÄßËÉΩÈóÆÈ¢ò„ÄÇ<br>
Read duration - Release
ÂèòÊõ¥ÔºöÂΩì Actor ÂÖ≥Èó≠Êàñ Pebble Ëø≠‰ª£Âô®‰∏çÂèØÁî®ÔºàÊ≤°ÊúâÁõ∏Âêå key ÂèØËø≠‰ª£‰∫ÜÔºâÊàñË∂ÖËøá iterMaxAliveDurationÔºà10000msÔºâÁöÑÊó∂ÂÄôÔºåÈáäÊîæËø≠‰ª£Âô®ÔºåÂπ∂ËÆ∞ÂΩïÂÖ∂ËÄóË¥πÁöÑÊó∂Èó¥Ôºõ
Ê∂à‰∫°ÔºöÊ≤°ÊúâÂèØËø≠‰ª£ÁöÑ key Êó∂Ôºå Actor Ëø≠‰ª£Âô®‰æø‰∏çËÆ∞ÂΩïÔºåÊàñ Capture ÈÄÄÂá∫Êó∂‰∏çÂÜçËÆ∞ÂΩïÔºõ
‰ΩúÁî®ÔºöÁî®ÁÉ≠ÂäõÂõæÂΩ¢ÂºèÔºåË°®Á§∫ÊØèÊ¨°ÈáäÊîæËø≠‰ª£Âô®ËÄóÊó∂ÊÉÖÂÜµÔºõ
Read OPS - First
Â§çÁî® Read duration ÊåáÊ†áÔºåË°®Á§∫ÊØèÁßíÂÆåÊàêÂ§öÂ∞ëÊ¨°Ëé∑Âèñ Actor Pebble Ëø≠‰ª£Âô®Êìç‰Ωú„ÄÇ
Read OPS - Next
Â§çÁî® Read duration ÊåáÊ†áÔºåË°®Á§∫ÊØèÁßíÂÆåÊàêÂ§öÂ∞ëÊ¨°Ëé∑Âèñ Actor Ëø≠‰ª£ key Êìç‰Ωú„ÄÇ
Read OPS - Release
Â§çÁî® Read duration ÊåáÊ†áÔºåË°®Á§∫ÊØèÁßíÂÆåÊàêÂ§öÂ∞ëÊ¨°Ëé∑Âèñ Actor ÈáäÊîæËø≠‰ª£Âô®Êìç‰Ωú„ÄÇ
Compact duration
ÂèòÊõ¥ÔºöÊØèÊ¨°Ëß¶Âèë Poll ÂØπ PebbleDB ËøõË°å CompactionÔºåËÆ∞ÂΩï‰∏ã‰ªéËß¶ÂèëÂà∞ÂÆåÊàêÁöÑËÄóÊó∂Ôºõ
Ê∂à‰∫°ÔºöÊú™Êª°Ë∂≥Ëß¶Âèë Compaction Êù°‰ª∂Êó∂‰∏çËÆ∞ÂΩïÔºõ
‰ΩúÁî®Ôºö‰ª•ÁÉ≠ÂäõÂõæÁöÑÊñπÂºèÔºåË°®Á§∫ Sorter Âú® Compaction Êìç‰Ωú‰∏äÁöÑÊï¥‰ΩìËÄóÊó∂Ôºå‰ª•‰æøÂàÜÊûê Sorter ÊòØÂê¶Â≠òÂú®ÊÄßËÉΩÈóÆÈ¢ò„ÄÇ
ÂéüÁêÜÔºöCapture ÂêØÂä®Êó∂‰º¥Èöè Actore system ÂêØÂä®Ôºå Comapction ‰∏™Êï∞‰∏éÈªòËÆ§ÂêØÂä®ÁöÑ PebbleDB instance Êï∞ÈáèÁõ∏ÂêåÔºåÂç≥Ôºö 8‰∏™„ÄÇ</p>
<p>Events Èù¢Êùø
Eventfeed count
ÂèòÊõ¥Ôºö
Ê∂à‰∫°Ôºö
‰ΩúÁî®Ôºö
ÂéüÁêÜÔºö
ÂØπ‰∫é ticdc_kvclient_event_feed_count ÂΩì changefeed ÂàõÂª∫Êó∂‰ºöÂú® puller ‰∏ãÂàùÂßãÂåñ‰∏Ä‰∏™  changefeedSesionÔºåÂàõÂª∫ÊàêÂäüÂàôËÆ°Êï∞‰ºöÂ¢ûÈïøÔºåsession goroutine Êé®Âá∫‰ºöÈôç‰ΩéÔºõ
ÂØπ‰∫é grpc_client_started_total Âπ∂Ê≤°ÊúâÂú®‰ª£Á†Å‰∏≠ÊâæÂà∞ÂØπÂ∫îÂÜÖÂÆπÔºå‰º∞ËÆ°ÊòØÂ§Ñ‰∫é‰ªÄ‰πàËÄÉËôëÂêéÊù•Âà†Èô§‰∫ÜËøô‰∏™ÊåáÊ†á„ÄÇ</p>
<p>Event size percentile
ÂèòÊõ¥Ôºö
received Ë°®Á§∫ regionWorker ÊØèÂ§ÑÁêÜ‰∏Ä‰∏™ EventÔºàÂåÖÂê´Event_Entries_„ÄÅEvent_Admin_„ÄÅEvent_Error„ÄÅEvent_ResolvedTsÔºâÔºå‰æøËÆ∞ÂΩï‰∏ãËøô‰∏™ Event ÁöÑ Grpc Â§ßÂ∞èÔºõ
dropped Ë°®Á§∫Âú®Â§ÑÁêÜ Event Êó∂ÔºåÂ¶ÇÊûúÊòØ Event_Entries_ Á±ªÂûãÊï∞ÊçÆÔºåÂàôËÆ∞ÂΩï‰∏ã Grpc Â§ßÂ∞èÔºõ
Ê∂à‰∫°ÔºöregionWorker ÈÄÄÂá∫Êó∂‰∏çÂÜçËÆ∞ÂΩïÊï∞ÊçÆÔºõ
‰ΩúÁî®ÔºöÔºà999 Á∫øÔºå99 Á∫øÔºâÂà§Êñ≠ RregionWorker Âú®Êé•Âèó TiKV ËøîÂõûÁöÑÊï∞ÊçÆÂ§ÑÁêÜ‰∏äÊòØÂê¶Â≠òÂú®Áì∂È¢àÔºåÊòØÂê¶Â≠òÂú®Â§ß EventÔºõ
ÂéüÁêÜÔºöregionWorker ‰ª• changefeedID„ÄÅeventFeedSessionÔºàÂÖ∂ÂÆûÂ∞±ÊòØ table range ÁöÑ region ‰∫§‰∫í‰ºöËØùÔºâ„ÄÅstoreAddr Ê†áÂÆöÂîØ‰∏ÄÁöÑ region WorkerÔºå‰πüÂ∞±ÊòØËØ¥ 1 ‰∏™ region worker ÂØπÂ∫îË°®Áª¥Êä§ÁùÄ N ‰∏™Êï∞ÈáèÁöÑ table regionÔºåÂΩìË∂ÖËøá regionWorkerInputChanSizeÔºà128Ôºâ * 0.7 ‰æøÂ§ÑÁêÜÂØπÂ∫îÊé•Êî∂Âà∞ÁöÑ event„ÄÇWorkerConcurrent Êú¨Ë∫´ÊòØ‰∏™ÊúçÁî®Á∫øÁ®ãÊ±†ÔºåÈªòËÆ§ 8 ‰∏™ÔºåÂç≥ÊØè‰∏™ tableRange ÁöÑÂ§ÑÁêÜ‰ºöËµ∑ 8 ‰∏™ region Worker ÂéªÂ§ÑÁêÜÊé•Êî∂Âà∞ÁöÑ event„ÄÇ
Eventfeed error/m
ÂèòÊõ¥Ôºö
{{type}}
NotLeader
EpochNotMatch
RegionNotFound
DuplicateRequest
Unknown
RPCCtxUnavailable
SendRequestToStore
ConnectToStore</p>
<p>transfer-leader„ÄÅmove-regionÊòØ‰ªé PD Ëé∑ÂèñÁöÑ schedule operator ÂàõÂª∫ÊÉÖÂÜµÔºåÁî®Êà∑ÂàÜÊûê error ÂèëÁîüÂéüÂõ†Ôºõ
Ê∂à‰∫°ÔºöPuller Êàñ Capture ÈÄÄÂá∫Êó∂
‰ΩúÁî®ÔºöÂàÜÊûêÂΩìÂâçÊé•Êî∂ tikv ÊòØÂê¶Â≠òÂú®ÈóÆÈ¢òÔºåÊàñÂ§ßÈáè transfer-leader ÂØºËá¥ÊÄßËÉΩÂú∞‰∏ãÔºõ
ÂéüÁêÜÔºöÈíàÂØπ ticdc_kvclient_event_feed_error_count ÔºåÊØè‰∏™ eventFeedSession ‰ºöÁªüËÆ°‰∏é tikv ÈìæÊé•ËøáÁ®ã‰∏≠ÂèëÁîüÁöÑÈîôËØØÔºåÂ¶ÇÂÖ∂ÂêçÊâÄÁ§∫ÔºåÂâç 5 È°πÊòØ‰∏é Event Áõ∏ÂÖ≥ TiKV ËøîÂõûÁöÑ„ÄÇ</p>
<p>KV client receive events/s
ÂèòÊõ¥ÔºöregionWorker Â§ÑÁêÜ event Êó∂ÔºåÊõ¥Êñ∞ÂØπÂ∫îÊåáÊ†áÔºõ
Ê∂à‰∫°ÔºöPuller Êàñ Capture ÈÄÄÂá∫Êó∂
‰ΩúÁî®ÔºöÂØπ Event_INITIALIZED„ÄÅEvent_COMMITTED„ÄÅEvent_COMMIT„ÄÅEvent_PREWRITE„ÄÅEvent_ROLLBACK„ÄÅnative-resolved„ÄÅcommit„ÄÅcommitted ÂàÜÁ±ªÁªüËÆ°ÔºåÂàÜÊûêÊé•ÂèóÂà∞ event ÁöÑÂêûÂêêÊÉÖÂÜµÔºåÂèäÁøªËØë grpc event ‰∏∫ region event Êó∂ÊòØÂê¶Â≠òÂú®ÊÄßËÉΩÈóÆÈ¢ò„ÄÇ
ÂéüÁêÜÔºöÔºåÂ∏¶ Event_ ÂâçÁºÄÁöÑË°®Á§∫‰ªé GRPC Êé•Âà∞ÁöÑÊï∞ÊçÆÔºånative-resolved Ë°®Á§∫ regionWorker Â§ÑÁêÜ resolvedTs ÁöÑÊ¨°Êï∞Ôºåcommit„ÄÅcommitted ‰∏éÂ∏¶ÂâçÁºÄÁöÑÁõ∏ÂØπÂ∫îÔºåÂ¶ÇÔºöEvent_COMMITTED Á±ª event ‰ºöÁªèËøá regionWorker ‰ºöÂ∞ÜÂÖ∂ grpc event ËΩ¨Êç¢Â∞ÅË£ÖÊàêÂÜÖÈÉ® reventÔºàregion EventÔºâ„ÄÇ
Puller output events/s
ÂèòÊõ¥ÔºöÂè™Ë¶Å puller Âú®ÊåÅÁª≠‰∏çÊñ≠ÁöÑ pull Êï∞ÊçÆ‰æøËÆ∞ÂΩï‰∏ãÊØè‰∏™ event Â§ÑÁêÜÔºõ
Ê∂à‰∫°Ôºöpuller ÈÄÄÂá∫Ôºõ
‰ΩúÁî®ÔºöËÆ∞ÂΩï puller ÂêûÂêêÊÉÖÂÜµÔºõ
ÂéüÁêÜÔºöÂú® puller ‰∏≠ÊØèÂ§ÑÁêÜ‰∏Ä‰∏™ event ‰æøËÆ∞ÂΩï‰∏ãÂØπÂ∫îÁä∂ÊÄÅÔºåËÆ∞ÂΩïÁöÑ event ÂàÜ‰∏∫ kvÔºåresolved 2 ‰∏≠ÔºåÂàÜÂà´Ê∫êËá™ tikv„ÄÇ
Sink buffer size
Ë≤å‰ººÂ∑≤Ë¢´Â∫üÂºÉÔºåÊó†Ê≥ïÊâæÂà∞ÂØπÂ∫îÊåáÊ†á
Entry sorter sort duration
ÂèòÊõ¥Ôºö
Ê∂à‰∫°Ôºö
‰ΩúÁî®Ôºö
ÂéüÁêÜÔºöpuller ËæìÂá∫ÁöÑ event ‰ºöË¢´ sorter Âä†ËΩΩÂà∞ resolvedTsGroup ‰∏≠ÔºåÊØè‰∏™ table ÂØπÂ∫î‰∏Ä‰∏™ SorterActor„ÄÇÊØèÈöî 1s Â∞Ü resolvedTsGroup ‰∏é unsorted Êï∞ÊçÆÊ∑∑Âêà‰∏ÄËµ∑ÔºåÂÖ®ÈÉ®ÂçáÂ∫èÊéíÂ∫èÂêé„ÄÇ
Entry sorter sort duration percentile
Â§çÁî® Entry sorter sort duration ÁõëÊéßÊåáÊ†á</p>
<p>Entry sorter merge duration
ÂèòÊõ¥Ôºö
Ê∂à‰∫°Ôºö
‰ΩúÁî®ÔºöËÆ∞ÂΩïÊØèÊ¨° merge ÁöÑËÄóÊó∂Ôºõ
ÂéüÁêÜÔºöÔºåÂèñ resolvedTsGroup ÊúÄÂêé‰∏Ä‰∏™ ResolvedTs ‰Ωú‰∏∫ maxResolvedTsÔºåÁªèËøáÊéíÂ∫èÂêéÁöÑ resolvedTsGroup ‰ºöÂÜç‰ΩøÁî®ÂèåÊåáÈíàÊ≥ï‰∏é‰∏ä‰∏ÄÊ¨°ÊéíÂ∫èÁöÑÁªìÊûúÊÆãÁïôÁöÑÔºåÂ§ß‰∫é‰∏ä‰∏ÄÊ¨°ÊØîËæÉ maxResolvedTs ÁöÑÁªìÊûúÊØîËæÉÔºåÂ∞ÜÂ§ß‰∫éÊú¨Ê¨° maxResolvedTs ÁöÑ event ‰øùÁïô‰∏ãÊù•Áî®‰∫é‰∏ã‰∏ÄÊ¨°ÊØîËæÉÔºåÂ∞è‰∫éÊú¨Ê¨° maxResolvedTs ÁöÑËæìÂá∫Âà∞ Mounter ÂéªËß£Á†Å RawKV Êï∞ÊçÆ„ÄÇ
Entry sorter merge duration percentile
Â§çÁî® Entry sorter merge duration ÁõëÊéßÊåáÊ†á</p>
<p>Mounter unmarshal duration
ÂèòÊõ¥Ôºö
Ê∂à‰∫°Ôºö
‰ΩúÁî®ÔºöMounter ‰ª• Entry Ëß£Á†Å RawKV ‰∏∫Â∏¶Êúâ TableID ÁöÑ EventÔºåÂú®Ê≠§ËøáÁ®ã‰∏≠ËÆ∞ÂΩï‰∏ãËß£Á†ÅÊØèË°åÂèòÊõ¥Êï∞ÊçÆÁöÑËÄóÊó∂„ÄÇ
Mounter unmarshal duration percentile</p>
<p>KV client dispatch events/s
ÂèòÊõ¥Ôºö
Ê∂à‰∫°Ôºö
‰ΩúÁî®Ôºö
ÂéüÁêÜÔºöregionWorker ÁöÑÂàÜÂèëÈÄüÂ∫¶Ôºõ
ÂõæÂÉè 2 Â§çÁî®‰∫Ü KV client batch resolved sizeÔºõ</p>
<p>KV client batch resolved size
ÂèòÊõ¥Ôºö
Ê∂à‰∫°Ôºö
‰ΩúÁî®ÔºöËÆ∞ÂΩïÊØèÊ¨°‰ªé tikv Êé•Êî∂Âà∞ÁöÑÊØè‰∏™ ChangeDataEvent ‰∏≠ÁöÑ region ‰∏™Êï∞Ôºõ
ÂéüÁêÜÔºö
KV client scanning regions
ÂèòÊõ¥Ôºö
Ê∂à‰∫°Ôºö
‰ΩúÁî®ÔºöÊØèÊ¨°Âêë TiKV ÂØπÂ∫î Region ÂèëÈÄÅËØ∑Ê±ÇÈÉΩ‰ºöË¢´ËÆ∞ÂΩïÔºåÁî®‰∫éÂàÜÊûê Capture Êàñ Changefeed Âêë TiKV ËØ∑Ê±ÇÁöÑ RPCË¥üËΩΩÊÉÖÂÜµÔºõ
ÂéüÁêÜÔºö
KV client gRPC stream count
ÂèòÊõ¥Ôºö
Ê∂à‰∫°Ôºö
‰ΩúÁî®ÔºöÊØèÈöî 1ms ËÆ∞ÂΩï‰∏ã GRPC Á∫øÁ®ãÊ±†‰∏≠Ê¥ªË∑ÉËøûÊé•Êï∞ÊÉÖÂÜµ
ÂéüÁêÜÔºö
KV client cached regions
ÂèòÊõ¥Ôºö
Ê∂à‰∫°Ôºö
‰ΩúÁî®ÔºöÂ¢ûÈáèÊâ´Èò∂ÊÆµÔºå‰ºöÁî® regionRouterChanSizeÔºà16ÔºâÂéªÈôêÂà∂ÂèëÂæÄ tikv ÁöÑ region ËØ∑Ê±ÇÊï∞ÈáèÔºåË∂ÖËøáÈÉ®ÂàÜ‰ºöÂÖà Cache Âú®ÂÜÖÂ≠ò‰∏≠„ÄÇ
ÂéüÁêÜÔºö
Estimate remaining time for initialization
ÂèòÊõ¥Ôºö
Ê∂à‰∫°Ôºö
‰ΩúÁî®ÔºöÁî® cache ÁöÑ region Êï∞ÈáèÈô§ 1 ÂàÜÈíüÂÜÖÂèòÂåñÊÉÖÂÜµÔºå‰º∞ËÆ°Â§ö‰πÖÂ¢ûÈáèÊâ´ËøáÁ®ã‰∏≠ÊâÄÊúâ region ÈÉΩÂª∫Á´ãÁöÑ grpc stream ÊâÄÈúÄÁöÑÊó∂Èó¥„ÄÇ
ÂéüÁêÜÔºö
Unified Sorter Èù¢Êùø
Unified Sorter intake rate
ÂèòÊõ¥Ôºö
Ê∂à‰∫°Ôºö
‰ΩúÁî®Ôºö
ÂéüÁêÜÔºöÊØè‰∏™ sorter ‰ºöÂ∞ÜÊé•Êî∂Âà∞ÁöÑ event ËÆ°Êï∞ÔºåÂ¶ÇÊûúÊòØ resolvedEvent ÂàôËÆ∞ÂΩï‰∏∫ resolved ÔºåÂ¶ÇÊûúÊòØ kv ÂèòÂåñÂàôËÆ∞‰∏∫ kv„ÄÇ
Unified Sorter event output rate
ÂèòÊõ¥Ôºö
Ê∂à‰∫°Ôºö
‰ΩúÁî®Ôºö
ÂéüÁêÜÔºöÊØèÊ¨° Poll Êó∂Ôºå‰ºöËÆ∞ÂΩï‰∏ãÊú¨Ê¨° Actor Â§ÑÁêÜËøáÁ®ã‰∏≠ÔºåÂá∫Áé∞Âú® channel ‰∏≠ÁöÑÊï∞ÊçÆÂÖ®ÈÉ®ËÆ∞ÂΩï‰∏ãÊù•„ÄÇ
Unified Sorter on disk data size
ÂèòÊõ¥Ôºö
Ê∂à‰∫°Ôºö
‰ΩúÁî®Ôºö
ÂéüÁêÜÔºöÊØèÈöî backgroundJobInterval Ôºà15sÔºâÂÆöÊúüÊ£ÄÊü•‰∏ã PebbleDB ‰∏≠Á£ÅÁõòÂç†Áî®Â§ßÂ∞è„ÄÇ
Unified Sorter in-memory data size
ÂèòÊõ¥Ôºö
Ê∂à‰∫°Ôºö
‰ΩúÁî®Ôºö
ÂéüÁêÜÔºöÊØèÈöî backgroundJobInterval Ôºà15sÔºâÂÆöÊúüÊ£ÄÊü•‰∏ãËØÑ‰º∞ÁöÑÂÜÖÂ≠òÂç†Áî®ÊÉÖÂÜµ„ÄÇ
Unified Sorter flush sizes
ÂèòÊõ¥Ôºö
Ê∂à‰∫°Ôºö
‰ΩúÁî®Ôºö
ÂéüÁêÜÔºöÂú® Sorter ÂêØÂä®Êó∂Ôºå‰ºöÂàùÂßãÂåñ HeapSorter Âπ∂ÈÖçÁΩÆ flush Á≠ñÁï•ÔºåË∂ÖËøáChunkSizeLimit ÊàñÂ∞è‰∫é flushRateLimitPerSecondÔºå‰æø‰ºöÂ∞ÜÂÖ∂ÂÜÖÂ≠òÊï∞ÊçÆ flush Âà∞Á£ÅÁõò‰∏ä„ÄÇ
Unified Sorter merge size
ÂèòÊõ¥Ôºö
Ê∂à‰∫°Ôºö
‰ΩúÁî®Ôºö
ÂéüÁêÜÔºöSorter ÂêØÂä®Âêé‰ºöÂΩíÂπ∂Êìç‰ΩúÂçïÊâπÊ¨°‰∏≠Â§ÑÁêÜÁöÑ event Êï∞Èáè„ÄÇ(ÁõÆÂâç‰∏çÂ§™ÊáÇ‰∏∫‰ªÄ‰πàË¶ÅÂΩíÂπ∂ merge)</p>
<p>Etcd Èù¢Êùø
Etcd MVCC DB total size
ÂèñËá™ PD Ë°®Á§∫ ETCD Âç†Áî®ÁöÑÁ©∫Èó¥Â§ßÂ∞èÔºåÁî®‰∫éÂàÜÊûêÊòØÂê¶Â≠òÂú®ÊÄßËÉΩÈóÆÈ¢ò„ÄÇ
Etcd health check duration
Capture ‰ºöÊØèÈöî 3s ‰ºö check ‰∏Ä‰∏ãÊâÄÊúâ PD ÁöÑÁä∂ÊÄÅÔºåÂÅöÁöÑÊìç‰ΩúÊòØ get ‰∏ã /pd/api/v1/health ÁöÑÊé•Âè£ÂÄºÔºåÊ≠§ËøáÁ®ã‰∏≠ËÄóË¥πÁöÑÊó∂Èó¥Ë¢´ËØ•ÊåáÊ†áËÆ∞ÂΩï‰∏ãÊù•„ÄÇ
EtcdWorker exec etcd txn duration
ETCD worker ÊØèÊ¨° Tick Êìç‰ΩúÁöÑËÄóÊó∂Ë¢´ËÆ∞ÂΩï‰∏ãÊù•ÔºåÂèØËÉΩÊòØ Owner/Processor ÁöÑ TickÔºåÂõ†‰∏∫‰∏ãÈù¢ÈÉΩËµ∞ etcdWorker„ÄÇ
EtcdWorker tick reactor duration
Â§çÁî® EtcdWorker exec etcd txn duration ÊåáÊ†áÔºåÂè™ÊòØÊç¢‰∫Ü‰∏ÄÁßçÂ±ïÁ§∫ÊñπÂºè„ÄÇ
EtcdWorker exec etcd txn duration
EtcdWorker ÊØèÂÅö‰∏ÄÊ¨° txn Â§ÑÁêÜÔºåÈÉΩ‰ºöËÆ∞ÂΩï‰∏ãÊâßË°åËÄóÊó∂„ÄÇ
EtcdWorker exec etcd txn duration percentile
Â§çÁî® EtcdWorker exec etcd txn duration ÊåáÊ†á„ÄÇ
EtcdWorker txn size
ËÆ∞ÂΩï‰∏ãÊØèÊ¨°ÊâßË°å txn Êìç‰ΩúÊó∂ÁöÑÊï∞ÊçÆÂ§ßÂ∞è„ÄÇ
EtcdWorker txn size percentile
Â§çÁî® EtcdWorker txn size Â§ßÂ∞è„ÄÇ
Etcd 99% WAL fsync duration
ÂèñËá™ PDÔºåË°®Á§∫WALÊó•ÂøóÊåÅ‰πÖÂåñÁöÑfsyncÁ≥ªÁªüË∞ÉÁî®Âª∂Êó∂Êó∂Èó¥ÔºåÁî®‰∫éÂàÜÊûê PD ‰∏≠ ETCD ÁöÑÊÄßËÉΩ„ÄÇ
Etcd 99% Handle transactions duration
ÂèñËá™ PDÔºåË°®Á§∫ PD ÊâßË°å txn ‰∏é ETCD ‰∫§‰∫íÊó∂ÁöÑÂª∂ËøüÊó∂Èó¥„ÄÇ
KvClient Èù¢Êùø
ResolveLock count/m
<a href="https://github.com/tikv/client-go/blob/57c12f7c64f626a478374de3c405c5134ea3cd42/metrics/metrics.go#L183" target="_blank" rel="noreferrer">https://github.com/tikv/client-go/blob/57c12f7c64f626a478374de3c405c5134ea3cd42/metrics/metrics.go#L183</a> Ë°®Á§∫Ëß£ÈîÅÂä®‰ΩúÁöÑÊ¨°Êï∞„ÄÇ
RegionCache operation/s
<a href="https://github.com/tikv/client-go/blob/681fb6e537b5b114f07cbc9eb0d6564742a470aa/metrics/shortcuts.go#L195-L205" target="_blank" rel="noreferrer">https://github.com/tikv/client-go/blob/681fb6e537b5b114f07cbc9eb0d6564742a470aa/metrics/shortcuts.go#L195-L205</a> Ë°®Á§∫ regionCache ËØ∑Ê±ÇÁ±ªÂûãÂèäËØ∑Ê±ÇÁä∂ÊÄÅÁöÑÁªüËÆ°
Backoff percentiles
<a href="https://github.com/tikv/client-go/blob/681fb6e537b5b114f07cbc9eb0d6564742a470aa/metrics/shortcuts.go#L158-L169" target="_blank" rel="noreferrer">https://github.com/tikv/client-go/blob/681fb6e537b5b114f07cbc9eb0d6564742a470aa/metrics/shortcuts.go#L158-L169</a> Ë°®Á§∫ client ËØ∑Ê±ÇÂèëÁîü backoff ÁöÑ‰∏ªË¶ÅÁ±ªÂûãÁªüËÆ°
TiKV Èù¢Êùø
CDC CPU
Ê∂âÂèä CDC Â∑•‰ΩúÁ∫øÁ®ãÁöÑÂç†Áî®ÊÉÖÂÜµÔºåÂú® tikv ‰∏≠ÈÄöËøá pid Êü• linux Êìç‰ΩúÁ≥ªÁªü‰ø°ÊÅØËé∑Âæó„ÄÇ
CDC network traffic
TiKV Áªô Capture Êé® Êï∞ÊçÆ‰πãÂâçÈÉΩ‰ºöËÆ∞ÂΩïÊé®ÈÄÅÁöÑ Event Êï∞ÊçÆÁöÑÂ§ßÂ∞èÔºå event„ÄÅresolved_ts ÂàÜÂà´ 2 Áßç‰∏çÂêå eventÔºåresolved_ts ÊòØ event ÁöÑÂçáÁ∫ßÁâàÊú¨Ôºå‰ª• batch ÂΩ¢ÂºèÊèêÈ´òÊÄßËÉΩ„ÄÇ
gRPC message count
Ê∫êËá™ tikv-detail ‰∏çÂÅöËß£Èáä
CDC memory
Ê∫êËá™ linux Êìç‰ΩúÁ≥ªÁªü‰∏≠Á∫øÁ®ãÂç†Áî®ÂÜÖÂ≠òÊÉÖÂÜµÔºå‰∏ªË¶Å‰ΩúÁî®ÊòØÁî®‰∫éËæ®Âà´ÔºåÂØπ TiKV Âú®ÂÜÖÂ≠òÊñπÈù¢ÁöÑÂΩ±Âìç„ÄÇ
ÁúÅÁï•ÂêémainÈù¢Êùø
ÈúÄË¶ÅÊó∂ÂÜçÁªÜÁúãÔºåÈÉΩÊòØ tikv component ‰∏≠ÁöÑÂÜÖÂÆπ</p>
<p>Peer Message Èù¢Êùø
p2p ÊòØ‰∏Ä‰∏™Â∞ÅË£Ö‰∫Ü GRPC ÁöÑÁÇπÂØπÁÇπ‰∫§‰∫íÊúçÂä°Ôºå‰∏ªË¶ÅÁî®‰∫é owner ‰∏é ÂÖ∂‰ªñ Capture ËäÇÁÇπÁöÑ‰∫§‰∫í„ÄÇ
Message Receive Rate
Capteure Êé•Êî∂ message ÁöÑÂêûÂêêÊÉÖÂÜµ„ÄÇ
Message Send Rate
Capteure ÂèëÈÄÅ message ÁöÑÂêûÂêêÊÉÖÂÜµÔºåÁªüËÆ°ÁöÑÊòØÊØèÊ¨°‰∫§‰∫í message ‰∏≠Âê´ÊúâÁöÑÊù°ÁõÆÊï∞Èáè„ÄÇ
Message Batch Size
‰∏é Message Send Rate ÁªüËÆ°ÁöÑÊï∞ÊçÆ‰∏ÄÊ†∑Ôºå‰ΩÜÊòØÂèØ‰ª•ÂàÜ‰ΩçÊï∞ÂΩ¢ÂºèÂ±ïÁ§∫„ÄÇ
Receive message batch bytes percentiles
‰∏é Message Send Rate ÁªüËÆ°ÁöÑ‰∏ÄÊ†∑Ôºå‰ΩÜÁªüËÆ°ÁöÑÊï∞ÊçÆÂèòÊàê‰∫Ü entry ÁöÑ‰∫åËøõÂà∂Â§ßÂ∞è„ÄÇ
Receive Message Bytes Percentile
‰∏é Message Send Rate ÁªüËÆ°‰ΩçÁΩÆ‰∏ÄÊ†∑Ôºå‰ΩÜÁªüËÆ°ÁöÑÊï∞ÊçÆ message ‰∏≠ÊØèÊù° entry ÁöÑ‰∫åËøõÂà∂Â§ßÂ∞èÔºåÊòØ Receive message batch bytes percentiles ÁöÑÁªÜÂåñ„ÄÇ
Stream Count Between Nodes
ÊØèÊé•Êî∂Âà∞‰∏ÄÊù° GRPC stream Ê∂àÊÅØÈÉΩ‰ºöËÆ∞ÂΩïÔºåÂ∞ÜÂèëÈÄÅËÄÖËÆ∞‰∏∫ from„ÄÇÁªüËÆ°ÁöÑÊòØÔºå‰∏çÂêå Capture ‰πãÈó¥ stream Êï∞ÈáèÔºå‰ªéËÄåÂà§Êñ≠ÊòØÂê¶Â≠òÂú®ÊÄßËÉΩÈóÆÈ¢ò„ÄÇ
Total Stream Count
‰∏é Stream Count Between Nodes ÊòØÂêå‰∏Ä‰∏™ÊåáÊ†áÔºå‰ΩÜÂ¢ûÂä†‰∫Ü expected ÔºåËÆ°ÁÆóÂÖ¨ÂºèÊòØ capture_num * 2 -1„ÄÇÂõ†‰∏∫ Owner ‰∏çÈúÄË¶ÅËá™Â∑±ÁªôËá™Â∑±ÂõûÊ∂àÊÅØÔºåÊâÄ‰ª•ÈúÄË¶ÅÂáè 1ÔºåÊØè‰∏™ Capture P2P ÂØπÂ∫î 2 ÂèëÈÄÅÁ´ØÊé•Êî∂Á´ØÔºåÊâÄ‰ª•Êúâ 2 ‰∏™„ÄÇ</p>
<p>Actor Èù¢Êùø
CPU usage
ÊØè‰∏™ Actor Âú® Build Êó∂Ôºå‰æùÊçÆÂäüËÉΩÂàùÂßãÂåñ‰∏çÂêå label ÁöÑÊåáÊ†áÔºå‰∏çÂêå label Ë°®Á§∫ Actor ÁöÑÂäüËÉΩ„ÄÇÁî®‰∫éÁªüËÆ°‰∏çÂêå Actor CPU Âç†Áî®ÊÉÖÂÜµ„ÄÇLable Êúâ sorter-db„ÄÅsorter-compactor„ÄÅsorter-writer„ÄÅsorter-reader„ÄÇ
Worker count
Actor worker ÁöÑÊï∞Èáè„ÄÇ
Slow poll duration
Poll Âç≥Ë∞ÉÁî® Actor ÂéªÊâßË°åÁöÑÊó∂Èó¥ÔºåËøô‰∏™Êó∂Èó¥ÂèØËÉΩÊòØË∞ÉÁî®ÂéªÊâßË°åÔºå‰πüÂèØËÉΩÊòØÊâßË°åÂÆåÊï¥‰∏™Ë∞ÉÁî®ÔºåÂèñÂÜ≥‰∫éË∞ÉÁî®‰ø°ÊÅØÂíåÁ±ªÂûãÔºåÊØè 5s ‰∏ÄÊõ¥Êñ∞„ÄÇ
Slow poll duration percentile
Â¶ÇÊûú Actor Poll Ë∞ÉÁî®Êó∂Èó¥Ë∂ÖËøá slowPollThreshold Ôºà100msÔºâÂàôËÆ∞ÂΩïÂ±ïÁ§∫„ÄÇ
Avg message batch size</p>
<p>Avg actor batch size</p>
<p>Actor poll/s</p>
<p>System poll/s</p>
<p>Runtime instance Èù¢Êùø
ËøôÈáåÈÉΩÊòØ‰∏Ä‰∫õ prometheus go Êî∂ÈõÜÂô®ÈááÈõÜÂá∫Êù•ÁöÑ‰ø°ÊÅØÔºå‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÁî®‰∏çÂà∞„ÄÇÂè™ÊúâÂØπÈúÄË¶ÅÂØπÁ≥ªÁªüËµÑÊ∫êÂç†Áî®ËøõË°åÊ∑±ÂÖ•ÂàÜÊûêÊó∂ÔºåÊâç‰ºöÁî®Âà∞„ÄÇ
Redo Èù¢Êùø
Âü∫Êú¨‰∏äËßÅÂêçÁü•ÊÑè
Kafka Sink Èù¢Êùø
Á±ª‰ºº‰∫é MySQL Sink Âì™‰∫õÈù¢ÊùøÁöÑÊÑèÊÄù„ÄÇ</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Usage Background]]></title>
            <link>https://askaric.com/en/work/tidb/TiDB-EcosystematicTools/TiCDC/TiCDC Overview.html</link>
            <guid>https://askaric.com/en/work/tidb/TiDB-EcosystematicTools/TiCDC/TiCDC Overview.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[# Usage Background

## 1. Project Background

As described on the [PingCAP official website](https://docs.pingcap.com/zh/tidb/stable/ticdc-overview), the main use cases of TiCDC are **"database disaster recovery"** and **"data integration"**. Enthusiasts familiar with the TiDB ecosystem might know about **"TiDB Binlog"**, a tool with similar functionality to TiCDC. **So why reinvent the wheel?**  
The answer lies in the limitations of "TiDB Binlog," which cannot address the following (not exhaustive) issues. For those unfamiliar with "TiDB Binlog," refer to the [TiDB Binlog Overview](https://docs.pingcap.com/zh/tidb/stable/tidb-binlog-overview):  
1. Poor scalability of "TiDB Binlog," such as the "single point" and "performance" issues of Drainer. Splitting Drainer cannot ensure "row change order."  
2. Low performance of "TiDB Binlog," such as only supporting single Kafka single partition writes, which limits Kafka throughput.  
3. Poor generality of "TiDB Binlog," such as requiring Reparo to parse SQL statements when writing binlog files, and not supporting general protocols like Maxwell or Canal.  
4. Synchronization pain points of "TiDB Binlog," such as being limited by GRPC max message size, e.g., [Pump's gRPC message exceeds limit](https://docs.pingcap.com/zh/tidb/stable/handle-tidb-binlog-errors#%E5%BD%93%E4%B8%8A%E6%B8%B8%E4%BA%8B%E5%8A%A1%E8%BE%83%E5%A4%A7%E6%97%B6pump-%E6%8A%A5%E9%94%99-rpc-error-code--resourceexhausted-desc--trying-to-send-message-larger-than-max-2191430008-vs-2147483647).  
5. Poor availability of "TiDB Binlog," such as synchronization interruptions when the single-point Drainer fails, with no self-healing capabilities.  

Thus, TiCDC was born. By directly capturing TiKV Change Logs, TiCDC uses tables as split units to schedule data synchronization to various Captures, solving scalability issues. It supports multi-partition Kafka writes and general protocols like Maxwell and Canal, addressing synchronization performance and ecosystem compatibility issues. When synchronization times out, Capture has uneven table distribution, or Capture crashes, TiCDC's scheduling mechanism and "At Least Once" guarantee ensure data integrity and self-healing.

![01BinlogAndTiCDC](../../../../../images/tidb/05TiDB-EcosystematicTools/5-1TiCDC/01BinlogAndTiCDC.png)

## 2. Tool Position

To understand how to use TiCDC, one must first clarify its position and role in the TiDB ecosystem.  
**1. In terms of role**: If a database is a "one-way street," it will inevitably be abandoned by the market, becoming a so-called **"data island."** TiCDC balances synchronization performance, data integrity, consistency, and ecosystem compatibility, creating a closed loop of **"data inflow -> TiDB -> data outflow."** Additionally, discussing performance without considering scenarios is meaningless. No product can excel in all scenarios, and TiDB has its comfort zones and pain points. **With TiCDC, users can easily enable data flow and use TiDB in its optimal scenarios.**  

**2. In terms of position**: TiCDC sits between TiDB and downstream destinations, which include all products and platforms compatible with MySQL communication protocols (e.g., TiDB, MySQL, RDS, third-party cloud platforms). Users can also develop custom solutions based on general message queue output protocols. Currently, TiCDC supports protocols like Open Protocol, Canal-JSON, Canal, Avro, and Maxwell. Some protocols are only partially supported. For details, refer to --> [TiCDC Supported Protocols Guide](https://github.com/pingcap/tiflow/blob/master/docs/design/2020-11-04-ticdc-protocol-list.md#protocols-%E5%88%86%E5%8D%8F%E8%AE%AE%E4%BB%8B%E7%BB%8D).  
Additionally, TiCDC covers almost all mainstream "data synchronization" use cases. The diagram below illustrates the classic combination of "MySQL --> TiDB --> Others." For other protocol databases (Oracle, PG), the method to flow into TiDB is equivalent to flowing into MySQL, as TiDB is compatible with MySQL communication protocols, ensuring mature solutions exist.  

![02UpstreamAndDownstream](../../../../../images/tidb/05TiDB-EcosystematicTools/5-1TiCDC/02UpstreamAndDownstream.png)

## 3. Usage Scenarios

**Note: The following companies were identified through articles on AskTUG, where shared articles mentioned their use of TiCDC. These companies are only those discoverable through search. Many commercial customers either request confidentiality or have not yet disclosed their usage.**  

### **3.1 Xiaohongshu**

From `Zhang Yihao`'s sharing in [„ÄêPingCAP Infra Meetup„ÄëNo.131 TiCDC's Ecosystem and Community Development](https://www.bilibili.com/video/BV1bD4y1o7qU?spm_id_from=333.337.search-card.all.click), Xiaohongshu uses TiCDC for content review, note tag recommendations, and growth audits. The architecture is as follows: "TiDB --> TiCDC --> Kafka --> Flink --> TiDB," enabling aggregation with other data sources.  

![03xiaohongshu_share](../../../../../images/tidb/05TiDB-EcosystematicTools/5-1TiCDC/03xiaohongshu_share.jpeg)

### **3.2 Haier Smart Home**

From `Yao Xiang`'s sharing in [„ÄêPingCAP Infra Meetup„ÄëNo.131 TiCDC's Ecosystem and Community Development](https://www.bilibili.com/video/BV1bD4y1o7qU?spm_id_from=333.337.search-card.all.click), Haier Smart Home uses TiCDC for search and recommendations. User data and smart home information are processed through "TiDB --> TiCDC --> Kafka --> ES," achieving near real-time search functionality with Kafka consuming approximately 3 million messages daily. As of the 2019-09-19 sharing, **TiCDC's synchronization boundary under normal conditions is in the "millisecond" range, and under jitter conditions, it is within "seconds" (less than 10s).**  
Additionally, from [Github -- Question and Bug Reports](https://github.com/pingcap/tiflow/projects/13), TiCDC has a roadmap for improving synchronization performance, such as `mqSink flushes data synchronously, causing low performance` and `improve performance of syncer.` TiCDC's synchronization performance is a continuous optimization process.  

![04haierzhijia_share](../../../../../images/tidb/05TiDB-EcosystematicTools/5-1TiCDC/04haierzhijia_share.jpeg)  

### **3.3 360**

From `Dai Xiaolei`'s sharing in [BLOG - TiCDC Application Scenarios Analysis](https://tidb.net/blog/2fa9cf6a), 360 uses TiCDC to meet the needs of incremental data extraction, same-city dual-cluster hot backup, and stream processing.  

## 4. Usage Methods

### 4.1 Deploying TiCDC

The following test environment sets up TiCDC for testing and learning its synchronization capabilities. The CDC components on `172.16.6.155:8300` and `172.16.6.196:8300` will appear after scaling.  

```shell
[tidb@Linux-Hostname ~]$ tiup cluster display tidb-test

ID                  Role          Host          Ports        OS/Arch       Status  Data Dir                                     Deploy Dir
--                  ]]></description>
            <content:encoded><![CDATA[<h1 id="usage-background" tabindex="-1">Usage Background <a class="header-anchor" href="#usage-background" aria-label="Permalink to &quot;Usage Background&quot;"></a></h1>
<h2 id="_1-project-background" tabindex="-1">1. Project Background <a class="header-anchor" href="#_1-project-background" aria-label="Permalink to &quot;1. Project Background&quot;"></a></h2>
<p>As described on the <a href="https://docs.pingcap.com/zh/tidb/stable/ticdc-overview" target="_blank" rel="noreferrer">PingCAP official website</a>, the main use cases of TiCDC are <strong>&quot;database disaster recovery&quot;</strong> and <strong>&quot;data integration&quot;</strong>. Enthusiasts familiar with the TiDB ecosystem might know about <strong>&quot;TiDB Binlog&quot;</strong>, a tool with similar functionality to TiCDC. <strong>So why reinvent the wheel?</strong><br>
The answer lies in the limitations of &quot;TiDB Binlog,&quot; which cannot address the following (not exhaustive) issues. For those unfamiliar with &quot;TiDB Binlog,&quot; refer to the <a href="https://docs.pingcap.com/zh/tidb/stable/tidb-binlog-overview" target="_blank" rel="noreferrer">TiDB Binlog Overview</a>:</p>
<ol>
<li>Poor scalability of &quot;TiDB Binlog,&quot; such as the &quot;single point&quot; and &quot;performance&quot; issues of Drainer. Splitting Drainer cannot ensure &quot;row change order.&quot;</li>
<li>Low performance of &quot;TiDB Binlog,&quot; such as only supporting single Kafka single partition writes, which limits Kafka throughput.</li>
<li>Poor generality of &quot;TiDB Binlog,&quot; such as requiring Reparo to parse SQL statements when writing binlog files, and not supporting general protocols like Maxwell or Canal.</li>
<li>Synchronization pain points of &quot;TiDB Binlog,&quot; such as being limited by GRPC max message size, e.g., <a href="https://docs.pingcap.com/zh/tidb/stable/handle-tidb-binlog-errors#%E5%BD%93%E4%B8%8A%E6%B8%B8%E4%BA%8B%E5%8A%A1%E8%BE%83%E5%A4%A7%E6%97%B6pump-%E6%8A%A5%E9%94%99-rpc-error-code--resourceexhausted-desc--trying-to-send-message-larger-than-max-2191430008-vs-2147483647" target="_blank" rel="noreferrer">Pump's gRPC message exceeds limit</a>.</li>
<li>Poor availability of &quot;TiDB Binlog,&quot; such as synchronization interruptions when the single-point Drainer fails, with no self-healing capabilities.</li>
</ol>
<p>Thus, TiCDC was born. By directly capturing TiKV Change Logs, TiCDC uses tables as split units to schedule data synchronization to various Captures, solving scalability issues. It supports multi-partition Kafka writes and general protocols like Maxwell and Canal, addressing synchronization performance and ecosystem compatibility issues. When synchronization times out, Capture has uneven table distribution, or Capture crashes, TiCDC's scheduling mechanism and &quot;At Least Once&quot; guarantee ensure data integrity and self-healing.</p>
<figure><img src="./../../../../../images/tidb/05TiDB-EcosystematicTools/5-1TiCDC/01BinlogAndTiCDC.png" alt="01BinlogAndTiCDC" tabindex="0"><figcaption>01BinlogAndTiCDC</figcaption></figure>
<h2 id="_2-tool-position" tabindex="-1">2. Tool Position <a class="header-anchor" href="#_2-tool-position" aria-label="Permalink to &quot;2. Tool Position&quot;"></a></h2>
<p>To understand how to use TiCDC, one must first clarify its position and role in the TiDB ecosystem.<br>
<strong>1. In terms of role</strong>: If a database is a &quot;one-way street,&quot; it will inevitably be abandoned by the market, becoming a so-called <strong>&quot;data island.&quot;</strong> TiCDC balances synchronization performance, data integrity, consistency, and ecosystem compatibility, creating a closed loop of <strong>&quot;data inflow -&gt; TiDB -&gt; data outflow.&quot;</strong> Additionally, discussing performance without considering scenarios is meaningless. No product can excel in all scenarios, and TiDB has its comfort zones and pain points. <strong>With TiCDC, users can easily enable data flow and use TiDB in its optimal scenarios.</strong></p>
<p><strong>2. In terms of position</strong>: TiCDC sits between TiDB and downstream destinations, which include all products and platforms compatible with MySQL communication protocols (e.g., TiDB, MySQL, RDS, third-party cloud platforms). Users can also develop custom solutions based on general message queue output protocols. Currently, TiCDC supports protocols like Open Protocol, Canal-JSON, Canal, Avro, and Maxwell. Some protocols are only partially supported. For details, refer to --&gt; <a href="https://github.com/pingcap/tiflow/blob/master/docs/design/2020-11-04-ticdc-protocol-list.md#protocols-%E5%88%86%E5%8D%8F%E8%AE%AE%E4%BB%8B%E7%BB%8D" target="_blank" rel="noreferrer">TiCDC Supported Protocols Guide</a>.<br>
Additionally, TiCDC covers almost all mainstream &quot;data synchronization&quot; use cases. The diagram below illustrates the classic combination of &quot;MySQL --&gt; TiDB --&gt; Others.&quot; For other protocol databases (Oracle, PG), the method to flow into TiDB is equivalent to flowing into MySQL, as TiDB is compatible with MySQL communication protocols, ensuring mature solutions exist.</p>
<figure><img src="./../../../../../images/tidb/05TiDB-EcosystematicTools/5-1TiCDC/02UpstreamAndDownstream.png" alt="02UpstreamAndDownstream" tabindex="0"><figcaption>02UpstreamAndDownstream</figcaption></figure>
<h2 id="_3-usage-scenarios" tabindex="-1">3. Usage Scenarios <a class="header-anchor" href="#_3-usage-scenarios" aria-label="Permalink to &quot;3. Usage Scenarios&quot;"></a></h2>
<p><strong>Note: The following companies were identified through articles on AskTUG, where shared articles mentioned their use of TiCDC. These companies are only those discoverable through search. Many commercial customers either request confidentiality or have not yet disclosed their usage.</strong></p>
<h3 id="_3-1-xiaohongshu" tabindex="-1"><strong>3.1 Xiaohongshu</strong> <a class="header-anchor" href="#_3-1-xiaohongshu" aria-label="Permalink to &quot;**3.1 Xiaohongshu**&quot;"></a></h3>
<p>From <code>Zhang Yihao</code>'s sharing in <a href="https://www.bilibili.com/video/BV1bD4y1o7qU?spm_id_from=333.337.search-card.all.click" target="_blank" rel="noreferrer">„ÄêPingCAP Infra Meetup„ÄëNo.131 TiCDC's Ecosystem and Community Development</a>, Xiaohongshu uses TiCDC for content review, note tag recommendations, and growth audits. The architecture is as follows: &quot;TiDB --&gt; TiCDC --&gt; Kafka --&gt; Flink --&gt; TiDB,&quot; enabling aggregation with other data sources.</p>
<figure><img src="./../../../../../images/tidb/05TiDB-EcosystematicTools/5-1TiCDC/03xiaohongshu_share.jpeg" alt="03xiaohongshu_share" tabindex="0"><figcaption>03xiaohongshu_share</figcaption></figure>
<h3 id="_3-2-haier-smart-home" tabindex="-1"><strong>3.2 Haier Smart Home</strong> <a class="header-anchor" href="#_3-2-haier-smart-home" aria-label="Permalink to &quot;**3.2 Haier Smart Home**&quot;"></a></h3>
<p>From <code>Yao Xiang</code>'s sharing in <a href="https://www.bilibili.com/video/BV1bD4y1o7qU?spm_id_from=333.337.search-card.all.click" target="_blank" rel="noreferrer">„ÄêPingCAP Infra Meetup„ÄëNo.131 TiCDC's Ecosystem and Community Development</a>, Haier Smart Home uses TiCDC for search and recommendations. User data and smart home information are processed through &quot;TiDB --&gt; TiCDC --&gt; Kafka --&gt; ES,&quot; achieving near real-time search functionality with Kafka consuming approximately 3 million messages daily. As of the 2019-09-19 sharing, <strong>TiCDC's synchronization boundary under normal conditions is in the &quot;millisecond&quot; range, and under jitter conditions, it is within &quot;seconds&quot; (less than 10s).</strong><br>
Additionally, from <a href="https://github.com/pingcap/tiflow/projects/13" target="_blank" rel="noreferrer">Github -- Question and Bug Reports</a>, TiCDC has a roadmap for improving synchronization performance, such as <code>mqSink flushes data synchronously, causing low performance</code> and <code>improve performance of syncer.</code> TiCDC's synchronization performance is a continuous optimization process.</p>
<figure><img src="./../../../../../images/tidb/05TiDB-EcosystematicTools/5-1TiCDC/04haierzhijia_share.jpeg" alt="04haierzhijia_share" tabindex="0"><figcaption>04haierzhijia_share</figcaption></figure>
<h3 id="_3-3-360" tabindex="-1"><strong>3.3 360</strong> <a class="header-anchor" href="#_3-3-360" aria-label="Permalink to &quot;**3.3 360**&quot;"></a></h3>
<p>From <code>Dai Xiaolei</code>'s sharing in <a href="https://tidb.net/blog/2fa9cf6a" target="_blank" rel="noreferrer">BLOG - TiCDC Application Scenarios Analysis</a>, 360 uses TiCDC to meet the needs of incremental data extraction, same-city dual-cluster hot backup, and stream processing.</p>
<h2 id="_4-usage-methods" tabindex="-1">4. Usage Methods <a class="header-anchor" href="#_4-usage-methods" aria-label="Permalink to &quot;4. Usage Methods&quot;"></a></h2>
<h3 id="_4-1-deploying-ticdc" tabindex="-1">4.1 Deploying TiCDC <a class="header-anchor" href="#_4-1-deploying-ticdc" aria-label="Permalink to &quot;4.1 Deploying TiCDC&quot;"></a></h3>
<p>The following test environment sets up TiCDC for testing and learning its synchronization capabilities. The CDC components on <code>172.16.6.155:8300</code> and <code>172.16.6.196:8300</code> will appear after scaling.</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@Linux-Hostname </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ tiup cluster display tidb-test</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ID</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                  Role</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">          Host</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">          Ports</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">        OS/Arch</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       Status</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Data</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Dir</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                     Deploy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Dir</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">--</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">                  ----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">          ----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">          -----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">        -------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">       ------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  --------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">                                     ----------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">172.16.6.155:9093</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   alertmanager</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  172.16.6.155</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  9093/9094</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Up</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      /home/data/tidb-home/data/alertmanager-9093</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  /home/data/tidb-deploy/alertmanager-9093</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">172.16.6.155:8300</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   cdc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">           172.16.6.155</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  8300</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">         linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Up</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      /data/deploy/install/data/cdc-8300</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">           /home/data/tidb-deploy/cdc-8300</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">172.16.6.196:8300</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   cdc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">           172.16.6.196</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  8300</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">         linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Up</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      /data/deploy/install/data/cdc-8300</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">           /home/data/tidb-deploy/cdc-8300</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">172.16.6.155:3000</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   grafana</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">       172.16.6.155</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  3000</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">         linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Up</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                            /home/data/tidb-deploy/grafana-3000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">172.16.6.155:2379</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   pd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">            172.16.6.155</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  2379/2380</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Up</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">UI</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   /home/data/tidb-home/data/pd-2379</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">            /home/data/tidb-deploy/pd-2379</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">172.16.6.194:2379</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   pd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">            172.16.6.194</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  2379/2380</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Up</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      /home/data/tidb-home/data/pd-2379</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">            /home/data/tidb-deploy/pd-2379</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">172.16.6.196:2379</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   pd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">            172.16.6.196</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  2379/2380</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Up</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">L</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    /home/data/tidb-home/data/pd-2379</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">            /home/data/tidb-deploy/pd-2379</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">172.16.6.155:9090</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   prometheus</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    172.16.6.155</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  9090/12020</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Up</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      /home/data/tidb-home/data/prometheus-9090</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    /home/data/tidb-deploy/prometheus-9090</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">172.16.6.155:4000</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   tidb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">          172.16.6.155</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  4000/10080</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Up</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                            /home/data/tidb-deploy/tidb-4000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">172.16.6.196:4000</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   tidb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">          172.16.6.196</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  4000/10080</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Up</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                            /home/data/tidb-deploy/tidb-4000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">172.16.6.155:20160</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  tikv</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">          172.16.6.155</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  20160/20180</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Up</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      /home/data/tidb-home/data/tikv-20160</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">         /home/data/tidb-deploy/tikv-20160</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">172.16.6.194:20160</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  tikv</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">          172.16.6.194</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  20160/20180</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Up</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      /home/data/tidb-home/data/tikv-20160</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">         /home/data/tidb-deploy/tikv-20160</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">172.16.6.196:20160</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  tikv</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">          172.16.6.196</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  20160/20180</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Up</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      /home/data/tidb-home/data/tikv-20160</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">         /home/data/tidb-deploy/tikv-20160</span></span></code></pre>
</div><p><strong>TiCDC reached GA in version 4.0.6, and it is recommended to use version 4.0.6 and above.</strong> For details, refer to the --&gt; <a href="https://docs.pingcap.com/zh/tidb/stable/scale-tidb-using-tiup#%E6%89%A9%E5%AE%B9-ticdc-%E8%8A%82%E7%82%B9" target="_blank" rel="noreferrer">TiCDC Official Documentation</a>. The scaling steps are as follows.</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@Linux-Hostname </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ cat scale-out-cdc.yaml </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">cdc_servers:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> host:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 172.16.6.155</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    gc-ttl:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 86400</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    data_dir:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /data/deploy/install/data/cdc-8300</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> host:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 172.16.6.196</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    gc-ttl:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 86400</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    data_dir:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /data/deploy/install/data/cdc-8300</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@Linux-Hostname </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ tiup cluster scale-out tidb-test scale-out-cdc.yaml</span></span></code></pre>
</div><h3 id="_4-2-synchronization-to-kafka" tabindex="-1">4.2 Synchronization to Kafka <a class="header-anchor" href="#_4-2-synchronization-to-kafka" aria-label="Permalink to &quot;4.2 Synchronization to Kafka&quot;"></a></h3>
<p>As I had no prior experience with Kafka, I referred to the <a href="https://kafka.apache.org/quickstart" target="_blank" rel="noreferrer">Kafka Quickstart</a> to set up a Kafka environment on <code>172.16.6.155</code> and <code>172.16.6.196</code> for testing. The goal was to parse messages sent to Kafka by TiCDC.</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Install Java Runtime Environment</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@kafka1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ yum install java-1.8.0-openjdk.x86_64</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@kafka1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ java -version</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">openjdk</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> version</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "1.8.0_322"</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Set up Kafka on 172.16.6.155 and 172.16.6.196</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@kafka1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$  wget https://dlcdn.apache.org/kafka/3.1.0/kafka_2.13-3.1g/kafka/3.1.0/kafka_2.13-3.1.0.tgz --no-check-certificate</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@kafka1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$  tar -xzf kafka_2.13-3.1.0.tgz</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@kafka1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$  cd kafka_2.13-3.1.0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@kafka1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$  bin/zookeeper-server-start.sh config/zookeeper.properties</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@kafka1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$  bin/kafka-server-start.sh config/server.properties</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Create a topic named tidb-test with 2 partitions</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@kafka1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$  bin/kafka-topics.sh --create --topic tidb-test </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    --bootstrap-server</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  172.16.6.155:9092,172.16.6.196:9092</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    --partitions</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Created</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> topic</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> quickstart-events.</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Describe the tidb-test topic to verify its configuration</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@kafka1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ bin/kafka-topics.sh --describe --topic tidb-test </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    --bootstrap-server</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 172.16.6.155:9092,172.16.6.196:9092</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Topic:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-test</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> TopicId:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> OjM6FFrBQtqyEB4sVWmYCQ</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> PartitionCount:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ReplicationFactor:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Configs:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> segment.bytes=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1073741824</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Topic:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-test</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Partition:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Leader:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Replicas:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Isr:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Topic:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-test</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Partition:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Leader:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Replicas:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Isr:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 0</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Create a changefeed in TiCDC to synchronize data to Kafka, using the manually created tidb-test topic</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@kafka1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ tiup cdc cli changefeed create --pd</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">http://172.16.6.155:2379</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    --sink-uri=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"kafka://172.16.6.155:9092/tidb-test?protocol=canal-json&#x26;kafka-version=2.4.0&#x26;partition-num=2&#x26;max-message-bytes=67108864&#x26;replication-factor=1"</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tiup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> checking</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> updates</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> component</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> cdc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> component</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">cdc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /home/tidb/.tiup/components/cdc/v6.0.0/cdc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /home/tidb/.tiup/components/cdc/v6.0.0/cdc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> cli</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> changefeed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> create</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --pd=http://172.16.6.155:2379</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --sink-uri=kafka://172.16.6.155:9092/tidb-test</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">?</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">protocol=canal-json</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&#x26;kafka-version</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">2.4.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&#x26;partition-num</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&#x26;max-message-bytes</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">67108864</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&#x26;replication-factor</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[2022/05/12 16:37:09.667 +08:00] [WARN] [kafka.go:416] [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"topic's `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">max.message.bytes</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">` less than the `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">max-message-bytes</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`,use topic's `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">max.message.bytes</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">` to initialize the Kafka producer"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">] [max.message.bytes</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">1048588] [max-message-bytes</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">67108864]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[2022/05/12 16:37:09.667 +08:00] [WARN] [kafka.go:425] [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"topic already exist, TiCDC will not create the topic"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">] [topic</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">tidb-test] [detail</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"{</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">NumPartitions</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">:2,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">ReplicationFactor</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">:1,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">ReplicaAssignment</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">:{</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">:[0],</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">:[0]},</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">ConfigEntries</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">:{</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">segment.bytes</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">1073741824</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">}}"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Create</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> changefeed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> successfully!</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Use sysbench to insert 2 rows into jan.sbtest1   </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@kafka1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ sysbench oltp_read_write --mysql-host</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">127.0.0.1</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    --mysql-port=4000</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    --mysql-db=jan</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    --mysql-user=root</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    --mysql-password=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    --table_size=2</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    --tables=1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  prepare</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Parse the data changes in Kafka as follows   </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@kafka1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ bin/kafka-console-consumer.sh --topic tidb-test </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    --from-beginning</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --bootstrap-server</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 172.16.6.155:9092,172.16.6.196:9092</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"id"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">:0,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"database"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"jan"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"table"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"sbtest1"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"pkNames"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"id"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">],</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"isDdl"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">:false,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"type"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"INSERT"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"es"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">:1652344970654,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"ts"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">:1652344977538,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"sql"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">""</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"sqlType"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">c</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":1,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">id</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":4,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">k</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":4,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">pad</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":1},"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">mysqlType</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":{"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">c</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">char</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">id</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">k</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">pad</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">char</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"},"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">data</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":[{"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">c</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">83868641912-28773972837-60736120486-75162659906-27563526494-20381887404-41576422241-93426793964-56405065102-33518432330</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">id</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">1</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">k</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">1</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">pad</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">67847967377-48000963322-62604785301-91415491898-96926520291</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"}],"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">old</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":null}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">{"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">id</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":0,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">database</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">table</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sbtest1</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">pkNames</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":["</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">id</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"],"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">isDdl</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":false,"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">INSERT</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">es</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":1652344970654,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ts</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":1652344977538,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sql</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sqlType</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":{"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">c</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":1,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">id</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":4,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">k</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":4,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">pad</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":1},"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">mysqlType</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":{"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">c</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">char</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">id</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">k</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">pad</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">char</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"},"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">data</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":[{"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">c</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">38014276128-25250245652-62722561801-27818678124-24890218270-18312424692-92565570600-36243745486-21199862476-38576014630</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">id</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">2</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">k</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">2</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">pad</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">23183251411-36241541236-31706421314-92007079971-60663066966</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"}],"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">old</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":null}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">{"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">id</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":0,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">database</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">table</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">pkNames</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":null,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">isDdl</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":true,"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">QUERY</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">es</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":1652344966953,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ts</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":1652344969305,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sql</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">CREATE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> DATABASE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sqlType</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":null,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">mysqlType</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":null,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">data</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":null,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">old</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":null}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">{"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">id</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":0,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">database</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">table</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sbtest1</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">pkNames</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":null,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">isDdl</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":true,"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">CREATE</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">es</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":1652344970604,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ts</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":1652344975305,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sql</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">CREATE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> TABLE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sbtest1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">id</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> INT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> NOT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> NULL</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> AUTO_INCREMENT,`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">k</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> INT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> DEFAULT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> _UTF8MB4'0'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> NOT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> NULL,`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> CHAR(120</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">DEFAULT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> _UTF8MB4''</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> NOT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> NULL,`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">pad</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> CHAR(60</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) DEFAULT _UTF8MB4</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">''</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> NOT NULL,PRIMARY KEY(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">id</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)) ENGINE = innodb","sqlType":null,"mysqlType":null,"data":null,"old":null}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"id"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">:0,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"database"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"jan"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"table"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"sbtest1"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"pkNames"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">:null,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"isDdl"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">:true,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"type"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"CINDEX"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"es"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">:1652344973455,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"ts"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">:1652344978504,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"sql"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"CREATE INDEX </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">k_1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> ON </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sbtest1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">k</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">)"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"sqlType"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">:null,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"mysqlType"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">:null,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"data"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">:null,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"old"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">:null}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Clean up the Kafka environment set up on 172.16.6.155 and 172.16.6.196</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># First, use ctrl + c to close all foreground processes started in terminals</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@kafka1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ rm -rf /tmp/kafka-logs /tmp/zookeeper</span></span></code></pre>
</div><h3 id="_4-3-synchronization-to-mysql" tabindex="-1">4.3 Synchronization to MySQL <a class="header-anchor" href="#_4-3-synchronization-to-mysql" aria-label="Permalink to &quot;4.3 Synchronization to MySQL&quot;"></a></h3>
<p>To synchronize data to MySQL, install MySQL on <code>172.16.6.155:3306</code>. After configuring the relevant parameters, a subscription task with the ID simple-replication-task can be created. The synchronization progress can be monitored on the Grafana dashboard. MySQL is a familiar tool for DBAs, so the steps for verifying synchronization are not elaborated here.</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@Linux-Hostname </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ tiup cdc cli changefeed create --pd</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">http://172.16.6.155:2379</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  --sink-uri=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"mysql://jan:123123@172.16.6.155:3306/?time-zone=&#x26;worker-count=16&#x26;max-txn-row=5000"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  --changefeed-id=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"simple-replication-task"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  --sort-engine=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"unified"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  --config=changefeed.toml</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tiup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> checking</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> updates</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> component</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> cdc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> component</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">cdc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /home/tidb/.tiup/components/cdc/v6.0.0/cdc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /home/tidb/.tiup/components/cdc/v6.0.0/cdc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> cli</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> changefeed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> create</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --pd=http://172.16.6.155:2379</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --sink-uri=mysql://jan:123123@172.16.6.155:3306/</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">?</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">time-zone=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&#x26;worker-count</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">16</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&#x26;max-txn-row</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">5000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> --changefeed-id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">simple-replication-task</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> --sort-engine</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">unified</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> --config</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">changefeed.toml</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[2022/04/12 16:58:40.954 +08:00] [WARN] [mysql_params.go:143] [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"max-txn-row too large"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">] [original</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">5000] [override</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">2048]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Create</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> changefeed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> successfully!</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span></code></pre>
</div><h2 id="_5-referenced-articles" tabindex="-1">5. Referenced Articles <a class="header-anchor" href="#_5-referenced-articles" aria-label="Permalink to &quot;5. Referenced Articles&quot;"></a></h2>
<p><a href="https://www.bilibili.com/video/BV1HT4y1A7mh?spm_id_from=333.337.search-card.all.click" target="_blank" rel="noreferrer">1. „ÄêPingCAP Infra Meetup„ÄëNo.131 Why and how we build TiCDC</a><br>
<a href="https://www.bilibili.com/video/BV1bD4y1o7qU?spm_id_from=333.337.search-card.all.click" target="_blank" rel="noreferrer">2. „ÄêPingCAP Infra Meetup„ÄëNo.131 TiCDC ÁöÑÁîüÊÄÅÂíåÁ§æÂå∫Âª∫ËÆæ</a>
<a href="https://docs.pingcap.com/zh/tidb/stable/ticdc-overview" target="_blank" rel="noreferrer">3. ÂÆòÊñπÊñáÊ°£ -- TiCDC</a><br>
<a href="https://docs.pingcap.com/zh/tidb/stable/tidb-binlog-overview" target="_blank" rel="noreferrer">4. ÂÆòÊñπÊñáÊ°£ -- TiDB Binlog</a><br>
<a href="https://docs.pingcap.com/zh/tidb/stable/handle-tidb-binlog-errors#%E5%BD%93%E4%B8%8A%E6%B8%B8%E4%BA%8B%E5%8A%A1%E8%BE%83%E5%A4%A7%E6%97%B6pump-%E6%8A%A5%E9%94%99-rpc-error-code--resourceexhausted-desc--trying-to-send-message-larger-than-max-2191430008-vs-2147483647" target="_blank" rel="noreferrer">5. ÂÆòÊñπ FAQ -- Pump ÁöÑ gRPC message Ë∂ÖËøáÈôêÂÄº</a><br>
<a href="https://github.com/pingcap/tiflow/blob/master/docs/design/2020-11-04-ticdc-protocol-list.md#protocols-%E5%88%86%E5%8D%8F%E8%AE%AE%E4%BB%8B%E7%BB%8D" target="_blank" rel="noreferrer">6. Github Design Doc -- TiCDC ÊîØÊåÅÁöÑÊ∂àÊÅØÈòüÂàóËæìÂá∫ÂçèËÆÆÊåáÂçó</a><br>
<a href="https://github.com/pingcap/tiflow/projects/13" target="_blank" rel="noreferrer">7. Github Question and Bug Reports -- TiCDC ÊèêÂçáÊÄßËÉΩËßÑÂàíË∑ØÂæÑ</a><br>
<a href="https://tidb.net/blog/2fa9cf6a" target="_blank" rel="noreferrer">8. AskTUG Blog -- ‰ª£ÊôìÁ£ä TiCDC Â∫îÁî®Âú∫ÊôØËß£Êûê</a><br>
<a href="https://kafka.apache.org/intro" target="_blank" rel="noreferrer">9. ÂÆòÊñπÊñáÊ°£ -- Kafka</a></p>
<p>Additionally, AskTUG, as the official support community for the TiDB ecosystem, is recommended for discussions <a href="https://tidb.net/blog/70588c4c" target="_blank" rel="noreferrer">here https://tidb.net/blog/70588c4c</a>.</p>
]]></content:encoded>
            <enclosure url="https://askaric.com/images/tidb/05TiDB-EcosystematicTools/5-1TiCDC/01BinlogAndTiCDC.png" length="0" type="image/png"/>
        </item>
        <item>
            <title><![CDATA[Analyzing the Architecture Model]]></title>
            <link>https://askaric.com/en/work/tidb/TiDB-EcosystematicTools/TiCDC/TiCDC Streaming.html</link>
            <guid>https://askaric.com/en/work/tidb/TiDB-EcosystematicTools/TiCDC/TiCDC Streaming.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[1. Synchronization Model

 1.1 Stream Processing vs. Batch Processing

"Data synchronization" es]]></description>
            <content:encoded><![CDATA[<h1 id="analyzing-the-architecture-model" tabindex="-1">Analyzing the Architecture Model <a class="header-anchor" href="#analyzing-the-architecture-model" aria-label="Permalink to &quot;Analyzing the Architecture Model&quot;"></a></h1>
<h2 id="_1-synchronization-model" tabindex="-1">1. Synchronization Model <a class="header-anchor" href="#_1-synchronization-model" aria-label="Permalink to &quot;1. Synchronization Model&quot;"></a></h2>
<h3 id="_1-1-stream-processing-vs-batch-processing" tabindex="-1">1.1 Stream Processing vs. Batch Processing <a class="header-anchor" href="#_1-1-stream-processing-vs-batch-processing" aria-label="Permalink to &quot;1.1 Stream Processing vs. Batch Processing&quot;"></a></h3>
<p>&quot;Data synchronization&quot; essentially belongs to &quot;data processing,&quot; which involves transferring data from one end to another. The &quot;end&quot; refers to a product unit, including distributed clusters. The main types of &quot;data processing&quot; can be divided into &quot;stream processing&quot; and &quot;batch processing.&quot; Their definitions, characteristics, and origins are as follows, borrowed from the <a href="https://flink.apache.org/flink-architecture.html" target="_blank" rel="noreferrer">Flink official website's explanation of computing engines</a>:</p>
<ol>
<li>In terms of definition:
<ul>
<li>Batch processing: Processes a fixed range of datasets using algorithms like MapReduce or Batch to meet functional requirements.</li>
<li>Stream processing: Processes datasets without a fixed range using algorithms based on Event-Time data structures to meet functional requirements.</li>
</ul>
</li>
<li>In terms of characteristics:
<ul>
<li>&quot;Batch processing,&quot; as the name suggests, reduces unnecessary performance consumption during calls by processing in batches, thereby improving performance, e.g., MapReduce.</li>
<li>&quot;Stream processing&quot; emerged as a counterpart to batch processing. For continuously generated data streams like log data or transaction data, stream processing optimizes computation methods based on the inherent orderliness of the data (e.g., occurrence time). For instance, in batch processing, if you want to count the number of changes from state A to state B in Log1 and Log2 between 3:00:00 and 4:00:00, the batch method would aggregate and summarize during the corresponding time window. However, if a change in Log1 falls outside the batch time window (e.g., 4:05:00) due to asynchronous threads or network transmission, this event cannot be calculated in the current batch and must wait for the next batch. This issue can lead to correctness problems in &quot;data synchronization&quot; processing, making stream processing particularly suitable for handling <strong>stateful (e.g., time)</strong> unbounded data streams.</li>
</ul>
</li>
</ol>
<p>In summary, this section aims to illustrate that data synchronization is suitable for <strong>stream event processing</strong> types. During the study of TiCDC code, it was found to be based on stream event processing.</p>
<h3 id="_1-2-stream-processing-source-and-sink" tabindex="-1">1.2 Stream Processing Source and Sink <a class="header-anchor" href="#_1-2-stream-processing-source-and-sink" aria-label="Permalink to &quot;1.2 Stream Processing Source and Sink&quot;"></a></h3>
<p>In the first article of the TiCDC series <a href="https://tidb.net/blog/70588c4c" target="_blank" rel="noreferrer">TiCDC Series Sharing - 01 - Brief Background</a>, it was mentioned that TiCDC provides an At Least Once synchronization model. At Least Once describes: <strong>&quot;The delivery semantics of a stream processing system when any component node in the synchronization chain fails.&quot;</strong> The complete set of related semantics is as follows:</p>
<ol>
<li>At Most Once: Operator events are processed only once, i.e., downstream operators are assumed to have successfully received messages from upstream by default. Data is lost in case of failure.</li>
<li>At Least Once: Operator events may be processed multiple times, i.e., if downstream operators fail to receive messages, upstream operators will retransmit the data.</li>
<li>Exactly Once: Operator events are effectively processed only once, i.e., if downstream operators fail to receive messages, they will receive retransmitted data from upstream. However, for the downstream's downstream operators (e.g., external systems like MySQL), the message is delivered effectively only once.</li>
</ol>
<p>In <strong>stream processing (event processing)</strong>, systems like Google Dataflow and Flink achieve Exactly Once through &quot;deduplication&quot; and <a href="https://lamport.azurewebsites.net/pubs/chandy.pdf" target="_blank" rel="noreferrer">&quot;distributed snapshots&quot;</a>, respectively. Exactly Once offers better performance but has its pros and cons under different algorithms. For details, refer to <a href="https://juejin.cn/post/6844903857558913038#heading-5" target="_blank" rel="noreferrer">Flink China Blog - Discussing the 'Exactly Once' Feature in Stream Computing</a>. Returning to why TiCDC only provides At Least Once is unknown. It might be due to factors like expectations, delivery, scheduling, and optimization. However, it is believed that this feature will be provided in the future.</p>
<p>The following diagram abstracts the synchronization model by comparing it to general stream engines (Dataflow or Flink), where the source is the sender and the sink is the receiver. Currently, two parts in TiCDC can be categorized under this abstraction:</p>
<ol>
<li>The process of collecting kv change logs in the tikv cdc component and delivering them to TiCDC Capture.</li>
<li>The process of collecting data in the puller and delivering it to downstream platforms like MySQL, MQ, or others.</li>
</ol>
<figure><img src="./../../../../../images/tidb/05TiDB-EcosystematicTools/5-1TiCDC/07TiCDC_DataFlow_Model.png" alt="07TiCDC_DataFlow_Model" tabindex="0"><figcaption>07TiCDC_DataFlow_Model</figcaption></figure>
<p>Abstracting to Source and Sink allows applying the &quot;delivery semantics of stream processing systems&quot; to this link. If message delivery fails in this link, it indicates the level of semantic support provided. As mentioned earlier, <strong>TiCDC provides At Least Once semantic support</strong>, which means it will retransmit, and the retransmitted duplicate data will be delivered again. However, due to the implementation of <strong>&quot;idempotency,&quot;</strong> data consistency is maintained.</p>
<ol>
<li>If the tikv cdc component fails to deliver a message to TiCDC Capture, it will retransmit.</li>
<li>If TiCDC Capture fails to deliver a message to the Downstream Platform, it will retransmit.</li>
</ol>
<p>The abstraction of Source and Sink in TiCDC also verifies that TiCDC has some similar foundational definitions for achieving &quot;Exactly Once,&quot; but it has not been implemented yet.</p>
<h2 id="_2-product-architecture" tabindex="-1">2. Product Architecture <a class="header-anchor" href="#_2-product-architecture" aria-label="Permalink to &quot;2. Product Architecture&quot;"></a></h2>
<p>The following diagram shows the TiCDC data flow architecture. TiCDC consists of stateless nodes called Capture, which are composed to achieve high availability through PD's internal etcd. It supports creating multiple synchronization tasks and synchronizing data to multiple different downstreams.<br>
Before understanding TiCDC, it's essential to grasp some conceptual definitions, such as Owner, Processor, ChangeFeed, ReslovedTs, CheckpointTs, etc. Some concepts are sourced from the <a href="https://docs.pingcap.com/zh/tidb/stable/ticdc-glossary#%E5%8F%98%E6%9B%B4%E6%95%B0%E6%8D%AE" target="_blank" rel="noreferrer">TiDB official explanation</a>, while others are derived from personal reading and research of relevant documents and source code. Discussions are welcome.</p>
<figure><img src="./../../../../../images/tidb/05TiDB-EcosystematicTools/5-1TiCDC/08ticdc_architecture.png" alt="08ticdc_architecture" tabindex="0"><figcaption>08ticdc_architecture</figcaption></figure>
<h3 id="_2-1-owner" tabindex="-1">2.1 Owner <a class="header-anchor" href="#_2-1-owner" aria-label="Permalink to &quot;2.1 Owner&quot;"></a></h3>
<p>Definition: A special role of Capture.<br>
Location: Internally within Capture, competing to become the Owner. Only one Capture will successfully become the Owner.<br>
Function: Maintains the synchronization status of all Capture in the global synchronization Task. For example, Table transfer Capture scheduling, executing DDL, updating the changefeed's Global CheckpointTs, and Global ResolvedTs.</p>
<h3 id="_2-2-processor" tabindex="-1">2.2 Processor <a class="header-anchor" href="#_2-2-processor" aria-label="Permalink to &quot;2.2 Processor&quot;"></a></h3>
<p>Definition: The synchronization processing unit of a data table.<br>
Location: Internally within Capture, multiple Processors can be started in each Capture. The number of Processors is related to ChangeFeed, i.e., a multi-table synchronization ChangeFeed is scheduled to each Capture. The Owner will build Processors on different Captures based on the (Capture, ChangeFeed, Table count) tuple.<br>
Function: Responsible for pulling, sorting, restoring, and distributing change data for the tables assigned to it. The creation of a ChangeFeed triggers the creation of a Processor, which reads the KeyRange and Region distribution of the assigned tables and establishes an EventFeed gRPC stream. During the continuous streaming process, it maintains its Processor ResolvedTs and Processor CheckpointTs and synchronizes data to the downstream based on the Global ResolvedTs.</p>
<h3 id="_2-3-puller" tabindex="-1">2.3 Puller <a class="header-anchor" href="#_2-3-puller" aria-label="Permalink to &quot;2.3 Puller&quot;"></a></h3>
<p>Definition: The module that pulls Change logs from tikv.<br>
Location: DDL Puller is located within the Processor, one for each Processor.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Row change Puller is located within the TablePipline, one for each TablePipline (i.e., Table).<br>
Function: Continuously pulls Change Logs from TiKV, writing to Buffer and Sorter.</p>
<h3 id="_2-4-mounter" tabindex="-1">2.4 Mounter <a class="header-anchor" href="#_2-4-mounter" aria-label="Permalink to &quot;2.4 Mounter&quot;"></a></h3>
<p>Definition: The module that translates KV Change Logs to TiCDC Change Events.<br>
Location: Internally within Capture, the Mounter is a global thread pool for Capture, but since it is called by each TablePipline, it is considered internal to Tablepipline.<br>
Function: Decodes RawKVEntry into RowChangedEvent, i.e., translates RawKV into the data needed by SQL.</p>
<h3 id="_2-5-sorter" tabindex="-1">2.5 Sorter <a class="header-anchor" href="#_2-5-sorter" aria-label="Permalink to &quot;2.5 Sorter&quot;"></a></h3>
<p>Definition: The module that sorts unordered kv change logs.
Location: Internally within Tablepipline, the unifiedSorter wraps Level DB, other engines are not introduced here, <a href="https://github.com/pingcap/tiflow/blob/master/docs/design/2022-03-16-ticdc-db-sorter.md" target="_blank" rel="noreferrer">for details, refer to the design document ticdc-db-sorter</a>.<br>
Function: Receives unsorted data, stores it in the internal LevelDB, and sorts it based on CheckpointTs for transaction and row data change restoration.</p>
<h3 id="_2-6-sink" tabindex="-1">2.6 Sink <a class="header-anchor" href="#_2-6-sink" aria-label="Permalink to &quot;2.6 Sink&quot;"></a></h3>
<p>Definition: The abstract module for synchronizing to multiple downstream platforms.<br>
Location: Internally within Capture.<br>
Function: Triggers row change events or DDL change events to synchronize change data to the downstream.</p>
<h3 id="_2-7-changefeed" tabindex="-1">2.7 ChangeFeed <a class="header-anchor" href="#_2-7-changefeed" aria-label="Permalink to &quot;2.7 ChangeFeed&quot;"></a></h3>
<p>Definition: The unit of synchronization task in TiCDC, each ChangeFeed task includes the synchronization of multiple tables.<br>
Location: Located in PD, once a ChangeFeed is created, it will be processed by the corresponding module in Capture.<br>
Function: Provides an easily understandable &quot;synchronization task&quot; semantic definition for users.</p>
<h2 id="_3-reslovedts-and-checkpointts" tabindex="-1">3. ReslovedTs and CheckpointTs <a class="header-anchor" href="#_3-reslovedts-and-checkpointts" aria-label="Permalink to &quot;3. ReslovedTs and CheckpointTs&quot;"></a></h2>
<h3 id="_3-1-reslovedts" tabindex="-1">3.1 ReslovedTs <a class="header-anchor" href="#_3-1-reslovedts" aria-label="Permalink to &quot;3.1 ReslovedTs&quot;"></a></h3>
<p>Definition: The latest consistent data that TiDB can read ( ResolvedTs &lt; All Unapply CommitTs  ), indicating that the tikv committed log before ResolvedTs has been received by the puller and can be restored as a complete transaction.<br>
Location: In the TiKV CDC Component, it observes the change of LockCF during data Apply to monitor the data changes of the Region.<br>
Function: Reduces the latency of TiCDC in restoring transactions, i.e., ResolvedTS ‚â§ Min Region StartTS &lt; all unapplied CommitTS. The initialization, delivery, and recommendation principles of ReslovedTs are as follows:</p>
<ol>
<li><strong>ResolvedTs generation</strong>: During the initialization phase, it is the event timestamp passed in at the beginning. After incremental scanning, it is obtained from the logs listened to from RaftStore.</li>
<li><strong>ResolvedTs delivery</strong>: TiKV CDC Component pushes the data of active Regions' Prewrite + Commit (carrying Ts) to the outside and promotes the non-active Regions' advancement through heartbeat (carrying Ts).</li>
<li><strong>ResolvedTs advancement</strong>: ResolvedTs is divided into Table-level, Processor-level, and Global-level. The resolved ts obtained by Capture from the kv client is advanced by taking the minimum of all regions sorted by table. That is, the event containing the resolved ts event output after sorting within the table is stored as the resolved ts of this table. The processor summarizes the resolved ts of all tables it is responsible for and the resolved ts of the ddl puller, takes the minimum value, and updates it as the resolved ts of the table. The owner reads the resolved ts of all tables, takes the minimum value, and updates the global resolved ts.</li>
</ol>
<h3 id="_3-2-checkpointts" tabindex="-1">3.2 CheckpointTs <a class="header-anchor" href="#_3-2-checkpointts" aria-label="Permalink to &quot;3.2 CheckpointTs&quot;"></a></h3>
<p>Definition: A type of ResolvedTs, indicating that all data before CheckpointTs has been synchronized to the downstream.<br>
Location: In Tablepipline, Processor, and Owner, constantly updated during the continuous streaming phase.<br>
Function: Ensures transaction atomicity. For example, if a transaction spans multiple regions, some keys may be successfully delivered to the capture while others are not, leading to a loss of atomicity for the transaction. CheckpointTs indicates that all keys less than checkpointTs have been sent to the Capture before this time point.</p>
<h2 id="_4-startup-process" tabindex="-1">4. Startup Process <a class="header-anchor" href="#_4-startup-process" aria-label="Permalink to &quot;4. Startup Process&quot;"></a></h2>
<p>Overall, the creation of a ChangeFeed goes through two stages: <strong>&quot;Incremental Scan&quot; + &quot;Continuous Streaming&quot;</strong>. The detailed description is as follows, referring to <a href="https://github.com/pingcap/tiflow/blob/master/docs/design/2020-03-04-ticdc-design-and-architecture-cn.md#tikv-%E5%85%B7%E4%BD%93%E8%A1%8C%E4%B8%BA" target="_blank" rel="noreferrer">ticdc-design</a>Ôºö</p>
<figure><img src="./../../../../../images/tidb/05TiDB-EcosystematicTools/5-1TiCDC/09incremental_scan_continues_push.jpeg" alt="09incremental_scan_continues_push" tabindex="0"><figcaption>09incremental_scan_continues_push</figcaption></figure>
<h3 id="_4-1-incremental-scan" tabindex="-1">4.1 Incremental Scan <a class="header-anchor" href="#_4-1-incremental-scan" aria-label="Permalink to &quot;4.1 Incremental Scan&quot;"></a></h3>
<p>When a ChangeFeed creation request is made, it carries a checkpoint_ts. Upon receiving the request, TiKV constructs a rocksdb snapshot and retrieves the Range ( checkpoint_ts, uint64::MAX ] - all records greater than checkpoint_ts.<br>
The incremental scan targets the data in TiKV RocksDB. As shown in the example, the incremental scan (TS1,TS5] scans LockCF + DefaultCF and constructs the corresponding perwirte records. It scans DefaultCF and WriteCF to build the records without locks greater than @TS1, simultaneously constructing the data for the continuous streaming phase.</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">@TS1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">begin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;                                                 </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">@TS2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">update</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Table_Jan </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">set</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'Jan Su'</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;                           </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">@TS3                          </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">begin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;                      </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">@TS4 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">commit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;                                                </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">@TS5                          </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">update</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Table_Jan </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">set</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'Jan Su'</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span></code></pre>
</div><h3 id="_4-2-continuous-streaming" tabindex="-1">4.2 Continuous Streaming <a class="header-anchor" href="#_4-2-continuous-streaming" aria-label="Permalink to &quot;4.2 Continuous Streaming&quot;"></a></h3>
<p>After the incremental scan, TiCDC continuously streams data through <strong>&quot;TiKV CDC Component --&gt; Capture --&gt; Downstream&quot;</strong>, maintaining CheckpointTs and ResolvedTs in real-time. Inside the TiKV CDC Component, a Region Map is maintained to listen to the log changes of RaftStore in real-time to push data to Capture. The Capture internally sorts the scattered TiKV Change Logs received and restores transactions to distribute and consume data to the downstream.</p>
<h3 id="_4-3-log-listening" tabindex="-1">4.3 Log Listening <a class="header-anchor" href="#_4-3-log-listening" aria-label="Permalink to &quot;4.3 Log Listening&quot;"></a></h3>
<p>After the incremental scan, the TiKV CDC Component registers an Observer in the Coprocessor to listen to the TiKV Change Log generated by RaftStore, continuously providing the data needed for the sustained push after the incremental scan.</p>
<h2 id="_5-state-maintenance" tabindex="-1">5. State Maintenance <a class="header-anchor" href="#_5-state-maintenance" aria-label="Permalink to &quot;5. State Maintenance&quot;"></a></h2>
<p>For DML changes, all Processors synchronize to the Global ResolvedTs, write to the downstream, and then update the CheckpointTs. For DDL changes, all processor CheckpointTs synchronize to the DDL commitTs, and then execute the DDL to the downstream. The calculation methods for Global ResolvedTs and Processor ResolvedTs are as follows, and maintain the following chart:</p>
<ol>
<li>Global ResolvedTs is calculated by the owner, taking the minimum value of all Processor's ResolvedTs and DDL puller's ResolvedTs.</li>
<li>Processor ResolvedTs is calculated by the Processor, taking the minimum value of all Tablepipline's ResolvedTs.</li>
</ol>
<figure><img src="./../../../../../images/tidb/05TiDB-EcosystematicTools/5-1TiCDC/10TiCDC_ResolvedTs_CheckpointTs.png" alt="10TiCDC_ResolvedTs_CheckpointTs" tabindex="0"><figcaption>10TiCDC_ResolvedTs_CheckpointTs</figcaption></figure>
<h2 id="_6-state-fault-tolerance" tabindex="-1">6. State Fault Tolerance <a class="header-anchor" href="#_6-state-fault-tolerance" aria-label="Permalink to &quot;6. State Fault Tolerance&quot;"></a></h2>
<p>State fault tolerance refers to how TiCDC provides &quot;At Least Once&quot; fault tolerance guarantees when data delivery ends fail.<br>
<strong>The following are two possible scenarios for state fault tolerance:</strong> The CheckpointTs and ResolvedTs of the Table can be understood similarly to the Snapshot mechanism in &quot;Exactly Once,&quot; but they provide &quot;At Least Once&quot; semantic guarantees.</p>
<ol>
<li>
<p><strong>Taking the tikv cdc component as the data delivery end:</strong> The receiving end is TiCDC Capture. Suppose the change log data of the table (N+2) managed by the Tablepipline is already in the Puller. Still, due to the Region Leader change, the DownStream connection between GRPC and TiKV needs to be re-established. The data will be re-pulled based on the Table ResolvedTs (N+1), but this data already exists in the Puller, causing data redundancy. The &quot;At Least Once&quot; semantic guarantee will result in the re-pulled data being restored as redundant data changes, i.e., the subsequent data will overwrite the previous data during synchronization to the downstream, making the operation idempotent.</p>
</li>
<li>
<p><strong>Taking TiCDC Capture as the data delivery end:</strong> The receiving end is the Downstream Platform. When the Capture where the Table is located crashes, the Owner will detect it and create a new Processor and Tablepipline on other Captures. It will request the TiKV CDC Component to reconstruct the GRPC Stream connection to pull TiKV Change Log data based on the CheckpointTs stored in PD, achieving high availability and fault tolerance.</p>
</li>
</ol>
<figure><img src="./../../../../../images/tidb/05TiDB-EcosystematicTools/5-1TiCDC/11TiCDC_Dataflow_Model.jpeg" alt="11TiCDC_Dataflow_Model" tabindex="0"><figcaption>11TiCDC_Dataflow_Model</figcaption></figure>
<h2 id="_7-references" tabindex="-1">7. References <a class="header-anchor" href="#_7-references" aria-label="Permalink to &quot;7. References&quot;"></a></h2>
<p><a href="https://www.bilibili.com/video/BV1qb411H7mY?spm_id_from=333.337.search-card.all.click" target="_blank" rel="noreferrer">1. Introduction to Apache Flink Concepts: The Cornerstone of Stateful Stream Processing Engines</a><br>
<a href="https://zhuanlan.zhihu.com/p/96045864" target="_blank" rel="noreferrer">2. Analysis of Flink Exactly Once State Fault Tolerance Paper Lamport's &quot;Distributed Snapshots&quot;</a><br>
<a href="https://lamport.azurewebsites.net/pubs/chandy.pdf" target="_blank" rel="noreferrer">3. Original Text of Flink Exactly Once State Fault Tolerance Distributed Snapshots: Determining Global States of Distributed Systems</a><br>
<a href="https://flink.apache.org/flink-architecture.html" target="_blank" rel="noreferrer">4. Flink Official Website Computing Engine Description</a><br>
<a href="https://tidb.net/blog/70588c4c" target="_blank" rel="noreferrer">5. TiCDC Series Sharing - 01 - Brief Background</a><br>
<a href="https://juejin.cn/post/6844903857558913038#heading-5" target="_blank" rel="noreferrer">6. Comparison of Implementation Methods for Exactly Once &quot;Distributed Snapshots&quot; and &quot;Deduplication&quot;</a><br>
<a href="https://github.com/pingcap/tiflow/blob/master/docs/design/2022-03-16-ticdc-db-sorter.md" target="_blank" rel="noreferrer">7. TiCDC Design Document ticdc-db-sorter</a><br>
<a href="https://github.com/pingcap/tiflow/blob/master/docs/design/2020-03-04-ticdc-design-and-architecture-cn.md#tikv-%E5%85%B7%E4%BD%93%E8%A1%8C%E4%B8%BA" target="_blank" rel="noreferrer">8. TiCDC Design Document Introduction to &quot;Incremental Scan + Streaming&quot;</a></p>
]]></content:encoded>
            <enclosure url="https://askaric.com/images/tidb/05TiDB-EcosystematicTools/5-1TiCDC/07TiCDC_DataFlow_Model.png" length="0" type="image/png"/>
        </item>
        <item>
            <title><![CDATA[What's Spanner Transaction]]></title>
            <link>https://askaric.com/en/work/tidb/TiDB-Principle/Paper Reading/02Spanner Transaction.html</link>
            <guid>https://askaric.com/en/work/tidb/TiDB-Principle/Paper Reading/02Spanner Transaction.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[‰∏Ä„ÄÅËÆ∫ÊñáÊëòË¶Å

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Spanner ÊòØ Google ÂèØÊâ©Â±ïÁöÑ„ÄÅÂ§öÁâàÊú¨ÁöÑ„ÄÅÂÖ®ÁêÉÂàÜÂ∏ÉÂºèÁöÑ„ÄÅÂêåÊ≠•Â§çÂà∂ÁöÑÊï∞ÊçÆÂ∫ì]]></description>
            <content:encoded><![CDATA[<h1 id="what-s-spanner-transaction" tabindex="-1">What's Spanner Transaction <a class="header-anchor" href="#what-s-spanner-transaction" aria-label="Permalink to &quot;What's Spanner Transaction&quot;"></a></h1>
<h2 id="‰∏Ä„ÄÅËÆ∫ÊñáÊëòË¶Å" tabindex="-1">‰∏Ä„ÄÅËÆ∫ÊñáÊëòË¶Å <a class="header-anchor" href="#‰∏Ä„ÄÅËÆ∫ÊñáÊëòË¶Å" aria-label="Permalink to &quot;‰∏Ä„ÄÅËÆ∫ÊñáÊëòË¶Å&quot;"></a></h2>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Spanner ÊòØ Google ÂèØÊâ©Â±ïÁöÑ„ÄÅÂ§öÁâàÊú¨ÁöÑ„ÄÅ<strong>ÂÖ®ÁêÉÂàÜÂ∏ÉÂºèÁöÑ</strong>„ÄÅÂêåÊ≠•Â§çÂà∂ÁöÑÊï∞ÊçÆÂ∫ì„ÄÇÊúÄÈáçË¶ÅÁöÑÊòØ Spanner Ê®°Êãü‰∫ÜÊó†ÈîÅÂè™ËØª‰∫ãÁâ©„ÄÅÂàÜÂ∏ÉÂºèÂéüÂ≠êÊìç‰Ωú„ÄÇF1 ÊòØ Spanner ÁöÑÁ¨¨‰∏Ä‰∏™‰ΩøÁî®ËÄÖ„ÄÅ‰∏Ä‰∏™ Google ÂπøÂëäÁ≥ªÁªüÂêéÂè∞ÔºåÊï∞ÊçÆË∑® 3 Âà∞ 5 ‰∏™Êï∞ÊçÆ‰∏≠ÂøÉÔºåÂπ≥Êó∂ÈÄâÊã©‰ΩéÂª∂Êó∂ÁöÑÊï∞ÊçÆ‰∏≠ÂøÉ‰∫§‰∫íÔºå1 Âà∞ 2 ‰∏™Êï∞ÊçÆ‰∏≠ÂøÉÂêåÊó∂ÂèëÁîüÁÅæÈöæÊó∂ÂèØÊï∞ÊçÆËá™Âä®Âπ∏Â≠ò„ÄÇ<strong>Êú¨‰∫∫ÂÜôËøôÁØáÊñáÁ´†ÁöÑÁî®ÊÑèÊòØÂÆûÁé∞‰ªé‰∏Ä‰∏™ËæÉ‰∏∫ÂÆèËßÇÁöÑËßíÂ∫¶‰ªãÁªç Spanner Â¶Ç‰ΩïÂÆûÁé∞ ÂèØ‰º∏Áº©ÊÄßÔºåËá™Âä®ÂàÜÁâáÔºåÂÆπÈîôÔºå‰∏ÄËá¥Â§çÂà∂Á≠âÁâπÊÄß„ÄÇ</strong></p>
<h2 id="‰∫å„ÄÅËÆ∫ÊñáÁÆÄ‰ªã" tabindex="-1">‰∫å„ÄÅËÆ∫ÊñáÁÆÄ‰ªã <a class="header-anchor" href="#‰∫å„ÄÅËÆ∫ÊñáÁÆÄ‰ªã" aria-label="Permalink to &quot;‰∫å„ÄÅËÆ∫ÊñáÁÆÄ‰ªã&quot;"></a></h2>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Spanner ÊòØ‰∏Ä‰∏™ÂèØÊâ©Â±ïÁöÑ„ÄÅÂÖ®ÁêÉÂàÜÂ∏ÉÂºèÊï∞ÊçÆÂ∫ìÔºå‰∏ªË¶ÅÂÖ≥Ê≥®ÁÇπÊòØÁÆ°ÁêÜË∑®Êï∞ÊçÆ‰∏≠ÂøÉÁöÑÂ§çÂà∂Êï∞ÊçÆÔºåÁî® Paxos Áä∂ÊÄÅÊú∫ÂàÜÁâáÊï∞ÊçÆÔºåÂÆ¢Êà∑Á´ØÈìæÊé•Ëá™Âä®Âú® Replica Èó¥Â§±Ë¥•ÂùáË°°„ÄÇÂΩìÊï∞ÊçÆÈáè„ÄÅÊúçÂä°Âô®Êï∞ÊçÆÈáèÂèëÁîüÂèòÂåñÊó∂ÔºåËá™Âä®Â§∏Êú∫Âô®ÈáçÊñ∞ÂàÜÈÖçÊï∞ÊçÆ<strong>Âπ≥Ë°°Ë¥üËΩΩÂπ∂ÂìçÂ∫îÊïÖÈöú</strong>Ôºõ</p>
<ol>
<li>Èù¢ÂØπÂ∫îÁî®ÈùûÂÖ≥Á≥ªÊ®°ÂºèÁöÑÁöÑË¥üË¥£„ÄÅÂ§ñÂ±ÇÁ≥ªÁªüÊï∞ÊçÆÂêåÊ≠•Á≠âÂº∫‰∏ÄËá¥ÈóÆÈ¢òÔºåSpanner ÊºîÂèòÊàêÁ±ª BigTable ÁöÑÈîÆÂÄºÂ≠òÂÇ®ÁöÑÂ§öÁâàÊú¨Êï∞ÊçÆÂ∫ìÔºåÁî®ÂçäÂÖ≥Á≥ªÂûãË°®Â≠òÂÇ®‰∏¥Êó∂Êï∞ÊçÆÔºåÂ§öÁâàÊú¨Êï∞ÊçÆÊê∫Â∏¶Êó∂Èó¥Êà≥ÔºåÈÖçÂêàÂûÉÂúæÂõûÊî∂Êú∫Âà∂ÂõûÊî∂ÊóßÁâàÊú¨Êï∞ÊçÆÔºõ</li>
<li>Spanner Êèê‰æõÈÄöÁî®‰∫ãÂä°Ê®°ÂºèÔºåÂπ∂ÊîØÊåÅ SQL ÊèèËø∞ÂºèËØ≠Ë®ÄÂ§ÑÁêÜÔºõ</li>
</ol>
<p><strong>Spanner ÈáçË¶ÅÁâπÊÄßÔºö</strong></p>
<ol>
<li>Êï∞ÊçÆÁöÑÂ§çÂà∂ÈÖçÁΩÆÂèØ‰ª•Áî±Â∫îÁî®Á®ãÂ∫èÂä®ÊÄÅÊéßÂà∂ÔºåÂπ∂Âä®ÊÄÅ„ÄÅÈÄèÊòéÂú∞Âú®Êï∞ÊçÆ‰∏≠ÂøÉ‰πãÈó¥ÁßªÂä®Êï∞ÊçÆÔºå‰ª•Âπ≥Ë°°Êï∞ÊçÆ‰∏≠ÂøÉ‰πãÈó¥ÁöÑËµÑÊ∫êÔºõ
1.1 ÈÄâÂèñËØªÊï∞ÊçÆÁõÆÁöÑÂú∞Ë∑ùÁ¶ª<strong>ÊéßÂà∂</strong>ËØªÂÜôÂª∂Êó∂Ôºõ
1.2 ÈÄâÂèñÂêÑÁä∂ÊÄÅÊú∫Èó¥Ë∑ùÁ¶ª<strong>ÊéßÂà∂</strong>ÂÜôÊï∞ÊçÆÊó∂Âú®ÂàÜÁâáÊï∞ÊçÆÈó¥ÁöÑÂª∂Êó∂Ôºõ
1.3 ÈÄâÂèñÂá†ÂâØÊú¨Êéß<strong>Âà∂ËØª</strong>ËØªÊÄßËÉΩ„ÄÅÊåÅ‰πÖÊÄß„ÄÅÂèØÁî®ÊÄßÔºõ</li>
<li>Â§ñÈÉ®ËØªÂÜô‰∏ÄËá¥ÊÄßÔºåÂü∫‰∫éÊó∂Èó¥Êà≥ÁöÑÂÖ®Â±ÄËØª‰∏ÄËá¥ÔºåÊ≠§ÁâπÊÄß‰Ωø‰∏ÄËá¥ÊÄßÂ§á‰ªΩ„ÄÅÂéüÂ≠êÊ®°Âºè‰øÆÊîπ„ÄÅMapReduce ÊâßË°åÊàê‰∏∫ÂèØËÉΩÔºõ
2.1 Spanner ÊòØÁ¨¨‰∏Ä‰∏™ÂÆûÁé∞ÂÖ®ÁêÉËåÉÂõ¥Âü∫‰∫éÊó∂Èó¥Êà≥ MVCC Êú∫Âà∂ÁöÑ‰∫ãÂä°ÊéßÂà∂Á≥ªÁªüÔºõ
2.2 Spanner ÈÄöËøá GPS ÂíåÂéüÂ≠êÊó∂ÈíüËÆæËÆ°ÂíåÂÆûÁé∞‰∫Ü TrueTime API ÔºåÁõ¥Êé•Êö¥Èú≤‰∏çÁ°ÆÂÆöÁöÑÊó∂ÈíüÔºåÂ¶ÇÊûúÊó∂ÈíüÂÅèÂ∑ÆËøáÂ§ßÔºåSpanner ‰ºöÈôçÈÄüÁ≠âÂæÖÁõ¥Ëá≥ËØØÂ∑ÆÂ∞è‰∫é 10msÔºõ</li>
</ol>
<h2 id="‰∏â„ÄÅÂü∫Êú¨ÊÄùÊÉ≥" tabindex="-1">‰∏â„ÄÅÂü∫Êú¨ÊÄùÊÉ≥ <a class="header-anchor" href="#‰∏â„ÄÅÂü∫Êú¨ÊÄùÊÉ≥" aria-label="Permalink to &quot;‰∏â„ÄÅÂü∫Êú¨ÊÄùÊÉ≥&quot;"></a></h2>
<h3 id="_3-1-spanner-ËÆæËÆ°ÂíåÂÆûÁé∞" tabindex="-1">3.1 Spanner ËÆæËÆ°ÂíåÂÆûÁé∞ <a class="header-anchor" href="#_3-1-spanner-ËÆæËÆ°ÂíåÂÆûÁé∞" aria-label="Permalink to &quot;3.1 Spanner ËÆæËÆ°ÂíåÂÆûÁé∞&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Spanner ÊäΩË±°‰∫ÜÊï∞ÊçÆË∑ØÂæÑÁî®‰∫éÁÆ°ÁêÜÂâØÊú¨Âíå‰ΩçÁΩÆÔºåÁß∞‰∏∫ ‚Äúdirectory‚ÄùÔºåÊòØÊúÄÂ∞èÊï∞ÊçÆÁßªÂä®ÂçïÂÖÉ„ÄÇ</p>
<p><strong>Â¶Ç‰∏ãÂü∫Êú¨Ê¶ÇÂøµÔºö</strong></p>
<ol>
<li>‰∏Ä‰∏™ Spanner ÈõÜÁæ§ÈÉ®ÁΩ≤Ë¢´Áß∞‰∏∫ ‚Äúuniverse‚ÄùÔºõ</li>
<li>‰∏Ä‰∏™ ‚Äúuniverse‚Äù ‰∏ãÊúâÂ§ö‰∏™ ‚ÄúZone‚ÄùÔºåÊØè‰∏™ ‚ÄúZone‚Äù ÊòØ‰∏Ä‰∏™ÁÆÄÂçïÁöÑ BigTable ÈõÜÁæ§Ôºå‚ÄúZone‚Äù ÊòØÂèØÁÆ°ÁêÜÁöÑÈÉ®ÁΩ≤ÂçïÂÖÉÔºõ‚ÄúZone‚Äù ‰πüÊòØÊï∞ÊçÆÂâØÊú¨ËÉΩÂ§çÂà∂ÁöÑ‰ΩçÁΩÆÈõÜÂêà„ÄÅÁâ©ÁêÜÈöîÁ¶ªÁöÑÈõÜÂêàÔºåÂèØ‰ª•Ë¢´Âä®ÊÄÅÁöÑÈöèÂä†ËΩΩ„ÄÅÂç∏ËΩΩ‰ªéËøêË°åÁöÑÁ≥ªÁªü‰∏≠Ôºå‰∏Ä‰∏™Êï∞ÊçÆ‰∏≠ÂøÉÂèØ‰ª•ÊúâÂ§ö‰∏™ ‚ÄúZone‚ÄùÔºõ</li>
<li>‰∏Ä‰∏™ ‚ÄúZone‚Äù ÁöÑ ‚ÄúZone Master‚Äù ÊåáÂÆöÂâØÊú¨Êï∞ÊçÆÂ§çÂà∂Âà∞ÁöÑ‰∏äÂçÉ‰∏™ ‚Äúspanservers‚ÄùÔºå‰ºöÊúâ ‚Äúper-zone location proxies‚Äù ÂàÜÈÖç ‚ÄúClient‚Äù ÊâÄËÉΩËé∑ÂèñÂà∞Êï∞ÊçÆÁöÑ ‚Äúspanservers‚ÄùÔºõ</li>
<li>‚Äúuniverse master‚Äù Âíå ‚Äúplacement driver‚Äù ÂäüËÉΩËøë‰ººÔºåÂâçËÄÖ‰∏ªË¶ÅÁî®‰∫éÊâìÂç∞ÊâÄÊúâ ‚ÄúZone‚Äù ‰ø°ÊÅØÔºåÂêéËÄÖ‰ª•ÂàÜÈíü‰∏∫Âçï‰ΩçÂ§ÑÁêÜ‰∏çÂêåÁä∂ÊÄÅÊú∫Èó¥„ÄÅ‚ÄúZone‚Äù Èó¥ÁöÑÊï∞ÊçÆÁßªÂä®Ôºõ</li>
</ol>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="./Theory-SpannerÂàÜÂ∏ÉÂºè‰∫ãÂä°/SpannerCluster.jpg" alt="SpannerCluster"></p>
<p><strong>‰∏ãÂõæÊòØÂü∫‰∫é Tablet ÂÆûÁé∞ÁöÑ SpannerÔºå‰ªé‰∏ãÂêë‰∏äÁúãÔºö</strong></p>
<ol>
<li>ÊØè‰∏™ Tablet Â≠òÂÇ® B-Tree Êï∞ÊçÆ„ÄÅColossus Â≠òÂÇ® WAL Êó•ÂøóÔºõ</li>
<li>Tablet ‰πã‰∏äÂÆûÁé∞ Paxos Áä∂ÊÄÅÊú∫ÔºåÊØè‰∏™Áä∂ÊÄÅÊú∫Â≠òÊîæËá™Â∑±ÁöÑÂÖÉÊï∞ÊçÆ„ÄÅÊó•ÂøóÊûÅÂÖ∂Áõ∏ÂÖ≥ tabletÔºõ</li>
<li>ÂΩìÂâç Spanner ÊØèÊ¨° Paxos ‰∫§‰∫íÂÜô‰∏§Ê¨°Êó•ÂøóÔºå‰∏ÄÊ¨°ÂÜô tablet Êó•ÂøóÔºå‰∏ÄÊ¨°ÂÜô paxos Êó•ÂøóÔºåSpanner ÈÄöËøáÁÆ°ÈÅìÂ¢ûÂ§ßÂêûÂêêËøõËÄåÂº•Ë°•ËøôÈ°πËÆæËÆ°ÂºïÂèëÁöÑÂª∂Êó∂ÈóÆÈ¢òÔºõ</li>
</ol>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="./Theory-SpannerÂàÜÂ∏ÉÂºè‰∫ãÂä°/BigTableBaisedSpanner.jpg" alt="BigTableBaisedSpanner"></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Paxos Áî®‰∫éÂÆûÁé∞‰∏ÄËá¥ÊÄßÂ§çÂà∂Ôºåreplica Êï∞ÊçÆÂ≠òÂÇ®Âú®Áõ∏ÂÖ≥ÁöÑ tablet ‰∏≠ÔºåÂÜôÂøÖÈ°ªÈÄöËøá Paxos Group LeaderÔºåËØªÂèØ‰ª•ÈÄöËøáÂ∑≤ÁªèÂèäÊó∂Êõ¥Êñ∞ÁöÑ replicate È´òÊïàËé∑Âèñ„ÄÇÊØè‰∏™ Spanner Server ÂÆûÁé∞‰∏Ä‰∏™ Lock Table ÈÄöËøá 2PC ÊñπÂºèÂÆûÁé∞Âπ∂ÂèëÊéßÂà∂„ÄÇ</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="./Theory-SpannerÂàÜÂ∏ÉÂºè‰∫ãÂä°/PaxosGroup.jpg" alt="PaxosGroup"></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Spanner ÂÆûÁé∞‰∫ÜÈïø‰∫ãÂä°ÔºåÁî®‰∫éËß£ÂÜ≥Âõ†ÂÜôÂÜ≤Á™ÅÂØºËá¥ÁöÑ‰πêËßÇÂπ∂ÂèëÊéßÂà∂ÊÄßËÉΩÂ∑Æ„ÄÅÂª∂ËøüÂ§ßÁöÑÈóÆÈ¢ò„ÄÇÂ¶Ç‰∏ãÂõæÔºåÂú®ÊØè‰∏™ Paxos Group ÊàêÂëòÂú®<strong>Áä∂ÊÄÅÊú∫ÂÜÖÈÉ®</strong>ÂùáÂÆûÁé∞‰∏Ä‰∏™‰∫ãÂä°ÁÆ°ÁêÜÂô®ÔºåTxn Group ‰∏≠‰ºöÈÄâÂá∫ LeaderÔºåÂÖ∂‰ªñÁß∞ SlaveÔºåLeader ‰ΩøÁî®‰∫ãÂä°ÁÆ°ÁêÜÂô®Â§ÑÁêÜÂÜ≤Á™ÅÔºõÁªÜËäÇÂ¶Ç‰∏ãÔºö
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>Ê≥®ÊÑèÔºö Txn Group Âíå Paxos Group ÁöÑÂÖ≥Á≥ªÊòØÔºåÂ§ö‰∏™ Paxos Group ÂØπ‰∏Ä‰∏™ Txn GroupÔºõ</strong></p>
<ol>
<li>Â¶ÇÊûú‰∏Ä‰∏™‰∫ãÂä°‰ªÖÂåÖÂê´‰∏Ä‰∏™ Paxos Group ÂèØÁõ¥Êé•ÁªïËøá‰∫ãÂä°ÁÆ°ÁêÜÂô®ÔºåÂõ†‰∏∫ Lock Table Âíå Paxos Êú¨Ë∫´Â∞±ÂèØ‰ª•ÂÆûÁé∞‰∫ãÂä°ÁÆ°ÁêÜÔºõ</li>
<li>Â¶ÇÊûú‰∏Ä‰∏™‰∫ãÁâ©ÂåÖÂê´Â§ö‰∏™ Paxos Group ÔºåTxn ‰∏≠‰ºöÂÖàÈÄâÂá∫Êú¨ Txn Leader ÔºåÂÖ∂‰ªñÁöÑ Paxos Group Leader Êàê‰∏∫ÂÄôÈÄâËÄÖÊåáÂêëÊú¨ TxnÔºõ</li>
</ol>
<h3 id="_3-2-spanner-dircetory-ÊäΩË±°" tabindex="-1">3.2 Spanner &quot;Dircetory&quot; ÊäΩË±° <a class="header-anchor" href="#_3-2-spanner-dircetory-ÊäΩË±°" aria-label="Permalink to &quot;3.2 Spanner &quot;Dircetory&quot; ÊäΩË±°&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Âú®ÈîÆÂÄºÂØπ‰πã‰∏ä Spanner ÂÆûÁé∞‰∫Ü &quot;Dircetory&quot; Ê°∂ÊäΩË±°ÔºåÊØè‰∏Ä‰∏™ &quot;Dircetory&quot; Â≠òÊîæÂÖ¨ÂÖ±ÂâçÁºÄÁöÑÊï∞ÊçÆÂèØ‰ª•Êõ¥Â•ΩÁöÑÊéßÂà∂Â±ÄÈÉ®Êï∞ÊçÆÔºåÂ¶ÇÔºöÊõ¥Âà©‰∫éËåÉÂõ¥Êâ´ÊèèÊï∞ÊçÆÔºåËøôÊòØÂü∫‰∫é hash ËßÑÂàôÂàÜÂå∫Êó†Ê≥ïÂÆûÁé∞ÁöÑ‰ºòÂäø„ÄÇSpanner ÂèØ‰ª•ÈÄöËøáÁßªÂä® &quot;Dircetory&quot; Êù•Èôç‰ΩéÊüê‰∏™ Paxos Group ÁöÑË¥üËΩΩÔºåÂ¶ÇÔºöÂ∞ÜÁªèÂ∏∏ËÆøÈóÆÁöÑÂ§ö‰∏™ &quot;Dircetory&quot; ÂêàÂπ∂‰∏∫‰∏Ä‰∏™ &quot;Dircetory&quot;„ÄÇ‰∏Ä‰∏™ 50MB ÁöÑ &quot;Dircetory&quot; ÂèØ‰ª•Âú®Âá†ÁßíÈíüÂÜÖÁßªÂä®„ÄÇ</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÁßªÂä® &quot;Dircetory&quot; ÊòØÁî®‰∫éÁßªÂä® Paxos Group ÁöÑÂêéÂè∞‰ªªÂä°ÔºåÈÄöËøáÊ∑ªÂä†„ÄÅÂà†Èô§ÂâØÊú¨ÊñπÂºèÂú®ÁªÑ‰πãÈó¥ÁßªÂä®ÁâáÊÆµ„ÄÇmovedir ‰ªéÊ≥®ÂÜåÂºÄÂßãÔºåÂêéÂè∞ÂêØÂä®Êï∞ÊçÆÁßªÂä®ÔºåÂΩìÂÆÉÁßªÂä®ÂÆåÊï∞ÊçÆÂêéÔºå‰ΩøÁî®‰∫ãÂä°Êù•ÂéüÂ≠êÊõ¥Êñ∞‰∏§‰∏™ Paxos Group ÂÖÉÊï∞ÊçÆ„ÄÇÈô§ÁßªÂä®Êï∞ÊçÆÂ§ñËøòÂèØÂàÜÂâ≤Êï∞ÊçÆÔºåÂ¶Ç &quot;Dircetory&quot; ÂèòÂæóÂ§™Â§ßÔºåSpanner‰ºöÂ∞ÜÂÖ∂ÂàÜÂâ≤ÊàêÂ§ö‰∏™ÁâáÊÆµ„ÄÇ</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÁÆ°ÁêÜÂëòÂèØÊéßÂà∂ÂâØÊú¨ÁöÑÊï∞Èáè„ÄÅÁ±ªÂûã„ÄÅÂú∞ÁêÜ‰ΩçÁΩÆÁöÑ‰∏çÂêåÁªÑÂêàÂÆûÁé∞ÈöîÁ¶ª‰∏éÂ§çÂà∂„ÄÇ‰æãÂ¶ÇÔºåÂ∫îÁî®Á®ãÂ∫èÂèØËÉΩÂ∞ÜÊâÄÈúÄË¶ÅÁöÑÊï∞ÊçÆÂ≠òÂÇ®Âú®‰∏Ä‰∏™ &quot;Dircetory&quot; ‰∏≠ÔºåÂä†‰πãÂú∞ÁêÜ‰ΩçÁΩÆÂÆûÁé∞ ‚ÄúÁî®Êà∑A‚Äù ÁöÑÊï∞ÊçÆÂú®Ê¨ßÊ¥≤Êúâ‰∏â‰∏™ÂâØÊú¨Ôºå‚ÄúÁî®Êà∑B‚Äù ÁöÑÊï∞ÊçÆÂú®ÂåóÁæéÊúâ‰∫î‰∏™ÂâØÊú¨„ÄÇ</p>
<h3 id="_3-4-truetime-api-ËÆæËÆ°ÂíåÂÆûÁé∞" tabindex="-1">3.4 TrueTime API ËÆæËÆ°ÂíåÂÆûÁé∞ <a class="header-anchor" href="#_3-4-truetime-api-ËÆæËÆ°ÂíåÂÆûÁé∞" aria-label="Permalink to &quot;3.4 TrueTime API ËÆæËÆ°ÂíåÂÆûÁé∞&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TrueTime Áî±ÊØè‰∏™Êï∞ÊçÆ‰∏≠ÂøÉÁöÑ‰∏ÄÁªÑ ‚ÄúÊó∂Èó¥‰∏ªÊú∫Âô®‚Äù ÂíåÊØè‰∏™Êú∫Âô®ÁöÑ ‚ÄúÊó∂Èó¥ÂÆàÊä§Á®ãÂ∫è‚Äù ÂÆûÁé∞Ôºå‰ΩøÁî®‰∏§ÁßçÂΩ¢ÂºèÁöÑÊó∂Èó¥ÂèÇËÄÉÔºåÁî®‰ª•ÊîæÁΩÆ‰∏çÂêåÁöÑÂ§±ÊïàÊ®°Âºè„ÄÇ</p>
<ol>
<li>GPS Â§±ÁÅµÁöÑÊñπÂºèÂèÇËÄÉÊ∫êÊºèÊ¥ûÂåÖÊã¨Â§©Á∫øÂíåÊé•Êî∂Âô®ÊïÖÈöú„ÄÅÊú¨Âú∞Êó†Á∫øÁîµÂπ≤Êâ∞ÂíåGPSÁ≥ªÁªü‰∏≠Êñ≠Á≠â„ÄÇ</li>
<li>ÂéüÂ≠êÈíüÂ§±ÁÅµÁöÑÊñπÂºèÂèÇËÄÉ GPS ‰ª•ÂèäÂéüÂ≠êÈíüÂΩºÊ≠§‰πãÈó¥‰∏çÁõ∏ÂÖ≥ÔºåÂèØËÉΩÁî±‰∫éÈ¢ëÁéáËØØÂ∑ÆÂá∫Áé∞ÊòéÊòæÊó∂Èó¥ÊºÇÁßª„ÄÇ</li>
</ol>
<h3 id="_3-3-spanner-Âπ∂ÂèëÊéßÂà∂" tabindex="-1">3.3 Spanner Âπ∂ÂèëÊéßÂà∂ <a class="header-anchor" href="#_3-3-spanner-Âπ∂ÂèëÊéßÂà∂" aria-label="Permalink to &quot;3.3 Spanner Âπ∂ÂèëÊéßÂà∂&quot;"></a></h3>
<h4 id="_3-3-1-ËØª‰∫ãÂä°" tabindex="-1">3.3.1 ËØª‰∫ãÂä° <a class="header-anchor" href="#_3-3-1-ËØª‰∫ãÂä°" aria-label="Permalink to &quot;3.3.1 ËØª‰∫ãÂä°&quot;"></a></h4>
<p>Spanner ÂàóÂá∫‰∫ÜÊîØÊåÅÁöÑÁ±ªÂûãÂíåÁº©Êú∫Âà∂Â¶Ç‰∏ãÔºö</p>
<table tabindex="0">
<thead>
<tr>
<th>Operation Type</th>
<th>Concurrency Control</th>
</tr>
</thead>
<tbody>
<tr>
<td>Read-Write Transcation</td>
<td>Pessimistic</td>
</tr>
<tr>
<td>Read-Only Transcation</td>
<td>lock-free</td>
</tr>
<tr>
<td>Snapshot Read,client-provided timestamp</td>
<td>lock-free</td>
</tr>
<tr>
<td>Snapshot Read,client-provided bound</td>
<td>lock-free</td>
</tr>
</tbody>
</table>
<ol>
<li>‚ÄúRead-Write Transcation‚Äù ÊòØ‰∏ÄÁßçÂÖ∑ÊúâÂø´ÁÖßÈöîÁ¶ªÁöÑÊÄßËÉΩÁöÑ‰∫ãÂä°,ÂøÖÈ°ªÈ¢ÑÂÖàÂ£∞Êòé‰∏∫Ê≤°Êúâ‰ªª‰ΩïÂÜôÊìç‰Ωú,Âπ∂Âú®Á≥ªÁªüÈÄâÊã©ÁöÑÊó∂Èó¥Êà≥‰∏äËØªÂèñÂè™ËØª‰∫ãÂä°ËÄå‰∏çÈîÅÂÆö„ÄÇÂè™ËØª‰∫ãÂä°‰∏≠ÁöÑËØªÊìç‰ΩúÂèØ‰ª•Âú®‰ªª‰ΩïË∂≥Â§üÊúÄÊñ∞ÁöÑ Replica ‰∏äËøõË°å„ÄÇ</li>
<li>‚ÄúSnapshot Read,client-provided timestamp‚Äù ÈÄöËøáÂÆ¢Êà∑Á´ØÂèØ‰ª•‰∏∫Âø´ÁÖßËØªÂèñÊåáÂÆöÊó∂Èó¥Êà≥ÔºåÂÆûÁé∞‰ªª‰ΩïË∂≥Â§üÊúÄÊñ∞ÁöÑ Replica ‰∏äÊâßË°åÊó†ÈîÅÂéÜÂè≤Êï∞ÊçÆËØªÂèñ„ÄÇÂØπ‰∫éÂè™ËØª‰∫ãÂä°ÂíåÂø´ÁÖßËØªÂèñÔºå‰∏ÄÊó¶Êó∂Èó¥Êà≥Ë¢´ÈÄâÂÆöÂ∞±ÂèØËßÜ‰∏∫Êèê‰∫§ÊàêÂäüÔºåÈô§ÈùûËØ•Êó∂Èó¥Êà≥ÁöÑÊï∞ÊçÆÂ∑≤ÁªèË¢´ÂûÉÂúæÊî∂ÈõÜ„ÄÇ</li>
<li>‚ÄúSnapshot Read,client-provided bound‚Äù Â∞±ÊòØ ‚ÄúSnapshot Read,client-provided timestamp‚Äù Âä†‰∏äÊèê‰æõÊâÄÈúÄÊó∂Èó¥Êà≥ËøáÊúüÁöÑ‰∏äÈôêÔºåÂπ∂ËÆ© Spanner ÈÄâÊã©Êó∂Èó¥Êà≥ÂÜÖÁöÑÊï∞ÊçÆÔºåËøõËÄåÈÅøÂÖçÂú®ÈáçËØïÂæ™ÁéØ‰∏≠ÁºìÂÜ≤ÁªìÊûú„ÄÇ</li>
</ol>
<h4 id="_3-3-1-ËØªÂÜô‰∫ãÂä°" tabindex="-1">3.3.1 ËØªÂÜô‰∫ãÂä° <a class="header-anchor" href="#_3-3-1-ËØªÂÜô‰∫ãÂä°" aria-label="Permalink to &quot;3.3.1 ËØªÂÜô‰∫ãÂä°&quot;"></a></h4>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TiDB ‰ΩúËÄÖ‰πã‰∏ÄÁöÑ <a href="https://pingcap.com/zh/blog/Spanner-cap-truetime-transaction" target="_blank" rel="noreferrer">TangLiu ÂØπËØ•ÈÉ®ÂàÜÁªôÂá∫‰∫ÜËß£ËØªÔºåÊú¨‰∫∫ËßâÂæóËæÉ‰∏∫Ê∏ÖÊô∞ÔºåÊïÖÂéüÊñáÂ∫îÁî®</a>Ôºõ<strong>ËôΩÁÑ∂ Spanner Âú®ÂÆûÁé∞ÂÜô‰∫ãÂä°‰∏äÂ§ÑÁêÜ‰æùÊçÆ‰ΩøÁî® Split Êï∞Èáè‰∏çÂêåÂàÜ‰∏∫ 1PC Âíå 2PCÔºå‰ΩÜÊú¨ÊñáÂè™Â±ïÁ§∫ 2PC ÁöÑ‰æãÂ≠êÔºåËØ¶ÊÉÖËØ∑ÈòÖËØªËøô‰Ωç‰ΩúËÄÖÊñáÁ´†</strong>„ÄÇ</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÂÅáËÆæ‰∏Ä‰∏™‰∫ãÂä°ÈúÄË¶ÅÂú® Split 1 ËØªÂèñÊï∞ÊçÆ Row 1ÔºåÂêåÊó∂Â∞ÜÊîπÂä® Row 2ÔºåRow 3 ÂàÜÂà´ÂÜôÂà∞ Split 2ÔºåSplit 3ÔºåÊµÅÁ®ãÂ¶Ç‰∏ãÔºö</p>
<ol>
<li>client ÂºÄÂßã‰∏Ä‰∏™ read-write ‰∫ãÂä°„ÄÇ</li>
<li>client ÈúÄË¶ÅËØªÂèñ Row 1ÔºåÂëäËØâ API Layer Áõ∏ÂÖ≥ËØ∑Ê±Ç„ÄÇ</li>
<li>API Layer ÂèëÁé∞ Row 1 Âú® Split 1„ÄÇ</li>
<li>API Layer Áªô Split 1 ÁöÑ Leader ÂèëÈÄÅ‰∏Ä‰∏™ read request„ÄÇ</li>
<li>Split1 ÁöÑ Leader Â∞ùËØïÂ∞Ü Row 1 Ëé∑Âèñ‰∏Ä‰∏™ read lock„ÄÇÂ¶ÇÊûúËøôË°åÊï∞ÊçÆ‰πãÂâçÊúâ write lockÔºåÂàô‰ºöÊåÅÁª≠Á≠âÂæÖ„ÄÇÂ¶ÇÊûú‰πãÂâçÂ∑≤ÁªèÊúâÂè¶‰∏Ä‰∏™‰∫ãÂä°‰∏ä‰∫Ü‰∏Ä‰∏™ read lockÔºåÂàô‰∏ç‰ºöÁ≠âÂæÖ„ÄÇËá≥‰∫é deadlockÔºåÈááÁî® wound-wait Â§ÑÁêÜÊñπÂºè„ÄÇ</li>
<li>Leader Ëé∑ÂèñÂà∞ Row 1 ÁöÑÊï∞ÊçÆÂπ∂‰∏îËøîÂõû„ÄÇ</li>
<li>Clients ÂºÄÂßãÂèëËµ∑‰∏Ä‰∏™ commit requestÔºåÂåÖÊã¨ Row 2ÔºåRow 3 ÁöÑÊîπÂä®„ÄÇÊâÄÊúâÁöÑË∑üËøô‰∏™‰∫ãÂä°ÂÖ≥ËÅîÁöÑ Split ÈÉΩÂèòÊàêÂèÇ‰∏éËÄÖ participants„ÄÇ</li>
<li>‰∏Ä‰∏™ participant Êàê‰∏∫ÂçèË∞ÉËÄÖ coordinatorÔºåË≠¨Â¶ÇËøô‰∏™ case ÈáåÈù¢ Row 2 Êàê‰∏∫ coordinator„ÄÇCoordinator ÁöÑ‰ΩúÁî®ÊòØÁ°Æ‰øù‰∫ãÂä°Âú®ÊâÄÊúâ participants ‰∏äÈù¢Ë¶Å‰∏çÊèê‰∫§ÊàêÂäüÔºåË¶Å‰∏çÂ§±Ë¥•„ÄÇËøô‰∫õÈÉΩÊòØÂú® participants Âíå coordinator ÂêÑËá™ÁöÑ Split Leader ‰∏äÈù¢ÂÆåÊàêÁöÑ„ÄÇ</li>
<li>Participants ÂºÄÂßãËé∑Âèñ lock
9.1 Split 2 ÂØπ Row 2 Ëé∑Âèñ write lock„ÄÇ
9.2 Split 3 ÂØπ Row 3 Ëé∑Âèñ write lock„ÄÇ
9.3 Split 1 Á°ÆÂÆö‰ªçÁÑ∂ÊåÅÊúâ Row 1 ÁöÑ read lock„ÄÇ
9.4 ÊØè‰∏™ participant ÁöÑ Split Leader Â∞Ü lock Â§çÂà∂Âà∞ÂÖ∂‰ªñ Split ÂâØÊú¨ÔºåËøôÊ†∑Â∞±ËÉΩ‰øùËØÅÂç≥‰ΩøËäÇÁÇπÊåÇ‰∫ÜÔºålock ‰πü‰ªçÁÑ∂ËÉΩË¢´ÊåÅÊúâ„ÄÇ</li>
<li>Â¶ÇÊûúÊâÄÊúâÁöÑ participants ÂëäËØâ coordinator lock Â∑≤ÁªèË¢´ÊåÅÊúâÔºåÈÇ£‰πàÂ∞±ÂèØ‰ª•Êèê‰∫§‰∫ãÂä°‰∫Ü„ÄÇcoordinator ‰ºö‰ΩøÁî®Ëøô‰∏™Êó∂ÂÄôÁöÑÊó∂Èó¥ÁÇπ‰Ωú‰∏∫ËøôÊ¨°‰∫ãÂä°ÁöÑÊèê‰∫§Êó∂Èó¥ÁÇπ„ÄÇ</li>
<li>Â¶ÇÊûúÊüê‰∏Ä‰∏™ participant ÂëäËØâ lock ‰∏çËÉΩË¢´Ëé∑ÂèñÔºå‰∫ãÂä°Â∞±Ë¢´ÂèñÊ∂à</li>
<li>Â¶ÇÊûúÊâÄÊúâ participants Âíå coordinator ÊàêÂäüÁöÑËé∑Âèñ‰∫Ü lockÔºåCoordinator ÂÜ≥ÂÆöÊèê‰∫§ËøôÊ¨°‰∫ãÂä°ÔºåÂπ∂‰ΩøÁî® TrueTime Ëé∑Âèñ‰∏Ä‰∏™ timestamp„ÄÇËøô‰∏™ commit ÂÜ≥ÂÆöÔºå‰ª•Âèä Split 2 Ëá™Â∑±ÁöÑ Row 2 ÁöÑÊï∞ÊçÆÔºåÈÉΩ‰ºöÂ§çÂà∂Âà∞ Split 2 ÁöÑÂ§ßÂ§öÊï∞ËäÇÁÇπ‰∏äÈù¢ÔºåÂ§çÂà∂ÊàêÂäü‰πãÂêéÔºåÂ∞±ÂèØ‰ª•ËÆ§‰∏∫Ëøô‰∏™‰∫ãÂä°Â∑≤ÁªèË¢´Êèê‰∫§„ÄÇ
Coordinator Â∞ÜÁªìÊûúÂëäËØâÂÖ∂‰ªñÁöÑ participantsÔºåÂêÑ‰∏™ participant ÁöÑ Leader Ëá™Â∑±Â∞ÜÊîπÂä®Â§çÂà∂Âà∞ÂÖ∂‰ªñÂâØÊú¨‰∏äÈù¢„ÄÇ</li>
<li>Â¶ÇÊûú‰∫ãÂä°Â∑≤ÁªèÊèê‰∫§Ôºåcoordinator ÂíåÊâÄÊúâÁöÑ participants Â∞± apply ÂÆûÈôÖÁöÑÊîπÂä®„ÄÇ
Coordinator Leader ËøîÂõûÁªô client ËØ¥‰∫ãÂä°Â∑≤ÁªèÊèê‰∫§ÊàêÂäüÔºåÂπ∂‰∏îËøîÂõû‰∫ãÂä°ÁöÑ timestamp„ÄÇÂΩìÁÑ∂‰∏∫‰∫Ü‰øùËØÅÊï∞ÊçÆÁöÑ‰∏ÄËá¥ÊÄßÔºåÈúÄË¶ÅÊúâ commit-wait</li>
</ol>
<h2 id="Âõõ„ÄÅÊÄßËÉΩËÆ∫ËØÅ" tabindex="-1">Âõõ„ÄÅÊÄßËÉΩËÆ∫ËØÅ <a class="header-anchor" href="#Âõõ„ÄÅÊÄßËÉΩËÆ∫ËØÅ" aria-label="Permalink to &quot;Âõõ„ÄÅÊÄßËÉΩËÆ∫ËØÅ&quot;"></a></h2>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>Âü∫ÂáÜÊµãËØïÁéØÂ¢É</strong>Âú®ÂàÜÊó∂Êú∫Âô®‰∏äËøõË°åÔºåÊØè‰∏™ spanserver ËøêË°åÂú® 4GB RAM Âíå 4Ê†∏ ÁöÑÊµãËØïÊú∫ÔºåÂÆ¢Êà∑Á´ØÁã¨Á´ãËøêË°åÊâøÂèóÂéãÂäõ„ÄÇÊØè‰∏™Âå∫ÂüüÂåÖÂê´‰∏Ä‰∏™ spanserver„ÄÇÂÆ¢Êà∑Á´ØÂíåÂå∫ÂüüË¢´ÊîæÁΩÆÂú®‰∏ÄÁªÑÁΩëÁªúË∑ùÁ¶ªÂ∞è‰∫é1msÁöÑÊï∞ÊçÆ‰∏≠ÂøÉ‰∏≠„ÄÇÊµãËØïÊï∞ÊçÆÂ∫ìÁî± 50 ‰∏™ Paxos Group Âíå 2500 ‰∏™ ‚ÄúDirectory‚Äù ÂàõÂª∫ÔºåÊìç‰ΩúÊòØ4KBÁöÑÁã¨Á´ãËØªÂÜôÔºåÊï∞ÊçÆÂÖÖÂàÜÈ¢ÑÁÉ≠ÊÉÖÂÜµ‰∏ã„ÄÇ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1. <strong>Âª∂Êó∂ÊÉÖÂÜµÔºö1 ÂâØÊú¨Êèê‰∫§Á≠âÂæÖÂ§ßÁ∫¶ÊòØ 5ms, Paxos Âª∂ËøüÂ§ßÁ∫¶ÊòØ 9ms</strong>„ÄÇÈöèÁùÄ Replica Êï∞ÈáèÁöÑÂ¢ûÂä†ÔºåÁî±‰∫é Paxos Group Êï∞ÊçÆÂêåÊ≠•Âπ∂Ë°åÊâßË°åÔºåÂõ†Ê≠§Âª∂ËøüÂü∫Êú¨‰øùÊåÅ‰∏çÂèò„ÄÇ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2. **ÂêûÂêêÈáèÊÉÖÂÜµÔºö**ÂÆ¢Êà∑Á´Ø‰ºöÂèëÂá∫Ë∂≥Â§üÂ§öÁöÑÊìç‰ΩúÂØºËá¥ÊúçÂä°Âô® cpu È•±ÂíåÔºåÂø´ÁÖßËØªÂèñÂèØÂú®‰ªª‰ΩïÊúÄÊñ∞ÁöÑ Replica ‰∏äÊâßË°åÔºåÂêûÂêêÈáèÂá†‰πéÈöè Replica ÁöÑÊï∞ÈáèÁ∫øÊÄßÂ¢ûÂä†„ÄÇ‰ΩÜÁõ∏ÂêåÁöÑÂÆûÈ™åÁéØÂ¢ÉÂÜôÂêûÂêêÈáèÈöèÁùÄ Replica Êï∞ÈáèÁöÑÂ¢ûÂä†ÔºåÊØèÊ¨°ÂÜôÊâÄÊâßË°åÁöÑÂ∑•‰ΩúÈáèÁöÑÁ∫øÊÄßÂ¢ûÂä†ÈáèÂ∑≤ÁªèË∂ÖËøá‰∫ÜÂÜôÂêûÂêêÈáèÂ∏¶Êù•ÁöÑÂ•ΩÂ§Ñ„ÄÇ</p>
<figure><img src="./Theory-SpannerÂàÜÂ∏ÉÂºè‰∫ãÂä°/performance01.jpg" alt="performance01" tabindex="0"><figcaption>performance01</figcaption></figure>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3. **Êâ©Â±ïÊÄßÊÉÖÂÜµÔºö**‰∏ãÂõæÂ±ïÁ§∫‰∫Ü‰∏§Èò∂ÊÆµÊèê‰∫§ÂèØ‰ª•Êâ©Â±ïÂà∞ÂêàÁêÜÊï∞ÈáèÁöÑÂèÇ‰∏éËÄÖÔºåÂÆûÈ™å‰∫ÜË∑®3‰∏™Âå∫ÂüüËøêË°åÁöÑÂÆûÈ™åÔºåÊØè‰∏™Âå∫ÂüüÊúâ25 ‰∏™ spanserver„ÄÇ‰ªé Âπ≥ÂùáÂÄº Âíå 99 ÁôæÂàÜ‰ΩçÊï∞Êù•ÁúãÔºåÊâ©Â±ïÂà∞ 50 ÂêçÈÉΩÂêàÁêÜÔºå‰ΩÜÂú® 100 ÂêçÂèÇ‰∏éËÄÖÊó∂Âª∂ËøüÂºÄÂßãÊòæËëó‰∏äÂçá„ÄÇ</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="./Theory-SpannerÂàÜÂ∏ÉÂºè‰∫ãÂä°/performance02.jpg" alt="performance02"></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4. **ÂèØÁî®ÊÄßÊµãËØïÔºö**ÊµãËØï ‚Äúuniverse‚Äù Áî± 5 ‰∏™ Zone ÁªÑÊàêÔºåÊØè‰∏™ ‚ÄúZone‚Äù ÂåÖÂê´ 25 ‰∏™spanserver„ÄÇÊµãËØïÊï∞ÊçÆËá™Âä®Ë¢´ÂàáÂàÜÊàê 1250 ‰∏™ Paxos GroupÔºå100 ‰∏™ÊµãËØïÂÆ¢Êà∑Á´Ø‰ª• 50KËØª/Áßí ÁöÑËÅöÂêàÈÄüÁéáÊåÅÁª≠ÂèëÂá∫ÈùûÂø´ÁÖßËØª„ÄÇÊâÄÊúâÁöÑ leader ÈÉΩÊòéÁ°ÆÂú∞ÊîæÂú® Zone 1„ÄÇÂú®ÊØèÊ¨°ÊµãËØïÁöÑ‰∫îÁßíÈíüÂÜÖÔºå‰∏Ä‰∏™ Zone ÂÜÖÁöÑÊâÄÊúâÊúçÂä°Âô®ÂÖ®ÈÉ®ÂÆïÊú∫Ê®°ÊãüÁÅæÈöæÔºåÂêåÊó∂Èùû leader ÊùÄÊ≠ª‰∫Ü Zone 2Ôºåhard-leader ÊùÄÊ≠ª Zone 1„ÄÇÂÆûÈ™åÁªìÊûú‰∏∫ÊùÄÊ≠ª Zone 2 ÂØπËØªÂêûÂêêÈáèÊ≤°ÊúâÂΩ±ÂìçÔºå‰ΩÜ hard-leader ÊùÄÊ≠ªZ1ÔºåÈúÄË¶ÅÈáçÊñ∞ÈÄâ‰∏æ leader ‰ºöÂΩ±ÂìçÂêûÂêêÈáèÂ§ßÁ∫¶Âú® 3-4%„ÄÇ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Âè¶‰∏ÄÊñπÈù¢ÔºåÁõ¥Êé•ÊùÄÊ≠ª Zone 1 ‰ºö‰Ωø TPS Âá†‰πéÈôçËá≥0„ÄÇPaxos lease Ë¢´ËÆæÁΩÆ‰∏∫10Áßí,ÂΩìÊùÄÊ≠ª Zone ÂêéÔºåÊØè‰∏™ÁßüÁ∫¶Âà∞ÊúüÂêéÁöÑ Paxos Group ‰ºöÈÄâÂá∫Êñ∞ÁöÑ leader„ÄÇÂú® kill Êó∂Èó¥‰πãÂêéÂ§ßÁ∫¶ 10 ÁßíÔºåÊâÄÊúâ Paxos Group ÂùáÊúâ‰∫Ü leaderÔºåÂêûÂêêÈáèÂ∑≤ÁªèÊÅ¢Â§ç„ÄÇÊõ¥Áü≠ÁöÑÁßüËµÅÊó∂Èó¥ÂèØÁº©Áü≠ÂØπÂèØÁî®ÊÄßÁöÑÂΩ±ÂìçÔºå‰ΩÜÂ∞ÜÊõ¥ËÄóÁΩëÁªúÊµÅÈáè„ÄÇ</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="./Theory-SpannerÂàÜÂ∏ÉÂºè‰∫ãÂä°/performance03.jpg" alt="performance03"></p>
<h2 id="‰∫î„ÄÅÊñáÁ´†ÁªìËÆ∫" tabindex="-1">‰∫î„ÄÅÊñáÁ´†ÁªìËÆ∫ <a class="header-anchor" href="#‰∫î„ÄÅÊñáÁ´†ÁªìËÆ∫" aria-label="Permalink to &quot;‰∫î„ÄÅÊñáÁ´†ÁªìËÆ∫&quot;"></a></h2>
<ol>
<li>Spanner ÁªìÂêàÂπ∂Êâ©Â±ï‰∫ÜÊï∞ÊçÆÂ∫ìÁ§æÂå∫„ÄÅÁ≥ªÁªüÁ§æÂå∫ÊÄùÊÉ≥ÔºåÊèê‰æõ‰∫ÜÂçäÂÖ≥Á≥ªÊé•Âè£Ôºå‰∫ãÂä°ÔºåÂü∫‰∫é sql ÁöÑÊü•ËØ¢ËØ≠Ë®ÄÔºåÂèØ‰º∏Áº©ÊÄßÔºåËá™Âä®ÂàÜÁâáÔºåÂÆπÈîôÔºå‰∏ÄËá¥Â§çÂà∂ÔºåÂ§ñÈÉ®‰∏ÄËá¥ÊÄßÔºåÂπøÂüüÂàÜÂ∏ÉÁ≠âÁâπÊÄß„ÄÇ</li>
<li>Spanner ÂÖ≥ÈîÆÂäüËÉΩÂÆûÁé∞‰∫Ü TrueTimeÔºåÂ∑≤ÁªèËØÅÊòéÔºåÂú®Êó∂Èó¥ API ‰∏≠ÂÖ∑‰ΩìÂåñÊó∂ÈíüÊûÑÂª∫ÂàÜÂ∏ÉÂºèÁ≥ªÁªüÊàê‰∏∫ÂèØËÉΩ„ÄÇ</li>
</ol>
<h2 id="ÂÖ≠„ÄÅÂºïÁî®ÊñáÁ´†" tabindex="-1">ÂÖ≠„ÄÅÂºïÁî®ÊñáÁ´† <a class="header-anchor" href="#ÂÖ≠„ÄÅÂºïÁî®ÊñáÁ´†" aria-label="Permalink to &quot;ÂÖ≠„ÄÅÂºïÁî®ÊñáÁ´†&quot;"></a></h2>
<p><a href="http://static.googleusercontent.com/media/research.google.com/zh-CN//archive/spanner-osdi2012.pdf" target="_blank" rel="noreferrer">Paper -- Spanner: Google‚Äôs Globally-Distributed Database</a>
<a href="https://pingcap.com/zh/blog/Spanner-cap-truetime-transaction" target="_blank" rel="noreferrer">TiDB Blog -- Spanner - CAP, TrueTime and Transaction by TangLiu</a></p>
]]></content:encoded>
            <enclosure url="https://askaric.com/Theory-Spanner%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1/SpannerCluster.jpg" length="0" type="image/jpg"/>
        </item>
        <item>
            <title><![CDATA[Why does LSM generated]]></title>
            <link>https://askaric.com/en/work/tidb/TiDB-Principle/Paper Reading/04LSMTree Storage.html</link>
            <guid>https://askaric.com/en/work/tidb/TiDB-Principle/Paper Reading/04LSMTree Storage.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[‰∏Ä„ÄÅËÆ∫ÊñáÊëòË¶Å

1. ÈÄÇÁî®Âú∫ÊôØÔºö LSM-tree ÊòØ‰∏ÄÁßçÂü∫‰∫éÁ£ÅÁõòÁöÑ Data StructureÔºåÊó®Âú®‰∏∫‰∏ÄÊÆµÊó∂Èó¥ÂÜÖÊåÅÁª≠ÊèíÂÖ•„ÄÅÂà†Èô§ÁöÑÊñá‰ª∂Êèê‰æõ‰ΩéÊàêÊú¨Á¥¢ÂºïÔºå‰ªéËÄåËß£ÂÜ≥‰º†Áªü B-tree Âú®ÊåÅÁª≠ÂÜôÂá∫Âú∫ÊôØ‰∏ã]]></description>
            <content:encoded><![CDATA[<h1 id="why-does-lsm-generated" tabindex="-1">Why does LSM generated <a class="header-anchor" href="#why-does-lsm-generated" aria-label="Permalink to &quot;Why does LSM generated&quot;"></a></h1>
<h2 id="‰∏Ä„ÄÅËÆ∫ÊñáÊëòË¶Å" tabindex="-1">‰∏Ä„ÄÅËÆ∫ÊñáÊëòË¶Å <a class="header-anchor" href="#‰∏Ä„ÄÅËÆ∫ÊñáÊëòË¶Å" aria-label="Permalink to &quot;‰∏Ä„ÄÅËÆ∫ÊñáÊëòË¶Å&quot;"></a></h2>
<ol>
<li><strong>ÈÄÇÁî®Âú∫ÊôØÔºö</strong> LSM-tree ÊòØ‰∏ÄÁßçÂü∫‰∫éÁ£ÅÁõòÁöÑ Data StructureÔºåÊó®Âú®‰∏∫‰∏ÄÊÆµÊó∂Èó¥ÂÜÖÊåÅÁª≠ÊèíÂÖ•„ÄÅÂà†Èô§ÁöÑÊñá‰ª∂Êèê‰æõ‰ΩéÊàêÊú¨Á¥¢ÂºïÔºå‰ªéËÄåËß£ÂÜ≥‰º†Áªü B-tree Âú®ÊåÅÁª≠ÂÜôÂá∫Âú∫ÊôØ‰∏ãÔºåÁª¥Êä§Ê¥ªÂøÉ‰∫ãÂä° I/O ÊàêÊú¨ÁøªÂÄçÁöÑÈóÆÈ¢ò„ÄÇÂú®ÊèíÂÖ•ÊØîÊ£ÄÁ¥¢Êõ¥Â∏∏ËßÅÁöÑÂú∫ÊôØ‰∏≠ÔºåLsm-tree Êõ¥‰∏∫ÊúâÁî®„ÄÇÂ¶ÇÔºåÂØπ‰∫éÂéÜÂè≤Ë°®ÂíåÊó•ÂøóÊñá‰ª∂„ÄÇ</li>
<li><strong>Áª¥Êä§ÊñπÂºèÔºö</strong> Lsm-tree ‰ΩøÁî®ÁÆóÊ≥ïÂª∂ËøüÂíåÊâπÈáèÁ¥¢ÂºïÊõ¥ÊîπÔºå‰ª•Á±ªÂΩíÂπ∂ÊéíÂ∫èÁöÑÊñπÂºèÂ∞Ü update ‰ø°ÊÅØÂÜÖÂ≠ò‰º†ÈÄíÂà∞Á£ÅÁõò„ÄÇ</li>
<li><strong>ÊÄßËÉΩÂØπÊØîÔºö</strong> ‰∏é‰º†ÁªüÁöÑbÊ†ëËÆøÈóÆÊñπÊ≥ïÁõ∏ÊØîÔºåËØ•ÁÆóÊ≥ïÂèØ‰ªéÂÜÖÂ≠òÊàñÁ£ÅÁõòËøûÁª≠ËØªÂèñËåÉÂõ¥Êï∞ÊçÆÔºåÂ§ßÂ§ßÂáèÂ∞ë‰∫ÜÁ£ÅÁõòËáÇÁöÑÁßªÂä®Ôºå‰ΩÜÁî±‰∫éÁÆóÊ≥ïÊú¨Ë∫´ËØªÊîæÂ§ßÔºåÁ¥¢ÂºïÊü•ËØ¢ÂèØËÉΩ‰ºö‰∏ßÂ§±‰∏ÄÂÆö I/O ÊïàÁéá„ÄÇ</li>
</ol>
<h2 id="‰∫å„ÄÅËÆ∫ÊñáÁÆÄ‰ªã" tabindex="-1">‰∫å„ÄÅËÆ∫ÊñáÁÆÄ‰ªã <a class="header-anchor" href="#‰∫å„ÄÅËÆ∫ÊñáÁÆÄ‰ªã" aria-label="Permalink to &quot;‰∫å„ÄÅËÆ∫ÊñáÁÆÄ‰ªã&quot;"></a></h2>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÂïÜ‰∏ö‰∏çÊñ≠Â∫îÁî®Êù°‰ª∂‰∏ãÔºå‰º†Áªü‰∫ãÂä°Êó•ÂøóÂÖ≥Ê≥®Â¥©Ê∫ÉÂõûÂ§çÔºå‰ΩÜÈÄöÂ∏∏Êèê‰æõÊó•ÂøóÊ£ÄÁ¥¢ÈúÄÊ±Ç‰∏çÊñ≠Â¢ûÂä†„ÄÇÈÄöËøáÊâ©ÂÖÖÁâ©ÁêÜÂÜÖÂ≠òÊñπÂºè‰∏çÊòØÈïø‰πÖ‰πãËÆ°ÔºåÂ¶ÇÊûúÂú®ÂéÜÂè≤ËÆ∞ÂΩïË°®‰∏äÊèê‰æõÁ¥¢ÂºïÊü•ËØ¢ÊîØÊåÅÂ∞ÜÊûÅÂÖ∑‰ª∑ÂÄº„ÄÇ<strong>LSM-Tree ÈÄöËøáÁÆóÊ≥ïÂÆûÁé∞‰∫ÜÁ¥¢Âºï node È°∫Â∫è‰∏é key È°∫Â∫è Êó†ÂÖ≥ÁöÑÔºåÈ´òÈ¢ëÊèíÂÖ•Êó∂ÁöÑÊü•ËØ¢ÊïàÁéá‰ºòÂåñ„ÄÇ</strong> Lsm-tree ËÆ∫ÊñáÁÆÄ‰ªãÈÉ®ÂàÜ‰ΩøÁî® <strong>‚Äú5 ÂàÜÈíüÂéüÂàô‚Äù„ÄÅ‚ÄúTPC-A benchmark ÂÆûÈ™å‚Äù</strong> ÂàÜÂà´ÂºïÂá∫ËÆ∫ÊñáÁöÑËÆ∫ËØÅÊ†áÂáÜ„ÄÅÂíåËÆ∫ËØÅÊñπÂºè„ÄÇ<strong>Êú¨‰∫∫Êí∞ÂÜôÊú¨ÊñáÁöÑÁõÆÁöÑ‰∏∫Â∏ÆÂä©ËØªËÄÖÊõ¥Â•ΩÁêÜËß£ Lsm-tree ÂéüÊñá</strong></p>
<ol>
<li><a href="https://www.hpl.hp.com/techreports/tandem/TR-86.1.pdf" target="_blank" rel="noreferrer">The 5 Minute Rule for Trading Memory for Disc Accesses and the 5 Byte Rule for Trading Memory for CPU Time</a> ËÆ∫ÊñáÂèëË°®‰∫é 1986 Âπ¥ÔºåÊñá‰∏≠ÁªôÂá∫‰∫Ü‰∏ÄÂ•óÂÖ¨ÂºèÊµãÁÆó‰ΩøÁî®Á£ÅÁõò‰ª£‰ª∑‰∏éÂÜÖÂ≠ò‰ª£‰ª∑ÊµãÁÆóÂÖ¨Âºè„ÄÇ</li>
<li>‚ÄúTPC-A benchmark ÂÆûÈ™å‚Äù ÊòØËëóÂêçÁöÑÂü∫ÂáÜÊµãËØïÂÆûÈ™åÔºåÂê´ÊúâÂ§ßÈáèÂéÜÂè≤ËÆ∞ÂΩïÊü•ËØ¢Âú∫ÊôØ„ÄÇ</li>
</ol>
<h2 id="‰∏â„ÄÅÂü∫Êú¨ÊÄùÊÉ≥" tabindex="-1">‰∏â„ÄÅÂü∫Êú¨ÊÄùÊÉ≥ <a class="header-anchor" href="#‰∏â„ÄÅÂü∫Êú¨ÊÄùÊÉ≥" aria-label="Permalink to &quot;‰∏â„ÄÅÂü∫Êú¨ÊÄùÊÉ≥&quot;"></a></h2>
<h3 id="_3-1-lsm-tree-‰∏§ÈáçË¶ÅÁªÑ‰ª∂" tabindex="-1">3.1 Lsm-tree ‰∏§ÈáçË¶ÅÁªÑ‰ª∂ <a class="header-anchor" href="#_3-1-lsm-tree-‰∏§ÈáçË¶ÅÁªÑ‰ª∂" aria-label="Permalink to &quot;3.1 Lsm-tree ‰∏§ÈáçË¶ÅÁªÑ‰ª∂&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Lsm-tree Áî± Disk tree Âíå Memory tree ‰∏§ÈÉ®ÂàÜÁªÑÊàêÔºåÂéÜÂè≤Êï∞ÊçÆÂ≠òÊîæÂú® Disk tree ‰∏≠„ÄÇÂΩìÊï∞ÊçÆËøõÂÖ• Lsm-tree ÁöÑÊó∂ÂÖàÂÜôÂ∫èÂàóÂåñÊó•Âøó‰ª•Áî®‰∫éÂ¥©Ê∫ÉÊÅ¢Â§çÔºåÈöèÂêéÊï∞ÊçÆËøõÂÖ•ÂÜÖÂ≠ò C0 Â±Ç„ÄÇÊØèÊ¨°Ê£ÄÁ¥¢Êï∞ÊçÆÈÉΩÈúÄÂÖàÊü• C0 Â±Ç„ÄÅÂÜçÊü• C1 Â±ÇÔºåËØªÊîæÂ§ßÂª∂Êó∂Âõ†Ê≠§‰∫ßÁîü„ÄÇ</p>
<figure><img src="./Theory-LSMTreeÂ≠òÂÇ®/two-components.jpg" alt="two-components" tabindex="0"><figcaption>two-components</figcaption></figure>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Êï∞ÊçÆÂú® C0 Â±ÇÊó∂Êó† IO Ê∂àËÄóÔºå‰ΩÜÂèóÁªèÊµéÂõ†Á¥†ÔºàÂÜÖÂ≠òÊØîÁ£ÅÁõòË¥µÔºâÈôêÂà∂ÔºåÂΩì C0 Â±ÇÊï∞ÊçÆËææÂà∞ÂÆπÈáèÈôêÂà∂‰ºöÊúâËøõÁ®ãÂ∞ÜÊï∞ÊçÆÂà∑Âà∞Á£ÅÁõò„ÄÇ‰∏é B-tree ÊØîËæÉÔºå Lsm-tree Âú®È°∫Â∫èÁ£ÅÁõòÊñπÂêëÊúâÊâÄ‰ºòÂåñÔºåÊ†πËäÇÁÇπ‰∏ãÂêÑÂ±ÇÂ≠êËäÇÁÇπÂùáÂ∑≤ËøûÁª≠Á£ÅÁõòÊï∞ÊçÆÈ°µÁöÑÂΩ¢ÂºèÂ≠òÂÇ®ÔºåÊèêÈ´òÁ£ÅÁõòËáÇ‰ΩøÁî®ÊïàÁéá„ÄÇÊØèÂ±ÇÊúâÂ§öËäÇÁÇπÂíåÊúâÂçïËäÇÁÇπÁöÑÂå∫Âà´ÁöÑÂéüÂõ†ÊòØÔºåÂ§öÂ≠êËäÇÁÇπÁî®‰∫éÊúâÂà©‰∫éÂ§ßËåÉÂõ¥Êï∞ÊçÆÊâ´ÊèèÔºåÂçïÂ≠êËäÇÁÇπÁî®‰∫éÊúÄÂ∞èÂåñÁºìÂ≠ò„ÄÇ</p>
<p><strong>ÂùóÂ§ßËá¥ÂàÜ‰∏§Á±ªÔºö</strong></p>
<ol>
<li><strong>emptying blockÔºö</strong> Ë¢´ÂêàÂπ∂ÂâçÔºå‰∏çÊñ≠ÂáèÂ∞ëÊï∞ÊçÆÁöÑÂùóÔºåÁß∞‰∏∫ÊéèÁ©∫ÂùóÔºõ</li>
<li><strong>filling blockÔºö</strong> ÂΩìÁ©∫ÂùóÂ§ßÂ∞èÂ¢ûÈïøÂà∞ÈòàÂÄºÔºåË¢´ÈáçÂÜôÂà∞ C1 Â±ÇÊñ∞ÂùóÔºå‰∏çÊñ≠Â¢ûÂä†Êï∞ÊçÆÁöÑÂùóÔºåÁß∞‰∏∫Â°´ÂÖÖÂùóÔºõ</li>
</ol>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÊªöÂä®ËêΩÁõòÂåÖÂê´‰∏ÄÁ≥ªÂàóÊ≠•È™§ÔºåÊØèÊ¨°‰ªé C1 Â±Ç<strong>Â§öÂùóÔºàÁ£ÅÁõòÈ°µÔºâËØª</strong>ËØªÂèñÂ§ö‰∏™Âè∂Â≠êÁªìÁÇπÂà∞ÂÜÖÂ≠òÔºåÂ∞Ü C0 Â±ÇÊï∞ÊçÆÂú®ÂÜÖÂ≠ò‰∏≠‰∏é C1 Â±ÇÊï∞ÊçÆÂêàÂπ∂Ôºå‰ªéËÄåÂáèÂ∞ë C0 Â±ÇÁ©∫Èó¥Âç†Áî®„ÄÇÂΩì ‚Äúfilling block‚Äù Ë¢´ÂÜôÊª°ÂêéÔºå‰ºöË¢´ÈáçÂÜôÂà∞Êñ∞ÁöÑÁ£ÅÁõòÁ©∫Èó≤Âå∫„ÄÇÊñ∞ÂêàÂπ∂ÁöÑËäÇÁÇπÂú®Áà∂ËäÇÁÇπÁöÑÂè≥‰æß„ÄÇÂΩìÊñ∞ËäÇÁÇπÂÆπÈáèÂ¢ûÈïøÂà∞ÈòàÂÄºÊó∂Ôºå‰ºöÁªßÁª≠Âêë‰∏ãÊªöÂä®‰∏äËø∞ÂêàÂπ∂ËøáÁ®ã„ÄÇ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Êóß block Êï∞ÊçÆË¢´ÂêàÂπ∂Âà∞Êñ∞ block Âêé‰∏ç‰ºöÁ´ãÂç≥Ë¢´ÈáçÂÜôÔºåËÄåÊòØ‰øùÁïôÁî®‰∫éÂ¥©Ê∫ÉÊÅ¢Â§ç„ÄÇÂêåÊó∂ÔºåË¢´Êõ¥Êñ∞Âè∂Â≠êÁªìÁÇπÁöÑÁà∂ËäÇÁÇπ‰πü‰ºöÁºìÂ≠òÂú®ÂÜÖÂ≠ò‰∏≠‰∏ÄÊÆµÊó∂Èó¥Ôºå‰ª•‰∏∫ÊúÄÂ∞èÂåñ I/O ÂèäÊõ¥Êñ∞Â≠êËäÇÁÇπ‰ΩçÁΩÆ‰ø°ÊÅØÔºåÁõ¥Ëá≥Êóß block Êó†ÊïàÊó∂Êâç‰ºöË¢´Âà†Èô§„ÄÇ</p>
<figure><img src="./Theory-LSMTreeÂ≠òÂÇ®/two-conments-tree.jpg" alt="two-conments-tree" tabindex="0"><figcaption>two-conments-tree</figcaption></figure>
<h4 id="_3-1-1-ÁªÑ‰ª∂Â¢ûÈïøÁªÜËäÇ" tabindex="-1">3.1.1 ÁªÑ‰ª∂Â¢ûÈïøÁªÜËäÇ <a class="header-anchor" href="#_3-1-1-ÁªÑ‰ª∂Â¢ûÈïøÁªÜËäÇ" aria-label="Permalink to &quot;3.1.1 ÁªÑ‰ª∂Â¢ûÈïøÁªÜËäÇ&quot;"></a></h4>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Lsm-tree Â¢ûÈïøÂàùÊúü‰ºöÂÖàÂ∞ÜËÆ∞ÂΩïÊèíÂÖ•ÂÜÖÂ≠ò‰∏≠ÁöÑ C0 ÁªÑ‰ª∂‰∏≠ÔºåÂõ†‰∏∫‰∏çÈúÄË¶ÅËÄÉËôëËêΩÁõòÂêéÔºåÊ£ÄÁ¥¢Êï∞ÊçÆÊçüÂ§± CPU ÊïàÁéáÔºåÊâÄ‰ª• C0 ËäÇÁÇπÁöÑÂÆπÈáèÂèØ‰ª•ÊòØ‰ªªÊÑèÁöÑ„ÄÇÂΩì C0 Êï∞ÊçÆÂÆπÈáèÂ¢ûÈïøÂà∞ÈòàÂÄºÊó∂Ôºå‰ª• batch ÊñπÂºèÈáçÊûÑÂà∞ C1 ÂêéÔºåÂà†Èô§Êéâ C0 ‰∏≠Êï∞ÊçÆ„ÄÇÈöè‰ªéÂ∑¶Âà∞Âè≥ÊîæÁΩÆÂú® C1 ÁöÑÈ°µÂùó‰∏çÊñ≠Â¢ûÂä†ÔºåÂΩì C1 ÁªÑ‰ª∂Êï∞ÊçÆÂ¢ûÈïøËææÂà∞ÈòàÂÄºÂêéÔºåË¢´ÂÜôÂÖ•Âà∞Á£ÅÁõò„ÄÇ
<strong>C1 Â±ÇËäÇÁÇπ‰ø°ÊÅØÊõ¥Êñ∞Âà∞Á£ÅÁõòÁöÑÊÉÖÂÜµ</strong></p>
<ol>
<li>Êüê‰∏™ÂåÖÂê´Â§öÁ£ÅÁõòÈ°µÁöÑÂùóË¢´ÂÜôÊª°Ôºõ</li>
<li>Ë∑üËäÇÁÇπÂàÜË£ÇÂ¢ûÂä†‰∫Ü C1 Ê†ëÊ∑±Â∫¶Ôºõ</li>
<li>ÊâßË°å chekckpoint Êó∂Ôºõ</li>
</ol>
<h3 id="_3-2-lsm-tree-ÊÄßËÉΩ‰∏éÂ§öÁªÑ‰ª∂" tabindex="-1">3.2 Lsm-tree ÊÄßËÉΩ‰∏éÂ§öÁªÑ‰ª∂ <a class="header-anchor" href="#_3-2-lsm-tree-ÊÄßËÉΩ‰∏éÂ§öÁªÑ‰ª∂" aria-label="Permalink to &quot;3.2 Lsm-tree ÊÄßËÉΩ‰∏éÂ§öÁªÑ‰ª∂&quot;"></a></h3>
<h3 id="_3-3-lsm-tree-Âπ∂Âèë‰∏éÂ¥©Ê∫ÉÊÅ¢Â§ç" tabindex="-1">3.3 Lsm-tree Âπ∂Âèë‰∏éÂ¥©Ê∫ÉÊÅ¢Â§ç <a class="header-anchor" href="#_3-3-lsm-tree-Âπ∂Âèë‰∏éÂ¥©Ê∫ÉÊÅ¢Â§ç" aria-label="Permalink to &quot;3.3 Lsm-tree Âπ∂Âèë‰∏éÂ¥©Ê∫ÉÊÅ¢Â§ç&quot;"></a></h3>
<h3 id="_3-4-Á£ÅÁõòËÆøÈóÆÁÆóÊ≥ïÊØîËæÉ" tabindex="-1">3.4 Á£ÅÁõòËÆøÈóÆÁÆóÊ≥ïÊØîËæÉ <a class="header-anchor" href="#_3-4-Á£ÅÁõòËÆøÈóÆÁÆóÊ≥ïÊØîËæÉ" aria-label="Permalink to &quot;3.4 Á£ÅÁõòËÆøÈóÆÁÆóÊ≥ïÊØîËæÉ&quot;"></a></h3>
<h2 id="Âõõ„ÄÅÊñáÁ´†ÁªìËÆ∫" tabindex="-1">Âõõ„ÄÅÊñáÁ´†ÁªìËÆ∫ <a class="header-anchor" href="#Âõõ„ÄÅÊñáÁ´†ÁªìËÆ∫" aria-label="Permalink to &quot;Âõõ„ÄÅÊñáÁ´†ÁªìËÆ∫&quot;"></a></h2>
<h2 id="‰∫î„ÄÅÂºïÁî®ÊñáÁ´†" tabindex="-1">‰∫î„ÄÅÂºïÁî®ÊñáÁ´† <a class="header-anchor" href="#‰∫î„ÄÅÂºïÁî®ÊñáÁ´†" aria-label="Permalink to &quot;‰∫î„ÄÅÂºïÁî®ÊñáÁ´†&quot;"></a></h2>
<p><a href="https://www.hpl.hp.com/techreports/tandem/TR-86.1.pdf" target="_blank" rel="noreferrer">Paper -- The 5 Minute Rule for Trading Memory for Disc Accesses and the 5 Byte Rule for Trading Memory for CPU Time</a>
<a href="http://paperhub.s3.amazonaws.com/18e91eb4db2114a06ea614f0384f2784.pdf" target="_blank" rel="noreferrer">Paper -- The Log-Structured Merge-Tree (LSM-Tree)</a>
<a href="https://blog.csdn.net/historyasamirror/article/details/5638106" target="_blank" rel="noreferrer">CSDN Blog -- The 5 minute rule: ‰∏ÄÈÉ®paperÁöÑËøûÁª≠Ââß by historyasamirror</a></p>
]]></content:encoded>
            <enclosure url="https://askaric.com/Theory-LSMTree%E5%AD%98%E5%82%A8/two-components.jpg" length="0" type="image/jpg"/>
        </item>
        <item>
            <title><![CDATA[Database Isolation]]></title>
            <link>https://askaric.com/en/work/tidb/TiDB-Principle/Paper Reading/05Database Isolation.html</link>
            <guid>https://askaric.com/en/work/tidb/TiDB-Principle/Paper Reading/05Database Isolation.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[# Database Isolation

Êó∂Èó¥Ôºö2021-01-14

## ÈöîÁ¶ªÁ∫ßÂà´ÁêÜËÆ∫ÁÆÄ‰ªã

|‰∫ãÂä°ÈöîÁ¶ªÁ∫ßÂà´ | ËÑèËØª | ‰∏çÂèØÈáçÂ§çËØª | ÂπªËØª | Â§áÊ≥® |
| ]]></description>
            <content:encoded><![CDATA[<h1 id="database-isolation" tabindex="-1">Database Isolation <a class="header-anchor" href="#database-isolation" aria-label="Permalink to &quot;Database Isolation&quot;"></a></h1>
<p>Êó∂Èó¥Ôºö2021-01-14</p>
<h2 id="ÈöîÁ¶ªÁ∫ßÂà´ÁêÜËÆ∫ÁÆÄ‰ªã" tabindex="-1">ÈöîÁ¶ªÁ∫ßÂà´ÁêÜËÆ∫ÁÆÄ‰ªã <a class="header-anchor" href="#ÈöîÁ¶ªÁ∫ßÂà´ÁêÜËÆ∫ÁÆÄ‰ªã" aria-label="Permalink to &quot;ÈöîÁ¶ªÁ∫ßÂà´ÁêÜËÆ∫ÁÆÄ‰ªã&quot;"></a></h2>
<table tabindex="0">
<thead>
<tr>
<th>‰∫ãÂä°ÈöîÁ¶ªÁ∫ßÂà´</th>
<th>ËÑèËØª</th>
<th>‰∏çÂèØÈáçÂ§çËØª</th>
<th>ÂπªËØª</th>
<th>Â§áÊ≥®</th>
</tr>
</thead>
<tbody>
<tr>
<td>ËØªÊú™Êèê‰∫§Ôºàread-uncommittedÔºâ</td>
<td>ÊòØ</td>
<td>ÊòØ</td>
<td>ÊòØ</td>
<td>read-uncommitted Âç≥‰ºöÂá∫Áé∞ËÑèËØªÔºå‰πü‰ºöÂá∫Áé∞‰∏çÂèØÈáçÂ§çËØª„ÄÅÂπªËØª;</td>
</tr>
<tr>
<td>‰∏çÂèØÈáçÂ§çËØªÔºàread-committedÔºâ</td>
<td>Âê¶</td>
<td>ÊòØ</td>
<td>ÊòØ</td>
<td>read-committed ‰ºöÂá∫Áé∞ÂπªËØªÂíå‰∏çÂèØÈáçÂ§çËØª;</td>
</tr>
<tr>
<td>ÂèØÈáçÂ§çËØªÔºàrepeatable-readÔºâ</td>
<td>Âê¶</td>
<td>Âê¶</td>
<td>ÊòØ</td>
<td>repeatable-read ‰∏ç‰ºöÂá∫Áé∞‰∏çÂèØÈáçÂ§çËØªÔºå‰ºöÂá∫Áé∞ÂπªËØª;</td>
</tr>
<tr>
<td>‰∏≤Ë°åÂåñÔºàserializableÔºâ</td>
<td>Âê¶</td>
<td>Âê¶</td>
<td>Âê¶</td>
<td>serializable ‰ª•‰∏ä‰∏âËÄÖÂùá‰∏ç‰ºöÂá∫Áé∞;</td>
</tr>
</tbody>
</table>
<p>Read UncommittedÔºàËØªÂèñÊú™Êèê‰∫§ÂÜÖÂÆπÔºâ
Âú®ËØ•ÈöîÁ¶ªÁ∫ßÂà´ÔºåÊâÄÊúâ‰∫ãÂä°ÈÉΩÂèØ‰ª•ÁúãÂà∞ÂÖ∂‰ªñÊú™Êèê‰∫§‰∫ãÂä°ÁöÑÊâßË°åÁªìÊûú„ÄÇÊú¨ÈöîÁ¶ªÁ∫ßÂà´ÂæàÂ∞ëÁî®‰∫éÂÆûÈôÖÂ∫îÁî®ÔºåÂõ†‰∏∫ÂÆÉÁöÑÊÄßËÉΩ‰πü‰∏çÊØîÂÖ∂‰ªñÁ∫ßÂà´Â•ΩÂ§öÂ∞ë„ÄÇËØªÂèñÊú™Êèê‰∫§ÁöÑÊï∞ÊçÆÔºå‰πüË¢´Áß∞‰πã‰∏∫ËÑèËØªÔºàDirty ReadÔºâ„ÄÇ</p>
<p>Read CommittedÔºàËØªÂèñÊèê‰∫§ÂÜÖÂÆπÔºâ
ËøôÊòØÂ§ßÂ§öÊï∞Êï∞ÊçÆÂ∫ìÁ≥ªÁªüÁöÑÈªòËÆ§ÈöîÁ¶ªÁ∫ßÂà´Ôºà‰ΩÜ‰∏çÊòØMySQLÈªòËÆ§ÁöÑÔºâ„ÄÇÂÆÉÊª°Ë∂≥‰∫ÜÈöîÁ¶ªÁöÑÁÆÄÂçïÂÆö‰πâÔºö‰∏Ä‰∏™‰∫ãÂä°Âè™ËÉΩÁúãËßÅÂ∑≤ÁªèÊèê‰∫§‰∫ãÂä°ÊâÄÂÅöÁöÑÊîπÂèò„ÄÇËøôÁßçÈöîÁ¶ªÁ∫ßÂà´ ‰πüÊîØÊåÅÊâÄË∞ìÁöÑ‰∏çÂèØÈáçÂ§çËØªÔºàNonrepeatable ReadÔºâÔºåÂõ†‰∏∫Âêå‰∏Ä‰∫ãÂä°ÁöÑÂÖ∂‰ªñÂÆû‰æãÂú®ËØ•ÂÆû‰æãÂ§ÑÁêÜÂÖ∂Èó¥ÂèØËÉΩ‰ºöÊúâÊñ∞ÁöÑcommitÔºåÊâÄ‰ª•Âêå‰∏ÄselectÂèØËÉΩËøîÂõû‰∏çÂêåÁªìÊûú„ÄÇ</p>
<p>Repeatable ReadÔºàÂèØÈáçËØªÔºâ
ËøôÊòØMySQLÁöÑÈªòËÆ§‰∫ãÂä°ÈöîÁ¶ªÁ∫ßÂà´ÔºåÂÆÉÁ°Æ‰øùÂêå‰∏Ä‰∫ãÂä°ÁöÑÂ§ö‰∏™ÂÆû‰æãÂú®Âπ∂ÂèëËØªÂèñÊï∞ÊçÆÊó∂Ôºå‰ºöÁúãÂà∞ÂêåÊ†∑ÁöÑÊï∞ÊçÆË°å„ÄÇ‰∏çËøáÁêÜËÆ∫‰∏äÔºåËøô‰ºöÂØºËá¥Âè¶‰∏Ä‰∏™Ê£òÊâãÁöÑÈóÆÈ¢òÔºöÂπªËØª ÔºàPhantom ReadÔºâ„ÄÇÁÆÄÂçïÁöÑËØ¥ÔºåÂπªËØªÊåáÂΩìÁî®Êà∑ËØªÂèñÊüê‰∏ÄËåÉÂõ¥ÁöÑÊï∞ÊçÆË°åÊó∂ÔºåÂè¶‰∏Ä‰∏™‰∫ãÂä°ÂèàÂú®ËØ•ËåÉÂõ¥ÂÜÖÊèíÂÖ•‰∫ÜÊñ∞Ë°åÔºåÂΩìÁî®Êà∑ÂÜçËØªÂèñËØ•ËåÉÂõ¥ÁöÑÊï∞ÊçÆË°åÊó∂Ôºå‰ºöÂèëÁé∞ÊúâÊñ∞ÁöÑ‚ÄúÂπªÂΩ±‚Äù Ë°å„ÄÇInnoDBÂíåFalconÂ≠òÂÇ®ÂºïÊìéÈÄöËøáÂ§öÁâàÊú¨Âπ∂ÂèëÊéßÂà∂ÔºàMVCCÔºåMultiversion Concurrency ControlÔºâÊú∫Âà∂Ëß£ÂÜ≥‰∫ÜËØ•ÈóÆÈ¢ò„ÄÇ</p>
<p>SerializableÔºàÂ∫èÂàóÂåñÔºâ
ËøôÊòØÊúÄÈ´òÁöÑÈöîÁ¶ªÁ∫ßÂà´ÔºåÂÆÉÈÄöËøáÂº∫Âà∂‰∫ãÂä°ÊéíÂ∫èÔºå‰Ωø‰πã‰∏çÂèØËÉΩÁõ∏‰∫íÂÜ≤Á™ÅÔºå‰ªéËÄåËß£ÂÜ≥ÂπªËØªÈóÆÈ¢ò„ÄÇÁÆÄË®Ä‰πãÔºåÂÆÉÊòØÂú®ÊØè‰∏™ËØªÁöÑÊï∞ÊçÆË°å‰∏äÂä†‰∏äÂÖ±‰∫´ÈîÅ„ÄÇÂú®Ëøô‰∏™Á∫ßÂà´ÔºåÂèØËÉΩÂØºËá¥Â§ßÈáèÁöÑË∂ÖÊó∂Áé∞Ë±°ÂíåÈîÅÁ´û‰∫â„ÄÇ</p>
<p>Áî±MVCCÂÆûÁé∞ÁöÑÂèØÈáçÂ§çËØª</p>
<ul>
<li>
<p>Âø´ÁÖßËØªÔºö</p>
</li>
<li>
<p>ÂΩìÂâçËØªÔºö</p>
</li>
</ul>
<h2 id="postgresql‰∫ãÂä°ÈöîÁ¶ªÁ∫ßÂà´ÂÆûÈ™å" tabindex="-1">PostgreSQL‰∫ãÂä°ÈöîÁ¶ªÁ∫ßÂà´ÂÆûÈ™å <a class="header-anchor" href="#postgresql‰∫ãÂä°ÈöîÁ¶ªÁ∫ßÂà´ÂÆûÈ™å" aria-label="Permalink to &quot;PostgreSQL‰∫ãÂä°ÈöîÁ¶ªÁ∫ßÂà´ÂÆûÈ™å&quot;"></a></h2>
<p>Êú¨Ê¨°ÂÆûÈ™åÈááÁî®postgreSQL</p>
<ul>
<li>ÊûÑÈÄ†ÂÆûÈ™åÊï∞ÊçÆÈõÜ</li>
</ul>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># session 1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">postgres</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"># create table jan_isolation_test(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">id</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> int</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> primary</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> key,name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,age</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># session 1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">postgres</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"># insert into jan_isolation_test values (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">1,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">'jan_1'</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,21</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">),(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">2,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">'jan_2'</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,22</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">);</span></span></code></pre>
</div><h4 id="read-uncommittedËØªÂ∑≤ÁªèÊèê‰∫§caseÂÆûÈ™å" tabindex="-1">READ-UNCOMMITTEDËØªÂ∑≤ÁªèÊèê‰∫§CASEÂÆûÈ™å <a class="header-anchor" href="#read-uncommittedËØªÂ∑≤ÁªèÊèê‰∫§caseÂÆûÈ™å" aria-label="Permalink to &quot;READ-UNCOMMITTEDËØªÂ∑≤ÁªèÊèê‰∫§CASEÂÆûÈ™å&quot;"></a></h4>
<h4 id="read-committedËØªÂ∑≤ÁªèÊèê‰∫§caseÂÆûÈ™å" tabindex="-1">READ-COMMITTEDËØªÂ∑≤ÁªèÊèê‰∫§CASEÂÆûÈ™å <a class="header-anchor" href="#read-committedËØªÂ∑≤ÁªèÊèê‰∫§caseÂÆûÈ™å" aria-label="Permalink to &quot;READ-COMMITTEDËØªÂ∑≤ÁªèÊèê‰∫§CASEÂÆûÈ™å&quot;"></a></h4>
<p>Êõ¥Êîπ‰∏§‰∏™sessionÁöÑÈöîÁ¶ªÁ∫ßÂà´</p>
<ul>
<li>ËØªÂ∑≤Êèê‰∫§Âá∫Áé∞ÂπªËØª<br>
session 1 Âú®Âêå‰∏Ä‰∏™‰∫ãÂä°ÊúüÈó¥ÁöÑ‰∏§Ê¨°Êü•ËØ¢ÔºåÂõ†‰∏∫ session 2 Âú®Âè¶‰∏Ä‰∏™Â∑≤Êèê‰∫§‰∫ãÂä°‰∏≠ËøõË°åÁöÑ insert Âíå delete Êìç‰ΩúÔºåËÄåÂâçÂêé‰∏âÊ¨°Êü•Âá∫‰∏çÂêåÁöÑÁªìÊûúÔºåÂõ†Ê≠§‰∫ßÁîüÂπªËØª„ÄÇ</li>
</ul>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# set default_transaction_isolation='READ COMMITTED';</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# show transaction_isolation;</span></span>
<span class="line"><span> transaction_isolation </span></span>
<span class="line"><span>-----------------------</span></span>
<span class="line"><span> read committed</span></span>
<span class="line"><span>(1 row)</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 2</span></span>
<span class="line"><span>postgres=# set default_transaction_isolation='READ COMMITTED';</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 2</span></span>
<span class="line"><span>postgres=# show transaction_isolation;</span></span>
<span class="line"><span> transaction_isolation </span></span>
<span class="line"><span>-----------------------</span></span>
<span class="line"><span> read committed</span></span>
<span class="line"><span>(1 row)</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# begin;</span></span>
<span class="line"><span>BEGIN</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# select * from jan_isolation_test;</span></span>
<span class="line"><span> id | name  | age </span></span>
<span class="line"><span>----+-------+-----</span></span>
<span class="line"><span>  1 | jan_1 |  22</span></span>
<span class="line"><span>  2 | jan_2 |  23</span></span>
<span class="line"><span>(2 rows)</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 2</span></span>
<span class="line"><span>postgres=#  begin;</span></span>
<span class="line"><span>BEGIN</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# select * from jan_isolation_test;</span></span>
<span class="line"><span> id | name  | age </span></span>
<span class="line"><span>----+-------+-----</span></span>
<span class="line"><span>  1 | jan_1 |  22</span></span>
<span class="line"><span>  2 | jan_2 |  23</span></span>
<span class="line"><span>(2 rows)</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# update jan_isolation_test set age=55;</span></span>
<span class="line"><span>UPDATE 2</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# select * from jan_isolation_test;</span></span>
<span class="line"><span> id | name  | age </span></span>
<span class="line"><span>----+-------+-----</span></span>
<span class="line"><span>  1 | jan_1 |  55</span></span>
<span class="line"><span>  2 | jan_2 |  55</span></span>
<span class="line"><span>(2 rows)</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 2</span></span>
<span class="line"><span>postgres=# select * from jan_isolation_test;</span></span>
<span class="line"><span> id | name  | age </span></span>
<span class="line"><span>----+-------+-----</span></span>
<span class="line"><span>  1 | jan_1 |  22</span></span>
<span class="line"><span>  2 | jan_2 |  23</span></span>
<span class="line"><span>(2 rows)</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 2</span></span>
<span class="line"><span>postgres=# insert into jan_isolation_test values(3,'jan_3',23);</span></span>
<span class="line"><span>INSERT 0 1</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 2</span></span>
<span class="line"><span>postgres=# select * from jan_isolation_test;</span></span>
<span class="line"><span> id | name  | age </span></span>
<span class="line"><span>----+-------+-----</span></span>
<span class="line"><span>  1 | jan_1 |  55</span></span>
<span class="line"><span>  2 | jan_2 |  55</span></span>
<span class="line"><span>  3 | jan_3 |  23</span></span>
<span class="line"><span>(3 rows)</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# select * from jan_isolation_test;</span></span>
<span class="line"><span> id | name  | age </span></span>
<span class="line"><span>----+-------+-----</span></span>
<span class="line"><span>  1 | jan_1 |  55</span></span>
<span class="line"><span>  2 | jan_2 |  55</span></span>
<span class="line"><span>(2 rows)</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 2</span></span>
<span class="line"><span>postgres=# commit;</span></span>
<span class="line"><span>COMMIT</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# select * from jan_isolation_test;</span></span>
<span class="line"><span> id | name  | age </span></span>
<span class="line"><span>----+-------+-----</span></span>
<span class="line"><span>  1 | jan_1 |  55</span></span>
<span class="line"><span>  2 | jan_2 |  55</span></span>
<span class="line"><span>  3 | jan_3 |  23</span></span>
<span class="line"><span>(3 rows)</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 2</span></span>
<span class="line"><span>postgres=# begin;</span></span>
<span class="line"><span>BEGIN</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 2</span></span>
<span class="line"><span>postgres=# delete from jan_isolation_test where id=3;</span></span>
<span class="line"><span>DELETE 1</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 2</span></span>
<span class="line"><span>postgres=# commit;</span></span>
<span class="line"><span>COMMIT</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# select * from jan_isolation_test;</span></span>
<span class="line"><span> id | name  | age </span></span>
<span class="line"><span>----+-------+-----</span></span>
<span class="line"><span>  1 | jan_1 |  55</span></span>
<span class="line"><span>  2 | jan_2 |  55</span></span>
<span class="line"><span>(2 rows)</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# rollback;</span></span>
<span class="line"><span>ROLLBACK</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# select * from jan_isolation_test;</span></span>
<span class="line"><span> id | name  | age </span></span>
<span class="line"><span>----+-------+-----</span></span>
<span class="line"><span>  1 | jan_1 |  21</span></span>
<span class="line"><span>  2 | jan_2 |  22</span></span>
<span class="line"><span>(2 rows)</span></span></code></pre>
</div><ul>
<li>ËØªÂ∑≤Êèê‰∫§Âá∫Áé∞‰∏çÂèØÈáçÂ§çËØª<br>
session 1 Âú®Âêå‰∏Ä‰∏™‰∫ãÂä°‰∏≠ÁöÑ‰∏§Ê¨°Êü•ËØ¢ÔºåÂõ†‰∏∫ session 2 Âú®Âè¶‰∏Ä‰∏™Êèê‰∫§‰∫ãÂä°ÁöÑ‰øÆÊîπÂæóÂà∞‰∫Ü‰∏çÂêåÁöÑÁªìÊûúÔºå‰∫ßÁîü‰∫Ü‰∏çÂèØÈáçÂ§çËØª„ÄÇ</li>
</ul>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# set default_transaction_isolation='READ COMMITTED';</span></span>
<span class="line"><span>SET</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# show transaction_isolation;</span></span>
<span class="line"><span> transaction_isolation </span></span>
<span class="line"><span>-----------------------</span></span>
<span class="line"><span> read committed</span></span>
<span class="line"><span>(1 row)</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 2</span></span>
<span class="line"><span>postgres=# set default_transaction_isolation='READ COMMITTED';</span></span>
<span class="line"><span>SET</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 2</span></span>
<span class="line"><span>postgres=# show transaction_isolation;</span></span>
<span class="line"><span> transaction_isolation </span></span>
<span class="line"><span>-----------------------</span></span>
<span class="line"><span> read committed</span></span>
<span class="line"><span>(1 row)</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# begin;</span></span>
<span class="line"><span>BEGIN</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# select * from jan_isolation_test;</span></span>
<span class="line"><span> id | name  | age </span></span>
<span class="line"><span>----+-------+-----</span></span>
<span class="line"><span>  1 | jan_1 |  21</span></span>
<span class="line"><span>  2 | jan_2 |  22</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 2</span></span>
<span class="line"><span>postgres=# begin;</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 2</span></span>
<span class="line"><span>postgres=# update jan_isolation_test set age=66;</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 2</span></span>
<span class="line"><span>commit;</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span># postgres=# select * from jan_isolation_test;</span></span>
<span class="line"><span> id | name  | age </span></span>
<span class="line"><span>----+-------+-----</span></span>
<span class="line"><span>  1 | jan_1 |  66</span></span>
<span class="line"><span>  2 | jan_2 |  66</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# commit;</span></span></code></pre>
</div><h4 id="repeatable-readÂèØÈáçÂ§çËØªcaseÂÆûÈ™å" tabindex="-1">REPEATABLE-READÂèØÈáçÂ§çËØªCASEÂÆûÈ™å <a class="header-anchor" href="#repeatable-readÂèØÈáçÂ§çËØªcaseÂÆûÈ™å" aria-label="Permalink to &quot;REPEATABLE-READÂèØÈáçÂ§çËØªCASEÂÆûÈ™å&quot;"></a></h4>
<p>ÊîπÂèò‰∏§‰∏™sessionÁöÑÈöîÁ¶ªÁ∫ßÂà´</p>
<ul>
<li>REPEATABLE‚ÄîREAD‰∏ç‰ºöÂá∫Áé∞ÂπªËØª</li>
</ul>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# set default_transaction_isolation='repeatable read';</span></span>
<span class="line"><span>SET</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=#  show transaction_isolation;</span></span>
<span class="line"><span> transaction_isolation </span></span>
<span class="line"><span>-----------------------</span></span>
<span class="line"><span> repeatable read</span></span>
<span class="line"><span>(1 row)</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 2</span></span>
<span class="line"><span>postgres=# set default_transaction_isolation='repeatable read';</span></span>
<span class="line"><span>SET</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 2</span></span>
<span class="line"><span>postgres=#  show transaction_isolation;</span></span>
<span class="line"><span> transaction_isolation </span></span>
<span class="line"><span>-----------------------</span></span>
<span class="line"><span> repeatable read</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# begin;</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# select * from jan_isolation_test;</span></span>
<span class="line"><span> id | name  | age </span></span>
<span class="line"><span>----+-------+-----</span></span>
<span class="line"><span>  1 | jan_1 |  21</span></span>
<span class="line"><span>  2 | jan_2 |  22</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 2</span></span>
<span class="line"><span>postgres=# begin;</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 2</span></span>
<span class="line"><span>postgres=# insert into jan_isolation_test values (3,'jan_3',23);</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 2</span></span>
<span class="line"><span>postgres=# commit;</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# select * from jan_isolation_test;</span></span>
<span class="line"><span> id | name  | age </span></span>
<span class="line"><span>----+-------+-----</span></span>
<span class="line"><span>  1 | jan_1 |  21</span></span>
<span class="line"><span>  2 | jan_2 |  22</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 2</span></span>
<span class="line"><span>postgres=# delete from jan_isolation_test where id=3;</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 2</span></span>
<span class="line"><span>postgres=# select * from jan_isolation_test;</span></span>
<span class="line"><span> id | name  | age </span></span>
<span class="line"><span>----+-------+-----</span></span>
<span class="line"><span>  1 | jan_1 |  21</span></span>
<span class="line"><span>  2 | jan_2 |  22</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# select * from jan_isolation_test;</span></span>
<span class="line"><span> id | name  | age </span></span>
<span class="line"><span>----+-------+-----</span></span>
<span class="line"><span>  1 | jan_1 |  21</span></span>
<span class="line"><span>  2 | jan_2 |  22</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# commit;</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# select * from jan_isolation_test;</span></span>
<span class="line"><span> id | name  | age </span></span>
<span class="line"><span>----+-------+-----</span></span>
<span class="line"><span>  1 | jan_1 |  21</span></span>
<span class="line"><span>  2 | jan_2 |  22</span></span></code></pre>
</div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>postgres=# select * from jan_isolation_test;</span></span>
<span class="line"><span> id | name  | age </span></span>
<span class="line"><span>----+-------+-----</span></span>
<span class="line"><span>  2 | jan_2 |  22</span></span>
<span class="line"><span>  1 | jan_1 |  21</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# begin;</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# commit;</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 2</span></span>
<span class="line"><span>postgres=# begin;</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 2</span></span>
<span class="line"><span>postgres=# insert into jan_isolation_test values(3,'jan_3',23);</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 2</span></span>
<span class="line"><span>postgres=# commit;</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span># postgres=# select * from jan_isolation_test;</span></span>
<span class="line"><span> id | name  | age </span></span>
<span class="line"><span>----+-------+-----</span></span>
<span class="line"><span>  2 | jan_2 |  22</span></span>
<span class="line"><span>  1 | jan_1 |  21</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# update jan_isolation_test set age = 66;</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# commit;</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# select * from jan_isolation_test;</span></span>
<span class="line"><span> id | name  | age </span></span>
<span class="line"><span>----+-------+-----</span></span>
<span class="line"><span>  3 | jan_3 |  23</span></span>
<span class="line"><span>  2 | jan_2 |  66</span></span>
<span class="line"><span>  1 | jan_1 |  66</span></span></code></pre>
</div><ul>
<li>Âá∫Áé∞‰∏çÂèØÈáçÂ§çËØª</li>
</ul>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# set default_transaction_isolation='READ COMMITTED';</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# show transaction_isolation;</span></span>
<span class="line"><span> transaction_isolation </span></span>
<span class="line"><span>-----------------------</span></span>
<span class="line"><span> read committed</span></span>
<span class="line"><span>(1 row)</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 2</span></span>
<span class="line"><span>postgres=# set default_transaction_isolation='READ COMMITTED';</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 2</span></span>
<span class="line"><span>postgres=# show transaction_isolation;</span></span>
<span class="line"><span> transaction_isolation </span></span>
<span class="line"><span>-----------------------</span></span>
<span class="line"><span> read committed</span></span>
<span class="line"><span>(1 row)</span></span></code></pre>
</div><h4 id="serializableÂ∫èÂàóÂåñcaseÂÆûÈ™å" tabindex="-1">SERIALIZABLEÂ∫èÂàóÂåñCASEÂÆûÈ™å <a class="header-anchor" href="#serializableÂ∫èÂàóÂåñcaseÂÆûÈ™å" aria-label="Permalink to &quot;SERIALIZABLEÂ∫èÂàóÂåñCASEÂÆûÈ™å&quot;"></a></h4>
<h2 id="mysqlÈ™åËØÅrepeatable-read" tabindex="-1">MySQLÈ™åËØÅREPEATABLE-READ <a class="header-anchor" href="#mysqlÈ™åËØÅrepeatable-read" aria-label="Permalink to &quot;MySQLÈ™åËØÅREPEATABLE-READ&quot;"></a></h2>
<figure><img src="http://cdn.lifemini.cn/dbblog/20210114/2ea5088487414a6fa0af0a73c4973d5f.png" alt="image.png" tabindex="0"><figcaption>image.png</figcaption></figure>
<p>ÁâàÊú¨‰ø°ÊÅØ‰∏éÊûÑÈÄ†ÂÆûÈ™åÊï∞ÊçÆ</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>mysql> select @@tx_isolation;</span></span>
<span class="line"><span>+-----------------+</span></span>
<span class="line"><span>| @@tx_isolation  |</span></span>
<span class="line"><span>+-----------------+</span></span>
<span class="line"><span>| REPEATABLE-READ |</span></span>
<span class="line"><span>+-----------------+</span></span>
<span class="line"><span>1 row in set, 1 warning (0.00 sec)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>mysql> select version();</span></span>
<span class="line"><span>+------------+</span></span>
<span class="line"><span>| version()  |</span></span>
<span class="line"><span>+------------+</span></span>
<span class="line"><span>| 5.7.32-log |</span></span>
<span class="line"><span>+------------+</span></span>
<span class="line"><span>1 row in set (0.00 sec)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>mysql> select * from jan_isolation_test;</span></span>
<span class="line"><span>+----+-------+------+</span></span>
<span class="line"><span>| id | name  | age  |</span></span>
<span class="line"><span>+----+-------+------+</span></span>
<span class="line"><span>|  1 | jan_1 |   21 |</span></span>
<span class="line"><span>|  2 | jan_2 |   22 |</span></span>
<span class="line"><span>+----+-------+------+</span></span>
<span class="line"><span>2 rows in set (0.00 sec)</span></span></code></pre>
</div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span># session 1</span></span>
<span class="line"><span>mysql> begin;</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>mysql> select * from jan_isolation_test;</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 2</span></span>
<span class="line"><span>mysql> begin;</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 2</span></span>
<span class="line"><span>mysql> insert into jan_isolation_test values(3,'jan_3',23);</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 2</span></span>
<span class="line"><span>mysql> commit;</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>mysql> select * from jan_isolation_test;</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>mysql> update jan_isolation_test set age=55;</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>mysql> commit;</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>mysql> select * from jan_isolation_test;</span></span></code></pre>
</div>]]></content:encoded>
            <enclosure url="http://cdn.lifemini.cn/dbblog/20210114/2ea5088487414a6fa0af0a73c4973d5f.png" length="0" type="image/png"/>
        </item>
        <item>
            <title><![CDATA[What's TiDB]]></title>
            <link>https://askaric.com/en/work/tidb/TiDB-Principle/Paper Reading/06What is TiDB.html</link>
            <guid>https://askaric.com/en/work/tidb/TiDB-Principle/Paper Reading/06What is TiDB.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[Concepts

From it's website, we can know TiDB is a database which has different attributes below (]]></description>
            <content:encoded><![CDATA[<h1 id="what-s-tidb" tabindex="-1">What's TiDB <a class="header-anchor" href="#what-s-tidb" aria-label="Permalink to &quot;What's TiDB&quot;"></a></h1>
<h2 id="concepts" tabindex="-1">Concepts <a class="header-anchor" href="#concepts" aria-label="Permalink to &quot;Concepts&quot;"></a></h2>
<p>From it's <a href="https://docs.pingcap.com/zh/tidb/stable/overview" target="_blank" rel="noreferrer">website</a>, we can know TiDB is a database which has different attributes below (scaling, high availability, HTAP, Cloud-native distributed, Compatible with the MySQL):</p>
<ol>
<li>Horizontally scaling out or scaling in easily</li>
<li>Financial-grade high availability</li>
<li>Real-time HTAP</li>
<li>Cloud-native distributed database</li>
<li>Compatible with the MySQL 5.7 protocol and MySQL ecosystem</li>
</ol>
<p>TiDB Cluster, which was basicly composed with component instances of PD-Server, TiDB-Server, TiKV-Server, could be understanded easily in a pic below:
<img src="https://download.pingcap.com/images/docs-cn/tidb-architecture-v3.1.png" alt="tidb-architecture-v3.1">
TiDB-Server is a statusless instance encapsulated etcd, which was used to deal with App connections and compute SQL result;<br>
TiKV-Server is a status instance encapsulated raft protocol, rocksdb KV engine and so forth, which were used to storage data;<br>
PD-Server is a status instance, which continously getting data or load info from TiKV heartbeats, aiming for scheduling parts of data to different TiKV-Server.</p>
<h2 id="attributes-and-effects" tabindex="-1">Attributes and effects <a class="header-anchor" href="#attributes-and-effects" aria-label="Permalink to &quot;Attributes and effects&quot;"></a></h2>
<ol>
<li>First of all, <code>scale-out</code> and <code>scale-in</code> are very easy to implment without any bad effections or just a little bit effects on App.</li>
<li>Second,</li>
</ol>
<p>All of components transport info on the internet,</p>
<h2 id="ecosystem" tabindex="-1">ecosystem <a class="header-anchor" href="#ecosystem" aria-label="Permalink to &quot;ecosystem&quot;"></a></h2>
]]></content:encoded>
            <enclosure url="https://download.pingcap.com/images/docs-cn/tidb-architecture-v3.1.png" length="0" type="image/png"/>
        </item>
        <item>
            <title><![CDATA[What problem does Paxos reslove]]></title>
            <link>https://askaric.com/en/work/tidb/TiDB-Principle/Paper Reading/PaperPaxos Note.html</link>
            <guid>https://askaric.com/en/work/tidb/TiDB-Principle/Paper Reading/PaperPaxos Note.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[PaxosÁÆóÊ≥ïÂ∏∏Ë¢´ÂºïÁî®‰∫éÂàÜÂ∏ÉÂºèÁõ∏ÂÖ≥ÊñáÁ´†ÔºåÂÄüÂä©ÈíàÂØπÂ∏åËÖäÂüéÈÇ¶ËÆÆ‰ºöÁ´ãÊ≥ïÁöÑÂú∫ÊôØÔºå‰∏ªË¶ÅÊé¢ËÆ®Âú®‰∫∫Âëò‰∏çÊñ≠ÂèòÂåñÁ≠â‰∏çÁ°ÆÂÆöÊÄßÂõ†Á¥†ÁöÑÂâçÊèê‰∏ãÂ¶Ç‰ΩïÂü∫‰∫é‰∏ÄÂÆöÁöÑËßÑÂàôËææÊàêÂÖ±ËØÜÊñπÊ≥ï„ÄÇ‰ΩúËÄÖÂÄüÁî®ÂØπÂú∫ÊôØÁöÑÊé¢ËÆ®ÈöêÂñªÂàÜÂ∏ÉÂºèËÆ°ÁÆóÊú∫Á≥ªÁªüÁöÑËß£ÂÜ≥ÂäûÊ≥ïÔºå]]></description>
            <content:encoded><![CDATA[<h1 id="what-problem-does-paxos-reslove" tabindex="-1">What problem does Paxos reslove <a class="header-anchor" href="#what-problem-does-paxos-reslove" aria-label="Permalink to &quot;What problem does Paxos reslove&quot;"></a></h1>
<p>PaxosÁÆóÊ≥ïÂ∏∏Ë¢´ÂºïÁî®‰∫éÂàÜÂ∏ÉÂºèÁõ∏ÂÖ≥ÊñáÁ´†ÔºåÂÄüÂä©ÈíàÂØπÂ∏åËÖäÂüéÈÇ¶ËÆÆ‰ºöÁ´ãÊ≥ïÁöÑÂú∫ÊôØÔºå‰∏ªË¶ÅÊé¢ËÆ®Âú®‰∫∫Âëò‰∏çÊñ≠ÂèòÂåñÁ≠â‰∏çÁ°ÆÂÆöÊÄßÂõ†Á¥†ÁöÑÂâçÊèê‰∏ãÂ¶Ç‰ΩïÂü∫‰∫é‰∏ÄÂÆöÁöÑËßÑÂàôËææÊàêÂÖ±ËØÜÊñπÊ≥ï„ÄÇ‰ΩúËÄÖÂÄüÁî®ÂØπÂú∫ÊôØÁöÑÊé¢ËÆ®ÈöêÂñªÂàÜÂ∏ÉÂºèËÆ°ÁÆóÊú∫Á≥ªÁªüÁöÑËß£ÂÜ≥ÂäûÊ≥ïÔºå‰ª•ËæÉÊòì‰∫éÁêÜËß£ÁöÑÂΩ¢ÂºèÈòêËø∞„ÄÅÂπ∂È™åËØÅ‰∫ÜËØ•ÁÆóÊ≥ïÁöÑÊ≠£Á°ÆÊÄß„ÄÇ</p>
<h2 id="„Ääpaxos-made-simple„ÄãÁÆÄËø∞" tabindex="-1">„ÄäPaxos Made Simple„ÄãÁÆÄËø∞ <a class="header-anchor" href="#„Ääpaxos-made-simple„ÄãÁÆÄËø∞" aria-label="Permalink to &quot;„ÄäPaxos Made Simple„ÄãÁÆÄËø∞&quot;"></a></h2>
<ul>
<li><strong>ÊñáÁ´†Áî±Êù•</strong></li>
</ul>
<p>PaxosÁÆóÊ≥ïÁöÑPaperÂéüÊñá‰∏∫„ÄäThe Part-Time Parliament„ÄãÔºå‰ΩÜÂõ†‰ΩúËÄÖlamportÈááÁî®ÈöêÂñªÁöÑÊñπÂºèË°®ËææÂèäÁÆóÊ≥ïÊú¨Ë∫´ÁöÑÂ§çÊùÇÊÄßÔºå‰ΩøÂæóËØ•ÁÆóÊ≥ïÈöæ‰ª•Ë¢´Â≠¶‰π†ËÄÖÊé•Âèó„ÄÇÂõ†Ê≠§Ôºå‰ΩúËÄÖÊé®Âá∫‰∫Ü„ÄäPaxos Made Simple„ÄãÂ∏ÆÂä©Â≠¶‰π†ËÄÖ‰ª¨ÁêÜËß£ÂíåÂ≠¶‰π†ÊîπÁÆóÊ≥ï„ÄÇ</p>
<ul>
<li><strong>ÊñáÁ´†ÁªìÊûÑ</strong></li>
</ul>
<p>„ÄäPaxos Made Simple„ÄãÊñáÁ´†Â§ßËá¥ÂàÜ‰∏∫Introduction„ÄÅThe Consensus Algorithm„ÄÅThe Implementation‰∏â‰∏™ÈÉ®ÂàÜÔºå‰∏ÄËá¥ÊÄßÁÆóÊ≥ïÈÉ®ÂàÜÂèØË∞ì‰∏≠ÈáçÂ∑•‰πãÈáç„ÄÇËØ•ÈÉ®ÂàÜÔºå‰∏ªË¶ÅËÆ≤Ëß£‰∫ÜÂ≠òÂú®ÁöÑÈóÆÈ¢ò„ÄÅ‰º†Êí≠Ë¢´promiseÁöÑÂÄºÔºåÂ§ÑÁêÜ„ÄÅÂÖ∑‰ΩìÁöÑÂÆûÁé∞„ÄÇ</p>
<ul>
<li><strong>ÊãúÂç†Â∫≠ÂÆπÈîôÂÖ±ËØÜÁÆóÊ≥ïÁöÑ‰∏§‰∏™ÊåáÊ†á</strong></li>
</ul>
<p>ÂÆâÂÖ®ÊÄß(safety)Ôºösafety means nothing bad happens.
ÔºàÂÆâÂÖ®ÊÄßÊÑèÂë≥ÁùÄÂ§öÁä∂ÊÄÅÊú∫ÁöÑÊúÄÁªà‰∏ÄËá¥ÊÄß„ÄÇÔºâ
Ê¥ªÊÄß(liveness)Ôºöliveness means that something good eventually happens.
ÔºàÊ¥ªÊÄßÊÑèÂë≥ÁùÄmessageÂèØ‰ª•Âª∂ËøüÂà∞ËææÔºå‰ΩÜÁªù‰∏çËÉΩ‰∏¢Â§±„ÄÇÔºâ</p>
<p>‰∏∫Á°Æ‰øùÂÆâÂÖ®ÊÄßÔºåËøòÈúÄÊª°Ë∂≥Â¶Ç‰∏ãË¶ÅÊ±ÇÔºö
Ôºà1Ôºâ ÊØèÊ¨°proposeÔºå‰ªÖ1‰∏™ÂÄºË¢´proposeÔºõ
Ôºà2Ôºâ ÊØèÊ¨°proposeÔºå‰ªÖ1‰∏™ÂÄºË¢´promiseÔºõ
Ôºà3Ôºâ ÊØèÊ¨°proposeÔºåËøõÁ®ã‰ªé‰∏çpromiseÊØîËá™Â∑±Â∞èÁöÑÂÄºÔºåÈô§ÈùûÁ≠â‰∫éËá™Â∑±ÁöÑÂÄºÔºõ</p>
<p>‰∏∫Á°Æ‰øùÊ¥ªÊÄßÔºåËøòÈúÄÊª°Ë∂≥Â¶Ç‰∏ãË¶ÅÊ±ÇÔºö</p>
<p>2312312312312</p>
<p>‰ΩúËÄÖÁêÜËÆ∫ÁöÑÂâçÊèêÊòØÔºå‰∏çÂá∫Áé∞ÊãúÂç†Â∫≠ÂÆπÈîôËØØÔºåÊó¢Ôºö‰∏ç‰∏¢Â§±Ê¥ªÊÄßÔºõ</p>
<ul>
<li><strong>ProposalÁöÑËøáÁ®ã</strong></li>
</ul>
<p>P1Êù°‰ª∂ÔºöacceptorÂøÖÈ°ªÊé•ÂèóÁ¨¨‰∏ÄÊ¨°Ë¢´proposeÁöÑÂÄºÔºõ</p>
<p>P2Êù°‰ª∂ÔºöÂ¶ÇÊûúaccepterÂ∑≤promiseËøáÁöÑvalueÔºåÈÇ£‰∏™Ë¢´promiseÁöÑÊõ¥Â§ßnumberÁöÑproposalÊê∫Â∏¶ÁöÑvalueÊòØÂêå‰∏Ä‰∏™„ÄÇ</p>
<p>P2aÊù°‰ª∂ÔºöÂ¶ÇÊûúaccepterÂ∑≤promiseËøáÁöÑvalueÔºåÈÇ£‰∏™Ë¢´promiseÁöÑÊõ¥Â§ßnumberÁöÑproposalÊê∫Â∏¶ÁöÑvalueÊòØÂêå‰∏Ä‰∏™Ôºå‰∏îË¢´ÊâÄÊúâacceptorÊâÄpromise„ÄÇÔºàÂú®Êª°Ë∂≥P1ÂíåP2ÁöÑÂâçÊèê‰∏ãÊé®ÂØºÂá∫P2aÔºâ</p>
<p>P2bÊù°‰ª∂ÔºöÂ¶ÇÊûúaccepterÂ∑≤promiseËøáÁöÑvalueÔºåÈÇ£‰∏™Ë¢´promiseÁöÑÊõ¥Â§ßnumberÁöÑproposalÊê∫Â∏¶ÁöÑvalueÊòØÂêå‰∏Ä‰∏™Ôºåproposer‰∏ç‰ºöÂèëÈÄÅÊØîÂΩìÂâçnumberÂ∞èÁöÑproposal„ÄÇÔºàÂú®Êó¢Êª°Ë∂≥ËøõÂ±ïÊÄßÔºåÂèàÊª°Ë∂≥P1Êù°‰ª∂ÁöÑÂâçÊèêÊó∂Ôºå‰ºöÂá∫Áé∞Ê¥ªÈîÅÈóÆÈ¢òËøùËÉåP2aÊù°‰ª∂ÔºåÈÄöËøáÂ¢ûÂº∫P2aÁöÑÊñπÂºèËß£ÂÜ≥Ëß£ÂÜ≥„ÄÇÔºâ</p>
<p>P2cÊù°‰ª∂ÔºöÂØπ‰∫é‰ªªÊÑèÁöÑvÂíånÔºåÂ¶ÇÊûúÊúâvalue‰∏∫v‰∏înumber‰∏∫nÁöÑproposalË¢´ÂàÜÂèëÔºåÂõ†‰∏∫acceptorÊòØÊâÄÊúâacceptor‰∏≠ÁöÑÂ§ßÂ§öÊï∞ÔºàÁÆÄÁß∞ÔºöSÔºâÔºåÂàôÂèØÊé®Êñ≠Âá∫ÂΩìÂâçÁöÑS‰∏≠ÁöÑvaluesÂÄºÔºåË¶Å‰πàÊ≤°ÊúâpromiseËøá‰ªª‰ΩïÂ∞è‰∫énÁöÑvalueÔºåË¶Å‰πàÂΩìÂâçSÊâÄpromiseËøáÁöÑÊòØproposal‰∏≠ÁöÑÊúÄÂ§ßnumberÊâÄÊê∫Â∏¶ÁöÑÂÄº„ÄÇ</p>
<p><strong>Ê≠§Â§ÑË¶ÅÊèíÂÖ•Êó∂Â∫èÂõæ</strong></p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>Phase 1. (a) A proposer selects a proposal number n and sends a prepare</span></span>
<span class="line"><span>request with number n to a majority of acceptors.</span></span>
<span class="line"><span>(b) If an acceptor receives a prepare request with number n greater</span></span>
<span class="line"><span>than that of any prepare request to which it has already responded,</span></span>
<span class="line"><span>then it responds to the request with a promise not to accept any more</span></span>
<span class="line"><span>proposals numbered less than n and with the highest-numbered proposal (if any) that it has accepted.</span></span>
<span class="line"><span>5</span></span>
<span class="line"><span>Phase 2. (a) If the proposer receives a response to its prepare requests</span></span>
<span class="line"><span>(numbered n) from a majority of acceptors, then it sends an accept</span></span>
<span class="line"><span>request to each of those acceptors for a proposal numbered n with a</span></span>
<span class="line"><span>value v, where v is the value of the highest-numbered proposal among</span></span>
<span class="line"><span>the responses, or is any value if the responses reported no proposals.</span></span>
<span class="line"><span>(b) If an acceptor receives an accept request for a proposal numbered</span></span>
<span class="line"><span>n, it accepts the proposal unless it has already responded to a prepare</span></span>
<span class="line"><span>request having a number greater than n.</span></span></code></pre>
</div><h3 id="Ê¥ªÈîÅÈóÆÈ¢òÁêÜËß£‰∏éÂ§ÑÁêÜ" tabindex="-1">Ê¥ªÈîÅÈóÆÈ¢òÁêÜËß£‰∏éÂ§ÑÁêÜ <a class="header-anchor" href="#Ê¥ªÈîÅÈóÆÈ¢òÁêÜËß£‰∏éÂ§ÑÁêÜ" aria-label="Permalink to &quot;Ê¥ªÈîÅÈóÆÈ¢òÁêÜËß£‰∏éÂ§ÑÁêÜ&quot;"></a></h3>
<h3 id="„Ääthe-part-time-parliament„ÄãÁÆÄËø∞" tabindex="-1">„ÄäThe Part-Time Parliament„ÄãÁÆÄËø∞ <a class="header-anchor" href="#„Ääthe-part-time-parliament„ÄãÁÆÄËø∞" aria-label="Permalink to &quot;„ÄäThe Part-Time Parliament„ÄãÁÆÄËø∞&quot;"></a></h3>
<h3 id="ÂèÇËÄÉÊñáÁ´†" tabindex="-1">ÂèÇËÄÉÊñáÁ´† <a class="header-anchor" href="#ÂèÇËÄÉÊñáÁ´†" aria-label="Permalink to &quot;ÂèÇËÄÉÊñáÁ´†&quot;"></a></h3>
<p><a href="http://lamport.azurewebsites.net/pubs/pubs.html" target="_blank" rel="noreferrer"><em><strong>Leslie LamportÂçöÂÆ¢</strong></em></a>
<a href="https://courses.cs.washington.edu/courses/csep590/04wi/papers/lamport-part-time-parliament.pdf" target="_blank" rel="noreferrer"><em><strong>The Part-Time ParliamentÂéüÊñá</strong></em></a>
<a href="https://lamport.azurewebsites.net/pubs/paxos-simple.pdf" target="_blank" rel="noreferrer"><em><strong>Paxos Made SimpleÂéüÊñá</strong></em></a>
<a href="https://www.cnblogs.com/hzmark/p/The_Part-Time_Parliament.html" target="_blank" rel="noreferrer"><em><strong>The Part-Time ParliamentËØëÊñá</strong></em></a>
<a href="https://www.jianshu.com/p/67dd80555ba2" target="_blank" rel="noreferrer"><em><strong>Re-visiting of Paxos Made SimpleËØëÊñá</strong></em></a>
<a href="https://www.jianshu.com/p/21785016f412" target="_blank" rel="noreferrer"><em><strong>ÁÆÄ‰π¶-Â≠ôÂ¶ÇÁªøÂè∂ÁöÑÊãúÂç†Â∫≠ÁÆóÊ≥ïÁêÜËß£</strong></em></a>
<a href="https://zhuanlan.zhihu.com/p/111304281" target="_blank" rel="noreferrer"><em><strong>Áü•‰πé-ÊΩáÊπòÂ§úÈõ®ÁêÜËß£‰∏§Èò∂ÊÆµÊèê‰∫§</strong></em></a>
<a href="https://zhuanlan.zhihu.com/p/91288179" target="_blank" rel="noreferrer"><em><strong>Áü•‰πé-ÁâõÂêÉËçâraftÂçèËÆÆÁêÜËß£</strong></em></a>
<a href="http://blog.itpub.net/9683969/viewspace-672920/" target="_blank" rel="noreferrer"><em><strong>itpub-OracleË°åÈîÅÂèämvccÂÆûÁé∞ÂéüÁêÜ</strong></em></a>
<a href="https://zhuanlan.zhihu.com/p/31727291" target="_blank" rel="noreferrer"><em><strong>Áü•‰πé-Á••ÂÖâÁöÑÊñáÁ´†(1)Paxos„ÄÅRaftÂàÜÂ∏ÉÂºè‰∏ÄËá¥ÊÄßÁÆóÊ≥ïÂ∫îÁî®Âú∫ÊôØ</strong></em></a>
<a href="https://zhuanlan.zhihu.com/p/31780743" target="_blank" rel="noreferrer"><em><strong>Áü•‰πé-Á••ÂÖâÁöÑÊñáÁ´†(2)PaxosÁÆóÊ≥ïËØ¶Ëß£</strong></em></a>
<a href="https://www.cnblogs.com/hzmark/p/The_Part-Time_Parliament.html" target="_blank" rel="noreferrer"><em><strong>ÂçöÂÆ¢Âõ≠-Êù≠Â∑û.MarkÁöÑÊñáÁ´†</strong></em></a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[What's Percolator Transaction]]></title>
            <link>https://askaric.com/en/work/tidb/TiDB-Principle/Paper Reading/Percolator Transaction.html</link>
            <guid>https://askaric.com/en/work/tidb/TiDB-Principle/Paper Reading/Percolator Transaction.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[‰∏Ä„ÄÅËÆ∫ÊñáÊëòË¶Å

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Google ‰ª•ÂæÄ‰æùÈù†Á¶ªÁ∫øËÆ°ÁÆóÁöÑ ‚ÄúÁΩëÈ°µÁ¥¢ÂºïÊúçÂä°‚Äù Â≠òÂú®Â§ÑÁêÜÊó∂Âª∂ÈóÆÈ¢òÔºåÂΩìÊñ∞ÁöÑÊñáÊ°£Á¥¢Âºï]]></description>
            <content:encoded><![CDATA[<h1 id="what-s-percolator-transaction" tabindex="-1">What's Percolator Transaction <a class="header-anchor" href="#what-s-percolator-transaction" aria-label="Permalink to &quot;What's Percolator Transaction&quot;"></a></h1>
<h2 id="‰∏Ä„ÄÅËÆ∫ÊñáÊëòË¶Å" tabindex="-1">‰∏Ä„ÄÅËÆ∫ÊñáÊëòË¶Å <a class="header-anchor" href="#‰∏Ä„ÄÅËÆ∫ÊñáÊëòË¶Å" aria-label="Permalink to &quot;‰∏Ä„ÄÅËÆ∫ÊñáÊëòË¶Å&quot;"></a></h2>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Google ‰ª•ÂæÄ‰æùÈù†Á¶ªÁ∫øËÆ°ÁÆóÁöÑ ‚ÄúÁΩëÈ°µÁ¥¢ÂºïÊúçÂä°‚Äù Â≠òÂú®Â§ÑÁêÜÊó∂Âª∂ÈóÆÈ¢òÔºåÂΩìÊñ∞ÁöÑÊñáÊ°£Á¥¢ÂºïÁü©ÈòµÊõ¥Êñ∞ÂêéÔºåÈúÄË¶Å MapReduce Âíå Batch ÊâπÂ§ÑÁêÜËÆ°ÁÆóÊñ∞ÁöÑÁªìÊûú„ÄÇ‰ΩøÁî® Percolator ÁªÑ‰ª∂ÊõøÊç¢Âü∫‰∫é batch Á¶ªÁ∫øÂ§ÑÁêÜ‰ΩìÁ≥ªÔºåÊØèÂ§©Áõ∏ÂêåÂ§ÑÁêÜÊñáÊ°£ÈáèÂâçÊèê‰∏ãÔºåÂπ≥ÂùáÊñáÊ°£Âπ¥ÈæÑÈôç‰Ωé 50%Ôºå‰∏ªË¶ÅÂéüÂõ†‰æøÊòØ Percolator ÁöÑÂ¢ûÈáèÂàÜÂ∏ÉÂºè‰∫ãÂä°Â§ÑÁêÜÊ®°Âûã„ÄÇ</p>
<figure><img src="./Theory-PercolatorÂàÜÂ∏ÉÂºè‰∫ãÂä°/Percolator_overview.svg" alt="03" tabindex="0"><figcaption>03</figcaption></figure>
<p><strong>‰ºòÁÇπÔºö</strong></p>
<ol>
<li>Â¢ûÈáèÂ§ÑÁêÜÔºåÁî®Â∏¶ Timestamp Oracle ÁöÑÁ±ª Mvcc Êú∫Âà∂ÂÆûÁé∞Êï∞ÊçÆÁâàÊú¨ÈöîÁ¶ªÔºõ</li>
<li>È´òÂÆπÈáèÊâ©Â±ïÔºåTSO Êú∫Âà∂ÂíåÂª∂ËøüÊ∏ÖÈîÅÊú∫Âà∂ÔºåÂÖÅËÆ∏ÈõÜÁæ§Êâ©Â±ïËá≥‰∏äÂçÉÂè∞Êú∫Âô®Ôºõ</li>
</ol>
<p><strong>Áº∫ÁÇπÔºö</strong></p>
<ol>
<li>Âª∂Êó∂È´òÔºåÁº∫‰πèÂÖ®Â±ÄÊ≠ªÈîÅÊé¢ÊµãÂô®ÂíåÂÖ®Â±Ä‰∫ãÂä°ÁÆ°ÁêÜÂô®Ôºå‰ºöÂ¢ûÂ§ß‰∫ãÂä°ÂÜ≤Á™ÅÂíåÂª∂Êó∂Ôºõ</li>
</ol>
<h2 id="‰∫å„ÄÅÊ®°ÂûãËÆæËÆ°Ëß£Êûê" tabindex="-1">‰∫å„ÄÅÊ®°ÂûãËÆæËÆ°Ëß£Êûê <a class="header-anchor" href="#‰∫å„ÄÅÊ®°ÂûãËÆæËÆ°Ëß£Êûê" aria-label="Permalink to &quot;‰∫å„ÄÅÊ®°ÂûãËÆæËÆ°Ëß£Êûê&quot;"></a></h2>
<h3 id="_2-1-Âπ∂ÂèëÊ≠£Á°ÆÊÄßÊéßÂà∂" tabindex="-1">2.1 Âπ∂ÂèëÊ≠£Á°ÆÊÄßÊéßÂà∂ <a class="header-anchor" href="#_2-1-Âπ∂ÂèëÊ≠£Á°ÆÊÄßÊéßÂà∂" aria-label="Permalink to &quot;2.1 Âπ∂ÂèëÊ≠£Á°ÆÊÄßÊéßÂà∂&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÂéüÊúâÁöÑ MapReduce Á¶ªÁ∫øËÆ°ÁÆóÊú∫Âà∂Ëá™Âä®ÈôêÂà∂Âπ∂ÂèëÈ°∫Â∫èÔºåÂΩìÂàáÊç¢Âà∞ Percolator ÊéßÂà∂Âπ∂ÂèëÊó∂Ôºå‰æøÊ∂âÂèäÊéßÂà∂Âπ∂ÂèëËÆ°ÁÆóÁöÑÁªìÊûúÊ≠£Á°ÆÊÄß„ÄÇÁªèÂÖ∏‰æãÂ≠êÔºöPageRank ÁÆóÊ≥ï‰ºòÂåñ Google ÁΩëÈ°µÁ¥¢ÂºïÈáçË¶ÅÊÄßÊúçÂä°‰∏≠ÁöÑÂπ∂ÂèëÊéßÂà∂ÔºåÂá∫‰∫éÁÆÄËø∞ÂéüÁêÜÁõÆÁöÑ‰æø‰∏çËµòËø∞ÔºåËØ¶Ëß£ÂèØÈòÖËØª <a href="https://zhuanlan.zhihu.com/p/197877312" target="_blank" rel="noreferrer">Áü•‰πéÊñáÁ´†</a>„ÄÇ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‰∏ã‰æãÁÆÄËø∞‰∏ÄÈúÄÂπ∂ÂèëÊéßÂà∂Âú∫ÊôØÔºåÂΩìÁà¨Ëô´Áà¨ÂèñÊñ∞ÁöÑÁΩëÈ°µÂà∞Â≠òÂÇ®Â∫ì‰∏≠ÔºåÈúÄË¶Å‰æùÊñ∞Êï∞ÊçÆËÆ°ÁÆóÊñ∞Á¥¢ÂºïÈ°µÈù¢ÈáçË¶ÅÊÄßÊó∂ÔºåÊñ∞ÊóßÊ®°ÂûãÂ∑ÆÂºÇÂ¶Ç‰∏ãÔºö</p>
<ol>
<li>ÂéüÁ¶ªÁ∫øÊ®°Âûã‰ΩøÁî® MapReduce Â≠ê‰ªªÂä° Reduce ‰∏çËÆ°ÁÆóÊàêÂäüÔºåÊÄª‰ªªÂä° Map ‰æøÊó†Ê≥ïÊ±áÊÄªËÆ°ÁÆóÔºåÂ§©ÁîüÂèØÁ°Æ‰øùËÆ°ÁÆóÈ°∫Â∫è„ÄÇ</li>
<li>Êñ∞Â¢ûÈáèÂ§ÑÁêÜÊ®°Âûã Percolator ‰æøÊúâ‰∫ÜÊéßÂà∂‰∏çÂêåÊó∂Èó¥ËÆ°ÁÆóÁªìÊûúÁöÑÈúÄÊ±ÇÔºåPercolator ÈúÄË¶ÅÁâàÊú¨ÊéßÂà∂ÁâπÊÄßÁ°Æ‰øùÊï∞ÊçÆËÆ°ÁÆóÊ≠£Á°Æ„ÄÇ</li>
</ol>
<figure><img src="./Theory-PercolatorÂàÜÂ∏ÉÂºè‰∫ãÂä°/PageRank.svg" alt="02" tabindex="0"><figcaption>02</figcaption></figure>
<h3 id="_2-2-percolator-ÁªÑ‰ª∂‰ΩúÁî®" tabindex="-1">2.2 Percolator ÁªÑ‰ª∂‰ΩúÁî® <a class="header-anchor" href="#_2-2-percolator-ÁªÑ‰ª∂‰ΩúÁî®" aria-label="Permalink to &quot;2.2 Percolator ÁªÑ‰ª∂‰ΩúÁî®&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Percolator ÈÄöËøá ACID Transaction „ÄÅ observers „ÄÅtimestamp oracle„ÄÅlightweight lock Âõõ‰∏™ÊäΩË±°Ëß£ÂÜ≥ÂàÜÂ∏ÉÂºè‰∫ãÂä°‰∏≠ÈÅáÂà∞ÁöÑ <strong>Ê≠£Á°ÆÊÄßÈóÆÈ¢ò„ÄÅÊÄßËÉΩÈóÆÈ¢ò</strong>„ÄÇÁªÑ‰ª∂Èó¥ÊâßÊµÅÂÖ•Â§ßËá¥Â¶Ç‰∏ãÔºö</p>
<ol>
<li>Observers ÈìæÊé• Percolator worker Âπ∂ÂèëÈÄÅ Notification ‰ø°ÊÅØÔºåÂèëËµ∑ Job Ë∞ÉÁî®Ôºõ</li>
<li>Percolator Workers ÂèëËµ∑‰∫ãÂä°ÔºåÂèëÈÄÅËØªÂÜô RPC Ê∂àÊÅØÁªô Bigtable tablet serversÔºõ</li>
<li>Bigtable tablet servers ÂèëÈÄÅËØªÂÜô RPC Ê∂àÊÅØÁªô GFS chunkserversÔºõ</li>
<li>TSOÔºàtimestamp oracleÔºâ Êèê‰æõ‰∏•Ê†ºÁöÑÊõæÈáèÊó∂Èó¥Êà≥ÔºåÁ°Æ‰øùÂø´ÁÖßÈöîÁ¶ª‰∏ÄËá¥ÊÄßÔºõ</li>
<li>Percolator Workers ‰ΩøÁî® lightweight lock ‰ΩøÊêúÁ¥¢Ë¢´‰øÆÊîπËøáÁöÑËÑèÊï∞ÊçÆÊõ¥È´òÊïà„ÄÇ</li>
</ol>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>ACID Transaction</strong> ÔºöPercolator Êèê‰æõÂ¶Ç‰º†ÁªüÊï∞ÊçÆÂ∫ì‰ΩøÁî®ÁöÑ ACID ‰∫ãÂä°Ê®°ÂûãÔºåÁ°Æ‰øùÊé®Êñ≠Â≠òÂÇ®Â∫ìÊó∂Èó¥Áä∂ÊÄÅÔºåÁ°Æ‰øùËÆ°ÁÆóÊ≠£Á°ÆÊÄß„ÄÇ</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>observers</strong> ÔºöPercolator Êèê‰æõ observers ÂÆåÊàêÁ±ª‰ºº Job ÂäüËÉΩË∞ÉÁî®ÁöÑÁ≥ªÁªü‰ª£Á†ÅÊÆµÔºåÊØè‰∏™ËßÇÂØüËÄÖÂÆåÊàê‰∏Ä‰∏™‰ªªÂä°ÔºåÂπ∂ÈÄöËøáÂêëË°®‰∏≠ÂÜôÂÖ•ÂÜÖÂÆπ‰∏∫ ‚Äú‰∏ãÊ∏∏‚Äù ËßÇÂØüËÄÖÂàõÂª∫Êõ¥Â§öÁöÑÂ∑•‰Ωú„ÄÇ</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>timestamp oracle</strong> ÔºöPercolator Êèê‰æõ TSO ÊúçÂä°Âô®Ôºå‰∏•Ê†ºÈÄíÂ¢ûÁöÑÈ°∫Â∫èÂàÜÂèëÊó∂Èó¥Êà≥ÔºåÂ∞ÜÊúÄÂ§ßÁöÑÊó∂Èó¥Êà≥ÂÜôÂÖ•Á®≥ÂÆöÂ≠òÂÇ®Ôºå‰ªéÂÜÖÂ≠ò‰∏≠Âë®ÊúüÊÄßÂú∞ÂàÜÈÖç‰∏Ä‰∏™Êó∂Èó¥Êà≥ËåÉÂõ¥Êª°Ë∂≥Êú™Êù•ÁöÑËØ∑Ê±Ç„ÄÇÂ¶ÇÊûúoracleÈáçÊñ∞ÂêØÂä®ÔºåÊó∂Èó¥Êà≥Â∞ÜÂêëÂâçË∑≥ËΩ¨Âà∞ÊâÄÂàÜÈÖçÁöÑÊúÄÂ§ßÊó∂Èó¥Êà≥(‰ΩÜÊ∞∏Ëøú‰∏ç‰ºöÂêëÂêé)„ÄÇ</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>lightweight lock</strong> ÔºöPercolator Êèê‰æõ ‚ÄúËΩªÈáèÈîÅ‚Äù Êú∫Âà∂Á°Æ‰øù‰∏äÂçÉÂè∞Êú∫Âô®Áõ∏ËøëÊó∂Èó¥ÁÇπÁöÑÂπ∂ÂèëËÆøÈóÆÔºåÊØè‰∏™ËØªÊìç‰ΩúÈô§Ëé∑ÂèñÊï∞ÊçÆÂ§ñÔºåËøò‰ºöÂä†ËØªÈîÅÂπ∂ÂÜôÂÖ• BigTable ÂÜÖÂ≠òÂàó‰∏≠ÊåÅ‰πÖÊï∞ÊçÆÂ≠òÂÇ®„ÄÇGet() Êìç‰ΩúÈ¶ñÂÖàÊ£ÄÊü• 0ÔΩûtimestamp Êó∂Èó¥ËåÉÂõ¥ÂÜÖÁöÑÈîÅÔºåÂ¶ÇÊûúÈîÅÂ≠òÂú®ÂÖ∂‰ªñ txn Ê≠£Âú®Âπ∂ÂèëÂÜôÊ≠§Â§ÑÁêÜÂçïÂÖÉ,‰ºöÁ≠âÂæÖÂà∞ÈáäÊîæ„ÄÇÂ¶ÇÊûúÊó†ÈîÅÂÜ≤Á™ÅÔºåGet() Ëé∑ÂèñÊúÄÊñ∞ Start Timestamp ÔºåÂπ∂‰∏îËøîÂõûÂÜôÁöÑËÆ∞ÂΩïË°å„ÄÇ</p>
<figure><img src="./Theory-PercolatorÂàÜÂ∏ÉÂºè‰∫ãÂä°/Percolator_architect.svg" alt="03" tabindex="0"><figcaption>03</figcaption></figure>
<h3 id="_2-3-mvcc-‰∏é-write-skew" tabindex="-1">2.3 MVCC ‰∏é Write Skew <a class="header-anchor" href="#_2-3-mvcc-‰∏é-write-skew" aria-label="Permalink to &quot;2.3 MVCC ‰∏é Write Skew&quot;"></a></h3>
<h4 id="_2-3-1-Âø´ÁÖßÈöîÁ¶ªÂèØËßÅÊÄß" tabindex="-1">2.3.1 Âø´ÁÖßÈöîÁ¶ªÂèØËßÅÊÄß <a class="header-anchor" href="#_2-3-1-Âø´ÁÖßÈöîÁ¶ªÂèØËßÅÊÄß" aria-label="Permalink to &quot;2.3.1 Âø´ÁÖßÈöîÁ¶ªÂèØËßÅÊÄß&quot;"></a></h4>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Âø´ÁÖßÈöîÁ¶ªÁ∫ßÂà´‰ª• start timestamp ‰∏∫‰∫ãÂä°ËØªËµ∑ÁÇπÔºå‰ª• commit timestamp ‰∏∫‰∫ãÂä°ÁªàÁÇπ„ÄÇ‰∏éÂèØÂ∫èÂàóÂåñÂçèËÆÆÁõ∏ÊØîÔºåÂø´ÁÖßÈöîÁ¶ªÁöÑ‰∏ªË¶Å‰ºòÁÇπÊòØËØªÂèñÊïàÁéáÊõ¥È´ò„ÄÇÂõ†‰∏∫‰ªª‰ΩïÊó∂Èó¥Êà≥ÈÉΩ‰ª£Ë°®‰∏ÄËá¥ÁöÑÂø´ÁÖßÔºåÊâÄ‰ª•ËØªÂèñÂçïÂÖÉÊ†ºÂè™ÈúÄË¶ÅÂú®ÁªôÂÆöÁöÑÊó∂Èó¥Êà≥ÊâßË°å Bigtable Êü•Êâæ‰æøÂèØÔºåÊü•ËØ¢ÈîÅÊòØ‰∏çÂøÖË¶ÅÁöÑ„ÄÇ</p>
<ol>
<li>txn 2 Âú® txn 1 ÂêéÂºÄÂêØÔºåÂ¶ÇÊûú txn 2 ‰∏ç commit Âàô‰∏ç‰ºöÁúãÂà∞ txn1 ÂÜôÁöÑÊï∞ÊçÆÔºõ</li>
<li>txn 1 Âíå txn 2 Âπ∂Ë°åÊâßË°åÔºåÂ¶ÇÊûúÂ≠òÂú®Áõ∏ÂêåÂøÖ‰ºöÊúâÂÖ∂‰∏≠‰∏Ä‰∏™ txn ÊâßË°åÂ§±Ë¥•Ôºõ</li>
<li>txn 3 Âç≥‰ºöÁúãÂà∞ txn 1 ,‰πü‰ºöÁúãÂà∞ txn 2Ôºõ</li>
</ol>
<figure><img src="./Theory-PercolatorÂàÜÂ∏ÉÂºè‰∫ãÂä°/isolation_tso.svg" alt="isolation_tso" tabindex="0"><figcaption>isolation_tso</figcaption></figure>
<h4 id="_2-3-2-Âø´ÁÖßÈöîÁ¶ªÂÜôÂÄæÊñú" tabindex="-1">2.3.2 Âø´ÁÖßÈöîÁ¶ªÂÜôÂÄæÊñú <a class="header-anchor" href="#_2-3-2-Âø´ÁÖßÈöîÁ¶ªÂÜôÂÄæÊñú" aria-label="Permalink to &quot;2.3.2 Âø´ÁÖßÈöîÁ¶ªÂÜôÂÄæÊñú&quot;"></a></h4>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Âú∫ÊôØÂÅáËÆæÂ¶Ç‰∏ãÔºö Jan_1 Âíå Jan_2 ÂùáÂÄºÁè≠‰ªäÂ§©ÁöÑ DBNEST Oncall Êó∂Èó¥ÔºåÂπ∂‰∏î Jan_1 Âíå Jan_2 ÂêåÊó∂Êúâ‰∫ãÈúÄË¶ÅÁî≥ËØ∑Ë∞ÉÁè≠ txn „ÄÇ Âπ∂ÂèëËæÉÈ´òÊó∂ÔºåÊûÅÊòì‰∫ßÁîüÊó†‰∫∫ÂÄºÁè≠ÊÉÖÂÜµ„ÄÇÂèØ‰ª•‰ΩøÁî®Ë°åÈîÅÊñπÂºèËß£ÂÜ≥Ôºå‰ΩÜ‰πü‰ºö‰∫ßÁîüÊÄßËÉΩÈôç‰Ωé„ÄÇ</p>
<p><strong>Txn 1 Jan_1:</strong></p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">//</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Êü•ËØ¢ BNEST Oncall ÊúâÂ§öÂ∞ë‰∫∫ÂÄºÁè≠Ôºü</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> COUNT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> oncall_members </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> shift_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 123456</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> AND</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> on_call </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> true;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">//</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ‰∫∫Êï∞ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, Êõ¥Êñ∞Ë∞ÉÁè≠</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">UPDATE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> oncall_members </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">SET</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> on_call </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> false </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">WHERE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> name=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'Jan_1'</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> AND</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> shift_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 123456</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span></code></pre>
</div><p><strong>Txn 2 Jan_2:</strong></p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">//</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Êü•ËØ¢ BNEST Oncall ÊúâÂ§öÂ∞ë‰∫∫ÂÄºÁè≠Ôºü</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> COUNT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> oncall_members </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> shift_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 123456</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> AND</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> on_call </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> true;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">//</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ‰∫∫Êï∞ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, Êõ¥Êñ∞Ë∞ÉÁè≠</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">UPDATE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> oncall_members </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">SET</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> on_call </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> false </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">WHERE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> name=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'Jan_2'</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> AND</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> shift_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 123456</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span></code></pre>
</div><h3 id="_2-4-percolator-‰∏§Èò∂ÊÆµÊèê‰∫§" tabindex="-1">2.4 Percolator ‰∏§Èò∂ÊÆµÊèê‰∫§ <a class="header-anchor" href="#_2-4-percolator-‰∏§Èò∂ÊÆµÊèê‰∫§" aria-label="Permalink to &quot;2.4 Percolator ‰∏§Èò∂ÊÆµÊèê‰∫§&quot;"></a></h3>
<h4 id="_2-4-1-È¢ÑÂÜôÂÖ•Èò∂ÊÆµ" tabindex="-1">2.4.1 È¢ÑÂÜôÂÖ•Èò∂ÊÆµ <a class="header-anchor" href="#_2-4-1-È¢ÑÂÜôÂÖ•Èò∂ÊÆµ" aria-label="Permalink to &quot;2.4.1 È¢ÑÂÜôÂÖ•Èò∂ÊÆµ&quot;"></a></h4>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ËØ•Èò∂ÊÆµ‰ºöÈîÅ‰ΩèÂ§ÑÁêÜÂçïÂÖÉ‰∏≠ÊâÄÊúâË°åÔºåÂú®ÂÆ¢Êà∑Á´ØËÆæËÆ°‰∏ªÈîÆÈîÅÔºàÂêéÊñáËØ¶Ëß£ÔºâÔºå‰∫ãÂä°ÈòÖËØªÂÖÉÊï∞ÊçÆ‰ø°ÊÅØÊ£ÄÊü•ÊòØÂê¶Â≠òÂú®Ë°åÂ§ÑÁêÜÂÜ≤Á™ÅÔºåÊúâ 3 ÁßçÂ§ÑÁêÜÊÉÖÂÜµÔºö</p>
<ol>
<li>ÂÜôÂÜôÂÜ≤Á™ÅÔºöÂ¶ÇÊûú txn 1 ÂèëÁé∞ÂÖ∂‰ªñ txn ÁöÑ Start Timestamp Âú® txn 1 ‰πãÂêéÁöÑÈîÅÔºåÂàô‰∫ãÂä°Â¥©Ê∫ÉÂõûÊªöÔºõ</li>
<li>ÈîÅÈáäÊîæÊÖ¢ÔºöÂ¶ÇÊûú txn 1 ÁúãÂà∞ÂÖ∂‰ªñ txn ‰ªª‰Ωï Start Timestamp ÁöÑÈîÅÔºåÂàô‰∫ãÂä°Â¥©Ê∫ÉÂõûÊªöÔºõ</li>
<li>Ê≠£Â∏∏Â§ÑÁêÜÔºöÂ¶ÇÊûú txn 1 Êú™ÂèëÁé∞‰ªª‰ΩïÂÜ≤Á™ÅÔºå‰æø‰ª•Ëá™Â∑±ÁöÑ Start Timestamp ËøõË°åÂÜôÈîÅ„ÄÅÂÜôÊï∞ÊçÆÂ§ÑÁêÜÔºõ</li>
</ol>
<h4 id="_2-4-2-Êèê‰∫§Èò∂ÊÆµ" tabindex="-1">2.4.2 Êèê‰∫§Èò∂ÊÆµ <a class="header-anchor" href="#_2-4-2-Êèê‰∫§Èò∂ÊÆµ" aria-label="Permalink to &quot;2.4.2 Êèê‰∫§Èò∂ÊÆµ&quot;"></a></h4>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Êèê‰∫§Èò∂ÊÆµ‰∏ªË¶ÅÊìç‰ΩúÂ¶Ç‰∏ãÔºö</p>
<ol>
<li>ÂÆ¢Êà∑Á´ØÈ¶ñÂÖàËé∑Âèñ Commit TSO Âπ∂ÈáäÊîæ‰ª•‰∏ªÈîÆ‰∏∫‰∏≠ÂøÉÁöÑÈîÅÔºõ</li>
<li>Â∞ÜÂÜôÂ§ÑÁêÜÂØπÁî®Êà∑ÂèØËßÅÔºåÂÜôËÆ∞ÂΩïÂåÖÂê´‰∏Ä‰∏™ÊåáÈíàÊåáÂêë start Timestamp,‰ª•‰æøÂÖ∂‰ªñ‰∫ãÂä°ÂèØ‰ª•ËÉΩÂ§üÊâæÂà∞ÁúüÂÆûÊï∞ÊçÆÔºõ</li>
</ol>
<h3 id="_2-5-percolator-ÂàÜÂ∏ÉÂºè‰∫ãÂä°" tabindex="-1">2.5 Percolator ÂàÜÂ∏ÉÂºè‰∫ãÂä° <a class="header-anchor" href="#_2-5-percolator-ÂàÜÂ∏ÉÂºè‰∫ãÂä°" aria-label="Permalink to &quot;2.5 Percolator ÂàÜÂ∏ÉÂºè‰∫ãÂä°&quot;"></a></h3>
<h4 id="_2-5-1-ÂàÜÂ∏ÉÂºè‰∫ãÂä°‰∏é‰º†ÁªüÂπ∂Ë°å‰∫ãÂä°ÁöÑ‰∏çÂêå" tabindex="-1">2.5.1 ÂàÜÂ∏ÉÂºè‰∫ãÂä°‰∏é‰º†ÁªüÂπ∂Ë°å‰∫ãÂä°ÁöÑ‰∏çÂêå <a class="header-anchor" href="#_2-5-1-ÂàÜÂ∏ÉÂºè‰∫ãÂä°‰∏é‰º†ÁªüÂπ∂Ë°å‰∫ãÂä°ÁöÑ‰∏çÂêå" aria-label="Permalink to &quot;2.5.1 ÂàÜÂ∏ÉÂºè‰∫ãÂä°‰∏é‰º†ÁªüÂπ∂Ë°å‰∫ãÂä°ÁöÑ‰∏çÂêå&quot;"></a></h4>
<ol>
<li>‰º†ÁªüÂπ∂Ë°åÊï∞ÊçÆÂ∫ìËÆøÈóÆ‰ºöË¢´Áªü‰∏Ä‰∫ãÂä°ÁÆ°ÁêÜÂô®ÊéßÂà∂ÈõÜ‰∏≠ÊéßÂà∂ÔºåÁî±‰∫ãÂä°ÁÆ°ÁêÜÂô®ÊéßÂà∂Ëé∑ÂæóËÆøÈóÆÂ≠òÂÇ®Â±ÇÊï∞ÊçÆÁöÑÊùÉÈôêÔºõ</li>
<li>Percolator ‰∏≠ÊâÄÊúâËäÇÁÇπÂùáÁõ¥Êé•Ëé∑ÂèñÊï∞ÊçÆÔºåÊ≤°ÊúâÂæàÂ•ΩÁöÑÊñπÂºèÊà™Êñ≠ËÆøÈóÆÂπ∂ÂØπ‰∫ãÂä°Âä†ÈîÅÔºåÂõ†Ê≠§ÈîÅÂøÖÈ°ªÂú®Êú∫Âô®ÊïÖÈöúÊó∂‰πüÊåÅ‰πÖÂåñÂ≠òÂú®ÔºåÂ¶ÇÊûúÈîÅÂú®‰∏§Èò∂ÊÆµÊèê‰∫§Êó∂Ê∂àÂ§±ÔºåÈÇ£‰πàËØ¥ÊòéÂ∑≤ÁªèÂèëÁîü‰∫ÜÂÜ≤Á™ÅÔºõ</li>
</ol>
<h4 id="_2-5-2-percolator-ÈîÅËÆæËÆ°" tabindex="-1">2.5.2 Percolator ÈîÅËÆæËÆ° <a class="header-anchor" href="#_2-5-2-percolator-ÈîÅËÆæËÆ°" aria-label="Permalink to &quot;2.5.2 Percolator ÈîÅËÆæËÆ°&quot;"></a></h4>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‰ªéÈîÅÊ∏ÖÁêÜÊú∫Âà∂ËßíÂ∫¶ÁúãÔºåÈöæÁÇπÂú®‰∫é Percolator ÂèëËµ∑ txn A Ê∏ÖÁêÜ txn B Êó∂ÔºåÂøÖÈ°ªÂà§ÂÆö txn B ÊòØÂê¶ÁúüÁöÑÂ§±Ë¥•„ÄÇ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Percolator ÈíàÂØπ commit „ÄÅcleanup Êìç‰ΩúÔºåÂú®‰∫ãÂä°Â¢ûÂä†ÂçïÂÖÉÊ†ºÊ†áËØÜ‰ΩçÔºå‰πüË¢´Áß∞‰Ωú‰∏ªÈîÆÈîÅ„ÄÇ‰∏çÂêå‰∫ãÂä°ÊúâËá™Â∑±ÁöÑ‰∏ªÈîÆÈîÅÔºåÊâßË°å commit Âíå cleanup Êìç‰ΩúÊòØÊó∂ÔºåË¶Å‰øÆÊîπ‰∏ªÈîÆÈîÅ„ÄÇ<br>
<strong>ÈîÅÂÖÉÊï∞ÊçÆÊ†ºÂºè</strong></p>
<table tabindex="0">
<thead>
<tr>
<th>Column</th>
<th>Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>C:lock</td>
<td>Êú™Êèê‰∫§ txn Â∞Ü‰∏ªÈîÆ‰ΩçÁΩÆÂÜôÂÖ•Ê≠§Âàó</td>
</tr>
<tr>
<td>C:write</td>
<td>Â∑≤Êèê‰∫§ txn Â≠òÂÇ®Êï∞ÊçÆÁöÑÊó∂Èó¥Êà≥</td>
</tr>
<tr>
<td>C:data</td>
<td>Â≠òÂÇ®Êï∞ÊçÆÊú¨Ë∫´</td>
</tr>
<tr>
<td>C:notify</td>
<td>Â≠òÂÇ® hint Âî§Ëµ∑ observers ÁöÑ‰ø°ÊÅØ</td>
</tr>
<tr>
<td>C:ack_O</td>
<td>observers ÂºÄÂßãËøêË°åÂêéÔºåÂ≠òÂÇ®‰∏äÊ¨°ËøêË°åÊàêÂäüÁöÑÊó∂Èó¥Êà≥</td>
</tr>
</tbody>
</table>
<h4 id="_2-5-3-percolator-‰∫ãÂä°Â§ÑÁêÜÊµÅÁ®ã" tabindex="-1">2.5.3 Percolator ‰∫ãÂä°Â§ÑÁêÜÊµÅÁ®ã <a class="header-anchor" href="#_2-5-3-percolator-‰∫ãÂä°Â§ÑÁêÜÊµÅÁ®ã" aria-label="Permalink to &quot;2.5.3 Percolator ‰∫ãÂä°Â§ÑÁêÜÊµÅÁ®ã&quot;"></a></h4>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Êú¨‰æã‰ª• Bob Âà∞ Joe ‰πãÈó¥ËΩ¨Ë¥¶‰∫§Êòì‰∏∫‰æãÔºåÊèèËø∞ Percolator ‰∫ãÂä°Âä†ÂáèÈîÅÊµÅÁ®ã„ÄÇ</p>
<ol>
<li>ÂàùÂßãÁä∂ÊÄÅÔºåJoe Ë¥¶Êà∑ 2 ÁæéÂÖÉÔºåBob Ë¥¶Êà∑ 10 ÁæéÂÖÉ„ÄÇ</li>
</ol>
<table tabindex="0">
<thead>
<tr>
<th>key</th>
<th>bal:data</th>
<th>bal:lock</th>
<th>bal:write</th>
</tr>
</thead>
<tbody>
<tr>
<td>Bob</td>
<td>6: <br/> 5:$10</td>
<td>6: <br/> 5:</td>
<td>6: data@5<br/> 5:</td>
</tr>
<tr>
<td>Joe</td>
<td>6: <br/> 5:$2</td>
<td>6: <br/> 5:</td>
<td>6: data@5<br/> 5:</td>
</tr>
</tbody>
</table>
<ol start="2">
<li>ËΩ¨Ë¥¶Á¨¨‰∏ÄÊ≠•ÔºåÂ∏¶Êñ∞Êó∂Èó¥Êà≥ 7 Âêë bal:lock ÂàóÂÜôÂÖ•Êï¥‰∏™‰∫ãÂä°‰∏ªÈîÆÈîÅÁöÑ‰ΩçÁΩÆ,‰πüÂ∞±ÊòØÂ§ÑÁêÜ Bob Ë°åÔºõ</li>
</ol>
<table tabindex="0">
<thead>
<tr>
<th>key</th>
<th>bal:data</th>
<th>bal:lock</th>
<th>bal:write</th>
</tr>
</thead>
<tbody>
<tr>
<td>Bob</td>
<td>7:$3 <br/> 6: <br/> 5:$10</td>
<td>7:I am primary location <br/>6: <br/> 5:</td>
<td>7: <br/>6: data@5<br/> 5:</td>
</tr>
<tr>
<td>Joe</td>
<td>6: <br/> 5:$2</td>
<td>6: <br/> 5:</td>
<td>6: data@5<br/> 5:</td>
</tr>
</tbody>
</table>
<ol start="3">
<li>ËΩ¨Ë¥¶Á¨¨‰∫åÊ≠•ÔºåÂ∞ÜÂ∏¶ÊúâÁõ∏ÂêåÊó∂Èó¥Êà≥ 7 ÁöÑÂÖ∂‰ªñË°åÔºå‰ª•ÊåáÈíàÁöÑÂΩ¢ÂºèÊåáÂêë Bob ÁöÑ‰∏ªÈîÆÈîÅ‰ΩçÁΩÆÔºåÂΩ¢ÊàêÂØπ‰∫ãÂä°‰∏≠ÊâÄÊúâË°åÁöÑÈîÅÂÆö„ÄÇ</li>
</ol>
<table tabindex="0">
<thead>
<tr>
<th>key</th>
<th>bal:data</th>
<th>bal:lock</th>
<th>bal:write</th>
</tr>
</thead>
<tbody>
<tr>
<td>Bob</td>
<td>7:$3 <br/> 6: <br/> 5:$10</td>
<td>7: I am primary location <br/>6: <br/> 5:</td>
<td>7: <br/>6: data@5<br/> 5:</td>
</tr>
<tr>
<td>Joe</td>
<td>7:$9 <br/> 6: <br/> 5:$2</td>
<td>7: primary@Bob.bal <br/> 6: <br/> 5:</td>
<td>7:<br/> 6: data@5<br/> 5:</td>
</tr>
</tbody>
</table>
<ol start="4">
<li>ËΩ¨Ë¥¶Á¨¨‰∏âÊ≠•Ôºå‰∫ãÂä°ËøõÂÖ•Êèê‰∫§Èò∂ÊÆµÔºåÂ∏¶ÊúâÊñ∞Êó∂Èó¥Êà≥ 8 ÂÜôÂÖ•‰∏ÄÊù°Êñ∞‰ø°ÊÅØÊì¶Èô§‰∏ªÈîÆÈîÅÔºåbal:write ÂåÖÂê´ÊúÄËøë commit ÁöÑÊó∂Èó¥Êà≥ÔºåÂÖ∂‰ªñ‰∫ãÂä°‰πü‰ºöÁúãËßÅÊ≠§‰∫ãÂä°ÊâÄÂÜôÂÜÖÂÆπ„ÄÇ</li>
</ol>
<table tabindex="0">
<thead>
<tr>
<th>key</th>
<th>bal:data</th>
<th>bal:lock</th>
<th>bal:write</th>
</tr>
</thead>
<tbody>
<tr>
<td>Bob</td>
<td>8:  <br/> 7:$3 <br/> 6: <br/> 5:$10</td>
<td>8:  <br/> 7:  <br/>6: <br/> 5:</td>
<td>8: data@7<br/> 7: <br/>6: data@5<br/> 5:</td>
</tr>
<tr>
<td>Joe</td>
<td>7:$9 <br/> 6: <br/> 5:$2</td>
<td>7: primary@Bob.bal<br/> 6: <br/> 5:</td>
<td>7:<br/> 6: data@5<br/> 5:</td>
</tr>
</tbody>
</table>
<ol start="4">
<li>ÊúÄÂêéÔºåÂú® Bob ÁöÑ bal:write ÂàóÂÜôÂÖ•‰∫ãÂä°Êèê‰∫§Êó∂Èó¥Êà≥ÔºåÂπ∂Êì¶Âá∫ÊåáÂêëÂéüÊúâ‰∏ªÈîÆÈîÅÁöÑÊ¨°Á∫ßË°åÈîÅ„ÄÇ</li>
</ol>
<table tabindex="0">
<thead>
<tr>
<th>key</th>
<th>bal:data</th>
<th>bal:lock</th>
<th>bal:write</th>
</tr>
</thead>
<tbody>
<tr>
<td>Bob</td>
<td>8:  <br/> 7:$3 <br/> 6: <br/> 5:$10</td>
<td>8:  <br/> 7:  <br/>6: <br/> 5:</td>
<td>8: data@7<br/> 7: <br/>6: data@5<br/> 5:</td>
</tr>
<tr>
<td>Joe</td>
<td>8:  <br/>7:$9 <br/> 6: <br/> 5:$2</td>
<td>8:  <br/> 7: <br/> 6: <br/> 5:</td>
<td>8: data@7<br/>7:<br/> 6: data@5<br/> 5:</td>
</tr>
</tbody>
</table>
<h4 id="_2-5-2-‰∫ãÂä°ÁöÑÈîôËØØÂ§ÑÁêÜ" tabindex="-1">2.5.2 ‰∫ãÂä°ÁöÑÈîôËØØÂ§ÑÁêÜ <a class="header-anchor" href="#_2-5-2-‰∫ãÂä°ÁöÑÈîôËØØÂ§ÑÁêÜ" aria-label="Permalink to &quot;2.5.2 ‰∫ãÂä°ÁöÑÈîôËØØÂ§ÑÁêÜ&quot;"></a></h4>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ê∏ÖÁêÜ‰∏ªÈîÅÊòØÂêåÊ≠•Êìç‰ΩúÔºåÊâÄ‰ª•Ê∏ÖÁêÜÊ¥ªÂä®ÂÆ¢Êà∑Á´ØÊåÅÊúâÁöÑÈîÅÊòØÂÆâÂÖ®ÁöÑÔºå‰ΩÜÂõûÊªöÂ∞ÜËø´‰Ωø‰∫ãÂä°‰∏≠Ê≠¢Ôºå‰ºö‰∫ßÁîüÊÄßËÉΩÈóÆÈ¢ò„ÄÇÂΩì‰∫ãÂä°Ê≠£Âú®Êèê‰∫§Êó∂ÂÆ¢Êà∑Á´ØÂ¥©Ê∫ÉÔºåÈîÅ‰∏ç‰ºöÊ∏ÖÈô§Ôºå‰æùÊóßÊåÅ‰πÖÂåñÂú® tablet server ‰∏≠„ÄÇ‰∏∫Èôç‰ΩéÊ∏ÖÈîÅÂØπÊÄßËÉΩÈÄ†ÊàêÂΩ±ÂìçÔºåÈùûÈòªÂ°ûÂΩìÂâç worker ËøêË°åÊàñÊ≠ªÈîÅÊÉÖÂÜµ‰∏ã‰∏ç‰ºö‰∏ªÂä®Ê∏ÖÁêÜÊÆãÁïôÈîÅÔºåÂêåÊó∂ÂºïÂÖ•‚Äú‰ª§Áâå‚Äù„ÄÅ‚ÄúË∂ÖÊó∂‚Äù Ë°•ÂÖÖÊ∏ÖÈîÅÊÉÖÂÜµ„ÄÇ</p>
<ol>
<li>ÂºïÂÖ• ‚Äú‰ª§Áâå‚Äù ‰ΩøÁî® worker Âêë Chubby ÂÜôÂÖ• tokenÔºå Ë°®ÊòéÊâÄÂ±û‰∫éÁ≥ªÁªüÂèäÂ≠òÊ¥ªÁä∂ÊÄÅÔºåtoken Âú®ËøõÁ®ãÈÄÄÂá∫Êó∂Ëá™Âä®Âà†Èô§„ÄÇ</li>
<li>ÂºïÂÖ• ‚ÄúË∂ÖÊó∂‚Äù Á°Æ‰øùÂç≥‰Ωø worker ÁöÑ token ÊúâÊïàÔºåÂ§™‰πÖÁöÑÈîÅ‰πü‰ºöË¢´Ê∏ÖÈô§„ÄÇ</li>
</ol>
<p><strong>ÈîÅÈáäÊîæÊ≠•È™§Ôºö</strong></p>
<ol>
<li>txn B Êèê‰∫§Ââç, ÂøÖÈ°ªÊ£ÄÊü•ÊòØÂê¶‰ªçÁÑ∂ÊåÅÊúâ‰∏ªÈîÆÈîÅÔºõ</li>
<li>txn A Ê∏ÖÈô§ txn B ÊÆãÁïôÈîÅÂâçÔºåtxn A ÂøÖÈ°ªÁ°Æ‰øù txn B ÁöÑ‰∏ªÈîÆÈîÅÊ≤°ÊúâË¢´Êèê‰∫§Ôºõ</li>
<li>ÂΩìÂÆ¢Êà∑Á´Ø commit Èò∂ÊÆµÂ¥©Ê∫ÉÊó∂ÔºåÂ¶ÇÊûúÂÆ¢Êà∑Á´ØÂ∑≤ÂèëËµ∑ commit Âπ∂‰ª•‰øÆÊîπÊï∞ÊçÆÔºåÂøÖÈ°ªÂâçÊªöÊÅ¢Â§çÊï∞ÊçÆÔºõÂÖ∂‰ªñÊÉÖÂÜµÂõûÊªöÊï∞ÊçÆ„ÄÇËØ¶ÊÉÖÂ¶Ç‰∏ã:
3.1 Á¨¨‰∏ÄÁßçÊÉÖÂÜµÔºöÂ¶ÇÊûú‰∏ªÈîÆÂ∑≤ÁªèÊõ¥Êç¢‰∏∫ÂÖ∂‰ªñËÆ∞ÂΩï, ËØ¥ÊòéÂÜôÈîÅÁöÑ‰∫ãÂä°Â∑≤ÁªèÊèê‰∫§ÔºåÂâçÊªö‰∫ãÂä°Âç≥ÂèØÔºõ
3.2 ÂÖ∂‰ªñÊÉÖÂÜµÔºöÁõ¥Êé•Â∞Ü txn A ÂÜôÂÖ• txn B ‰∏ªÈîÆÈîÅË°åÂõûÊªö txn B ‰æøÂèØÔºåÂõ†‰∏∫‰∫ãÂä°Êèê‰∫§‰ºöÈ¶ñÂÖàÈáäÊîæ‰∏ªÈîÆÈîÅÔºõ</li>
</ol>
<h3 id="_2-4-percolator-Áé∞Â≠òÈóÆÈ¢ò" tabindex="-1">2.4 Percolator Áé∞Â≠òÈóÆÈ¢ò <a class="header-anchor" href="#_2-4-percolator-Áé∞Â≠òÈóÆÈ¢ò" aria-label="Permalink to &quot;2.4 Percolator Áé∞Â≠òÈóÆÈ¢ò&quot;"></a></h3>
<ol>
<li>PRC ÊÄßËÉΩÔºöÁõ∏ËæÉ mapreduce ËæÉ‰ΩéÊïàÁéáÁöÑÊòØÊØè‰∏™Â∑•‰ΩúÂçïÂÖÉÂèëÈÄÅÁöÑ rpc Êï∞ÈáèÔºåMapReduce ÂØπ GFS ËøõË°å‰∏ÄÊ¨°Â§ßÁöÑËØªÂèñÔºåËé∑Âèñ 10 ÔΩû 100 ‰∏™ÁΩëÈ°µÁöÑÊâÄÊúâÊï∞ÊçÆÔºåËÄå Percolator ÊâßË°åÂ§ßÁ∫¶ 50 ‰∏™ÂçïÁã¨ÁöÑ Bigtable Rpc Êìç‰ΩúÊù•Â§ÑÁêÜ‰∏Ä‰∏™ÊñáÊ°£ÔºåÂêûÂêêÂ≠òÂú®ÈóÆÈ¢ò„ÄÇ</li>
<li>ÂÜôÈîÅÊó∂Âª∂ÔºöÊØèÊ¨°ÂÜôÈîÅÂøÖÈ°ªÊâßË°åËØª„ÄÅ‰øÆÊîπ„ÄÅÂÜô‰∏â‰∏™Êìç‰ΩúÔºåÈúÄË¶Å‰∏é Bigtable ‰∏§Ê¨° rpc ‰∫§‰∫í : ‰∏ÄÊ¨°Áî®‰∫éËØªÂèñÂÜ≤Á™ÅÈîÅÔºå‰∏ÄÊ¨°Áî®‰∫éÂÜôÂÖ•Êñ∞ÈîÅ„ÄÇ
2.1 ‰ºòÂåñ‰∏Ä ÊâπÈáèÔºöËôΩÁÑ∂Áõ∏Âêå Tablet server ÁöÑÂÜôÈîÅÊìç‰ΩúÂèØ‰ª• batch Â§ÑÁêÜÔºå‰ΩÜÈ´òÂπ∂Âèë‰∏ãËØ•ÈóÆÈ¢òËæÉ‰∏∫ÊòéÊòæ„ÄÇ
2.2 ‰ºòÂåñ‰∫å È¢ÑÂèñÔºöÂü∫‰∫éËØª‰∏ÄË°å‰∏éËØªÂèñ‰∏§‰∏™ÊàñÂ§ö‰∏™ÂÄºÁöÑÊàêÊú¨Âü∫Êú¨Áõ∏ÂêåÔºåÈ¢ÑÂèñ‰∏éÁºìÂ≠òÁªìÂêàÂèØ‰ª•ÂáèÂ∞èËØª Bigtable ÁöÑÊ¨°Êï∞ 10 ÂÄç„ÄÇ</li>
</ol>
<h2 id="‰∏â„ÄÅÊÄßËÉΩ‰∏éÊú™Êù•" tabindex="-1">‰∏â„ÄÅÊÄßËÉΩ‰∏éÊú™Êù• <a class="header-anchor" href="#‰∏â„ÄÅÊÄßËÉΩ‰∏éÊú™Êù•" aria-label="Permalink to &quot;‰∏â„ÄÅÊÄßËÉΩ‰∏éÊú™Êù•&quot;"></a></h2>
<p><strong>ÊÄßËÉΩ</strong>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Google ÈÄöËøáÂª∫Á´ãÂíåÈÉ®ÁΩ≤ PercolatorÔºåËá™2010Âπ¥4Êúà‰ª•Êù•Áî®‰∫éÂà∂‰ΩúË∞∑Ê≠åÁöÑÁΩëÁªúÊêúÁ¥¢Á¥¢ÂºïÂÆûÁé∞‰∫ÜÂáèÂ∞ëÁ¥¢ÂºïÂçï‰∏™ÊñáÊ°£ÁöÑÂª∂ËøüÁöÑÁõÆÊ†á„ÄÇÂêåÊó∂Ôºå‰∏∫‰∫ÜÂú®Êõ¥ÂÆûÈôÖÁöÑÂ∑•‰ΩúË¥üËΩΩ‰∏äËØÑ‰º∞ Percolator ÂÆûÁé∞‰∫ÜÂü∫‰∫é TPC-EÔºàTPC-E Ê®°Êãü‰∫Ü‰∏Ä‰∏™ÁªèÁ∫™ÂÖ¨Âè∏ÔºåÂÆ¢Êà∑ÊâßË°å‰∫§Êòì„ÄÅÂ∏ÇÂú∫ÊêúÁ¥¢ÂíåÂ∏êÊà∑Êü•ËØ¢Ôºâ ÁöÑÂü∫ÂáÜÊµãËØïÁªìÊûú‰∏∫Êú™Êù•ÁöÑÁ†îÁ©∂Êèê‰æõ‰∫ÜÊñ∞ÁöÑÂâçÊôØÊñπÂêë„ÄÇÊµãËØïÁªìÊûúÂπ≥Âùá‰∫ãÂä°Âª∂ËøüÊòØ2Âà∞5ÁßíÔºåÂºÇÂ∏∏ÂÄºÂèØËÉΩÈúÄË¶ÅÂá†ÂàÜÈíü„ÄÇ<br>
<strong>Êú™Êù•</strong></p>
<ol>
<li>Percolator ËøôÊ†∑ÁöÑÂ∑®Â§ßÊï∞ÊçÆÈõÜÂçï‰∏™ÂÖ±‰∫´ÂÜÖÂ≠òÊú∫Âô®Â∑≤Êó†Ê≥ïÂ§ÑÁêÜÔºåÈúÄË¶ÅÊâ©Â±ïÂà∞ 1000 Âè∞Êú∫Âô®ÁöÑÂàÜÂ∏ÉÂºèËß£ÂÜ≥ÊñπÊ°àÔºåÈÄöËøáÁâ∫Áâ≤Âπ∂Ë°åÊï∞ÊçÆÂ∫ìÁöÑÈÉ®ÂàÜÁÅµÊ¥ªÊÄßÂíå‰ΩéÂª∂ËøüÔºåÊèê‰æõ‰∫Ü‰∏Ä‰∏™Ë∂≥‰ª•ÈÄÇÂ∫î‰∫íËÅîÁΩëËßÑÊ®°ÁöÑÊï∞ÊçÆÈõÜÁöÑÁ≥ªÁªüÔºåËß£ÂÜ≥‰∫ÜÁé∞ÊúâÁöÑÂπ∂Ë°åÊï∞ÊçÆÂ∫ìÂè™ËÉΩÂà©Áî®100Âè∞Êú∫Âô®ÁöÑËäÇÁÇπÁì∂È¢à„ÄÇ</li>
<li>Percolator ÊòØ‰∏Ä‰∏™Êï∞ÊçÆËΩ¨Êç¢Á≥ªÁªüÔºåËÄå‰∏ç‰ªÖ‰ªÖÊòØ‰∏Ä‰∏™Êï∞ÊçÆÂ≠òÂÇ®Á≥ªÁªüÔºå‰∏é NewSQL„ÄÅRocksDB Á≠âÈ´òÊïàÂ≠òÂÇ®ÂºïÊìéÁªÑÂêàÂú®‰∏ÄËµ∑Ôºå‰ºöÊØî‰º†ÁªüÊï∞ÊçÆÂ∫ìÊèê‰æõÊõ¥È´òÁöÑÊÄßËÉΩÂíåÊõ¥Â•ΩÁöÑ‰º∏Áº©ÊÄß„ÄÇ</li>
</ol>
<h2 id="Âõõ„ÄÅÂèÇËÄÉÊñáÁ´†" tabindex="-1">Âõõ„ÄÅÂèÇËÄÉÊñáÁ´† <a class="header-anchor" href="#Âõõ„ÄÅÂèÇËÄÉÊñáÁ´†" aria-label="Permalink to &quot;Âõõ„ÄÅÂèÇËÄÉÊñáÁ´†&quot;"></a></h2>
<p><a href="http://notes.stephenholiday.com/Percolator.pdf" target="_blank" rel="noreferrer">Paper -- Large-scale Incremental Processing
Using Distributed Transactions and Notifications</a>
<a href="https://pingcap.com/zh/blog/percolator-and-txn" target="_blank" rel="noreferrer">PingCAP Blog -- Percolator Âíå TiDB ‰∫ãÂä°ÁÆóÊ≥ï</a></p>
]]></content:encoded>
            <enclosure url="https://askaric.com/Theory-Percolator%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1/Percolator_overview.svg" length="0" type="image/svg"/>
        </item>
        <item>
            <title><![CDATA[How to build logical plan]]></title>
            <link>https://askaric.com/en/work/tidb/TiDB-Principle/TiDB Optimizer/03How to build logical plan.html</link>
            <guid>https://askaric.com/en/work/tidb/TiDB-Principle/TiDB Optimizer/03How to build logical plan.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[1. One SQL'll be translated into AST
note : pic from PingCAP website
From the pic above, SQL operate]]></description>
            <content:encoded><![CDATA[<h1 id="how-to-build-logical-plan" tabindex="-1">How to build logical plan <a class="header-anchor" href="#how-to-build-logical-plan" aria-label="Permalink to &quot;How to build logical plan&quot;"></a></h1>
<h2 id="_1-one-sql-ll-be-translated-into-ast" tabindex="-1">1. One SQL'll be translated into AST <a class="header-anchor" href="#_1-one-sql-ll-be-translated-into-ast" aria-label="Permalink to &quot;1. One SQL'll be translated into AST&quot;"></a></h2>
<p><img src="https://pic4.zhimg.com/80/v2-ada27a924bb54e304da9811094eacacf_1440w.webp" alt="overview-tidb-architecture">
note : pic from PingCAP website</p>
<p>From the pic above, SQL operateing processing can be seen as <strong>&quot;SQL(Client) --&gt; AST(Parser) --&gt; Logical Plan(Logical Optimzier) --&gt; Physical Plan(Physical Optimzier) --&gt; Execution(Executior) --&gt; Data(TiDB server return)&quot;</strong>. This part'll foucs on <strong>&quot;AST --&gt; Logical Plan&quot;</strong>.</p>
<p>So, <a href="https://github.com/pingcap/tidb/blob/eb35c773b512e4e00c42caf7f04ea7397d00c127/planner/core/planbuilder.go#L489" target="_blank" rel="noreferrer">PlanBuilder</a> builds Plan from an ast.Node, the one is partal of Logical Plan and different type of SQLs are dealed in different paths at <a href="https://github.com/pingcap/tidb/blob/eb35c773b512e4e00c42caf7f04ea7397d00c127/planner/core/planbuilder.go#L779" target="_blank" rel="noreferrer">func Build</a>.</p>
<h2 id="_2-123" tabindex="-1">2. 123 <a class="header-anchor" href="#_2-123" aria-label="Permalink to &quot;2. 123&quot;"></a></h2>
]]></content:encoded>
            <enclosure url="https://pic4.zhimg.com/80/v2-ada27a924bb54e304da9811094eacacf_1440w.webp" length="0" type="image/webp"/>
        </item>
        <item>
            <title><![CDATA[What's Logical Optimizing in TiDB]]></title>
            <link>https://askaric.com/en/work/tidb/TiDB-Principle/TiDB Optimizer/Logical Optimizing in TiDB.html</link>
            <guid>https://askaric.com/en/work/tidb/TiDB-Principle/TiDB Optimizer/Logical Optimizing in TiDB.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[# What's Logical Optimizing in TiDB

## First of all

Actually, every logical rule struct has a method named `optimize()`

## rules of logical

From [here](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/optimizer.go#L597), we can see logical optimizing items will be applied one by one.  

```go
var optRuleList = []logicalOptRule{
 &gcSubstituter{},
 &columnPruner{},
 &resultReorder{},
 &buildKeySolver{},
 &decorrelateSolver{},
 &semiJoinRewriter{},
 &aggregationEliminator{},
 &skewDistinctAggRewriter{},
 &projectionEliminator{},
 &maxMinEliminator{},
 &ppdSolver{},
 &outerJoinEliminator{},
 &partitionProcessor{},
 &collectPredicateColumnsPoint{},
 &aggregationPushDownSolver{},
 &pushDownTopNOptimizer{},
 &syncWaitStatsLoadPoint{},
 &joinReOrderSolver{},
 &columnPruner{}, // column pruning again at last, note it will mess up the results of buildKeySolver
}
```

## gcSubstituter

By [mysql reference](https://dev.mysql.com/doc/refman/8.0/en/generated-column-index-optimizations.html) of `Generated Column(in short: gc)`, we can see what the function of gc is. And from [here](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/rule_generate_column_substitute.go#L97), you can figure out how tidb implment `gc` in period of logical plan. There are four parts of operands, (Selection, Projection, Sort, Aggregation), will subtitute gc as index.

1. LogicalSelection:  

    LogicalSelection represents a where or having predicate.
    firstly, in generated column function, index wouldn't none. Because of every calculating is based on index expression.
    secondly, when predicate operands are `=`, `>`, `>=`, `<`, `<=`, `like`, `or`, `and`, `not`. TiDB'll deal with it using generated column.  However, when predicate is `in`, there is a limition that all of scalars are the same type.  

2. LogicalProjection:

    LogicalProjection represents a select fields plan and TiDB'll loop every field(selected colums from SQL) and try subsitiuting generated column.  

3. LogicalSort:  

    LogicalSort stands for the order by plan. if there are any `sort` item in a query.

4. LogicalAggregation:

    LogicalAggregation represents an aggregate plan. And all agg functions are [here](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/parser/ast/functions.go#L701). if there any field could be subtitiuted into one genereated colum, it'd be done.

    ```go
    // AggFuncCount is the name of Count function.
    AggFuncCount = "count"
    // AggFuncSum is the name of Sum function.
    AggFuncSum = "sum"
    // AggFuncAvg is the name of Avg function.
    AggFuncAvg = "avg"
    // AggFuncFirstRow is the name of FirstRowColumn function.
    AggFuncFirstRow = "firstrow"
    // AggFuncMax is the name of max function.
    AggFuncMax = "max"
    // AggFuncMin is the name of min function.
    AggFuncMin = "min"
    // AggFuncGroupConcat is the name of group_concat function.
    AggFuncGroupConcat = "group_concat"
    // AggFuncBitOr is the name of bit_or function.
    AggFuncBitOr = "bit_or"
    // AggFuncBitXor is the name of bit_xor function.
    AggFuncBitXor = "bit_xor"
    // AggFuncBitAnd is the name of bit_and function.
    AggFuncBitAnd = "bit_and"
    // AggFuncVarPop is the name of var_pop function
    AggFuncVarPop = "var_pop"
    // AggFuncVarSamp is the name of var_samp function
    AggFuncVarSamp = "var_samp"
    // AggFuncStddevPop is the name of stddev_pop/std/stddev function
    AggFuncStddevPop = "stddev_pop"
    // AggFuncStddevSamp is the name of stddev_samp function
    AggFuncStddevSamp = "stddev_samp"
    // AggFuncJsonArrayagg is the name of json_arrayagg function
    AggFuncJsonArrayagg = "json_arrayagg"
    // AggFuncJsonObjectAgg is the name of json_objectagg function
    AggFuncJsonObjectAgg = "json_objectagg"
    // AggFuncApproxCountDistinct is the name of approx_count_distinct function.
    AggFuncApproxCountDistinct = "approx_count_distinct"
    // AggFuncApproxPercentile is the name of approx_percentile function.
    AggFuncApproxPercentile = "approx_percentile"
    ```

## columnPruner

1. Actually, there are too many operands implmented `pruneCoumns`, you can PTAL at [it's interface](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan.go#L258). After parsing AST, TiDB has already had a basic logic plan and column info without any tuning, when we step in here. I'll choose `LogicalSelection` which is one of the easiest to take a look deeply.  
2. That just deals with every column selected in sql or filterd in predicate and prunes part of columns which don't need. In `LogicalSelection`, as result of `func filter` is nil, so result is equal to columns selected plus predicate for filtering.

    ```go
    func extractColumns(result []*Column, expr Expression, filter func(*Column) bool) []*Column {
     switch v := expr.(type) {
     case *Column:
      if filter == nil || filter(v) {
       result = append(result, v)
      }
     case *ScalarFunction:
      for _, arg := range v.GetArgs() {
       result = extractColumns(result, arg, filter)
      }
     }
     return result
    }
    ```

## resultReorder

1. ResultReorder reorder query results, which is not a common rule for all queries, it's specially implemented for a few customers. And here is a short comment in code place.  

    ```go
    /*
    Results of some queries are not ordered, for example:

        create table t (a int); insert into t values (1), (2); select a from t;

    In the case above, the result can be `1 2` or `2 1`, which is not ordered.
    This rule reorders results by modifying or injecting a Sort operator:
     1. iterate the plan from the root, and ignore all input-order operators (Sel/Proj/Limit);
     2. when meeting the first non-input-order operator,
        2.1. if it's a Sort, update it by appending all output columns into its order-by list,
        2.2. otherwise, inject a new Sort upon this operator.
    */
    ```

2. At [here](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/rule_result_reorder.go#L43), based on the such clear comment, TiDB'll do `1`, `2.1` and `2.2` by `func completeSort` and `func injectSort`. PTAL at [#pr](https://github.com/pingcap/tidb/pull/25971) for details.

## buildKeyInfo

BuildKeyInfo as their name will collect the information of unique keys into schema(`selfSchema` and `childSchema`) and check keys of schema from query input coule be used. in addition, that to check if a query returns no more than one row is also an important action inside of this step. [more details](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan.go#L274)

## decorrelateSolver

1. what's apply? from comments, `LogicalApply` gets one row from outer executor and gets one row from inner executor according to outer row.  
2. which means, there wouldn't have optimization without `Apply` operand logic.
3. if `innerPlan` is `LogicalSelection`, action is set new apply-plan children and reoptimize it using the same `decorrelateSolver` rule, you can see [here](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/rule_decorrelate.go#L150).
4. if `innerPlan` is `LogicalMaxOneRow`, action is the same as `LogicalSelection`.
5. if `innerPlan` is `LogicalProjection` and `JoinType` is `LeftOuterJoin`, action is it doesn't have optimization, because of below comments, every comparation will return 1 since the projection is evaluated after the join. And when an `Apply` is `apply.JoinType != SemiJoin && apply.JoinType != LeftOuterSemiJoin && apply.JoinType != AntiSemiJoin && apply.JoinType != AntiLeftOuterSemiJoin`, it'll step to next step and try to substitute the all the schema with new expressions which maybe have been optimized by `columnPruner`, which mainly it does is substitued all expressions or columns like `gcSubstitute`.
6. if `innerPlan` is `LogicalAggregation`,

    ```sql
    select (select 1 from t1 where t1.a=t2.a) from t2;
    -- when t1.a=t2.a is false, the result should be null
    -- after decorrelateSolver, it'll be a format below
    select t1.* from t2 left outer join (select distinct(t1.a) as a from t1) as sub on t2.a = sub.a;
    -- | t2.a |      | t1.a |        | t2.a | t1.a | join result |      | join result |
    -- |   1  | join |  0   |  -->   |   1  |   0  |     nll     | -->  | 1 | 1 |  1  |
    -- |   2  |      |  1   |        |   1  |   1  |      1      |
    --                               |   2  |   1  |     null    |
    --                               |   2  |   1  |     null    |
    ```

7. if `innerPlan` is `LogicalLimit` and `apply.JoinType != SemiJoin && apply.JoinType != LeftOuterSemiJoin && apply.JoinType != AntiSemiJoin && apply.JoinType != AntiLeftOuterSemiJoin`, that means if `LogicalLimit` is not SemiJoin, the output of it might be expanded even though we are `limit 1`. because of function of `semi join` below, if we did expanding, we'd get `semi join` the result of limit number of rows.

    ```sql
    select * from sale_detail;
    --ËøîÂõûÁªìÊûú„ÄÇ
    +]]></description>
            <content:encoded><![CDATA[<h1 id="what-s-logical-optimizing-in-tidb" tabindex="-1">What's Logical Optimizing in TiDB <a class="header-anchor" href="#what-s-logical-optimizing-in-tidb" aria-label="Permalink to &quot;What's Logical Optimizing in TiDB&quot;"></a></h1>
<h2 id="first-of-all" tabindex="-1">First of all <a class="header-anchor" href="#first-of-all" aria-label="Permalink to &quot;First of all&quot;"></a></h2>
<p>Actually, every logical rule struct has a method named <code>optimize()</code></p>
<h2 id="rules-of-logical" tabindex="-1">rules of logical <a class="header-anchor" href="#rules-of-logical" aria-label="Permalink to &quot;rules of logical&quot;"></a></h2>
<p>From <a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/optimizer.go#L597" target="_blank" rel="noreferrer">here</a>, we can see logical optimizing items will be applied one by one.</p>
<div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> optRuleList </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> []</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">logicalOptRule</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> &#x26;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">gcSubstituter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{},</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> &#x26;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">columnPruner</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{},</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> &#x26;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">resultReorder</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{},</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> &#x26;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">buildKeySolver</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{},</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> &#x26;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">decorrelateSolver</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{},</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> &#x26;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">semiJoinRewriter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{},</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> &#x26;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">aggregationEliminator</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{},</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> &#x26;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">skewDistinctAggRewriter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{},</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> &#x26;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">projectionEliminator</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{},</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> &#x26;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">maxMinEliminator</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{},</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> &#x26;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ppdSolver</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{},</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> &#x26;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">outerJoinEliminator</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{},</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> &#x26;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">partitionProcessor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{},</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> &#x26;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">collectPredicateColumnsPoint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{},</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> &#x26;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">aggregationPushDownSolver</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{},</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> &#x26;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">pushDownTopNOptimizer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{},</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> &#x26;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">syncWaitStatsLoadPoint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{},</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> &#x26;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">joinReOrderSolver</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{},</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> &#x26;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">columnPruner</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{}, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// column pruning again at last, note it will mess up the results of buildKeySolver</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
</div><h2 id="gcsubstituter" tabindex="-1">gcSubstituter <a class="header-anchor" href="#gcsubstituter" aria-label="Permalink to &quot;gcSubstituter&quot;"></a></h2>
<p>By <a href="https://dev.mysql.com/doc/refman/8.0/en/generated-column-index-optimizations.html" target="_blank" rel="noreferrer">mysql reference</a> of <code>Generated Column(in short: gc)</code>, we can see what the function of gc is. And from <a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/rule_generate_column_substitute.go#L97" target="_blank" rel="noreferrer">here</a>, you can figure out how tidb implment <code>gc</code> in period of logical plan. There are four parts of operands, (Selection, Projection, Sort, Aggregation), will subtitute gc as index.</p>
<ol>
<li>
<p>LogicalSelection:</p>
<p>LogicalSelection represents a where or having predicate.
firstly, in generated column function, index wouldn't none. Because of every calculating is based on index expression.
secondly, when predicate operands are <code>=</code>, <code>&gt;</code>, <code>&gt;=</code>, <code>&lt;</code>, <code>&lt;=</code>, <code>like</code>, <code>or</code>, <code>and</code>, <code>not</code>. TiDB'll deal with it using generated column.  However, when predicate is <code>in</code>, there is a limition that all of scalars are the same type.</p>
</li>
<li>
<p>LogicalProjection:</p>
<p>LogicalProjection represents a select fields plan and TiDB'll loop every field(selected colums from SQL) and try subsitiuting generated column.</p>
</li>
<li>
<p>LogicalSort:</p>
<p>LogicalSort stands for the order by plan. if there are any <code>sort</code> item in a query.</p>
</li>
<li>
<p>LogicalAggregation:</p>
<p>LogicalAggregation represents an aggregate plan. And all agg functions are <a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/parser/ast/functions.go#L701" target="_blank" rel="noreferrer">here</a>. if there any field could be subtitiuted into one genereated colum, it'd be done.</p>
<div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// AggFuncCount is the name of Count function.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">AggFuncCount </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "count"</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// AggFuncSum is the name of Sum function.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">AggFuncSum </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "sum"</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// AggFuncAvg is the name of Avg function.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">AggFuncAvg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "avg"</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// AggFuncFirstRow is the name of FirstRowColumn function.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">AggFuncFirstRow </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "firstrow"</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// AggFuncMax is the name of max function.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">AggFuncMax </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "max"</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// AggFuncMin is the name of min function.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">AggFuncMin </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "min"</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// AggFuncGroupConcat is the name of group_concat function.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">AggFuncGroupConcat </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "group_concat"</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// AggFuncBitOr is the name of bit_or function.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">AggFuncBitOr </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "bit_or"</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// AggFuncBitXor is the name of bit_xor function.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">AggFuncBitXor </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "bit_xor"</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// AggFuncBitAnd is the name of bit_and function.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">AggFuncBitAnd </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "bit_and"</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// AggFuncVarPop is the name of var_pop function</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">AggFuncVarPop </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "var_pop"</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// AggFuncVarSamp is the name of var_samp function</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">AggFuncVarSamp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "var_samp"</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// AggFuncStddevPop is the name of stddev_pop/std/stddev function</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">AggFuncStddevPop </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "stddev_pop"</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// AggFuncStddevSamp is the name of stddev_samp function</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">AggFuncStddevSamp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "stddev_samp"</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// AggFuncJsonArrayagg is the name of json_arrayagg function</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">AggFuncJsonArrayagg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "json_arrayagg"</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// AggFuncJsonObjectAgg is the name of json_objectagg function</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">AggFuncJsonObjectAgg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "json_objectagg"</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// AggFuncApproxCountDistinct is the name of approx_count_distinct function.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">AggFuncApproxCountDistinct </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "approx_count_distinct"</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// AggFuncApproxPercentile is the name of approx_percentile function.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">AggFuncApproxPercentile </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "approx_percentile"</span></span></code></pre>
</div></li>
</ol>
<h2 id="columnpruner" tabindex="-1">columnPruner <a class="header-anchor" href="#columnpruner" aria-label="Permalink to &quot;columnPruner&quot;"></a></h2>
<ol>
<li>
<p>Actually, there are too many operands implmented <code>pruneCoumns</code>, you can PTAL at <a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan.go#L258" target="_blank" rel="noreferrer">it's interface</a>. After parsing AST, TiDB has already had a basic logic plan and column info without any tuning, when we step in here. I'll choose <code>LogicalSelection</code> which is one of the easiest to take a look deeply.</p>
</li>
<li>
<p>That just deals with every column selected in sql or filterd in predicate and prunes part of columns which don't need. In <code>LogicalSelection</code>, as result of <code>func filter</code> is nil, so result is equal to columns selected plus predicate for filtering.</p>
<div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">func</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> extractColumns</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> []</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Column</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">expr</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Expression</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">filter</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> func</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Column</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">bool</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) []</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Column</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> switch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> v </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> expr.(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> case</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> *</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Column</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> filter </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> nil</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> ||</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> filter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(v) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   result </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> append</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(result, v)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> case</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> *</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ScalarFunction</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> _, arg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> range</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> v.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">GetArgs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">() {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   result </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> extractColumns</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(result, arg, filter)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> result</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
</div></li>
</ol>
<h2 id="resultreorder" tabindex="-1">resultReorder <a class="header-anchor" href="#resultreorder" aria-label="Permalink to &quot;resultReorder&quot;"></a></h2>
<ol>
<li>
<p>ResultReorder reorder query results, which is not a common rule for all queries, it's specially implemented for a few customers. And here is a short comment in code place.</p>
<div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">/*</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">Results of some queries are not ordered, for example:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    create table t (a int); insert into t values (1), (2); select a from t;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">In the case above, the result can be `1 2` or `2 1`, which is not ordered.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">This rule reorders results by modifying or injecting a Sort operator:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"> 1. iterate the plan from the root, and ignore all input-order operators (Sel/Proj/Limit);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"> 2. when meeting the first non-input-order operator,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    2.1. if it's a Sort, update it by appending all output columns into its order-by list,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    2.2. otherwise, inject a new Sort upon this operator.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">*/</span></span></code></pre>
</div></li>
<li>
<p>At <a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/rule_result_reorder.go#L43" target="_blank" rel="noreferrer">here</a>, based on the such clear comment, TiDB'll do <code>1</code>, <code>2.1</code> and <code>2.2</code> by <code>func completeSort</code> and <code>func injectSort</code>. PTAL at <a href="https://github.com/pingcap/tidb/pull/25971" target="_blank" rel="noreferrer">#pr</a> for details.</p>
</li>
</ol>
<h2 id="buildkeyinfo" tabindex="-1">buildKeyInfo <a class="header-anchor" href="#buildkeyinfo" aria-label="Permalink to &quot;buildKeyInfo&quot;"></a></h2>
<p>BuildKeyInfo as their name will collect the information of unique keys into schema(<code>selfSchema</code> and <code>childSchema</code>) and check keys of schema from query input coule be used. in addition, that to check if a query returns no more than one row is also an important action inside of this step. <a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan.go#L274" target="_blank" rel="noreferrer">more details</a></p>
<h2 id="decorrelatesolver" tabindex="-1">decorrelateSolver <a class="header-anchor" href="#decorrelatesolver" aria-label="Permalink to &quot;decorrelateSolver&quot;"></a></h2>
<ol>
<li>
<p>what's apply? from comments, <code>LogicalApply</code> gets one row from outer executor and gets one row from inner executor according to outer row.</p>
</li>
<li>
<p>which means, there wouldn't have optimization without <code>Apply</code> operand logic.</p>
</li>
<li>
<p>if <code>innerPlan</code> is <code>LogicalSelection</code>, action is set new apply-plan children and reoptimize it using the same <code>decorrelateSolver</code> rule, you can see <a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/rule_decorrelate.go#L150" target="_blank" rel="noreferrer">here</a>.</p>
</li>
<li>
<p>if <code>innerPlan</code> is <code>LogicalMaxOneRow</code>, action is the same as <code>LogicalSelection</code>.</p>
</li>
<li>
<p>if <code>innerPlan</code> is <code>LogicalProjection</code> and <code>JoinType</code> is <code>LeftOuterJoin</code>, action is it doesn't have optimization, because of below comments, every comparation will return 1 since the projection is evaluated after the join. And when an <code>Apply</code> is <code>apply.JoinType != SemiJoin &amp;&amp; apply.JoinType != LeftOuterSemiJoin &amp;&amp; apply.JoinType != AntiSemiJoin &amp;&amp; apply.JoinType != AntiLeftOuterSemiJoin</code>, it'll step to next step and try to substitute the all the schema with new expressions which maybe have been optimized by <code>columnPruner</code>, which mainly it does is substitued all expressions or columns like <code>gcSubstitute</code>.</p>
</li>
<li>
<p>if <code>innerPlan</code> is <code>LogicalAggregation</code>,</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> t1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">where</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> t1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">a</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">t2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> t2;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">-- when t1.a=t2.a is false, the result should be null</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">-- after decorrelateSolver, it'll be a format below</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> t1.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> t2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">left outer join</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select distinct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">t1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> a </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> t1) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> sub </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">on</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> t2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">a</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> sub</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">-- | t2.a |      | t1.a |        | t2.a | t1.a | join result |      | join result |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">-- |   1  | join |  0   |  -->   |   1  |   0  |     nll     | -->  | 1 | 1 |  1  |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">-- |   2  |      |  1   |        |   1  |   1  |      1      |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">--                               |   2  |   1  |     null    |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">--                               |   2  |   1  |     null    |</span></span></code></pre>
</div></li>
<li>
<p>if <code>innerPlan</code> is <code>LogicalLimit</code> and <code>apply.JoinType != SemiJoin &amp;&amp; apply.JoinType != LeftOuterSemiJoin &amp;&amp; apply.JoinType != AntiSemiJoin &amp;&amp; apply.JoinType != AntiLeftOuterSemiJoin</code>, that means if <code>LogicalLimit</code> is not SemiJoin, the output of it might be expanded even though we are <code>limit 1</code>. because of function of <code>semi join</code> below, if we did expanding, we'd get <code>semi join</code> the result of limit number of rows.</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> sale_detail;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">--ËøîÂõûÁªìÊûú„ÄÇ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">------------+-------------+-------------+------------+------------+</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| shop_name  | customer_id | total_price | sale_date  | region     |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">------------+-------------+-------------+------------+------------+</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| s1         | c1          | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">       | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2013</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">       | china      |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| s2         | c2          | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">       | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2013</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">       | china      |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| s3         | c3          | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">       | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2013</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">       | china      |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">------------+-------------+-------------+------------+------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> sale_detail_sj;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">--ËøîÂõûÁªìÊûú„ÄÇ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">------------+-------------+-------------+------------+------------+</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| shop_name  | customer_id | total_price | sale_date  | region     |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">------------+-------------+-------------+------------+------------+</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| s1         | c1          | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">       | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2013</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">       | china      |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| s2         | c2          | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">       | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2013</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">       | china      |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| s5         | c2          | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">       | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2013</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">       | china      |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| s2         | c2          | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">       | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2013</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">       | china      |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">------------+-------------+-------------+------------+------------+</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> sale_detail a left semi </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">join</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> sale_detail_sj b </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">on</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">total_price</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">b</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">total_price</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">------------+-------------+-------------+------------+------------+</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| shop_name  | customer_id | total_price | sale_date  | region     |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">------------+-------------+-------------+------------+------------+</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| s2         | c2          | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">       | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2013</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">       | china      |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| s1         | c1          | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">       | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2013</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">       | china      |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">------------+-------------+-------------+------------+------------+</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[right result]  </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> test t1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">where</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> exists</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> test t2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">where</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> t1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> t2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> limit</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">);  </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[wrong result]  </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> test t1 a semi </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">join</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> test t2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">where</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> t1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> t2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> limit</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span></code></pre>
</div></li>
<li>
<p>if <code>innerPlan</code> is <code>LogicalAggregation</code>, It'll check if <code>Apply</code> can be pulled up and an aggregation can be pulled up, then, do related actions like add <code>sum</code> flag.</p>
</li>
<li>
<p>if <code>innerPlan</code> is <code>LogicalSort</code>, Since TiDB only pull up Selection, Projection, Aggregation, MaxOneRow, so there just setp in childen optimization.</p>
</li>
</ol>
<p><a href="https://zhuanlan.zhihu.com/p/52138596" target="_blank" rel="noreferrer">The text</a> may help you understand it easily.</p>
<h2 id="semijoinrewriter" tabindex="-1">semiJoinRewriter <a class="header-anchor" href="#semijoinrewriter" aria-label="Permalink to &quot;semiJoinRewriter&quot;"></a></h2>
<p>all of join types could show as pic below, which'll help understand what <code>semi join</code> is, <a href="https://riptutorial.com/sql/example/22934/join-terminology--inner--outer--semi--anti---" target="_blank" rel="noreferrer">more details PTAL on <code>JOIN Terminology</code></a>.:<br>
<img src="./01Logical-Optimizing-in-TiDB/01Logical-Optimizing-in-TiDB-1.jpeg" alt="01Logical-Optimizing-in-TiDB-1"></p>
<p>If it's <code>semi join</code> or <code>outer semi join</code>, then outer table condition should be pushed down into suboperand. And TiDB implemnted <a href="https://docs.pingcap.com/zh/tidb/stable/agg-distinct-optimization#%E7%AE%80%E5%8D%95-distinct" target="_blank" rel="noreferrer"><code>distinct</code></a> by <code>firstRow | group by</code>, so, in some specific scernaios for avoiding that an aggregation may block the predicate push down, TiDB creates an <code>selection</code> Operand to push down conditions. Like an example below, the <code>HashAgg_22</code> firstly do a distinct operation as inner table, which a benefit is if there is any condition , then, that could be push down, and inner table size'll be small for a good performance. finally, after <code>semiJoinRewriter</code> step, it'll return an projection operand for select aimied fields and more details are <a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/rule_semi_join_rewrite.go#L36" target="_blank" rel="noreferrer">here</a> and this <a href="https://github.com/pingcap/tidb/pull/35325" target="_blank" rel="noreferrer">#PR</a>.</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">mysql</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> table</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> t(id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,a </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,b </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">mysql</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> explain </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> t </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">where</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> exists</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"> /*+ SEMI_JOIN_REWRITE() */</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> t t1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">join</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> t t2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">where</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> t1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">a</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> t2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">a</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> and</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> t1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">a</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">------------------------------------+----------+-----------+---------------+-------------------------------------------------------+</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| id                                 | estRows  | task      | access </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | operator info                                         |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">------------------------------------+----------+-----------+---------------+-------------------------------------------------------+</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| HashJoin_17                        | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">9990</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">root</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">      |               | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">inner join</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, equal:[eq(test.t.a, test.t.a)]            |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| ‚îú‚îÄHashAgg_22(Build)                | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">7992</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">root</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">      |               | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">group by</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">test</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.a, funcs:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">firstrow</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">test</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.a)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-></span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">test</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.a |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| ‚îÇ ‚îî‚îÄHashJoin_23                    | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">12487</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">50</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">root</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">      |               | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">inner join</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, equal:[eq(test.t.a, test.t.a)]            |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| ‚îÇ   ‚îú‚îÄTableReader_30(Build)        | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">9990</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">root</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">      |               | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:Selection_29                                     |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| ‚îÇ   ‚îÇ ‚îî‚îÄSelection_29               | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">9990</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  | cop[tikv] |               | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">not</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">isnull</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">test</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.a))                                 |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| ‚îÇ   ‚îÇ   ‚îî‚îÄTableFullScan_28         | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">10000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | cop[tikv] | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">table</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:t2      | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">keep</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> order:false, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">stats</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:pseudo                        |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| ‚îÇ   ‚îî‚îÄTableReader_27(Probe)        | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">9990</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">root</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">      |               | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:Selection_26                                     |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| ‚îÇ     ‚îî‚îÄSelection_26               | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">9990</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  | cop[tikv] |               | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">not</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">isnull</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">test</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.a))                                 |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| ‚îÇ       ‚îî‚îÄTableFullScan_25         | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">10000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | cop[tikv] | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">table</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:t1      | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">keep</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> order:false, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">stats</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:pseudo                        |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| ‚îî‚îÄTableReader_21(Probe)            | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">9990</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">root</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">      |               | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:Selection_20                                     |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">|   ‚îî‚îÄSelection_20                   | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">9990</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  | cop[tikv] |               | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">not</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">isnull</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">test</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.a))                                 |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">|     ‚îî‚îÄTableFullScan_19             | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">10000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | cop[tikv] | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">table</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:t       | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">keep</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> order:false, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">stats</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:pseudo                        |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">------------------------------------+----------+-----------+---------------+-------------------------------------------------------+</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">-- if t2 has conditions like `t2.b = xxx`, that can be push down to `selection`.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">mysql</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> explain </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> t </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">where</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> exists</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"> /*+ SEMI_JOIN_REWRITE() */</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> t t1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">join</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> t t2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">where</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> t1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">a</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> t2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">a</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> and</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> t1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">a</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">a</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> and</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> t1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">b</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 123</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">------------------------------------+----------+-----------+---------------+-------------------------------------------------------+</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| id                                 | estRows  | task      | access </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | operator info                                         |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">------------------------------------+----------+-----------+---------------+-------------------------------------------------------+</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| HashJoin_17                        | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">9</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">99</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">     | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">root</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">      |               | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">inner join</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, equal:[eq(test.t.a, test.t.a)]            |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| ‚îú‚îÄHashAgg_22(Build)                | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">7</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">99</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">     | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">root</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">      |               | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">group by</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">test</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.a, funcs:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">firstrow</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">test</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.a)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-></span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">test</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.a |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| ‚îÇ ‚îî‚îÄHashJoin_24                    | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">12</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">49</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">root</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">      |               | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">inner join</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, equal:[eq(test.t.a, test.t.a)]            |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| ‚îÇ   ‚îú‚îÄTableReader_27(Build)        | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">9</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">99</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">     | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">root</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">      |               | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:Selection_26                                     |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| ‚îÇ   ‚îÇ ‚îî‚îÄSelection_26               | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">9</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">99</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">     | cop[tikv] |               | eq(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">test</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.b, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">123</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">), </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">not</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">isnull</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">test</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.a))              |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| ‚îÇ   ‚îÇ   ‚îî‚îÄTableFullScan_25         | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">10000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | cop[tikv] | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">table</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:t1      | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">keep</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> order:false, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">stats</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:pseudo                        |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| ‚îÇ   ‚îî‚îÄTableReader_30(Probe)        | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">9990</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">root</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">      |               | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:Selection_29                                     |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| ‚îÇ     ‚îî‚îÄSelection_29               | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">9990</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  | cop[tikv] |               | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">not</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">isnull</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">test</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.a))                                 |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| ‚îÇ       ‚îî‚îÄTableFullScan_28         | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">10000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | cop[tikv] | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">table</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:t2      | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">keep</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> order:false, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">stats</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:pseudo                        |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| ‚îî‚îÄTableReader_21(Probe)            | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">9990</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">root</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">      |               | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:Selection_20                                     |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">|   ‚îî‚îÄSelection_20                   | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">9990</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  | cop[tikv] |               | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">not</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">isnull</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">test</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.a))                                 |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">|     ‚îî‚îÄTableFullScan_19             | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">10000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | cop[tikv] | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">table</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:t       | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">keep</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> order:false, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">stats</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:pseudo                        |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">------------------------------------+----------+-----------+---------------+-------------------------------------------------------+</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">12</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> rows</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> in</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">01</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> sec)</span></span></code></pre>
</div><h2 id="aggregationeliminator" tabindex="-1">aggregationEliminator <a class="header-anchor" href="#aggregationeliminator" aria-label="Permalink to &quot;aggregationEliminator&quot;"></a></h2>
<p>Actually, <code>aggregationEliminator</code> will eliminate distinct in the aggregation function if the aggregation args have unique key column and if any aggregation can be eliminated, it'll be done. Like example below, IndexFullScan_13 chould be push down to TiKV side. more details are <a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/rule_aggregation_elimination.go#L230-L231" target="_blank" rel="noreferrer">here</a> and <a href="https://github.com/pingcap/tidb/issues/23436" target="_blank" rel="noreferrer">this #PR</a></p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">mysql</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> table</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> t1(a </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> , </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">unique</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(a));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">-- without aggregationEliminator</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">mysql</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> desc</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> select</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">distinct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> a) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> t;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">--------------------------+----------+-----------+---------------------+------------------------------------------+</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| id                       | estRows  | task      | access </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">       | operator info                            |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">--------------------------+----------+-----------+---------------------+------------------------------------------+</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| StreamAgg_6              | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">     | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">root</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">      |                     | funcs:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">distinct</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> test</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.a)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">Column#</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| ‚îî‚îÄIndexReader_14         | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">10000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">root</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">      |                     | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">index</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:IndexFullScan_13                   |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">|   ‚îî‚îÄIndexFullScan_13     | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">10000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | cop[tikv] | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">table</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:t, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">index</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:a(a) | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">keep</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> order:false, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">stats</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:pseudo           |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">--------------------------+--------</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">-- with aggregationEliminator</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">mysql</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> desc</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> select</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">distinct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> a) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> t1;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">----------------------------+----------+-----------+----------------------+----------------------------------+</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| id                         | estRows  | task      | access </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        | operator info                    |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">----------------------------+----------+-----------+----------------------+----------------------------------+</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| StreamAgg_20               | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">     | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">root</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">      |                      | funcs:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(Column#</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">Column#</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| ‚îî‚îÄIndexReader_21           | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">     | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">root</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">      |                      | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">index</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:StreamAgg_8                |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">|   ‚îî‚îÄStreamAgg_8            | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">     | cop[tikv] |                      | funcs:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">test</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">t1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.a)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">Column#</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">|     ‚îî‚îÄIndexFullScan_19     | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">10000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | cop[tikv] | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">table</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:t1, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">index</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:a(a) | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">keep</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> order:false, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">stats</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:pseudo   |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">----------------------------+----------+-----------+----------------------+----------------------------------+</span></span></code></pre>
</div><h2 id="skewdistinctaggrewriter" tabindex="-1">skewDistinctAggRewriter <a class="header-anchor" href="#skewdistinctaggrewriter" aria-label="Permalink to &quot;skewDistinctAggRewriter&quot;"></a></h2>
<p>Comments are very clear for <code>skewDistinctAggRewriter</code>, PTAL at <a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/rule_aggregation_skew_rewrite.go#L49" target="_blank" rel="noreferrer">here</a></p>
<div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// skewDistinctAggRewriter will rewrite group distinct aggregate into 2 level aggregates, e.g.:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">//</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// select S_NATIONKEY as s, count(S_SUPPKEY), count(distinct S_NAME) from supplier group by s;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">//</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// will be rewritten to</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">//</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// select S_NATIONKEY as s, sum(c), count(S_NAME) from (</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">//   select S_NATIONKEY, S_NAME, count(S_SUPPKEY) c from supplier group by S_NATIONKEY, S_NAME</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// ) as T group by s;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">//</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// If the group key is highly skewed and the distinct key has large number of distinct values</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// (a.k.a. high cardinality), the query execution will be slow. This rule may help to ease the</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// skew issue.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">//</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// The rewrite rule only applies to query that satisfies:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// - The aggregate has at least 1 group by column (the group key can be columns or expressions)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// - The aggregate has 1 and only 1 distinct aggregate function (limited to count, avg, sum)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">//</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// This rule is disabled by default. Use tidb_opt_skew_distinct_agg to enable the rule.</span></span></code></pre>
</div><h2 id="projectioneliminator" tabindex="-1">projectionEliminator <a class="header-anchor" href="#projectioneliminator" aria-label="Permalink to &quot;projectionEliminator&quot;"></a></h2>
<p>The <code>projectionEliminator</code> eliminates the redundant projection in a logical plan. From <a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/rule_eliminate_projection.go#L171" target="_blank" rel="noreferrer">here</a>, The actions it does is trying to extract all of columns from scalar functions in SQL-selected fields.</p>
<h2 id="maxmineliminator" tabindex="-1">maxMinEliminator <a class="header-anchor" href="#maxmineliminator" aria-label="Permalink to &quot;maxMinEliminator&quot;"></a></h2>
<p>The <code>maxMinEliminator</code> tries to convert max/min to <code>Limit+Sort</code> operators. Actually, there are  two sceranio which can be divided into, on the one hand, it's just one aggFuc or multi aggFucs like <code>select max(a) from t</code> + <code>select min(a) from t</code> + <code>select max(b) from t</code>. For multi aggFucs, this rule'll check and split every agg into a slice, then, try to eliminate all of them using index. more details are <a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/rule_max_min_eliminate.go#L213-L245" target="_blank" rel="noreferrer">here</a></p>
<h2 id="ppdsolver" tabindex="-1">ppdSolver <a class="header-anchor" href="#ppdsolver" aria-label="Permalink to &quot;ppdSolver&quot;"></a></h2>
<p>The <code>ppd</code> named <a href="https://blogs.oracle.com/optimizer/post/optimizer-transformation-join-predicate-pushdown" target="_blank" rel="noreferrer">PredicatePushDown</a> from insight of oracle database, and this step pushes down the predicates in the where/on/having clauses as deeply as possible. It will accept a predicate that is an expression slice, and return the expressions that can't be pushed. Lots of operands have implmented <a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan.go#L255" target="_blank" rel="noreferrer">this interface</a>, please debug it when you are facing a problem related it.
Interestingly, from <a href="https://blog.jooq.org/join-elimination-an-essential-optimiser-feature-for-advanced-sql-usage/" target="_blank" rel="noreferrer">this page</a>, you know, sometime, people tend to write rudentant join because of easy thinking and writing. In <a href="https://github.com/pingcap/tidb/pull/8021" target="_blank" rel="noreferrer">this #PR</a>, we can see TiDB has implemnted <code>outer join elimination</code> and <code>outer join elimination with distinct</code>. And an example are here below to show what the ppd is:</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">-- OUTER JOIN Elimination, they are equal, A UNIQUE constraint on the left table (here: ADDRESS.ADDRESS_ID) is sufficient to show that for every CUSTOMER there can be at most one ADDRESS</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> c.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> customer c </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">LEFT JOIN</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> address</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> a </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">ON</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> c</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">address_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">address_id</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> customer c</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">-- OUTER JOIN Elimination with DISTINCT, they are equal, when TiDB already has a UNIQUE constraint on (FIRST_NAME, LAST_NAME)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">SELECT DISTINCT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> first_name, last_name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> actor a </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">LEFT JOIN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> film_actor fa </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">ON</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">actor_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> fa</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">actor_id</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">SELECT DISTINCT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> first_name, last_name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> actor a</span></span></code></pre>
</div><h2 id="partitionprocessor" tabindex="-1">partitionProcessor <a class="header-anchor" href="#partitionprocessor" aria-label="Permalink to &quot;partitionProcessor&quot;"></a></h2>
<p>Also comments in code space are very clear, <a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/rule_partition_processor.go#L61" target="_blank" rel="noreferrer">PTAL</a>. Mainly, What it does is rewriting an select query into UnionScan and prune the columns in datasource.</p>
<div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// partitionProcessor rewrites the ast for table partition.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// Used by static partition prune mode.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">/*</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// create table t (id int) partition by range (id)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">//   (partition p1 values less than (10),</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">//    partition p2 values less than (20),</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">//    partition p3 values less than (30))</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">//</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// select * from t is equal to</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// select * from (union all</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">//      select * from p1 where id &#x3C; 10</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">//      select * from p2 where id &#x3C; 20</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">//      select * from p3 where id &#x3C; 30)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">*/</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// partitionProcessor is here because it's easier to prune partition after predicate push down.</span></span></code></pre>
</div><h2 id="collectpredicatecolumnspoint" tabindex="-1">collectPredicateColumnsPoint <a class="header-anchor" href="#collectpredicatecolumnspoint" aria-label="Permalink to &quot;collectPredicateColumnsPoint&quot;"></a></h2>
<p>Actually, It'll collect collect the indices which includes following conditions:</p>
<ol>
<li>the indices contained the any one of histNeededColumns, eg: histNeededColumns contained A,B columns, and idx_a is composed up by A column, then we thought the idx_a should be collected.</li>
<li>The stats condition of idx_a can't meet loading all of info, which means its stats was evicted previously.</li>
</ol>
<p>And, in <a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_stats.go#L39-L40" target="_blank" rel="noreferrer">here</a> comparing with doc of <a href="https://docs.pingcap.com/zh/tidb/stable/system-variables#tidb_stats_load_sync_wait-%E4%BB%8E-v540-%E7%89%88%E6%9C%AC%E5%BC%80%E5%A7%8B%E5%BC%95%E5%85%A5" target="_blank" rel="noreferrer">tidb_stats_load_sync_wait</a>, you could easily understand what kind of actions does if have on logical optimization. However, it just sends and the load column/index stats requests to stats handle, exactly, which was done in step of <code>syncWaitStatsLoadPoint</code>.</p>
<h2 id="aggregationpushdownsolver" tabindex="-1">aggregationPushDownSolver <a class="header-anchor" href="#aggregationpushdownsolver" aria-label="Permalink to &quot;aggregationPushDownSolver&quot;"></a></h2>
<p>EliminateAggregation will eliminate aggregation grouped by unique key, like something below:</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">-- there are equal, If a is a unique key, so this min() could be eliminated.</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> min</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(b) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> t </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">group by</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> a;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> b </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> t </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">group by</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> a</span></span></code></pre>
</div><h2 id="pushdowntopnoptimizer" tabindex="-1">pushDownTopNOptimizer <a class="header-anchor" href="#pushdowntopnoptimizer" aria-label="Permalink to &quot;pushDownTopNOptimizer&quot;"></a></h2>
<p>pushDownTopN will push down the topN or limit operator during logical optimization. Actually, what it does is just push topN to children operand.</p>
<h2 id="syncwaitstatsloadpoint" tabindex="-1">syncWaitStatsLoadPoint <a class="header-anchor" href="#syncwaitstatsloadpoint" aria-label="Permalink to &quot;syncWaitStatsLoadPoint&quot;"></a></h2>
<p>SyncWaitStatsLoad syncs and waits for stats load until timeout with <a href="https://docs.pingcap.com/zh/tidb/v6.4/system-variables#tidb_stats_load_sync_wait-%E4%BB%8E-v540-%E7%89%88%E6%9C%AC%E5%BC%80%E5%A7%8B%E5%BC%95%E5%85%A5" target="_blank" rel="noreferrer">tidb_stats_load_sync_wait</a> and <a href="https://docs.pingcap.com/zh/tidb/v6.4/system-variables#tidb_stats_load_pseudo_timeout-%E4%BB%8E-v540-%E7%89%88%E6%9C%AC%E5%BC%80%E5%A7%8B%E5%BC%95%E5%85%A5" target="_blank" rel="noreferrer">tidb_stats_load_pseudo_timeout</a></p>
<h2 id="joinreordersolver" tabindex="-1">joinReOrderSolver <a class="header-anchor" href="#joinreordersolver" aria-label="Permalink to &quot;joinReOrderSolver&quot;"></a></h2>
<p>This step recursively collects join groups and applies join reorder algorithm for each group. And it was composed with DP algorithm, greedy algorithm and joinOrderGroup, like hint function of <a href="https://docs.pingcap.com/zh/tidb/v6.4/optimizer-hints#leadingt1_name--tl_name-" target="_blank" rel="noreferrer">leading</a>.</p>
]]></content:encoded>
            <enclosure url="https://askaric.com/01Logical-Optimizing-in-TiDB/01Logical-Optimizing-in-TiDB-1.jpeg" length="0" type="image/jpeg"/>
        </item>
        <item>
            <title><![CDATA[What's Psysical Optimizing in TiDB]]></title>
            <link>https://askaric.com/en/work/tidb/TiDB-Principle/TiDB Optimizer/Physical Optimizing in TiDB.html</link>
            <guid>https://askaric.com/en/work/tidb/TiDB-Principle/TiDB Optimizer/Physical Optimizing in TiDB.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[# What's Psysical Optimizing in TiDB

## First of all

first of all, in psysical period, [preparePossibleProperties](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/optimizer.go#L624) will get all possible order properties(column fields), which is only used for join and aggregation. Like group by a,b,c, into one slice from different level childs.  

## How to calculate physical plan

1. [DoOptimize](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/optimizer.go#L269) is the core connection from logicalOptimize to physicalOptimize, which optimizes a logical plan to a physical plan.
2. Function findBestTask ,in [physicalOptimize](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/optimizer.go#L619), will find out the best tasks from logical plan, and converts the logical plan to the physical plan, which's a new interface.
3. Until 2022-11-30 TiDB master branch, TiDB optizmizer gets plan cost in the order of `DoOptimize` -> `getPlanCost` -> `getPlanCostVer1/getPlanCostVer2`.Actually, the method [getPlanCostVer1/getPlanCostVer2](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan.go#L337) of interface PhysicalPlan is use get psysical every operand cost. I mean, by their different implentation, you could figure out how it's calculated.
4. In [here](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L39), you'll get that It figures out child cost one by one.  

## Why go PlanCostVer1 to PlanCostVer2

This [PR](https://github.com/pingcap/tidb/pull/35378) indeciates sometimes optimizer cannot discern which is the best datasource,  so a new cost formular for `Selection/TableScan/IndexScan` has been merged. which are here below:  

1. Selection : rows*num-filters*cpu-factor, which Tiflash has a specific cpu-factor
2. TableScan : rows*log(row-size)*scan-factor, which Tiflash has a specific cpu-factor
3. indexScan : rows*log(row-size)*scan-factor  

## Formula map of operand cost

1. In the map below, you'll find a lot of factor and can get them on [Formula map of different factors](## Formula map of different factors ).

| TaskType | version | cost calculated expression | code addr |
| - | - | - | - |
| PhysicalSelection | 2 | cost = child-cost + filter-cost | [here](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L62) |
| PhysicalProjection | 2 | cost = (child-cost + (proj-cost = rows \* len(expressions) \* cpu-factor)) / projection-concurrency  | [here](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L85) |
| PhysicalIndexScan | 2 | cost = rows *log2(row-size)* scan-factor | [here](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L109) |
| PhysicalTableScan | 2 | cost = rows *log2(row-size)* scan-factor | [here](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L126) |
| PhysicalIndexReader | 2 |  cost = (child-cost + net-cost + seek-cost) / concurrency | [here](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L150) |
| PhysicalTableReader | 2 | cost = (child-cost + (rows *row-size* net-factor) + (num-tasks * seek-factor)) / concurrency | [here](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L178) |
| PhysicalIndexLookUpReader | 2 | cost = index-side-cost + (table-side-cost + double-read-cost) / double-read-concurrency | [here](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L217) |
| PhysicalIndexMergeReader | 2 | cost = cost = table-side-cost + sum(index-side-cost) | [here](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L269) |
| PhysicalSort | 2 | cost = child-cost + sort-cpu-cost + sort-mem-cost + sort-disk-cost | [here](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L322) |
| PhysicalTopN | 2 | cost = child-cost + topn-cpu-cost + topn-mem-cost | [here](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L372) |
| PhysicalStreamAgg | 2 | cost = child-cost + agg-cost + group-cost | [here](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L402) |
| PhysicalHashAgg | 2 | child-cost + (agg-cost + group-cost + hash-build-cost + hash-probe-cost) / concurrency | [here](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L425) |
| PhysicalMergeJoin | 2 | cost = left-child-cost + right-child-cost + filter-cost + group-cost |   |
| PhysicalHashJoin | 2 | cost = build-child-cost + probe-child-cost + build-hash-cost + build-filter-cost + (probe-filter-cost + probe-hash-cost) / concurrency | [here](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L486) |
| PhysicalIndexJoin | 2 | cost = build-child-cost + build-filter-cost + (probe-cost + probe-filter-cost) / concurrency probe-cost = probe-child-cost * build-rows / batchRatio | [here](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L530) |
| PhysicalIndexHashJoin | 2 | until 2022-11-30, It's the same as PhysicalIndexJoin | [here](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L566) |
| PhysicalIndexMergeJoin | 2 | until 2022-11-30, It's the same as IndexJoin | [here](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L571) |
| PhysicalApply | 2 | cost = uild-child-cost + build-filter-cost + probe-cost + probe-filter-cost | [here](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L579) |
| PhysicalUnionAll | 2 | cost = sum(child-cost) / concurrency | [here](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L609) |
| PhysicalExchangeReceiver | 2 | cost = child-cost + net-cost | [here](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L630) |
| PointGetPlan | 2 | cost = child-cost + net-cost | [here](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L652) |
| PointGetPlan | 2 | cost = child-cost + net-cost | [here](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L652) |
| BatchPointGetPlan | 2 | cost = seek-cost + net-cost | [here](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L676) |

## Formula map of different factors

| function name | name | factor name |
| - | - | - |
| TiDBTemp | tidb_temp_table_factor | 0 |
| TiKVScan:     | tikv_scan_factor | 100 |
| TiKVDescScan: | tikv_desc_scan_factor | 150 |
| TiFlashScan:  | tiflash_scan_factor | 5 |
| TiDBCPU:      | tidb_cpu_factor | 30 |
| TiKVCPU:      | tikv_cpu_factor | 30 |
| TiFlashCPU:   | tiflash_cpu_factor | 5 |
| TiDB2KVNet:   | tidb_kv_net_factor | 8 |
| TiDB2FlashNet:| tidb_flash_net_factor | 4 |
| TiFlashMPPNet:| tiflash_mpp_net_factor | 4 |
| TiDBMem:      | tidb_mem_factor | 1 |
| TiKVMem:      | tikv_mem_factor | 1 |
| TiFlashMem:   | tiflash_mem_factor | 1 |
| TiDBDisk:     | tidb_disk_factor | 1000 |
| TiDBRequest:  | tidb_request_factor | 9500000 |

## PhysicalSelection

1. If row-size belongs to the type of PointGet, the row-size is 1. And row-size of BatchPointGet will come from stats.  
2. And filter-cost indicates cost of this step which uses to calculate and filter the result, which is `row-size * float64(len(filters)) * (tidb_cpu_factor or tikv_cpu_factor or TiFlashCPU)`.

```yaml
plan-cost =  child-cost + filter-cost(row-size * float64(len(filters)) * (tidb_cpu_factor or tikv_cpu_factor or TiFlashCPU)) 
```

## PhysicalProjection

1. projection-concurrency can be modified by [tidb_executor_concurrency](https://docs.pingcap.com/zh/tidb/stable/system-variables#tidb_executor_concurrency-%E4%BB%8E-v50-%E7%89%88%E6%9C%AC%E5%BC%80%E5%A7%8B%E5%BC%95%E5%85%A5)
2. proj-cost is equal to `row-size * len(expressions) * cpu-factor)`, which expressions is the number of column this step.

```yaml
                 child-cost + row-size * len(expressions) * cpu-factor
plan-cost =   ]]></description>
            <content:encoded><![CDATA[<h1 id="what-s-psysical-optimizing-in-tidb" tabindex="-1">What's Psysical Optimizing in TiDB <a class="header-anchor" href="#what-s-psysical-optimizing-in-tidb" aria-label="Permalink to &quot;What's Psysical Optimizing in TiDB&quot;"></a></h1>
<h2 id="first-of-all" tabindex="-1">First of all <a class="header-anchor" href="#first-of-all" aria-label="Permalink to &quot;First of all&quot;"></a></h2>
<p>first of all, in psysical period, <a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/optimizer.go#L624" target="_blank" rel="noreferrer">preparePossibleProperties</a> will get all possible order properties(column fields), which is only used for join and aggregation. Like group by a,b,c, into one slice from different level childs.</p>
<h2 id="how-to-calculate-physical-plan" tabindex="-1">How to calculate physical plan <a class="header-anchor" href="#how-to-calculate-physical-plan" aria-label="Permalink to &quot;How to calculate physical plan&quot;"></a></h2>
<ol>
<li><a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/optimizer.go#L269" target="_blank" rel="noreferrer">DoOptimize</a> is the core connection from logicalOptimize to physicalOptimize, which optimizes a logical plan to a physical plan.</li>
<li>Function findBestTask ,in <a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/optimizer.go#L619" target="_blank" rel="noreferrer">physicalOptimize</a>, will find out the best tasks from logical plan, and converts the logical plan to the physical plan, which's a new interface.</li>
<li>Until 2022-11-30 TiDB master branch, TiDB optizmizer gets plan cost in the order of <code>DoOptimize</code> -&gt; <code>getPlanCost</code> -&gt; <code>getPlanCostVer1/getPlanCostVer2</code>.Actually, the method <a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan.go#L337" target="_blank" rel="noreferrer">getPlanCostVer1/getPlanCostVer2</a> of interface PhysicalPlan is use get psysical every operand cost. I mean, by their different implentation, you could figure out how it's calculated.</li>
<li>In <a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L39" target="_blank" rel="noreferrer">here</a>, you'll get that It figures out child cost one by one.</li>
</ol>
<h2 id="why-go-plancostver1-to-plancostver2" tabindex="-1">Why go PlanCostVer1 to PlanCostVer2 <a class="header-anchor" href="#why-go-plancostver1-to-plancostver2" aria-label="Permalink to &quot;Why go PlanCostVer1 to PlanCostVer2&quot;"></a></h2>
<p>This <a href="https://github.com/pingcap/tidb/pull/35378" target="_blank" rel="noreferrer">PR</a> indeciates sometimes optimizer cannot discern which is the best datasource,  so a new cost formular for <code>Selection/TableScan/IndexScan</code> has been merged. which are here below:</p>
<ol>
<li>Selection : rows<em>num-filters</em>cpu-factor, which Tiflash has a specific cpu-factor</li>
<li>TableScan : rows*log(row-size)*scan-factor, which Tiflash has a specific cpu-factor</li>
<li>indexScan : rows*log(row-size)*scan-factor</li>
</ol>
<h2 id="formula-map-of-operand-cost" tabindex="-1">Formula map of operand cost <a class="header-anchor" href="#formula-map-of-operand-cost" aria-label="Permalink to &quot;Formula map of operand cost&quot;"></a></h2>
<ol>
<li>In the map below, you'll find a lot of factor and can get them on [Formula map of different factors](## Formula map of different factors ).</li>
</ol>
<table tabindex="0">
<thead>
<tr>
<th>TaskType</th>
<th>version</th>
<th>cost calculated expression</th>
<th>code addr</th>
</tr>
</thead>
<tbody>
<tr>
<td>PhysicalSelection</td>
<td>2</td>
<td>cost = child-cost + filter-cost</td>
<td><a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L62" target="_blank" rel="noreferrer">here</a></td>
</tr>
<tr>
<td>PhysicalProjection</td>
<td>2</td>
<td>cost = (child-cost + (proj-cost = rows * len(expressions) * cpu-factor)) / projection-concurrency</td>
<td><a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L85" target="_blank" rel="noreferrer">here</a></td>
</tr>
<tr>
<td>PhysicalIndexScan</td>
<td>2</td>
<td>cost = rows <em>log2(row-size)</em> scan-factor</td>
<td><a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L109" target="_blank" rel="noreferrer">here</a></td>
</tr>
<tr>
<td>PhysicalTableScan</td>
<td>2</td>
<td>cost = rows <em>log2(row-size)</em> scan-factor</td>
<td><a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L126" target="_blank" rel="noreferrer">here</a></td>
</tr>
<tr>
<td>PhysicalIndexReader</td>
<td>2</td>
<td>cost = (child-cost + net-cost + seek-cost) / concurrency</td>
<td><a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L150" target="_blank" rel="noreferrer">here</a></td>
</tr>
<tr>
<td>PhysicalTableReader</td>
<td>2</td>
<td>cost = (child-cost + (rows <em>row-size</em> net-factor) + (num-tasks * seek-factor)) / concurrency</td>
<td><a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L178" target="_blank" rel="noreferrer">here</a></td>
</tr>
<tr>
<td>PhysicalIndexLookUpReader</td>
<td>2</td>
<td>cost = index-side-cost + (table-side-cost + double-read-cost) / double-read-concurrency</td>
<td><a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L217" target="_blank" rel="noreferrer">here</a></td>
</tr>
<tr>
<td>PhysicalIndexMergeReader</td>
<td>2</td>
<td>cost = cost = table-side-cost + sum(index-side-cost)</td>
<td><a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L269" target="_blank" rel="noreferrer">here</a></td>
</tr>
<tr>
<td>PhysicalSort</td>
<td>2</td>
<td>cost = child-cost + sort-cpu-cost + sort-mem-cost + sort-disk-cost</td>
<td><a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L322" target="_blank" rel="noreferrer">here</a></td>
</tr>
<tr>
<td>PhysicalTopN</td>
<td>2</td>
<td>cost = child-cost + topn-cpu-cost + topn-mem-cost</td>
<td><a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L372" target="_blank" rel="noreferrer">here</a></td>
</tr>
<tr>
<td>PhysicalStreamAgg</td>
<td>2</td>
<td>cost = child-cost + agg-cost + group-cost</td>
<td><a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L402" target="_blank" rel="noreferrer">here</a></td>
</tr>
<tr>
<td>PhysicalHashAgg</td>
<td>2</td>
<td>child-cost + (agg-cost + group-cost + hash-build-cost + hash-probe-cost) / concurrency</td>
<td><a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L425" target="_blank" rel="noreferrer">here</a></td>
</tr>
<tr>
<td>PhysicalMergeJoin</td>
<td>2</td>
<td>cost = left-child-cost + right-child-cost + filter-cost + group-cost</td>
<td></td>
</tr>
<tr>
<td>PhysicalHashJoin</td>
<td>2</td>
<td>cost = build-child-cost + probe-child-cost + build-hash-cost + build-filter-cost + (probe-filter-cost + probe-hash-cost) / concurrency</td>
<td><a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L486" target="_blank" rel="noreferrer">here</a></td>
</tr>
<tr>
<td>PhysicalIndexJoin</td>
<td>2</td>
<td>cost = build-child-cost + build-filter-cost + (probe-cost + probe-filter-cost) / concurrency probe-cost = probe-child-cost * build-rows / batchRatio</td>
<td><a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L530" target="_blank" rel="noreferrer">here</a></td>
</tr>
<tr>
<td>PhysicalIndexHashJoin</td>
<td>2</td>
<td>until 2022-11-30, It's the same as PhysicalIndexJoin</td>
<td><a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L566" target="_blank" rel="noreferrer">here</a></td>
</tr>
<tr>
<td>PhysicalIndexMergeJoin</td>
<td>2</td>
<td>until 2022-11-30, It's the same as IndexJoin</td>
<td><a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L571" target="_blank" rel="noreferrer">here</a></td>
</tr>
<tr>
<td>PhysicalApply</td>
<td>2</td>
<td>cost = uild-child-cost + build-filter-cost + probe-cost + probe-filter-cost</td>
<td><a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L579" target="_blank" rel="noreferrer">here</a></td>
</tr>
<tr>
<td>PhysicalUnionAll</td>
<td>2</td>
<td>cost = sum(child-cost) / concurrency</td>
<td><a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L609" target="_blank" rel="noreferrer">here</a></td>
</tr>
<tr>
<td>PhysicalExchangeReceiver</td>
<td>2</td>
<td>cost = child-cost + net-cost</td>
<td><a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L630" target="_blank" rel="noreferrer">here</a></td>
</tr>
<tr>
<td>PointGetPlan</td>
<td>2</td>
<td>cost = child-cost + net-cost</td>
<td><a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L652" target="_blank" rel="noreferrer">here</a></td>
</tr>
<tr>
<td>PointGetPlan</td>
<td>2</td>
<td>cost = child-cost + net-cost</td>
<td><a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L652" target="_blank" rel="noreferrer">here</a></td>
</tr>
<tr>
<td>BatchPointGetPlan</td>
<td>2</td>
<td>cost = seek-cost + net-cost</td>
<td><a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L676" target="_blank" rel="noreferrer">here</a></td>
</tr>
</tbody>
</table>
<h2 id="formula-map-of-different-factors" tabindex="-1">Formula map of different factors <a class="header-anchor" href="#formula-map-of-different-factors" aria-label="Permalink to &quot;Formula map of different factors&quot;"></a></h2>
<table tabindex="0">
<thead>
<tr>
<th>function name</th>
<th>name</th>
<th>factor name</th>
</tr>
</thead>
<tbody>
<tr>
<td>TiDBTemp</td>
<td>tidb_temp_table_factor</td>
<td>0</td>
</tr>
<tr>
<td>TiKVScan:</td>
<td>tikv_scan_factor</td>
<td>100</td>
</tr>
<tr>
<td>TiKVDescScan:</td>
<td>tikv_desc_scan_factor</td>
<td>150</td>
</tr>
<tr>
<td>TiFlashScan:</td>
<td>tiflash_scan_factor</td>
<td>5</td>
</tr>
<tr>
<td>TiDBCPU:</td>
<td>tidb_cpu_factor</td>
<td>30</td>
</tr>
<tr>
<td>TiKVCPU:</td>
<td>tikv_cpu_factor</td>
<td>30</td>
</tr>
<tr>
<td>TiFlashCPU:</td>
<td>tiflash_cpu_factor</td>
<td>5</td>
</tr>
<tr>
<td>TiDB2KVNet:</td>
<td>tidb_kv_net_factor</td>
<td>8</td>
</tr>
<tr>
<td>TiDB2FlashNet:</td>
<td>tidb_flash_net_factor</td>
<td>4</td>
</tr>
<tr>
<td>TiFlashMPPNet:</td>
<td>tiflash_mpp_net_factor</td>
<td>4</td>
</tr>
<tr>
<td>TiDBMem:</td>
<td>tidb_mem_factor</td>
<td>1</td>
</tr>
<tr>
<td>TiKVMem:</td>
<td>tikv_mem_factor</td>
<td>1</td>
</tr>
<tr>
<td>TiFlashMem:</td>
<td>tiflash_mem_factor</td>
<td>1</td>
</tr>
<tr>
<td>TiDBDisk:</td>
<td>tidb_disk_factor</td>
<td>1000</td>
</tr>
<tr>
<td>TiDBRequest:</td>
<td>tidb_request_factor</td>
<td>9500000</td>
</tr>
</tbody>
</table>
<h2 id="physicalselection" tabindex="-1">PhysicalSelection <a class="header-anchor" href="#physicalselection" aria-label="Permalink to &quot;PhysicalSelection&quot;"></a></h2>
<ol>
<li>If row-size belongs to the type of PointGet, the row-size is 1. And row-size of BatchPointGet will come from stats.</li>
<li>And filter-cost indicates cost of this step which uses to calculate and filter the result, which is <code>row-size * float64(len(filters)) * (tidb_cpu_factor or tikv_cpu_factor or TiFlashCPU)</code>.</li>
</ol>
<div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">plan-cost =  child-cost + filter-cost(row-size * float64(len(filters)) * (tidb_cpu_factor or tikv_cpu_factor or TiFlashCPU))</span></span></code></pre>
</div><h2 id="physicalprojection" tabindex="-1">PhysicalProjection <a class="header-anchor" href="#physicalprojection" aria-label="Permalink to &quot;PhysicalProjection&quot;"></a></h2>
<ol>
<li>projection-concurrency can be modified by <a href="https://docs.pingcap.com/zh/tidb/stable/system-variables#tidb_executor_concurrency-%E4%BB%8E-v50-%E7%89%88%E6%9C%AC%E5%BC%80%E5%A7%8B%E5%BC%95%E5%85%A5" target="_blank" rel="noreferrer">tidb_executor_concurrency</a></li>
<li>proj-cost is equal to <code>row-size * len(expressions) * cpu-factor)</code>, which expressions is the number of column this step.</li>
</ol>
<div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                 child-cost + row-size * len(expressions) * cpu-factor</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">plan-cost =   ------------------------------------------------------------</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                          projection-concurrency</span></span></code></pre>
</div><h2 id="physicalindexscan" tabindex="-1">PhysicalIndexScan <a class="header-anchor" href="#physicalindexscan" aria-label="Permalink to &quot;PhysicalIndexScan&quot;"></a></h2>
<ol>
<li>rowSize(row-size) = AvgRowSize + [tablePrefix(1) + tableID(8) + indexPrefix(2) + indexID(8)] = AvgRowSize + 19.</li>
<li>BTW, the calculation of <code>AvgRowSize</code> is really complicated. if you wanna figure out how the result value is computed, please explore the code logic. And,<a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/statistics/table.go#L1289" target="_blank" rel="noreferrer">here</a> are the code addr.</li>
</ol>
<div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">cost = rows * log2(row-size) * scan-factor</span></span></code></pre>
</div><h2 id="physicaltablescan" tabindex="-1">PhysicalTableScan <a class="header-anchor" href="#physicaltablescan" aria-label="Permalink to &quot;PhysicalTableScan&quot;"></a></h2>
<ol>
<li>rows is the Cardinality generated by stats;</li>
<li>The expression is equal to PhysicalIndexScan.</li>
</ol>
<div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">cost = rows * log2(row-size) * scan-factor</span></span></code></pre>
</div><h2 id="physicalindexreader" tabindex="-1">PhysicalIndexReader <a class="header-anchor" href="#physicalindexreader" aria-label="Permalink to &quot;PhysicalIndexReader&quot;"></a></h2>
<ol>
<li>Actually, the concurrency of this step is distSQLScanConcurrency(default 15) in system varliable, and can be changed by <a href="https://docs.pingcap.com/zh/tidb/dev/system-variables#tidb_distsql_scan_concurrency" target="_blank" rel="noreferrer">tidb_distsql_scan_concurrency</a>.</li>
</ol>
<div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">           child-cost + rows * row-size * net-factor + num-tasks * seek-factor</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">cost =  -------------------------------------------------------------------------</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                          tidb_distsql_scan_concurrency</span></span></code></pre>
</div><h2 id="physicaltablereader" tabindex="-1">PhysicalTableReader <a class="header-anchor" href="#physicaltablereader" aria-label="Permalink to &quot;PhysicalTableReader&quot;"></a></h2>
<ol>
<li>equal to PhysicalIndexReader</li>
</ol>
<div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">           child-cost + rows * row-size * net-factor + num-tasks * seek-factor</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">cost =  -------------------------------------------------------------------------</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                          tidb_distsql_scan_concurrency</span></span></code></pre>
</div><h2 id="physicalindexlookupreader" tabindex="-1">PhysicalIndexLookUpReader <a class="header-anchor" href="#physicalindexlookupreader" aria-label="Permalink to &quot;PhysicalIndexLookUpReader&quot;"></a></h2>
<ol>
<li>How to change the concurrency is <a href="https://docs.pingcap.com/zh/tidb/dev/system-variables#tidb_executor_concurrency-%E4%BB%8E-v50-%E7%89%88%E6%9C%AC%E5%BC%80%E5%A7%8B%E5%BC%95%E5%85%A5" target="_blank" rel="noreferrer">tidb_index_lookup_concurrency</a> and now which named tidb_executor_concurrency.</li>
<li>index-side-cost = (index-child-cost + index-net-cost + index-seek-cost) / dist-concurrency, which is same with IndexReader</li>
<li>table-side-cost = (table-child-cost + table-net-cost + table-seek-cost) / dist-concurrency, which is same with TableReader</li>
<li>double-read-cost = double-read-seek-cost + double-read-cpu-cost</li>
<li>double-read-seek-cost = double-read-tasks * seek-factor</li>
<li>double-read-cpu-cost = index-rows * cpu-factor</li>
<li>double-read-tasks = index-rows / batch-size * task-per-batch ,and task-per-batch is a magic number 40 now</li>
</ol>
<div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                   (index-child-cost + index-net-cost + index-seek-cost) +                          -> index-side-cost</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                    (table-child-cost + table-net-cost + table-seek-cost +                          -> table-side-cost</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">          ((index-rows / batch-size * task-per-batch(40)) * seek-factor + index-rows * cpu-factor)) -> double-read-cost</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">          -----------------------------------------------------------------------------------------</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">cost =                               dist-concurrency</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      -------------------------------------------------------------------------------------------------</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                  double-read-concurrency</span></span></code></pre>
</div><h2 id="physicalindexmergereader" tabindex="-1">PhysicalIndexMergeReader <a class="header-anchor" href="#physicalindexmergereader" aria-label="Permalink to &quot;PhysicalIndexMergeReader&quot;"></a></h2>
<ol>
<li>The cost is made up of index-side-cost and table-side-cost, and the formar's equal to IndexReader, and the latter's the same as TableReader.</li>
<li></li>
</ol>
<div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">          (table-child-cost + table-net-cost + table-seek-cost) + (index-child-cost + index-net-cost + index-seek-cost)</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">cost =  ----------------------------------------------------------------------------------------------------------------</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                                dist-concurrency</span></span></code></pre>
</div><h2 id="physicalsort" tabindex="-1">PhysicalSort <a class="header-anchor" href="#physicalsort" aria-label="Permalink to &quot;PhysicalSort&quot;"></a></h2>
<ol>
<li>cost = child-cost + sort-cpu-cost + sort-mem-cost + sort-disk-cost</li>
<li>The Spill means that you're just going to have to use oomUseTmpStorage to save enough TiDB memor, When sort action happens.
a. if no spill, <code>sort-mem-cost</code> will be <code>rows * row-size * mem-factor</code> and, <code>sort-disk-cost</code> is 0;
b. if spill, <code>sort-mem-cost is</code> <code>mem-quota * mem-factor</code> and, <code>sort-disk-cost</code> is <code>rows * row-size * disk-factor</code>;</li>
<li>So, It's clear that when spill happend, <code>sort-mem-cost</code> and <code>sort-disk-cost</code> will change in an appropriate way.</li>
</ol>
<div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">cost = child-cost + (rows * log2(rows) * len(sort-items) * cpu-factor) + sort-mem-cost + sort-disk-cost</span></span></code></pre>
</div><h2 id="physicaltopn" tabindex="-1">PhysicalTopN <a class="header-anchor" href="#physicaltopn" aria-label="Permalink to &quot;PhysicalTopN&quot;"></a></h2>
<ol>
<li>child-cost + topn-cpu-cost + topn-mem-cost</li>
</ol>
<div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">cost = child-cost + (rows * log2(N) * len(sort-items) * cpu-factor) + (N * row-size * mem-factor)</span></span></code></pre>
</div><h2 id="physicalstreamagg" tabindex="-1">PhysicalStreamAgg <a class="header-anchor" href="#physicalstreamagg" aria-label="Permalink to &quot;PhysicalStreamAgg&quot;"></a></h2>
<div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">cost = child-cost + agg-cost + group-cost</span></span></code></pre>
</div><h2 id="physicalhashagg" tabindex="-1">PhysicalHashAgg <a class="header-anchor" href="#physicalhashagg" aria-label="Permalink to &quot;PhysicalHashAgg&quot;"></a></h2>
<ol>
<li>Default value of <a href="https://docs.pingcap.com/zh/tidb/dev/system-variables#tidb_opt_concurrency_factor" target="_blank" rel="noreferrer">tidb_opt_concurrency_factor</a> is 5.</li>
</ol>
<div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">           child-cost + (agg-cost + group-cost + hash-build-cost + hash-probe-cost)</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">cost =    --------------------------------------------------------------------------------</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                tidb_opt_concurrency_factor</span></span></code></pre>
</div><h2 id="physicalmergejoin" tabindex="-1">PhysicalMergeJoin <a class="header-anchor" href="#physicalmergejoin" aria-label="Permalink to &quot;PhysicalMergeJoin&quot;"></a></h2>
<div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">cost = left-child-cost + right-child-cost + filter-cost + group-cost</span></span></code></pre>
</div><h2 id="physicalhashjoin" tabindex="-1">PhysicalHashJoin <a class="header-anchor" href="#physicalhashjoin" aria-label="Permalink to &quot;PhysicalHashJoin&quot;"></a></h2>
<div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">            build-child-cost + probe-child-cost + build-hash-cost +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">cost =  build-filter-cost + (probe-filter-cost + probe-hash-cost) / concurrency</span></span></code></pre>
</div><h2 id="physicalindexjoin-physicalindexhashjoin-physicalindexmergejoin" tabindex="-1">PhysicalIndexJoin &amp; PhysicalIndexHashJoin &amp; PhysicalIndexMergeJoin <a class="header-anchor" href="#physicalindexjoin-physicalindexhashjoin-physicalindexmergejoin" aria-label="Permalink to &quot;PhysicalIndexJoin &amp; PhysicalIndexHashJoin &amp; PhysicalIndexMergeJoin&quot;"></a></h2>
<ol>
<li>They are equal to IndexJoin.</li>
</ol>
<div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">cost =  build-child-cost + build-filter-cost +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                     </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       (probe-child-cost * build-rows / batchRatio + probe-filter-cost) / concurrency</span></span></code></pre>
</div><h2 id="physicalapply" tabindex="-1">PhysicalApply <a class="header-anchor" href="#physicalapply" aria-label="Permalink to &quot;PhysicalApply&quot;"></a></h2>
<div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">cost = build-child-cost + build-filter-cost + probe-child-cost * build-rows + probe-filter-cost</span></span></code></pre>
</div><h2 id="physicalunionall" tabindex="-1">PhysicalUnionAll <a class="header-anchor" href="#physicalunionall" aria-label="Permalink to &quot;PhysicalUnionAll&quot;"></a></h2>
<ol>
<li><a href="https://docs.pingcap.com/zh/tidb/dev/system-variables#tidb_opt_concurrency_factor" target="_blank" rel="noreferrer">tidb_opt_concurrency_factor</a> is the denominator below.</li>
</ol>
<div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">cost = sum(child-cost) / concurrency</span></span></code></pre>
</div><h2 id="physicalexchangereceiver-pointgetplan-pointgetplan-batchpointgetplan" tabindex="-1">PhysicalExchangeReceiver &amp; PointGetPlan &amp; PointGetPlan &amp; BatchPointGetPlan <a class="header-anchor" href="#physicalexchangereceiver-pointgetplan-pointgetplan-batchpointgetplan" aria-label="Permalink to &quot;PhysicalExchangeReceiver &amp; PointGetPlan &amp; PointGetPlan &amp; BatchPointGetPlan&quot;"></a></h2>
<div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">cost = child-cost + net-cost</span></span></code></pre>
</div>]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[My introduction of TiDB notes]]></title>
            <link>https://askaric.com/en/work/tidb/</link>
            <guid>https://askaric.com/en/work/tidb/</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[01TiDB-Principle
 02TIDB-Deployment
 03TiDB-Maintaining
 04TiDB-Tuning
 05TiDB-EcosystematicTools
 0]]></description>
            <content:encoded><![CDATA[<h1 id="my-introduction-of-tidb-notes" tabindex="-1">My introduction of TiDB notes <a class="header-anchor" href="#my-introduction-of-tidb-notes" aria-label="Permalink to &quot;My introduction of TiDB notes&quot;"></a></h1>
<h2 id="_01tidb-principle" tabindex="-1">01TiDB-Principle <a class="header-anchor" href="#_01tidb-principle" aria-label="Permalink to &quot;01TiDB-Principle&quot;"></a></h2>
<h2 id="_02tidb-deployment" tabindex="-1">02TIDB-Deployment <a class="header-anchor" href="#_02tidb-deployment" aria-label="Permalink to &quot;02TIDB-Deployment&quot;"></a></h2>
<h2 id="_03tidb-maintaining" tabindex="-1">03TiDB-Maintaining <a class="header-anchor" href="#_03tidb-maintaining" aria-label="Permalink to &quot;03TiDB-Maintaining&quot;"></a></h2>
<h2 id="_04tidb-tuning" tabindex="-1">04TiDB-Tuning <a class="header-anchor" href="#_04tidb-tuning" aria-label="Permalink to &quot;04TiDB-Tuning&quot;"></a></h2>
<h2 id="_05tidb-ecosystematictools" tabindex="-1">05TiDB-EcosystematicTools <a class="header-anchor" href="#_05tidb-ecosystematictools" aria-label="Permalink to &quot;05TiDB-EcosystematicTools&quot;"></a></h2>
<h2 id="_06tidb-solution" tabindex="-1">06TiDB-Solution <a class="header-anchor" href="#_06tidb-solution" aria-label="Permalink to &quot;06TiDB-Solution&quot;"></a></h2>
<h2 id="_07tidb-sourcecode" tabindex="-1">07TiDB-SourceCode <a class="header-anchor" href="#_07tidb-sourcecode" aria-label="Permalink to &quot;07TiDB-SourceCode&quot;"></a></h2>
<h2 id="_08tidb-cloud-k8s" tabindex="-1">08TiDB-Cloud-K8S <a class="header-anchor" href="#_08tidb-cloud-k8s" aria-label="Permalink to &quot;08TiDB-Cloud-K8S&quot;"></a></h2>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> pod</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                     READY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   STATUS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      RESTARTS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   AGE</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">basic-discovery-5db6c75657-h4c2p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">         1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">          14d</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">basic-monitor-0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                          4/4</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">          14d</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">basic-pd-0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                               1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">          14d</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">basic-ticdc-0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                            1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">          60m</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">basic-ticdc-1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                            1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">          60m</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">basic-tidb-0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                             2/2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">          14d</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">basic-tikv-0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                             1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">          14d</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan-dm-dm-discovery-5c84866d6c-cwcx6</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">          14d</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan-dm-dm-master-0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                       1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">          14d</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan-dm-dm-worker-0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                       1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">          14d</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan-lightning-tidb-lightning-7ssfc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       0/1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     Completed</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">          23h</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ticdc-to-mysql-deploy-85d5d498bc-wwcvb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">          67m</span></span></code></pre>
</div>]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[ÂçöÂÆ¢ÂèäÂçö‰∏ªÁÆÄ‰ªã]]></title>
            <link>https://askaric.com/zh/about.html</link>
            <guid>https://askaric.com/zh/about.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[# ÂçöÂÆ¢ÂèäÂçö‰∏ªÁÆÄ‰ªã

![header](../images/header.jpg)

- BilibiliÔºö[AskAric](https://space.bilibili.com/318184941?spm_id_from=333.1007.0.0)
- GithubÔºö<https://github.com/aricSu>
- EmailÔºöjan-su-dev@outlook.com
- WechatÔºöxh9836(```ËØ∑ËØ¥Êòé‰Ω†ÁöÑÊù•ÊÑèÂèäËé∑Âèñ‰ΩçÁΩÆ```)

## ÂçöÂÆ¢ÂÜÖÂÆπ

1. **ÊòØ‰ªÄ‰πà**Ôºö‰∏ªË¶ÅÊòØËÆ∞ÂΩï‰∏™‰∫∫Âú® **Êï∞ÊçÆÂ∫ìÊñπÈù¢Áü•ËØÜ**„ÄÅ**Ëã±ËØ≠Á¨îËÆ∞**ÔºåÂèä **ÂÄºÂæóÂàÜ‰∫´ÁöÑÂÜÖÂÆπ**„ÄÇ
2. **‰∏∫‰ªÄ‰πà**ÔºöÊúüÊúõ‰ª• ÂçöÂÆ¢ ÁöÑÂΩ¢ÂºèÔºåÂÖãÊúçËá™Â∑±ÁöÑÈÅóÂøòÔºåÂπ∂ÁªôÂøóË∂£Áõ∏ÊäïÁöÑ‰ºô‰º¥Êèê‰æõËµÑÊñôÔºå‰πüÁ∫†ÈîôËá™Â∑±„ÄÇ
3. **ÊÄé‰πàÂÅö**ÔºöÂú®ÂØºËà™Ê†è **‚ÄúÊñáÊ°£Á¨îËÆ∞‚Äù** ‰∏≠ÔºåËÆ∞ÂΩïÂ≠¶‰π†ËøáÁ®ãÔºå‰πüÊ¨¢ËøéÂ§ßÂÆ∂Âú® **‚ÄúÁ§æÂå∫‚Äù** ‰∏≠Áïô‰∏ã‰Ω†ÁöÑÊÑèËßÅÂíåÈóÆÈ¢ò„ÄÇ

## ÊäÄÊúØÁºòËµ∑

1. Âàù‰∏≠Êó∂ÔºåËØªÂà∞‰∏ÄÊú¨‰π¶„ÄäÈ©¨‰∫ëÂàõ‰∏öÂêØÁ§∫ÂΩï„ÄãÔºàPSÔºöËôΩÁÑ∂‰π¶‰∏≠ÂÜÖÂÆπ‰∏éÊäÄÊúØÂÖ≥Á≥ª‰∏çÂ§ßÔºâËÆ©ÊàëÁúãÂà∞‰∫ÜÔºå‰∫íËÅîÁΩëÂ∏¶Áªô‰∏≠ÂõΩÁöÑÊîπÂèò„ÄÇÈöèÂêéÊàë‰πüÂ¢ûÂºÄËøáÂá†Ê¨°ÁΩëÂ∫óÔºåÂπ∂Ëµö‰∫Ü‰∫õÈõ∂Ëä±Èí±üòÅÔºåËøôÁï™ÁªèÂéÜÂØºËá¥‰∫ÜÊàëÂú®Â§ßÂ≠¶Êó∂ÊØÖÁÑ∂ÂÜ≥ÂÆöËµ∞Âêë IT Áõ∏ÂÖ≥‰∏ì‰∏öÔºåÂπ∂Âú®Â§ßÂ≠¶ÊúüÈó¥ÂçèÂä©ËÄÅÂ∏à‰ΩøÁî® **Python + Scrapy + chrome-driver + phantomjs** Áà¨Âèñ Boss Áõ¥ËÅòÔºå51 job Á≠â‰ø°ÊÅØÁî®‰∫éÂàÜÊûêÔºåÂ≠¶Èô¢ËØæÁ®ãÊîπÈù©ÊñπÂêë‰∏éÂ∏ÇÂú∫ÈúÄÊ±ÇÂåπÈÖç„ÄÇ
2. ‰∏¥ËøëÊØï‰∏öÔºåÂú®ËÄÅÂ∏àÁöÑÊé®Ëçê‰∏ãËµ∞ËøõÊï∞ÊçÆÂ∫ìË°å‰∏ö„ÄÇÂàùÂÖ•Ë°å‰∏öÔºåÈÄâÊã©‰∫ÜÁ®≥ÂÆö‰∏îÂë®ËæπÁîüÊÄÅÂÅ•ÂÖ®ÁöÑ Oracle Â≠¶‰π†Ôºå‰ΩÜÂΩìÊó∂ÂÅöÁöÑÊòØÊï∞ÊçÆÂ∫ìÁÆ°ÁêÜÂëòÔºàDBAÔºâÔºå‰∏™‰∫∫ËßâÂæóËøòÊòØÂ∫îËØ•Ê∑±ÂÖ•Êï∞ÊçÆÂ∫ìÂÜÖÈÉ®Ôºà‰ª£Á†ÅÂ±ÇÔºâÂéª‰∫ÜËß£‰∏Ä‰∏ãÔºåÂ∞±ÂÉè **`What I cannot create, I do not understand. -- Richard Phillips Feynman`** ËØ¥ÁöÑ‰∏ÄÊ†∑Ôºå‰∏ç‰ºöÈÄ†‰æø‰∏çËÉΩÁúüÊ≠£ÁêÜËß£„ÄÇÈöèÂêéÔºåÊúâÂπ∏Êù•Âà∞ [PingCAP](https://baike.baidu.com/item/PingCAP/60056692?fr=aladdin) Â∑•‰ΩúÔºåÂ≠¶‰π†Êñ∞‰∏Ä‰ª£ÂàÜÂ∏ÉÂºè HTAP Êï∞ÊçÆÂ∫ì„ÄÇ
3. ÁßâÊâøÊ∑±ÂÖ•ÂÜÖÊ†∏Â≠¶‰π†ÊÄùË∑ØÔºåÂú®Ëøô‰∏™ËøáÁ®ã‰∏≠ÈÄêÊ∏ê‰∫ÜËß£ Golang, Rust, NodeJs Á≠âËØ≠Ë®ÄÔºåÊäÄÊúØ‰πãË∑ØÂæàÊúâË∂£ÔºåÊòØÊé®Âä®‰∏ñÁïåÂâçËøõÁöÑÈáçË¶ÅÂäõÈáè„ÄÇ

]]></description>
            <content:encoded><![CDATA[<h1 id="ÂçöÂÆ¢ÂèäÂçö‰∏ªÁÆÄ‰ªã" tabindex="-1">ÂçöÂÆ¢ÂèäÂçö‰∏ªÁÆÄ‰ªã <a class="header-anchor" href="#ÂçöÂÆ¢ÂèäÂçö‰∏ªÁÆÄ‰ªã" aria-label="Permalink to &quot;ÂçöÂÆ¢ÂèäÂçö‰∏ªÁÆÄ‰ªã&quot;"></a></h1>
<figure><img src="./../images/header.jpg" alt="header" tabindex="0"><figcaption>header</figcaption></figure>
<ul>
<li>BilibiliÔºö<a href="https://space.bilibili.com/318184941?spm_id_from=333.1007.0.0" target="_blank" rel="noreferrer">AskAric</a></li>
<li>GithubÔºö<a href="https://github.com/aricSu" target="_blank" rel="noreferrer">https://github.com/aricSu</a></li>
<li>EmailÔºöjan-su-dev@outlook.com</li>
<li>WechatÔºöxh9836(<code>ËØ∑ËØ¥Êòé‰Ω†ÁöÑÊù•ÊÑèÂèäËé∑Âèñ‰ΩçÁΩÆ</code>)</li>
</ul>
<h2 id="ÂçöÂÆ¢ÂÜÖÂÆπ" tabindex="-1">ÂçöÂÆ¢ÂÜÖÂÆπ <a class="header-anchor" href="#ÂçöÂÆ¢ÂÜÖÂÆπ" aria-label="Permalink to &quot;ÂçöÂÆ¢ÂÜÖÂÆπ&quot;"></a></h2>
<ol>
<li><strong>ÊòØ‰ªÄ‰πà</strong>Ôºö‰∏ªË¶ÅÊòØËÆ∞ÂΩï‰∏™‰∫∫Âú® <strong>Êï∞ÊçÆÂ∫ìÊñπÈù¢Áü•ËØÜ</strong>„ÄÅ<strong>Ëã±ËØ≠Á¨îËÆ∞</strong>ÔºåÂèä <strong>ÂÄºÂæóÂàÜ‰∫´ÁöÑÂÜÖÂÆπ</strong>„ÄÇ</li>
<li><strong>‰∏∫‰ªÄ‰πà</strong>ÔºöÊúüÊúõ‰ª• ÂçöÂÆ¢ ÁöÑÂΩ¢ÂºèÔºåÂÖãÊúçËá™Â∑±ÁöÑÈÅóÂøòÔºåÂπ∂ÁªôÂøóË∂£Áõ∏ÊäïÁöÑ‰ºô‰º¥Êèê‰æõËµÑÊñôÔºå‰πüÁ∫†ÈîôËá™Â∑±„ÄÇ</li>
<li><strong>ÊÄé‰πàÂÅö</strong>ÔºöÂú®ÂØºËà™Ê†è <strong>‚ÄúÊñáÊ°£Á¨îËÆ∞‚Äù</strong> ‰∏≠ÔºåËÆ∞ÂΩïÂ≠¶‰π†ËøáÁ®ãÔºå‰πüÊ¨¢ËøéÂ§ßÂÆ∂Âú® <strong>‚ÄúÁ§æÂå∫‚Äù</strong> ‰∏≠Áïô‰∏ã‰Ω†ÁöÑÊÑèËßÅÂíåÈóÆÈ¢ò„ÄÇ</li>
</ol>
<h2 id="ÊäÄÊúØÁºòËµ∑" tabindex="-1">ÊäÄÊúØÁºòËµ∑ <a class="header-anchor" href="#ÊäÄÊúØÁºòËµ∑" aria-label="Permalink to &quot;ÊäÄÊúØÁºòËµ∑&quot;"></a></h2>
<ol>
<li>Âàù‰∏≠Êó∂ÔºåËØªÂà∞‰∏ÄÊú¨‰π¶„ÄäÈ©¨‰∫ëÂàõ‰∏öÂêØÁ§∫ÂΩï„ÄãÔºàPSÔºöËôΩÁÑ∂‰π¶‰∏≠ÂÜÖÂÆπ‰∏éÊäÄÊúØÂÖ≥Á≥ª‰∏çÂ§ßÔºâËÆ©ÊàëÁúãÂà∞‰∫ÜÔºå‰∫íËÅîÁΩëÂ∏¶Áªô‰∏≠ÂõΩÁöÑÊîπÂèò„ÄÇÈöèÂêéÊàë‰πüÂ¢ûÂºÄËøáÂá†Ê¨°ÁΩëÂ∫óÔºåÂπ∂Ëµö‰∫Ü‰∫õÈõ∂Ëä±Èí±üòÅÔºåËøôÁï™ÁªèÂéÜÂØºËá¥‰∫ÜÊàëÂú®Â§ßÂ≠¶Êó∂ÊØÖÁÑ∂ÂÜ≥ÂÆöËµ∞Âêë IT Áõ∏ÂÖ≥‰∏ì‰∏öÔºåÂπ∂Âú®Â§ßÂ≠¶ÊúüÈó¥ÂçèÂä©ËÄÅÂ∏à‰ΩøÁî® <strong>Python + Scrapy + chrome-driver + phantomjs</strong> Áà¨Âèñ Boss Áõ¥ËÅòÔºå51 job Á≠â‰ø°ÊÅØÁî®‰∫éÂàÜÊûêÔºåÂ≠¶Èô¢ËØæÁ®ãÊîπÈù©ÊñπÂêë‰∏éÂ∏ÇÂú∫ÈúÄÊ±ÇÂåπÈÖç„ÄÇ</li>
<li>‰∏¥ËøëÊØï‰∏öÔºåÂú®ËÄÅÂ∏àÁöÑÊé®Ëçê‰∏ãËµ∞ËøõÊï∞ÊçÆÂ∫ìË°å‰∏ö„ÄÇÂàùÂÖ•Ë°å‰∏öÔºåÈÄâÊã©‰∫ÜÁ®≥ÂÆö‰∏îÂë®ËæπÁîüÊÄÅÂÅ•ÂÖ®ÁöÑ Oracle Â≠¶‰π†Ôºå‰ΩÜÂΩìÊó∂ÂÅöÁöÑÊòØÊï∞ÊçÆÂ∫ìÁÆ°ÁêÜÂëòÔºàDBAÔºâÔºå‰∏™‰∫∫ËßâÂæóËøòÊòØÂ∫îËØ•Ê∑±ÂÖ•Êï∞ÊçÆÂ∫ìÂÜÖÈÉ®Ôºà‰ª£Á†ÅÂ±ÇÔºâÂéª‰∫ÜËß£‰∏Ä‰∏ãÔºåÂ∞±ÂÉè <strong><code>What I cannot create, I do not understand. -- Richard Phillips Feynman</code></strong> ËØ¥ÁöÑ‰∏ÄÊ†∑Ôºå‰∏ç‰ºöÈÄ†‰æø‰∏çËÉΩÁúüÊ≠£ÁêÜËß£„ÄÇÈöèÂêéÔºåÊúâÂπ∏Êù•Âà∞ <a href="https://baike.baidu.com/item/PingCAP/60056692?fr=aladdin" target="_blank" rel="noreferrer">PingCAP</a> Â∑•‰ΩúÔºåÂ≠¶‰π†Êñ∞‰∏Ä‰ª£ÂàÜÂ∏ÉÂºè HTAP Êï∞ÊçÆÂ∫ì„ÄÇ</li>
<li>ÁßâÊâøÊ∑±ÂÖ•ÂÜÖÊ†∏Â≠¶‰π†ÊÄùË∑ØÔºåÂú®Ëøô‰∏™ËøáÁ®ã‰∏≠ÈÄêÊ∏ê‰∫ÜËß£ Golang, Rust, NodeJs Á≠âËØ≠Ë®ÄÔºåÊäÄÊúØ‰πãË∑ØÂæàÊúâË∂£ÔºåÊòØÊé®Âä®‰∏ñÁïåÂâçËøõÁöÑÈáçË¶ÅÂäõÈáè„ÄÇ</li>
</ol>
<hr>
<h2 id="ËßÜÈ¢ëÊºîËÆ≤" tabindex="-1">ËßÜÈ¢ëÊºîËÆ≤ <a class="header-anchor" href="#ËßÜÈ¢ëÊºîËÆ≤" aria-label="Permalink to &quot;ËßÜÈ¢ëÊºîËÆ≤&quot;"></a></h2>
<ol>
<li><a href="https://asktug.com/t/topic/998896#h-2" target="_blank" rel="noreferrer">„Äê2022Âπ¥„ÄëTiDB Á§æÂå∫Âπ¥Â∫¶ÊÄªÁªì - Áâà‰∏ª - ËãèÂøóÈπèÔºàjansu-devÔºâ</a></li>
</ol>
<hr>
<h2 id="ËØÅ‰π¶Ëç£Ë™â" tabindex="-1">ËØÅ‰π¶Ëç£Ë™â <a class="header-anchor" href="#ËØÅ‰π¶Ëç£Ë™â" aria-label="Permalink to &quot;ËØÅ‰π¶Ëç£Ë™â&quot;"></a></h2>
<ol>
<li>
<p>Oracle OCP
<img src="./../images/oracle_ocp.jpg" alt="oracle_ocp"></p>
</li>
<li>
<p>TiDB PTCP(chinese version)
<img src="./../images/tidb_ptcp_chinest.jpg" alt="tidb_ptcp_chinest"></p>
</li>
<li>
<p>TiDB PTCA(english/global version)
<img src="./../images/tidb_ptca_global.jpg" alt="tidb_ptca_global"></p>
</li>
<li>
<p>TiDB PTCP(english/global version 6)
<img src="./../images/tidb_ptcp_global.jpg" alt="tidb_ptcp_global"></p>
</li>
<li>
<p>PostgreSQL PGCA
<img src="./../images/pg_pgca.jpg" alt="pg_pgca"></p>
</li>
<li>
<p>PostgreSQL PGCE
<img src="./../images/pg_pgce.jpg" alt="pg_pgce"></p>
</li>
<li>
<p>AskTUG MVA: <a href="https://asktug.com/t/topic/273501" target="_blank" rel="noreferrer">Áõ∏ÂÖ≥ÈìæÊé•</a>
<img src="./../images/asktug_mva.jpg" alt="asktug_mva"></p>
</li>
</ol>
<hr>
<h2 id="ÂÖ≥‰∫éÁîüÊ¥ª" tabindex="-1">ÂÖ≥‰∫éÁîüÊ¥ª <a class="header-anchor" href="#ÂÖ≥‰∫éÁîüÊ¥ª" aria-label="Permalink to &quot;ÂÖ≥‰∫éÁîüÊ¥ª&quot;"></a></h2>
]]></content:encoded>
            <enclosure url="https://askaric.com/images/header.jpg" length="0" type="image/jpg"/>
        </item>
        <item>
            <link>https://askaric.com/zh/life/coffee/20250214 my coffee.html</link>
            <guid>https://askaric.com/zh/life/coffee/20250214 my coffee.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[123123123]]></description>
            <content:encoded><![CDATA[<p>123123123</p>
<figure><img src="./../../../images/coffee-machine.jpg" alt="coffee-machine" tabindex="0"><figcaption>coffee-machine</figcaption></figure>
<figure><img src="./../../../images/coffee.jpg" alt="coffee-machine" tabindex="0"><figcaption>coffee-machine</figcaption></figure>
]]></content:encoded>
            <enclosure url="https://askaric.com/images/coffee-machine.jpg" length="0" type="image/jpg"/>
        </item>
        <item>
            <title><![CDATA[ÂíñÂï°ÂÖ•Èó®]]></title>
            <link>https://askaric.com/zh/life/coffee/basic.html</link>
            <guid>https://askaric.com/zh/life/coffee/basic.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[# ÂíñÂï°ÂÖ•Èó®

]]></description>
            <content:encoded><![CDATA[<h1 id="ÂíñÂï°ÂÖ•Èó®" tabindex="-1">ÂíñÂï°ÂÖ•Èó® <a class="header-anchor" href="#ÂíñÂï°ÂÖ•Èó®" aria-label="Permalink to &quot;ÂíñÂï°ÂÖ•Èó®&quot;"></a></h1>
<hr>
<h2 id="ÂíñÂï°ÂìÅÁßçÊ¶ÇËßà" tabindex="-1">ÂíñÂï°ÂìÅÁßçÊ¶ÇËßà <a class="header-anchor" href="#ÂíñÂï°ÂìÅÁßçÊ¶ÇËßà" aria-label="Permalink to &quot;ÂíñÂï°ÂìÅÁßçÊ¶ÇËßà&quot;"></a></h2>
<p><strong>1. ÂüÉÂ°û‰øÑÊØî‰∫öÂíñÂï°</strong></p>
<ul>
<li><strong>‰∫ßÂú∞</strong>: ÈùûÊ¥≤</li>
<li>ÁâπÂæÅ: ÊûúÂÆûÂ∞èÂûãÔºåÈ£éÂë≥ÂèØËÉΩÂ≠òÂú®ËæÉÂ§ßÁº∫Èô∑</li>
</ul>
<p><strong>2. Âà©ÊØîÈáå‰∫ö-Â§ßÁ≤íÁßç</strong></p>
<ul>
<li><strong>Êù•Ê∫êÂú∞</strong>: È©¨Êù•Ë•ø‰∫öÈùûÊ¥≤</li>
<li>ÁâπÂæÅ: È£éÂë≥Áõ∏ÂØπËæÉÂº±</li>
</ul>
<p><strong>3. ÁΩóÂ∏ÉÊñØÂ°î‰∏≠Á≤íÁßç</strong></p>
<ul>
<li><strong>‰∏ªË¶ÅÁßçÊ§çÂå∫</strong>: Â∑¥Ë•ø„ÄÅË∂äÂçó„ÄÅÂç∞Â∞ºÁ≠âÁÉ≠Â∏¶Âú∞Âå∫</li>
<li>ÁâπÂæÅ: Âº∫ÁÉàÊµìÈÉÅÔºåËã¶Ê∂©‰∏éËæõËæ£Áõ∏ÂØπÁ™ÅÂá∫ÔºåÂ∏ÇÂú∫Âç†ÊØîÁ∫¶30%</li>
</ul>
<p><strong>4. ÈòøÊãâÊØîÂç°Â∞èÁ≤íÁßç</strong></p>
<ul>
<li><strong>ÂàÜÂ∏ÉÂπøÊ≥õ</strong>: ÈùûÊ¥≤„ÄÅ‰∫öÊ¥≤„ÄÅÁæéÊ¥≤</li>
<li>ÁâπÂæÅ: Ê∏ÖÂáâÊ∏©ÂíåÔºåÂ∏¶Êúâ‰∏∞ÂØåÁöÑÊ∞¥ÊûúÂíåÂùöÊûúÈ¶ôÊ∞îÔºåÂ∏ÇÂú∫Âç†ÊØîÁ∫¶70%</li>
</ul>
<hr>
<p>ÈòøÊãâÊØîÂç°</p>
<ul>
<li>ÈìÅÁöÆÂç°ÁßçÔºö</li>
<li>Ê≥¢ÊóÅÁßçÔºö
ÈªÑ - Â∑ßÂÖãÂäõ ÂùöÊûú
Ê©ô - Ëä±Êûú ÁÉ≠Â∏¶Ê∞¥Êûú
Á≤â -</li>
<li>ËíôÂ§öËØ∫Ê≤ÉÁßçÔºöÊòØÈìÅÁöÆÂç°ÁßçÂèäÊ≥¢ÊóÅÁßçÁöÑÊ∑∑Ë°Ä</li>
<li>Âç°ÊùúÊãâÁßçÔºö Ê≥¢ÊóÅÁöÑËá™ÁÑ∂Á™ÅÂèòÁßçÔºåËæÉ‰ΩéÈÖ∏Â∫¶ÂíåÈÜáÂéöÂ∫¶</li>
<li>Âç°ÂõæËâæÁßçÔºöÂç°ÊùúÊãâÁßçÂèäËíôÂ§öËØ∫Ê≤ÉÁöÑ‰∫∫Â∑•ÊùÇ‰∫§ÁßçÔºå‰ΩéÈÖ∏ Â∑ßÂÖãÂäõÈ£éÂë≥</li>
<li>Âç°Ëø™ÂßÜÁßçÔºöÂç°ÊùúÊãâÂíåËíÇÂßÜÁöÑ‰∫∫‰∏≠ÊùÇ‰∫§ÁßçÔºåÈ£éÂë≥Áº∫Èô∑Ôºå‰ΩÜÊòØÊäóÁóÖËÉΩÂäõÂá∫Ëâ≤‰∫ßÈáèÈ´òÔºåÊòØ‰∏≠ÂõΩ‰∫ëÂçóÊó©Âπ¥ÂπøÊ≥õÁßçÊ§çÂìÅÁßç„ÄÇ</li>
<li>ËñáÊãâ¬∑ËµõÂ∞îÂ•áÁßçÔºöÊ≥¢ÊóÅÁöÑËá™ÁÑ∂Á™ÅÂèòÁßçÔºåÈ£éÂë≥ÂùáË°°ÔºåÁîúÊÑüÂçÅË∂≥„ÄÇ</li>
<li>Â∏ïÂç°ÊñØÁßçÔºöÊ≥¢ÊóÅÁöÑËá™ÁÑ∂Á™ÅÂèòÁßçÔºåÂíãÊòØÂùáË°°È°∫ÊªëÈÜáÈ¶ôÔºåÊúâÂ•∂Ê≤πÂùöÊûúÈ£éÂë≥„ÄÇ</li>
<li>È©¨ÊãâÊààÊó•ÁöÆÁßçÔºöÈìÅÁöÆÂç°ÁßçÁöÑËá™ÁÑ∂Á™ÅÂèòÁßçÔºàË±°Ë±ÜÔºâÔºåÂè£ÊÑüÊ∏ÖÊæà ÈÖ∏ÁîúÊ∏©Âíå ÂíñÂï°Âõ†Êª¥ÔºåÂùöÊûúÁÑ¶Á≥ñÊÉ≥Ëµ∑ÂçÅË∂≥„ÄÇ</li>
<li>Â∏ïÂç°È©¨ÊãâÁßçÔºöÂ∏ïÂç°ÊñØÂíåÈ©¨ÊãâÊààÊó•ÁöÆÁöÑ‰∫∫Â∑•ÊùÇ‰∫§ÁßçÔºåÂ§öÂ∑ßÂÖãÂäõÂèäÊ∞¥ÊûúÈ£éÂë≥Ôºå‰πüÂÆπÊòì‰∫ßÁîüËçâÊú¨Ê¥ãËë±Ëà¨ÁöÑÂºÇÂë≥„ÄÇ</li>
<li>SL 28 ÁßçÔºöÊ≥¢ÊóÅÁöÑ‰∫∫Â∑•ÈÄâËÇ≤ÁßçÔºåSL Êåá‰Ωç‰∫éËÇØÂ∏ù‰∫öÊñØÁßëÁâπÂÆûÈ™åÂÆ§Áº©ÂÜôÔºåÂè£ÊÑüÊâéÂÆû ÂùáË°° È°∫ÊªëÈÜáÈ¶ô È´òÁîú Á≤æËá¥ÁöÑÂπ≥Ë°° ‰∏∞ÂØåÁöÑÊûúÈÖ∏ÂíåÊµìÈÉÅÂè£ÊÑü ÈÄöÂ∏∏‰ª•ÈªëÈÜãÊ†óÊù•ÂΩ¢ÂÆπ„ÄÇ</li>
<li>SL 34 ÁßçÔºö‰∫∫Â∑•ÈÄâËÇ≤ÔºåÊúÄÊó©Ë¢´ËÆ§‰∏∫ÊòØÊ≥¢ÊóÅË°ÄÁªüÔºåÁé∞‰ª£ÂèëÁé∞Êù•Ëá™ÈìÅÁöÆÂç°ÁöÑÂü∫Âõ†Áæ§„ÄÇÂ∏¶ÊúâÊüëÊ©òÈÖ∏ÂíåÊµìÂéöÂè£ÊÑü„ÄÇ</li>
<li>ËÇØÁâπÁßçÔºöÈìÅÁöÆÂç°ÁöÑËá™ÁÑ∂Á™ÅÂèòÁßçÔºåÈ£éÂë≥‰∏çÁ™ÅÂá∫ÔºåÊäóÁóÖËÉΩÂäõÂº∫„ÄÇ</li>
<li>S 795 ÁßçÔºöËÇØÁâπÂíå S288 ÁöÑ‰∫∫Â∑•ÊùÇ‰∫§ÁßçÔºåÊúâÊû´Á≥ñÊµÜ ÁÑ¶Á≥ñ ÊµÖÈªÑÁ≥ñÁöÑÈ£éÂë≥ÔºåÁªßÊâø‰∫ÜËÇØÁâπÁöÑÊäóÁóÖËÉΩÂäõ„ÄÇ</li>
<li>ÂéüÂ£∞ÁßçÔºöÊú™Ë¢´ÂàÜÁ±ªÔºåËÄ∂Âä†Èõ™Ëè≤‰∫ßÂå∫„ÄÅË•øËææÊë©‰∫ßÂå∫„ÄÅÁë∞Â§èÁßç</li>
</ul>
<p>ÈòøÊãâÊØîÂç°ÂíñÂï°ÁßçÁ±ªÁπÅÂ§öÔºåÂÖ∂‰∏≠‰∏ªË¶ÅÂàÜ‰∏∫Âá†‰∏™Â§ßÁ±ªÂà´Ôºö</p>
<ol>
<li>
<p><strong>ÈìÅÁöÆÂç°Áßç</strong>Ôºö</p>
<ul>
<li><strong>ËíôÂ§öËØ∫Ê≤ÉÁßç</strong>ÔºöÁî±ÈìÅÁöÆÂç°ÂíåÊ≥¢ÊóÅÁßçÊùÇ‰∫§ËÄåÊàê„ÄÇ</li>
</ul>
</li>
<li>
<p><strong>Ê≥¢ÊóÅÁßç</strong>Ôºö</p>
<ul>
<li>ÈªÑËâ≤Ê≥¢ÊóÅÔºö‰ª•ÂÖ∂Â∑ßÂÖãÂäõÂíåÂùöÊûúÈ£éÂë≥ËëóÂêç„ÄÇ</li>
<li>Ê©ôËâ≤Ê≥¢ÊóÅÔºöÂÖ∑ÊúâËä±ÊûúÁÉ≠Â∏¶Ê∞¥ÊûúÁöÑÂë≥ÈÅì„ÄÇ</li>
<li>Á≤âËâ≤Ê≥¢ÊóÅÔºàÂÖ∑‰Ωì‰ø°ÊÅØÁº∫Â§±Ôºâ„ÄÇ</li>
</ul>
</li>
<li>
<p><strong>Ê∑∑ÂêàÁßç</strong>Ôºö</p>
<ul>
<li>Âç°ÊùúÊãâÁßçÔºöÊ≥¢ÊóÅÁöÑËá™ÁÑ∂ÂèòÂºÇÔºå‰ª•‰ΩéÈÖ∏Â∫¶ÂíåÈÜáÂéöËëóÁß∞„ÄÇ</li>
<li>Âç°ÂõæËâæÁßçÔºöÁªìÂêàÂç°ÊùúÊãâÂíåËíôÂ§öËØ∫Ê≤ÉÁöÑ‰∫∫Â∑•ÊùÇ‰∫§ÔºåÁâπÁÇπÊòØ‰ΩéÈÖ∏„ÄÅÂ∑ßÂÖãÂäõÈ£éÂë≥„ÄÇ</li>
</ul>
</li>
<li>
<p><strong>ÂÖ∂‰ªñÊùÇ‰∫§ÂìÅÁßç</strong>Ôºö</p>
<ul>
<li>Âç°Ëø™ÂßÜÁßçÔºö‰ΩéÈÖ∏ÔºåÈ´ò‰∫ßÊäóÁóÖÔºåÊõæÂú®‰∏≠ÂõΩ‰∫ëÂçóÂπøÊ≥õÁßçÊ§ç„ÄÇ</li>
<li>ËñáÊãâ¬∑ËµõÂ∞îÂ•áÁßçÔºöÈ£éÂë≥ÂùáË°°ÔºåÁîúÂë≥‰∏∞ÂØå„ÄÇ</li>
<li>Â∏ïÂç°ÊñØÁßçÔºöÂùáË°°È°∫ÊªëÔºåÂ•∂Ê≤πÂùöÊûúÈ£éÂë≥„ÄÇ</li>
<li>È©¨ÊãâÊààÊó•ÁöÆÁßçÔºöÊ∏ÖÁàΩÂè£ÊÑüÔºåÈÖ∏ÁîúÈÄÇ‰∏≠ÔºåÂ∏¶ÂùöÊûúÁÑ¶Á≥ñÈ¶ôÊ∞î„ÄÇ</li>
<li>Â∏ïÂç°È©¨ÊãâÁßçÔºöÂ∑ßÂÖãÂäõÂíåÊ∞¥ÊûúÈ£éÂë≥ÔºåÂèØËÉΩ‰º¥ÊúâËçâÊú¨ÂºÇÂë≥„ÄÇ</li>
<li>SL 28ÁßçÂíåSL 34ÁßçÔºö‰∫∫Â∑•ÈÄâËÇ≤ÔºåÂêÑÊúâÁâπËâ≤ÔºåÊØîÂ¶ÇSL 28ÊúâÈªëÈÜãÊ†óÈ£éÂë≥ÔºåSL 34ÂàôÊúâÊüëÊ©òÈÖ∏ÂíåÊµìÂéöÂè£ÊÑü„ÄÇ</li>
</ul>
</li>
<li>
<p><strong>Ëá™ÁÑ∂Á™ÅÂèòÁßç</strong>Ôºö</p>
<ul>
<li>ËÇØÁâπÁßçÔºöÈ£éÂë≥‰∏çÊòéÊòæ‰ΩÜÊäóÁóÖÂº∫„ÄÇ</li>
<li>S 795ÁßçÔºöËûçÂêàËÇØÁâπÂíåS288ÁöÑÁâπÊÄßÔºåÊúâÊû´Á≥ñ„ÄÅÁÑ¶Á≥ñÂíåÊµÖÈªÑÁ≥ñÂë≥ÈÅì„ÄÇ</li>
</ul>
</li>
<li>
<p><strong>Êú™ÂàÜÁ±ªÂéüÂ£∞Áßç</strong>Ôºö</p>
<ul>
<li>ËÄ∂Âä†Èõ™Ëè≤‰∫ßÂå∫„ÄÅË•øËææÊë©‰∫ßÂå∫ÂíåÁë∞Â§èÁßçÔºåËøô‰∫õÊ≤°ÊúâÁâπÂÆöÁöÑÂàÜÁ±ªÊ†áÂáÜ„ÄÇ</li>
</ul>
</li>
</ol>
<p>Êó•ÊôíÂ§ÑÁêÜÔºöÁîúÂë≥ÈÜáÂéöÂ∫¶È´ò
Ê∞¥Ê¥óÂ§ÑÁêÜÔºöÊ∞¥ÊµÆÂäõÂéªÈô§Êú™ÊàêÁÜüÊûúÂÆûÔºåÂá∫ÂìÅÁ®≥ÂÆöÔºåË±ÜÂ≠êÊôÆÈÅçÈ£éÂë≥Âπ≤ÂáÄÔºåÈÖ∏Â∫¶ËæÉÈ´òÔºåÈ¶ôÊ∞îÂ§çÊùÇ„ÄÇ
ËúúÂ§ÑÁêÜÔºö‰ªã‰∫é‰∫åËÄÖ‰πãÈó¥„ÄÇ</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[ËøôÊòØÁîüÊ¥ª]]></title>
            <link>https://askaric.com/zh/life/</link>
            <guid>https://askaric.com/zh/life/</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="ËøôÊòØÁîüÊ¥ª" tabindex="-1">ËøôÊòØÁîüÊ¥ª <a class="header-anchor" href="#ËøôÊòØÁîüÊ¥ª" aria-label="Permalink to &quot;ËøôÊòØÁîüÊ¥ª&quot;"></a></h1>
]]></content:encoded>
        </item>
        <item>
            <link>https://askaric.com/zh/life/motor/20250213 my motor.html</link>
            <guid>https://askaric.com/zh/life/motor/20250213 my motor.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[123123123]]></description>
            <content:encoded><![CDATA[<p>123123123</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[ËÅäËÅäÊªëÈõ™]]></title>
            <link>https://askaric.com/zh/life/skiing/20250212 learn about skiing.html</link>
            <guid>https://askaric.com/zh/life/skiing/20250212 learn about skiing.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[2025
&lt;iframe src="//player.bilibili.com/player.html?isOutside=true&aid=113991351272161&bvid=BV1rr]]></description>
            <content:encoded><![CDATA[<h1 id="ËÅäËÅäÊªëÈõ™" tabindex="-1">ËÅäËÅäÊªëÈõ™ <a class="header-anchor" href="#ËÅäËÅäÊªëÈõ™" aria-label="Permalink to &quot;ËÅäËÅäÊªëÈõ™&quot;"></a></h1>
<h2 id="_2025" tabindex="-1">2025 <a class="header-anchor" href="#_2025" aria-label="Permalink to &quot;2025&quot;"></a></h2>
<iframe src="//player.bilibili.com/player.html?isOutside=true&aid=113991351272161&bvid=BV1rrKLeQE7j&cid=28357560559&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"></iframe>
]]></content:encoded>
        </item>
        <item>
            <link>https://askaric.com/zh/life/tennis/20250213 my tennis.html</link>
            <guid>https://askaric.com/zh/life/tennis/20250213 my tennis.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[123123123]]></description>
            <content:encoded><![CDATA[<p>123123123</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[DocDB Êï∞ÊçÆÊî∂ÈõÜ]]></title>
            <link>https://askaric.com/zh/tihc/collect/docdb.html</link>
            <guid>https://askaric.com/zh/tihc/collect/docdb.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[# DocDB Êï∞ÊçÆÊî∂ÈõÜ

‰ΩøÁî® `tihc collect docdb` ÂëΩ‰ª§Êî∂ÈõÜÂ≠òÂÇ®Âú® TiDB ÈõÜÁæ§ Docdb ‰∏≠ TOPSQL ÁöÑ DocDB Áõ∏ÂÖ≥Êï∞ÊçÆ„ÄÇ

## Âø´ÈÄüÂºÄÂßã

```bash
# Êî∂ÈõÜÊúÄËøë5ÂàÜÈíüÁöÑ TopSQL Êï∞ÊçÆ
tihc collect docdb --instance 127.0.0.1:10080 --storage topsql.json

# ÊåáÂÆöÊó∂Èó¥ËåÉÂõ¥Êî∂ÈõÜÊï∞ÊçÆ
tihc collect docdb \
    --instance 127.0.0.1:10080 \
    --start 1744195176 \
    --end 1744195476 \
    --storage custom_topsql.json
```

## ‰∏ªË¶ÅÈÄâÈ°π

| ÈÄâÈ°π | ËØ¥Êòé | ÈªòËÆ§ÂÄº |
|]]></description>
            <content:encoded><![CDATA[<h1 id="docdb-Êï∞ÊçÆÊî∂ÈõÜ" tabindex="-1">DocDB Êï∞ÊçÆÊî∂ÈõÜ <a class="header-anchor" href="#docdb-Êï∞ÊçÆÊî∂ÈõÜ" aria-label="Permalink to &quot;DocDB Êï∞ÊçÆÊî∂ÈõÜ&quot;"></a></h1>
<p>‰ΩøÁî® <code>tihc collect docdb</code> ÂëΩ‰ª§Êî∂ÈõÜÂ≠òÂÇ®Âú® TiDB ÈõÜÁæ§ Docdb ‰∏≠ TOPSQL ÁöÑ DocDB Áõ∏ÂÖ≥Êï∞ÊçÆ„ÄÇ</p>
<h2 id="Âø´ÈÄüÂºÄÂßã" tabindex="-1">Âø´ÈÄüÂºÄÂßã <a class="header-anchor" href="#Âø´ÈÄüÂºÄÂßã" aria-label="Permalink to &quot;Âø´ÈÄüÂºÄÂßã&quot;"></a></h2>
<div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Êî∂ÈõÜÊúÄËøë5ÂàÜÈíüÁöÑ TopSQL Êï∞ÊçÆ</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tihc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> collect</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> docdb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --instance</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 127.0.0.1:10080</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --storage</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> topsql.json</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># ÊåáÂÆöÊó∂Èó¥ËåÉÂõ¥Êî∂ÈõÜÊï∞ÊçÆ</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tihc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> collect</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> docdb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    --instance</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 127.0.0.1:10080</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    --start</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1744195176</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    --end</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1744195476</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    --storage</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> custom_topsql.json</span></span></code></pre>
</div><h2 id="‰∏ªË¶ÅÈÄâÈ°π" tabindex="-1">‰∏ªË¶ÅÈÄâÈ°π <a class="header-anchor" href="#‰∏ªË¶ÅÈÄâÈ°π" aria-label="Permalink to &quot;‰∏ªË¶ÅÈÄâÈ°π&quot;"></a></h2>
<table tabindex="0">
<thead>
<tr>
<th>ÈÄâÈ°π</th>
<th>ËØ¥Êòé</th>
<th>ÈªòËÆ§ÂÄº</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>--instance &lt;INSTANCE&gt;</code></td>
<td>ÂÆû‰æãÂú∞ÂùÄÔºåÊ†ºÂºè‰∏∫ ip:port</td>
<td>127.0.0.1:10080</td>
</tr>
<tr>
<td><code>--ngurl &lt;NGURL&gt;</code></td>
<td>NG Monitor Âú∞ÂùÄ</td>
<td>127.0.0.1:12020</td>
</tr>
<tr>
<td><code>--start &lt;START&gt;</code></td>
<td>ÂºÄÂßãÊó∂Èó¥Êà≥</td>
<td>1744195176</td>
</tr>
<tr>
<td><code>--end &lt;END&gt;</code></td>
<td>ÁªìÊùüÊó∂Èó¥Êà≥</td>
<td>1744195476</td>
</tr>
<tr>
<td><code>--window &lt;WINDOW&gt;</code></td>
<td>Êó∂Èó¥Á™óÂè£Â§ßÂ∞è</td>
<td>2s</td>
</tr>
<tr>
<td><code>--top &lt;TOP&gt;</code></td>
<td>ËøîÂõûÁªìÊûúÊï∞ÈáèÈôêÂà∂</td>
<td>10000</td>
</tr>
<tr>
<td><code>--storage &lt;STORAGE&gt;</code></td>
<td>Êï∞ÊçÆÂ≠òÂÇ®Êñá‰ª∂Ë∑ØÂæÑ</td>
<td>topsql.json</td>
</tr>
<tr>
<td><code>-l, --log-file &lt;LOG_FILE&gt;</code></td>
<td>Êó•ÂøóÊñá‰ª∂Ë∑ØÂæÑ</td>
<td>tihc_started_at_20250409_184436.log</td>
</tr>
<tr>
<td><code>-L, --log-level &lt;LOG_LEVEL&gt;</code></td>
<td>Êó•ÂøóÁ∫ßÂà´Ôºàtrace„ÄÅdebug„ÄÅinfo„ÄÅwarn„ÄÅerrorÔºâ</td>
<td>info</td>
</tr>
</tbody>
</table>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Collect Pprof]]></title>
            <link>https://askaric.com/zh/tihc/collect/pprof.html</link>
            <guid>https://askaric.com/zh/tihc/collect/pprof.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[# Collect Pprof

ÂÆûÁî® tihc collect pprof ÂëΩ‰ª§ÔºåÊî∂ÈõÜ TiDB ÈõÜÁæ§‰∏≠ÂêÑÁªÑ‰ª∂ÁöÑ pprof ‰ø°ÊÅØ„ÄÇ

## Âø´ÈÄüÂºÄÂßã

```bash
tihc collect pprof -a IP_ADDRESS:2379 \
    -c pd \
    -t goroutine \
    -o /tmp/pd_goroutine
```


## ‰∏ªË¶ÅÈÄâÈ°π

| ÈÄâÈ°π | ËØ¥Êòé | ÈªòËÆ§ÂÄº |
|]]></description>
            <content:encoded><![CDATA[<h1 id="collect-pprof" tabindex="-1">Collect Pprof <a class="header-anchor" href="#collect-pprof" aria-label="Permalink to &quot;Collect Pprof&quot;"></a></h1>
<p>ÂÆûÁî® tihc collect pprof ÂëΩ‰ª§ÔºåÊî∂ÈõÜ TiDB ÈõÜÁæ§‰∏≠ÂêÑÁªÑ‰ª∂ÁöÑ pprof ‰ø°ÊÅØ„ÄÇ</p>
<h2 id="Âø´ÈÄüÂºÄÂßã" tabindex="-1">Âø´ÈÄüÂºÄÂßã <a class="header-anchor" href="#Âø´ÈÄüÂºÄÂßã" aria-label="Permalink to &quot;Âø´ÈÄüÂºÄÂßã&quot;"></a></h2>
<div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tihc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> collect</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> pprof</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> IP_ADDRESS:2379</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    -c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> pd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    -t</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> goroutine</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /tmp/pd_goroutine</span></span></code></pre>
</div><h2 id="‰∏ªË¶ÅÈÄâÈ°π" tabindex="-1">‰∏ªË¶ÅÈÄâÈ°π <a class="header-anchor" href="#‰∏ªË¶ÅÈÄâÈ°π" aria-label="Permalink to &quot;‰∏ªË¶ÅÈÄâÈ°π&quot;"></a></h2>
<table tabindex="0">
<thead>
<tr>
<th>ÈÄâÈ°π</th>
<th>ËØ¥Êòé</th>
<th>ÈªòËÆ§ÂÄº</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-a, --address &lt;IP:PORT&gt;</code></td>
<td>ÂÆû‰æãÂú∞ÂùÄÔºàtidb/tikv/pd ÁªÑ‰ª∂ÂøÖÈúÄÔºâÔºåÊ†ºÂºè‰∏∫ ip:portÔºå‰æãÂ¶ÇÔºö127.0.0.1:2379</td>
<td>-</td>
</tr>
<tr>
<td><code>-c, --component &lt;COMPONENT&gt;</code></td>
<td>Ë¶ÅÊî∂ÈõÜÁöÑÁªÑ‰ª∂ÔºåÂèØÈÄâÂÄºÔºötidb„ÄÅtikv„ÄÅpd„ÄÅbr</td>
<td>-</td>
</tr>
<tr>
<td><code>-t, --collection-type &lt;COLLECTION_TYPE&gt;</code></td>
<td>Êî∂ÈõÜÁ±ªÂûãÔºåÂèØÈÄâÂÄºÔºöconfig„ÄÅprofile„ÄÅmutex„ÄÅheap„ÄÅgoroutine</td>
<td>-</td>
</tr>
<tr>
<td><code>-o, --output &lt;OUTPUT&gt;</code></td>
<td>Êî∂ÈõÜÊï∞ÊçÆÁöÑÂ≠òÂÇ®Ë∑ØÂæÑÔºàgoroutine Êî∂ÈõÜÂèØÈÄâÔºâ</td>
<td>-</td>
</tr>
<tr>
<td><code>-P, --processid &lt;PROCESSID&gt;</code></td>
<td>ËøõÁ®ã IDÔºàbr ÁªÑ‰ª∂ÂøÖÈúÄÔºâ</td>
<td>-</td>
</tr>
<tr>
<td><code>-s, --seconds &lt;SECONDS&gt;</code></td>
<td>ÊÄßËÉΩÂàÜÊûêÊåÅÁª≠Êó∂Èó¥ÔºàÁßíÔºâ</td>
<td>60</td>
</tr>
<tr>
<td><code>-l, --log-file &lt;LOG_FILE&gt;</code></td>
<td>Êó•ÂøóÊñá‰ª∂Ë∑ØÂæÑ</td>
<td>tihc_started_at_20250320_143949.log</td>
</tr>
<tr>
<td><code>-L, --log-level &lt;LOG_LEVEL&gt;</code></td>
<td>Êó•ÂøóÁ∫ßÂà´Ôºàtrace„ÄÅdebug„ÄÅinfo„ÄÅwarn„ÄÅerrorÔºâ</td>
<td>info</td>
</tr>
</tbody>
</table>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[TiHC (TiDB Health Checker)]]></title>
            <link>https://askaric.com/zh/tihc/</link>
            <guid>https://askaric.com/zh/tihc/</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[TiHC ÊòØ Aric ‰∏ì‰∏∫ TiDB ÂàÜÂ∏ÉÂºèÊï∞ÊçÆÂ∫ìËÆæËÆ°ÁöÑÂëΩ‰ª§Ë°åÂ∑•ÂÖ∑ÈõÜÔºåÊó®Âú®ÁÆÄÂåñ TiDB ÁöÑÊó•Â∏∏ËøêÁª¥„ÄÅÈóÆÈ¢òËØäÊñ≠ÂíåÊÄßËÉΩÂàÜÊûêÂ∑•‰Ωú„ÄÇ‰Ωú‰∏∫‰∏ÄÊ¨æ‰∏ì‰∏öÁöÑÊï∞ÊçÆÂ∫ìÂÅ•Â∫∑Ê£ÄÊü•Â∑•ÂÖ∑ÔºåTiHC ËÉΩÂ§üÂ∏ÆÂä© DBA ÂíåÂºÄÂèë‰∫∫Âëò]]></description>
            <content:encoded><![CDATA[<h1 id="tihc-tidb-health-checker" tabindex="-1">TiHC (TiDB Health Checker) <a class="header-anchor" href="#tihc-tidb-health-checker" aria-label="Permalink to &quot;TiHC (TiDB Health Checker)&quot;"></a></h1>
<p>TiHC ÊòØ <a href="./../about.html">Aric</a> ‰∏ì‰∏∫ TiDB ÂàÜÂ∏ÉÂºèÊï∞ÊçÆÂ∫ìËÆæËÆ°ÁöÑÂëΩ‰ª§Ë°åÂ∑•ÂÖ∑ÈõÜÔºåÊó®Âú®ÁÆÄÂåñ TiDB ÁöÑÊó•Â∏∏ËøêÁª¥„ÄÅÈóÆÈ¢òËØäÊñ≠ÂíåÊÄßËÉΩÂàÜÊûêÂ∑•‰Ωú„ÄÇ‰Ωú‰∏∫‰∏ÄÊ¨æ‰∏ì‰∏öÁöÑÊï∞ÊçÆÂ∫ìÂÅ•Â∫∑Ê£ÄÊü•Â∑•ÂÖ∑ÔºåTiHC ËÉΩÂ§üÂ∏ÆÂä© DBA ÂíåÂºÄÂèë‰∫∫ÂëòÂø´ÈÄüÂèëÁé∞Âπ∂Ëß£ÂÜ≥ TiDB ÈõÜÁæ§‰∏≠ÁöÑÊΩúÂú®ÈóÆÈ¢ò„ÄÇ</p>
<h2 id="üöÄ-‰∏ªË¶ÅÁâπÊÄß" tabindex="-1">üöÄ ‰∏ªË¶ÅÁâπÊÄß <a class="header-anchor" href="#üöÄ-‰∏ªË¶ÅÁâπÊÄß" aria-label="Permalink to &quot;üöÄ ‰∏ªË¶ÅÁâπÊÄß&quot;"></a></h2>
<ul>
<li><strong>ËΩªÈáèÂåñ</strong>: ËΩØ‰ª∂Êú¨Ë∫´ËΩªÈáèÔºåÂØπÊï∞ÊçÆÂ∫ìÊó†‰æµÂÖ•ÔºåÂèØÂú®‰ªª‰ΩïÁéØÂ¢É‰∏≠ÂÆâÂÖ®ËøêË°å</li>
<li><strong>ÊòìÁî®ÊÄß</strong>: ‰ªÖÈÄöËøáÂëΩ‰ª§Ë°åÁïåÈù¢Âø´ÈÄüÂÆö‰ΩçÂíåËß£ÂÜ≥Â∏∏ËßÅÈóÆÈ¢òÔºåÊó†ÈúÄÂ§çÊùÇÈÖçÁΩÆ</li>
</ul>
<h2 id="üí°-‰ΩøÁî®Âú∫ÊôØ" tabindex="-1">üí° ‰ΩøÁî®Âú∫ÊôØ <a class="header-anchor" href="#üí°-‰ΩøÁî®Âú∫ÊôØ" aria-label="Permalink to &quot;üí° ‰ΩøÁî®Âú∫ÊôØ&quot;"></a></h2>
<h2 id="üì¶-ÂÆâË£ÖÂíå‰ΩøÁî®" tabindex="-1">üì¶ ÂÆâË£ÖÂíå‰ΩøÁî® <a class="header-anchor" href="#üì¶-ÂÆâË£ÖÂíå‰ΩøÁî®" aria-label="Permalink to &quot;üì¶ ÂÆâË£ÖÂíå‰ΩøÁî®&quot;"></a></h2>
<h3 id="Ê∫êÁ†ÅÊûÑÂª∫" tabindex="-1">Ê∫êÁ†ÅÊûÑÂª∫ <a class="header-anchor" href="#Ê∫êÁ†ÅÊûÑÂª∫" aria-label="Permalink to &quot;Ê∫êÁ†ÅÊûÑÂª∫&quot;"></a></h3>
<div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># ÂÖãÈöÜ‰ª£Á†ÅÂ∫ì</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> clone</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> https://github.com/AricSu/tihc.git</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># ÁºñËØë</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tihc</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">make</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># ËøêË°å</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">./tihc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --help</span></span></code></pre>
</div><h3 id="‰∫åËøõÂà∂‰∏ãËΩΩ" tabindex="-1">‰∫åËøõÂà∂‰∏ãËΩΩ <a class="header-anchor" href="#‰∫åËøõÂà∂‰∏ãËΩΩ" aria-label="Permalink to &quot;‰∫åËøõÂà∂‰∏ãËΩΩ&quot;"></a></h3>
<p>‰ªé GitHub ÂèëÂ∏ÉÈ°µ‰∏ãËΩΩÈ¢ÑÁºñËØëÁöÑ‰∫åËøõÂà∂Êñá‰ª∂Ôºö</p>
<ol>
<li>
<p>ËÆøÈóÆ <a href="https://github.com/aricsu/tihc/releases" target="_blank" rel="noreferrer">TiHC Releases</a> È°µÈù¢</p>
</li>
<li>
<p>‰∏ãËΩΩÂØπÂ∫îÊìç‰ΩúÁ≥ªÁªüÁöÑ‰∫åËøõÂà∂Êñá‰ª∂Ôºö</p>
<ul>
<li>macOS: <code>tihc-darwin-amd64.tar.gz</code></li>
</ul>
</li>
<li>
<p>Ëß£Âéã‰∏ãËΩΩÁöÑÊñá‰ª∂Ôºö</p>
</li>
</ol>
<div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tar</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -xvf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tihc-darwin-amd64.tar.gz</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">chmod</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> +x</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tihc</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">./tihc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --help</span></span></code></pre>
</div><h3 id="‰∏ÄÈîÆÂÆâË£Ö-macos" tabindex="-1">‰∏ÄÈîÆÂÆâË£ÖÔºàmacOSÔºâ <a class="header-anchor" href="#‰∏ÄÈîÆÂÆâË£Ö-macos" aria-label="Permalink to &quot;‰∏ÄÈîÆÂÆâË£ÖÔºàmacOSÔºâ&quot;"></a></h3>
<div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -fsSL</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> https://raw.githubusercontent.com/AricSu/tihc/master/scripts/install.sh</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> bash</span></span></code></pre>
</div><h2 id="üîç-‰ΩøÁî®ÊåáÂçó" tabindex="-1">üîç ‰ΩøÁî®ÊåáÂçó <a class="header-anchor" href="#üîç-‰ΩøÁî®ÊåáÂçó" aria-label="Permalink to &quot;üîç ‰ΩøÁî®ÊåáÂçó&quot;"></a></h2>
<h3 id="Âü∫Êú¨Áî®Ê≥ï" tabindex="-1">Âü∫Êú¨Áî®Ê≥ï <a class="header-anchor" href="#Âü∫Êú¨Áî®Ê≥ï" aria-label="Permalink to &quot;Âü∫Êú¨Áî®Ê≥ï&quot;"></a></h3>
<div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Êü•ÁúãÂ∏ÆÂä©‰ø°ÊÅØ</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">./tihc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --help</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># ËæìÂá∫</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tihc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1.0.0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Author:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Aric</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">TiHC</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> CLI</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Tool</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Email:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> askaric@gmail.com</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Doc:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> https://www.askaric.com/en/tihc</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">USAGE:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    tihc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [OPTIONS] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">&#x3C;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">SUBCOMMAND</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">OPTIONS:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    -h,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --help</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                     Print</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> help</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> information</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    -l,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --log-file</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> &#x3C;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">LOG_FIL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">E</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      Log</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> file</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> path</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [default: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">tihc_started_at_20250320_142358.log]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    -L,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --log-level</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> &#x3C;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">LOG_LEVE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">L</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    Log</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> level</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (trace, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">debug,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> info,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> warn,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) [default: info]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    -V,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --version</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                  Print</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> version</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> information</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SUBCOMMANDS:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    collect</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    Collect</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> info</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> TiDB</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> components</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (tidb, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">tikv,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> pd,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> br</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    help</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       Print</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> this</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> message</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> or</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> help</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> given</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> subcommand</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">s</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span></code></pre>
</div><h2 id="ü§ù-Ë¥°ÁåÆ‰∏éÊîØÊåÅ" tabindex="-1">ü§ù Ë¥°ÁåÆ‰∏éÊîØÊåÅ <a class="header-anchor" href="#ü§ù-Ë¥°ÁåÆ‰∏éÊîØÊåÅ" aria-label="Permalink to &quot;ü§ù Ë¥°ÁåÆ‰∏éÊîØÊåÅ&quot;"></a></h2>
<ul>
<li>ÈóÆÈ¢òÂèçÈ¶àÔºö<a href="https://github.com/aricsu/tihc/issues" target="_blank" rel="noreferrer">GitHub Issues</a></li>
<li>ÊñáÊ°£Ôºö<a href="https://www.askaric.com/zh/tihc" target="_blank" rel="noreferrer">ÂÆåÊï¥ÊñáÊ°£</a></li>
<li>ËÅîÁ≥ª‰ΩúËÄÖÔºöask.aric.su@gmail.com</li>
</ul>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Ëß£ÊûêÊÖ¢Êó•Âøó]]></title>
            <link>https://askaric.com/zh/tihc/tools/slowlog.html</link>
            <guid>https://askaric.com/zh/tihc/tools/slowlog.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[# Ëß£ÊûêÊÖ¢Êó•Âøó

‰ΩøÁî® `tihc tools slowlog` ÂëΩ‰ª§Ëß£Êûê TiDB ÈõÜÁæ§ÁöÑÊÖ¢Êü•ËØ¢Êó•ÂøóÊñá‰ª∂ÔºåÂπ∂‰ª•ÂºÇÊ≠•ÁöÑÊñπÂºèÂØºÂÖ•‰ªªÊÑè‰∏é MySQL ÂÖºÂÆπÁöÑÊï∞ÊçÆÂ∫ì‰∏≠‰ª•‰æøÂàÜÊûê„ÄÇ

## ‰ΩøÁî®Âú∫ÊôØ

Âú®ÂàÜÊûê TiDB ÈõÜÁæ§ÊÄßËÉΩÈóÆÈ¢òÊó∂ÔºåÊÖ¢Êü•ËØ¢Êó•ÂøóÔºàslow logÔºâÊòØÂàÜÊûêÊÄßËÉΩÈóÆÈ¢òÁöÑÈáçË¶ÅÊï∞ÊçÆÊù•Ê∫ê„ÄÇÈÄöÂ∏∏Êàë‰ª¨ÂèØ‰ª•ÈÄöËøá‰ª•‰∏ãÊñπÂºèÂàÜÊûêÊÖ¢Êü•ËØ¢Ôºå‰ΩøÁî® [TiDB Dashboard](https://docs.pingcap.com/zh/tidb/v7.5/dashboard-slow-query/) ËøõË°åÂú®Á∫øÂàÜÊûê„ÄÇ

![TiDB Dashboard](https://docs-download.pingcap.com/media/images/docs-cn/dashboard/dashboard-slow-queries-list1-v620.png)


‰ΩÜÁ±ª‰ºº‰ª•‰∏ãÂú∫ÊôØ‰∏≠ÔºåÊàë‰ª¨ÈúÄË¶Å‰∏ÄÁßçÊõ¥ÁÅµÊ¥ªÁöÑÂàÜÊûêÊñπÂºèÔºö
- Êó†Ê≥ïËÆøÈóÆ Dashboard
- Êó†Ê≥ïËøûÊé•Êï∞ÊçÆÂ∫ìÊü•ËØ¢ [information_schema.cluster_slow_query](https://docs.pingcap.com/zh/tidb/v7.5/information-schema-slow-query/#cluster_slow_query-table)
- ÈúÄË¶ÅÂØπÂéÜÂè≤Êï∞ÊçÆËøõË°åÁ¶ªÁ∫øÂàÜÊûê
- **ÈúÄË¶ÅËøõË°åÂ§çÊùÇÁöÑÁªüËÆ°ÂàÜÊûêÔºàÂ¶ÇÔºöÂàÜÊûêÊüêÁ±ª Slow SQL ÁöÑÊó∂Èó¥ÂàÜÂ∏ÉÔºâ**

`tihc tools slowlog` ÂëΩ‰ª§ÂèØ‰ª•Â∞ÜÊÖ¢Êü•ËØ¢Êó•ÂøóËß£ÊûêÂπ∂ÂØºÂÖ•Âà∞Êï∞ÊçÆÂ∫ì‰∏≠ÔºåÊîØÊåÅ‰ΩøÁî® SQL ËøõË°åÁÅµÊ¥ªÁöÑÊü•ËØ¢ÂíåÁªüËÆ°ÂàÜÊûê„ÄÇ


## ‰ΩøÁî®ÊñπÊ≥ï

1. ÂáÜÂ§á TiDB ÈõÜÁæ§

```bash
aric@MacBook ~ % curl --proto '=https' --tlsv1.2 -sSf https://tiup-mirrors.pingcap.com/install.sh | sh

aric@MacBook ~ % source ${your_shell_profile}

aric@MacBook ~ % tiup playground
üéâ TiDB Playground Cluster is started, enjoy!

Connect TiDB:    mysql --comments --host 127.0.0.1 --port 4000 -u root
TiDB Dashboard:  http://127.0.0.1:2379/dashboard
Grafana:         http://127.0.0.1:3000

```

2. Á°ÆÂÆöÊÖ¢Êü•ËØ¢Êó•Âøó‰ΩçÁΩÆ

```bash
aric@MacBook tidb_slow_query-2025-03 % cd /Downloads/tidb_slow_query-2025-03
aric@MacBook tidb_slow_query-2025-03 % ll
total 821464
-rw-r--r--@ 1 aric  staff   38140064  3 27 15:52 tidb.log
-rw-r--r--@ 1 aric  staff  314572718  3 26 00:57 tidb_slow_query-2025-03-25T16-57-07.979.log
-rw-r--r--@ 1 aric  staff   67874170  4  7 17:27 tidb_slow_query.log

```


3. Ëß£ÊûêÊÖ¢Êó•ÂøóÊñá‰ª∂ÂÖ•Ë°®

```bash
aric@MacBook tidb_slow_query-2025-03 % tihc tools slowlog \
    --host 127.0.0.1:4000 \
    --log-dir /Downloads/tidb_slow_query-2025-03 \
    --pattern "tidb_.*.log"

==================================================
Command: slowlog
Status: Success
Duration: 15.974513708s
==================================================
```

4. Ê£ÄÊü•ÂØºÂÖ•ÁªìÊûú
```sql
aric@MacBook Downloads % mysql --comments --host 127.0.0.1 --port 4000 -u root                         

mysql> use tihc

mysql> show tables;
+]]></description>
            <content:encoded><![CDATA[<h1 id="Ëß£ÊûêÊÖ¢Êó•Âøó" tabindex="-1">Ëß£ÊûêÊÖ¢Êó•Âøó <a class="header-anchor" href="#Ëß£ÊûêÊÖ¢Êó•Âøó" aria-label="Permalink to &quot;Ëß£ÊûêÊÖ¢Êó•Âøó&quot;"></a></h1>
<p>‰ΩøÁî® <code>tihc tools slowlog</code> ÂëΩ‰ª§Ëß£Êûê TiDB ÈõÜÁæ§ÁöÑÊÖ¢Êü•ËØ¢Êó•ÂøóÊñá‰ª∂ÔºåÂπ∂‰ª•ÂºÇÊ≠•ÁöÑÊñπÂºèÂØºÂÖ•‰ªªÊÑè‰∏é MySQL ÂÖºÂÆπÁöÑÊï∞ÊçÆÂ∫ì‰∏≠‰ª•‰æøÂàÜÊûê„ÄÇ</p>
<h2 id="‰ΩøÁî®Âú∫ÊôØ" tabindex="-1">‰ΩøÁî®Âú∫ÊôØ <a class="header-anchor" href="#‰ΩøÁî®Âú∫ÊôØ" aria-label="Permalink to &quot;‰ΩøÁî®Âú∫ÊôØ&quot;"></a></h2>
<p>Âú®ÂàÜÊûê TiDB ÈõÜÁæ§ÊÄßËÉΩÈóÆÈ¢òÊó∂ÔºåÊÖ¢Êü•ËØ¢Êó•ÂøóÔºàslow logÔºâÊòØÂàÜÊûêÊÄßËÉΩÈóÆÈ¢òÁöÑÈáçË¶ÅÊï∞ÊçÆÊù•Ê∫ê„ÄÇÈÄöÂ∏∏Êàë‰ª¨ÂèØ‰ª•ÈÄöËøá‰ª•‰∏ãÊñπÂºèÂàÜÊûêÊÖ¢Êü•ËØ¢Ôºå‰ΩøÁî® <a href="https://docs.pingcap.com/zh/tidb/v7.5/dashboard-slow-query/" target="_blank" rel="noreferrer">TiDB Dashboard</a> ËøõË°åÂú®Á∫øÂàÜÊûê„ÄÇ</p>
<figure><img src="https://docs-download.pingcap.com/media/images/docs-cn/dashboard/dashboard-slow-queries-list1-v620.png" alt="TiDB Dashboard" tabindex="0"><figcaption>TiDB Dashboard</figcaption></figure>
<p>‰ΩÜÁ±ª‰ºº‰ª•‰∏ãÂú∫ÊôØ‰∏≠ÔºåÊàë‰ª¨ÈúÄË¶Å‰∏ÄÁßçÊõ¥ÁÅµÊ¥ªÁöÑÂàÜÊûêÊñπÂºèÔºö</p>
<ul>
<li>Êó†Ê≥ïËÆøÈóÆ Dashboard</li>
<li>Êó†Ê≥ïËøûÊé•Êï∞ÊçÆÂ∫ìÊü•ËØ¢ <a href="https://docs.pingcap.com/zh/tidb/v7.5/information-schema-slow-query/#cluster_slow_query-table" target="_blank" rel="noreferrer">information_schema.cluster_slow_query</a></li>
<li>ÈúÄË¶ÅÂØπÂéÜÂè≤Êï∞ÊçÆËøõË°åÁ¶ªÁ∫øÂàÜÊûê</li>
<li><strong>ÈúÄË¶ÅËøõË°åÂ§çÊùÇÁöÑÁªüËÆ°ÂàÜÊûêÔºàÂ¶ÇÔºöÂàÜÊûêÊüêÁ±ª Slow SQL ÁöÑÊó∂Èó¥ÂàÜÂ∏ÉÔºâ</strong></li>
</ul>
<p><code>tihc tools slowlog</code> ÂëΩ‰ª§ÂèØ‰ª•Â∞ÜÊÖ¢Êü•ËØ¢Êó•ÂøóËß£ÊûêÂπ∂ÂØºÂÖ•Âà∞Êï∞ÊçÆÂ∫ì‰∏≠ÔºåÊîØÊåÅ‰ΩøÁî® SQL ËøõË°åÁÅµÊ¥ªÁöÑÊü•ËØ¢ÂíåÁªüËÆ°ÂàÜÊûê„ÄÇ</p>
<h2 id="‰ΩøÁî®ÊñπÊ≥ï" tabindex="-1">‰ΩøÁî®ÊñπÊ≥ï <a class="header-anchor" href="#‰ΩøÁî®ÊñπÊ≥ï" aria-label="Permalink to &quot;‰ΩøÁî®ÊñπÊ≥ï&quot;"></a></h2>
<ol>
<li>ÂáÜÂ§á TiDB ÈõÜÁæ§</li>
</ol>
<div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">aric@MacBook</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ~</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --proto</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> '=https'</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --tlsv1.2</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -sSf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> https://tiup-mirrors.pingcap.com/install.sh</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> sh</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">aric@MacBook</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ~</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> source</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ${your_shell_profile}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">aric@MacBook</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ~</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tiup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> playground</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">üéâ</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> TiDB</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Playground</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> started,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> enjoy!</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Connect</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> TiDB:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    mysql</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --comments</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --host</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 127.0.0.1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --port</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 4000</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> root</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">TiDB</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Dashboard:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  http://127.0.0.1:2379/dashboard</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Grafana:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">         http://127.0.0.1:3000</span></span></code></pre>
</div><ol start="2">
<li>Á°ÆÂÆöÊÖ¢Êü•ËØ¢Êó•Âøó‰ΩçÁΩÆ</li>
</ol>
<div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">aric@MacBook</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb_slow_query-2025-03</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /Downloads/tidb_slow_query-2025-03</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">aric@MacBook</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb_slow_query-2025-03</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ll</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">total</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 821464</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">-rw-r--r--@</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> aric</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  staff</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   38140064</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  3</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 27</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 15:52</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb.log</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">-rw-r--r--@</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> aric</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  staff</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  314572718</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  3</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 26</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 00:57</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb_slow_query-2025-03-25T16-57-07.979.log</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">-rw-r--r--@</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> aric</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  staff</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   67874170</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  4</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  7</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 17:27</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb_slow_query.log</span></span></code></pre>
</div><ol start="3">
<li>Ëß£ÊûêÊÖ¢Êó•ÂøóÊñá‰ª∂ÂÖ•Ë°®</li>
</ol>
<div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">aric@MacBook</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb_slow_query-2025-03</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tihc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tools</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> slowlog</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    --host</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 127.0.0.1:4000</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    --log-dir</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /Downloads/tidb_slow_query-2025-03</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    --pattern</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "tidb_.*.log"</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">==================================================</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Command:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> slowlog</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Status:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Success</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Duration:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 15.974513708s</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">==================================================</span></span></code></pre>
</div><ol start="4">
<li>Ê£ÄÊü•ÂØºÂÖ•ÁªìÊûú</li>
</ol>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">aric@MacBook Downloads % mysql </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">--comments --host 127.0.0.1 --port 4000 -u root                         </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">mysql</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> tihc</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">mysql</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> show tables;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">--------------------+</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| Tables_in_tihc     |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">--------------------+</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| CLUSTER_SLOW_QUERY |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">--------------------+</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> row</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> in</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> sec)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">mysql</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> select</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> CLUSTER_SLOW_QUERY;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">----------+</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">----------+</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">|    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">88522</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">----------+</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> row</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> in</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> sec)</span></span></code></pre>
</div><ol start="5">
<li>ÂàÜÊûêÊÖ¢Êü•ËØ¢Êó•Âøó
ÂèØ‰ª•ÁúãÂà∞ Digest = '12aee6550cdb84e9b42b0bdafff971ed4f4917faa7509129c56a0341fc127050' ÁöÑ SQL Âú® 2025-03-26 21:00:00 ÔΩû 2025-03-26 21:00:00 Âá∫Áé∞ÊúÄÂ§öÔºåÊü•ËØ¢‰πüÊúÄÊÖ¢„ÄÇ</li>
</ol>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">mysql</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    DATE_FORMAT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">Time</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'%Y-%m-%d %H:00:00'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> hour_time,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    COUNT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> frequency,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    AVG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(Query_time) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> avg_query_time,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    MAX</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(Query_time) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> max_query_time,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    MIN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">LEFT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(Query, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> query_sample</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">FROM</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> tihc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">CLUSTER_SLOW_QUERY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    Digest</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> '12aee6550cdb84e9b42b0bdafff971ed4f4917faa7509129c56a0341fc127050'</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">GROUP BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    DATE_FORMAT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">Time</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'%Y-%m-%d %H:00:00'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    hour_time </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">ASC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">---------------------+-----------+---------------------+----------------+----------------------+</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| hour_time           | frequency | avg_query_time      | max_query_time | query_sample         |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">---------------------+-----------+---------------------+----------------+----------------------+</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">18</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 21</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |        </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">19</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">4493804775789474</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">606918439</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_id,base_ |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">19</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 18</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |         </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |          </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">32581528</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">338701305</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_id,base_ |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">19</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 21</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |         </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |        </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">3377161814</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |     </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">34657984</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_id,base_ |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 02</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |         </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |          </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">33664294</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">355553451</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_id,base_ |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 13</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |         </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |         </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">314235047</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">314235047</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_id,base_ |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 18</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |         </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |          </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">47384816</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |     </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">47384816</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_id,base_ |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 23</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |         </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |         </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">344667988</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">360696473</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_id,base_ |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">22</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 15</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |         </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |         </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">325766261</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">325766261</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_id,base_ |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">22</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 19</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |         </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |         </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">364963524</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">364963524</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_id,base_ |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">24</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 11</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |         </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">35267484299999996</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">387675187</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_id,base_ |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">25</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 15</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |         </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">5252397500000001</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">550156766</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_id,base_ |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">26</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |         </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |         </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">303821168</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">303821168</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_id,base_ |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">26</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 15</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |        </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">19</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">3894580074210525</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">486571348</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_id,base_ |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">26</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 16</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |        </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">12</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">6510478335833334</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">736003024</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_id,base_ |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">26</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 17</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |        </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">24</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">7259553074999999</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">322673489</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_id,base_ |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">26</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 18</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |        </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">22</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">9133352314545455</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">009928439</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_id,base_ |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">26</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 19</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |        </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">12</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">35154566491666667</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">505610509</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_id,base_ |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">26</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |         </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">9</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">3434320862222227</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">374194282</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_id,base_ |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">26</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 21</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |        </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">96</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">9793197923125003</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">519375406</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_id,base_ |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">26</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 23</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |        </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">39</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">4582763911025642</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">269301483</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_id,base_ |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">27</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |        </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">34</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">8496621455294118</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">047704387</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_id,base_ |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">27</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 01</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |        </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">16</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |     </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">8533504235625</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">043561618</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_id,base_ |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">27</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 02</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |        </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">13</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">5850548099230768</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |      </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">6326255</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_id,base_ |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">27</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 03</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |        </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">40</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">6741900960500005</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">825635187</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_id,base_ |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">27</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 05</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |        </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">29</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">4251187663793108</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">882324567</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_id,base_ |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">27</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 06</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |        </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">12</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">5653918619166668</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">602165939</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_id,base_ |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">27</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 07</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |        </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">25</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">8880253696799998</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">409791623</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_id,base_ |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">27</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 13</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |        </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">12</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">6974716397499999</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">749698881</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_id,base_ |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">27</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 14</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |        </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">15</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">8890294175333332</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">939996461</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_id,base_ |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2025</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">27</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 15</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |        </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">54</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">9239673954629628</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">684070904</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_id,base_ |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">---------------------+-----------+---------------------+----------------+----------------------+</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">30</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> rows</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> in</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">09</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> sec)</span></span></code></pre>
</div><h2 id="‰∏ªË¶ÅÈÄâÈ°π" tabindex="-1">‰∏ªË¶ÅÈÄâÈ°π <a class="header-anchor" href="#‰∏ªË¶ÅÈÄâÈ°π" aria-label="Permalink to &quot;‰∏ªË¶ÅÈÄâÈ°π&quot;"></a></h2>
<table tabindex="0">
<thead>
<tr>
<th>ÈÄâÈ°π</th>
<th>ËØ¥Êòé</th>
<th>ÈªòËÆ§ÂÄº</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-a, --host &lt;HOST:PORT&gt;</code></td>
<td>TiDB ÊúçÂä°Âô®Âú∞ÂùÄÔºå‰æãÂ¶ÇÔºö127.0.0.1:4000</td>
<td>-</td>
</tr>
<tr>
<td><code>-b, --batch-size &lt;BATCH_SIZE&gt;</code></td>
<td>ÊØèÊâπÂ§ÑÁêÜÁöÑËÆ∞ÂΩïÊï∞Èáè</td>
<td>64</td>
</tr>
<tr>
<td><code>-d, --database &lt;DATABASE&gt;</code></td>
<td>ÂØºÂÖ•ÊÖ¢Êü•ËØ¢Êï∞ÊçÆÁöÑÁõÆÊ†áÊï∞ÊçÆÂ∫ìÂêç</td>
<td>tihc</td>
</tr>
<tr>
<td><code>-D, --log-dir &lt;DIR&gt;</code></td>
<td>TiDB ÊÖ¢Êü•ËØ¢Êó•ÂøóÊñá‰ª∂ÊâÄÂú®ÁõÆÂΩï</td>
<td>-</td>
</tr>
<tr>
<td><code>-p, --password &lt;PASSWORD&gt;</code></td>
<td>TiDB Êï∞ÊçÆÂ∫ìÂØÜÁ†Å</td>
<td>&quot;&quot;</td>
</tr>
<tr>
<td><code>-u, --user &lt;USER&gt;</code></td>
<td>TiDB Êï∞ÊçÆÂ∫ìÁî®Êà∑Âêç</td>
<td>root</td>
</tr>
<tr>
<td><code>-t, --pattern &lt;PATTERN&gt;</code></td>
<td>ÊÖ¢Êü•ËØ¢Êó•ÂøóÊñá‰ª∂ÂêçÂåπÈÖçÊ®°ÂºèÔºå‰æãÂ¶ÇÔºö&quot;tidb-slow*.log&quot;</td>
<td>-</td>
</tr>
<tr>
<td><code>--timezone &lt;TIMEZONE&gt;</code></td>
<td>‰Ω†ÊâÄÂú®ÁöÑÊó∂Âå∫ (Â¶ÇÔºöUTC+8)ÔºåÁî®‰∫éÁ°Æ‰øùÂØºÂÖ•Êï∞ÊçÆÁöÑÊó∂Èó¥‰∏éÊó•ÂøóÊñá‰ª∂‰∏≠Êó∂Èó¥ÁöÑ<strong>Â≠óÈù¢ÂÄº</strong>‰∏ÄËá¥</td>
<td>UTC</td>
</tr>
<tr>
<td><code>-l, --log-file &lt;LOG_FILE&gt;</code></td>
<td>Êó•ÂøóÊñá‰ª∂Ë∑ØÂæÑ</td>
<td>tihc_started_at_*.log</td>
</tr>
<tr>
<td><code>-L, --log-level &lt;LOG_LEVEL&gt;</code></td>
<td>Êó•ÂøóÁ∫ßÂà´Ôºàtrace„ÄÅdebug„ÄÅinfo„ÄÅwarn„ÄÅerrorÔºâ</td>
<td>info</td>
</tr>
</tbody>
</table>
<h2 id="cluster-slow-query" tabindex="-1">CLUSTER_SLOW_QUERY <a class="header-anchor" href="#cluster-slow-query" aria-label="Permalink to &quot;CLUSTER_SLOW_QUERY&quot;"></a></h2>
<p>tihc.CLUSTER_SLOW_QUERY ‰∏é TiDB ÊÖ¢Êü•ËØ¢Êó•ÂøóÊñá‰ª∂ÁöÑÂ≠óÊÆµ‰∏Ä‰∏ÄÂØπÂ∫îÔºå <strong>‰ªÖÁº∫Â∞ë INSTANCE Â≠óÊÆµÔºåÂõ†‰∏∫ slow log ‰∏≠Ê≤°ÊúâËÆ∞ÂΩïËØ•ÂÄº</strong>„ÄÇ</p>
<ol>
<li>TiDB ÊÖ¢Êó•Âøó‰ªãÁªçÔºåËØ∑ÂèÇËÄÉ<a href="https://docs.pingcap.com/zh/tidb/v7.5/identify-slow-queries" target="_blank" rel="noreferrer">ÂÆòÊñπ‰ªãÁªç</a></li>
<li>TiDB ÁöÑ CLUSTER_SLOW_QUERYÔºåËØ∑ÂèÇËÄÉ<a href="https://docs.pingcap.com/zh/tidb/stable/information-schema-slow-query/#cluster_slow_query-table" target="_blank" rel="noreferrer">ÂÆòÊñπ‰ªãÁªç</a></li>
</ol>
]]></content:encoded>
            <enclosure url="https://docs-download.pingcap.com/media/images/docs-cn/dashboard/dashboard-slow-queries-list1-v620.png" length="0" type="image/png"/>
        </item>
        <item>
            <title><![CDATA[ÁîüÊ¥ªÊñπÂºè]]></title>
            <link>https://askaric.com/zh/work/english/01Âü∫Á°ÄËã±ËØ≠/1-1Âú∫ÊôØ_ÁîüÊ¥ªÊñπÂºè.html</link>
            <guid>https://askaric.com/zh/work/english/01Âü∫Á°ÄËã±ËØ≠/1-1Âú∫ÊôØ_ÁîüÊ¥ªÊñπÂºè.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[First of all

1. ‰ΩøÁî®ÊñπÂºèÂâØËØçÂíåÂΩ¢ÂÆπËØçË∞àËÆ∫‰∫∫‰ª¨ÁöÑË°å‰∏∫  
2. Âú®ÂΩ¢ÂÆπËØçÂâç‰ΩøÁî®ÂâØËØçÂΩ¢ÂÆπ‰∫∫ÁöÑ‰∏™ÊÄß
3. ‰ΩøÁî® `always` ÂíåÂä®ËØçËøõË°åÊó∂ÊèèËø∞‰π†ÊÉØ
4. ‰ΩøÁî® `at lea]]></description>
            <content:encoded><![CDATA[<h1 id="ÁîüÊ¥ªÊñπÂºè" tabindex="-1">ÁîüÊ¥ªÊñπÂºè <a class="header-anchor" href="#ÁîüÊ¥ªÊñπÂºè" aria-label="Permalink to &quot;ÁîüÊ¥ªÊñπÂºè&quot;"></a></h1>
<h2 id="first-of-all" tabindex="-1">First of all <a class="header-anchor" href="#first-of-all" aria-label="Permalink to &quot;First of all&quot;"></a></h2>
<ol>
<li>‰ΩøÁî®ÊñπÂºèÂâØËØçÂíåÂΩ¢ÂÆπËØçË∞àËÆ∫‰∫∫‰ª¨ÁöÑË°å‰∏∫</li>
<li>Âú®ÂΩ¢ÂÆπËØçÂâç‰ΩøÁî®ÂâØËØçÂΩ¢ÂÆπ‰∫∫ÁöÑ‰∏™ÊÄß</li>
<li>‰ΩøÁî® <code>always</code> ÂíåÂä®ËØçËøõË°åÊó∂ÊèèËø∞‰π†ÊÉØ</li>
<li>‰ΩøÁî® <code>at least</code> ÊåáÂá∫Áä∂ÂÜµÁöÑÁßØÊûÅÈù¢</li>
</ol>
<h2 id="about-grammar" tabindex="-1">About grammar <a class="header-anchor" href="#about-grammar" aria-label="Permalink to &quot;About grammar&quot;"></a></h2>
<ol>
<li>
<p>ÂΩ¢ÂÆπËØç + ÂêçÊ¨°<br>
a. It's a patient person.</p>
</li>
<li>
<p>Âä®ËØç + ÊñπÂºèÂâØËØç<br>
a. I wait patiently in lines.</p>
</li>
<li>
<p>Â∏∏ËßÑÁöÑÂâØËØç<br>
a. Patient --&gt; patiently.</p>
</li>
<li>
<p>ÈùûÂ∏∏ËßÑÂâØËØç<br>
a. good --&gt; well<br>
b. late --&gt; late<br>
c. fast --&gt; hard<br>
d. hard --&gt; hard</p>
</li>
<li>
<p>be, feel, get, etc + ÂΩ¢ÂÆπËØç<br>
a. I'm patient<br>
b. His voice sounds terrible.<br>
c. He gets reckless sometimes.</p>
</li>
</ol>
<h2 id="about-content" tabindex="-1">About content <a class="header-anchor" href="#about-content" aria-label="Permalink to &quot;About content&quot;"></a></h2>
<h2 id="new-words" tabindex="-1">New words <a class="header-anchor" href="#new-words" aria-label="Permalink to &quot;New words&quot;"></a></h2>
<ol>
<li>reckless</li>
<li>considerate</li>
<li>impeccable</li>
</ol>
<h2 id="new-phrases" tabindex="-1">New Phrases <a class="header-anchor" href="#new-phrases" aria-label="Permalink to &quot;New Phrases&quot;"></a></h2>
<ol>
<li>honk your horn</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[ÂéÜÂè≤ÁªèÈ™å]]></title>
            <link>https://askaric.com/zh/work/english/01Âü∫Á°ÄËã±ËØ≠/1-2Âú∫ÊôØ_ÂéÜÂè≤ÁªèÈ™å.html</link>
            <guid>https://askaric.com/zh/work/english/01Âü∫Á°ÄËã±ËØ≠/1-2Âú∫ÊôØ_ÂéÜÂè≤ÁªèÈ™å.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[ËØæÁ®ãÂÜÖÂÆπ

1. ‰ΩøÁî®Áé∞Âú®ÂÆåÊàêÊó∂ÂéªË∞àËÆ∫ÁªèÈ™åÂíåÁßòÂØÜÁöÑÊ¢¶ÊÉ≥
2. ‰ΩøÁî®ÂÆåÊàêÊó∂ÂéªËØ¢ÈóÆ‰∏çÂØªÂ∏∏ÁªèÈ™å
3. ÊåÅÁª≠Êé®ËøõÂØπËØùËøõË°å
4. ‰ΩøÁî® `Do you? Have you? etc` ÂèñÂ±ïÁ§∫‰Ω†ÊòØÊÑüÂÖ¥Ë∂£]]></description>
            <content:encoded><![CDATA[<h1 id="ÂéÜÂè≤ÁªèÈ™å" tabindex="-1">ÂéÜÂè≤ÁªèÈ™å <a class="header-anchor" href="#ÂéÜÂè≤ÁªèÈ™å" aria-label="Permalink to &quot;ÂéÜÂè≤ÁªèÈ™å&quot;"></a></h1>
<h2 id="ËØæÁ®ãÂÜÖÂÆπ" tabindex="-1">ËØæÁ®ãÂÜÖÂÆπ <a class="header-anchor" href="#ËØæÁ®ãÂÜÖÂÆπ" aria-label="Permalink to &quot;ËØæÁ®ãÂÜÖÂÆπ&quot;"></a></h2>
<ol>
<li>‰ΩøÁî®Áé∞Âú®ÂÆåÊàêÊó∂ÂéªË∞àËÆ∫ÁªèÈ™åÂíåÁßòÂØÜÁöÑÊ¢¶ÊÉ≥</li>
<li>‰ΩøÁî®ÂÆåÊàêÊó∂ÂéªËØ¢ÈóÆ‰∏çÂØªÂ∏∏ÁªèÈ™å</li>
<li>ÊåÅÁª≠Êé®ËøõÂØπËØùËøõË°å</li>
<li>‰ΩøÁî® <code>Do you? Have you? etc</code> ÂèñÂ±ïÁ§∫‰Ω†ÊòØÊÑüÂÖ¥Ë∂£ÁöÑ</li>
</ol>
<h2 id="ËØæÁ®ãËØ≠Ê≥ï" tabindex="-1">ËØæÁ®ãËØ≠Ê≥ï <a class="header-anchor" href="#ËØæÁ®ãËØ≠Ê≥ï" aria-label="Permalink to &quot;ËØæÁ®ãËØ≠Ê≥ï&quot;"></a></h2>
<ol>
<li>
<p>Áé∞Âú®ÂÆåÊàêÊó∂Áî®‰∫éÁé∞Âú®‰πãÂâç‰∏çÁ°ÆÂÆöÊó∂Èó¥ÁöÑ‰∫ã‰ª∂
a. I've been to Europe.<br>
b. We've had a lot of fun.</p>
</li>
<li>
<p>Áé∞Âú®ÂÆåÊàêÊó∂Â∏∏‰∏éËøô‰∫õ È¢ëÁéáË°®Ëææ ËøûÁî®
a. I've always wanted to study acting.
b. We've gone sailing once/twice/many times.</p>
</li>
<li>
<p>Ê≥®ÊÑèÔºö‰∫∫‰ª¨ÊòØÂ¶Ç‰ΩïÁî®beenÂíågoneÊù•Ë∞àËÆ∫ÊóÖË°åÁõÆÁöÑÂú∞ÁöÑ
a. I've been to paris.
b. She's gone to Paris.</p>
</li>
<li>
<p>‰∏ÄËà¨ËøáÂéªÊó∂Áî®‰∫éËøáÂéªÁöÑÁâπÂÆö‰∫ã‰ª∂ÊàñÊó∂Èó¥
a. Did you have good time? --&gt; Yes, I did, but I fell off the raft.</p>
</li>
</ol>
<h2 id="Êñ∞ÂçïËØç" tabindex="-1">Êñ∞ÂçïËØç <a class="header-anchor" href="#Êñ∞ÂçïËØç" aria-label="Permalink to &quot;Êñ∞ÂçïËØç&quot;"></a></h2>
<ol>
<li>raft</li>
</ol>
<h2 id="Êñ∞ËØçÁªÑ" tabindex="-1">Êñ∞ËØçÁªÑ <a class="header-anchor" href="#Êñ∞ËØçÁªÑ" aria-label="Permalink to &quot;Êñ∞ËØçÁªÑ&quot;"></a></h2>
<ol>
<li>fell off</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[ÁÆ°ÁêÜÁîüÊ¥ª]]></title>
            <link>https://askaric.com/zh/work/english/01Âü∫Á°ÄËã±ËØ≠/1-3Âú∫ÊôØ_ÁÆ°ÁêÜÁîüÊ¥ª.html</link>
            <guid>https://askaric.com/zh/work/english/01Âü∫Á°ÄËã±ËØ≠/1-3Âú∫ÊôØ_ÁÆ°ÁêÜÁîüÊ¥ª.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[ÂÖ≥‰∫éÂÜÖÂÆπ

1. ‰ΩøÁî® `will, be going to the present continuous, and the simple present` Ë∞àËÆ∫Êú™Êù•ËßÑÂàíÂèäËÆ°Âàí
2. ‰ΩøÁî® `o]]></description>
            <content:encoded><![CDATA[<h1 id="ÁÆ°ÁêÜÁîüÊ¥ª" tabindex="-1">ÁÆ°ÁêÜÁîüÊ¥ª <a class="header-anchor" href="#ÁÆ°ÁêÜÁîüÊ¥ª" aria-label="Permalink to &quot;ÁÆ°ÁêÜÁîüÊ¥ª&quot;"></a></h1>
<h2 id="ÂÖ≥‰∫éÂÜÖÂÆπ" tabindex="-1">ÂÖ≥‰∫éÂÜÖÂÆπ <a class="header-anchor" href="#ÂÖ≥‰∫éÂÜÖÂÆπ" aria-label="Permalink to &quot;ÂÖ≥‰∫éÂÜÖÂÆπ&quot;"></a></h2>
<ol>
<li>‰ΩøÁî® <code>will, be going to the present continuous, and the simple present</code> Ë∞àËÆ∫Êú™Êù•ËßÑÂàíÂèäËÆ°Âàí</li>
<li>‰ΩøÁî® <code>ought to, have got to, would rather, had better, etc</code> ËÆ®ËÆ∫ÈóÆÈ¢òÂíåËß£ÂÜ≥ÊñπÊ°à</li>
<li>‰ΩøÁî® <code>I'd better go</code> ËøôÊ†∑ÁöÑË°®ËææÊù•ÁªìÊùüÁîµËØù‰∫§Ë∞à</li>
<li>‰ΩøÁî®Á±ª‰ºº‰∫é <code>Call you later</code> ËøôÊ†∑ÁöÑË°®ËææÊñπÂºèËØ¥ÂÜçËßÅ</li>
</ol>
<h2 id="ÂÖ≥‰∫éËØ≠Ê≥ï" tabindex="-1">ÂÖ≥‰∫éËØ≠Ê≥ï <a class="header-anchor" href="#ÂÖ≥‰∫éËØ≠Ê≥ï" aria-label="Permalink to &quot;ÂÖ≥‰∫éËØ≠Ê≥ï&quot;"></a></h2>
<ol>
<li>
<p>ÂΩì‰Ω†ËØ¥ËØùÊó∂ÂÜ≥ÂÆöÂÅöÊüê‰∫ãÊó∂ÔºåÁî® <code>will</code>„ÄÇ
a. I'll just stop by my apartment to get changed and then i'll come right over to meet you.</p>
</li>
<li>
<p>ÂØπ‰∫é‰∫ãÂÆû‰ø°ÊÅØÊàñÂü∫‰∫é‰Ω†ÊâÄÁü•ÈÅìÁöÑÈ¢ÑÊµãÔºå‰ΩøÁî® <code>will</code> Êàñ <code>be going to</code>„ÄÇ
a. You're goning to out of town, bu you'll be back Friday?</p>
</li>
<li>
<p>Áî®Áé∞Âú®ËøõË°åÊó∂Êàñ <code>be going to</code> (ËÄå‰∏çÊòØ <code>will</code>) Êù•Ë°®Á§∫‰Ω†Â∑≤ÁªèÂÅöÂá∫ÁöÑÂÜ≥ÂÆöÂíåÂõ∫ÂÆöÁöÑËÆ°Âàí„ÄÇ
a. I'm meeting Anna after my kickboaxing class.</p>
</li>
<li>
<p>ÂØπ‰∫éÊó•Â∏∏ËÆ°ÂàíÔºå‰ΩøÁî®‰∏ÄËà¨Áé∞Âú®Êó∂Ë°®Ëææ„ÄÇ
a. I have my kickboxing class tomorrow, It stats at 7:00.</p>
</li>
<li>
<p>What's advisable.  You'd better do something quickly.</p>
</li>
<li>
<p>What's nessary. I'm going to have to do something about it.</p>
</li>
<li>
<p>What's preferable. I'd rather stay in my current job.</p>
</li>
<li>
<p>Âú®ÂèãÂ•ΩÊàñÈùûÊ≠£ÂºèÁöÑÁîµËØù‰∫§Ë∞à‰∏≠Ôºå‰Ω†ÂèØ‰ª•‰ΩøÁî®Ëøô‰∫õÁÆÄÁü≠ÁöÑË°®ËææÊù•ËØ¥ÂÜçËßÅÊàñÊåÇÊú∫„ÄÇ
a. Talk to you later
b. Catch you later
c. See you later
d. Got to go<br>
e. better go
f. nice talking to you</p>
</li>
</ol>
<h2 id="Êñ∞ÂçïËØç" tabindex="-1">Êñ∞ÂçïËØç <a class="header-anchor" href="#Êñ∞ÂçïËØç" aria-label="Permalink to &quot;Êñ∞ÂçïËØç&quot;"></a></h2>
<ol>
<li>parentheses</li>
</ol>
<h2 id="Êñ∞ËØçÁªÑ" tabindex="-1">Êñ∞ËØçÁªÑ <a class="header-anchor" href="#Êñ∞ËØçÁªÑ" aria-label="Permalink to &quot;Êñ∞ËØçÁªÑ&quot;"></a></h2>
<ol>
<li>come right over to do</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[ÊäÄÊúØ‰∏ìÂÆ∂]]></title>
            <link>https://askaric.com/zh/work/english/01Âü∫Á°ÄËã±ËØ≠/1-4Âú∫ÊôØ_ÊäÄÊúØ‰∏ìÂÆ∂.html</link>
            <guid>https://askaric.com/zh/work/english/01Âü∫Á°ÄËã±ËØ≠/1-4Âú∫ÊôØ_ÊäÄÊúØ‰∏ìÂÆ∂.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[ÂÖ≥‰∫éÂÜÖÂÆπ

1. Âú®Âè•Â≠ê‰∏≠‰ΩøÁî®ÁñëÈóÆÂè•Ë∞àËÆ∫ÊäÄÊúØÈóÆÈ¢ò„ÄÇ
2. Áî®ÂèØÂàÜÁ¶ªÂä®ËØçÁü≠ËØ≠(Â¶Ç turn on Âíå plug in)ÊèèËø∞‰∫ãÁâ©ÊòØÂ¶Ç‰ΩïÂ∑•‰ΩúÁöÑ„ÄÇ
3. ‰ΩøÁî®how to + verb, where ]]></description>
            <content:encoded><![CDATA[<h1 id="ÊäÄÊúØ‰∏ìÂÆ∂" tabindex="-1">ÊäÄÊúØ‰∏ìÂÆ∂ <a class="header-anchor" href="#ÊäÄÊúØ‰∏ìÂÆ∂" aria-label="Permalink to &quot;ÊäÄÊúØ‰∏ìÂÆ∂&quot;"></a></h1>
<h2 id="ÂÖ≥‰∫éÂÜÖÂÆπ" tabindex="-1">ÂÖ≥‰∫éÂÜÖÂÆπ <a class="header-anchor" href="#ÂÖ≥‰∫éÂÜÖÂÆπ" aria-label="Permalink to &quot;ÂÖ≥‰∫éÂÜÖÂÆπ&quot;"></a></h2>
<ol>
<li>Âú®Âè•Â≠ê‰∏≠‰ΩøÁî®ÁñëÈóÆÂè•Ë∞àËÆ∫ÊäÄÊúØÈóÆÈ¢ò„ÄÇ</li>
<li>Áî®ÂèØÂàÜÁ¶ªÂä®ËØçÁü≠ËØ≠(Â¶Ç turn on Âíå plug in)ÊèèËø∞‰∫ãÁâ©ÊòØÂ¶Ç‰ΩïÂ∑•‰ΩúÁöÑ„ÄÇ</li>
<li>‰ΩøÁî®how to + verb, where to + verb, etc Êù•ÂØªÊ±ÇÊäÄÊúØÂ∏ÆÂä©„ÄÇ</li>
<li>Âè¶‰∏ÄÊñπÈù¢ÔºåÁî®ÂÉè on the other hand Ë°®ËææÊñπÂºèÁªôÂá∫‰∏çÂêåÁöÑÊÑèËßÅ„ÄÇ</li>
<li>Áî® you know what i mean? ÂéªËØ∑Ê±ÇÊüê‰∫∫ÂêåÊÑè‰Ω†ÁöÑËßÇÁÇπ„ÄÇ</li>
</ol>
<h2 id="ÂÖ≥‰∫éËØ≠Ê≥ï" tabindex="-1">ÂÖ≥‰∫éËØ≠Ê≥ï <a class="header-anchor" href="#ÂÖ≥‰∫éËØ≠Ê≥ï" aria-label="Permalink to &quot;ÂÖ≥‰∫éËØ≠Ê≥ï&quot;"></a></h2>
<ol>
<li>
<p>Áõ¥Êé•ÊèêÈóÆ
a. What's the problem?</p>
</li>
<li>
<p>ÁñëÈóÆÂè•‰∏≠ÁöÑÈóÆÂè•
a. Do you know what the problem is?</p>
</li>
<li>
<p>ÈôàËø∞Âè•‰∏≠ÁöÑÈóÆÈ¢òÂè•
a. I don't know what the problem is.</p>
</li>
<li>
<p>Â∏¶ÂÆæËØ≠ÁöÑÂèØÂàÜÁ¶ªÂä®ËØçÁü≠ËØ≠
a. How do you turn on the game controller?</p>
</li>
<li>
<p>Ë°®ËææÁ±ªÂûã Ôºö ÁñëÈóÆËØç + to + verb<br>
a. Let me show you what to do
b. Can you show me how to turn it on?
c. Do you know where to plug it in?</p>
</li>
</ol>
<h2 id="Êñ∞ÂçïËØç" tabindex="-1">Êñ∞ÂçïËØç <a class="header-anchor" href="#Êñ∞ÂçïËØç" aria-label="Permalink to &quot;Êñ∞ÂçïËØç&quot;"></a></h2>
<ol>
<li>antivirus</li>
<li>separable</li>
<li>phrasal</li>
</ol>
<h2 id="Êñ∞ËØçÁªÑ" tabindex="-1">Êñ∞ËØçÁªÑ <a class="header-anchor" href="#Êñ∞ËØçÁªÑ" aria-label="Permalink to &quot;Êñ∞ËØçÁªÑ&quot;"></a></h2>
<ol>
<li>hook it up</li>
<li>look it up</li>
<li>pick it up</li>
<li>put it down</li>
<li>print it out</li>
<li>put them on</li>
<li>take them off</li>
<li>take it apart</li>
<li>throw it away</li>
<li>turn it down</li>
<li>turn it up</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Âç∞Ë±°Ê∑±Âàª]]></title>
            <link>https://askaric.com/zh/work/english/01Âü∫Á°ÄËã±ËØ≠/1-5Âú∫ÊôØ_Âç∞Ë±°Ê∑±Âàª.html</link>
            <guid>https://askaric.com/zh/work/english/01Âü∫Á°ÄËã±ËØ≠/1-5Âú∫ÊôØ_Âç∞Ë±°Ê∑±Âàª.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[ÂÖ≥‰∫éÂÜÖÂÆπ

1. Ë°®Á§∫Êé®ÊµãÊó∂Ôºå‰ΩøÁî® must, may, might, can't, Âíå could.
2. ÊèèËø∞Áä∂ÂÜµÂíåÊÑüËßâÊó∂Ôºå‰ΩøÁî®‰ª• ing Âíå ed ÁªìÂ∞æÁöÑÂΩ¢ÂÆπËØç
3. Â±ïÁ§∫‰Ω†ÁêÜËß£Âè¶‰∏Ä‰∏™‰∫∫]]></description>
            <content:encoded><![CDATA[<h1 id="Âç∞Ë±°Ê∑±Âàª" tabindex="-1">Âç∞Ë±°Ê∑±Âàª <a class="header-anchor" href="#Âç∞Ë±°Ê∑±Âàª" aria-label="Permalink to &quot;Âç∞Ë±°Ê∑±Âàª&quot;"></a></h1>
<h2 id="ÂÖ≥‰∫éÂÜÖÂÆπ" tabindex="-1">ÂÖ≥‰∫éÂÜÖÂÆπ <a class="header-anchor" href="#ÂÖ≥‰∫éÂÜÖÂÆπ" aria-label="Permalink to &quot;ÂÖ≥‰∫éÂÜÖÂÆπ&quot;"></a></h2>
<ol>
<li>Ë°®Á§∫Êé®ÊµãÊó∂Ôºå‰ΩøÁî® must, may, might, can't, Âíå could.</li>
<li>ÊèèËø∞Áä∂ÂÜµÂíåÊÑüËßâÊó∂Ôºå‰ΩøÁî®‰ª• ing Âíå ed ÁªìÂ∞æÁöÑÂΩ¢ÂÆπËØç</li>
<li>Â±ïÁ§∫‰Ω†ÁêÜËß£Âè¶‰∏Ä‰∏™‰∫∫ÁöÑÊÑüËßâÊàñÁä∂ÂÜµ</li>
<li>‰ΩøÁî® you see ÂèñÂ±ïÁ§∫‰∏ÄÁßçÁä∂ÂÜµÂíå I see Ë°®ËææÊàëÊáÇ‰∫Ü</li>
</ol>
<h2 id="ÂÖ≥‰∫éËØ≠Ê≥ï" tabindex="-1">ÂÖ≥‰∫éËØ≠Ê≥ï <a class="header-anchor" href="#ÂÖ≥‰∫éËØ≠Ê≥ï" aria-label="Permalink to &quot;ÂÖ≥‰∫éËØ≠Ê≥ï&quot;"></a></h2>
<ol>
<li>
<p>ËøôÈáåÊúâ‰∏Ä‰∏™Ë°®ÊèèËø∞‰∫Ü‰∏çÂêåÂçïËØçÁöÑÂèØËÉΩÊÄß„ÄÇ</p>
<table tabindex="0">
<thead>
<tr>
<th>modal verb</th>
<th>possibility</th>
</tr>
</thead>
<tbody>
<tr>
<td>must</td>
<td>100%</td>
</tr>
<tr>
<td>bet</td>
<td>100%</td>
</tr>
<tr>
<td>can</td>
<td>80%</td>
</tr>
<tr>
<td>may</td>
<td>50%</td>
</tr>
<tr>
<td>could</td>
<td>50%</td>
</tr>
<tr>
<td>might</td>
<td>30%</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>‰ª• -ed ÁªìÂ∞æÁöÑÂΩ¢ÂÆπËØçÂèØ‰ª•ÊèèËø∞‰Ω†ÂØπÊüê‰∫∫ÊàñÊüê‰∫ãÁöÑÊÑüËßâ„ÄÇ
a. I'm bored with my job.
b. That means I am feeling bored when doing my job.</p>
</li>
<li>
<p>‰ª• -ing ÁªìÂ∞æÁöÑÂΩ¢ÂÆπËØçÂèØ‰ª•Áî®Êù•ÊèèËø∞Êüê‰∫∫ÊàñÊüêÁâ©„ÄÇ
a. My job is very boring.
b. That means  I think job is boring.</p>
</li>
</ol>
<h2 id="Êñ∞ÂçïËØç" tabindex="-1">Êñ∞ÂçïËØç <a class="header-anchor" href="#Êñ∞ÂçïËØç" aria-label="Permalink to &quot;Êñ∞ÂçïËØç&quot;"></a></h2>
<ol>
<li>fascinated</li>
<li>embarrassed</li>
<li>annoyed</li>
<li>frustrating</li>
<li>shocked</li>
<li>anxious</li>
<li>spill</li>
<li>jealous</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Ê≥ïÂæã‰∏éÁß©Â∫è]]></title>
            <link>https://askaric.com/zh/work/english/02Ëã±ËØ≠Âè£ËØ≠/2-10Âú∫ÊôØ_Ê≥ïÂæã‰∏éÁß©Â∫è.html</link>
            <guid>https://askaric.com/zh/work/english/02Ëã±ËØ≠Âè£ËØ≠/2-10Âú∫ÊôØ_Ê≥ïÂæã‰∏éÁß©Â∫è.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[ÂÖ≥‰∫éÂÜÖÂÆπ

1. ‰ΩøÁî®ÊÉÖÊÄÅÂä®ËØçË¢´Âä®ËØ≠ÊÄÅÊù•ËÆ®ËÆ∫Ê¥ªÂä®ÁöÑÊ≥ïÂÆöÂπ¥ÈæÑ„ÄÇ
2. ÂÖ≥‰∫éÁäØÁΩ™ÂíåÊÉ©ÁΩö‰ΩøÁî®getË¢´Âä®ËØ≠ÊÄÅÁöÑË°®Ê†º„ÄÇ
3. Áî®‚ÄúFirst of all‚ÄùÁ≠âËØçÁªÑÁªá‰Ω†ÁöÑËßÇÁÇπ„ÄÇ
4. Áî®‚ÄúËøôÊòØ‰∏Ä‰∏™Â•ΩËßÇÁÇπ]]></description>
            <content:encoded><![CDATA[<h1 id="Ê≥ïÂæã‰∏éÁß©Â∫è" tabindex="-1">Ê≥ïÂæã‰∏éÁß©Â∫è <a class="header-anchor" href="#Ê≥ïÂæã‰∏éÁß©Â∫è" aria-label="Permalink to &quot;Ê≥ïÂæã‰∏éÁß©Â∫è&quot;"></a></h1>
<h2 id="ÂÖ≥‰∫éÂÜÖÂÆπ" tabindex="-1">ÂÖ≥‰∫éÂÜÖÂÆπ <a class="header-anchor" href="#ÂÖ≥‰∫éÂÜÖÂÆπ" aria-label="Permalink to &quot;ÂÖ≥‰∫éÂÜÖÂÆπ&quot;"></a></h2>
<ol>
<li>‰ΩøÁî®ÊÉÖÊÄÅÂä®ËØçË¢´Âä®ËØ≠ÊÄÅÊù•ËÆ®ËÆ∫Ê¥ªÂä®ÁöÑÊ≥ïÂÆöÂπ¥ÈæÑ„ÄÇ</li>
<li>ÂÖ≥‰∫éÁäØÁΩ™ÂíåÊÉ©ÁΩö‰ΩøÁî®getË¢´Âä®ËØ≠ÊÄÅÁöÑË°®Ê†º„ÄÇ</li>
<li>Áî®‚ÄúFirst of all‚ÄùÁ≠âËØçÁªÑÁªá‰Ω†ÁöÑËßÇÁÇπ„ÄÇ</li>
<li>Áî®‚ÄúËøôÊòØ‰∏Ä‰∏™Â•ΩËßÇÁÇπ‚ÄùËøôÊ†∑ÁöÑË°®ËææÊù•Ë°®ÊòéÊüê‰∫∫Êúâ‰∏Ä‰∏™ÊúâÊïàÁöÑËÆ∫ÁÇπ„ÄÇ‚Äù„ÄÇ</li>
</ol>
<h2 id="ÂÖ≥‰∫éËØ≠Ê≥ï" tabindex="-1">ÂÖ≥‰∫éËØ≠Ê≥ï <a class="header-anchor" href="#ÂÖ≥‰∫éËØ≠Ê≥ï" aria-label="Permalink to &quot;ÂÖ≥‰∫éËØ≠Ê≥ï&quot;"></a></h2>
<ol>
<li>
<p>Áé∞Âú®ÊÉÖÊÄÅÂä®ËØçÁöÑË¢´Âä®ËØ≠ÊÄÅÊòØÊÉÖÊÄÅÂä®ËØç+ be +ËøáÂéªÂàÜËØç„ÄÇ
a. R-rated movies should be banned.
b. The law ought to be changed.</p>
</li>
<li>
<p>Ë¢´Âä®ËØ≠ÊÄÅÈÄöÂ∏∏Áî±beÊûÑÊàêÔºå‰ΩÜÊúâÊó∂‰πüÂèØ‰ª•Áî®get„ÄÇ<br>
a. Like : people who speed don't usually get arrested.</p>
</li>
<li>
<p>Âú®should‰πãÂêéÔºåË¢´Âä®ËØ≠ÊÄÅÊõ¥‰∏∫Â∏∏ËßÅ„ÄÇ<br>
a. People who speed should be arrested if they cause an accident.</p>
</li>
<li>
<p>Ê≥®ÊÑè‰∫ãÈ°π:‰ΩøÁî® catch + person + verb + ing.
a. Like : What happens if they catch you shoplifting.</p>
</li>
<li>
<p>Êâ©Â±ï
a. Well,Basically ... The point/thing is ...
b. Adding ideas : Another thing is ...
c. Introducing a list : There are two problems ... or ... for a couple of reasons.
d. Ordinal numbers : First of all, Second of all, ...<br>
e. Numbers or letters : One, Two, ... or A, B, ...</p>
</li>
</ol>
<h2 id="Êñ∞ÂçïËØç" tabindex="-1">Êñ∞ÂçïËØç <a class="header-anchor" href="#Êñ∞ÂçïËØç" aria-label="Permalink to &quot;Êñ∞ÂçïËØç&quot;"></a></h2>
<ol>
<li>penalty</li>
<li>jaywalking</li>
<li>vandals</li>
<li>kidnapping</li>
<li>robbing</li>
<li>shoplifting</li>
<li>convicted of burglary</li>
<li>graffiti</li>
<li>murderer</li>
<li>knife</li>
</ol>
<h2 id="Êñ∞ËØçÁªÑ" tabindex="-1">Êñ∞ËØçÁªÑ <a class="header-anchor" href="#Êñ∞ËØçÁªÑ" aria-label="Permalink to &quot;Êñ∞ËØçÁªÑ&quot;"></a></h2>
<ol>
<li>catch someone doing</li>
<li>convict of(get sentenced to)</li>
<li>life in prison</li>
<li>lose your license</li>
<li>against the law</li>
<li>get enforced</li>
<li>put on probation</li>
<li>take someone captive</li>
<li>go to jail</li>
<li>get arrested</li>
<li>for a couple of reasons</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Â•áÊÄ™‰∫ã‰ª∂]]></title>
            <link>https://askaric.com/zh/work/english/02Ëã±ËØ≠Âè£ËØ≠/2-11Âú∫ÊôØ_Â•áÊÄ™‰∫ã‰ª∂.html</link>
            <guid>https://askaric.com/zh/work/english/02Ëã±ËØ≠Âè£ËØ≠/2-11Âú∫ÊôØ_Â•áÊÄ™‰∫ã‰ª∂.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[ÂÖ≥‰∫éÂÜÖÂÆπ

1. Áî®ËøáÂéªÂÆåÊàêÊó∂Ë∞àËÆ∫Â∑ßÂêà„ÄÇ
2. Ë∞àË∞àËø∑‰ø°„ÄÇ
3. Âú®ÂõûÁ≠î‚ÄúÊâÄ‰ª•‚ÄùÂíå‚ÄúÈÉΩ‰∏çÊòØ‚ÄùÊó∂ÔºåÊòæÁ§∫Âá∫‰∏Ä‰∫õÂÖ±Âêå‰πãÂ§Ñ„ÄÇ
4. ÈáçÂ§ç‰Ω†ÁöÑËßÇÁÇπÔºå‰Ωø‰Ω†ÁöÑÊÑèÊÄùÊõ¥Ê∏ÖÊ•ö„ÄÇ

 ÂÖ≥‰∫éËØ≠Ê≥ï

1. Áî®]]></description>
            <content:encoded><![CDATA[<h1 id="Â•áÊÄ™‰∫ã‰ª∂" tabindex="-1">Â•áÊÄ™‰∫ã‰ª∂ <a class="header-anchor" href="#Â•áÊÄ™‰∫ã‰ª∂" aria-label="Permalink to &quot;Â•áÊÄ™‰∫ã‰ª∂&quot;"></a></h1>
<h2 id="ÂÖ≥‰∫éÂÜÖÂÆπ" tabindex="-1">ÂÖ≥‰∫éÂÜÖÂÆπ <a class="header-anchor" href="#ÂÖ≥‰∫éÂÜÖÂÆπ" aria-label="Permalink to &quot;ÂÖ≥‰∫éÂÜÖÂÆπ&quot;"></a></h2>
<ol>
<li>Áî®ËøáÂéªÂÆåÊàêÊó∂Ë∞àËÆ∫Â∑ßÂêà„ÄÇ</li>
<li>Ë∞àË∞àËø∑‰ø°„ÄÇ</li>
<li>Âú®ÂõûÁ≠î‚ÄúÊâÄ‰ª•‚ÄùÂíå‚ÄúÈÉΩ‰∏çÊòØ‚ÄùÊó∂ÔºåÊòæÁ§∫Âá∫‰∏Ä‰∫õÂÖ±Âêå‰πãÂ§Ñ„ÄÇ</li>
<li>ÈáçÂ§ç‰Ω†ÁöÑËßÇÁÇπÔºå‰Ωø‰Ω†ÁöÑÊÑèÊÄùÊõ¥Ê∏ÖÊ•ö„ÄÇ</li>
</ol>
<h2 id="ÂÖ≥‰∫éËØ≠Ê≥ï" tabindex="-1">ÂÖ≥‰∫éËØ≠Ê≥ï <a class="header-anchor" href="#ÂÖ≥‰∫éËØ≠Ê≥ï" aria-label="Permalink to &quot;ÂÖ≥‰∫éËØ≠Ê≥ï&quot;"></a></h2>
<ol>
<li>
<p>Áî®ËøáÂéªÂÆåÊàêÊó∂Êù•Ë∞àËÆ∫‰ª•ÂâçÂèëÁîüÁöÑ‰∫ãÊÉÖÂíåËøáÂéªÂèëÁîüÁöÑ‰∫ã‰ª∂„ÄÇ
a. I had set up my camp and was cooking, and this van appeared out of nowhere.
b. From sentences above, we could know that i seted up my camp happened before something about van.</p>
</li>
<li>
<p>ËøáÂéªÂÆåÊàêÊó∂ÈÄöÂ∏∏Áî®‰∫éËß£ÈáäÊàñËß£Èáä‰∫ãÊÉÖÂèëÁîüÁöÑÂéüÂõ†„ÄÇ
a. It was nice to have company beacuse i hadn't spoken to anyone in days.</p>
</li>
<li>
<p>Áî® So and Neither ÂõûÂ∫î
a. Present of be : I'm hungary --&gt; So am I
b. SImple present : I wlk around ladders --&gt; So do I<br>
c. Simple past : I knew that --&gt; So did I</p>
</li>
</ol>
<h2 id="Êñ∞ÂçïËØç" tabindex="-1">Êñ∞ÂçïËØç <a class="header-anchor" href="#Êñ∞ÂçïËØç" aria-label="Permalink to &quot;Êñ∞ÂçïËØç&quot;"></a></h2>
<ol>
<li>scary</li>
<li>husband-to-be</li>
<li>coincidence</li>
<li>deja vu</li>
<li>telepathy</li>
</ol>
<h2 id="Êñ∞ËØçÁªÑ" tabindex="-1">Êñ∞ËØçÁªÑ <a class="header-anchor" href="#Êñ∞ËØçÁªÑ" aria-label="Permalink to &quot;Êñ∞ËØçÁªÑ&quot;"></a></h2>
<ol>
<li>call out of the blue</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[ÂêçÊ∞î]]></title>
            <link>https://askaric.com/zh/work/english/02Ëã±ËØ≠Âè£ËØ≠/2-12Âú∫ÊôØ_ÂêçÊ∞î.html</link>
            <guid>https://askaric.com/zh/work/english/02Ëã±ËØ≠Âè£ËØ≠/2-12Âú∫ÊôØ_ÂêçÊ∞î.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[ÂÖ≥‰∫éÂÜÖÂÆπ

1. Ë∞àËÆ∫Âêç‰∫∫ÁöÑÊàêÂêç
2. ‰ΩøÁî®if‰ªéÂè•Êù•ËØ¥Êòé‰∫ãÊÉÖÂèØËÉΩ‰ºöÊúâÊâÄ‰∏çÂêå
3. Ë∞àËÆ∫Ëé∑ÂæóÂíåÂ§±ÂéªÂêçÂ£∞
4. ‰ΩøÁî®ÈôÑÂä†ÁñëÈóÆÂè•Êù•Ë°®ËææËßÇÁÇπÊàñÊ£ÄÊü•‰ø°ÊÅØ
5. ‰ΩøÁî®ÂèçÈóÆÊù•ËΩØÂåñÂª∫ËÆÆÂπ∂Áªô‰∫àÈºìÂä±
6.]]></description>
            <content:encoded><![CDATA[<h1 id="ÂêçÊ∞î" tabindex="-1">ÂêçÊ∞î <a class="header-anchor" href="#ÂêçÊ∞î" aria-label="Permalink to &quot;ÂêçÊ∞î&quot;"></a></h1>
<h2 id="ÂÖ≥‰∫éÂÜÖÂÆπ" tabindex="-1">ÂÖ≥‰∫éÂÜÖÂÆπ <a class="header-anchor" href="#ÂÖ≥‰∫éÂÜÖÂÆπ" aria-label="Permalink to &quot;ÂÖ≥‰∫éÂÜÖÂÆπ&quot;"></a></h2>
<ol>
<li>Ë∞àËÆ∫Âêç‰∫∫ÁöÑÊàêÂêç</li>
<li>‰ΩøÁî®if‰ªéÂè•Êù•ËØ¥Êòé‰∫ãÊÉÖÂèØËÉΩ‰ºöÊúâÊâÄ‰∏çÂêå</li>
<li>Ë∞àËÆ∫Ëé∑ÂæóÂíåÂ§±ÂéªÂêçÂ£∞</li>
<li>‰ΩøÁî®ÈôÑÂä†ÁñëÈóÆÂè•Êù•Ë°®ËææËßÇÁÇπÊàñÊ£ÄÊü•‰ø°ÊÅØ</li>
<li>‰ΩøÁî®ÂèçÈóÆÊù•ËΩØÂåñÂª∫ËÆÆÂπ∂Áªô‰∫àÈºìÂä±</li>
<li>Áî®ËøôÊ†∑ÁöÑË°®ËææÊù•ÂõûÁ≠îÂõ∞ÈöæÁöÑÈóÆÈ¢ò:ËøôÂæàÈöæËØ¥</li>
</ol>
<h2 id="ÂÖ≥‰∫éËØ≠Ê≥ï" tabindex="-1">ÂÖ≥‰∫éËØ≠Ê≥ï <a class="header-anchor" href="#ÂÖ≥‰∫éËØ≠Ê≥ï" aria-label="Permalink to &quot;ÂÖ≥‰∫éËØ≠Ê≥ï&quot;"></a></h2>
<ol>
<li>
<p>‰Ω†ÂèØ‰ª•Áî®Â∏¶ifÁöÑÂè•Â≠êÊù•ÂÅáËÆæÂú∞Ë∞àËÆ∫ËøáÂéª„ÄÇÂπ∂‰∏îÔºåÂú®if‰ªéÂè•‰∏≠‰ΩøÁî®ËøáÂéªÂÆåÊàêÊó∂ÔºåÂú®‰∏ªÂè•‰∏≠‰ΩøÁî®ËøáÂéªÊó∂ÊÄÅ„ÄÇ
a. If + past perfect,past modal would have, could have, might have, etc
b. If he hadn't won the talent contest, maybe he would've done something entirely different.</p>
</li>
<li>
<p>ÂÖ≥‰∫éËøáÂéªÁöÑÂÅáËÆæÊÄßÈóÆÈ¢ò„ÄÇ
a. What would've happended if he'd stayed in school?
b. Would he have become a singer?</p>
</li>
<li>
<p>ËÇØÂÆöÈôàËø∞+Âê¶ÂÆöÊ†áÁ≠æ„ÄÇ
a. It's amazing, isn't it?
b. That was a dumb thing to do, wasn't it?<br>
c. She won the talent show, didn't she?
d. he's dropped out of sight, hasn't she?</p>
</li>
<li>
<p>Âê¶ÂÆöÈôàËø∞+ËÇØÂÆöÊ†áÁ≠æ„ÄÇ
a. It's not easy to become famous, is it?<br>
b. That wasn't too smart, was it?<br>
c. She didn't have connections, did she?<br>
d. His career hasn't taken off, has it?</p>
</li>
</ol>
<h2 id="Êñ∞ÂçïËØç" tabindex="-1">Êñ∞ÂçïËØç <a class="header-anchor" href="#Êñ∞ÂçïËØç" aria-label="Permalink to &quot;Êñ∞ÂçïËØç&quot;"></a></h2>
<ol>
<li>hypothetically</li>
<li>affirmative</li>
<li>up-and-coming</li>
<li>in the headlines</li>
<li>making headlines</li>
</ol>
<h2 id="Êñ∞ËØçÁªÑ" tabindex="-1">Êñ∞ËØçÁªÑ <a class="header-anchor" href="#Êñ∞ËØçÁªÑ" aria-label="Permalink to &quot;Êñ∞ËØçÁªÑ&quot;"></a></h2>
<ol>
<li>have connections</li>
<li>get discovered</li>
<li>in the right place at the right time</li>
<li>drop out of sight</li>
<li>get bad press</li>
<li>go downhill</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[ÁîüÊ¥ª]]></title>
            <link>https://askaric.com/zh/work/english/02Ëã±ËØ≠Âè£ËØ≠/2-1Âú∫ÊôØ_ÁîüÊ¥ª.html</link>
            <guid>https://askaric.com/zh/work/english/02Ëã±ËØ≠Âè£ËØ≠/2-1Âú∫ÊôØ_ÁîüÊ¥ª.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[ÂÖ≥‰∫éÂÜÖÂÆπ

1. Â¶Ç‰Ωï‰ΩøÁî®‰∏ÄËà¨Áé∞Âú®Êó∂ÂíåÁé∞Âú®ËøõË°åÊó∂ÊâæÂÆ§Âèã
2. ‰ΩøÁî® `verb + ing` or `to + verb` ËÆ≤Ëø∞ÁîüÊ¥ª
3. ‰ΩøÁî®Áé∞Âú®ÊòØËÆ≤Ëø∞È´òÂÖâÊó∂Âàª  
4. ‰ΩøÁî® `this]]></description>
            <content:encoded><![CDATA[<h1 id="ÁîüÊ¥ª" tabindex="-1">ÁîüÊ¥ª <a class="header-anchor" href="#ÁîüÊ¥ª" aria-label="Permalink to &quot;ÁîüÊ¥ª&quot;"></a></h1>
<h2 id="ÂÖ≥‰∫éÂÜÖÂÆπ" tabindex="-1">ÂÖ≥‰∫éÂÜÖÂÆπ <a class="header-anchor" href="#ÂÖ≥‰∫éÂÜÖÂÆπ" aria-label="Permalink to &quot;ÂÖ≥‰∫éÂÜÖÂÆπ&quot;"></a></h2>
<ol>
<li>Â¶Ç‰Ωï‰ΩøÁî®‰∏ÄËà¨Áé∞Âú®Êó∂ÂíåÁé∞Âú®ËøõË°åÊó∂ÊâæÂÆ§Âèã</li>
<li>‰ΩøÁî® <code>verb + ing</code> or <code>to + verb</code> ËÆ≤Ëø∞ÁîüÊ¥ª</li>
<li>‰ΩøÁî®Áé∞Âú®ÊòØËÆ≤Ëø∞È´òÂÖâÊó∂Âàª</li>
<li>‰ΩøÁî® <code>this/these</code> Ë°®ËææÈáçÁÇπ</li>
</ol>
<h2 id="about-grammar" tabindex="-1">About grammar <a class="header-anchor" href="#about-grammar" aria-label="Permalink to &quot;About grammar&quot;"></a></h2>
<ol>
<li>
<p>‰ΩøÁî®‰∏ÄËà¨Áé∞Âú®Êó∂Ë°®Ëææ <code>complete actions</code> or <code>permanent actions</code>:
a. ‰∏ÄËà¨Áé∞Âú®Êó∂ : what kind of music do you listen to? I love jazz and blue music. I listen to it a lot.<br>
b. Áé∞Âú®ÂÆåÊàêÊó∂ : Have you ever lived in another country? No, I've never lived anywhere else.
c. ‰∏ÄËà¨ËøáÂéªÊó∂ : what did you do for your last brithday? I went to home and had a big party.</p>
</li>
<li>
<p>‰ΩøÁî®Áé∞Âú®ËøõË°åÊó∂Ë°®Ëææ <code>ongoing actions</code> or <code>temporary situations</code>:<br>
a. Áé∞Âú®Êó∂ : what kind of music are you listening to currently? I'm listening to a lot of Latin right now.
b. Áé∞Âú®Êó∂ : How long have you been living here? I've been living here for five years.<br>
c. ËøáÂéªÊó∂ : What were you doing at ths time yesterday? I was sitting on bus.</p>
</li>
<li>
<p>Âõ∫ÂÆöË°®Ëææ
a. <code>Verb + verb + ing</code>
b. <code>Verb + particle/preposition + verb + ing</code>
c. <code>Verb + to + verb</code>
d. <code>Verb + ing</code> or <code>to verb</code> with the same meaning<br>
e. <code>Verb + ing</code> or <code>to verb</code> with a different meaning</p>
</li>
</ol>
<h2 id="Êñ∞ËØçÁªÑ" tabindex="-1">Êñ∞ËØçÁªÑ <a class="header-anchor" href="#Êñ∞ËØçÁªÑ" aria-label="Permalink to &quot;Êñ∞ËØçÁªÑ&quot;"></a></h2>
<ol>
<li>we walked off the trail. --&gt; Á¶ªÂºÄËøôÊù°Â∞èË∑Ø</li>
<li>consider doing --&gt; ËÄÉËôëÂÅö...</li>
<li>finish doing --&gt; ÂÆåÊàêÂÅö...</li>
<li>imagine doing --&gt; ÊÉ≥Ë±°ÂÅö...</li>
<li>miss doing --&gt; ÂøòËÆ∞ÂÅö...</li>
<li>mind doing --&gt; ËÆ∞ÂæóÂÅö...</li>
<li>spend(time) doing --&gt; Ëä±Ë¥πÊó∂Èó¥ÂÅö...</li>
<li>end up doing --&gt; ‰ª•ÂÅö...ÂëäÁªà</li>
<li>deep on doing --&gt; Ê∑±ÂÖ•ÂÅö.../ÂùöÊåÅÂÅö...</li>
<li>think about doing --&gt; ËÄÉËôëÂÅö...</li>
<li>plan on doing --&gt; ËÆ°ÂàíÂÅö...</li>
<li>decide to do --&gt; ÂÜ≥ÂÆöÂÅö...</li>
<li>happen to do --&gt; ÊÅ∞Â∑ßÂÅö...</li>
<li>offer to do --&gt; ÊèêÂá∫Ë¶ÅÂÅö...</li>
<li>seem to do --&gt; Â•ΩÂÉè...</li>
<li>intend to do --&gt; ÊÉ≥Ë¶ÅÂÅö...</li>
<li>expect to do --&gt; ÊúüÂæÖÂÅö...</li>
<li>begin doing/to do --&gt; ÂºÄÂßãÂÅö...</li>
<li>bother to do/doing --&gt; Ë¥πÂøÉÂÅö...</li>
<li>continue to do/doing --&gt; ÊåÅÁª≠ÂÅö...</li>
<li>start to do/doing --&gt; ÂºÄÂßãÂÅö...</li>
<li>like doing/to do --&gt; ÂñúÊ¨¢ÂÅö...</li>
<li>love to do/love doing --&gt; ÂñúÊ¨¢ÂÅö...</li>
<li>hate to do/doing --&gt; ËÆ®ÂéåÂÅö...</li>
<li>remember to do --&gt; ËÆ∞ÂæóÂéªÂÅö...</li>
<li>remember doing --&gt; ËÆ∞ÂæóÂÅö...</li>
<li>stop to do --&gt; ÂÅúÊ≠¢ÂΩìÂâçÂéªÂÅö...</li>
<li>stop doing --&gt; ÂÅúÊ≠¢ÂΩìÂâçÂÅöÁöÑ...</li>
<li>try doing --&gt; Â∞ùËØïÂÅö...</li>
<li>try to do --&gt; Â∞ΩÂäõÂÅö...</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Âêç‰∫∫]]></title>
            <link>https://askaric.com/zh/work/english/02Ëã±ËØ≠Âè£ËØ≠/2-2Âú∫ÊôØ_Âêç‰∫∫.html</link>
            <guid>https://askaric.com/zh/work/english/02Ëã±ËØ≠Âè£ËØ≠/2-2Âú∫ÊôØ_Âêç‰∫∫.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[Êï¥‰Ωì

Ëøô‰∏™ËØùÈ¢òÊòØÂÖ≥‰∫é‚ÄúÂêç‰∫∫‚ÄùÁöÑ„ÄÇÂú®ËøôÊÆµÂØπËØù‰∏≠ÔºåÊàë‰ª¨ÂèØ‰ª•ÁúãÂà∞‰ªñËÆ©ÊàëÂÖ≥Ê≥®‚ÄúËØ≠Ê≥ï‚ÄùÂíå‚Äú‰∏∫‰ªÄ‰πàÂØπÂêç‰∫∫ÊÑüÂÖ¥Ë∂£ÊòØÊ≠£Â∏∏ÁöÑ?‚ÄùÂú®ÂπøÊí≠Ë∞àËÆ∫Âêç‰∫∫-Èü≥ËΩ®1.16„ÄÇ

 ÂÖ≥‰∫éËØ≠Ê≥ï

Âú®ËØ≠Ê≥ïÈÉ®ÂàÜÔºåÊàë‰ª¨ÂèØ‰ª•ÁúãÂà∞‰ª•‰∏ã]]></description>
            <content:encoded><![CDATA[<h1 id="Âêç‰∫∫" tabindex="-1">Âêç‰∫∫ <a class="header-anchor" href="#Âêç‰∫∫" aria-label="Permalink to &quot;Âêç‰∫∫&quot;"></a></h1>
<h2 id="Êï¥‰Ωì" tabindex="-1">Êï¥‰Ωì <a class="header-anchor" href="#Êï¥‰Ωì" aria-label="Permalink to &quot;Êï¥‰Ωì&quot;"></a></h2>
<p>Ëøô‰∏™ËØùÈ¢òÊòØÂÖ≥‰∫é‚ÄúÂêç‰∫∫‚ÄùÁöÑ„ÄÇÂú®ËøôÊÆµÂØπËØù‰∏≠ÔºåÊàë‰ª¨ÂèØ‰ª•ÁúãÂà∞‰ªñËÆ©ÊàëÂÖ≥Ê≥®‚ÄúËØ≠Ê≥ï‚ÄùÂíå‚Äú‰∏∫‰ªÄ‰πàÂØπÂêç‰∫∫ÊÑüÂÖ¥Ë∂£ÊòØÊ≠£Â∏∏ÁöÑ?‚ÄùÂú®<a href="https://dogwood.xdfsjj.com/pc/audioDetail.html?id=51352&amp;pcrId=12680494&amp;resId=14718879&amp;resSign=c76b28&amp;type=14" target="_blank" rel="noreferrer">ÂπøÊí≠Ë∞àËÆ∫Âêç‰∫∫-Èü≥ËΩ®1.16</a>„ÄÇ</p>
<h2 id="ÂÖ≥‰∫éËØ≠Ê≥ï" tabindex="-1">ÂÖ≥‰∫éËØ≠Ê≥ï <a class="header-anchor" href="#ÂÖ≥‰∫éËØ≠Ê≥ï" aria-label="Permalink to &quot;ÂÖ≥‰∫éËØ≠Ê≥ï&quot;"></a></h2>
<p>Âú®ËØ≠Ê≥ïÈÉ®ÂàÜÔºåÊàë‰ª¨ÂèØ‰ª•ÁúãÂà∞‰ª•‰∏ãÂá†ÁÇπ:</p>
<ol>
<li>
<p>ÂÆö‰πâÊù°Ê¨æ:
a. Êàë‰ª¨ÂèØ‰ª•Áî®that/whichÊù•ÂÆö‰πâ„ÄÅËØÜÂà´ÊàñÁªôÂá∫ÂÖ≥‰∫éÂêçËØçÁöÑÂü∫Êú¨‰ø°ÊÅØ„ÄÇ
b. Ê≤°ÊúâËøô‰∏™Êù°Ê¨æÂ∞±Ê≤°ÊúâÊÑè‰πâ‰∫Ü„ÄÇ
c. ‰æãÂ¶Ç:‚Äúthere are show that/which for plastic surgery‚Äù„ÄÇ</p>
</li>
<li>
<p>ÈùûÂÆö‰πâ‰ªéÂè•:</p>
<p>a. ÈùûÂÆöËØ≠‰ªéÂè•Áî®‰∫éÊ∑ªÂä†ÂÖ≥‰∫éÂêçËØçÊàñÂÖ∂ÂâçÈù¢‰ªéÂè•ÁöÑÈ¢ùÂ§ñ‰ø°ÊÅØ„ÄÇ
b. Â∏∏Áî®ÁöÑÁî®Ê≥ïÊòØ‰ΩøÁî® <code>which</code>„ÄÇ
c. ‰æãÂ¶Ç: ‚ÄúÂêç‰∫∫ÊùÇÂøóÊó†Â§Ñ‰∏çÂú®ÔºåÂÆÉ‰ª¨ÁöÑÊï∞ÈáèË∂ÖËøá‰∫ÜÊñ∞ÈóªÊùÇÂøó„ÄÇ‚Äù</p>
</li>
</ol>
<h2 id="ÂÖ≥‰∫éÂÜÖÂÆπ" tabindex="-1">ÂÖ≥‰∫éÂÜÖÂÆπ <a class="header-anchor" href="#ÂÖ≥‰∫éÂÜÖÂÆπ" aria-label="Permalink to &quot;ÂÖ≥‰∫éÂÜÖÂÆπ&quot;"></a></h2>
<p>ÂÖ≥‰∫éÂÜÖÂÆπÈÉ®ÂàÜÔºåÊàë‰ª¨ÂèØ‰ª•ÁúãÂà∞Ôºå‰∏ãÈù¢ÊòØÊàëÂ∫îËØ•ÂÖ≥Ê≥®ÁöÑ‰∏â‰∏™ÈóÆÈ¢ò:</p>
<ol>
<li>
<p>‰∏∫‰ªÄ‰πàÂØπÂêç‰∫∫ÊÑüÂÖ¥Ë∂£ÂæàÊ≠£Â∏∏?
a. È¶ñÂÖàÔºåÂØπÂêç‰∫∫ÁöÑÁó¥Ëø∑ÊòØÊ≠£Â∏∏ÁöÑÔºåÊàë‰ª¨ÂèØ‰ª•Âú®ÊØè‰∏™Êä•Êëä‰∏äÁúãÂà∞Âêç‰∫∫ÊùÇÂøóÁöÑÊï∞ÈáèË∂ÖËøáÊñ∞ÈóªÊùÇÂøó„ÄÇÊàë‰ª¨ÂñúÊ¨¢ËØªÂêç‰∫∫ÁöÑÁ∫¶‰ºöÔºå‰ªñ‰ª¨Á©øÁöÑË°£ÊúçÔºåÁâπÂà´ÊòØÂ™í‰ΩìÁªèÂ∏∏ÁºñÈÄ†ÁöÑ‰ªñ‰ª¨ÁöÑÈóÆÈ¢ò„ÄÇ
b. ÂÖ∂Ê¨°ÔºåÊòØÁúü‰∫∫ÁßÄËäÇÁõÆ„ÄÇÊï∞Áôæ‰∏áËßÇ‰ºóÁÉ≠ÂàáÂú∞ÂÖ≥Ê≥®ÁùÄÁúü‰∫∫ÁßÄÂíåÁîµËßÜËäÇÁõÆÔºåËøô‰∫õËäÇÁõÆËÆ©ÊôÆÈÄö‰∫∫Áû¨Èó¥Êàê‰∏∫Âêç‰∫∫„ÄÇ</p>
</li>
<li>
<p>‰∏∫‰ªÄ‰πàÊàë‰ª¨Â¶ÇÊ≠§Áó¥Ëø∑?
a. È¶ñÂÖàÔºåËøôÊòØ‰∏Ä‰∏™ÁßëÂ≠¶ÁöÑÁêÜÁî±ÔºåÂÆÉ‰ºöËÆ©‰Ω†ÂØπËá™Â∑±ÂØπÂêç‰∫∫ÂÖ´Âç¶ÁöÑÂÖ¥Ë∂£ÊÑüËßâËâØÂ•Ω„ÄÇ
b. Á¨¨‰∫åÔºåÂøÉÁêÜÂ≠¶ÂÆ∂ËØ¥Ê®°‰ªøÁ§æ‰ºö‰∏äÁöÑÊàêÂäü‰∫∫Â£´ÊòØÂæàÊ≠£Â∏∏ÁöÑ„ÄÇ
c. Á¨¨‰∏âÔºåÊúâ‰∫ÜÁîµËßÜÔºåÂêç‰∫∫‰ºº‰πéÂèØ‰ª•Áõ¥Êé•Ëµ∞ËøõÊàë‰ª¨ÁöÑÂÆ∂ÔºåÊàê‰∏∫Êàë‰ª¨ÂÆ∂Â∫≠ÁöÑ‰∏ÄÈÉ®ÂàÜ„ÄÇ</p>
</li>
</ol>
<h2 id="ÊàëÁöÑÈóÆÈ¢ò" tabindex="-1">ÊàëÁöÑÈóÆÈ¢ò <a class="header-anchor" href="#ÊàëÁöÑÈóÆÈ¢ò" aria-label="Permalink to &quot;ÊàëÁöÑÈóÆÈ¢ò&quot;"></a></h2>
<ol>
<li>
<p>‰∏çÂÆπÊòìÂå∫ÂàÜÂÆö‰πâÂ≠êÂè•ÂíåÈùûÂÆö‰πâÂ≠êÂè•ÔºåÊØîÂ¶Ç:
a. ‰∫ãÂÆû‰∏ä: <code>we love to read about people that celebrity's date, clothes they ware and especially their problems, which the media will often invent.</code>
b. ÊàëÂê¨Âà∞: <code>we love to read about people that celebrity's date, clothes they ware and especially their problems which the media will often invent.</code>
c. ÈóÆÈ¢òÁöÑÈáçË¶ÅÊÄß:Áé∞Âú®ÂÆÉÂØπÊàëÊù•ËØ¥Âπ∂‰∏çÂçÅÂàÜÈáçË¶Å„ÄÇ</p>
</li>
<li>
<p>ÈÄöÂ∏∏Âú®Âá∫Áé∞Êñ∞ÂçïËØçÊó∂Ëø∑Â§±ÔºåÊØîÂ¶Ç:
a. Âú® <code>Million of viewers avidly follow reality and telant shows</code> ‰∏≠Ôºå<code>avidly</code> Ëøô‰∏™ËØçÁ™ÅÁÑ∂Âá∫Áé∞Âú®ÊàëÁöÑËÑëÊµ∑‰∏≠ÔºåÊàë‰∏Ä‰∏ãÂ≠êÊáµ‰∫Ü„ÄÇ
b. Â¶Ç‰ΩïÂÖãÊúç : ÊàëËÆ§‰∏∫ÊàëÂ∫îËØ•Ê≥®ÊÑèÊï¥‰∏™Âè•Â≠êÁöÑÁªìÊûÑËÄå‰∏çÊòØÊÑèÊÄù„ÄÇÁÑ∂ËÄåÔºåÂ¶ÇÊûúÊ≤°ÊúâË∂≥Â§üÁöÑËØçÊ±áÂíåËØ≠Ê≥ïÁü•ËØÜÔºåËøôÊòØÂæàÈöæÁöÑ„ÄÇ
c. ÈóÆÈ¢òÁöÑÈáçË¶ÅÊÄß : ÂæàÈáçË¶ÅÔºåÊàëÂøÖÈ°ªÂ∞ΩÂø´ÂÖãÊúçÂÆÉ„ÄÇ</p>
</li>
</ol>
<h2 id="Êñ∞ÂçïËØç" tabindex="-1">Êñ∞ÂçïËØç <a class="header-anchor" href="#Êñ∞ÂçïËØç" aria-label="Permalink to &quot;Êñ∞ÂçïËØç&quot;"></a></h2>
<ol>
<li><code>mimic</code> --&gt; Ê®°‰ªø</li>
<li><code>pay for</code> --&gt; ÊîØ‰ªò</li>
<li><code>outnumber of</code> --&gt; ÁÅ´ÁàÜ</li>
<li><code>athlete</code> --&gt; ËøêÂä®Âëò</li>
<li><code>reassuring</code> --&gt; ‰Ωø‰∫∫ÂÆâÂøÉÁöÑ</li>
<li><code>vary</code> --&gt; ÊîπÂèò</li>
<li><code>bully</code> --&gt; Â®ÅÂêìÔºåÊ®™Ë°åÈú∏ÈÅìËÄÖ</li>
<li><code>avidly</code> --&gt; Ë¥™ÂøÉÂú∞</li>
<li><code>newstand</code> --&gt; Êä•Êëä</li>
<li><code>cereal</code> --&gt; Ë∞∑Á±ªÈ£üÁâ©</li>
<li><code>sugary</code> --&gt; Âê´Á≥ñÁöÑ</li>
</ol>
<h2 id="Êñ∞ËØçÁªÑ" tabindex="-1">Êñ∞ËØçÁªÑ <a class="header-anchor" href="#Êñ∞ËØçÁªÑ" aria-label="Permalink to &quot;Êñ∞ËØçÁªÑ&quot;"></a></h2>
<ol>
<li><code>increase in ... of ...</code></li>
<li><code>impact ... on ...</code></li>
<li><code>research on</code></li>
<li><code>effect on</code></li>
<li><code>advertisement for</code></li>
<li><code>reason for</code></li>
<li><code>rise in</code></li>
<li><code>problem with</code></li>
<li><code>link between ... and ...</code></li>
<li><code>cause of</code></li>
<li><code>concern about</code></li>
<li><code>influence on</code></li>
<li><code>relationship between ... and ...</code></li>
<li><code>pick on</code></li>
<li><code>tune into</code></li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[ËØÑËÆ∫]]></title>
            <link>https://askaric.com/zh/work/english/02Ëã±ËØ≠Âè£ËØ≠/2-3Âú∫ÊôØ_Â§áÊ≥®.html</link>
            <guid>https://askaric.com/zh/work/english/02Ëã±ËØ≠Âè£ËØ≠/2-3Âú∫ÊôØ_Â§áÊ≥®.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[Êï¥‰Ωì

Ëøô‰∏™ËØùÈ¢òÊòØÂÖ≥‰∫é `you know what ...` ÁöÑË°®ËææÊñπÂºèÔºåÊàëÂ∫îËØ•Â≠¶‰π†Â¶Ç‰ΩïÊ∑ªÂä†Ê≥®Èáä„ÄÇËøôÊòØ‰∏ÄÊÆµÂÖ≥‰∫éËßÜÈ¢ëÂâ™ËæëÊÑèËßÅÁöÑÂØπËØùÔºåÂú®ÂÖ≥‰∫éÂêç‰∫∫ÁöÑÂπøÊí≠ËÆ≤ËØù-Èü≥ËΩ®1.22„ÄÇ

 ÂÖ≥‰∫éËØ≠Ê≥ï

1]]></description>
            <content:encoded><![CDATA[<h1 id="ËØÑËÆ∫" tabindex="-1">ËØÑËÆ∫ <a class="header-anchor" href="#ËØÑËÆ∫" aria-label="Permalink to &quot;ËØÑËÆ∫&quot;"></a></h1>
<h2 id="Êï¥‰Ωì" tabindex="-1">Êï¥‰Ωì <a class="header-anchor" href="#Êï¥‰Ωì" aria-label="Permalink to &quot;Êï¥‰Ωì&quot;"></a></h2>
<p>Ëøô‰∏™ËØùÈ¢òÊòØÂÖ≥‰∫é <code>you know what ...</code> ÁöÑË°®ËææÊñπÂºèÔºåÊàëÂ∫îËØ•Â≠¶‰π†Â¶Ç‰ΩïÊ∑ªÂä†Ê≥®Èáä„ÄÇËøôÊòØ‰∏ÄÊÆµÂÖ≥‰∫éËßÜÈ¢ëÂâ™ËæëÊÑèËßÅÁöÑÂØπËØùÔºåÂú®<a href="https://dogwood.xdfsjj.com/pc/audioDetail.html?id=51352&amp;pcrId=12680494&amp;resId=14718879&amp;resSign=c76b28&amp;type=14" target="_blank" rel="noreferrer">ÂÖ≥‰∫éÂêç‰∫∫ÁöÑÂπøÊí≠ËÆ≤ËØù-Èü≥ËΩ®1.22</a>„ÄÇ</p>
<h2 id="ÂÖ≥‰∫éËØ≠Ê≥ï" tabindex="-1">ÂÖ≥‰∫éËØ≠Ê≥ï <a class="header-anchor" href="#ÂÖ≥‰∫éËØ≠Ê≥ï" aria-label="Permalink to &quot;ÂÖ≥‰∫éËØ≠Ê≥ï&quot;"></a></h2>
<ol>
<li>
<p>ÊúâÊó∂ÂÄôÔºå<code>you know what‚Ä¶</code> Áî®Êù•ËØÑËÆ∫‰Ω†/ÊàëÁöÑËßÇÁÇπ„ÄÇ
a. ÂèçÈóÆ : <code>you know what i like?</code></p>
</li>
<li>
<p>Âè¶‰∏ÄÊñπÈù¢ÔºåÂÆÉ‰πüÂèØ‰ª•Ë¢´ËßÜ‰∏∫ËøûËØçÁªìÊûÑÔºå‰æãÂ¶Ç: <code>statement-X,you know what‚Ä¶Ôºü statement-Y</code> Áî®ÂÆÉÊù•ËøûÊé• <code>statement-X</code> Âíå <code>statement-Y</code>Ôºå‰∏ãÈù¢ÊòØ‰∏Ä‰∏™ÁúüÂÆûÁöÑ‰æãÂ≠ê„ÄÇ
a. People do really dangrous things and video it - like rifing bikes off walls.
b. Which is stupid, I know.
c. You know what gets me, too. Some of the home videos people post. They're so boring.</p>
</li>
</ol>
<h2 id="ÂÖ≥‰∫éÂÜÖÂÆπ" tabindex="-1">ÂÖ≥‰∫éÂÜÖÂÆπ <a class="header-anchor" href="#ÂÖ≥‰∫éÂÜÖÂÆπ" aria-label="Permalink to &quot;ÂÖ≥‰∫éÂÜÖÂÆπ&quot;"></a></h2>
<ol>
<li>‰ªñÂíåÂ•π‰πãÈó¥ÁöÑÊÑèËßÅÊòØ‰ªÄ‰πà?
a. ËÉåÊôØ:Â•πÁªô‰ªñÂèë‰∫Ü‰∏ÄÊÆµËßÜÈ¢ëÔºåÈóÆ‰ªñÊÑüËßâÂ¶Ç‰Ωï„ÄÇ
b. ‰ªñÁöÑËßÇÁÇπ: ‰ªñÈÄöÂ∏∏‰∏çÂñúÊ¨¢ÁúãÂà´‰∫∫ÂèëÁöÑËßÜÈ¢ë„ÄÇ‰ªñËÆ§‰∏∫Â§ßÈÉ®ÂàÜÊòØÊó†ËÅäÁöÑÔºåÂç±Èô©ÁöÑÔºåÂ∞±ÂÉè‰ªéÂ¢ô‰∏äÈ™ë‰∏ãÊù•Ôºå‰∏çËÉΩÂæóÂà∞ÂàÜÊï∞„ÄÇ
c. Â•πÁöÑÁúãÊ≥ï : Â•πÁü•ÈÅì‰ªñÁöÑËØÑËÆ∫ÂíåË¢´ÂéãÂà∂Âú®ÁÇπÂáªÈáèÈÇ£‰πàÂ§öÁöÑÈÇ£‰∏™ÁâáÊÆµÔºåÂ∞±ÂÉèÊï∞Áôæ‰∏á„ÄÇ</li>
</ol>
<h2 id="ÊàëÁöÑÈóÆÈ¢ò" tabindex="-1">ÊàëÁöÑÈóÆÈ¢ò <a class="header-anchor" href="#ÊàëÁöÑÈóÆÈ¢ò" aria-label="Permalink to &quot;ÊàëÁöÑÈóÆÈ¢ò&quot;"></a></h2>
<ol>
<li>Âõ†‰∏∫ÁªÑÂêàÂèëÈü≥ÔºåÊàëÊÑüÂà∞ÊúâÁÇπÂõ∞ÊÉëÔºå‰ΩÜÊ≤°ÊúâËø∑Â§±„ÄÇ
a. ‰∫ãÂÆû‰∏ä: Did you see that clip I emaild you?<br>
b. ÊàëÂê¨ËØ¥: Did you see that clip <code>by email</code> you?
c. Âõ†‰∏∫Ëøô‰∏™Êñ∞ÂçïËØçÂíåÁªÑÂêàÂèëÈü≥ÔºåÊàë‰∏çÁü•ÈÅìÈóÆÁöÑÊòØ‰ªÄ‰πà„ÄÇ
d. ÈóÆÈ¢òÁöÑÈáçË¶ÅÊÄß: ÈáçË¶ÅÔºåÂõ†‰∏∫Â¶ÇÊûúÊ≤°ÊúâË∂≥Â§üÁöÑËÉåÊôØÔºå‰ºöËÆ©ÊàëÊ∑∑Ê∑ÜÁîöËá≥Â§±ÂéªÂ§ßÊÑè„ÄÇ
e. Â¶Ç‰ΩïÂÖãÊúç : ‰∏ìÊ≥®‰∫éÊØè‰∏Ä‰∏™ÂáÜÁ°ÆÁöÑÂèëÈü≥„ÄÇ</li>
</ol>
<h2 id="Êñ∞ÂçïËØç" tabindex="-1">Êñ∞ÂçïËØç <a class="header-anchor" href="#Êñ∞ÂçïËØç" aria-label="Permalink to &quot;Êñ∞ÂçïËØç&quot;"></a></h2>
<ol>
<li>hilarious --&gt; ÂæàÊªëÁ®ΩÁöÑ</li>
<li>clip --&gt; Âà´Èíà, ‰øÆÂâ™</li>
<li>conduct --&gt; Ë°å‰∏∫, ÂÆûÊñΩ</li>
</ol>
<h2 id="Êñ∞Áü≠ËØ≠" tabindex="-1">Êñ∞Áü≠ËØ≠ <a class="header-anchor" href="#Êñ∞Áü≠ËØ≠" aria-label="Permalink to &quot;Êñ∞Áü≠ËØ≠&quot;"></a></h2>
<ol>
<li>you know what gets me?</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Ë∂ãÂäø]]></title>
            <link>https://askaric.com/zh/work/english/02Ëã±ËØ≠Âè£ËØ≠/2-4Âú∫ÊôØ_Ë∂ãÂäø.html</link>
            <guid>https://askaric.com/zh/work/english/02Ëã±ËØ≠Âè£ËØ≠/2-4Âú∫ÊôØ_Ë∂ãÂäø.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[ÂÖ≥‰∫éÂÜÖÂÆπ

1. ‰ΩøÁî®Áé∞Âú®Êó∂ÔºåÁé∞Âú®ËøõË°åÊó∂ÔºåÁé∞Âú®ÂÆåÊàêÊó∂ÁöÑË¢´Âä®ËØ≠ÊÄÅÔºåË∞àËÆ∫Á§æ‰∫§ÂèòÂåñ.
2. ‰ΩøÁî® although, because of, in order to, and instead ‰πãÁ±ªÁöÑÂõ∫]]></description>
            <content:encoded><![CDATA[<h1 id="Ë∂ãÂäø" tabindex="-1">Ë∂ãÂäø <a class="header-anchor" href="#Ë∂ãÂäø" aria-label="Permalink to &quot;Ë∂ãÂäø&quot;"></a></h1>
<h2 id="ÂÖ≥‰∫éÂÜÖÂÆπ" tabindex="-1">ÂÖ≥‰∫éÂÜÖÂÆπ <a class="header-anchor" href="#ÂÖ≥‰∫éÂÜÖÂÆπ" aria-label="Permalink to &quot;ÂÖ≥‰∫éÂÜÖÂÆπ&quot;"></a></h2>
<ol>
<li>‰ΩøÁî®Áé∞Âú®Êó∂ÔºåÁé∞Âú®ËøõË°åÊó∂ÔºåÁé∞Âú®ÂÆåÊàêÊó∂ÁöÑË¢´Âä®ËØ≠ÊÄÅÔºåË∞àËÆ∫Á§æ‰∫§ÂèòÂåñ.</li>
<li>‰ΩøÁî® although, because of, in order to, and instead ‰πãÁ±ªÁöÑÂõ∫ÂÆöË°®Ëææ</li>
<li>‰ΩøÁî® As I said ÊãâÂõûË∞àËØù.</li>
<li>‰ΩøÁî®‰∏çÊòéÁ°ÆÁöÑË°®Ëææ <code>and so forth</code>.</li>
</ol>
<h2 id="about-grammar" tabindex="-1">About grammar <a class="header-anchor" href="#about-grammar" aria-label="Permalink to &quot;About grammar&quot;"></a></h2>
<ol>
<li>
<p>‰ΩøÁî®Âä®ËØçÁöÑ‰∏ªÂä®ÂΩ¢ÂºèÂº∫Ë∞É &quot;doer&quot; ÊàñÂä®‰ΩúÁöÑÂéüÂõ†.<br>
a. Companies are recruiting workers overseas.</p>
</li>
<li>
<p>‰ΩøÁî®Âä®ËØçÁöÑË¢´Âä®ËØ≠ÊÄÅÂº∫Ë∞É &quot;reveiver&quot;.<br>
a. Workers are being recruited overseas.</p>
</li>
<li>
<p>Êâ©Â±ï<br>
a. Contrast : Although / Even though, inspite of/ despite<br>
b. Reason : because of / as result of / due to / so that<br>
c. Purpose : in order to<br>
d. Alternative : instead of</p>
</li>
</ol>
<h2 id="new-words" tabindex="-1">New words <a class="header-anchor" href="#new-words" aria-label="Permalink to &quot;New words&quot;"></a></h2>
<ol>
<li>air pollution --&gt; Á©∫Ê∞îÊ±°Êüì</li>
<li>drought --&gt; Âπ≤Êó±</li>
<li>environmentally friendly --&gt; ÁéØÂ¢ÉÂèãÂ•ΩÁöÑ</li>
<li>a landfill --&gt; Â°´Âüã</li>
<li>toxic chemicals --&gt; ÊúâÊØíÂåñÂ≠¶ÂìÅ</li>
<li>bigdegradeable --&gt; ÂèØÁîüÁâ©ÈôçËß£ÁöÑ</li>
<li>energy-saving --&gt; ËäÇËÉΩ</li>
<li>global warming --&gt; ÂÖ®ÁêÉÂèòÊöñ</li>
<li>natural resources --&gt; Ëá™ÁÑ∂ËµÑÊ∫ê</li>
<li>water consumption --&gt; Êµ™Ë¥πÊ∞¥</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Ëß£ÂÜ≥ÈóÆÈ¢ò]]></title>
            <link>https://askaric.com/zh/work/english/02Ëã±ËØ≠Âè£ËØ≠/2-5Âú∫ÊôØ_Ëß£ÂÜ≥ÈóÆÈ¢ò.html</link>
            <guid>https://askaric.com/zh/work/english/02Ëã±ËØ≠Âè£ËØ≠/2-5Âú∫ÊôØ_Ëß£ÂÜ≥ÈóÆÈ¢ò.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[ÂÖ≥‰∫éÂÜÖÂÆπ

There are some something below :

1. Áî® get Âíå have Êù•Ë∞àËÆ∫Âà´‰∫∫‰∏∫‰Ω†ÂÅöÁöÑ‰∫ãÊÉÖ„ÄÇ
2. Áî®need + Ë¢´Âä®‰∏çÂÆöÂºè Êàñ need + ]]></description>
            <content:encoded><![CDATA[<h1 id="Ëß£ÂÜ≥ÈóÆÈ¢ò" tabindex="-1">Ëß£ÂÜ≥ÈóÆÈ¢ò <a class="header-anchor" href="#Ëß£ÂÜ≥ÈóÆÈ¢ò" aria-label="Permalink to &quot;Ëß£ÂÜ≥ÈóÆÈ¢ò&quot;"></a></h1>
<h2 id="ÂÖ≥‰∫éÂÜÖÂÆπ" tabindex="-1">ÂÖ≥‰∫éÂÜÖÂÆπ <a class="header-anchor" href="#ÂÖ≥‰∫éÂÜÖÂÆπ" aria-label="Permalink to &quot;ÂÖ≥‰∫éÂÜÖÂÆπ&quot;"></a></h2>
<p>There are some something below :</p>
<ol>
<li>Áî® get Âíå have Êù•Ë∞àËÆ∫Âà´‰∫∫‰∏∫‰Ω†ÂÅöÁöÑ‰∫ãÊÉÖ„ÄÇ</li>
<li>Áî®need + Ë¢´Âä®‰∏çÂÆöÂºè Êàñ need + Âä®ËØç + ing Êù•ÊèèËø∞ÂÆ∂Â∫≠ÈóÆÈ¢ò„ÄÇ</li>
<li>Áî® ‚ÄúÁÆÄÁü≠ÁöÑÂè•Â≠ê‚Äù ÈùûÊ≠£ÂºèÂú∞ËØ¥ËØù„ÄÇ</li>
<li>ÂΩì‰∫ãÊÉÖÂá∫ÈîôÊó∂Ôºå‰ΩøÁî®ÂÉè Uh-oh Âíå Ouch ËøôÊ†∑ÁöÑË°®Ëææ„ÄÇ</li>
</ol>
<h2 id="about-grammar" tabindex="-1">About grammar <a class="header-anchor" href="#about-grammar" aria-label="Permalink to &quot;About grammar&quot;"></a></h2>
<ol>
<li>
<p>ÂΩìÊÉ≥Â±ïÁ§∫‰Ω†ÂØªÊ±ÇÂ∏ÆÂä©ÁöÑ‰∫∫Êó∂ÔºåÂèØ‰ª•‰ΩøÁî® <code>get + someone + to + verb</code> or <code>have + someone + verb</code>.
a. I get my brother to fix my car.
b. I didn't pay to have someone repair my dishwasher.</p>
</li>
<li>
<p>ÂΩìÊèê‰æõÂ∏ÆÂä©ÁöÑ‰∫∫ÂæàÈáçË¶ÅÊó∂ÔºåÂèØ‰ª•‰ΩøÁî® get or have + something + past particle.<br>
a. I get my car fixed at my uncle's garage once a year.</p>
</li>
<li>
<p>ÂèØ‰ª•‰ΩøÁî® need to talk about things that should be done.<br>
a. need + passive infinitive. Like : The TV needs to be fixed.
b. need + verb + ing. Like : The screen needs adjusting.</p>
</li>
<li>
<p>ÈùûÊ≠£ÂºèÂè£ËØ≠Ë°®ËææÊâ©Â±ï
a. Ooh! = when you see a problem.<br>
b. Uh-oh! = when you suddenly discover a problem.<br>
c. Oops!/Whoops! = when you make a small mistake.<br>
d. Ow!/Ouch! = &quot;That hurt.&quot; / &quot;It sounds like that hurt&quot;.
e. Shoot! = &quot;Oh, no!&quot;(a general reaction)
f. Ugh!/Yuck! = &quot;It's disgusting.&quot;</p>
</li>
</ol>
<h2 id="Êñ∞ËØçÁªÑ" tabindex="-1">Êñ∞ËØçÁªÑ <a class="header-anchor" href="#Êñ∞ËØçÁªÑ" aria-label="Permalink to &quot;Êñ∞ËØçÁªÑ&quot;"></a></h2>
<ol>
<li>interior designer --&gt; ÂÆ§ÂÜÖËÆæËÆ°Â∏à</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Ë°å‰∏∫]]></title>
            <link>https://askaric.com/zh/work/english/02Ëã±ËØ≠Âè£ËØ≠/2-6Âú∫ÊôØ_Ë°å‰∏∫.html</link>
            <guid>https://askaric.com/zh/work/english/02Ëã±ËØ≠Âè£ËØ≠/2-6Âú∫ÊôØ_Ë°å‰∏∫.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[ÂÖ≥‰∫éÂÜÖÂÆπ

Here are something which will be talked below:  

1. ÂÅáËÆæË∞àËÆ∫ËøáÂéªÁöÑÁî®Ê≥ï : `would have`,`should have]]></description>
            <content:encoded><![CDATA[<h1 id="Ë°å‰∏∫" tabindex="-1">Ë°å‰∏∫ <a class="header-anchor" href="#Ë°å‰∏∫" aria-label="Permalink to &quot;Ë°å‰∏∫&quot;"></a></h1>
<h2 id="ÂÖ≥‰∫éÂÜÖÂÆπ" tabindex="-1">ÂÖ≥‰∫éÂÜÖÂÆπ <a class="header-anchor" href="#ÂÖ≥‰∫éÂÜÖÂÆπ" aria-label="Permalink to &quot;ÂÖ≥‰∫éÂÜÖÂÆπ&quot;"></a></h2>
<p>Here are something which will be talked below:</p>
<ol>
<li>ÂÅáËÆæË∞àËÆ∫ËøáÂéªÁöÑÁî®Ê≥ï : <code>would have</code>,<code>should have</code>,<code>could have</code>.</li>
<li>ÊèèËø∞ÊÉÖÁª™Âíå‰∏™‰∫∫ÂìÅË¥®.</li>
<li>Êé®ÊµãËøáÂéª :  <code>must have</code>, <code>may have</code>, <code>might have</code>, <code>could have</code>.</li>
</ol>
<h2 id="ÂÖ≥‰∫éËØ≠Ê≥ï" tabindex="-1">ÂÖ≥‰∫éËØ≠Ê≥ï <a class="header-anchor" href="#ÂÖ≥‰∫éËØ≠Ê≥ï" aria-label="Permalink to &quot;ÂÖ≥‰∫éËØ≠Ê≥ï&quot;"></a></h2>
<p>ÂèØ‰ª•‰ΩøÁî® would/should/could + have + ËøáÂéªÂàÜËØç ÂéªË∞àËÆ∫ÂÅáÊÉ≥ÁöÑËøáÂéª‰∫ãÊÉÖ.</p>
<ol>
<li>imageine your behavior in a situation : What would you have done? I'd have said no politely.</li>
<li>Say what was the right thing to do : What should she have done? She shouldn't have yelled at him.</li>
<li>Say waht other possiblities there were :  What else could she have done? She could have told him not to call again.</li>
<li>You could also use above grammer to speculate past things using modal verber, like :
a. must/coud/may/might + have + past participate
b. They must have gotten tied up in traffic.<br>
c. And, different modal verbs have different precent probability.</li>
</ol>
<h2 id="Êñ∞ÂçïËØç" tabindex="-1">Êñ∞ÂçïËØç <a class="header-anchor" href="#Êñ∞ÂçïËØç" aria-label="Permalink to &quot;Êñ∞ÂçïËØç&quot;"></a></h2>
<ol>
<li>aggressive  --&gt; Â•ΩÊñóÁöÑ</li>
<li>decisive --&gt; ÊûúÊñ≠ÁöÑ</li>
<li>impulsive --&gt; ÂÜ≤Âä®ÁöÑ</li>
<li>jealousy --&gt; Â´âÂ¶í</li>
<li>guilty --&gt; ÂÜÖÁñöÁöÑ</li>
<li>ashmaed --&gt; ÁæûÊÑßÁöÑ</li>
<li>depressed --&gt; ÊäëÈÉÅÁöÑ</li>
<li>sympathetic --&gt; ÂêåÊÉÖÁöÑ</li>
<li>felxible --&gt; ÊüîÈüßÁöÑ</li>
<li>honesty --&gt; ËØöÂÆûÁöÑ</li>
<li>grief --&gt; ÊÇ≤‰º§</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Â∑•‰Ωú]]></title>
            <link>https://askaric.com/zh/work/english/02Ëã±ËØ≠Âè£ËØ≠/2-7Âú∫ÊôØ_Â∑•‰Ωú.html</link>
            <guid>https://askaric.com/zh/work/english/02Ëã±ËØ≠Âè£ËØ≠/2-7Âú∫ÊôØ_Â∑•‰Ωú.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[ÂÖ≥‰∫éÂÜÖÂÆπ

1. ‰ΩøÁî®‰ªéÂè•ÂíåÈïøÁü≠ËØ≠ÂéªË∞àËÆ∫ËÅå‰∏öËÆ°Âàí
2. ‰ΩøÁî®Â∞ÜÊù•ÂÆåÊàêÊó∂Ë∞àËÆ∫ËÅå‰∏öËÆ°Âàí

 ÂÖ≥‰∫éËØ≠Ê≥ï

1. ‰∏ãÈù¢ÁöÑ‰æãÂ≠êÂéªË°®ËææÈáçË¶ÅÁöÑ‰∫ãÊÉÖ
    a. What you need is l]]></description>
            <content:encoded><![CDATA[<h1 id="Â∑•‰Ωú" tabindex="-1">Â∑•‰Ωú <a class="header-anchor" href="#Â∑•‰Ωú" aria-label="Permalink to &quot;Â∑•‰Ωú&quot;"></a></h1>
<h2 id="ÂÖ≥‰∫éÂÜÖÂÆπ" tabindex="-1">ÂÖ≥‰∫éÂÜÖÂÆπ <a class="header-anchor" href="#ÂÖ≥‰∫éÂÜÖÂÆπ" aria-label="Permalink to &quot;ÂÖ≥‰∫éÂÜÖÂÆπ&quot;"></a></h2>
<ol>
<li>‰ΩøÁî®‰ªéÂè•ÂíåÈïøÁü≠ËØ≠ÂéªË∞àËÆ∫ËÅå‰∏öËÆ°Âàí</li>
<li>‰ΩøÁî®Â∞ÜÊù•ÂÆåÊàêÊó∂Ë∞àËÆ∫ËÅå‰∏öËÆ°Âàí</li>
</ol>
<h2 id="ÂÖ≥‰∫éËØ≠Ê≥ï" tabindex="-1">ÂÖ≥‰∫éËØ≠Ê≥ï <a class="header-anchor" href="#ÂÖ≥‰∫éËØ≠Ê≥ï" aria-label="Permalink to &quot;ÂÖ≥‰∫éËØ≠Ê≥ï&quot;"></a></h2>
<ol>
<li>
<p>‰∏ãÈù¢ÁöÑ‰æãÂ≠êÂéªË°®ËææÈáçË¶ÅÁöÑ‰∫ãÊÉÖ
a. What you need is lots of info.(what clauses)
b. The main things you need is information.(long noun phrases)</p>
</li>
<li>
<p>ÊàëËÆ§‰∏∫ËøôÈÉ®ÂàÜÁ≠â‰∫é Âä®ËØç + ing ‰Ωú‰∏ªËØ≠„ÄÇ‰∏çÂêåÁöÑÊòØÔºåÊàë‰ª¨ÂèØ‰ª•Áî®Êõ¥Â∞ëÁöÑËØçÊàñ‰ªéÂè•Êù•ÊèèËø∞ what Êàñ ÈïøÁü≠ËØ≠ÔºåËÆ©ÂÆÉ‰ª¨‰∏∞ÂØåËµ∑Êù•„ÄÇ</p>
</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[‰∏™‰∫∫Ë∂£Âêë]]></title>
            <link>https://askaric.com/zh/work/english/02Ëã±ËØ≠Âè£ËØ≠/2-8Âú∫ÊôØ_‰∏™‰∫∫Ë∂£Âêë.html</link>
            <guid>https://askaric.com/zh/work/english/02Ëã±ËØ≠Âè£ËØ≠/2-8Âú∫ÊôØ_‰∏™‰∫∫Ë∂£Âêë.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[ÂÖ≥‰∫éÂÜÖÂÆπ

1. Ë∞àËÆ∫Êó∂Â∞öÂíåÂåñÂ¶Ü„ÄÇ
2. ‰∏é(‰∏ç)‰Ωú‰∏∫‚Ä¶‚Ä¶‰ΩúÊØîËæÉ‰Ωú‰∏∫„ÄÇ
3. ÂΩì‰Ω†ÊÉ≥Ë¶ÅÂà´‰∫∫ÂêåÊÑèÁöÑÊó∂ÂÄôÔºåÈóÆ‰∏Ä‰∫õÊ∂àÊûÅÁöÑÈóÆÈ¢ò„ÄÇ
4. ÊèèËø∞ÊúçË£Ö„ÄÇ
5. ÈÄöËøáÊÄªÁªìÂà´‰∫∫ËØ¥ÁöÑËØùÊù•Ë°®Ëææ‰Ω†ÁöÑÁêÜËß£„ÄÇ  
]]></description>
            <content:encoded><![CDATA[<h1 id="‰∏™‰∫∫Ë∂£Âêë" tabindex="-1">‰∏™‰∫∫Ë∂£Âêë <a class="header-anchor" href="#‰∏™‰∫∫Ë∂£Âêë" aria-label="Permalink to &quot;‰∏™‰∫∫Ë∂£Âêë&quot;"></a></h1>
<h2 id="ÂÖ≥‰∫éÂÜÖÂÆπ" tabindex="-1">ÂÖ≥‰∫éÂÜÖÂÆπ <a class="header-anchor" href="#ÂÖ≥‰∫éÂÜÖÂÆπ" aria-label="Permalink to &quot;ÂÖ≥‰∫éÂÜÖÂÆπ&quot;"></a></h2>
<ol>
<li>Ë∞àËÆ∫Êó∂Â∞öÂíåÂåñÂ¶Ü„ÄÇ</li>
<li>‰∏é(‰∏ç)‰Ωú‰∏∫‚Ä¶‚Ä¶‰ΩúÊØîËæÉ‰Ωú‰∏∫„ÄÇ</li>
<li>ÂΩì‰Ω†ÊÉ≥Ë¶ÅÂà´‰∫∫ÂêåÊÑèÁöÑÊó∂ÂÄôÔºåÈóÆ‰∏Ä‰∫õÊ∂àÊûÅÁöÑÈóÆÈ¢ò„ÄÇ</li>
<li>ÊèèËø∞ÊúçË£Ö„ÄÇ</li>
<li>ÈÄöËøáÊÄªÁªìÂà´‰∫∫ËØ¥ÁöÑËØùÊù•Ë°®Ëææ‰Ω†ÁöÑÁêÜËß£„ÄÇ<br>
<strong>Ê≥®ÊÑè</strong>Ôºö‰Ω†ÂèØ‰ª•ÊÄªÁªìÊüê‰∫∫ÂàöÂàöËØ¥ËøáÁöÑËØù„ÄÇËøôË°®ÊòéÂ•πÂèÇ‰∏é‰∫ÜË∞àËØùÔºåÂπ∂Ë∑ü‰∏ä‰∫ÜÂà´‰∫∫ËØ¥ÁöÑËØù„ÄÇ</li>
</ol>
<h2 id="ÂÖ≥‰∫éËØ≠Ê≥ï" tabindex="-1">ÂÖ≥‰∫éËØ≠Ê≥ï <a class="header-anchor" href="#ÂÖ≥‰∫éËØ≠Ê≥ï" aria-label="Permalink to &quot;ÂÖ≥‰∫éËØ≠Ê≥ï&quot;"></a></h2>
<ol>
<li>
<p>‰ΩøÁî® as ... as ÁªìÊûÑËøûÊé• adjectives, nouns, adverbs ÊØîËæÉ.<br>
a. Adjectives : THe pants are just as comfortable as my jeans.<br>
b. Nouns : She spends as little time as posible on her makeup.<br>
c. Adverbs : I tried as hard as I could to find the right style for her.</p>
</li>
<li>
<p>ÂΩì‰Ω†ÊÉ≥Êüê‰∫∫ÂêåÊÑè‰Ω†ÁöÑËßÇÁÇπÊòØÔºåÂèØ‰ª•Áî®Âèç‰πâÁñëÈóÆÂè•Ë°®Ëææ.<br>
a. To express an opinion : Don't you think it's great? or Isn't this Jacket great?<br>
b. To suggest an idea : Aren't they a little expensive? or It'd look good, don't you think?<br>
c. To show suprise : Isn't it on sale? or Don't you like it?</p>
</li>
</ol>
<h2 id="Êñ∞ÂçïËØç" tabindex="-1">Êñ∞ÂçïËØç <a class="header-anchor" href="#Êñ∞ÂçïËØç" aria-label="Permalink to &quot;Êñ∞ÂçïËØç&quot;"></a></h2>
<ol>
<li>scruffy --&gt; ‰∏çÊï¥ÈΩêÁöÑ</li>
<li>pastel shirt --&gt; ÊüîÂíåÁöÑË°¨Ë°´</li>
<li>bright --&gt; Êòé‰∫ÆÁöÑ</li>
<li>neon --&gt; ÈúìËôπÁÅØ</li>
<li>neon green --&gt; ËçßÂÖâÁªø</li>
<li>leather --&gt; ÁöÆÈù©</li>
<li>encyclopedia --&gt; ÁôæÁßëÂÖ®‰π¶</li>
</ol>
<h2 id="Êñ∞ËØçÁªÑ" tabindex="-1">Êñ∞ËØçÁªÑ <a class="header-anchor" href="#Êñ∞ËØçÁªÑ" aria-label="Permalink to &quot;Êñ∞ËØçÁªÑ&quot;"></a></h2>
<ol>
<li>broad tastes --&gt; ÂπøÊ≥õÁöÑÁà±Â•Ω</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[‰∏ñÁïåÊñáÂåñ]]></title>
            <link>https://askaric.com/zh/work/english/02Ëã±ËØ≠Âè£ËØ≠/2-9Âú∫ÊôØ_‰∏ñÁïåÊñáÂåñ.html</link>
            <guid>https://askaric.com/zh/work/english/02Ëã±ËØ≠Âè£ËØ≠/2-9Âú∫ÊôØ_‰∏ñÁïåÊñáÂåñ.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[ÂÖ≥‰∫éÂÜÖÂÆπ

1. Áî®‰∏ÄËà¨Áé∞Âú®Êó∂Ë∞àËÆ∫‰Ω†ÁöÑÊñáÂåñ„ÄÇ
2. Áî® Âä®ËØç + ing Âíå to + Âä®ËØçË∞àËÆ∫‰π†‰øóÂíåÁ§º‰ª™„ÄÇ
3. ‰ΩøÁî®ÂÉè ‚Äúto be honest‚Äù ËøôÊ†∑ÁöÑË°®ËææÂê¨Ëµ∑Êù•Êõ¥Áõ¥Êé•„ÄÇ
4. ‰ΩøÁî®]]></description>
            <content:encoded><![CDATA[<h1 id="‰∏ñÁïåÊñáÂåñ" tabindex="-1">‰∏ñÁïåÊñáÂåñ <a class="header-anchor" href="#‰∏ñÁïåÊñáÂåñ" aria-label="Permalink to &quot;‰∏ñÁïåÊñáÂåñ&quot;"></a></h1>
<h2 id="ÂÖ≥‰∫éÂÜÖÂÆπ" tabindex="-1">ÂÖ≥‰∫éÂÜÖÂÆπ <a class="header-anchor" href="#ÂÖ≥‰∫éÂÜÖÂÆπ" aria-label="Permalink to &quot;ÂÖ≥‰∫éÂÜÖÂÆπ&quot;"></a></h2>
<ol>
<li>Áî®‰∏ÄËà¨Áé∞Âú®Êó∂Ë∞àËÆ∫‰Ω†ÁöÑÊñáÂåñ„ÄÇ</li>
<li>Áî® Âä®ËØç + ing Âíå to + Âä®ËØçË∞àËÆ∫‰π†‰øóÂíåÁ§º‰ª™„ÄÇ</li>
<li>‰ΩøÁî®ÂÉè ‚Äúto be honest‚Äù ËøôÊ†∑ÁöÑË°®ËææÂê¨Ëµ∑Êù•Êõ¥Áõ¥Êé•„ÄÇ</li>
<li>‰ΩøÁî® <code>course</code> Êù•ÁªôÂá∫Âπ∂‰∏ç‰ª§‰∫∫ÊÉäËÆ∂ÁöÑ‰ø°ÊÅØÔºåÊàñËÄÖË°®Á§∫ÂêåÊÑè„ÄÇ</li>
</ol>
<h2 id="ÂÖ≥‰∫éËØ≠Ê≥ï" tabindex="-1">ÂÖ≥‰∫éËØ≠Ê≥ï <a class="header-anchor" href="#ÂÖ≥‰∫éËØ≠Ê≥ï" aria-label="Permalink to &quot;ÂÖ≥‰∫éËØ≠Ê≥ï&quot;"></a></h2>
<ol>
<li>
<p>ÂΩìË°å‰∏∫ÁöÑÂèëÂá∫ËÄÖ‰∏çÈáçË¶ÅÊó∂Ôºå‰ΩøÁî®Ë¢´Âä®ËØ≠ÊÄÅ„ÄÇ
a. Active, How do they make kimpap?  They make it with rice and vegetables.<br>
b. Passive : How is kimpap made? It's made with rice and vegetables.</p>
</li>
<li>
<p>Â¶ÇÊûúË°å‰∏∫ÁöÑÂèëÂá∫ËÄÖÂæàÈáçË¶ÅÔºå‰Ω†ÂèØ‰ª•Áî®byÊù•‰ªãÁªçÂÆÉ„ÄÇ
a. THe sculptures are carved by teams from all over the world.</p>
</li>
<li>
<p>Verb + ing ‰Ωú‰∏ªËØ≠
a. Eating in public is bad manners.</p>
</li>
<li>
<p>Verb + ing Âú®‰ªãËØçÂêé
a. You can offend people by eating in public.</p>
</li>
<li>
<p>‰ΩøÁî® To + verb Âú® It's ...<br>
a. It's bad manners to eat in public.</p>
</li>
<li>
<p>not ÁöÑ‰ªãËØç‰ΩøÁî®
a. Not comes before the word it negates. Like : be careful not to point at people.
b. That are difference meanings between <code>be careful not to</code> and <code>not becareful to</code>.</p>
</li>
<li>
<p>Of course ÈÄöÂ∏∏ÊÑèÂë≥ÁùÄËøô‰∏™ÊÉ≥Ê≥ïÂπ∂‰∏ç‰ª§‰∫∫ÊÉäËÆ∂„ÄÇËøôÂ∞±ÊòØ‰Ω†ÊâÄÊúüÊúõÁöÑ„ÄÇ</p>
</li>
<li>
<p>‰Ω†‰πüÂèØ‰ª•Âú®ÂõûÁ≠î‰∏≠‰ΩøÁî® <code>Of course</code> Êù•Ë°®Á§∫‰Ω†ÂêåÊÑèÊàñÁêÜËß£„ÄÇ
a. When you are living here, do you miss your home? --&gt; Of course or I really miss my home.</p>
</li>
</ol>
<h2 id="Êñ∞ÂçïÊ¨°" tabindex="-1">Êñ∞ÂçïÊ¨° <a class="header-anchor" href="#Êñ∞ÂçïÊ¨°" aria-label="Permalink to &quot;Êñ∞ÂçïÊ¨°&quot;"></a></h2>
<ol>
<li>dish(foods or tools for carrying foods) --&gt; Ëèú</li>
<li>handicraft --&gt; Â∑•Ëâ∫ÂìÅ</li>
<li>earrings --&gt; ËÄ≥ÁéØ</li>
<li>tip(give a fee) --&gt; Â∞èË¥π</li>
<li>negates(negative) --&gt; Âê¶ÂÆö</li>
<li>concise --&gt; ÁÆÄÊ¥ÅÁöÑ</li>
<li>decisive --&gt; ÂÜ≥ÂÆöÊÄßÁöÑ</li>
</ol>
<h2 id="Êñ∞ËØçÁªÑ" tabindex="-1">Êñ∞ËØçÁªÑ <a class="header-anchor" href="#Êñ∞ËØçÁªÑ" aria-label="Permalink to &quot;Êñ∞ËØçÁªÑ&quot;"></a></h2>
<ol>
<li>carved out of --&gt; Âü∫‰∫é...ÈõïÂàªÁöÑ</li>
<li>cut in line  --&gt; ÊèíÈòü</li>
<li>keep your voice down --&gt; ‰øùÊåÅÂ∞èÂ£∞</li>
<li>bowing or shaking hands --&gt; Êè°Êâã</li>
<li>walk around barefoot --&gt; Ë£∏ËÑöËµ∞Ë∑Ø</li>
<li>take off your shoes --&gt; ÊãñÈûã</li>
<li>showing affection --&gt; ËØïÁà±</li>
<li>point at --&gt; ÊåáÂêë</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[ÊàêÂäü‰∏éÂø´‰πê]]></title>
            <link>https://askaric.com/zh/work/english/03È´òÁ∫ßÂè£ËØ≠/3-10Âú∫ÊôØ_ÊàêÂäü‰∏éÂø´‰πê.html</link>
            <guid>https://askaric.com/zh/work/english/03È´òÁ∫ßÂè£ËØ≠/3-10Âú∫ÊôØ_ÊàêÂäü‰∏éÂø´‰πê.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[ÂÖ≥‰∫éÂÜÖÂÆπ
1. Ë∞àËÆ∫ÊàêÂäüÂíåÂπ∏Á¶è
2. ‰ΩøÁî®all, both, each, every, neither, none of, no
3. Â≠¶‰π† -ing ÂΩ¢ÂºèÁöÑÊõ¥Â§öÁî®Ê≥ï
4. Áî® As far As ]]></description>
            <content:encoded><![CDATA[<h1 id="ÊàêÂäü‰∏éÂø´‰πê" tabindex="-1">ÊàêÂäü‰∏éÂø´‰πê <a class="header-anchor" href="#ÊàêÂäü‰∏éÂø´‰πê" aria-label="Permalink to &quot;ÊàêÂäü‰∏éÂø´‰πê&quot;"></a></h1>
<h2 id="ÂÖ≥‰∫éÂÜÖÂÆπ" tabindex="-1">ÂÖ≥‰∫éÂÜÖÂÆπ <a class="header-anchor" href="#ÂÖ≥‰∫éÂÜÖÂÆπ" aria-label="Permalink to &quot;ÂÖ≥‰∫éÂÜÖÂÆπ&quot;"></a></h2>
<ol>
<li>Ë∞àËÆ∫ÊàêÂäüÂíåÂπ∏Á¶è</li>
<li>‰ΩøÁî®all, both, each, every, neither, none of, no</li>
<li>Â≠¶‰π† -ing ÂΩ¢ÂºèÁöÑÊõ¥Â§öÁî®Ê≥ï</li>
<li>Áî® As far As I'm concerned, ...</li>
</ol>
<h2 id="about-grammar" tabindex="-1">About grammar <a class="header-anchor" href="#about-grammar" aria-label="Permalink to &quot;About grammar&quot;"></a></h2>
<ol>
<li>
<p>ÂçïÊï∞ÂêçËØç<br>
a. each entrepreneur was successful.<br>
b. Every restaurant rejected the recipe.<br>
c. No entrepreneur wants to fail.<br>
d. No restaurant accepted the recipe.</p>
</li>
<li>
<p>Both(= two)<br>
a. Both products got off to a good start.<br>
b. Both (of) these men become billionaires.<br>
c. Neither product was a success as first.<br>
d. Neither of the men let failure get them down.</p>
</li>
<li>
<p>Â§çÊï∞ÂêçËØç<br>
a. All successful people have vision.<br>
b. All (of) these people were successful.<br>
c. No successful people get ahead easily.<br>
d. None of these people graduated from college.</p>
</li>
<li>
<p>‰∏çÂèØÊï∞Êï∞ÂêçËØç<br>
a. All(of) their hard work paid off.<br>
b. None of their hard work was wasted.</p>
</li>
<li>
<p>‰Ω†ÂèØ‰ª•‰ΩøÁî®Ë¢´Âä®ËØ≠ÊÄÅ‰ΩøÂä®‰ΩúÁöÑÊé•Êî∂ËÄÖÊàê‰∏∫ÁÑ¶ÁÇπ<br>
a. Experts expect the population to rise.<br>
b. the population is expected to rise.</p>
</li>
<li>
<p>Verb + object + verb(help, let, make)<br>
a. Blueberries are said to help you concentrate.<br>
b. Make the pain go away with cherries.</p>
</li>
<li>
<p>Verb + object + infinitive(allow, cause, enable, help)<br>
a. Eating too much salt may cause your blood pressure to rise.<br>
b. Researchers say chili preppers enable you to lose weight.</p>
</li>
<li>
<p>Verb + object + form + -ing form(keep, prevent, protect, stop, all of these verbs can also be used with from)<br>
a. Avocado may prevent / stop your skin (from) aging.<br>
b. Kiwis are said to keep your eyesight from deteriorating.</p>
</li>
<li>
<p>Â¶Ç‰Ωï‰ΩøÁî®‰∏ãÈù¢Ëøô‰∫õÁü≠ËØ≠„ÄÇ<br>
a. As far as (success) is concerned, ...<br>
c. As far as (careers) go, ...<br>
d. When it comes to happiness / being happy, ...<br>
e. ... in terms of ...</p>
</li>
<li>
<p>Âú®ÂØπËØù‰∏≠ÔºåÊàë‰ª¨ÂèØ‰ª•Áî®‰∏ãÈù¢ÁöÑÁü≠ËØ≠Êù•Ë°®Ëææ <code>In my opinion</code>.<br>
a. As far as I'm concerned(frequency == üåüüåüüåü)<br>
b. As far as I know(frequency == üåüüåü)<br>
c. As far as I can tell(frequency == üåü)</p>
</li>
<li>
<p>Ê∑ªÂä†Ë°•ÂÖÖ‰ø°ÊÅØ(-ing form)<br>
a. An -ing form can be a reduced relative clause. Like: There are some people digging for clams.<br>
b. An -ing form can describe one event that happens at the same time as another. Notice the commas. Like: We'd run around, playing in the sand, not caring ...<br>
c. An -ing form can come before or after be. It can be the subject or object of a verb. Like: My happinest moments were playing on this beach. Or, being successful is good. Or, I remember sitting outside.</p>
</li>
</ol>
<h2 id="Êñ∞ÂçïËØç" tabindex="-1">Êñ∞ÂçïËØç <a class="header-anchor" href="#Êñ∞ÂçïËØç" aria-label="Permalink to &quot;Êñ∞ÂçïËØç&quot;"></a></h2>
<ol>
<li>pursue/seek/devote oneself to</li>
<li>nevertheless</li>
<li>recipe/secret (of success)</li>
<li>culinary/cooked</li>
<li>setback/suffering</li>
<li>deteriorate/getting worse</li>
<li>jointÔºàconjunct(adj.)/collaborate(v.)Ôºâ</li>
<li>cohesionÔºàsufferingÔºâ</li>
<li>tortureÔºàsufferingÔºâ</li>
</ol>
<h2 id="Êñ∞ËØçÁªÑ" tabindex="-1">Êñ∞ËØçÁªÑ <a class="header-anchor" href="#Êñ∞ËØçÁªÑ" aria-label="Permalink to &quot;Êñ∞ËØçÁªÑ&quot;"></a></h2>
<ol>
<li>get anywhere/to be successful</li>
<li>get off the ground/take off</li>
<li>get it under way/start</li>
<li>got to be one of the most XXX/become</li>
<li>got off to a good start</li>
<li>get them down</li>
<li>get in their way</li>
<li>get on with/restart/continue</li>
<li>get ahead</li>
<li>got to the top</li>
<li>go as far as you can in your career</li>
<li>direct ratio</li>
<li>inverse ratio</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Âá∫Ê∏∏]]></title>
            <link>https://askaric.com/zh/work/english/03È´òÁ∫ßÂè£ËØ≠/3-11Âú∫ÊôØ_Âá∫Ê∏∏.html</link>
            <guid>https://askaric.com/zh/work/english/03È´òÁ∫ßÂè£ËØ≠/3-11Âú∫ÊôØ_Âá∫Ê∏∏.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[ÂÖ≥‰∫éÂÜÖÂÆπ
1. Ë∞àËÆ∫ÊóÖË°åÂíåÂÅáÊúü„ÄÇ
2. Â≠¶‰π†Êõ¥Â§öÂÖ≥‰∫éÈó¥Êé•ÂºïËØ≠ÂíåÈó¥Êé•ÊÄùÊÉ≥ÁöÑÁü•ËØÜ„ÄÇ
3. ‰ªé‰∫∫‰ª¨ÊâÄËØ¥ÁöÑ‰∫ãÊÉÖ‰∏≠ÂæóÂá∫ÁªìËÆ∫„ÄÇ
4. Áî® in what way? ËØ¢ÈóÆÁªÜËäÇ„ÄÇ
 ÂÖ≥‰∫éËØ≠Ê≥ï
1. ÂΩì‰Ω†Êä•ÈÅì‰∫∫‰ª¨ËøáÂéªËØ¥]]></description>
            <content:encoded><![CDATA[<h1 id="Âá∫Ê∏∏" tabindex="-1">Âá∫Ê∏∏ <a class="header-anchor" href="#Âá∫Ê∏∏" aria-label="Permalink to &quot;Âá∫Ê∏∏&quot;"></a></h1>
<h2 id="ÂÖ≥‰∫éÂÜÖÂÆπ" tabindex="-1">ÂÖ≥‰∫éÂÜÖÂÆπ <a class="header-anchor" href="#ÂÖ≥‰∫éÂÜÖÂÆπ" aria-label="Permalink to &quot;ÂÖ≥‰∫éÂÜÖÂÆπ&quot;"></a></h2>
<ol>
<li>Ë∞àËÆ∫ÊóÖË°åÂíåÂÅáÊúü„ÄÇ</li>
<li>Â≠¶‰π†Êõ¥Â§öÂÖ≥‰∫éÈó¥Êé•ÂºïËØ≠ÂíåÈó¥Êé•ÊÄùÊÉ≥ÁöÑÁü•ËØÜ„ÄÇ</li>
<li>‰ªé‰∫∫‰ª¨ÊâÄËØ¥ÁöÑ‰∫ãÊÉÖ‰∏≠ÂæóÂá∫ÁªìËÆ∫„ÄÇ</li>
<li>Áî® in what way? ËØ¢ÈóÆÁªÜËäÇ„ÄÇ</li>
</ol>
<h2 id="ÂÖ≥‰∫éËØ≠Ê≥ï" tabindex="-1">ÂÖ≥‰∫éËØ≠Ê≥ï <a class="header-anchor" href="#ÂÖ≥‰∫éËØ≠Ê≥ï" aria-label="Permalink to &quot;ÂÖ≥‰∫éËØ≠Ê≥ï&quot;"></a></h2>
<ol>
<li>
<p>ÂΩì‰Ω†Êä•ÈÅì‰∫∫‰ª¨ËøáÂéªËØ¥ËøáÁöÑ‰∫ãÊÉÖÊó∂ÔºåÂä®ËØçÁöÑÊó∂ÊÄÅÈÄöÂ∏∏‰ºöÂèòÂõûÂéª„ÄÇ<br>
a. &quot;The plane's just a 16-seater&quot; --&gt; The agent explained the plane was just a 16-seater.<br>
b. &quot;The last bus has left.&quot; --&gt; She informed me the last bus had left.</p>
</li>
<li>
<p>Ëøô‰∫õÊÉÖÊÄÅÂä®ËØçÂú®Èó¥Êé•ÂºïËØ≠‰∏≠‰ºöÂèëÁîüÂèòÂåñ:<br>
a. &quot;There may be a delay.&quot; --&gt; She said there might be a delay.</p>
</li>
<li>
<p>Êó∂Èó¥ÁöÑË°®ËææÊñπÂºè‰πüÁªèÂ∏∏ÊîπÂèò„ÄÇ‰ΩÜÊòØÔºåËøô‰∫õÊÉÖÊÄÅÂä®ËØçÊòØ‰∏çÂèòÁöÑÔºåÊØîÂ¶Ç:could, should, would, might, used to<br>
a. &quot;The flights are full today and tomorrow.&quot; --&gt; He said the flights were full that day and the next day.</p>
</li>
<li>
<p>Èó¥Êé•ÁñëÈóÆÂè•‰ΩøÁî®ÈôàËø∞Âè•ÁöÑËØçÂ∫è„ÄÇ‰ªñ‰ª¨Ê≤°ÊúâÈóÆÂè∑„ÄÇ<br>
a. &quot;Are you married?&quot; --&gt; People often ask me whether/if I'm married.<br>
b. &quot;What do you take with you?&quot; --&gt; We asked people what they take/took with them.<br>
c. &quot;Why shouldn't I use hotel shampoo&quot; --&gt; She asked me why she shouldn't use hotel shampoo.</p>
</li>
<li>
<p>ÂΩì‰Ω†ËΩ¨Ëø∞Êó∂ÂÖ≥‰∫éÁé∞Âú®ÊàñÂ∞ÜÊù•‰ªçÁÑ∂ÁúüÂÆûÊàñÁõ∏ÂÖ≥ÁöÑ‰ø°ÊÅØÊó∂Ôºå‰Ω†‰∏çÈúÄË¶Å‚Äúshift back‚ÄùÂä®ËØçÊó∂ÊÄÅ„ÄÇ<br>
a. &quot;Do you have any kids?&quot; &quot;I have two.&quot; --&gt; A woman asked me if I have kids. I told her I have two.<br>
b. &quot;Where are you going on your next trip?&quot; --&gt; He wanted to know where I'm going on my next trip.</p>
</li>
<li>
<p>Âú® ask„ÄÅtell„ÄÅorder„ÄÅadvise ÂêéÈù¢‰ΩøÁî®‰∏çÂÆöÂºèÊù•Êä•ÂëäËØ∑Ê±Ç„ÄÅÂª∫ËÆÆÊàñÊåáÁ§∫„ÄÇ<br>
a. &quot;Can you lend me a flashlight?&quot; --&gt; My sister asked me to lend her a flashlight.<br>
b. &quot;Don't use hotel shampoo.&quot; --&gt; A friend told/advised me not to use hotel shampoo.</p>
</li>
<li>
<p>‰Ω†ÂèØ‰ª•Áî® <code>in what way?</code> Êù•ËØ¢ÈóÆÂÖ≥‰∫éÊüê‰∫∫ÊÉ≥Ê≥ïÊàñËßÇÁÇπÁöÑÊõ¥Â§öÁªÜËäÇ„ÄÇ</p>
</li>
<li>
<p>Â¶Ç‰ΩïÁî®ËøôÊ†∑ÁöÑË°®ËææÊñπÂºè‰ªéÂè¶‰∏Ä‰∏™‰∫∫ËØ¥ÁöÑËØù‰∏≠ÂæóÂá∫ÁªìËÆ∫„ÄÇ<br>
a. (So) you're saying (that) ...<br>
b. (So) what you're saying is ...<br>
c. (so) I guess ... (then)<br>
d. you mean</p>
</li>
</ol>
<h2 id="ÂøÖÈ°ªÂÖãÊúçÁöÑÈóÆÈ¢ò" tabindex="-1">ÂøÖÈ°ªÂÖãÊúçÁöÑÈóÆÈ¢ò <a class="header-anchor" href="#ÂøÖÈ°ªÂÖãÊúçÁöÑÈóÆÈ¢ò" aria-label="Permalink to &quot;ÂøÖÈ°ªÂÖãÊúçÁöÑÈóÆÈ¢ò&quot;"></a></h2>
<ol>
<li>Âå∫ÂàÜ‰ª•‰∏ãÂçïËØçÁöÑÂèëÈü≥ÂíåÊÑèÊÄù:<br>
a. plane/plan/explan/planet/planet/plant<br>
b. candle and candy<br>
c. clams and claim</li>
</ol>
<h2 id="Êñ∞ÂçïËØç" tabindex="-1">Êñ∞ÂçïËØç <a class="header-anchor" href="#Êñ∞ÂçïËØç" aria-label="Permalink to &quot;Êñ∞ÂçïËØç&quot;"></a></h2>
<ol>
<li>suburb/environs</li>
<li>climb/crawl up</li>
<li>meant</li>
<li>scented/ a scented candle</li>
<li>flashlight</li>
<li>earplugs</li>
<li>shampoo</li>
<li>conditioner</li>
<li>streetlight</li>
<li>hairstylist/hairdresser</li>
<li>galaxy/milky way</li>
<li>frightening/awful</li>
<li>prospect/view/possiblity/investigate</li>
<li>sensation/feeling</li>
<li>floating/weightless</li>
<li>voyage</li>
<li>fantasy</li>
<li>roller coasters</li>
</ol>
<h2 id="Êñ∞ËØçÁªÑ" tabindex="-1">Êñ∞ËØçÁªÑ <a class="header-anchor" href="#Êñ∞ËØçÁªÑ" aria-label="Permalink to &quot;Êñ∞ËØçÁªÑ&quot;"></a></h2>
<ol>
<li>It energizes you(though it's a sentence)</li>
<li>someone could live longer lives(though it's a sentence)</li>
<li>Weird in what way?</li>
<li>upside down</li>
<li>blast off/take off</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[ÊñáÂåñ]]></title>
            <link>https://askaric.com/zh/work/english/03È´òÁ∫ßÂè£ËØ≠/3-12Âú∫ÊôØ_ÊñáÂåñ.html</link>
            <guid>https://askaric.com/zh/work/english/03È´òÁ∫ßÂè£ËØ≠/3-12Âú∫ÊôØ_ÊñáÂåñ.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[ÂÖ≥‰∫éÂÜÖÂÆπ
1. Ë∞àËÆ∫Â©öÁ§º„ÄÅÁ§ºÁâ©Âíå‰º†Áªü„ÄÇ
2. ‰∏éwhen, where, whoseËøûÁî®ÂÖ≥Á≥ª‰ªéÂè•„ÄÇ
3. ‰ΩøÁî®Â∏¶Êúâ‰∏§‰∏™ÂÆæËØ≠ÁöÑÂä®ËØç„ÄÇ
4. Áî®ÂÉè little ËøôÊ†∑ÁöÑË°®ËææÊù•ËΩØÂåñËØÑËÆ∫„ÄÇ
5. ËØ¥‚ÄúÊòØÁöÑÔºå‰∏ç]]></description>
            <content:encoded><![CDATA[<h1 id="ÊñáÂåñ" tabindex="-1">ÊñáÂåñ <a class="header-anchor" href="#ÊñáÂåñ" aria-label="Permalink to &quot;ÊñáÂåñ&quot;"></a></h1>
<h2 id="ÂÖ≥‰∫éÂÜÖÂÆπ" tabindex="-1">ÂÖ≥‰∫éÂÜÖÂÆπ <a class="header-anchor" href="#ÂÖ≥‰∫éÂÜÖÂÆπ" aria-label="Permalink to &quot;ÂÖ≥‰∫éÂÜÖÂÆπ&quot;"></a></h2>
<ol>
<li>Ë∞àËÆ∫Â©öÁ§º„ÄÅÁ§ºÁâ©Âíå‰º†Áªü„ÄÇ</li>
<li>‰∏éwhen, where, whoseËøûÁî®ÂÖ≥Á≥ª‰ªéÂè•„ÄÇ</li>
<li>‰ΩøÁî®Â∏¶Êúâ‰∏§‰∏™ÂÆæËØ≠ÁöÑÂä®ËØç„ÄÇ</li>
<li>Áî®ÂÉè little ËøôÊ†∑ÁöÑË°®ËææÊù•ËΩØÂåñËØÑËÆ∫„ÄÇ</li>
<li>ËØ¥‚ÄúÊòØÁöÑÔºå‰∏ç‰æµÁäØ‚ÄùÔºåÂπ∂ÂèëË°®ËØÑËÆ∫„ÄÇ</li>
</ol>
<h2 id="ÂÖ≥‰∫éËØ≠Ê≥ï" tabindex="-1">ÂÖ≥‰∫éËØ≠Ê≥ï <a class="header-anchor" href="#ÂÖ≥‰∫éËØ≠Ê≥ï" aria-label="Permalink to &quot;ÂÖ≥‰∫éËØ≠Ê≥ï&quot;"></a></h2>
<ol>
<li>
<p>When„ÄÅwhereÂíåwhoseÂèØ‰ª•ÂºïÂÖ•ÂÆöËØ≠‰ªéÂè•ÂíåÈùûÂÆöËØ≠‰ªéÂè•„ÄÇ<br>
a. Time -  when<br>
b. e.g. : There's a touching moment when the bride walks down the aisle.<br>
c. Place - where<br>
d. e.g. : There are places in the U.S. where a celebrity look-alike peforms the ceremony.<br>
e. Possessopm - whose<br>
f. e.g. : I have lots of friends whose parents used a matchmaker.</p>
</li>
<li>
<p>Ê≥®ÊÑèÂä®ËØçÁöÑÂè•ÂûãÔºåÊØîÂ¶Çbring, buy, give, lend, make, offer, send„ÄÇ</p>
<table tabindex="0">
<thead>
<tr>
<th></th>
<th>indirect object</th>
<th>direct object</th>
</tr>
</thead>
<tbody>
<tr>
<td>I never give</td>
<td>my friends / them</td>
<td>money</td>
</tr>
<tr>
<td>She lent</td>
<td>someone</td>
<td>her book</td>
</tr>
<tr>
<td>A friend sent</td>
<td>my monther</td>
<td>a gift</td>
</tr>
<tr>
<td>I bought / made</td>
<td>his monther</td>
<td>something / one</td>
</tr>
</tbody>
</table>
<table tabindex="0">
<thead>
<tr>
<th></th>
<th>object</th>
<th>prepositional phrase</th>
</tr>
</thead>
<tbody>
<tr>
<td>I never give</td>
<td>money</td>
<td>to my friends / them</td>
</tr>
<tr>
<td>She lent</td>
<td>her book / it</td>
<td>to someone</td>
</tr>
<tr>
<td>A friend sent</td>
<td>a gift</td>
<td>to my monther</td>
</tr>
<tr>
<td>I bought / made</td>
<td>something / one</td>
<td>for his monther</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Êàë‰ª¨Áî®‰∏ãÈù¢ÁöÑËØçÊù•ËΩØÂåñÊàë‰ª¨ÁöÑËØÑËÆ∫„ÄÇ<br>
a. kind of, a(little) bit, not really, sort of, slightly, not quite, a little, somewhat<br>
b. Kind of, a little and sort of are the most common expressions.<br>
c. Somewhat and slightly are more common in formal speaking.<br>
d. People often use not quite with sure, right, true, clear and certain.</p>
</li>
<li>
<p>Áî®‚ÄúYeah, no‚Äù Êù•ÂêåÊÑèÊüê‰∫∫ÔºåÁÑ∂ÂêéÂèëË°®Ëá™Â∑±ÁöÑËØÑËÆ∫„ÄÇ<br>
a. Yeah : you're talking/ I agree with you.<br>
b. no : no, that's not good.</p>
</li>
</ol>
<h2 id="ÊàëÁöÑÈóÆÈ¢ò" tabindex="-1">ÊàëÁöÑÈóÆÈ¢ò <a class="header-anchor" href="#ÊàëÁöÑÈóÆÈ¢ò" aria-label="Permalink to &quot;ÊàëÁöÑÈóÆÈ¢ò&quot;"></a></h2>
<ol>
<li>Ê≥®ÊÑè‰∏ãÈù¢ÂçïËØçÁöÑÂèëÈü≥:<br>
a. two special words : 20th and 30th</li>
</ol>
<h2 id="Êñ∞ÂçïËØç" tabindex="-1">Êñ∞ÂçïËØç <a class="header-anchor" href="#Êñ∞ÂçïËØç" aria-label="Permalink to &quot;Êñ∞ÂçïËØç&quot;"></a></h2>
<ol>
<li>fortune-teller</li>
<li>aisle</li>
<li>bride/groom</li>
<li>symbolize/stand for</li>
<li>newlyweds</li>
<li>prosperity</li>
<li>western-style ceremonies</li>
<li>rehearsal/repeating</li>
<li>bachelor</li>
<li>bachelorette</li>
<li>bridesmaid(s)</li>
<li>groomsmen</li>
<li>exchange vows</li>
<li>obliged</li>
<li>punch you</li>
<li>bizarre/eccentric</li>
<li>costume/clothe</li>
</ol>
<h2 id="Êñ∞ËØçÁªÑ" tabindex="-1">Êñ∞ËØçÁªÑ <a class="header-anchor" href="#Êñ∞ËØçÁªÑ" aria-label="Permalink to &quot;Êñ∞ËØçÁªÑ&quot;"></a></h2>
<ol>
<li>go to reception</li>
<li>walks down the aisle</li>
<li>parents of the groom host a dinner</li>
<li>tear off</li>
<li>out of tune(with)/weird/odd</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[ËÉΩÂäõ]]></title>
            <link>https://askaric.com/zh/work/english/03È´òÁ∫ßÂè£ËØ≠/3-13Âú∫ÊôØ_ËÉΩÂäõ.html</link>
            <guid>https://askaric.com/zh/work/english/03È´òÁ∫ßÂè£ËØ≠/3-13Âú∫ÊôØ_ËÉΩÂäõ.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[ÂÖ≥‰∫éÂÜÖÂÆπ
1. Ë∞àËÆ∫Êô∫Âäõ„ÄÅÊäÄËÉΩÂíåËÉΩÂäõ„ÄÇ
2. ‰ΩøÁî®ÂâØËØçÂíåÂΩ¢ÂÆπËØçÊù•ÊèèËø∞ÂíåÊØîËæÉ„ÄÇ
3. ÂΩì‰Ω†‰∏çÈúÄË¶ÅÁ≤æÁ°ÆË°®ËææÊó∂Ôºå‰ΩøÁî®Ê®°Á≥äÁöÑË°®Ëææ„ÄÇ
4. ÂêåÊÑèÊüê‰∫∫‰ΩøÁî®‚ÄúÊØ´Êó†ÁñëÈóÆ‚ÄùËøôÊ†∑ÁöÑÂõûÁ≠î„ÄÇ
 ÂÖ≥‰∫éËØ≠Ê≥ï
1. ‰Ω†ÂèØ‰ª•Âú®ÂΩ¢ÂÆπËØç]]></description>
            <content:encoded><![CDATA[<h1 id="ËÉΩÂäõ" tabindex="-1">ËÉΩÂäõ <a class="header-anchor" href="#ËÉΩÂäõ" aria-label="Permalink to &quot;ËÉΩÂäõ&quot;"></a></h1>
<h2 id="ÂÖ≥‰∫éÂÜÖÂÆπ" tabindex="-1">ÂÖ≥‰∫éÂÜÖÂÆπ <a class="header-anchor" href="#ÂÖ≥‰∫éÂÜÖÂÆπ" aria-label="Permalink to &quot;ÂÖ≥‰∫éÂÜÖÂÆπ&quot;"></a></h2>
<ol>
<li>Ë∞àËÆ∫Êô∫Âäõ„ÄÅÊäÄËÉΩÂíåËÉΩÂäõ„ÄÇ</li>
<li>‰ΩøÁî®ÂâØËØçÂíåÂΩ¢ÂÆπËØçÊù•ÊèèËø∞ÂíåÊØîËæÉ„ÄÇ</li>
<li>ÂΩì‰Ω†‰∏çÈúÄË¶ÅÁ≤æÁ°ÆË°®ËææÊó∂Ôºå‰ΩøÁî®Ê®°Á≥äÁöÑË°®Ëææ„ÄÇ</li>
<li>ÂêåÊÑèÊüê‰∫∫‰ΩøÁî®‚ÄúÊØ´Êó†ÁñëÈóÆ‚ÄùËøôÊ†∑ÁöÑÂõûÁ≠î„ÄÇ</li>
</ol>
<h2 id="ÂÖ≥‰∫éËØ≠Ê≥ï" tabindex="-1">ÂÖ≥‰∫éËØ≠Ê≥ï <a class="header-anchor" href="#ÂÖ≥‰∫éËØ≠Ê≥ï" aria-label="Permalink to &quot;ÂÖ≥‰∫éËØ≠Ê≥ï&quot;"></a></h2>
<ol>
<li>
<p>‰Ω†ÂèØ‰ª•Âú®ÂΩ¢ÂÆπËØçÂíåÂâØËØç‰πãÂâç‰ΩøÁî®ËøôÊ†∑ÁöÑÂâØËØçÊù•‰ªãÁªçËøô‰∫õÊÉ≥Ê≥ï„ÄÇ<br>
a. Degree -- extremely, highly, relatively  -- They're extremely literate and highly skilled.<br>
b. Type -- scientifically, linguistically -- Linguistically intelligent people are good at languages.<br>
c. Opinion -- incredibly, remarkably -- They seem to solve problems incredibly easily.<br>
d. Focus -- especially, particularly -- People with logical intelligence are especially good at math.</p>
</li>
<li>
<p>ÊØîËæÉÁ∫ßÂíåÊúÄÈ´òÁ∫ßÔºåÂΩ¢ÂÆπËØçÂíåÂâØËØç</p>
<table tabindex="0">
<thead>
<tr>
<th></th>
<th>Comparatives and as ... as</th>
<th>Superlatives</th>
</tr>
</thead>
<tbody>
<tr>
<td>Adjectives</td>
<td>I feel <strong>happier</strong>, and I've gotten better at it.</td>
<td>The race is my biggest and best challenge.</td>
</tr>
<tr>
<td></td>
<td>I'm <strong>more confident</strong> and <strong>less nervous</strong>.</td>
<td>Talking a course was <strong>the most sensible</strong> idea.</td>
</tr>
<tr>
<td></td>
<td>I'm not <strong>as fast as</strong> I'd like to be.</td>
<td>I was <strong>the least experienced</strong> presenter.</td>
</tr>
<tr>
<td>Adverbs</td>
<td>I'm training <strong>harder</strong> than ever.</td>
<td>We all train hard, but I <strong>train</strong> hardest.</td>
</tr>
<tr>
<td></td>
<td>I'm improving <strong>more slowly</strong> than I'd hoped.</td>
<td>I train <strong>(the) most often</strong> on weekends.</td>
</tr>
<tr>
<td></td>
<td>I practice <strong>less often</strong> than I should.</td>
<td></td>
</tr>
<tr>
<td></td>
<td>I don't play <strong>as often as</strong> I should.</td>
<td><strong>(Superlative adverbs with least are not common)</strong></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Ê®°Á≥äÁöÑË°®Ëææ</p>
<table tabindex="0">
<thead>
<tr>
<th>less common in formal</th>
<th>more common in formal</th>
</tr>
</thead>
<tbody>
<tr>
<td>... and things (like that)/ and stuff (like that)</td>
<td>and so on</td>
</tr>
<tr>
<td>... and all/ and all that</td>
<td>and all that</td>
</tr>
<tr>
<td>... and that kind of thing / and that sort of thing</td>
<td>and things</td>
</tr>
<tr>
<td>... and everything</td>
<td>and stuff</td>
</tr>
</tbody>
</table>
</li>
</ol>
<h2 id="Êñ∞ÂçïËØç" tabindex="-1">Êñ∞ÂçïËØç <a class="header-anchor" href="#Êñ∞ÂçïËØç" aria-label="Permalink to &quot;Êñ∞ÂçïËØç&quot;"></a></h2>
<ol>
<li>rookie/noob</li>
<li>imprecise/inadequate</li>
<li>articulate(talking fluently)</li>
<li>literate(people who can read and write)</li>
<li>logical-mathematical</li>
<li>bodily</li>
<li>spatial/spacial/dimensional</li>
<li>interpersonal(interpersonal communication)</li>
<li>intrapersonal</li>
<li>vague/unclear</li>
<li>unscramble</li>
</ol>
<h2 id="Êñ∞ËØçÁªÑ" tabindex="-1">Êñ∞ËØçÁªÑ <a class="header-anchor" href="#Êñ∞ËØçÁªÑ" aria-label="Permalink to &quot;Êñ∞ËØçÁªÑ&quot;"></a></h2>
<ol>
<li>be adequate for</li>
<li>be sensitive to</li>
<li>be skilled at</li>
<li>be scientifically minded</li>
<li>have a capacity for</li>
<li>be efficient at</li>
<li>have a talent for</li>
<li>be particularly adept at</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Âø´ÈÄü‰∫§Âèã]]></title>
            <link>https://askaric.com/zh/work/english/03È´òÁ∫ßÂè£ËØ≠/3-1Âú∫ÊôØ_Âø´ÈÄü‰∫§Âèã.html</link>
            <guid>https://askaric.com/zh/work/english/03È´òÁ∫ßÂè£ËØ≠/3-1Âú∫ÊôØ_Âø´ÈÄü‰∫§Âèã.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[ÂÖ≥‰∫éÂÜÖÂÆπ

 ÂÖ≥‰∫éËØ≠Ê≥ï

 Êñ∞ÂçïËØç

 Êñ∞ËØçÁªÑ]]></description>
            <content:encoded><![CDATA[<h1 id="Âø´ÈÄü‰∫§Âèã" tabindex="-1">Âø´ÈÄü‰∫§Âèã <a class="header-anchor" href="#Âø´ÈÄü‰∫§Âèã" aria-label="Permalink to &quot;Âø´ÈÄü‰∫§Âèã&quot;"></a></h1>
<h2 id="ÂÖ≥‰∫éÂÜÖÂÆπ" tabindex="-1">ÂÖ≥‰∫éÂÜÖÂÆπ <a class="header-anchor" href="#ÂÖ≥‰∫éÂÜÖÂÆπ" aria-label="Permalink to &quot;ÂÖ≥‰∫éÂÜÖÂÆπ&quot;"></a></h2>
<h2 id="ÂÖ≥‰∫éËØ≠Ê≥ï" tabindex="-1">ÂÖ≥‰∫éËØ≠Ê≥ï <a class="header-anchor" href="#ÂÖ≥‰∫éËØ≠Ê≥ï" aria-label="Permalink to &quot;ÂÖ≥‰∫éËØ≠Ê≥ï&quot;"></a></h2>
<h2 id="Êñ∞ÂçïËØç" tabindex="-1">Êñ∞ÂçïËØç <a class="header-anchor" href="#Êñ∞ÂçïËØç" aria-label="Permalink to &quot;Êñ∞ÂçïËØç&quot;"></a></h2>
<h2 id="Êñ∞ËØçÁªÑ" tabindex="-1">Êñ∞ËØçÁªÑ <a class="header-anchor" href="#Êñ∞ËØçÁªÑ" aria-label="Permalink to &quot;Êñ∞ËØçÁªÑ&quot;"></a></h2>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[scernario celebrity]]></title>
            <link>https://askaric.com/zh/work/english/03È´òÁ∫ßÂè£ËØ≠/3-2Âú∫ÊôØ_Âêç‰∫∫.html</link>
            <guid>https://askaric.com/zh/work/english/03È´òÁ∫ßÂè£ËØ≠/3-2Âú∫ÊôØ_Âêç‰∫∫.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[ÂÜÖÂÆπÊÄªËßà

Ëøô‰∏™ËØùÈ¢òÊòØÂÖ≥‰∫é‚ÄúÂêç‰∫∫‚ÄùÁöÑ„ÄÇÂú®ËøôÊÆµÂØπËØù‰∏≠ÔºåÊàë‰ª¨ÂèØ‰ª•ÁúãÂà∞‰ªñÈóÆÊàëÂÖ≥Ê≥®‚ÄúËØ≠Ê≥ï‚ÄùÂíå‚Äú‰∏∫‰ªÄ‰πàÂØπÂêç‰∫∫ÊÑüÂÖ¥Ë∂£ÂæàÊ≠£Â∏∏?‚ÄùÂú®ÂÖ≥‰∫éÂêç‰∫∫ÁöÑÂπøÊí≠ÊºîËÆ≤-ËΩ®ÈÅì1.16„ÄÇ

 ÂÖ≥‰∫éËØ≠Ê≥ï

ÂØπ‰∫éËØ≠Ê≥ïÈÉ®ÂàÜÔºåÊàë‰ª¨ÂèØ]]></description>
            <content:encoded><![CDATA[<h1 id="scernario-celebrity" tabindex="-1">scernario celebrity <a class="header-anchor" href="#scernario-celebrity" aria-label="Permalink to &quot;scernario celebrity&quot;"></a></h1>
<h2 id="ÂÜÖÂÆπÊÄªËßà" tabindex="-1">ÂÜÖÂÆπÊÄªËßà <a class="header-anchor" href="#ÂÜÖÂÆπÊÄªËßà" aria-label="Permalink to &quot;ÂÜÖÂÆπÊÄªËßà&quot;"></a></h2>
<p>Ëøô‰∏™ËØùÈ¢òÊòØÂÖ≥‰∫é‚ÄúÂêç‰∫∫‚ÄùÁöÑ„ÄÇÂú®ËøôÊÆµÂØπËØù‰∏≠ÔºåÊàë‰ª¨ÂèØ‰ª•ÁúãÂà∞‰ªñÈóÆÊàëÂÖ≥Ê≥®‚ÄúËØ≠Ê≥ï‚ÄùÂíå‚Äú‰∏∫‰ªÄ‰πàÂØπÂêç‰∫∫ÊÑüÂÖ¥Ë∂£ÂæàÊ≠£Â∏∏?‚ÄùÂú®<a href="https://dogwood.xdfsjj.com/pc/audioDetail.html?id=51352&amp;pcrId=12680494&amp;resId=14718879&amp;resSign=c76b28&amp;type=14" target="_blank" rel="noreferrer">ÂÖ≥‰∫éÂêç‰∫∫ÁöÑÂπøÊí≠ÊºîËÆ≤-ËΩ®ÈÅì1.16</a>„ÄÇ</p>
<h2 id="ÂÖ≥‰∫éËØ≠Ê≥ï" tabindex="-1">ÂÖ≥‰∫éËØ≠Ê≥ï <a class="header-anchor" href="#ÂÖ≥‰∫éËØ≠Ê≥ï" aria-label="Permalink to &quot;ÂÖ≥‰∫éËØ≠Ê≥ï&quot;"></a></h2>
<p>ÂØπ‰∫éËØ≠Ê≥ïÈÉ®ÂàÜÔºåÊàë‰ª¨ÂèØ‰ª•ÁúãÂà∞‰ª•‰∏ãÂá†ÁÇπ:</p>
<ol>
<li>ÈôêÂÆöÊÄßÂÆöËØ≠‰ªéÂè• :<br>
a. Êàë‰ª¨ÂèØ‰ª•Áî®that/whichÊù•ÂÆö‰πâ„ÄÅÁ°ÆÂÆöÊàñÁªôÂá∫ÂÖ≥‰∫éÂêçËØçÁöÑÂü∫Êú¨‰ø°ÊÅØ„ÄÇ<br>
b. Ê≤°ÊúâËøô‰∏™Êù°Ê¨æÂ∞±Ê≤°ÊúâÊÑè‰πâ‰∫ÜÊàñÂè•Â≠ê‰∏çÂÆåÊï¥„ÄÇ<br>
c. ‰æãÂ¶Ç : <code>there are shows that/which pay for plastic suergery.</code></li>
<li>ÈùûÈôêÂà∂ÂÆöÂÆöËØ≠‰ªéÂè• :<br>
a. ÈùûÈôêÂÆö‰ªéÂè•Áî®‰∫éÊ∑ªÂä†ÂÖ≥‰∫éÂêçËØçÊàñÂÖ∂ÂâçÈù¢‰ªéÂè•ÁöÑÈ¢ùÂ§ñ‰ø°ÊÅØ„ÄÇ<br>
b. ÈÄöÂ∏∏‰ΩøÁî® <code>which</code>.<br>
c. ‰æãÂ¶Ç : <code>Celebrity magazines,which outnumber news magazines are everywhere.</code></li>
</ol>
<h2 id="ÂÖ≥‰∫éÂÜÖÂÆπ" tabindex="-1">ÂÖ≥‰∫éÂÜÖÂÆπ <a class="header-anchor" href="#ÂÖ≥‰∫éÂÜÖÂÆπ" aria-label="Permalink to &quot;ÂÖ≥‰∫éÂÜÖÂÆπ&quot;"></a></h2>
<p>for content part,we can see that in the below, here are three questions i should foucus on:</p>
<ol>
<li>
<p>why is it normal to be insterested in celebrities normal?<br>
a. firstly, celebrity obssession is normal, we can see celebrity magazines, which outnumber over news magazines are on every newstand. we love to read about people that celebrity's date, clothes they ware and especially their problems which the media will often invent.<br>
b. secondly, there's reality TV. Million of viewers avidly follow reality and telant shows, which makes ordinary people into instant celebrities.</p>
</li>
<li>
<p>why are we so obssessed?<br>
a. firstly, That a scentific reason for it is that which will make you feel good about your own interest in celebrity's gossip.<br>
b. secondly, Psychologists say it's normal to imitate people who are successful in our society.<br>
c. thirdly, with TV, celebrity seems could be able to come right into our home and be sort of part of our family.</p>
</li>
</ol>
<h2 id="ÊàëÁöÑÈóÆÈ¢ò" tabindex="-1">ÊàëÁöÑÈóÆÈ¢ò <a class="header-anchor" href="#ÊàëÁöÑÈóÆÈ¢ò" aria-label="Permalink to &quot;ÊàëÁöÑÈóÆÈ¢ò&quot;"></a></h2>
<ol>
<li>
<p>‰∏çÂÆπÊòìÂå∫ÂàÜÂÆö‰πâ‰ªéÂè•ÂíåÈùûÂÆö‰πâ‰ªéÂè•ÔºåÊØîÂ¶Ç:
a. in fact : <code>we love to read about people that celebrity's date, clothes they ware and especially their problems, which the media will often invent.</code><br>
b. i head : <code>we love to read about people that celebrity's date, clothes they ware and especially their problems which the media will often invent.</code><br>
c. importance of problem : it's not every important for me, now.</p>
</li>
<li>
<p>usually being lost when there appear out of a new words, like:<br>
a. i suddenly lost when the word of <code>avidly</code> came into my mind in <code>Million of viewers avidly follow reality and telant shows</code>.
b. how to overcome : i think i should notice the structure of whole sentence instead of meaning.However, it's hard without enough knlowledges about words and grammars.<br>
c. importance of problem : important, i have to overcome it ASAP.</p>
</li>
</ol>
<h2 id="Êñ∞ÂçïËØç" tabindex="-1">Êñ∞ÂçïËØç <a class="header-anchor" href="#Êñ∞ÂçïËØç" aria-label="Permalink to &quot;Êñ∞ÂçïËØç&quot;"></a></h2>
<ol>
<li><code>mimic</code></li>
<li><code>pay for</code></li>
<li><code>outnumber</code></li>
<li><code>athlete</code></li>
<li><code>reassuring</code></li>
<li><code>vary</code></li>
<li><code>bully</code></li>
</ol>
<h2 id="Êñ∞ËØçÁªÑ" tabindex="-1">Êñ∞ËØçÁªÑ <a class="header-anchor" href="#Êñ∞ËØçÁªÑ" aria-label="Permalink to &quot;Êñ∞ËØçÁªÑ&quot;"></a></h2>
<ol>
<li><code>increase in ... of ...</code></li>
<li><code>impact ... on ...</code></li>
<li><code>research on</code></li>
<li><code>effect on</code></li>
<li><code>advertisement for</code></li>
<li><code>reason for</code></li>
<li><code>rise in</code></li>
<li><code>problem with</code></li>
<li><code>link between ... and ...</code></li>
<li><code>cause of</code></li>
<li><code>concern about</code></li>
<li><code>influence on</code></li>
<li><code>relationship between ... and ...</code></li>
<li><code>pick on</code></li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[ËØÑËÆ∫]]></title>
            <link>https://askaric.com/zh/work/english/03È´òÁ∫ßÂè£ËØ≠/3-3Âú∫ÊôØ_ËØÑËÆ∫.html</link>
            <guid>https://askaric.com/zh/work/english/03È´òÁ∫ßÂè£ËØ≠/3-3Âú∫ÊôØ_ËØÑËÆ∫.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[ÂÜÖÂÆπÊÄªËßà

Ëøô‰∏™ËØùÈ¢òÊòØÂÖ≥‰∫é `you know what ...` ÁöÑË°®ËææÔºåÊàëÂ∫îËØ•Â≠¶‰π†Â¶Ç‰ΩïÊ∑ªÂä†ËØÑËÆ∫„ÄÇËøôÊòØ‰∏ÄÊÆµÂÖ≥‰∫éÂâ™ËæëÊÑèËßÅÁöÑÂØπËØùÔºåÂú®ÂÖ≥‰∫éÂêç‰∫∫ÁöÑÂπøÊí≠Âú∞ÂùÄ-ËΩ®ÈÅì1.22„ÄÇ

 About gramm]]></description>
            <content:encoded><![CDATA[<h1 id="ËØÑËÆ∫" tabindex="-1">ËØÑËÆ∫ <a class="header-anchor" href="#ËØÑËÆ∫" aria-label="Permalink to &quot;ËØÑËÆ∫&quot;"></a></h1>
<h2 id="ÂÜÖÂÆπÊÄªËßà" tabindex="-1">ÂÜÖÂÆπÊÄªËßà <a class="header-anchor" href="#ÂÜÖÂÆπÊÄªËßà" aria-label="Permalink to &quot;ÂÜÖÂÆπÊÄªËßà&quot;"></a></h2>
<p>Ëøô‰∏™ËØùÈ¢òÊòØÂÖ≥‰∫é <code>you know what ...</code> ÁöÑË°®ËææÔºåÊàëÂ∫îËØ•Â≠¶‰π†Â¶Ç‰ΩïÊ∑ªÂä†ËØÑËÆ∫„ÄÇËøôÊòØ‰∏ÄÊÆµÂÖ≥‰∫éÂâ™ËæëÊÑèËßÅÁöÑÂØπËØùÔºåÂú®<a href="https://dogwood.xdfsjj.com/pc/audioDetail.html?id=51352&amp;pcrId=12680494&amp;resId=14718879&amp;resSign=c76b28&amp;type=14" target="_blank" rel="noreferrer">ÂÖ≥‰∫éÂêç‰∫∫ÁöÑÂπøÊí≠Âú∞ÂùÄ-ËΩ®ÈÅì1.22</a>„ÄÇ</p>
<h2 id="about-grammar" tabindex="-1">About grammar <a class="header-anchor" href="#about-grammar" aria-label="Permalink to &quot;About grammar&quot;"></a></h2>
<ol>
<li>
<p>ÊúâÊó∂ÂÄôÔºå<code>you know what‚Ä¶</code> Áî®Êù•ËØÑËÆ∫‰Ω†/ÊàëÁöÑËßÇÁÇπ„ÄÇ<br>
a. question : you know what i like?</p>
</li>
<li>
<p>Âè¶‰∏ÄÊñπÈù¢ÔºåÂÆÉ‰πüÂèØ‰ª•Ë¢´ËßÜ‰∏∫‰∏Ä‰∏™ËøûÊé•ÁªìÊûÑÔºå‰æãÂ¶Ç <code>statement-X,you know what‚Ä¶Ôºü statement-Y</code> Âè™ÊòØÁî®ÂÆÉÊù•ËøûÊé• <code>statement-X</code> Âíå <code>statement-Y</code>Ôºå‰∏ãÈù¢ÊòØ‰∏Ä‰∏™ÁúüÂÆûÁöÑ‰æãÂ≠ê„ÄÇ<br>
a. People do really dangrous things and video it - like rifing bikes off walls.<br>
b. Which is stupid, I know.<br>
c. You know what gets me, too. Some of the home videos people post. They're so boring.</p>
</li>
</ol>
<h2 id="ÂÖ≥‰∫éÂÜÖÂÆπ" tabindex="-1">ÂÖ≥‰∫éÂÜÖÂÆπ <a class="header-anchor" href="#ÂÖ≥‰∫éÂÜÖÂÆπ" aria-label="Permalink to &quot;ÂÖ≥‰∫éÂÜÖÂÆπ&quot;"></a></h2>
<ol>
<li>‰ªñÂíåÂ•π‰πãÈó¥Êúâ‰ªÄ‰πàÊÑèËßÅ?
a. background : she emailed him a clip and ask how would he feel.<br>
b. his opinion : he don't usually tend to watch clips which were sent by people. And he thinks mostly which are boring, dangerous like riding bake off the wall, and couldn't get the points.<br>
c. her opinion : she know his comments and are suppresing in the hits of that clips are so much, like millions.</li>
</ol>
<h2 id="ÊàëÁöÑÈóÆÈ¢ò" tabindex="-1">ÊàëÁöÑÈóÆÈ¢ò <a class="header-anchor" href="#ÊàëÁöÑÈóÆÈ¢ò" aria-label="Permalink to &quot;ÊàëÁöÑÈóÆÈ¢ò&quot;"></a></h2>
<ol>
<li>Âõ†‰∏∫ÁªÑÂêàÂèëÈü≥ÔºåÊàëÊÑüÂà∞ÊúâÁÇπÂõ∞ÊÉëÔºå‰ΩÜÂπ∂Ê≤°ÊúâËø∑Â§±„ÄÇ<br>
a. in fact : Did you see that clip I emaild you?
b. I heard : Did you see that clip <code>by email</code> you?<br>
c. because of the new word and combinding pronunciation, I don't know what asking for is the whole question.
d. importance of problem : important, becasue that without enough context would let me confused or even lost the main idea.<br>
e. how to overcome : foucusing on every accurate pronunication.</li>
</ol>
<h2 id="Êñ∞ÂçïËØç" tabindex="-1">Êñ∞ÂçïËØç <a class="header-anchor" href="#Êñ∞ÂçïËØç" aria-label="Permalink to &quot;Êñ∞ÂçïËØç&quot;"></a></h2>
<ol>
<li>hilarious</li>
<li>clip</li>
<li>conduct</li>
</ol>
<h2 id="Êñ∞Âè•Â≠ê" tabindex="-1">Êñ∞Âè•Â≠ê <a class="header-anchor" href="#Êñ∞Âè•Â≠ê" aria-label="Permalink to &quot;Êñ∞Âè•Â≠ê&quot;"></a></h2>
<ol>
<li>you know what gets me?</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Â∞ÜÊïÖ‰∫ã]]></title>
            <link>https://askaric.com/zh/work/english/03È´òÁ∫ßÂè£ËØ≠/3-4Âú∫ÊôØ_ÊïÖ‰∫ã.html</link>
            <guid>https://askaric.com/zh/work/english/03È´òÁ∫ßÂè£ËØ≠/3-4Âú∫ÊôØ_ÊïÖ‰∫ã.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[ÂÖ≥‰∫éÂÜÖÂÆπ

1. Ë∞àËÆ∫‰∫∫ÁîüÁöÑÊïôËÆ≠ÂíåÁªèÂéÜ
2. ‰ΩøÁî®ËøáÂéªÊó∂ÔºåÁé∞Âú®ÂÆåÊàêÊó∂ÂíåËøáÂéªÂÆåÊàêÊó∂„ÄÇ
3. ËÆ≤ÊïÖ‰∫ãÊó∂Ë¶ÅÂä†ËØÑËÆ∫„ÄÇ
4. Áî® (It's) no wonder ...  ËØ¥Êüê‰∫ãÂπ∂‰∏çÂ•áÊÄ™„ÄÇ

 ]]></description>
            <content:encoded><![CDATA[<h1 id="Â∞ÜÊïÖ‰∫ã" tabindex="-1">Â∞ÜÊïÖ‰∫ã <a class="header-anchor" href="#Â∞ÜÊïÖ‰∫ã" aria-label="Permalink to &quot;Â∞ÜÊïÖ‰∫ã&quot;"></a></h1>
<h2 id="ÂÖ≥‰∫éÂÜÖÂÆπ" tabindex="-1">ÂÖ≥‰∫éÂÜÖÂÆπ <a class="header-anchor" href="#ÂÖ≥‰∫éÂÜÖÂÆπ" aria-label="Permalink to &quot;ÂÖ≥‰∫éÂÜÖÂÆπ&quot;"></a></h2>
<ol>
<li>Ë∞àËÆ∫‰∫∫ÁîüÁöÑÊïôËÆ≠ÂíåÁªèÂéÜ</li>
<li>‰ΩøÁî®ËøáÂéªÊó∂ÔºåÁé∞Âú®ÂÆåÊàêÊó∂ÂíåËøáÂéªÂÆåÊàêÊó∂„ÄÇ</li>
<li>ËÆ≤ÊïÖ‰∫ãÊó∂Ë¶ÅÂä†ËØÑËÆ∫„ÄÇ</li>
<li>Áî® (It's) no wonder ...  ËØ¥Êüê‰∫ãÂπ∂‰∏çÂ•áÊÄ™„ÄÇ</li>
</ol>
<h2 id="ÂÖ≥‰∫éËØ≠Ê≥ï" tabindex="-1">ÂÖ≥‰∫éËØ≠Ê≥ï <a class="header-anchor" href="#ÂÖ≥‰∫éËØ≠Ê≥ï" aria-label="Permalink to &quot;ÂÖ≥‰∫éËØ≠Ê≥ï&quot;"></a></h2>
<ol>
<li>
<p>Áé∞Âú®ÂÆåÊàêÊó∂ÂíåÁé∞Âú®ÂÆåÊàêËøõË°åÊó∂ÁöÑÂå∫Âà´ÊòØ‰ªÄ‰πà?<br>
a. present prefect : until now, I might turn to the other thing or keep on doing the same thing.<br>
b. present perfect continous : until now, I might continously keep on the same thing.</p>
</li>
<li>
<p>ÂØπ‰∫éËøáÂéªÂ∑≤ÁªèÂÆåÊàêÁöÑÔºå‰∏éÁé∞Âú®Êó†ÂÖ≥ÁöÑÊÉÖÂÜµÂíå‰∫ã‰ª∂Ôºå‰ΩøÁî®ËøáÂéªÊó∂ÊÄÅ„ÄÇ<br>
a. I lived in Italy a few years ago.(I'm not there now).</p>
</li>
<li>
<p>Áî®ËøáÂéªÁé∞Âú®ÂÆåÊàêÊó∂ÂΩ¢ÂÆπËøáÂéªÁöÑÊÉÖÂÜµÂíå‰∫ã‰ª∂ÔºåËøô‰∫õÊÉÖÂÜµÂíå‰∫ã‰ª∂‰∏ÄÁõ¥ÊåÅÁª≠Âà∞Áé∞Âú®„ÄÇ<br>
a. Life has been interesting so far. (It still is)</p>
</li>
<li>
<p>‰ΩøÁî®ÁÆÄÂçïÂä®ËØçÊù•ÊèèËø∞Â∑≤ÂÆåÊàêÁöÑ‰∫ã‰ª∂ÊàñÊ∞∏‰πÖÁöÑÊÉÖÂÜµ„ÄÇ<br>
a. Marco's band broke up.</p>
</li>
<li>
<p>‰ΩøÁî®ËøõË°åÊó∂Âä®ËØçË°®Á§∫ËÉåÊôØÁöÑ„ÄÅÊ≠£Âú®ËøõË°åÁöÑÊàñÊöÇÊó∂ÁöÑ‰∫ã‰ª∂ÊàñÊÉÖÂÜµ„ÄÇ<br>
a. He's been coaching a soccer team.</p>
</li>
</ol>
<h2 id="Êñ∞ÂçïËØç" tabindex="-1">Êñ∞ÂçïËØç <a class="header-anchor" href="#Êñ∞ÂçïËØç" aria-label="Permalink to &quot;Êñ∞ÂçïËØç&quot;"></a></h2>
<ol>
<li>miserable</li>
<li>penalty</li>
<li>hall</li>
<li>ethics</li>
<li>deterrent</li>
<li>anecdote</li>
<li>gymnastics</li>
<li>pervasive</li>
<li>evolve</li>
<li>spot</li>
<li>determine</li>
<li>convention</li>
<li>bartenders</li>
<li>sibling</li>
<li>literal</li>
<li>rigidly</li>
<li>infer</li>
<li>anonymous</li>
<li>analogous</li>
<li>jargon</li>
<li>abbreviation</li>
<li>facilitate</li>
<li>amortize</li>
</ol>
<h2 id="Êñ∞ËØçÁªÑ" tabindex="-1">Êñ∞ËØçÁªÑ <a class="header-anchor" href="#Êñ∞ËØçÁªÑ" aria-label="Permalink to &quot;Êñ∞ËØçÁªÑ&quot;"></a></h2>
<ol>
<li>woke/waked up(woke's more common in use)</li>
<li>life's ups and downs</li>
<li>cheer you up/make you happy</li>
<li>break up(end up)</li>
<li>count toward our final grade</li>
<li>struggling with the class</li>
<li>fall behind on my work</li>
<li>caught up on</li>
<li>turn in(hand on)</li>
<li>left the question blank</li>
<li>raised his hand</li>
<li>affect my grade</li>
<li>complete that questions</li>
<li>count towards</li>
<li>turn to(going to)</li>
<li>turn into (water turns into tea and is changed totally)</li>
<li>be convicted of (get sentenced to)</li>
<li>right before ... + clause with simple past</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[scernario working lives]]></title>
            <link>https://askaric.com/zh/work/english/03È´òÁ∫ßÂè£ËØ≠/3-5Âú∫ÊôØ_Â∑•‰ΩúÂØøÂëΩ.html</link>
            <guid>https://askaric.com/zh/work/english/03È´òÁ∫ßÂè£ËØ≠/3-5Âú∫ÊôØ_Â∑•‰ΩúÂØøÂëΩ.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[ÂÖ≥‰∫éÂÜÖÂÆπ

1. Ë∞àËÆ∫Â∑•‰ΩúÂíåÊâæÂ∑•‰Ωú
2. ‰ΩøÁî®ÂèØÊï∞ÂêçËØçÂíå‰∏çÂèØËß£ÈáäÂêçËØç
3. ‰ΩøÁî®ÂÜ†ËØçËøõË°åÊ¶ÇÊã¨ÂíåÊåáÂÆö
4. Áî® ly ÂâØËØçÊù•Ë°®Ëææ‰Ω†ÁöÑÊÄÅÂ∫¶
5. ‰∫ãÂÆû‰∏äÔºå‰∫ãÂÆû‰∏äÊèê‰æõÊàñÁ∫†Ê≠£‰ø°ÊÅØ

 ÂÖ≥‰∫éËØ≠Ê≥ï]]></description>
            <content:encoded><![CDATA[<h1 id="scernario-working-lives" tabindex="-1">scernario working lives <a class="header-anchor" href="#scernario-working-lives" aria-label="Permalink to &quot;scernario working lives&quot;"></a></h1>
<h2 id="ÂÖ≥‰∫éÂÜÖÂÆπ" tabindex="-1">ÂÖ≥‰∫éÂÜÖÂÆπ <a class="header-anchor" href="#ÂÖ≥‰∫éÂÜÖÂÆπ" aria-label="Permalink to &quot;ÂÖ≥‰∫éÂÜÖÂÆπ&quot;"></a></h2>
<ol>
<li>Ë∞àËÆ∫Â∑•‰ΩúÂíåÊâæÂ∑•‰Ωú</li>
<li>‰ΩøÁî®ÂèØÊï∞ÂêçËØçÂíå‰∏çÂèØËß£ÈáäÂêçËØç</li>
<li>‰ΩøÁî®ÂÜ†ËØçËøõË°åÊ¶ÇÊã¨ÂíåÊåáÂÆö</li>
<li>Áî® ly ÂâØËØçÊù•Ë°®Ëææ‰Ω†ÁöÑÊÄÅÂ∫¶</li>
<li>‰∫ãÂÆû‰∏äÔºå‰∫ãÂÆû‰∏äÊèê‰æõÊàñÁ∫†Ê≠£‰ø°ÊÅØ</li>
</ol>
<h2 id="ÂÖ≥‰∫éËØ≠Ê≥ï" tabindex="-1">ÂÖ≥‰∫éËØ≠Ê≥ï <a class="header-anchor" href="#ÂÖ≥‰∫éËØ≠Ê≥ï" aria-label="Permalink to &quot;ÂÖ≥‰∫éËØ≠Ê≥ï&quot;"></a></h2>
<ol>
<li>
<p>ÂèØÊï∞ÂêçËØçÂèØ‰ª•Áî®‚Äúa/an‚Äù‰Ωú‰∏∫ÂçïÊï∞ÂΩ¢Âºè„ÄÇ<br>
a. Give an example of how you achieved a goal.</p>
</li>
<li>
<p>ÂçïÊï∞ÂèØÊï∞ÂêçËØçÊé•ÂçïÊï∞Âä®ËØçÔºåÂ§çÊï∞ÂèØÊï∞ÂêçËØçÊé•Â§çÊï∞Âä®ËØç„ÄÇ<br>
a. An impressive resume is important.<br>
b. Candidates face stiff competition.</p>
</li>
<li>
<p>‰∏çÂèØÊï∞ÂêçËØçÂè™ÊúâÂçïÊï∞ÂΩ¢Âºè„ÄÇ<br>
a. Explain how your work can save money.</p>
</li>
<li>
<p>‰∏çÂèØÊï∞ÂêçËØçÂä®ËØçÈááÁî®ÂçïÊï∞ÂΩ¢Âºè„ÄÇ<br>
a. Feedback from a counselor is invaluable.<br>
b. Research shows what employers look for.</p>
</li>
<li>
<p>ÂΩì‰Ω†ÊåáÁöÑ‰∏çÊòØÁâπÂÆöÁöÑ‰∫∫Êàñ‰∫ãÊó∂ÔºåÂèØ‰ª•Áî® <code>a/an</code> ‰∏éÂçïÊï∞ÂèØÊï∞ÂêçËØçËøûÁî®Êù•Ê≥õÂåñ„ÄÇ<br>
a. I want to work for a company that has a salon.</p>
</li>
<li>
<p>‰∏çË¶ÅÁî® the Êù•Ê¶ÇÊã¨Â§çÊï∞ÂèØÊï∞ÂêçËØçÊàñ‰∏çÂèØÊï∞ÂêçËØç„ÄÇ<br>
a. Classes after work are a great idea.</p>
</li>
<li>
<p>ÂΩìËØªËÄÖÊàñÂê¨‰ºóÁü•ÈÅìËøô‰∏™ÊÉ≥Ê≥ïÔºåÊàñËÄÖÂΩì‰Ω†ÊåáÁöÑÊòØÂì™‰∏™‰∫∫Êàñ‰∫ãÂæàÊ∏ÖÊ•öÁöÑÊó∂ÂÄôÔºå‰ΩøÁî® ‚Äúthe‚Äù„ÄÇ<br>
a. I'd like to take the kids to the office.</p>
</li>
<li>
<p>ÂΩì‰Ω†ÊòéÁ°ÆË°®Ëææ‰Ω†ÁöÑÊÑèÊÄùÊó∂ÔºåÁî® the„ÄÇ<br>
a. The classes that I take are very expensive.</p>
</li>
<li>
<p>‰∏çÂèØÊï∞ÂêçËØçÈÄöÂ∏∏ÊòØ‰∏ÄÁßçÁâ©Ë¥®Êàñ‰∏ÄÁªÑ‰∫ãÁâ©ÁöÑÂêçÁß∞„ÄÇ‰Ω†ÂèØ‰ª•Áî® <code>a piece of</code> Êåá‰ª£Ëøô‰∫õ‰∏çÂèØÊï∞ÂêçËØçÁöÑ‰∏Ä‰∏™‰æãÂ≠êÊàñ‰∏ÄÈÉ®ÂàÜ:<br>
a. a piece of jewelry/funiture/music/equipment/information/software/advice/evidence</p>
</li>
<li>
<p>ÂØπ‰∫é‰∏Ä‰∫õ‰∏çÂèØÊï∞ÂêçËØçÔºå‰Ω†ÈúÄË¶Å‰ΩøÁî®‰∏çÂêåÁöÑÂèØÊï∞ÂêçËØçÊù•Êåá‰ª£‰∏Ä‰∏™‰æãÂ≠êÊàñ‰∏Ä‰∏™ÈÉ®ÂàÜ:<br>
a. travel - trips<br>
b. cash - coin or bill<br>
c. feedback - comment<br>
d. luggage - bag<br>
e. work - job or position</p>
</li>
<li>
<p>ÂåÖÊã¨Êñ∞ÈóªÂú®ÂÜÖÁöÑÂ≠¶ÊúØÁßëÁõÆÂíå‰ΩìËÇ≤ÈÄöÂ∏∏ÊòØÂçïÊï∞:<br>
a. economics, genetics, mathematics physics, politics, aerobics, gymnastics</p>
</li>
<li>
<p>Êúâ‰∫õÂêçËØçÊó¢ÊòØÂèØÊï∞ÂêçËØçÂèàÊòØ‰∏çÂèØÊï∞ÂêçËØçÔºå‰ΩÜÊòØÂÆÉ‰ª¨ÁöÑÊÑèÊÄù‰∏çÂêå, ÊØîÂ¶Ç:<br>
a. bussiness, competition, experience, paper, time, work</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    1.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> chinese</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> business</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> seems</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> has</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> taken</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> off.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    2.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> new</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> business</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> thrives</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> this</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> area.</span></span></code></pre>
</div><p>b. competition</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    1.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> competitions</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> job</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> acute.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    2.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> competition</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> job</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> acute</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> marketplace</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> now.</span></span></code></pre>
</div><p>c. experience</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    1.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> managing</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> experence</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> such</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> important.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    2.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> we</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> all</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> learn</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> by</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> experence.</span></span></code></pre>
</div><p>d. paper</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    1.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> there</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> any</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> news</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> today's papers?  </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    2. can you give me a piece of paper?</span></span></code></pre>
</div><p>e. time</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    1.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> you've paid it 2 times.  </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    2. do you have any time?</span></span></code></pre>
</div><p>f. work</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    1.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> heard</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> you</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> are</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> looking</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> work.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    2.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> i've lots of works about database.</span></span></code></pre>
</div></li>
<li>
<p>Âú®Ëøô‰∫õÂ∏∏ËßÅÁöÑÂú∞ÁÇπÂêéÈù¢‰ΩøÁî®theÔºåÂ∞§ÂÖ∂ÊòØÂú®‰ªãËØçatÂíåtoÂêéÈù¢:the office, the factory, the store, the mall, the gym, the library, the park, the pool, the post office, the bank„ÄÇ<br>
a. I'd like to have exercise quipment at the office. I never have time to go to the gym.<br>
b. Some companies install ATMs so that employees don't have to go to the bank.</p>
</li>
<li>
<p>‰∏çË¶ÅÂú®Ëøô‰∫õÂ∏∏ËßÅÁöÑ‰ΩçÁΩÆÂêéÈù¢‰ΩøÁî®theÔºåÂ∞§ÂÖ∂ÊòØÂú®‰ªãËØçat, to, in, beforeÂíåafterÂêéÈù¢:home, bed, work, school, college, class, prison, jail„ÄÇ<br>
a. I arrive at work early so that I can leave early to pick up my children after school.<br>
b. Some companies offer special training programs for people who have been in prison.<br>
c. Many employees work during the day and go to college at night.</p>
</li>
<li>
<p>È•≠Ââç‰∏çË¶ÅÁî®„ÄÇÂΩì‰Ω†ÊèèËø∞‰∏ÄÈ°øÁâπÂÆöÁöÑÈ•≠Êó∂Ôºå‰Ω†ÂèØ‰ª•Áî®ÂÜ†ËØç„ÄÇ<br>
a. I had breakfeast late, so I didn't eat much for lunch.<br>
b. The lunch we had at that new cafe wan't very good. It was an expensive lunch, too.</p>
</li>
</ol>
<h2 id="ÊàëÁöÑÈóÆÈ¢ò" tabindex="-1">ÊàëÁöÑÈóÆÈ¢ò <a class="header-anchor" href="#ÊàëÁöÑÈóÆÈ¢ò" aria-label="Permalink to &quot;ÊàëÁöÑÈóÆÈ¢ò&quot;"></a></h2>
<ol>
<li>Pronunciation : Something aren't very accurate.<br>
a. how<br>
b. explain<br>
c. path<br>
d. as well as --&gt; <code>as well las</code><br>
e. poll<br>
f. desirable</li>
<li>Rarelly use adverb when I'm talking.<br>
a. fortunatlly, luckily, stangely, obviously, suprisinglyÔºå seriously</li>
</ol>
<h2 id="Êñ∞ÂçïËØç" tabindex="-1">Êñ∞ÂçïËØç <a class="header-anchor" href="#Êñ∞ÂçïËØç" aria-label="Permalink to &quot;Êñ∞ÂçïËØç&quot;"></a></h2>
<ol>
<li>stiff</li>
<li>plural</li>
<li>perk</li>
<li>poll</li>
<li>subsidize(sponsor)</li>
<li>rate --&gt; how do you rate them?</li>
<li>nap</li>
<li>reimburse</li>
<li>tuition</li>
<li>demanding</li>
<li>genre</li>
<li>aerobics</li>
<li>therMometer</li>
<li>cold medicine</li>
<li>rewarding</li>
<li>tempt / atract</li>
<li>fabulous</li>
</ol>
<h2 id="Êñ∞ËØçÁªÑ" tabindex="-1">Êñ∞ËØçÁªÑ <a class="header-anchor" href="#Êñ∞ËØçÁªÑ" aria-label="Permalink to &quot;Êñ∞ËØçÁªÑ&quot;"></a></h2>
<ol>
<li>achieve a goal</li>
<li>acquire skill or knowledge</li>
<li>face stiff in school or at work</li>
<li>follow someone's suggestion, advice, instruction</li>
<li>make a progress/ improvement with a project</li>
<li>meet a deadline</li>
<li>save or make money</li>
<li>show interests in a job</li>
<li>submit a job application</li>
<li>a piece of jewelry/funiture/music/equipment/information/software/advice/evidence</li>
<li>travel(uncountable) - trip(countable)</li>
<li>cash - coin or bill</li>
<li>feedback - comment</li>
<li>luggage - bag</li>
<li>work - job or position</li>
<li>stand out from the crowd</li>
<li>as a matter of fact</li>
<li>in fact</li>
<li>i have a fever</li>
<li>i have a headache</li>
<li>i have a sore throat</li>
<li>i have a runny nose</li>
<li>i have to blow my nose</li>
<li>i feel sore all over</li>
<li>i feel chilly as well</li>
<li>i have a really bad cough</li>
<li>i sneeze all the time</li>
<li>4 pills / tablets after a meal</li>
<li>i'm testd / i got tested postitive</li>
<li>i feel dizzy</li>
<li>have second thoughts about it</li>
<li>being stuck in a lab all day</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[scernario challenge]]></title>
            <link>https://askaric.com/zh/work/english/03È´òÁ∫ßÂè£ËØ≠/3-6Âú∫ÊôØ_ÊåëÊàò.html</link>
            <guid>https://askaric.com/zh/work/english/03È´òÁ∫ßÂè£ËØ≠/3-6Âú∫ÊôØ_ÊåëÊàò.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[ÂÖ≥‰∫éËØ≠Ê≥ï

1. the + adj == ÊúâÂΩ¢ÂÆπËØçÁâπÂæÅÁöÑ‰∫∫
2. you can use `if` clasues to talk about hypothetical events in t]]></description>
            <content:encoded><![CDATA[<h1 id="scernario-challenge" tabindex="-1">scernario challenge <a class="header-anchor" href="#scernario-challenge" aria-label="Permalink to &quot;scernario challenge&quot;"></a></h1>
<h2 id="ÂÖ≥‰∫éËØ≠Ê≥ï" tabindex="-1">ÂÖ≥‰∫éËØ≠Ê≥ï <a class="header-anchor" href="#ÂÖ≥‰∫éËØ≠Ê≥ï" aria-label="Permalink to &quot;ÂÖ≥‰∫éËØ≠Ê≥ï&quot;"></a></h2>
<ol>
<li>the + adj == ÊúâÂΩ¢ÂÆπËØçÁâπÂæÅÁöÑ‰∫∫</li>
<li>you can use <code>if</code> clasues to talk about hypothetical events in the present or past.<br>
a. Present : <code>if + past form; modal + verb</code><br>
b. e.g. : What would you do if you saw a homeless person on the street?<br>
c. Past : <code>if + past perfect form</code><br>
d. e.g. : if you'd been in the car with Jan, what would you have done?<br>
e. Mixed present and past<br>
f. e.g. : If they still lived in their big house, would they have raised any money? Maybe. But they might not be so close now if they had stayed there.</li>
<li>wish and hope<br>
a. Use wish + past form to imagine a different situation in the present.<br>
b. e.g. Aya wishes we could eradicate poverty. She wishes the gap between rich and poor was smaller.<br>
c. Use wish + would + verb for things you want other people to do or for things you can't control.<br>
d. e.g. Pin wishes someone would solve the hunger problem.<br>
e. Use wish + past perfect to imagine the past.<br>
f. e.g. Luis wishes everywhere hadn't gotten so polluted.<br>
g. Use hope to talk about things that you want to be ture about the future, present, or past.<br>
h. e.g. Tom hopes they will create more new jobs. or, I hope that makes sense/ I didn't say anything silly.</li>
<li>what if ‰ªéÂè•ÊòØËøô‰∫õË°®Ëææ‰∏≠ÊúÄÂ∏∏ËßÅÁöÑÔºå‰∏ªË¶ÅÁî®‰∫éÂêéÁª≠ÈóÆÈ¢ò‰∏≠„ÄÇËøôÈÄöÂ∏∏‰∏ç‰ºöÂºïÂèë‰ªÄ‰πàÂØπËØù„ÄÇ<br>
a. e.g. : what if I adopted a polar bear for him?</li>
<li>‰Ω†ÂèØ‰ª•Áî® <code>I suppose</code> Êù•Ë°®Á§∫Âè¶‰∏Ä‰∏™‰∫∫ÁöÑÊÉ≥Ê≥ïÊòØÂØπÁöÑÔºåÂ∞±ÂÉè <code>I suppose You it is</code> ÊÑèÊÄùÊòØ‰Ω†ËØ¥ÁöÑÂèØËÉΩÊòØÂØπÁöÑ</li>
</ol>
<h2 id="ÊàëÁöÑÈóÆÈ¢ò" tabindex="-1">ÊàëÁöÑÈóÆÈ¢ò <a class="header-anchor" href="#ÊàëÁöÑÈóÆÈ¢ò" aria-label="Permalink to &quot;ÊàëÁöÑÈóÆÈ¢ò&quot;"></a></h2>
<ol>
<li>ÂΩìÊàëËØª‰∏Ä‰∫õÂè•Â≠êÁöÑÊó∂ÂÄôÔºåÊàëÁ™ÅÁÑ∂ÂèëÁé∞Êàë‰∏çÁü•ÈÅìÂÆÉÊòØ‰ªÄ‰πàÊÑèÊÄù„ÄÇ<br>
a. analyze result : Grammar is only being used when I'm expressing something after thinking in my brain.<br>
b. analyze result : However, when I'm reading, grammar isn't a main part of what I'd check.<br>
c. analyze result : I'm not familliar with common phrases and combinding expressions in use, like <code>a lot less cash</code>.</li>
<li>ÊàëÁöÑÂáÜÁ°ÆÊÄß‰∏çÂ•Ω<br>
a. like <code>fashion --&gt; fashionable --&gt; fashionably --&gt; fashionmonger</code><br>
b. solution : in new words of every note, I'm just gonna write synonyms and different word classes.</li>
<li>‰∏çÁÜüÊÇâÂçïËØçÁªÑÊàñÂçïËØçÊóè<br>
a. analyze result : I'll append a new sector named necessary sentences which means I have to recite all of them, so that I can speak smoothly or fluently.</li>
</ol>
<h2 id="Êñ∞ÂçïËØç" tabindex="-1">Êñ∞ÂçïËØç <a class="header-anchor" href="#Êñ∞ÂçïËØç" aria-label="Permalink to &quot;Êñ∞ÂçïËØç&quot;"></a></h2>
<ol>
<li>eradicate --&gt; eradication</li>
<li>poverty --&gt; poor</li>
<li>wealth --&gt; wealthy</li>
<li>nephew</li>
<li>polar --&gt; polarity --&gt; polarize --&gt; polarization</li>
</ol>
<h2 id="Êñ∞ËØçÁªÑ" tabindex="-1">Êñ∞ËØçÁªÑ <a class="header-anchor" href="#Êñ∞ËØçÁªÑ" aria-label="Permalink to &quot;Êñ∞ËØçÁªÑ&quot;"></a></h2>
<ol>
<li>the economy the way it is</li>
<li>I suppose there's no point in doing somthing</li>
<li>last-minute panic</li>
<li>time from now --&gt; 20 years from now</li>
<li>vending machine</li>
</ol>
<h2 id="ÂøÖÂ§áÂè•Â≠ê" tabindex="-1">ÂøÖÂ§áÂè•Â≠ê <a class="header-anchor" href="#ÂøÖÂ§áÂè•Â≠ê" aria-label="Permalink to &quot;ÂøÖÂ§áÂè•Â≠ê&quot;"></a></h2>
<ol>
<li>there's not point in somthing</li>
<li>I suppose</li>
<li>someone's gonna be doing</li>
<li>someone won't be doing somthing/won't do somthing</li>
<li>someone'll probably be doing something</li>
<li>I just don't have any change</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Âú®Êú™Êù•]]></title>
            <link>https://askaric.com/zh/work/english/03È´òÁ∫ßÂè£ËØ≠/3-7Âú∫ÊôØ_Âú®Êú™Êù•.html</link>
            <guid>https://askaric.com/zh/work/english/03È´òÁ∫ßÂè£ËØ≠/3-7Âú∫ÊôØ_Âú®Êú™Êù•.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[ÂÖ≥‰∫éËØ≠Ê≥ï

1. Âú®be going to„ÄÅwill„ÄÅmayÂíåmightÂêéÈù¢‰ΩøÁî®ËøõË°åÂºèÔºåË°®Á§∫‰Ω†È¢ÑËÆ°Âú®Êú™Êù•Êüê‰∏™Êó∂Èó¥‰ºöÂèëÁîüÁöÑ‰∫ã‰ª∂„ÄÇ  
    a. you can use `be gonna` w]]></description>
            <content:encoded><![CDATA[<h1 id="Âú®Êú™Êù•" tabindex="-1">Âú®Êú™Êù• <a class="header-anchor" href="#Âú®Êú™Êù•" aria-label="Permalink to &quot;Âú®Êú™Êù•&quot;"></a></h1>
<h2 id="ÂÖ≥‰∫éËØ≠Ê≥ï" tabindex="-1">ÂÖ≥‰∫éËØ≠Ê≥ï <a class="header-anchor" href="#ÂÖ≥‰∫éËØ≠Ê≥ï" aria-label="Permalink to &quot;ÂÖ≥‰∫éËØ≠Ê≥ï&quot;"></a></h2>
<ol>
<li>Âú®be going to„ÄÅwill„ÄÅmayÂíåmightÂêéÈù¢‰ΩøÁî®ËøõË°åÂºèÔºåË°®Á§∫‰Ω†È¢ÑËÆ°Âú®Êú™Êù•Êüê‰∏™Êó∂Èó¥‰ºöÂèëÁîüÁöÑ‰∫ã‰ª∂„ÄÇ<br>
a. you can use <code>be gonna</code> when there's evidence noe for a future event.<br>
b. e.g. : Everyone's going to use cards more in the future.<br>
c. you can use will, may, or might in predictions <code>will</code> is more certain than may or might.<br>
d. e.g. : Every cell phone will(probably) have a chip.<br>
e. use the present form in <code>if</code> or time clauses that refer to the future.<br>
f. e.g. : if we use cards, what are kids going to do?</li>
</ol>
<h2 id="ÊàëÁöÑÈóÆÈ¢ò" tabindex="-1">ÊàëÁöÑÈóÆÈ¢ò <a class="header-anchor" href="#ÊàëÁöÑÈóÆÈ¢ò" aria-label="Permalink to &quot;ÊàëÁöÑÈóÆÈ¢ò&quot;"></a></h2>
<ol>
<li>
<p>ÂΩìÊàëËØª‰∏Ä‰∫õÂè•Â≠êÁöÑÊó∂ÂÄôÔºåÊàëÁ™ÅÁÑ∂ÂèëÁé∞Êàë‰∏çÁü•ÈÅìÂÆÉÊòØ‰ªÄ‰πàÊÑèÊÄù„ÄÇ<br>
a. analyze result : Grammar is only being used when I'm expressing something in my brain.<br>
b. analyze result : However, when I'm reading, grammar isn't a main part of what I'd check.<br>
c. analyze result : I'm not familliar with common phrases and combinding expressions in use, like <code>a lot less cash</code>.</p>
</li>
<li>
<p>ÊÉÖÊÄÅÂä®ËØçÂèØ‰ª•Ë°®Ëææ‰∏ÄÁ≥ªÂàóÁöÑÊÑèÊÄù„ÄÇ</p>
<table tabindex="0">
<thead>
<tr>
<th>Scenario</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td>Expectations</td>
<td>There should /ought to be a handout going around</td>
</tr>
<tr>
<td>Guesses</td>
<td>The projector must be warming up. It might /could / may be broken</td>
</tr>
<tr>
<td>Necessity</td>
<td>I should /ought to/have to /need to /'d better stop.('d = had')</td>
</tr>
<tr>
<td>Suggestions/advice</td>
<td>You might want to check out the articles on the handout</td>
</tr>
<tr>
<td>Ability</td>
<td>Can you see all the screen</td>
</tr>
<tr>
<td>Failure(tp operate)</td>
<td>The projector won't connect to my laptop</td>
</tr>
<tr>
<td>Requests</td>
<td>Could/ Would/ Can someboday turn the lights off, please?</td>
</tr>
<tr>
<td>Offers</td>
<td>I'll make the screen bigger. I can/ could turn it up</td>
</tr>
<tr>
<td>Permission</td>
<td>May/ Could/ Can I ask a question? Yes, you may(more formal)/ can</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>ÊüîÂíåË°®Ëææ‰Ω†ÁöÑÊÉ≥Ê≥ï<br>
a. would/'d + do<br>
b. I would say</p>
</li>
</ol>
<h2 id="Êñ∞ÂçïËØç" tabindex="-1">Êñ∞ÂçïËØç <a class="header-anchor" href="#Êñ∞ÂçïËØç" aria-label="Permalink to &quot;Êñ∞ÂçïËØç&quot;"></a></h2>
<ol>
<li>fraud --&gt; fraudulent --&gt; fraudulence</li>
<li>scam --&gt; scammer</li>
<li>theft --&gt; robbery(synonym)</li>
<li>chip --&gt; chipper --&gt; chiping</li>
<li>projecter</li>
</ol>
<h2 id="Êñ∞ËØçÁªÑ" tabindex="-1">Êñ∞ËØçÁªÑ <a class="header-anchor" href="#Êñ∞ËØçÁªÑ" aria-label="Permalink to &quot;Êñ∞ËØçÁªÑ&quot;"></a></h2>
<ol>
<li>the economy the way it is</li>
</ol>
<h2 id="ÂøÖÂ§áÂè•Â≠ê" tabindex="-1">ÂøÖÂ§áÂè•Â≠ê <a class="header-anchor" href="#ÂøÖÂ§áÂè•Â≠ê" aria-label="Permalink to &quot;ÂøÖÂ§áÂè•Â≠ê&quot;"></a></h2>
<ol>
<li>Can you all see the screen?</li>
<li>there should be a handout going around.</li>
<li>let's get started</li>
<li>I wanna look at</li>
<li>I'll be talking about</li>
<li>I'll allow time for questitons and commetns at the end</li>
<li>I'd like to begin by doing</li>
<li>As you;ll see on the slide</li>
<li>let's move and look at</li>
<li>Anyway, that's all I have time for</li>
<li>I'd better stop</li>
<li>Does anyone have any querstions or comments</li>
<li>I'll just conclude by saying thank you for your listening</li>
<li>I'll turn it over to John</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[ÂíåÁù¶Áõ∏Â§Ñ]]></title>
            <link>https://askaric.com/zh/work/english/03È´òÁ∫ßÂè£ËØ≠/3-8Âú∫ÊôØ_ÂíåÁù¶Áõ∏Â§Ñ.html</link>
            <guid>https://askaric.com/zh/work/english/03È´òÁ∫ßÂè£ËØ≠/3-8Âú∫ÊôØ_ÂíåÁù¶Áõ∏Â§Ñ.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[ÂÖ≥‰∫éËØ≠Ê≥ï
1. ‰∏çÂÆöÂºè(to + verb)  
    a. Âú®ÂΩ¢ÂÆπËØçÂêéÈù¢Ôºå‰Ω†ÂèØ‰ª•Áî®‰∏çÂÆöÂºèÔºåÂ∞§ÂÖ∂ÊòØÂú®it‰ªéÂè•‰∏≠ÔºåËøôÂú®Ê¶ÇÊã¨‰∏≠ÂæàÂ∏∏ËßÅ„ÄÇ  
    b. e.g. : It was impossible]]></description>
            <content:encoded><![CDATA[<h1 id="ÂíåÁù¶Áõ∏Â§Ñ" tabindex="-1">ÂíåÁù¶Áõ∏Â§Ñ <a class="header-anchor" href="#ÂíåÁù¶Áõ∏Â§Ñ" aria-label="Permalink to &quot;ÂíåÁù¶Áõ∏Â§Ñ&quot;"></a></h1>
<h2 id="ÂÖ≥‰∫éËØ≠Ê≥ï" tabindex="-1">ÂÖ≥‰∫éËØ≠Ê≥ï <a class="header-anchor" href="#ÂÖ≥‰∫éËØ≠Ê≥ï" aria-label="Permalink to &quot;ÂÖ≥‰∫éËØ≠Ê≥ï&quot;"></a></h2>
<ol>
<li>
<p>‰∏çÂÆöÂºè(to + verb)<br>
a. Âú®ÂΩ¢ÂÆπËØçÂêéÈù¢Ôºå‰Ω†ÂèØ‰ª•Áî®‰∏çÂÆöÂºèÔºåÂ∞§ÂÖ∂ÊòØÂú®it‰ªéÂè•‰∏≠ÔºåËøôÂú®Ê¶ÇÊã¨‰∏≠ÂæàÂ∏∏ËßÅ„ÄÇ<br>
b. e.g. : It was impossible for her to have time for herself.<br>
c. Afeter nouns or pronouns, use infinitives to add more details or say how you use them.<br>
d. e.g. : We always has nice clothes to wear.</p>
</li>
<li>
<p>-ing Ê†ºÂºè(verb + -ing)<br>
a. ‰Ω†‰πüÂèØ‰ª•‰ΩøÁî® -ing ÂΩ¢Âºè„ÄÇËøôÂú®‰∫∫‰ª¨ÊèèËø∞ÂÆûÈôÖÁªèÂéÜÊó∂ÂæàÂ∏∏ËßÅ„ÄÇ<br>
b. e.g. : I was a bit lonely being by myseld all the time.<br>
c. After these expressions, use -ing forms : have fun, have trouble/problem(s); be worth.<br>
d. e.g. : I had fun/no problems growing up in my family.</p>
</li>
</ol>
<h2 id="ÂÖ≥‰∫éÂÜÖÂÆπ" tabindex="-1">ÂÖ≥‰∫éÂÜÖÂÆπ <a class="header-anchor" href="#ÂÖ≥‰∫éÂÜÖÂÆπ" aria-label="Permalink to &quot;ÂÖ≥‰∫éÂÜÖÂÆπ&quot;"></a></h2>
<ol>
<li>Ë∞àËÆ∫‰∏é‰∫∫Áõ∏Â§Ñ„ÄÇ</li>
<li>‰ΩøÁî®Âä®ËØçÁü≠ËØ≠„ÄÇ</li>
<li>‰ΩøÁî®‰∏çÂÆöÂºèÂíå-ingÂΩ¢Âºè„ÄÇ</li>
<li>Â≠¶‰ºöÂ¶Ç‰ΩïÊää‰Ω†ÁöÑËßÇÁÇπË°®ËææÊ∏ÖÊ•ö„ÄÇ</li>
<li>Áî® <code>I have to say</code> Êù•Ë°®ËææÂº∫ÁÉàÁöÑËßÇÁÇπ„ÄÇ</li>
</ol>
<h2 id="Êñ∞ÂçïËØç" tabindex="-1">Êñ∞ÂçïËØç <a class="header-anchor" href="#Êñ∞ÂçïËØç" aria-label="Permalink to &quot;Êñ∞ÂçïËØç&quot;"></a></h2>
<ol>
<li>infinitives</li>
<li>boomerang child</li>
<li>frankly</li>
<li>friction</li>
</ol>
<h2 id="Êñ∞ËØçÁªÑ" tabindex="-1">Êñ∞ËØçÁªÑ <a class="header-anchor" href="#Êñ∞ËØçÁªÑ" aria-label="Permalink to &quot;Êñ∞ËØçÁªÑ&quot;"></a></h2>
<ol>
<li>name calling</li>
<li>put up with</li>
<li>put off</li>
<li>come up/show up</li>
<li>go over</li>
<li>run out of</li>
<li>have friends over for dinner</li>
<li>wake up</li>
<li>give it back</li>
<li>clean up</li>
<li>put up with</li>
<li>look forward to</li>
<li>right away</li>
<li>desire for/yearn for</li>
<li>get on my feet</li>
</ol>
<h2 id="ÂøÖÂ§áÂè•Â≠ê" tabindex="-1">ÂøÖÂ§áÂè•Â≠ê <a class="header-anchor" href="#ÂøÖÂ§áÂè•Â≠ê" aria-label="Permalink to &quot;ÂøÖÂ§áÂè•Â≠ê&quot;"></a></h2>
<ol>
<li>I used to long for somewhere quiet to study.</li>
<li>move back in with my parents</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[‰ºòË¥®ËØªÁâ©]]></title>
            <link>https://askaric.com/zh/work/english/03È´òÁ∫ßÂè£ËØ≠/3-9Âú∫ÊôØ_‰ºòË¥®ËØªÁâ©.html</link>
            <guid>https://askaric.com/zh/work/english/03È´òÁ∫ßÂè£ËØ≠/3-9Âú∫ÊôØ_‰ºòË¥®ËØªÁâ©.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[ÂÖ≥‰∫éÂÜÖÂÆπ
In this unit, I'll learn something below:
1. Ë∞àËÆ∫ÊñáÂ≠¶‰ΩúÂìÅ„ÄÅÈòÖËØª‰π†ÊÉØÂíåÊúÄÂñúÊ¨¢ÁöÑ‰ΩúÂÆ∂„ÄÇ
2. ÈÅøÂÖç‰ΩøÁî®Âä©Âä®ËØçtoÂíåone(s)Êù•ÈáçÂ§çÂçïËØç„ÄÇ
3. ‰Ωø]]></description>
            <content:encoded><![CDATA[<h1 id="‰ºòË¥®ËØªÁâ©" tabindex="-1">‰ºòË¥®ËØªÁâ© <a class="header-anchor" href="#‰ºòË¥®ËØªÁâ©" aria-label="Permalink to &quot;‰ºòË¥®ËØªÁâ©&quot;"></a></h1>
<h2 id="ÂÖ≥‰∫éÂÜÖÂÆπ" tabindex="-1">ÂÖ≥‰∫éÂÜÖÂÆπ <a class="header-anchor" href="#ÂÖ≥‰∫éÂÜÖÂÆπ" aria-label="Permalink to &quot;ÂÖ≥‰∫éÂÜÖÂÆπ&quot;"></a></h2>
<p>In this unit, I'll learn something below:</p>
<ol>
<li>Ë∞àËÆ∫ÊñáÂ≠¶‰ΩúÂìÅ„ÄÅÈòÖËØª‰π†ÊÉØÂíåÊúÄÂñúÊ¨¢ÁöÑ‰ΩúÂÆ∂„ÄÇ</li>
<li>ÈÅøÂÖç‰ΩøÁî®Âä©Âä®ËØçtoÂíåone(s)Êù•ÈáçÂ§çÂçïËØç„ÄÇ</li>
<li>‰ΩøÁî®Âä©Âä®ËØçÊù•Âº∫Ë∞É„ÄÇ</li>
<li>Áî®if soÂíåif not‰ª£ÊõøÈáçÂ§çÊÉ≥Ê≥ï„ÄÇ</li>
</ol>
<h2 id="ÂÖ≥‰∫éËØ≠Ê≥ï" tabindex="-1">ÂÖ≥‰∫éËØ≠Ê≥ï <a class="header-anchor" href="#ÂÖ≥‰∫éËØ≠Ê≥ï" aria-label="Permalink to &quot;ÂÖ≥‰∫éËØ≠Ê≥ï&quot;"></a></h2>
<ol>
<li>
<p>‰Ω†ÂèØ‰ª•‰ΩøÁî®Âä©Âä®ËØçÊù•ÈÅøÂÖçÈáçÂ§çÂçïËØç (e.g., be, have, do).<br>
a. The auxiliary can be in the same tense as the first verb.<br>
b. He's obviously enjoying it - as I am. (= am enjoying it)<br>
c. I think it's a great idea, but my family doesn't. (= doesn't think it's a great idea)<br>
d. I haven't been aboard. My friends haven't either. (= haven't been aboard)</p>
</li>
<li>
<p>Âä©Âä®ËØç‰πüÂèØ‰ª•Áî®‰∏çÂêåÁöÑÊó∂ÊÄÅ<br>
a. She obviously changed careers - a lot of people do theese days. (= change careers)<br>
b. I hope it works out. It did for me. (= worked out)</p>
</li>
<li>
<p>Â§öËÆ≤Âä©Âä®ËØçÔºåÈÅøÂÖçÈáçÂ§ç„ÄÇ<br>
a. <strong>Simple present or past</strong> : I don't often take risks, but my best friend does all the time.<br>
b. <strong>Present or past continuous</strong> : I was hoping to graduate last year. One of my friends was, too.<br>
c. <strong>Present perfect (or continuous)</strong> : I've been thinking about settling down, but my friends haven't.<br>
d. <strong>Past perfect (or continuous)</strong> : I'd never has straight A's till this year, though my friends all had.<br>
e. <strong>Modal verbs</strong> : My dad can't understand why I want to travel, but my mom can.</p>
</li>
<li>
<p>‰Ω†ÂèØ‰ª•Áî® too, so Âíå neither Êù•Ë°®Á§∫Áõ∏‰ºº„ÄÇ<br>
a. I'm saving for a trip, and my best friend is, too. Or ... and so is my best friend.<br>
b. She doesn't enjoy her work, and I don't, either. Or ... and neither do I.<br>
c. She can't afford to go away next year, and I can't, either. Or ... and neither can I.</p>
</li>
<li>
<p>‰ΩøÁî®(to) do soÊù•ÈÅøÂÖçÈáçÂ§çÂä®ËØç+ÂÆæËØ≠ÊàñË°•ËØ≠„ÄÇ<br>
a. Learning to play sports has given me confidence and will continue to do so for many years.<br>
b. Many people want to buy their own homw but are not in a position to do so.<br>
c. A lot of people want to publish novels but are unable to do do.<br>
d. Anyone who wishes to take a career break can do so if they plan it carefully.</p>
</li>
<li>
<p>Âà†Èô§ÂçïËØçÊàñ‰ΩøÁî®one / ones„ÄÇ<br>
a. You can avoid repeating infinitive verb phrases by using <code>to</code> when it's clear what you mean.  (I would like to write like her, but I'll never be able to. I mean, I'd like to write like her --&gt; I mean, I'd like to.)<br>
b. Notice the negatives with try and prefer.  (I shouldn't read trashy novels, and I try not to read trashy novels --&gt; I try not to.)<br>
c. You can use one or ones to avoid repeating countbale nouns. Don't use them after my, your, his, etc., some, any, or both useless there is an adjective.  (I've read all her books, Her best one is ... or Of the books I read, the ones I like best are nonfiction)</p>
</li>
</ol>
<h2 id="Êñ∞ÂçïËØç" tabindex="-1">Êñ∞ÂçïËØç <a class="header-anchor" href="#Êñ∞ÂçïËØç" aria-label="Permalink to &quot;Êñ∞ÂçïËØç&quot;"></a></h2>
<ol>
<li>lucrative</li>
<li>dye</li>
<li>contemplate</li>
<li>dentistry</li>
<li>autobiography</li>
<li>memoir</li>
<li>wear --&gt; worn</li>
<li>contradictory</li>
<li>fabulous</li>
<li>uproot</li>
</ol>
<h2 id="Êñ∞ËØçÁªÑ" tabindex="-1">Êñ∞ËØçÁªÑ <a class="header-anchor" href="#Êñ∞ËØçÁªÑ" aria-label="Permalink to &quot;Êñ∞ËØçÁªÑ&quot;"></a></h2>
<ol>
<li>on the tip of my tongue</li>
<li>couldn't make heads or tails of them</li>
<li>get your head around</li>
<li>come to grips (with)</li>
<li>learned by heart (recite)</li>
<li>off the top of my head</li>
<li>nothing to come to mind</li>
<li>get something out of it</li>
<li>It's beyond me</li>
<li>stick in my mind</li>
<li>lost my train of thought</li>
</ol>
<h2 id="ÂøÖÂ§áÂè•Â≠ê" tabindex="-1">ÂøÖÂ§áÂè•Â≠ê <a class="header-anchor" href="#ÂøÖÂ§áÂè•Â≠ê" aria-label="Permalink to &quot;ÂøÖÂ§áÂè•Â≠ê&quot;"></a></h2>
<ol>
<li>I'm a bit confused.</li>
<li>I don't understand it clearly.</li>
<li>It's one I learned by heart when I was a kid.</li>
<li>It's beyound me why people think you should read the classic.</li>
<li>I don't see the point of it</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Â¶Ç‰ΩïÂáÜÂ§áÈõÖÊÄù]]></title>
            <link>https://askaric.com/zh/work/english/04ÈõÖÊÄùËÄÉËØï/4-1week1_ÈõÖÊÄùËÄÉËØï.html</link>
            <guid>https://askaric.com/zh/work/english/04ÈõÖÊÄùËÄÉËØï/4-1week1_ÈõÖÊÄùËÄÉËØï.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[ÈõÖÊÄùËßÑÂàô
 Âè£ËØ≠ÈóÆÈ¢ò
1. ÁßØÊûÅË°®ËææÊÑèÊÑø‰∏çÂº∫
2. ÊµÅÁïÖÂ∫¶ÊúâÈóÆÈ¢ò
3. ÂèëÈü≥ÈóÆÈ¢ò‰∏çÂ§ß
4. ÂØπÈóÆÈ¢òÁöÑÊó∂ÊÄÅÊàñÂáÜÁ°ÆÊÄß‰∏çÊïèÊÑü
 ÊàëÁöÑËÆ°Âàí
1. Èô§‰∫ÜËã±ËØ≠‰πãÂ§ñÔºåÊàëËøòÊµãËØï‰∫Ü `Âê¨` ÁöÑÈÉ®ÂàÜÔºåÊÑüËßâÂæàÈöæ„ÄÇÂè™ÂÅö‰∫Ü 1]]></description>
            <content:encoded><![CDATA[<h1 id="Â¶Ç‰ΩïÂáÜÂ§áÈõÖÊÄù" tabindex="-1">Â¶Ç‰ΩïÂáÜÂ§áÈõÖÊÄù <a class="header-anchor" href="#Â¶Ç‰ΩïÂáÜÂ§áÈõÖÊÄù" aria-label="Permalink to &quot;Â¶Ç‰ΩïÂáÜÂ§áÈõÖÊÄù&quot;"></a></h1>
<h2 id="ÈõÖÊÄùËßÑÂàô" tabindex="-1">ÈõÖÊÄùËßÑÂàô <a class="header-anchor" href="#ÈõÖÊÄùËßÑÂàô" aria-label="Permalink to &quot;ÈõÖÊÄùËßÑÂàô&quot;"></a></h2>
<figure><img src="./../../../../images/english/04IELTS_exam/day1-IELTS.jpeg" alt="day1-IELTS" tabindex="0"><figcaption>day1-IELTS</figcaption></figure>
<h2 id="Âè£ËØ≠ÈóÆÈ¢ò" tabindex="-1">Âè£ËØ≠ÈóÆÈ¢ò <a class="header-anchor" href="#Âè£ËØ≠ÈóÆÈ¢ò" aria-label="Permalink to &quot;Âè£ËØ≠ÈóÆÈ¢ò&quot;"></a></h2>
<ol>
<li>ÁßØÊûÅË°®ËææÊÑèÊÑø‰∏çÂº∫</li>
<li>ÊµÅÁïÖÂ∫¶ÊúâÈóÆÈ¢ò</li>
<li>ÂèëÈü≥ÈóÆÈ¢ò‰∏çÂ§ß</li>
<li>ÂØπÈóÆÈ¢òÁöÑÊó∂ÊÄÅÊàñÂáÜÁ°ÆÊÄß‰∏çÊïèÊÑü</li>
</ol>
<h2 id="ÊàëÁöÑËÆ°Âàí" tabindex="-1">ÊàëÁöÑËÆ°Âàí <a class="header-anchor" href="#ÊàëÁöÑËÆ°Âàí" aria-label="Permalink to &quot;ÊàëÁöÑËÆ°Âàí&quot;"></a></h2>
<ol>
<li>Èô§‰∫ÜËã±ËØ≠‰πãÂ§ñÔºåÊàëËøòÊµãËØï‰∫Ü <code>Âê¨</code> ÁöÑÈÉ®ÂàÜÔºåÊÑüËßâÂæàÈöæ„ÄÇÂè™ÂÅö‰∫Ü 14 ÈÅìÂê¨ÂäõÁúüÈ¢òÔºåÂè™Âê¨Âá∫ÂÖ∂‰∏≠ 1 ‰∏™È¢òÔºåÊÑüËßâÂæà‰∏çÂ•Ω„ÄÇ</li>
<li>ÊâÄ‰ª•ÔºåÈúÄË¶ÅÂ§ßÈáèÁöÑÊó∂Èó¥ÂéªËÅîÁ≥ª <code>Âê¨</code>, <code>ËØª</code>, <code>ÂÜô</code> ‰∏â‰∏™ÈÉ®ÂàÜÔºåÂØπ <code>ËØ¥</code> ÁöÑÈÉ®ÂàÜÂâçÊúü‰ª•‰øùÊåÅËØ≠ÊÑüÔºå‰øÆÊ≠£ËøûË¥ØÊÄß‰∏∫‰∏ª„ÄÇ</li>
<li>ÊàëËÆ§‰∏∫ÊúÄÂêéÁöÑÈõÖÊÄùÁõÆÊ†áÂàÜÊòØ 7„ÄÇ</li>
</ol>
<p>‰ª• 4 ‰∏™Êúà‰∏∫ÊúüÔºåÊØèÂ§© 1h ÊäïÂÖ•ÔºåÊÄªÊó∂Èó¥‰∏∫ <code>30 * 4 * 2 = 240h</code>.</p>
<h2 id="ÊµãËØïÁªìÊûú" tabindex="-1">ÊµãËØïÁªìÊûú <a class="header-anchor" href="#ÊµãËØïÁªìÊûú" aria-label="Permalink to &quot;ÊµãËØïÁªìÊûú&quot;"></a></h2>
<p>ÊàëÁ¨¨‰∏ÄÊ¨°‰ΩøÁî® <code>ÊµÅÂà©ËØ¥.ÈõÖÊÄù</code> ÊµãËØïÁöÑÈõÖÊÄùÂè£ËØ≠ÁªìÊûúÂ¶Ç‰∏ãÔºå‰∏∫ 5.0 ÂàÜ„ÄÇ</p>
<figure><img src="./../../../../images/english/04IELTS_exam/day1_oral_english_result_2023_04_04.jpeg" alt="day1_oral_english_result_2023_04_04" tabindex="0"><figcaption>day1_oral_english_result_2023_04_04</figcaption></figure>
<h2 id="Â≠¶‰π†ËøõÂ∫¶" tabindex="-1">Â≠¶‰π†ËøõÂ∫¶ <a class="header-anchor" href="#Â≠¶‰π†ËøõÂ∫¶" aria-label="Permalink to &quot;Â≠¶‰π†ËøõÂ∫¶&quot;"></a></h2>
<ol>
<li>
<p>Âë®ËøõÂ∫¶</p>
<table tabindex="0">
<thead>
<tr>
<th></th>
<th>Saturday</th>
<th>Sunday</th>
<th>Monday</th>
<th>Tuesday</th>
<th>Wednesday</th>
<th>Thursday</th>
<th>Friday</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td></td>
<td></td>
<td>1.ÂæóÂà∞ÈõÖÊÄùÂê¨ÂäõÂíåÂè£ËØ≠ÁöÑÊµãËØïÁªìÊûú 2. ÂÆåÊàêÂè£ËØ≠ÁªÉ‰π†ÔºåÂú® <code>ÈõÖÊÄùËÄÉÊª°ÂàÜ</code></td>
<td>1. ÁúãÂπ∂ÊäÑÂΩï‰∏Ä‰ªΩ 7min ÁöÑ<a href="https://www.bilibili.com/video/BV1Rt411U7Ve" target="_blank" rel="noreferrer">‰πîÂ∏ÉÊñØÂÜÖÈÉ®ËßÜÈ¢ë</a>,ÁõÆÁöÑÊòØÂÖàÂê¨ 3 ÈÅçÔºåÂÜçËÉå‰∏ãÊù•ÔºåÂÜçÂê¨ÁúãÂØπÂê¨ÂäõÊòØÂê¶ÊúâÊîπÂñÑ(ÊúâÈÉ®ÂàÜÊîπÂñÑ) 2. ÁøªËØë‰πãÂâçÁöÑËã±ËØ≠Á¨îËÆ∞Êàê‰∏≠ÊñáÔºåÂπ∂Â§ç‰π†ÂÖ∂‰∏≠ÂÜÖÂÆπÔºàËØ≠Ê≥ïÔºåÂçïËØçÔºåËØçÁªÑÔºâ3. ÂÆåÊàê‰∏Ä‰∏™Âè£ËØ≠ÁªÉ‰π†Âú® <code>ÈõÖÊÄùËÄÉÊª°ÂàÜ</code></td>
<td>1. ÂÆåÊàêËã±ËØ≠‰Ωú‰∏ö 2. ÈõÖÊÄùËÄÉÊª°ÂàÜ‰∏äÊØèÊó•‰∏ÄÁªÉ</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Ëä±Ë¥πÊó∂Èó¥</td>
<td>None</td>
<td>None</td>
<td>3h(11:00 A.M.-2:00 A.M.)</td>
<td>5h(11:00 P.M.-5:00 A.M.)</td>
<td>1.5h(19:00 P.M.-20:30 P.M.)</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>ÊØèÊó•‰∏ÄÈ¢òËøõÂ∫¶</p>
<table tabindex="0">
<thead>
<tr>
<th>Date</th>
<th>Model Text</th>
<th>BestScore , BestTimeConsuming , MyBestScore , MyTimeConsuming</th>
</tr>
</thead>
<tbody>
<tr>
<td>2023-04-03</td>
<td>forgot to record</td>
<td>N/A</td>
</tr>
<tr>
<td>2023-04-04</td>
<td>Do you have patience? --&gt; I will be lying if I say I have patient. Even though I know that patient is one of the most important virtue that one can have. I'm not a patient person, I am always want to rush things no matter it's for work, or in my personal life, even a minute more, I'll consider it as a waste of time.</td>
<td>93, 35s,91,27s</td>
</tr>
<tr>
<td>2023-04-05</td>
<td>1. Do you have patience? --&gt; <a href="https://ielts.kmf.com/speaking/wechat/speakinfo?exam_unique=168069586533056514&amp;by_name=%25E5%25AD%25A6%25E5%2591%2598vQStk1" target="_blank" rel="noreferrer">My answer</a>, 2. What may distract you when you're trying to stay foucused? --&gt; <a href="https://ielts.kmf.com/speaking/wechat/speakinfo?exam_unique=168069625066321730&amp;by_name=%25E5%25AD%25A6%25E5%2591%2598vQStk1" target="_blank" rel="noreferrer">My answer</a>, 3. What do you do to help you concentrate? --&gt; <a href="https://ielts.kmf.com/speaking/wechat/speakinfo?exam_unique=168069661875421160&amp;by_name=%25E5%25AD%25A6%25E5%2591%2598vQStk1" target="_blank" rel="noreferrer">My answer</a>, 4. Is it difficult for you to stay focused on something? --&gt; <a href="https://ielts.kmf.com/speaking/wechat/speakinfo?exam_unique=168069700793308542&amp;by_name=%25E5%25AD%25A6%25E5%2591%2598vQStk1" target="_blank" rel="noreferrer">My answer</a></td>
<td>N/A</td>
</tr>
</tbody>
</table>
</li>
</ol>
<h2 id="Êñ∞ÂçïËØç-Êñ∞Âè•Â≠ê-Êñ∞ËØçÁªÑ" tabindex="-1">Êñ∞ÂçïËØçÔºåÊñ∞Âè•Â≠êÔºåÊñ∞ËØçÁªÑ <a class="header-anchor" href="#Êñ∞ÂçïËØç-Êñ∞Âè•Â≠ê-Êñ∞ËØçÁªÑ" aria-label="Permalink to &quot;Êñ∞ÂçïËØçÔºåÊñ∞Âè•Â≠êÔºåÊñ∞ËØçÁªÑ&quot;"></a></h2>
<p>Ëøô‰∏ÄÈÉ®ÂàÜÊòØÂÖ≥‰∫éÊàëÊ≤°ÊúâËßÅËøáÁöÑÊñ∞ËØçÂíåËØØËß£„ÄÇ</p>
<ol>
<li>monologue Áã¨ÁôΩ</li>
<li>interpret ËØ¥Êòé</li>
<li>corridor ÈÄöÈÅì</li>
<li>entrance to somewhere ÊüêÂú∞ÁöÑÂÖ•Âè£</li>
<li>look out onto ÂêëÂ§ñÁúãÂêë</li>
<li>be moved by Ë¢´ÊÑüÂä®</li>
<li>put out Âá∫Áâà</li>
<li>put out of Ê∂àÁÅ≠</li>
<li>it's what we are ËøôÂ∞±ÊòØÊàë‰ª¨ÔºàÂè£ËØ≠‰∏≠Áî®ÁöÑÊå∫È¢ëÁπÅÁöÑÂè•ÂûãÔºâ + about + doing/clause</li>
<li>intention --&gt; ÁõÆÁöÑ</li>
<li>deliberate --&gt; Ê∑±ÊÄùÁÜüËôëÁöÑÔºåÊïÖÊÑèÁöÑ</li>
<li>manifesto --&gt; Â£∞ÊòéÔºåÂÆ£Ë®Ä</li>
<li>phenomenal --&gt; Êù∞Âá∫ÁöÑÔºåÂèØÊÑüÁü•ÁöÑ</li>
<li>billboards --&gt; ÂπøÂëäÁâå</li>
<li>turn around --&gt; ËΩ¨ÂêëÂèçÊñπÂêëÔºå(ÁîüÊÑèÊàñÁªèÊµé) Â•ΩËΩ¨</li>
<li>estate --&gt; ÈÅó‰∫ß</li>
<li>representative --&gt; ÂÖ∏ÂûãÁöÑÔºåÊúâ‰ª£Ë°®ÊÄßÁöÑÔºå‰ª£Ë°®Ôºå‰ª£ÁêÜ‰∫∫</li>
<li>videotape --&gt; ÂΩïÂÉèÂ∏¶</li>
<li>the more + clause, the more/less + clasue --&gt; Ë∂äÊÄé‰πàÊ†∑ÔºåË∂äÊÄé‰πàÊ†∑</li>
<li>celebrate with + someone/sth --&gt; ‰∏éÊüê‰∫∫Â∫ÜÁ•ùÔºåÁî®ÊüêÁâ©Â∫ÜÁ•ù</li>
</ol>
<h2 id="Ëø∑ÊÉëÈÉ®ÂàÜ" tabindex="-1">Ëø∑ÊÉëÈÉ®ÂàÜ <a class="header-anchor" href="#Ëø∑ÊÉëÈÉ®ÂàÜ" aria-label="Permalink to &quot;Ëø∑ÊÉëÈÉ®ÂàÜ&quot;"></a></h2>
<p>ËøôÈÉ®ÂàÜÊòØ‰∏éËØæÁ®ãÊàñËÆ°ÂàíÊó†ÂÖ≥Ôºå‰ΩÜÊòØÔºåÂú®Â≠¶‰π†ËøáÁ®ã‰∏≠‰∫ßÁîüÁöÑ‰∏Ä‰∫õÁñëÊÉë„ÄÇ</p>
<ol>
<li><code>think about doing</code> ‰∏é <code>consider doing</code> ÁöÑ‰∏çÂêå<br>
Â§ßÈÉ®ÂàÜÂú∫ÊôØÂèØ‰ª•ÈÄöÁî®ÔºåÁÆÄËÄåË®Ä‰πãÔºå‰∏çÂêåÂú®‰∫é<code>think about</code> ÊòØÊõ¥ÈÄöÁî®ÁöÑ‰∏îÂèØ‰ª•ÊåáÂêë‰ªª‰ΩïÁöÑÊÄùËÄÉËøáÁ®ãÔºåÂêåÊó∂Ôºå<code>consider doing</code> ÈÄöÂ∏∏ÊÑèÂë≥ÁùÄÊõ¥Âä†ÈõÜ‰∏≠Âú®ÂÅöÂÜ≥ÂÆöÁöÑÂú∫ÊôØ‰∏ä„ÄÇ</li>
<li><code>intention</code> ‰∏é <code>aim</code> ÁöÑ‰∏çÂêå<br>
ÊÑè‰πâÁõ∏‰ººÔºå‰∏çÂêåÂú®‰∫é intention ÈÄöÂ∏∏‰ΩøÁî®Âú®‰∏Ä‰∏™ÂÆ¢ËßÇÁöÑÊåáÂÆöÂä®‰ΩúÊàñÊÄùËÄÉËøáÁ®ã‰∏≠ÔºåËÄå aim Êõ¥Â§öÊòØÁöÑ‰∏ªËßÇÂ±ÇÈù¢ÁöÑÁõÆÊ†á„ÄÇ</li>
</ol>
]]></content:encoded>
            <enclosure url="https://askaric.com/images/english/04IELTS_exam/day1-IELTS.jpeg" length="0" type="image/jpeg"/>
        </item>
        <item>
            <title><![CDATA[Â§ç‰π†ÂâëÊ°• 4B]]></title>
            <link>https://askaric.com/zh/work/english/04ÈõÖÊÄùËÄÉËØï/4-2week2_Â§ç‰π†ÂâëÊ°•4B.html</link>
            <guid>https://askaric.com/zh/work/english/04ÈõÖÊÄùËÄÉËØï/4-2week2_Â§ç‰π†ÂâëÊ°•4B.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[Â≠¶‰π†ËøõÂ∫¶
1. Âë®ËøõÂ∫¶
    | | Saturday | Sunday | Monday | Tuesday | Wednesday | Thursday | Friday |
    | - |]]></description>
            <content:encoded><![CDATA[<h1 id="Â§ç‰π†ÂâëÊ°•-4b" tabindex="-1">Â§ç‰π†ÂâëÊ°• 4B <a class="header-anchor" href="#Â§ç‰π†ÂâëÊ°•-4b" aria-label="Permalink to &quot;Â§ç‰π†ÂâëÊ°• 4B&quot;"></a></h1>
<h2 id="Â≠¶‰π†ËøõÂ∫¶" tabindex="-1">Â≠¶‰π†ËøõÂ∫¶ <a class="header-anchor" href="#Â≠¶‰π†ËøõÂ∫¶" aria-label="Permalink to &quot;Â≠¶‰π†ËøõÂ∫¶&quot;"></a></h2>
<ol>
<li>
<p>Âë®ËøõÂ∫¶</p>
<table tabindex="0">
<thead>
<tr>
<th></th>
<th>Saturday</th>
<th>Sunday</th>
<th>Monday</th>
<th>Tuesday</th>
<th>Wednesday</th>
<th>Thursday</th>
<th>Friday</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td>1. Âê¨Âπ∂ÊäÑÂÜôÈÉ®ÂàÜ Elon Musk Âíå Jack Ma ÁöÑÊºîËÆ≤ÔºåÂπ∂ÊàëÂ∫îËØ•ËÉåËØµÁöÑÂè•Â≠ê</td>
<td>1. ËÉåËØµ 4B ‰π¶‰∏äÂ≠¶ËøáÁöÑÊâÄÊúâÂ≠¶ËøáÁöÑÊÆµËêΩ 2. ÂÆåÊàê 2 ‰∏™ topic ÁªÉ‰π†ÔºåÂú® <code>ÈõÖÊÄùËÄÉÊª°ÂàÜ</code></td>
<td>1. Â§ç‰π†‰∏ÄÈÅçÊò®Â§©Â§ç‰π†ÁöÑ 4B ÂÜÖÂÆπ 2. ÂÆåÊàê‰∏Ä‰∏™ topic ÁªÉ‰π†</td>
<td>1. Â§ç‰π† 4A Âè£ËØ≠‰π¶ÂÜÖÂÆπ 2. ÂÆåÊàêËã±ËØ≠‰Ωú‰∏ö 3. ÂÅöÈ¢ùÂ§ñÁöÑ 3 ‰∏™Âè£ËØ≠ÁªÉ‰π†ÔºöÂë®Êú´ÔºåÂ∑ßÂÖãÂäõÔºåÂ∞èÁîüÊÑè</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Ëä±Ë¥πÊó∂Èó¥</td>
<td>3h</td>
<td>4h</td>
<td>2h(1:30 A.M.~3:30 A.M.)</td>
<td>3h(11:30 P.M.~2:30 A.M.)</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Êó•ËøõÂ∫¶</p>
<table tabindex="0">
<thead>
<tr>
<th>Date</th>
<th>Model Text</th>
<th>BestScore , BestTimeConsuming , MyBestScore , MyTimeConsuming</th>
</tr>
</thead>
<tbody>
<tr>
<td>2023-04-08</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr>
<td>2023-04-09</td>
<td><a href="https://ielts.kmf.com/speaking/wechat/speakinfo?exam_unique=168106106657616818&amp;by_name=%25E5%25AD%25A6%25E5%2591%2598vQStk1" target="_blank" rel="noreferrer">Topic-1 When do people smile to others? --&gt; My Answer</a>, <a href="https://ielts.kmf.com/speaking/wechat/speakinfo?exam_unique=168106178767317770&amp;by_name=%25E5%25AD%25A6%25E5%2591%2598vQStk1" target="_blank" rel="noreferrer">Topic-1 Do you smile when someone takes photos for you? --&gt; My Answer</a>, <a href="https://ielts.kmf.com/speaking/wechat/speakinfo?exam_unique=168106240036624335&amp;by_name=%25E5%25AD%25A6%25E5%2591%2598vQStk1" target="_blank" rel="noreferrer">Topic-1 Can you feel it when someone`s smile is fake? --&gt; My Answer</a>, <a href="https://ielts.kmf.com/speaking/wechat/speakinfo?exam_unique=168106258407798647&amp;by_name=%25E5%25AD%25A6%25E5%2591%2598vQStk1" target="_blank" rel="noreferrer">Topic-1 When was the last time you saw many people laughing? --&gt; My Answer</a>, <a href="https://ielts.kmf.com/speaking/wechat/speakinfo?exam_unique=168106276426192642&amp;by_name=%25E5%25AD%25A6%25E5%2591%2598vQStk1" target="_blank" rel="noreferrer">Topic-1 Do you like smiling? --&gt; My Answer</a>, <a href="https://ielts.kmf.com/speaking/wechat/speakinfo?exam_unique=168106314754511315&amp;by_name=%25E5%25AD%25A6%25E5%2591%2598vQStk1" target="_blank" rel="noreferrer">Topic-2 Do you think patience is important? --&gt; My Answer</a>, <a href="https://ielts.kmf.com/speaking/wechat/speakinfo?exam_unique=168106346585831496&amp;by_name=%25E5%25AD%25A6%25E5%2591%2598vQStk1" target="_blank" rel="noreferrer">Topic-2 Do you have patience? --&gt; My Answer</a>, <a href="https://ielts.kmf.com/speaking/wechat/speakinfo?exam_unique=168106390144226300&amp;by_name=%25E5%25AD%25A6%25E5%2591%2598vQStk1" target="_blank" rel="noreferrer">Topic-2 How to improve patience? --&gt; My Answer</a>, <a href="https://ielts.kmf.com/speaking/wechat/speakinfo?exam_unique=168106404944697395&amp;by_name=%25E5%25AD%25A6%25E5%2591%2598vQStk1" target="_blank" rel="noreferrer">Topic-2 Do you think you're more patient than before? --&gt; My Answer</a></td>
<td>N/A</td>
</tr>
<tr>
<td>2023-04-10</td>
<td><a href="https://ielts.kmf.com/speaking/wechat/speakinfo?exam_unique=168115414262822864&amp;by_name=%25E5%25AD%25A6%25E5%2591%2598vQStk1" target="_blank" rel="noreferrer">Topic-1 What do you think makes a good friend? --&gt; My Answer</a>, <a href="https://ielts.kmf.com/speaking/wechat/speakinfo?exam_unique=168115537707492161&amp;by_name=%25E5%25AD%25A6%25E5%2591%2598vQStk1" target="_blank" rel="noreferrer">Topic-1 Do you think you are a good friend to others? --&gt; My Answer</a>, <a href="https://ielts.kmf.com/speaking/wechat/speakinfo?exam_unique=168115479823260505&amp;by_name=%25E5%25AD%25A6%25E5%2591%2598vQStk1" target="_blank" rel="noreferrer">Topic-1 What kinds of people do you like to make friends with? --&gt; My Answer</a>, <a href="https://ielts.kmf.com/speaking/wechat/speakinfo?exam_unique=168115452839393063&amp;by_name=%25E5%25AD%25A6%25E5%2591%2598vQStk1" target="_blank" rel="noreferrer">Topic-1 Do you keep in touch with friends from your childhood? --&gt; My Answer</a></td>
<td>N/A</td>
</tr>
<tr>
<td>2023-04-11</td>
<td>1. reviewed 4A book. 2. finished homework 3. tested there extra topics: Chocolate, Small Bussiness, Weekends</td>
<td>N/A</td>
</tr>
</tbody>
</table>
</li>
</ol>
<h2 id="new-words-phrase-sentences" tabindex="-1">New Words, Phrase, Sentences <a class="header-anchor" href="#new-words-phrase-sentences" aria-label="Permalink to &quot;New Words, Phrase, Sentences&quot;"></a></h2>
<h2 id="puzzled-part" tabindex="-1">Puzzled Part <a class="header-anchor" href="#puzzled-part" aria-label="Permalink to &quot;Puzzled Part&quot;"></a></h2>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Â§öÊó∂ÊÄÅË°®ËææÂä†ÂàÜÈõÖÊÄùÂè£ËØ≠ËÄÉËØï]]></title>
            <link>https://askaric.com/zh/work/english/04ÈõÖÊÄùËÄÉËØï/4-3week3_Âä†ÂàÜÁ≠ñÁï•.html</link>
            <guid>https://askaric.com/zh/work/english/04ÈõÖÊÄùËÄÉËØï/4-3week3_Âä†ÂàÜÁ≠ñÁï•.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[ËøõÂ∫¶
1. Âë®ËøõÂ∫¶
    | | Saturday | Sunday | Monday | Tuesday | Wednesday | Thursday | Friday |
    | - | -]]></description>
            <content:encoded><![CDATA[<h1 id="Â§öÊó∂ÊÄÅË°®ËææÂä†ÂàÜÈõÖÊÄùÂè£ËØ≠ËÄÉËØï" tabindex="-1">Â§öÊó∂ÊÄÅË°®ËææÂä†ÂàÜÈõÖÊÄùÂè£ËØ≠ËÄÉËØï <a class="header-anchor" href="#Â§öÊó∂ÊÄÅË°®ËææÂä†ÂàÜÈõÖÊÄùÂè£ËØ≠ËÄÉËØï" aria-label="Permalink to &quot;Â§öÊó∂ÊÄÅË°®ËææÂä†ÂàÜÈõÖÊÄùÂè£ËØ≠ËÄÉËØï&quot;"></a></h1>
<h2 id="ËøõÂ∫¶" tabindex="-1">ËøõÂ∫¶ <a class="header-anchor" href="#ËøõÂ∫¶" aria-label="Permalink to &quot;ËøõÂ∫¶&quot;"></a></h2>
<ol>
<li>
<p>Âë®ËøõÂ∫¶</p>
<table tabindex="0">
<thead>
<tr>
<th></th>
<th>Saturday</th>
<th>Sunday</th>
<th>Monday</th>
<th>Tuesday</th>
<th>Wednesday</th>
<th>Thursday</th>
<th>Friday</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td></td>
<td></td>
<td>1. ÁúãÂÆåËÄÅÂèãËÆ∞Á¨¨‰∫åÂ≠£ 2. ËÉå‰∏ãÊù•Â∏∏Áî®Êó∂Â∫èË°®ËææÊ≥ïÔºåÈõÖÊÄùÂè£ËØ≠Âä†ÂàÜÊäÄÂ∑ß</td>
<td>1. ÁúãÂÆåËÄÅÂèãËÆ∞Á¨¨‰∏âÂ≠£‰∏ÄÂçä 2. ÈîªÁÇº 3 ‰∏™Âè£ËØ≠È¢òÁßØÁ¥Ø‰∏ªÈ¢ò</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Time Consuming</td>
<td></td>
<td>3h</td>
<td>Ôºà24:00ÔΩûÔºâ</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Â§©ËøõÂ∫¶</p>
<table tabindex="0">
<thead>
<tr>
<th>Date</th>
<th>Model Text</th>
<th>BestScore , BestTimeConsuming , MyBestScore , MyTimeConsuming</th>
</tr>
</thead>
<tbody>
<tr>
<td>2023-04-22</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr>
<td>2023-04-23</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr>
<td>2023-04-24</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr>
<td>2023-04-25</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr>
<td>2023-04-26</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr>
<td>2023-04-27</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr>
<td>2023-04-28</td>
<td>N/A</td>
<td>N/A</td>
</tr>
</tbody>
</table>
</li>
</ol>
<h2 id="Êñ∞ÂçïËØç" tabindex="-1">Êñ∞ÂçïËØç <a class="header-anchor" href="#Êñ∞ÂçïËØç" aria-label="Permalink to &quot;Êñ∞ÂçïËØç&quot;"></a></h2>
<ol>
<li>anecdote</li>
<li>astonishing</li>
<li>nuisance/peeve</li>
<li>pet peeve</li>
<li>tacitly/ tacitly imply</li>
<li>discern</li>
<li>advocate</li>
<li>aim to</li>
</ol>
<h2 id="Á≠ñÁï•" tabindex="-1">Á≠ñÁï• <a class="header-anchor" href="#Á≠ñÁï•" aria-label="Permalink to &quot;Á≠ñÁï•&quot;"></a></h2>
<ol>
<li>
<p>Which one restaurant do you usually go? --&gt; I've been going to an Italian restaurant. Actually, I've been there at least 10 times. I remember the first time I went there was last year. I was looking forward to a place to have dinner. I checked reviews online and found it. Let's have it a try/shot. Finally, It turned out to be amazing.</p>
</li>
<li>
<p>As a matter of fact, this pattern uses three tense to response, that's more likely to get high score, though without hard and abundant words.</p>
</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[ËÆ∞ÂΩïËã±ËØ≠Â≠¶‰π†ËøáÁ®ã]]></title>
            <link>https://askaric.com/zh/work/english/</link>
            <guid>https://askaric.com/zh/work/english/</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[ÂâçÊÉÖÊèêË¶Å
 Âè£ËØ≠Â≠¶‰π†
Êàë‰ª•ÊØèÂë® 1 Â∞èÊó∂ËØæÁ®ãÁöÑËøõÂ∫¶ÔºåÁª¥ÊåÅÊàëÁöÑËã±ËØ≠Âè£ËØ≠Â≠¶‰π†ÔºåÂú®Ê≠§ËÆ∞ÂΩï‰∏Ä‰∫õÂ≠¶‰π†Á¨îËÆ∞ÔºåËøô‰∏™Ë°å‰∏∫ÊúâÂä©‰∫éÊó•ÂêéÂ§ç‰π†„ÄÇ
 ÈõÖÊÄùËÄÉËØï
Âú® 2023 Âπ¥ 3 Êúà 25 Êó•ÔºåÊàëÁªùÂøÉ‰∏∫ÊàëÁöÑËã±ËØ≠Â≠¶‰π†ÂéÜÁ®ãËé∑Âèñ‰∏Ä]]></description>
            <content:encoded><![CDATA[<h1 id="ËÆ∞ÂΩïËã±ËØ≠Â≠¶‰π†ËøáÁ®ã" tabindex="-1">ËÆ∞ÂΩïËã±ËØ≠Â≠¶‰π†ËøáÁ®ã <a class="header-anchor" href="#ËÆ∞ÂΩïËã±ËØ≠Â≠¶‰π†ËøáÁ®ã" aria-label="Permalink to &quot;ËÆ∞ÂΩïËã±ËØ≠Â≠¶‰π†ËøáÁ®ã&quot;"></a></h1>
<h2 id="ÂâçÊÉÖÊèêË¶Å" tabindex="-1">ÂâçÊÉÖÊèêË¶Å <a class="header-anchor" href="#ÂâçÊÉÖÊèêË¶Å" aria-label="Permalink to &quot;ÂâçÊÉÖÊèêË¶Å&quot;"></a></h2>
<h2 id="Âè£ËØ≠Â≠¶‰π†" tabindex="-1">Âè£ËØ≠Â≠¶‰π† <a class="header-anchor" href="#Âè£ËØ≠Â≠¶‰π†" aria-label="Permalink to &quot;Âè£ËØ≠Â≠¶‰π†&quot;"></a></h2>
<p>Êàë‰ª•ÊØèÂë® 1 Â∞èÊó∂ËØæÁ®ãÁöÑËøõÂ∫¶ÔºåÁª¥ÊåÅÊàëÁöÑËã±ËØ≠Âè£ËØ≠Â≠¶‰π†ÔºåÂú®Ê≠§ËÆ∞ÂΩï‰∏Ä‰∫õÂ≠¶‰π†Á¨îËÆ∞ÔºåËøô‰∏™Ë°å‰∏∫ÊúâÂä©‰∫éÊó•ÂêéÂ§ç‰π†„ÄÇ</p>
<h2 id="ÈõÖÊÄùËÄÉËØï" tabindex="-1">ÈõÖÊÄùËÄÉËØï <a class="header-anchor" href="#ÈõÖÊÄùËÄÉËØï" aria-label="Permalink to &quot;ÈõÖÊÄùËÄÉËØï&quot;"></a></h2>
<p>Âú® 2023 Âπ¥ 3 Êúà 25 Êó•ÔºåÊàëÁªùÂøÉ‰∏∫ÊàëÁöÑËã±ËØ≠Â≠¶‰π†ÂéÜÁ®ãËé∑Âèñ‰∏Ä‰∏™Èò∂ÊÆµÊÄßÁªìÊûúÔºåÂõ†Ê≠§ÔºåÂ∞ÜÂéüÊúâËã±ËØ≠ËØæÁ®ã‰∏ìÂêë ‚ÄúÈõÖÊÄùËÄÉËØï‚ÄùÔºå‰Ω†ÂèØ‰ª•Âú® <strong>‚Äú[ÈõÖÊÄùËÄÉËØï]‚Äù</strong> ÁõÆÂΩïÁúãÂà∞ÊàëÁöÑ‰∏Ä‰∫õËøõÂ±ïÔºÅ</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Start--11gÁâ©ÁêÜDGÈÉ®ÁΩ≤]]></title>
            <link>https://askaric.com/zh/work/oracle/Start-DG.html</link>
            <guid>https://askaric.com/zh/work/oracle/Start-DG.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[

> [DBNEST -- Bilibili DataGuard Âü∫Á°ÄÊê≠Âª∫ËßÜÈ¢ëÂú∞ÂùÄ](https://www.bilibili.com/video/BV1Ep4y197JA?from=search&seid=17237800447886927935&spm_id_from=333.337.0.0)    
> [DBNEST -- ÊóßÁâàÊñáÊ°£ ‚ÄúÁÇπÂáª‚Äù Áõ¥Êé•ÊµèËßàÊàñ‰∏ãËΩΩ PDF](./Oracle11gRACÈõÜÁæ§Êê≠Âª∫ÊâãÂÜå.pdf) 

<iframe src="//player.bilibili.com/player.html?aid=968019810&bvid=BV1Ep4y197JA&cid=187553574&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" height="560" width="780"> </iframe>

## ‰∏Ä„ÄÅÂÆâË£ÖÂâçÊèê

### 1.1 Áâ©ÁêÜDGÂèÇÊï∞

| HOSTNAME | IP | DB_NAME | DB_UNIQUE_NAME | INSTANCE_NAME | SERVICE_NAME | TNSNAME | 
| - | - | - | - | - | - | - |
| dg1 | 192.168.169.220 | prod | uni_dg1 | prod | dg1 | uni_dg1 |
| dg2 | 192.168.169.221 | prod | uni_dg2 | Prod_stdby | dg2 | uni_dg2 |

### 1.2 Êñá‰ª∂Áâ©ÁêÜË∑ØÂæÑ
| datafile | controlfile | logfile | archivelog | auditfile |
| - | - | - | - | - |
| /u01/oradata/prod | /u01/oradata/prod /u01/fast_recovery_area/prod  | /u01/oradata/prod | /u01/arch | /u01/admin/prod/adump |
| /u01/oradata/prod_stdby | /u01/oradata/prod_stdby /u01/fast_recovery_area/prod | /u01/oradata/prod_stdby | /u01/arch | /u01/admin/prod_stdby/adump |



## ‰∫å„ÄÅÊúçÂä°Âô®ÈÖçÁΩÆ‰øÆÊîπ
### 2.1 ÈÖçÁΩÆÁΩëÁªú
‰∏ªÂ∫ìdg1:
```shell
[root@dg1 ~]# vi /etc/hosts
[root@dg1 ~]# scp /etc/hosts dg2:/etc/
The authenticity of host 'dg2 (192.168.169.201)' can't be established.
RSA key fingerprint is 26:5c:d2:36:66:2b:e2:b3:12:0d:c4:fb:a6:44:97:7b.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added 'dg2,192.168.169.201' (RSA) to the list of known hosts.
root@dg2's password: 123456
```
### 2.2 ‰øÆÊîπÂ§áÂ∫ìÂÆû‰æãÂêç

Â§áÂ∫ìdg2:
```shell
[root@dg2 ~]# cat /etc/hosts
127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4
192.168.169.200 dg1
192.168.169.201 dg2
[root@dg2 ~]# su - oracle
[oracle@dg2 ~]$ vi .bash_profile 
[oracle@dg2 ~]$ source .bash_profile 
[oracle@dg2 ~]$ env |grep SID
ORACLE_SID=prod_stdby
```
### 2.3 Âª∫Á´ãÂ§áÂ∫ìÁõÆÂΩï
Â§áÂ∫ìdg2:
```shell
[oracle@dg2 ~]$ mkdir -p /u01/oradata/prod_stdby
[oracle@dg2 ~]$ mkdir -p /u01/arch
[oracle@dg2 ~]$ mkdir -p /u01/fast_recovery_area/prod_stdby/
```
## ‰∏â„ÄÅÂª∫Á´ãÁâ©ÁêÜDG
### 3.1 ‰∏ªÂ∫ìÂº∫Âà∂ËÆ∞ÂΩïÊó•Âøó
‰∏ªÂ∫ìdg1:
```shell
[oracle@dg1 ~]$ sqlplus / as sysdba
SQL> select log_mode,force_logging from v$database;
LOG_MODE     FOR
]]></description>
            <content:encoded><![CDATA[<blockquote>
<p><a href="https://www.bilibili.com/video/BV1Ep4y197JA?from=search&amp;seid=17237800447886927935&amp;spm_id_from=333.337.0.0" target="_blank" rel="noreferrer">DBNEST -- Bilibili DataGuard Âü∫Á°ÄÊê≠Âª∫ËßÜÈ¢ëÂú∞ÂùÄ</a><br>
<a href="./Oracle11gRAC%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA%E6%89%8B%E5%86%8C.pdf">DBNEST -- ÊóßÁâàÊñáÊ°£ ‚ÄúÁÇπÂáª‚Äù Áõ¥Êé•ÊµèËßàÊàñ‰∏ãËΩΩ PDF</a></p>
</blockquote>
<iframe src="//player.bilibili.com/player.html?aid=968019810&bvid=BV1Ep4y197JA&cid=187553574&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" height="560" width="780"> </iframe>
<h2 id="‰∏Ä„ÄÅÂÆâË£ÖÂâçÊèê" tabindex="-1">‰∏Ä„ÄÅÂÆâË£ÖÂâçÊèê <a class="header-anchor" href="#‰∏Ä„ÄÅÂÆâË£ÖÂâçÊèê" aria-label="Permalink to &quot;‰∏Ä„ÄÅÂÆâË£ÖÂâçÊèê&quot;"></a></h2>
<h3 id="_1-1-Áâ©ÁêÜdgÂèÇÊï∞" tabindex="-1">1.1 Áâ©ÁêÜDGÂèÇÊï∞ <a class="header-anchor" href="#_1-1-Áâ©ÁêÜdgÂèÇÊï∞" aria-label="Permalink to &quot;1.1 Áâ©ÁêÜDGÂèÇÊï∞&quot;"></a></h3>
<table tabindex="0">
<thead>
<tr>
<th>HOSTNAME</th>
<th>IP</th>
<th>DB_NAME</th>
<th>DB_UNIQUE_NAME</th>
<th>INSTANCE_NAME</th>
<th>SERVICE_NAME</th>
<th>TNSNAME</th>
</tr>
</thead>
<tbody>
<tr>
<td>dg1</td>
<td>192.168.169.220</td>
<td>prod</td>
<td>uni_dg1</td>
<td>prod</td>
<td>dg1</td>
<td>uni_dg1</td>
</tr>
<tr>
<td>dg2</td>
<td>192.168.169.221</td>
<td>prod</td>
<td>uni_dg2</td>
<td>Prod_stdby</td>
<td>dg2</td>
<td>uni_dg2</td>
</tr>
</tbody>
</table>
<h3 id="_1-2-Êñá‰ª∂Áâ©ÁêÜË∑ØÂæÑ" tabindex="-1">1.2 Êñá‰ª∂Áâ©ÁêÜË∑ØÂæÑ <a class="header-anchor" href="#_1-2-Êñá‰ª∂Áâ©ÁêÜË∑ØÂæÑ" aria-label="Permalink to &quot;1.2 Êñá‰ª∂Áâ©ÁêÜË∑ØÂæÑ&quot;"></a></h3>
<table tabindex="0">
<thead>
<tr>
<th>datafile</th>
<th>controlfile</th>
<th>logfile</th>
<th>archivelog</th>
<th>auditfile</th>
</tr>
</thead>
<tbody>
<tr>
<td>/u01/oradata/prod</td>
<td>/u01/oradata/prod /u01/fast_recovery_area/prod</td>
<td>/u01/oradata/prod</td>
<td>/u01/arch</td>
<td>/u01/admin/prod/adump</td>
</tr>
<tr>
<td>/u01/oradata/prod_stdby</td>
<td>/u01/oradata/prod_stdby /u01/fast_recovery_area/prod</td>
<td>/u01/oradata/prod_stdby</td>
<td>/u01/arch</td>
<td>/u01/admin/prod_stdby/adump</td>
</tr>
</tbody>
</table>
<h2 id="‰∫å„ÄÅÊúçÂä°Âô®ÈÖçÁΩÆ‰øÆÊîπ" tabindex="-1">‰∫å„ÄÅÊúçÂä°Âô®ÈÖçÁΩÆ‰øÆÊîπ <a class="header-anchor" href="#‰∫å„ÄÅÊúçÂä°Âô®ÈÖçÁΩÆ‰øÆÊîπ" aria-label="Permalink to &quot;‰∫å„ÄÅÊúçÂä°Âô®ÈÖçÁΩÆ‰øÆÊîπ&quot;"></a></h2>
<h3 id="_2-1-ÈÖçÁΩÆÁΩëÁªú" tabindex="-1">2.1 ÈÖçÁΩÆÁΩëÁªú <a class="header-anchor" href="#_2-1-ÈÖçÁΩÆÁΩëÁªú" aria-label="Permalink to &quot;2.1 ÈÖçÁΩÆÁΩëÁªú&quot;"></a></h3>
<p>‰∏ªÂ∫ìdg1:</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[root@dg1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]# vi /etc/hosts</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[root@dg1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]# scp /etc/hosts dg2:/etc/</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">The</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> authenticity</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> host</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'dg2 (192.168.169.201)'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> can't be established.</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">RSA key fingerprint is 26:5c:d2:36:66:2b:e2:b3:12:0d:c4:fb:a6:44:97:7b.</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">Are you sure you want to continue connecting (yes/no)? yes</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">Warning: Permanently added 'dg2,192.168.169.201' (RSA) to the list of known hosts.</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">root@dg2's</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> password:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 123456</span></span></code></pre>
</div><h3 id="_2-2-‰øÆÊîπÂ§áÂ∫ìÂÆû‰æãÂêç" tabindex="-1">2.2 ‰øÆÊîπÂ§áÂ∫ìÂÆû‰æãÂêç <a class="header-anchor" href="#_2-2-‰øÆÊîπÂ§áÂ∫ìÂÆû‰æãÂêç" aria-label="Permalink to &quot;2.2 ‰øÆÊîπÂ§áÂ∫ìÂÆû‰æãÂêç&quot;"></a></h3>
<p>Â§áÂ∫ìdg2:</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[root@dg2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]# cat /etc/hosts</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">127.0.0.1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   localhost</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> localhost.localdomain</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> localhost4</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> localhost4.localdomain4</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">192.168.169.200</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dg1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">192.168.169.201</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dg2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[root@dg2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]# su - oracle</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[oracle@dg2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ vi .bash_profile </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[oracle@dg2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ source .bash_profile </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[oracle@dg2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ env </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> SID</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">ORACLE_SID</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">prod_stdby</span></span></code></pre>
</div><h3 id="_2-3-Âª∫Á´ãÂ§áÂ∫ìÁõÆÂΩï" tabindex="-1">2.3 Âª∫Á´ãÂ§áÂ∫ìÁõÆÂΩï <a class="header-anchor" href="#_2-3-Âª∫Á´ãÂ§áÂ∫ìÁõÆÂΩï" aria-label="Permalink to &quot;2.3 Âª∫Á´ãÂ§áÂ∫ìÁõÆÂΩï&quot;"></a></h3>
<p>Â§áÂ∫ìdg2:</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[oracle@dg2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ mkdir -p /u01/oradata/prod_stdby</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[oracle@dg2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ mkdir -p /u01/arch</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[oracle@dg2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ mkdir -p /u01/fast_recovery_area/prod_stdby/</span></span></code></pre>
</div><h2 id="‰∏â„ÄÅÂª∫Á´ãÁâ©ÁêÜdg" tabindex="-1">‰∏â„ÄÅÂª∫Á´ãÁâ©ÁêÜDG <a class="header-anchor" href="#‰∏â„ÄÅÂª∫Á´ãÁâ©ÁêÜdg" aria-label="Permalink to &quot;‰∏â„ÄÅÂª∫Á´ãÁâ©ÁêÜDG&quot;"></a></h2>
<h3 id="_3-1-‰∏ªÂ∫ìÂº∫Âà∂ËÆ∞ÂΩïÊó•Âøó" tabindex="-1">3.1 ‰∏ªÂ∫ìÂº∫Âà∂ËÆ∞ÂΩïÊó•Âøó <a class="header-anchor" href="#_3-1-‰∏ªÂ∫ìÂº∫Âà∂ËÆ∞ÂΩïÊó•Âøó" aria-label="Permalink to &quot;3.1 ‰∏ªÂ∫ìÂº∫Âà∂ËÆ∞ÂΩïÊó•Âøó&quot;"></a></h3>
<p>‰∏ªÂ∫ìdg1:</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[oracle@dg1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ sqlplus / as sysdba</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">select</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> log_mode,force_logging</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> v</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">$database;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">LOG_MODE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     FOR</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">------------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   ---</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">NOARCHIVELOG</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> NO</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">alter</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> database</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> force</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> logging</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">select</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> log_mode,force_logging</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> v</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">$database;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">LOG_MODE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     FOR</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">------------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   ---</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">NOARCHIVELOG</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> YES</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">shutdown</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> immediate</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">startup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mount</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">alter</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> database</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> archivelog</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">alter</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> database</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> open</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">select</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> log_mode,force_logging</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> v</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">$database;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">LOG_MODE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     FOR</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">------------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   ---</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ARCHIVELOG</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    YES</span></span></code></pre>
</div><h3 id="_3-2-ÈÖçÁΩÆ‰∏ªÂ§áÁõëÂê¨" tabindex="-1">3.2 ÈÖçÁΩÆ‰∏ªÂ§áÁõëÂê¨ <a class="header-anchor" href="#_3-2-ÈÖçÁΩÆ‰∏ªÂ§áÁõëÂê¨" aria-label="Permalink to &quot;3.2 ÈÖçÁΩÆ‰∏ªÂ§áÁõëÂê¨&quot;"></a></h3>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[oracle@dg1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ cd /u01/oracle/network/admin/</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[oracle@dg1 admin]$ vi tnsnames.ora </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                    </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">uni_dg1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">DESCRIPTION</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ADDRESS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (PROTOCOL </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> TCP</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">HOST</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dg1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">PORT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1521</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">CONNECT_DATA</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">      (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SERVER</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> DEDICATED</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">      (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SERVICE_NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> uni_dg1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    )</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  )</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">uni_dg2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">DESCRIPTION</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ADDRESS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (PROTOCOL </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> TCP</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">HOST</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dg2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">PORT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1521</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">CONNECT_DATA</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">      (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SERVER</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> DEDICATED</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">      (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SERVICE_NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> uni_dg2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    )</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  )</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[oracle@dg1 admin]$ scp ./tnsnames.ora dg2:/u01/oracle/network/admin/</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">The</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> authenticity</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> host</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'dg2 (192.168.169.221)'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> can't be established.</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">RSA key fingerprint is 26:5c:d2:36:66:2b:e2:b3:12:0d:c4:fb:a6:44:97:7b.</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">Are you sure you want to continue connecting (yes/no)? yes</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">Warning: Permanently added 'dg2,192.168.169.221' (RSA) to the list of known hosts.</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">oracle@dg2's</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> password:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Permission</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> denied,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> please</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> try</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> again.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">oracle@dg2</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">'s password: </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Permission denied, please try again.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">oracle@dg2'</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> password:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tnsnames.ora</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[oracle@dg2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ cd /u01/oracle/network/admin/</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[oracle@dg2 admin]$ cat tnsnames.ora</span></span></code></pre>
</div><h3 id="_3-3-ÈÖçÁΩÆ‰∏ªÂ∫ì‰ø°ÊÅØ" tabindex="-1">3.3 ÈÖçÁΩÆ‰∏ªÂ∫ì‰ø°ÊÅØ <a class="header-anchor" href="#_3-3-ÈÖçÁΩÆ‰∏ªÂ∫ì‰ø°ÊÅØ" aria-label="Permalink to &quot;3.3 ÈÖçÁΩÆ‰∏ªÂ∫ì‰ø°ÊÅØ&quot;"></a></h3>
<p>‰∏ªÂ∫ìdg1:</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>SQL> create pfile='/home/oracle/dg1_spfile' from spfile;</span></span>
<span class="line"><span>SQL> exit</span></span>
<span class="line"><span>[oracle@dg1 ~]$ vi dg1_spfile </span></span>
<span class="line"><span>DB_UNIQUE_NAME=uni_dg1 LOG_ARCHIVE_CONFIG='DG_CONFIG=(uni_dg1,uni_dg2)'</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>LOG_ARCHIVE_DEST_1='LOCATION=/u01/arch/ VALID_FOR=(ALL_LOGFILES,ALL_ROLES) DB_UNIQUE_NAME=uni_dg1'</span></span>
<span class="line"><span>LOG_ARCHIVE_DEST_2='SERVICE=uni_dg2 ASYNC VALID_FOR=(ONLINE_LOGFILES,PRIMARY_ROLE) DB_UNIQUE_NAME=uni_dg2'</span></span>
<span class="line"><span>LOG_ARCHIVE_DEST_STATE_1=ENABLE</span></span>
<span class="line"><span>LOG_ARCHIVE_DEST_STATE_2=ENABLE</span></span>
<span class="line"><span></span></span>
<span class="line"><span>FAL_SERVER=uni_dg2</span></span>
<span class="line"><span>DB_FILE_NAME_CONVERT='/u01/oradata/prod_stdby','/u01/oradata/prod'</span></span>
<span class="line"><span>LOG_FILE_NAME_CONVERT='/u01/oradata/prod_stdby','/u01/oradata/prod'</span></span>
<span class="line"><span>STANDBY_FILE_MANAGEMENT=AUTO</span></span>
<span class="line"><span>[oracle@dg1 ~]$ cd /u01/</span></span>
<span class="line"><span>[oracle@dg1 u01]$ mkdir arch</span></span>
<span class="line"><span>[oracle@dg1 u01]$ ll  |grep arch</span></span>
<span class="line"><span>drwxr-xr-x  2 oracle oinstall 4096 Apr 22 18:19 arch</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[oracle@dg1 u01]$ sqlplus / as sysdba</span></span>
<span class="line"><span>SQL> shutdown immediate</span></span>
<span class="line"><span>[oracle@dg1 u01]$ sqlplus / as sysdba</span></span>
<span class="line"><span>SQL> startup force nomount pfile=/home/oracle/dg1_spfile</span></span>
<span class="line"><span>ORACLE instance started.</span></span>
<span class="line"><span>Total System Global Area  521936896 bytes</span></span>
<span class="line"><span>SQL> show parameter name</span></span>
<span class="line"><span></span></span>
<span class="line"><span>NAME         TYPE                             VALUE</span></span>
<span class="line"><span>-------------------------   -------------------------------    ---------------------------------------</span></span>
<span class="line"><span>cell_offloadgroup_name   string</span></span>
<span class="line"><span>db_file_name_convert        string                        /u01/oradata/prod_stdby, /u01/oradata/prod</span></span>
<span class="line"><span>db_name           string     prod</span></span>
<span class="line"><span>db_unique_name    string     uni_dg1</span></span>
<span class="line"><span>global_names          boolean    FALSE</span></span>
<span class="line"><span>instance_name          string     prod</span></span>
<span class="line"><span>lock_name_space          string</span></span>
<span class="line"><span>log_file_name_convert         string     /u01/oradata/prod_stdby, /u01/oradata/prod</span></span>
<span class="line"><span>processor_group_name   string</span></span>
<span class="line"><span>service_names          string     uni_dg1</span></span>
<span class="line"><span>SQL> create spfile from pfile='/home/oracle/dg1_spfile';</span></span>
<span class="line"><span>SQL> startup force</span></span>
<span class="line"><span>Database opened.</span></span>
<span class="line"><span>SQL> show parameter name</span></span>
<span class="line"><span></span></span>
<span class="line"><span>NAME         TYPE  VALUE</span></span>
<span class="line"><span>------------------------------------ ----------- ------------------------------</span></span>
<span class="line"><span>cell_offloadgroup_name       string</span></span>
<span class="line"><span>db_file_name_convert       string  /u01/oradata/prod_stdby, /u01/oradata/prod</span></span>
<span class="line"><span>db_name         string  prod</span></span>
<span class="line"><span>db_unique_name       string  uni_dg1</span></span>
<span class="line"><span>global_names        boolean  FALSE</span></span>
<span class="line"><span>instance_name        string  prod</span></span>
<span class="line"><span>lock_name_space        string</span></span>
<span class="line"><span>log_file_name_convert       string  /u01/oradata/prod_stdby, /u01/oradata/prod</span></span>
<span class="line"><span>processor_group_name      string</span></span>
<span class="line"><span>service_names        string  uni_dg1</span></span>
<span class="line"><span>SQL> alter database create standby controlfile as '/home/oracle/stdby_ctrl_file.bak';</span></span>
<span class="line"><span>Database altered.</span></span>
<span class="line"><span>SQL> exit</span></span>
<span class="line"><span>Disconnected from Oracle Database 11g Enterprise Edition Release 11.2.0.4.0 - 64bit Production</span></span>
<span class="line"><span>With the Partitioning, OLAP, Data Mining and Real Application Testing options</span></span>
<span class="line"><span>[oracle@dg1 u01]$ cd</span></span>
<span class="line"><span>[oracle@dg1 ~]$ ll |grep ctrl</span></span>
<span class="line"><span>-rw-r----- 1 oracle oinstall 9748480 Apr 22 18:34 stdby_ctrl_file.bak</span></span>
<span class="line"><span>[oracle@dg1 ~]$ cd /u01/oradata/prod/</span></span>
<span class="line"><span>[oracle@dg1 prod]$ ll</span></span>
<span class="line"><span>total 3531072</span></span>
<span class="line"><span>-rw-r----- 1 oracle oinstall    9748480 Apr 22 18:36 control01.ctl</span></span>
<span class="line"><span>-rw-r----- 1 oracle oinstall  363077632 Apr 22 18:32 example01.dbf</span></span>
<span class="line"><span>-rw-r----- 1 oracle oinstall   52429312 Apr 22 18:36 redo01.log</span></span>
<span class="line"><span>-rw-r----- 1 oracle oinstall   52429312 Apr 22 18:32 redo02.log</span></span>
<span class="line"><span>-rw-r----- 1 oracle oinstall   52429312 Apr 22 18:32 redo03.log</span></span>
<span class="line"><span>-rw-r----- 1 oracle oinstall  702554112 Apr 22 18:32 sysaux01.dbf</span></span>
<span class="line"><span>-rw-r----- 1 oracle oinstall  796925952 Apr 22 18:32 system01.dbf</span></span>
<span class="line"><span>-rw-r----- 1 oracle oinstall   38805504 Apr 22 18:32 temp01.dbf</span></span>
<span class="line"><span>-rw-r----- 1 oracle oinstall 1428103168 Apr 22 18:32 test01.dbf</span></span>
<span class="line"><span>-rw-r----- 1 oracle oinstall  110108672 Apr 22 18:32 undotbs01.dbf</span></span>
<span class="line"><span>-rw-r----- 1 oracle oinstall    9183232 Apr 22 18:32 users01.dbf</span></span>
<span class="line"><span>[oracle@dg1 prod]$ scp * dg2:/u01/oradata/prod_stdby/</span></span>
<span class="line"><span>[oracle@dg1 dbs]$  scp orapwprod /u01/oracle/dbs/orapwprod_stdby </span></span>
<span class="line"><span>[oracle@dg1 dbs]$  scp orapwprod oracle@dg2:/u01/oracle/dbs/orapwprod_stdby</span></span></code></pre>
</div><p>Â§áÂ∫ìdg2Ôºö</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[oracle@dg2 prod_stdby]$ cd /u01/oradata/prod_stdby/</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[oracle@dg2 prod_stdby]$ ll </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> control</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">-rw-r-----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oinstall</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    9748480</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Apr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 22</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 18:39</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> control01.ctl</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[oracle@dg2 prod_stdby]$ rm control01.ctl</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[oracle@dg2 prod_stdby]$ cd /u01/fast_recovery_area/prod/ PROD/ </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[oracle@dg2 prod_stdby]$ cd /u01/fast_recovery_area/prod/</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[oracle@dg2 prod]$ ll</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">total</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 9520</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">-rw-r-----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oinstall</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 9748480</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Apr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 22</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 17:30</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> control02.ctl</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[oracle@dg2 prod]$ rm control02.ctl</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[oracle@dg1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ sqlplus / as sysdba</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">shutdown</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> immediate</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ORACLE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> instance</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> shut</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> down.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[oracle@dg1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ scp stdby_ctrl_file.bak dg2:/u01/oradata/prod_stdby/control01.ctl</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[oracle@dg1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ cd /u01/oradata/prod/ </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[oracle@dg1 prod]$ scp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> dg2:/u01/oradata/prod_stdby/</span></span></code></pre>
</div><p>Â§áÂ∫ìdg2:</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[oracle@dg2 prod_stdby]$ ll</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">total</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 3521564</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">-rw-r--r--</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oinstall</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">       1168</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Apr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 22</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 18:44</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> control01.ctl</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">-rw-r--r--</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oinstall</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">       1168</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Apr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 22</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 18:44</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dg1_spfile</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">-rw-r-----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oinstall</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  363077632</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Apr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 22</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 18:39</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> example01.dbf</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">-rw-r-----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oinstall</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   52429312</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Apr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 22</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 18:39</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> redo01.log</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">-rw-r-----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oinstall</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   52429312</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Apr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 22</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 18:39</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> redo02.log</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">-rw-r-----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oinstall</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   52429312</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Apr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 22</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 18:39</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> redo03.log</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">-rw-r-----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oinstall</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  702554112</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Apr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 22</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 18:39</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> sysaux01.dbf</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">-rw-r-----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oinstall</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  796925952</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Apr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 22</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 18:39</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> system01.dbf</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">-rw-r-----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oinstall</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   38805504</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Apr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 22</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 18:39</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> temp01.dbf</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">-rw-r-----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oinstall</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1428103168</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Apr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 22</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 18:40</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> test01.dbf</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">-rw-r-----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oinstall</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  110108672</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Apr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 22</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 18:40</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> undotbs01.dbf</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">-rw-r-----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oinstall</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    9183232</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Apr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 22</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 18:40</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> users01.d</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[oracle@dg1 prod]$ cd</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[oracle@dg1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ scp stdby_ctrl_file.bak dg2:/u01/oradata/prod_stdby/control01.ctl</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">oracle@dg2</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">'s password: </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">stdby_ctrl_file.bak                           100% 9520KB   9.3MB/s   00:00</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">[oracle@dg1 ~]$ scp stdby_ctrl_file.bak dg2:/u01/fast_recovery_area/prod_stdby/control02.ctl</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">oracle@dg2'</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> password:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">stdby_ctrl_file.bak</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                   100%</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 9520KB</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   9.3MB/s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   00:00</span></span></code></pre>
</div><h3 id="_3-4-ÈÖçÁΩÆÂ§áÂ∫ì‰ø°ÊÅØ" tabindex="-1">3.4 ÈÖçÁΩÆÂ§áÂ∫ì‰ø°ÊÅØ <a class="header-anchor" href="#_3-4-ÈÖçÁΩÆÂ§áÂ∫ì‰ø°ÊÅØ" aria-label="Permalink to &quot;3.4 ÈÖçÁΩÆÂ§áÂ∫ì‰ø°ÊÅØ&quot;"></a></h3>
<p>Â§áÂ∫ìdg2:</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[oracle@dg2 dbs]$ cd</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[oracle@dg2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ vi .bash_profile </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[oracle@dg2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ env </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> SID</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">ORACLE_SID</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">prod_stdby</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[oracle@dg2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ cd $ORACLE_HOME/dbs</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[oracle@dg2 dbs]$ ll</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">total</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 24</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">-rw-rw----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oinstall</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1544</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Apr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 22</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 17:38</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> hc_prod.dat</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">-rw-r--r--</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oinstall</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 2851</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> May</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 15</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  2009</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> init.ora</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">-rw-r--r--</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oinstall</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  896</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Apr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 16</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 22:31</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> initprod.ora</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">-rw-r-----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oinstall</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   24</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Mar</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  8</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 08:50</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> lkPROD</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">-rw-r-----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oinstall</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1536</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Mar</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  8</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 08:53</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> orapwprod</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">-rw-r-----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oinstall</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 2560</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Apr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 22</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 17:30</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> spfileprod.ora</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[oracle@dg2 dbs]$ cp initprod.ora initprod_stdby.ora </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[oracle@dg2 dbs]$ vi initprod_stdby.ora</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.db_recovery_file_dest</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'/u01/fast_recovery_area'</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.db_recovery_file_dest_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">4385144832</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.diagnostic_dest</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'/u01'</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.dispatchers</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'(PROTOCOL=TCP) (SERVICE=prodXDB)'</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.memory_target</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">511705088</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.nls_language</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'SIMPLIFIED CHINESE'</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.nls_territory</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'CHINA'</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.open_cursors</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">300</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.processes</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">150</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.remote_login_passwordfile</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'EXCLUSIVE'</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.undo_tablespace</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'UNDOTBS1'</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">DB_UNIQUE_NAME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">uni_dg2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">LOG_ARCHIVE_CONFIG</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'DG_CONFIG=(uni_dg1,uni_dg2)'</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">LOG_ARCHIVE_DEST_1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> 'LOCATION=/u01/arch/</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  VALID_FOR=(ALL_LOGFILES,ALL_ROLES)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  DB_UNIQUE_NAME=uni_dg2'</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">LOG_ARCHIVE_DEST_2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> 'SERVICE=uni_dg1 ASYNC</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  VALID_FOR=(ONLINE_LOGFILES,PRIMARY_ROLE)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  DB_UNIQUE_NAME=uni_dg1'</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">LOG_ARCHIVE_DEST_STATE_1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">ENABLE</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">LOG_ARCHIVE_DEST_STATE_2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">ENABLE</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">FAL_SERVER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">uni_dg1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">DB_FILE_NAME_CONVERT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'/u01/oradata/prod','/u01/oradata/prod_stdby'</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">LOG_FILE_NAME_CONVERT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'/u01/oradata/prod','/u01/oradata/prod_stdby'</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">STANDBY_FILE_MANAGEMENT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">AUTO</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">alter</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> system</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> log_archive_dest_1='LOCATION=/u01/ora_arch VALID_FOR=(ALL_LOGFILES,ALL_ROLES) DB_UNIQUE_NAME=primary'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> scope=both</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> db_unique_name=primary</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[oracle@dg2 prod_stdby]$ cd /u01/</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[oracle@dg2 u01]$ ll </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ^d</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> arch</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">drwxr-xr-x</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oinstall</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 4096</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Apr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 22</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 19:03</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> arch</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[oracle@dg2 u01]$ sqlplus / as sysdba</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">startup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> force</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> nomount</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> pfile=/u01/oracle/dbs/initprod_stdby.ora</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ORACLE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> instance</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> started.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Total</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> System</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Global</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Area</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  509411328</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> bytes</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Fixed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Size</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">      2254704</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> bytes</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Variable</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Size</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    377489552</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> bytes</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Database</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Buffers</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   121634816</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> bytes</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Redo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Buffers</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">      8032256</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> bytes</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">create</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> spfile</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> pfile</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">File</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> created.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">startup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> force</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mount</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ORACLE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> instance</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> st</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> SQ</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">L</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> arted.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Total</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> System</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Global</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Area</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  509411328</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> bytes</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Fixed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Size</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">      2254704</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> bytes</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Variable</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Size</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    377489552</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> bytes</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Database</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Buffers</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   121634816</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> bytes</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Redo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Buffers</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">      8032256</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> bytes</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Database</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mounted.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">startup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> force</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">alter</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> database</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> open</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;   </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">recover</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> managed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> standby</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> database</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> disconnect</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> session</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span></code></pre>
</div><h3 id="_3-4-ÊµãËØïÊó•ÂøóÂàáÊç¢" tabindex="-1">3.4 ÊµãËØïÊó•ÂøóÂàáÊç¢ <a class="header-anchor" href="#_3-4-ÊµãËØïÊó•ÂøóÂàáÊç¢" aria-label="Permalink to &quot;3.4 ÊµãËØïÊó•ÂøóÂàáÊç¢&quot;"></a></h3>
<p>‰∏ªÂ∫ìdg1:</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">select</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tablespace_name,file_name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dba_data_files</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">TABLESPACE_NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                FILE_NAME</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">------------------------------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --------------------------------------------------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">EXAMPLE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                        /u01/oradata/prod/example01.dbf</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">USERS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                          /u01/oradata/prod/users01.dbf</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">UNDOTBS1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                       /u01/oradata/prod/undotbs01.dbf</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SYSAUX</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                         /u01/oradata/prod/sysaux01.dbf</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SYSTEM</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                         /u01/oradata/prod/system01.dbf</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">create</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tablespace</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> test1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> datafile</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> '/u01/oradata/prod/test101.dbf'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> size</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 5m</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">create</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> table</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> scott.test</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">id</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">tablespace</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> test1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">insert</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> into</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> scott.test</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> values</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">commit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">alter</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> system</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> switch</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> logfile</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span></code></pre>
</div><p>Â§áÂ∫ìdg2:</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">select</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tablespace_name,file_name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dba_data_files</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> where</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tablespace_name=‚ÄôTEST1‚Äô</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">select</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> *</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> scott.test</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span></code></pre>
</div>]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Oracle 11g RAC ÈÉ®ÁΩ≤Êê≠Âª∫]]></title>
            <link>https://askaric.com/zh/work/oracle/Start-OracleRAC.html</link>
            <guid>https://askaric.com/zh/work/oracle/Start-OracleRAC.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[# Oracle 11g RAC ÈÉ®ÁΩ≤Êê≠Âª∫

> [DBNEST -- Bilibili RAC Âü∫Á°ÄÊê≠Âª∫ËßÜÈ¢ëÂú∞ÂùÄ](https://www.bilibili.com/video/BV1ZT4y157NN?from=search&seid=17237800447886927935&spm_id_from=333.337.0.0)

<iframe src="//player.bilibili.com/player.html?aid=926769884&bvid=BV1ZT4y157NN&cid=228088873&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" height="560" width="780"> </iframe>

| HOSTNAME | ÂÖ¨ÁΩëIP | ‰∏ªÊú∫Âêç | ÁßÅÁΩëIP | VIP | SCANIP |
| - | - | - | - | - | - |
| node1 | 192.168.174.11 | Prod1 | 10.10.10.1 | 192.168.174.111 | 192.168.174.24
| node2 | 192.168.174.12 | Prod2 | 10.10.10.2 | 192.168.174.121 | 192.168.174.24

## ‰∏Ä„ÄÅÂàõÂª∫ËôöÊãüÊú∫ÂèäÊê≠Âª∫Êìç‰ΩúÁ≥ªÁªü

### 1.1 ÂàõÂª∫ËôöÊãüÊú∫

ËôöÊãüÊú∫ÁöÑÂàõÂª∫ ÈúÄË¶ÅÂàõÂª∫‰∏§‰∏™ËôöÊãüÊú∫ÈÖçÁΩÆÁõ∏ÂêåÂèñ‰∏çÂêåÁöÑÂêçÂ≠óÊù•Âå∫ÂàÜ„ÄÇ
ÊâìÂºÄvmwareÁÇπÂáªÂàõÂª∫Êñ∞ÁöÑËôöÊãüÊú∫„ÄÇ

![01](./Oracle-RAC/01.png)  

![02](./Oracle-RAC/02.png)

![03](./Oracle-RAC/03.png)

ÈÄâÊã©redhat 6 ÁâàÊú¨64‰Ωç  

![04](./Oracle-RAC/04.png)

Ê≠§Â§ÑÊúÄÂ•ΩÂú®windows‰∏äÂàõÂª∫Â•Ω‰∏Ä‰∏™ÁõÆÂΩïÊù•ÊîæÈõÜÁæ§Êñπ‰æøÂå∫ÂàÜ  

![05](./Oracle-RAC/05.png)  

![06](./Oracle-RAC/06.png)  

![07](./Oracle-RAC/07.png)  

![08](./Oracle-RAC/08.png)  

![09](./Oracle-RAC/09.png)  

![10](./Oracle-RAC/10.png)  

![11](./Oracle-RAC/11.png)  

![12](./Oracle-RAC/12.png)  

![13](./Oracle-RAC/13.png)  

![14](./Oracle-RAC/14.png)  

![15](./Oracle-RAC/15.png)  

![16](./Oracle-RAC/16.png)  

![17](./Oracle-RAC/17.png)  

![18](./Oracle-RAC/18.png)  

![19](./Oracle-RAC/19.png)  

![20](./Oracle-RAC/20.png)  

![21](./Oracle-RAC/21.png)  

![22](./Oracle-RAC/22.png)  

![23](./Oracle-RAC/23.png)  

![24](./Oracle-RAC/24.png)  

![25](./Oracle-RAC/25.png)  

![26](./Oracle-RAC/26.png)  

![27](./Oracle-RAC/27.png)  

![28](./Oracle-RAC/28.png)  

![29](./Oracle-RAC/29.png)  

![30](./Oracle-RAC/30.png)

![31](./Oracle-RAC/31.png)  

![32](./Oracle-RAC/32.png)

![33](./Oracle-RAC/33.png)  

![34](./Oracle-RAC/34.png)

### 1.2 ÈÖçÁΩÆËôöÊãüÊú∫ÁΩëÂç°

ÁÇπÂáªËôöÊãüÁΩëÁªúÁºñËæëÂô®ÔºåÂáÜÂ§áÊ∑ªÂä†ÁΩëÂç°Ôºõ

![35](./Oracle-RAC/35.png)

ÁÇπÂáªÊõ¥ÊîπËÆæÁΩÆÔºõ
![36](./Oracle-RAC/36.png)

ÁÇπÂáªÊ∑ªÂä†ÁΩëÁªúÔºåÊ∑ªÂä†ËôöÊãüÁΩëÂç°Ôºõ
![37](./Oracle-RAC/37.png)  

ÁÇπÂáªÁ°ÆÂÆöÔºõ
![38](./Oracle-RAC/38.png)  

‰øÆÊîπÂ≠êÁΩëIPËá≥ËßÑÂàíÁöÑÂÖ¨ÁΩëÂú∞ÂùÄ„ÄÇ
ÊåâÁÖß‰∏äËø∞Êìç‰ΩúÔºåÂàõÂª∫ÂÜÖÁΩëÁΩëÂç°ÔºåÂπ∂‰øÆÊîπIPÊàëÂú∞ÂùÄ‰∏∫10.10.10.1Ôºõ
![39](./Oracle-RAC/39.png)  

ÁÇπÂáªvmwareÁöÑÁºñËæëËôöÊãüÊú∫ËÆæÁΩÆ  
![40](./Oracle-RAC/40.png)  

ÈÄâ‰∏≠ÁΩëÁªúÈÄÇÈÖçÂô®ÁÇπÂáªÊ∑ªÂä†  
![41](./Oracle-RAC/41.png)  

ÈÄâÊã©ÁΩëÁªúÈÄÇÈÖçÂô®ÁÇπÂáªÂÆåÊàêÂç≥ÂèØÂÆåÊàêÊ∑ªÂä†  
![42](./Oracle-RAC/42.png)  

Êñ∞Ê∑ªÂä†ÁöÑÁΩëÂç°ÈÄâÊã©‰∏∫Ê°•Êé•Ê®°ÂºèÁÇπÂáªÁ°ÆÂÆö‰øùÂ≠òÊõ¥Êîπ  
![43](./Oracle-RAC/43.png)  

### 1.3 ÂàõÂª∫ÂÖ±‰∫´Á£ÅÁõò

ËøõÂÖ•windowsÁöÑcmdÂëΩ‰ª§Ë°åÁ™óÂè£Âà∞ÂÆâË£ÖVMwareËΩØ‰ª∂ÁöÑÁõÆÂΩïÊâßË°åÂ¶Ç‰∏ãÂëΩ‰ª§ÂàõÂª∫ÂÖ±‰∫´Á£ÅÁõòÔºåÂ∞±ÊòØ‰∏§Âè∞Êú∫Âô®ÂÖ±Áî®ÁöÑÁ£ÅÁõòÊâÄ‰ª•Âú®Âè¶‰∏ÄÂè∞ËôöÊú∫‰∏äÊó†ÈúÄÂÜçÊ¨°ÂàõÂª∫‰∫î‰∏™„ÄÇ
ÂàõÂª∫ÁöÑÁ£ÅÁõòÊúÄÂ•ΩÂçïÁã¨ÊîæÂà∞‰∏Ä‰∏™ÁõÆÂΩï‰∏≠Êñπ‰æøÂêéÁª≠ÁöÑÈÖçÁΩÆ

```
cd /d D:\VMware15
vmware-vdiskmanager.exe -c -s 2Gb -a lsilogic -t 2 "D:\JanRAC\sharedisk\OCR01.vmdk"
vmware-vdiskmanager.exe -c -s 2Gb -a lsilogic -t 2 "D:\JanRAC\sharedisk\OCR02.vmdk"
vmware-vdiskmanager.exe -c -s 2Gb -a lsilogic -t 2 "D:\JanRAC\sharedisk\OCR03.vmdk"
vmware-vdiskmanager.exe -c -s 15Gb -a lsilogic -t 2 "D:\JanRAC\sharedisk\DATA1.vmdk"
vmware-vdiskmanager.exe -c -s 5Gb -a lsilogic -t 2 "D:\JanRAC\sharedisk\ARCH.vmdk"
```

Á£ÅÁõòÂàõÂª∫ÂÆåÊàêÂêéÂÜçÊ¨°ËøõÂÖ•VMwareÁÇπÂáªÁºñËæëÁÇπÂáªÊ∑ªÂä†
![44](./Oracle-RAC/44.png)  

ÈÄâÊã©Á°¨Áõò
![45](./Oracle-RAC/45.png)  
![46](./Oracle-RAC/46.png)  

ÈÄâÊã©‰ΩøÁî®Áé∞ÊúâÁöÑÁ£ÅÁõò
![47](./Oracle-RAC/47.png)  

ËøõÂÖ•ÂàöÊâçÂª∫Á´ãÁöÑÁ£ÅÁõòÁõÆÂΩï‰∏≠ÈÄâÊã©Â¶Ç‰∏ãÂõæÊâÄÁ§∫ÁöÑÁõòÔºà‰∏çË¶ÅÈÄâflatÁªìÂ∞æÁöÑÔºâ
![48](./Oracle-RAC/48.png)  
![49](./Oracle-RAC/49.png)  
![50](./Oracle-RAC/50.png)  
![51](./Oracle-RAC/51.png)  
![52](./Oracle-RAC/52.png)  

ÊåâÁÖßÂêåÊ†∑ÁöÑÊñπÊ≥ïÊää‰∫î‰∏™ÁõòÈÉΩÂä†Âà∞‰∏äÈù¢„ÄÇ
ÂÖ®ÈÉ®ÂÆåÊàêÂêéÁÇπÂáªÁ°ÆËÆ§‰ΩøÂÖ∂ÁîüÊïà

![53](./Oracle-RAC/53.png)  
![54](./Oracle-RAC/54.png)  

ÊâæÂà∞‰∏§Âè∞ËôöÊãüÊú∫ÁöÑÈÖçÁΩÆÊñá‰ª∂Áî®ËÆ∞‰∫ãÊú¨Ê®°ÂºèÊâìÂºÄÂÆÉÂä†ÂÖ•‰∏§Ë°åÂèÇÊï∞„ÄÇ

Â∞Ü‰∏ãÈù¢ÈÖçÁΩÆÁ≤òË¥¥Ëá≥VMXÊñá‰ª∂‰∏≠Ôºå‰∏§‰∏™ËäÇÁÇπÂùáÊìç‰Ωú„ÄÇ

```
disk.locking="FALSE"
disk.EnableUUID = "TRUE"‚ÄÉ
```

### 1.4 Êê≠Âª∫linuxÊìç‰ΩúÁ≥ªÁªü

ÁÇπÂáªËôöÊãüÊú∫ËÆæÁΩÆ
![55](./Oracle-RAC/55.png)

ÈÄâÊã©ÂÆâË£ÖÂÖâÁõòÂêéÁÇπÂáªÁ°ÆËÆ§  
![56](./Oracle-RAC/56.png)  

ÁÇπÂáªÂºÄÂêØÊ¨°ËôöÊãüÊú∫
![57](./Oracle-RAC/57.png)  

ÁÇπÂáªÂõûËΩ¶
![58](./Oracle-RAC/58.png)  
![59](./Oracle-RAC/59.png)  
![60](./Oracle-RAC/60.png)  
![61](./Oracle-RAC/61.png)  
![62](./Oracle-RAC/62.png)  
![63](./Oracle-RAC/63.png)  

ÈÄâÊã©yes
![64](./Oracle-RAC/64.png)  

‰∏ªÊú∫ÂêçÂ≠ó
![65](./Oracle-RAC/65.png)  

Êó∂Âå∫ÈÄâÊã©‰∏äÊµ∑
![66](./Oracle-RAC/66.png)  

ËÆæÁΩÆÂØÜÁ†Å
![67](./Oracle-RAC/67.png)  

Á£ÅÁõòÂàÜÂå∫
![68](./Oracle-RAC/68.png)  

ÁÇπÂáªcreate
![69](./Oracle-RAC/69.png)  

Ê≥®ÊÑèÂè™ÈÄâÊã©sdaÁõòËøõË°åÂàÜÂå∫ÂÖ∂‰ªñÁöÑÁõòÂãæÊéâÔºåÈ¶ñÂÖàÂä†‰∏Ä‰∏™/bootÂàÜÂå∫Â§ßÂ∞è200ÁÇπÂáªok
![70](./Oracle-RAC/70.png)  

Ê≥®ÊÑèÂè™ÈÄâÊã©sdaÁõòËøõË°åÂàÜÂå∫ÂÖ∂‰ªñÁöÑÁõòÂãæÊéâÔºåÂä†‰∏Ä‰∏™swapÂàÜÂå∫Â§ßÂ∞è2G
![71](./Oracle-RAC/71.png)  

Ê≥®ÊÑèÂè™ÈÄâÊã©sdaÁõòËøõË°åÂàÜÂå∫ÂÖ∂‰ªñÁöÑÁõòÂãæÊéâÔºåÊ†πÂàÜÂå∫Â§ßÂ∞è5G
![72](./Oracle-RAC/72.png)  

Ê≥®ÊÑèÂè™ÈÄâÊã©sdaÁõòËøõË°åÂàÜÂå∫ÂÖ∂‰ªñÁöÑÁõòÂãæÊéâÔºå/u01ÂàÜÂå∫Â∞ÜÂâ©‰∏ãÊâÄÊúâÁ©∫Èó¥ÂÖ®ÈÉ®ÂàÜÈÖçÁªô‰ªñ

![73](./Oracle-RAC/73.png)  
![74](./Oracle-RAC/74.png)  
![75](./Oracle-RAC/75.png)  
![76](./Oracle-RAC/76.png)  

ÁÇπÂáªrebootÂÆåÊàêÊìç‰ΩúÁ≥ªÁªüÁöÑÂÆâË£ÖÈáçÂêØÂêéËøõÂÖ•Êìç‰ΩúÁ≥ªÁªüÁïåÈù¢
![77](./Oracle-RAC/78.png)  

## ‰∫å„ÄÅÊìç‰ΩúÁ≥ªÁªüÈÖçÁΩÆ

### 2.1 Ê£ÄÊü•Êìç‰ΩúÁ≥ªÁªüËÆæÁΩÆ

‰∏§‰∏™ËôöÊú∫Ê†πÊçÆËá™Â∑±ÁöÑÁΩëÂç°‰ø°ÊÅØÈÖçÁΩÆÁΩëÂç°

```shell
vi /etc/sysconfig/network-script/ifcfg-eth0
DEVICE=eth0
#HWADDR=00:0C:29:93:4D:A6
TYPE=Ethernet
#UUID=58b202c7-754b-4cea-aedc-705e370c90b8
ONBOOT=yes
NM_CONTROLLED=yes
BOOTPROTO=static
IPADDR=192.168.174.11
NETMASK=255.255.255.0

vi /etc/sysconfig/network-script/ifcfg-eth1
DEVICE=eth1
#HWADDR=00:0C:29:93:4D:B0
TYPE=Ethernet
#UUID=5050a9fd-a783-4ddc-bc31-59cbe7be5d1d
ONBOOT=yes
NM_CONTROLLED=yes
BOOTPROTO=static
IPADDR=10.10.10.1
NETMASK=255.255.255.0
```

### 2.2 Ê£ÄÊü•Á≥ªÁªüÂ∫ì‰æùËµñ

ÈÖçÁΩÆyumÊ∫êÔºåÂπ∂ÂÆâË£Ö‰æùËµñÂåÖ

```shell
vi /etc/yum.repos.d/iso.repo
[iso]
name=iso
baseurl=file:///mnt
enabled=1
gpgcheck=0

mount /dev/cdrom /mnt
yum -y install binutils compat-libstdc++-33 glibc ksh libaio libgcc libstdc++ make compat-libcap1 gcc gcc-c++ glibc-devel libaio-devel libstdc++-devel sysstat
```

### 2.3 Êìç‰ΩúÁ≥ªÁªüÂÜÖÊ†∏ÂèÇÊï∞Ë∞ÉÊï¥

```shell
vi /etc/sysctl.conf
kernel.shmall = xxx  #Â°´ÂÖ•ÂëΩ‰ª§echo "`cat /proc/meminfo | grep "MemTotal" | awk '{print $2}'` / (`getconf PAGESIZE` / 1024)" | bc ÁöÑËøêË°åÁªìÊûú
kernel.shmmax = xxx  #Â°´ÂÖ•ÂëΩ‰ª§echo "`cat /proc/meminfo | grep "MemTotal" | awk '{print $2}'` * 1024 * 0.8" | bc  | sed 's#\..*$##' ÁöÑËøêË°åÁªìÊûú

kernel.shmmni = 4096 
kernel.sem = 250 32000 100 128 

fs.file-max = 6815744
fs.aio-max-nr = 1048576

net.ipv4.ip_local_port_range = 9000 65500 
net.core.rmem_default = 262144 
net.core.rmem_max = 4194304 
net.core.wmem_default = 262144 
net.core.wmem_max = 104857

vm.swappiness = 0
vm.dirty_background_ratio = 3
vm.dirty_ratio = 80
vm.dirty_expire_centisecs = 500
vm.dirty_writeback_centisecs = 100

sysctl -p   ‰ΩøÂèÇÊï∞ÁîüÊïà
```

### 2.4 ÂÖ≥Èó≠ SElinux„ÄÅÈò≤ÁÅ´Â¢ô

Ê†πÊçÆÂÆâË£ÖËßÑËåÉÔºåÊ≠§‰∏§È°πÂÜÖÂÆπÂ∫îËØ•Â∑≤ÁªèË¢´ÂÖ≥Èó≠
‰ΩøÁî®Â¶Ç‰∏ãÂëΩ‰ª§ÂÖ≥Èó≠Ôºö

```shell
sed -i 's/enforcing/disabled/g' /etc/selinux/config
setenforce 0

service iptables stop
chkconfig iptables off

service NetworkManager stop
chkconfig NetworkManager off
```

### 2.5 IPÂú∞ÂùÄÂàÜÈÖç

#### 2.5.1 ‰∏ªÊú∫Êñá‰ª∂ÈÖçÁΩÆ

1. ÊØè‰∏™ËäÇÁÇπÁöÑÂÖ¨ÁΩëÁΩëÂç°ÂêçÔºåÁßÅÁΩëÁΩëÂç°ÂêçÂ∫î‰øùÊåÅ‰∏ÄËá¥Ôºå‰æãÂ¶ÇÔºöÂú®ËäÇÁÇπ1ÂÖ¨ÁΩëÁΩëÂç°Âêç‰∏∫eth0ÔºåÁßÅÁΩëÁΩëÂç°Âêçeth1ÔºåÂàôËäÇÁÇπ2ÁöÑÂÖ¨2. ÁΩëÁΩëÂç°Âêç‰πüÂ∫î‰∏∫eth0ÔºåÁßÅÁΩëÁΩëÂç°ÂêçÂ∫î‰∏∫eth1„ÄÇ
Ê≥®ÊÑèÔºöÂêÑ‰∏™ËäÇÁÇπÁöÑÂêåÂêçÁΩëÂç°ÁöÑÈÖçÁΩÆÊñá‰ª∂‚Äú/etc/sysconfig/network-scripts/ifcfg-ÁΩëÂç°Âêç‚Äù‰πüÂ∫îÁõ∏ÂêåÔºÅ

vip/priv/scanÂëΩÂêçËßÑÂàôÂ¶Ç‰∏ãÔºö

```shell
<hostname>-vipÔºå‰ª£Ë°®VIP‰∏ªÊú∫ÂêçÔºõ
<hostname>-privÔºå‰ª£Ë°®priv‰∏ªÊú∫ÂêçÔºõ
<hostname>-scanÔºå‰ª£Ë°®scan‰∏ªÊú∫ÂêçÔºõ
```

ÈíàÂØπIPÂú∞ÂùÄÂàÜÈÖçÂ¶Ç‰∏ãÔºåÈúÄË¶ÅÂú®/etc/hostsÊñá‰ª∂‰∏≠Â¢ûÂä†‰ª•‰∏ãIPÂú∞ÂùÄËß£ÊûêÔºö

```shell
#PUBLIC
192.168.174.11    rac1
192.168.174.12    rac2
 
#PRIVATE
10.10.10.1    rac1-priv 
10.10.10.2    rac2-priv   

#VIP
192.168.174.111   rac1-vip
192.168.174.121   rac2-vip
192.168.174.24    rac-scan
```

#### 2.5.2 IpÂú∞ÂùÄÂàÜÈÖçÂ∫îÈÅµÂæ™Â¶Ç‰∏ãÂéüÂàô

Ôºà1Ôºâ Public ip,scan ip, vip ÂøÖÈ°ªÂú®Áõ∏ÂêåÁΩëÊÆµ
Ôºà2Ôºâ private ip ‰∏é‰∏äËø∞ip ‰∏çËÉΩÂú®Áõ∏ÂêåÁΩëÊÆµÔºõ

## ‰∏â„ÄÅÁî®Êà∑ÁéØÂ¢ÉÂèäÁõÆÂΩïÈÖçÁΩÆ

### 3.1 Áî®Êà∑Áõ∏ÂÖ≥ËÆæÁΩÆ

ÂàõÂª∫Áî®Êà∑ÂíåÁªÑ

```shell
groupadd -g 1000 oinstall
groupadd -g 1001 dba
groupadd -g 1002 oper
groupadd -g 1003 asmadmin
groupadd -g 1004 asmdba
groupadd -g 1005 asmoper
useradd -u 1001 -g oinstall -G dba,asmadmin,asmdba,asmoper grid
useradd -u 1002 -g oinstall -G dba,oper,asmadmin,asmdba oracle
echo grid |passwd --stdin grid
echo grid |passwd --stdin oracle
```

ÂàõÂª∫ÁõÆÂΩï

```shell
mkdir -p /u01/app/oraInventory
chown -R grid:oinstall /u01/app/oraInventory
chmod -R 775 /u01/app/oraInventory

mkdir -p /u01/app/grid
chown -R grid:oinstall /u01/app/grid
chmod -R 775 /u01/app/grid

mkdir -p /u01/app/11.2.0.4/grid
chown -R grid:oinstall /u01/app/11.2.0.4/grid
chmod -R 775 /u01/app/11.2.0.4/grid

mkdir -p /u01/app/oracle
chown -R oracle:oinstall /u01/app/oracle
chmod -R 775 /u01/app/oracle

mkdir -p /u01/app/oracle/product/11.2.0.4/db_1
chown -R oracle:oinstall /u01/app/oracle/product/11.2.0.4/db_1
chmod -R 775 /u01/app/oracle/product/11.2.0.4/db_1
```

‰øÆÊîπÁ≥ªÁªüËµÑÊ∫êÈôêÂà∂

```shell
vi /etc/security/limits.conf
grid soft nproc 2047    
grid hard nproc 16384   
grid soft nofile 1024   
grid hard nofile 65536  
oracle soft nproc 2047  
oracle hard nproc 16384 
oracle soft nofile 1024 
oracle hard nofile 65536
```

‰øÆÊîπ/etc/profileÔºåÊ∑ªÂä†Â¶Ç‰∏ãÈÖçÁΩÆ

```shell
vi /etc/profile
if [ \$USER = "oracle" ] || [ \$USER = "grid" ]; then
 if [ \$SHELL = "/bin/ksh" ]; then
    ulimit -p 16384
    ulimit -n 65536
 else
    ulimit -u 16384 -n 65536
 fi
umask 022
fi
```

‰øÆÊîπ/etc/csh.logÔºåÊ∑ªÂä†Â¶Ç‰∏ãÈÖçÁΩÆ

```shell
vi /etc/csh.login
if ( \$USER = "oracle" || \$USER = "grid" ) then
limit maxproc 16384
limit descriptors 65536
endif
```

‰øÆÊîπgridÁî®Êà∑ÁéØÂ¢ÉÂèòÈáè

```shell
su - grid
vi .bash_profile
export ORACLE_BASE=/u01/app/grid
export ORACLE_SID=+ASM1  ]]></description>
            <content:encoded><![CDATA[<h1 id="oracle-11g-rac-ÈÉ®ÁΩ≤Êê≠Âª∫" tabindex="-1">Oracle 11g RAC ÈÉ®ÁΩ≤Êê≠Âª∫ <a class="header-anchor" href="#oracle-11g-rac-ÈÉ®ÁΩ≤Êê≠Âª∫" aria-label="Permalink to &quot;Oracle 11g RAC ÈÉ®ÁΩ≤Êê≠Âª∫&quot;"></a></h1>
<blockquote>
<p><a href="https://www.bilibili.com/video/BV1ZT4y157NN?from=search&amp;seid=17237800447886927935&amp;spm_id_from=333.337.0.0" target="_blank" rel="noreferrer">DBNEST -- Bilibili RAC Âü∫Á°ÄÊê≠Âª∫ËßÜÈ¢ëÂú∞ÂùÄ</a></p>
</blockquote>
<iframe src="//player.bilibili.com/player.html?aid=926769884&bvid=BV1ZT4y157NN&cid=228088873&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" height="560" width="780"> </iframe>
<table tabindex="0">
<thead>
<tr>
<th>HOSTNAME</th>
<th>ÂÖ¨ÁΩëIP</th>
<th>‰∏ªÊú∫Âêç</th>
<th>ÁßÅÁΩëIP</th>
<th>VIP</th>
<th>SCANIP</th>
</tr>
</thead>
<tbody>
<tr>
<td>node1</td>
<td>192.168.174.11</td>
<td>Prod1</td>
<td>10.10.10.1</td>
<td>192.168.174.111</td>
<td>192.168.174.24</td>
</tr>
<tr>
<td>node2</td>
<td>192.168.174.12</td>
<td>Prod2</td>
<td>10.10.10.2</td>
<td>192.168.174.121</td>
<td>192.168.174.24</td>
</tr>
</tbody>
</table>
<h2 id="‰∏Ä„ÄÅÂàõÂª∫ËôöÊãüÊú∫ÂèäÊê≠Âª∫Êìç‰ΩúÁ≥ªÁªü" tabindex="-1">‰∏Ä„ÄÅÂàõÂª∫ËôöÊãüÊú∫ÂèäÊê≠Âª∫Êìç‰ΩúÁ≥ªÁªü <a class="header-anchor" href="#‰∏Ä„ÄÅÂàõÂª∫ËôöÊãüÊú∫ÂèäÊê≠Âª∫Êìç‰ΩúÁ≥ªÁªü" aria-label="Permalink to &quot;‰∏Ä„ÄÅÂàõÂª∫ËôöÊãüÊú∫ÂèäÊê≠Âª∫Êìç‰ΩúÁ≥ªÁªü&quot;"></a></h2>
<h3 id="_1-1-ÂàõÂª∫ËôöÊãüÊú∫" tabindex="-1">1.1 ÂàõÂª∫ËôöÊãüÊú∫ <a class="header-anchor" href="#_1-1-ÂàõÂª∫ËôöÊãüÊú∫" aria-label="Permalink to &quot;1.1 ÂàõÂª∫ËôöÊãüÊú∫&quot;"></a></h3>
<p>ËôöÊãüÊú∫ÁöÑÂàõÂª∫ ÈúÄË¶ÅÂàõÂª∫‰∏§‰∏™ËôöÊãüÊú∫ÈÖçÁΩÆÁõ∏ÂêåÂèñ‰∏çÂêåÁöÑÂêçÂ≠óÊù•Âå∫ÂàÜ„ÄÇ
ÊâìÂºÄvmwareÁÇπÂáªÂàõÂª∫Êñ∞ÁöÑËôöÊãüÊú∫„ÄÇ</p>
<figure><img src="./Oracle-RAC/01.png" alt="01" tabindex="0"><figcaption>01</figcaption></figure>
<figure><img src="./Oracle-RAC/02.png" alt="02" tabindex="0"><figcaption>02</figcaption></figure>
<figure><img src="./Oracle-RAC/03.png" alt="03" tabindex="0"><figcaption>03</figcaption></figure>
<p>ÈÄâÊã©redhat 6 ÁâàÊú¨64‰Ωç</p>
<figure><img src="./Oracle-RAC/04.png" alt="04" tabindex="0"><figcaption>04</figcaption></figure>
<p>Ê≠§Â§ÑÊúÄÂ•ΩÂú®windows‰∏äÂàõÂª∫Â•Ω‰∏Ä‰∏™ÁõÆÂΩïÊù•ÊîæÈõÜÁæ§Êñπ‰æøÂå∫ÂàÜ</p>
<figure><img src="./Oracle-RAC/05.png" alt="05" tabindex="0"><figcaption>05</figcaption></figure>
<figure><img src="./Oracle-RAC/06.png" alt="06" tabindex="0"><figcaption>06</figcaption></figure>
<figure><img src="./Oracle-RAC/07.png" alt="07" tabindex="0"><figcaption>07</figcaption></figure>
<figure><img src="./Oracle-RAC/08.png" alt="08" tabindex="0"><figcaption>08</figcaption></figure>
<figure><img src="./Oracle-RAC/09.png" alt="09" tabindex="0"><figcaption>09</figcaption></figure>
<figure><img src="./Oracle-RAC/10.png" alt="10" tabindex="0"><figcaption>10</figcaption></figure>
<figure><img src="./Oracle-RAC/11.png" alt="11" tabindex="0"><figcaption>11</figcaption></figure>
<figure><img src="./Oracle-RAC/12.png" alt="12" tabindex="0"><figcaption>12</figcaption></figure>
<figure><img src="./Oracle-RAC/13.png" alt="13" tabindex="0"><figcaption>13</figcaption></figure>
<figure><img src="./Oracle-RAC/14.png" alt="14" tabindex="0"><figcaption>14</figcaption></figure>
<figure><img src="./Oracle-RAC/15.png" alt="15" tabindex="0"><figcaption>15</figcaption></figure>
<figure><img src="./Oracle-RAC/16.png" alt="16" tabindex="0"><figcaption>16</figcaption></figure>
<figure><img src="./Oracle-RAC/17.png" alt="17" tabindex="0"><figcaption>17</figcaption></figure>
<figure><img src="./Oracle-RAC/18.png" alt="18" tabindex="0"><figcaption>18</figcaption></figure>
<figure><img src="./Oracle-RAC/19.png" alt="19" tabindex="0"><figcaption>19</figcaption></figure>
<figure><img src="./Oracle-RAC/20.png" alt="20" tabindex="0"><figcaption>20</figcaption></figure>
<figure><img src="./Oracle-RAC/21.png" alt="21" tabindex="0"><figcaption>21</figcaption></figure>
<figure><img src="./Oracle-RAC/22.png" alt="22" tabindex="0"><figcaption>22</figcaption></figure>
<figure><img src="./Oracle-RAC/23.png" alt="23" tabindex="0"><figcaption>23</figcaption></figure>
<figure><img src="./Oracle-RAC/24.png" alt="24" tabindex="0"><figcaption>24</figcaption></figure>
<figure><img src="./Oracle-RAC/25.png" alt="25" tabindex="0"><figcaption>25</figcaption></figure>
<figure><img src="./Oracle-RAC/26.png" alt="26" tabindex="0"><figcaption>26</figcaption></figure>
<figure><img src="./Oracle-RAC/27.png" alt="27" tabindex="0"><figcaption>27</figcaption></figure>
<figure><img src="./Oracle-RAC/28.png" alt="28" tabindex="0"><figcaption>28</figcaption></figure>
<figure><img src="./Oracle-RAC/29.png" alt="29" tabindex="0"><figcaption>29</figcaption></figure>
<figure><img src="./Oracle-RAC/30.png" alt="30" tabindex="0"><figcaption>30</figcaption></figure>
<figure><img src="./Oracle-RAC/31.png" alt="31" tabindex="0"><figcaption>31</figcaption></figure>
<figure><img src="./Oracle-RAC/32.png" alt="32" tabindex="0"><figcaption>32</figcaption></figure>
<figure><img src="./Oracle-RAC/33.png" alt="33" tabindex="0"><figcaption>33</figcaption></figure>
<figure><img src="./Oracle-RAC/34.png" alt="34" tabindex="0"><figcaption>34</figcaption></figure>
<h3 id="_1-2-ÈÖçÁΩÆËôöÊãüÊú∫ÁΩëÂç°" tabindex="-1">1.2 ÈÖçÁΩÆËôöÊãüÊú∫ÁΩëÂç° <a class="header-anchor" href="#_1-2-ÈÖçÁΩÆËôöÊãüÊú∫ÁΩëÂç°" aria-label="Permalink to &quot;1.2 ÈÖçÁΩÆËôöÊãüÊú∫ÁΩëÂç°&quot;"></a></h3>
<p>ÁÇπÂáªËôöÊãüÁΩëÁªúÁºñËæëÂô®ÔºåÂáÜÂ§áÊ∑ªÂä†ÁΩëÂç°Ôºõ</p>
<figure><img src="./Oracle-RAC/35.png" alt="35" tabindex="0"><figcaption>35</figcaption></figure>
<p>ÁÇπÂáªÊõ¥ÊîπËÆæÁΩÆÔºõ
<img src="./Oracle-RAC/36.png" alt="36"></p>
<p>ÁÇπÂáªÊ∑ªÂä†ÁΩëÁªúÔºåÊ∑ªÂä†ËôöÊãüÁΩëÂç°Ôºõ
<img src="./Oracle-RAC/37.png" alt="37"></p>
<p>ÁÇπÂáªÁ°ÆÂÆöÔºõ
<img src="./Oracle-RAC/38.png" alt="38"></p>
<p>‰øÆÊîπÂ≠êÁΩëIPËá≥ËßÑÂàíÁöÑÂÖ¨ÁΩëÂú∞ÂùÄ„ÄÇ
ÊåâÁÖß‰∏äËø∞Êìç‰ΩúÔºåÂàõÂª∫ÂÜÖÁΩëÁΩëÂç°ÔºåÂπ∂‰øÆÊîπIPÊàëÂú∞ÂùÄ‰∏∫10.10.10.1Ôºõ
<img src="./Oracle-RAC/39.png" alt="39"></p>
<p>ÁÇπÂáªvmwareÁöÑÁºñËæëËôöÊãüÊú∫ËÆæÁΩÆ<br>
<img src="./Oracle-RAC/40.png" alt="40"></p>
<p>ÈÄâ‰∏≠ÁΩëÁªúÈÄÇÈÖçÂô®ÁÇπÂáªÊ∑ªÂä†<br>
<img src="./Oracle-RAC/41.png" alt="41"></p>
<p>ÈÄâÊã©ÁΩëÁªúÈÄÇÈÖçÂô®ÁÇπÂáªÂÆåÊàêÂç≥ÂèØÂÆåÊàêÊ∑ªÂä†<br>
<img src="./Oracle-RAC/42.png" alt="42"></p>
<p>Êñ∞Ê∑ªÂä†ÁöÑÁΩëÂç°ÈÄâÊã©‰∏∫Ê°•Êé•Ê®°ÂºèÁÇπÂáªÁ°ÆÂÆö‰øùÂ≠òÊõ¥Êîπ<br>
<img src="./Oracle-RAC/43.png" alt="43"></p>
<h3 id="_1-3-ÂàõÂª∫ÂÖ±‰∫´Á£ÅÁõò" tabindex="-1">1.3 ÂàõÂª∫ÂÖ±‰∫´Á£ÅÁõò <a class="header-anchor" href="#_1-3-ÂàõÂª∫ÂÖ±‰∫´Á£ÅÁõò" aria-label="Permalink to &quot;1.3 ÂàõÂª∫ÂÖ±‰∫´Á£ÅÁõò&quot;"></a></h3>
<p>ËøõÂÖ•windowsÁöÑcmdÂëΩ‰ª§Ë°åÁ™óÂè£Âà∞ÂÆâË£ÖVMwareËΩØ‰ª∂ÁöÑÁõÆÂΩïÊâßË°åÂ¶Ç‰∏ãÂëΩ‰ª§ÂàõÂª∫ÂÖ±‰∫´Á£ÅÁõòÔºåÂ∞±ÊòØ‰∏§Âè∞Êú∫Âô®ÂÖ±Áî®ÁöÑÁ£ÅÁõòÊâÄ‰ª•Âú®Âè¶‰∏ÄÂè∞ËôöÊú∫‰∏äÊó†ÈúÄÂÜçÊ¨°ÂàõÂª∫‰∫î‰∏™„ÄÇ
ÂàõÂª∫ÁöÑÁ£ÅÁõòÊúÄÂ•ΩÂçïÁã¨ÊîæÂà∞‰∏Ä‰∏™ÁõÆÂΩï‰∏≠Êñπ‰æøÂêéÁª≠ÁöÑÈÖçÁΩÆ</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>cd /d D:\VMware15</span></span>
<span class="line"><span>vmware-vdiskmanager.exe -c -s 2Gb -a lsilogic -t 2 "D:\JanRAC\sharedisk\OCR01.vmdk"</span></span>
<span class="line"><span>vmware-vdiskmanager.exe -c -s 2Gb -a lsilogic -t 2 "D:\JanRAC\sharedisk\OCR02.vmdk"</span></span>
<span class="line"><span>vmware-vdiskmanager.exe -c -s 2Gb -a lsilogic -t 2 "D:\JanRAC\sharedisk\OCR03.vmdk"</span></span>
<span class="line"><span>vmware-vdiskmanager.exe -c -s 15Gb -a lsilogic -t 2 "D:\JanRAC\sharedisk\DATA1.vmdk"</span></span>
<span class="line"><span>vmware-vdiskmanager.exe -c -s 5Gb -a lsilogic -t 2 "D:\JanRAC\sharedisk\ARCH.vmdk"</span></span></code></pre>
</div><p>Á£ÅÁõòÂàõÂª∫ÂÆåÊàêÂêéÂÜçÊ¨°ËøõÂÖ•VMwareÁÇπÂáªÁºñËæëÁÇπÂáªÊ∑ªÂä†
<img src="./Oracle-RAC/44.png" alt="44"></p>
<p>ÈÄâÊã©Á°¨Áõò
<img src="./Oracle-RAC/45.png" alt="45"><br>
<img src="./Oracle-RAC/46.png" alt="46"></p>
<p>ÈÄâÊã©‰ΩøÁî®Áé∞ÊúâÁöÑÁ£ÅÁõò
<img src="./Oracle-RAC/47.png" alt="47"></p>
<p>ËøõÂÖ•ÂàöÊâçÂª∫Á´ãÁöÑÁ£ÅÁõòÁõÆÂΩï‰∏≠ÈÄâÊã©Â¶Ç‰∏ãÂõæÊâÄÁ§∫ÁöÑÁõòÔºà‰∏çË¶ÅÈÄâflatÁªìÂ∞æÁöÑÔºâ
<img src="./Oracle-RAC/48.png" alt="48"><br>
<img src="./Oracle-RAC/49.png" alt="49"><br>
<img src="./Oracle-RAC/50.png" alt="50"><br>
<img src="./Oracle-RAC/51.png" alt="51"><br>
<img src="./Oracle-RAC/52.png" alt="52"></p>
<p>ÊåâÁÖßÂêåÊ†∑ÁöÑÊñπÊ≥ïÊää‰∫î‰∏™ÁõòÈÉΩÂä†Âà∞‰∏äÈù¢„ÄÇ
ÂÖ®ÈÉ®ÂÆåÊàêÂêéÁÇπÂáªÁ°ÆËÆ§‰ΩøÂÖ∂ÁîüÊïà</p>
<p><img src="./Oracle-RAC/53.png" alt="53"><br>
<img src="./Oracle-RAC/54.png" alt="54"></p>
<p>ÊâæÂà∞‰∏§Âè∞ËôöÊãüÊú∫ÁöÑÈÖçÁΩÆÊñá‰ª∂Áî®ËÆ∞‰∫ãÊú¨Ê®°ÂºèÊâìÂºÄÂÆÉÂä†ÂÖ•‰∏§Ë°åÂèÇÊï∞„ÄÇ</p>
<p>Â∞Ü‰∏ãÈù¢ÈÖçÁΩÆÁ≤òË¥¥Ëá≥VMXÊñá‰ª∂‰∏≠Ôºå‰∏§‰∏™ËäÇÁÇπÂùáÊìç‰Ωú„ÄÇ</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>disk.locking="FALSE"</span></span>
<span class="line"><span>disk.EnableUUID = "TRUE"</span></span></code></pre>
</div><h3 id="_1-4-Êê≠Âª∫linuxÊìç‰ΩúÁ≥ªÁªü" tabindex="-1">1.4 Êê≠Âª∫linuxÊìç‰ΩúÁ≥ªÁªü <a class="header-anchor" href="#_1-4-Êê≠Âª∫linuxÊìç‰ΩúÁ≥ªÁªü" aria-label="Permalink to &quot;1.4 Êê≠Âª∫linuxÊìç‰ΩúÁ≥ªÁªü&quot;"></a></h3>
<p>ÁÇπÂáªËôöÊãüÊú∫ËÆæÁΩÆ
<img src="./Oracle-RAC/55.png" alt="55"></p>
<p>ÈÄâÊã©ÂÆâË£ÖÂÖâÁõòÂêéÁÇπÂáªÁ°ÆËÆ§<br>
<img src="./Oracle-RAC/56.png" alt="56"></p>
<p>ÁÇπÂáªÂºÄÂêØÊ¨°ËôöÊãüÊú∫
<img src="./Oracle-RAC/57.png" alt="57"></p>
<p>ÁÇπÂáªÂõûËΩ¶
<img src="./Oracle-RAC/58.png" alt="58"><br>
<img src="./Oracle-RAC/59.png" alt="59"><br>
<img src="./Oracle-RAC/60.png" alt="60"><br>
<img src="./Oracle-RAC/61.png" alt="61"><br>
<img src="./Oracle-RAC/62.png" alt="62"><br>
<img src="./Oracle-RAC/63.png" alt="63"></p>
<p>ÈÄâÊã©yes
<img src="./Oracle-RAC/64.png" alt="64"></p>
<p>‰∏ªÊú∫ÂêçÂ≠ó
<img src="./Oracle-RAC/65.png" alt="65"></p>
<p>Êó∂Âå∫ÈÄâÊã©‰∏äÊµ∑
<img src="./Oracle-RAC/66.png" alt="66"></p>
<p>ËÆæÁΩÆÂØÜÁ†Å
<img src="./Oracle-RAC/67.png" alt="67"></p>
<p>Á£ÅÁõòÂàÜÂå∫
<img src="./Oracle-RAC/68.png" alt="68"></p>
<p>ÁÇπÂáªcreate
<img src="./Oracle-RAC/69.png" alt="69"></p>
<p>Ê≥®ÊÑèÂè™ÈÄâÊã©sdaÁõòËøõË°åÂàÜÂå∫ÂÖ∂‰ªñÁöÑÁõòÂãæÊéâÔºåÈ¶ñÂÖàÂä†‰∏Ä‰∏™/bootÂàÜÂå∫Â§ßÂ∞è200ÁÇπÂáªok
<img src="./Oracle-RAC/70.png" alt="70"></p>
<p>Ê≥®ÊÑèÂè™ÈÄâÊã©sdaÁõòËøõË°åÂàÜÂå∫ÂÖ∂‰ªñÁöÑÁõòÂãæÊéâÔºåÂä†‰∏Ä‰∏™swapÂàÜÂå∫Â§ßÂ∞è2G
<img src="./Oracle-RAC/71.png" alt="71"></p>
<p>Ê≥®ÊÑèÂè™ÈÄâÊã©sdaÁõòËøõË°åÂàÜÂå∫ÂÖ∂‰ªñÁöÑÁõòÂãæÊéâÔºåÊ†πÂàÜÂå∫Â§ßÂ∞è5G
<img src="./Oracle-RAC/72.png" alt="72"></p>
<p>Ê≥®ÊÑèÂè™ÈÄâÊã©sdaÁõòËøõË°åÂàÜÂå∫ÂÖ∂‰ªñÁöÑÁõòÂãæÊéâÔºå/u01ÂàÜÂå∫Â∞ÜÂâ©‰∏ãÊâÄÊúâÁ©∫Èó¥ÂÖ®ÈÉ®ÂàÜÈÖçÁªô‰ªñ</p>
<p><img src="./Oracle-RAC/73.png" alt="73"><br>
<img src="./Oracle-RAC/74.png" alt="74"><br>
<img src="./Oracle-RAC/75.png" alt="75"><br>
<img src="./Oracle-RAC/76.png" alt="76"></p>
<p>ÁÇπÂáªrebootÂÆåÊàêÊìç‰ΩúÁ≥ªÁªüÁöÑÂÆâË£ÖÈáçÂêØÂêéËøõÂÖ•Êìç‰ΩúÁ≥ªÁªüÁïåÈù¢
<img src="./Oracle-RAC/78.png" alt="77"></p>
<h2 id="‰∫å„ÄÅÊìç‰ΩúÁ≥ªÁªüÈÖçÁΩÆ" tabindex="-1">‰∫å„ÄÅÊìç‰ΩúÁ≥ªÁªüÈÖçÁΩÆ <a class="header-anchor" href="#‰∫å„ÄÅÊìç‰ΩúÁ≥ªÁªüÈÖçÁΩÆ" aria-label="Permalink to &quot;‰∫å„ÄÅÊìç‰ΩúÁ≥ªÁªüÈÖçÁΩÆ&quot;"></a></h2>
<h3 id="_2-1-Ê£ÄÊü•Êìç‰ΩúÁ≥ªÁªüËÆæÁΩÆ" tabindex="-1">2.1 Ê£ÄÊü•Êìç‰ΩúÁ≥ªÁªüËÆæÁΩÆ <a class="header-anchor" href="#_2-1-Ê£ÄÊü•Êìç‰ΩúÁ≥ªÁªüËÆæÁΩÆ" aria-label="Permalink to &quot;2.1 Ê£ÄÊü•Êìç‰ΩúÁ≥ªÁªüËÆæÁΩÆ&quot;"></a></h3>
<p>‰∏§‰∏™ËôöÊú∫Ê†πÊçÆËá™Â∑±ÁöÑÁΩëÂç°‰ø°ÊÅØÈÖçÁΩÆÁΩëÂç°</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">vi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /etc/sysconfig/network-script/ifcfg-eth0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">DEVICE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">eth0</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">#HWADDR=00:0C:29:93:4D:A6</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">TYPE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">Ethernet</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">#UUID=58b202c7-754b-4cea-aedc-705e370c90b8</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">ONBOOT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">yes</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">NM_CONTROLLED</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">yes</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">BOOTPROTO</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">static</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">IPADDR</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">192.168.174.11</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">NETMASK</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">255.255.255.0</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">vi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /etc/sysconfig/network-script/ifcfg-eth1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">DEVICE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">eth1</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">#HWADDR=00:0C:29:93:4D:B0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">TYPE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">Ethernet</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">#UUID=5050a9fd-a783-4ddc-bc31-59cbe7be5d1d</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">ONBOOT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">yes</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">NM_CONTROLLED</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">yes</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">BOOTPROTO</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">static</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">IPADDR</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">10.10.10.1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">NETMASK</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">255.255.255.0</span></span></code></pre>
</div><h3 id="_2-2-Ê£ÄÊü•Á≥ªÁªüÂ∫ì‰æùËµñ" tabindex="-1">2.2 Ê£ÄÊü•Á≥ªÁªüÂ∫ì‰æùËµñ <a class="header-anchor" href="#_2-2-Ê£ÄÊü•Á≥ªÁªüÂ∫ì‰æùËµñ" aria-label="Permalink to &quot;2.2 Ê£ÄÊü•Á≥ªÁªüÂ∫ì‰æùËµñ&quot;"></a></h3>
<p>ÈÖçÁΩÆyumÊ∫êÔºåÂπ∂ÂÆâË£Ö‰æùËµñÂåÖ</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">vi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /etc/yum.repos.d/iso.repo</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[iso]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">iso</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">baseurl</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">file:///mnt</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">enabled</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">gpgcheck</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">0</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">mount</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /dev/cdrom</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /mnt</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">yum</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -y</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> binutils</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> compat-libstdc++-33</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> glibc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ksh</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> libaio</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> libgcc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> libstdc++</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> compat-libcap1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> gcc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> gcc-c++</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> glibc-devel</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> libaio-devel</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> libstdc++-devel</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> sysstat</span></span></code></pre>
</div><h3 id="_2-3-Êìç‰ΩúÁ≥ªÁªüÂÜÖÊ†∏ÂèÇÊï∞Ë∞ÉÊï¥" tabindex="-1">2.3 Êìç‰ΩúÁ≥ªÁªüÂÜÖÊ†∏ÂèÇÊï∞Ë∞ÉÊï¥ <a class="header-anchor" href="#_2-3-Êìç‰ΩúÁ≥ªÁªüÂÜÖÊ†∏ÂèÇÊï∞Ë∞ÉÊï¥" aria-label="Permalink to &quot;2.3 Êìç‰ΩúÁ≥ªÁªüÂÜÖÊ†∏ÂèÇÊï∞Ë∞ÉÊï¥&quot;"></a></h3>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">vi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /etc/sysctl.conf</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">kernel.shmall</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> xxx</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">  #Â°´ÂÖ•ÂëΩ‰ª§echo "`cat /proc/meminfo | grep "MemTotal" | awk '{print $2}'` / (`getconf PAGESIZE` / 1024)" | bc ÁöÑËøêË°åÁªìÊûú</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">kernel.shmmax</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> xxx</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">  #Â°´ÂÖ•ÂëΩ‰ª§echo "`cat /proc/meminfo | grep "MemTotal" | awk '{print $2}'` * 1024 * 0.8" | bc  | sed 's#\..*$##' ÁöÑËøêË°åÁªìÊûú</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">kernel.shmmni</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 4096</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">kernel.sem</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 250</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 32000</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 100</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 128</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">fs.file-max</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 6815744</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">fs.aio-max-nr</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1048576</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">net.ipv4.ip_local_port_range</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 9000</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 65500</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">net.core.rmem_default</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 262144</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">net.core.rmem_max</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 4194304</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">net.core.wmem_default</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 262144</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">net.core.wmem_max</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 104857</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">vm.swappiness</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">vm.dirty_background_ratio</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 3</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">vm.dirty_ratio</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 80</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">vm.dirty_expire_centisecs</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 500</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">vm.dirty_writeback_centisecs</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 100</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sysctl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   ‰ΩøÂèÇÊï∞ÁîüÊïà</span></span></code></pre>
</div><h3 id="_2-4-ÂÖ≥Èó≠-selinux„ÄÅÈò≤ÁÅ´Â¢ô" tabindex="-1">2.4 ÂÖ≥Èó≠ SElinux„ÄÅÈò≤ÁÅ´Â¢ô <a class="header-anchor" href="#_2-4-ÂÖ≥Èó≠-selinux„ÄÅÈò≤ÁÅ´Â¢ô" aria-label="Permalink to &quot;2.4 ÂÖ≥Èó≠ SElinux„ÄÅÈò≤ÁÅ´Â¢ô&quot;"></a></h3>
<p>Ê†πÊçÆÂÆâË£ÖËßÑËåÉÔºåÊ≠§‰∏§È°πÂÜÖÂÆπÂ∫îËØ•Â∑≤ÁªèË¢´ÂÖ≥Èó≠
‰ΩøÁî®Â¶Ç‰∏ãÂëΩ‰ª§ÂÖ≥Èó≠Ôºö</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sed</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 's/enforcing/disabled/g'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /etc/selinux/config</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">setenforce</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 0</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">service</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> iptables</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> stop</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">chkconfig</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> iptables</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> off</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">service</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> NetworkManager</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> stop</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">chkconfig</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> NetworkManager</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> off</span></span></code></pre>
</div><h3 id="_2-5-ipÂú∞ÂùÄÂàÜÈÖç" tabindex="-1">2.5 IPÂú∞ÂùÄÂàÜÈÖç <a class="header-anchor" href="#_2-5-ipÂú∞ÂùÄÂàÜÈÖç" aria-label="Permalink to &quot;2.5 IPÂú∞ÂùÄÂàÜÈÖç&quot;"></a></h3>
<h4 id="_2-5-1-‰∏ªÊú∫Êñá‰ª∂ÈÖçÁΩÆ" tabindex="-1">2.5.1 ‰∏ªÊú∫Êñá‰ª∂ÈÖçÁΩÆ <a class="header-anchor" href="#_2-5-1-‰∏ªÊú∫Êñá‰ª∂ÈÖçÁΩÆ" aria-label="Permalink to &quot;2.5.1 ‰∏ªÊú∫Êñá‰ª∂ÈÖçÁΩÆ&quot;"></a></h4>
<ol>
<li>ÊØè‰∏™ËäÇÁÇπÁöÑÂÖ¨ÁΩëÁΩëÂç°ÂêçÔºåÁßÅÁΩëÁΩëÂç°ÂêçÂ∫î‰øùÊåÅ‰∏ÄËá¥Ôºå‰æãÂ¶ÇÔºöÂú®ËäÇÁÇπ1ÂÖ¨ÁΩëÁΩëÂç°Âêç‰∏∫eth0ÔºåÁßÅÁΩëÁΩëÂç°Âêçeth1ÔºåÂàôËäÇÁÇπ2ÁöÑÂÖ¨2. ÁΩëÁΩëÂç°Âêç‰πüÂ∫î‰∏∫eth0ÔºåÁßÅÁΩëÁΩëÂç°ÂêçÂ∫î‰∏∫eth1„ÄÇ
Ê≥®ÊÑèÔºöÂêÑ‰∏™ËäÇÁÇπÁöÑÂêåÂêçÁΩëÂç°ÁöÑÈÖçÁΩÆÊñá‰ª∂‚Äú/etc/sysconfig/network-scripts/ifcfg-ÁΩëÂç°Âêç‚Äù‰πüÂ∫îÁõ∏ÂêåÔºÅ</li>
</ol>
<p>vip/priv/scanÂëΩÂêçËßÑÂàôÂ¶Ç‰∏ãÔºö</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">&#x3C;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">hostname</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">-vipÔºå‰ª£Ë°®VIP‰∏ªÊú∫ÂêçÔºõ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">&#x3C;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">hostname</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">-privÔºå‰ª£Ë°®priv‰∏ªÊú∫ÂêçÔºõ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">&#x3C;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">hostname</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">-scanÔºå‰ª£Ë°®scan‰∏ªÊú∫ÂêçÔºõ</span></span></code></pre>
</div><p>ÈíàÂØπIPÂú∞ÂùÄÂàÜÈÖçÂ¶Ç‰∏ãÔºåÈúÄË¶ÅÂú®/etc/hostsÊñá‰ª∂‰∏≠Â¢ûÂä†‰ª•‰∏ãIPÂú∞ÂùÄËß£ÊûêÔºö</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">#PUBLIC</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">192.168.174.11</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    rac1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">192.168.174.12</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    rac2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">#PRIVATE</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">10.10.10.1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    rac1-priv</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">10.10.10.2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    rac2-priv</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">#VIP</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">192.168.174.111</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   rac1-vip</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">192.168.174.121</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   rac2-vip</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">192.168.174.24</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    rac-scan</span></span></code></pre>
</div><h4 id="_2-5-2-ipÂú∞ÂùÄÂàÜÈÖçÂ∫îÈÅµÂæ™Â¶Ç‰∏ãÂéüÂàô" tabindex="-1">2.5.2 IpÂú∞ÂùÄÂàÜÈÖçÂ∫îÈÅµÂæ™Â¶Ç‰∏ãÂéüÂàô <a class="header-anchor" href="#_2-5-2-ipÂú∞ÂùÄÂàÜÈÖçÂ∫îÈÅµÂæ™Â¶Ç‰∏ãÂéüÂàô" aria-label="Permalink to &quot;2.5.2 IpÂú∞ÂùÄÂàÜÈÖçÂ∫îÈÅµÂæ™Â¶Ç‰∏ãÂéüÂàô&quot;"></a></h4>
<p>Ôºà1Ôºâ Public ip,scan ip, vip ÂøÖÈ°ªÂú®Áõ∏ÂêåÁΩëÊÆµ
Ôºà2Ôºâ private ip ‰∏é‰∏äËø∞ip ‰∏çËÉΩÂú®Áõ∏ÂêåÁΩëÊÆµÔºõ</p>
<h2 id="‰∏â„ÄÅÁî®Êà∑ÁéØÂ¢ÉÂèäÁõÆÂΩïÈÖçÁΩÆ" tabindex="-1">‰∏â„ÄÅÁî®Êà∑ÁéØÂ¢ÉÂèäÁõÆÂΩïÈÖçÁΩÆ <a class="header-anchor" href="#‰∏â„ÄÅÁî®Êà∑ÁéØÂ¢ÉÂèäÁõÆÂΩïÈÖçÁΩÆ" aria-label="Permalink to &quot;‰∏â„ÄÅÁî®Êà∑ÁéØÂ¢ÉÂèäÁõÆÂΩïÈÖçÁΩÆ&quot;"></a></h2>
<h3 id="_3-1-Áî®Êà∑Áõ∏ÂÖ≥ËÆæÁΩÆ" tabindex="-1">3.1 Áî®Êà∑Áõ∏ÂÖ≥ËÆæÁΩÆ <a class="header-anchor" href="#_3-1-Áî®Êà∑Áõ∏ÂÖ≥ËÆæÁΩÆ" aria-label="Permalink to &quot;3.1 Áî®Êà∑Áõ∏ÂÖ≥ËÆæÁΩÆ&quot;"></a></h3>
<p>ÂàõÂª∫Áî®Êà∑ÂíåÁªÑ</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">groupadd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -g</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1000</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oinstall</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">groupadd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -g</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1001</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dba</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">groupadd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -g</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1002</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oper</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">groupadd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -g</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1003</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> asmadmin</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">groupadd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -g</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1004</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> asmdba</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">groupadd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -g</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1005</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> asmoper</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">useradd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -u</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1001</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -g</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oinstall</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -G</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dba,asmadmin,asmdba,asmoper</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> grid</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">useradd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -u</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1002</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -g</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oinstall</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -G</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dba,oper,asmadmin,asmdba</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oracle</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> grid</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">passwd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --stdin</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> grid</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> grid</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">passwd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --stdin</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oracle</span></span></code></pre>
</div><p>ÂàõÂª∫ÁõÆÂΩï</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">mkdir</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /u01/app/oraInventory</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">chown</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -R</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> grid:oinstall</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /u01/app/oraInventory</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">chmod</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -R</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 775</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /u01/app/oraInventory</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">mkdir</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /u01/app/grid</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">chown</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -R</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> grid:oinstall</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /u01/app/grid</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">chmod</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -R</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 775</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /u01/app/grid</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">mkdir</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /u01/app/11.2.0.4/grid</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">chown</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -R</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> grid:oinstall</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /u01/app/11.2.0.4/grid</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">chmod</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -R</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 775</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /u01/app/11.2.0.4/grid</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">mkdir</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /u01/app/oracle</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">chown</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -R</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oracle:oinstall</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /u01/app/oracle</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">chmod</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -R</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 775</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /u01/app/oracle</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">mkdir</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /u01/app/oracle/product/11.2.0.4/db_1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">chown</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -R</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oracle:oinstall</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /u01/app/oracle/product/11.2.0.4/db_1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">chmod</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -R</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 775</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /u01/app/oracle/product/11.2.0.4/db_1</span></span></code></pre>
</div><p>‰øÆÊîπÁ≥ªÁªüËµÑÊ∫êÈôêÂà∂</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">vi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /etc/security/limits.conf</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">grid</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> soft</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> nproc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 2047</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">grid</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> hard</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> nproc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 16384</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">grid</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> soft</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> nofile</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1024</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">grid</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> hard</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> nofile</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 65536</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> soft</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> nproc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 2047</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> hard</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> nproc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 16384</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> soft</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> nofile</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1024</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> hard</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> nofile</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 65536</span></span></code></pre>
</div><p>‰øÆÊîπ/etc/profileÔºåÊ∑ªÂä†Â¶Ç‰∏ãÈÖçÁΩÆ</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">vi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /etc/profile</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [ </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\$</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">USER </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "oracle"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">||</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [ </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\$</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">USER </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "grid"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ]; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">then</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [ </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\$</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">SHELL </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "/bin/ksh"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ]; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">then</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    ulimit</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -p</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 16384</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    ulimit</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -n</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 65536</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> else</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    ulimit</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -u</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 16384</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -n</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 65536</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> fi</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">umask</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 022</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">fi</span></span></code></pre>
</div><p>‰øÆÊîπ/etc/csh.logÔºåÊ∑ªÂä†Â¶Ç‰∏ãÈÖçÁΩÆ</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">vi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /etc/csh.login</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ( </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">\$USER</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "oracle"</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> ||</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> \$USER</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "grid"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">then</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">limit</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> maxproc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 16384</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">limit</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> descriptors</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 65536</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">endif</span></span></code></pre>
</div><p>‰øÆÊîπgridÁî®Êà∑ÁéØÂ¢ÉÂèòÈáè</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">su</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> grid</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">vi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> .bash_profile</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ORACLE_BASE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">/u01/app/grid</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ORACLE_SID</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">+ASM1  --</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">-ËäÇÁÇπ2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ‰∏∫+ASM2</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ORACLE_HOME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">/u01/app/11.2.0.4/grid</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> PATH</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">$ORACLE_HOME/bin:$ORACLE_HOME/OPatch:$PATH</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">NAME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">hostname</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">PS1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"[</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">$NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">$LOGNAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">]:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">{PWD}>"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">umask</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 022</span></span></code></pre>
</div><p>‰øÆÊîπoracleÁéØÂ¢ÉÂèòÈáè</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">su</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oracle</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">vi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> .bash_profile</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ORACLE_BASE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">/u01/app/oracle</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ORACLE_SID</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">orcl1  --</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">-ËäÇÁÇπ2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ‰∏∫orcl2</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ORACLE_HOME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">$ORACLE_BASE/product/11.2.0.4/db_1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> PATH</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">$ORACLE_HOME/bin:$ORACLE_HOME/OPatch:$PATH</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">NAME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">hostname</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">PS1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"[</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">$NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">$LOGNAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">]:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">{PWD}>"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">umask</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 022</span></span></code></pre>
</div><h3 id="_3-2-Ëß£Âéã-11-2-0-4-ÂÆâË£ÖÂåÖ" tabindex="-1">3.2 Ëß£Âéã 11.2.0.4 ÂÆâË£ÖÂåÖ <a class="header-anchor" href="#_3-2-Ëß£Âéã-11-2-0-4-ÂÆâË£ÖÂåÖ" aria-label="Permalink to &quot;3.2 Ëß£Âéã 11.2.0.4 ÂÆâË£ÖÂåÖ&quot;"></a></h3>
<p>‰∏ä‰º†ÂÆâË£Ö‰ªãË¥®Âπ∂Ëß£ÂéãÁº©ÔºåÂÖ±‰∏â‰∏™ÂéãÁº©ÂåÖÔºå1,2Ëß£ÂéãÂá∫Êù•‰∏∫databaseÔºå3Ëß£ÂéãÂá∫Êù•‰∏∫grid</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">p13390677_112040_Linux-x86-64_1of7.zip</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">p13390677_112040_Linux-x86-64_2of7.zip</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">p13390677_112040_Linux-x86-64_3of7.zip</span></span></code></pre>
</div><h3 id="_3-3-ËÆæÁΩÆ-udev-ËßÑÂàô" tabindex="-1">3.3 ËÆæÁΩÆ UDEV ËßÑÂàô <a class="header-anchor" href="#_3-3-ËÆæÁΩÆ-udev-ËßÑÂàô" aria-label="Permalink to &quot;3.3 ËÆæÁΩÆ UDEV ËßÑÂàô&quot;"></a></h3>
<p>ÁªëÂÆöÂâçÈúÄË¶ÅÊü•Áúã‰∏ãËôöÊú∫ÁöÑÈÖçÁΩÆÊñá‰ª∂ÁöÑdisk.EnableUUIDÂèÇÊï∞ÈúÄË¶ÅÊòØTRUEÔºåÂ¶ÇÊûú‰∏çÊòØÈúÄË¶ÅÂÖ≥Èó≠Êìç‰ΩúÁ≥ªÁªüË°ÄÈíôÂèÇÊï∞ÂêéÂÜçÈáçÂêØ</p>
<p>‰øÆÊîπÊñá‰ª∂/etc/udev/rules.d/99-oracle-asmdevices.rulesÔºåËøêË°å‰∏Ä‰∏ãËÑöÊú¨Ôºö</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">/etc/udev/rules.d/99-oracle-asmdevices.rules</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> DISK</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> b</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> e</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">do</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">DISK</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">$(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">expr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> $DISK </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">UUID</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">scsi_id</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -gud</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /dev/sd</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">$i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "KERNEL==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">sd*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">, SUBSYSTEM==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">block</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">, PROGRAM==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">/sbin/scsi_id --whitelisted --replace-whitespace --device=/dev/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">name</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,  RESULT==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">$UUID</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">, NAME=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">asm-disk</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">$DISK</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,  OWNER=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">grid</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,  GROUP=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">asmadmin</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">, MODE=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">0660</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> >></span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">/etc/udev/rules.d/99-oracle-asmdevices.rules</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">done</span></span></code></pre>
</div><p>ÈáçÂêØUDEV‰ª•‰Ωø‰∏äËø∞ËÆæÁΩÆÁîüÊïàÔºö</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">/sbin/udevadm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> control</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --reload-rules</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">/sbin/start_udev</span></span></code></pre>
</div><h2 id="Âõõ„ÄÅgrid-Âíå-db-ËΩØ‰ª∂ÂÆâË£Ö" tabindex="-1">Âõõ„ÄÅGRID Âíå DB ËΩØ‰ª∂ÂÆâË£Ö <a class="header-anchor" href="#Âõõ„ÄÅgrid-Âíå-db-ËΩØ‰ª∂ÂÆâË£Ö" aria-label="Permalink to &quot;Âõõ„ÄÅGRID Âíå DB ËΩØ‰ª∂ÂÆâË£Ö&quot;"></a></h2>
<ol>
<li>Áî®SecureCRTÔºåÂØπÂ∫îÊúçÂä°Âô®ËøûÊé•Â±ûÊÄß‰∏≠ÂãæÈÄâForward X11 PacketsÔºåÂç≥ÂèØÂÆûÁé∞Âú®‰∏çËÆæÁΩÆDISPLAYÈÄâÈ°πÔºåÂØπÂ∫îÊúçÂä°Âô®ping‰∏çÈÄöÊú¨Êú∫ÁöÑÊÉÖÂΩ¢‰∏ã‰æùÁÑ∂ÂèØ‰ª•Ê≠£Â∏∏ÊòæÁ§∫OracleÂÆâË£ÖÁïåÈù¢„ÄÇ</li>
<li>‰ΩÜÂú®ÊâßË°årunInstallerÊó∂ÊúÄÂêéË¶Å‰ª•ÂØπÂ∫îÁöÑgrid/oracleÁî®Êà∑ÁôªÂΩïÔºå‰∏çËÉΩÁî®rootÁî®Êà∑sshÁôªÂΩïÂêéÂÜçsuÂà∞grid/oracleÁî®Êà∑ÔºåÂê¶ÂàôOracleÂÆâË£ÖÁïåÈù¢ÊúâÂèØËÉΩÊòæÁ§∫‰∏çÂá∫Êù•„ÄÇ</li>
</ol>
<h3 id="_4-1-grid-ËΩØ‰ª∂ÂÆâË£Ö" tabindex="-1">4.1 GRID ËΩØ‰ª∂ÂÆâË£Ö <a class="header-anchor" href="#_4-1-grid-ËΩØ‰ª∂ÂÆâË£Ö" aria-label="Permalink to &quot;4.1 GRID ËΩØ‰ª∂ÂÆâË£Ö&quot;"></a></h3>
<p>gridÁî®Êà∑ÁôªÂΩïÁ¨¨‰∏Ä‰∏™ËäÇÁÇπ‰∏ªÊú∫ÔºåÁÑ∂ÂêéÊâßË°årunInstallerÂëΩ‰ª§ÂÆâË£ÖGrid Infrastructure,ÂÖ∑‰ΩìÂÆâË£ÖÊ≠•È™§Â¶Ç‰∏ãÔºöÊâßË°å./runInstallerÂÆâË£ÖÔºö</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[grid@epayrac1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ cd /home/oracle_install/grid</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[root@tim1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]# dd if</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">/dev/zero</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> of</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">/u01/swap1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> bs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">1M</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> count</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">2048</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">2ÔºâÂàõÂª∫‰∏Ä‰∏™swapÁ±ªÂûãÊñá‰ª∂,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[root@epayrac1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]# mkswap /u01/swap1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">3ÔºâÂ∞Üswpf1ÁîüÊàêswapÊñá‰ª∂</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[root@epayrac1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]# swapon /u01/swap1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Êü•Áúã‰∏Ä‰∏ãÔºåswap1Ëµ∑‰ΩúÁî®‰∫Ü</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[root@epayrac1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]# free -m   </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">4ÔºâÂÆûÁé∞ÂºÄÊú∫ÂêéËá™Âä®‰ΩøÁî®Êñ∞Ê∑ªÁöÑswap1ÂàÜÂå∫</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[root@epayrac1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]# vi /etc/fstab</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Ê∑ªÂä†swapË°å</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">/u01/swap1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       swap</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       swap</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      defaults</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">     0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">5Ôºâ‰øÆÊîπtmpfsË°å</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tmpfs</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">            /dev/shm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   tmpfs</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   defaults,size=2G</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">6ÔºâtmpfsÈáçÁΩÆ‰∏Ä‰∏ãÔºå‰ΩøÂÖ∂ÂΩì‰∏ãÊúâÊïà</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[root@epayrac1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]# mount -o remount /dev/shm</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[grid@epayrac1 grid]$ ./runInstaller</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Universal</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Installer...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Checking</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Temp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> space:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> must</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> be</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> greater</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> than</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 120</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> MB.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   Actual</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 3996</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> MB</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    Passed</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Checking</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> swap</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> space:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> must</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> be</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> greater</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> than</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 150</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> MB.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   Actual</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 32145</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> MB</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    Passed</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Checking</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> monitor:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> must</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> be</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> configured</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> display</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> at</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> least</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 256</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> colors.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    Actual</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 16777216</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    Passed</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Preparing</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> launch</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Universal</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Installer</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /tmp/OraInstall2014-08-21_05-26-13PM.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Please</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> wait</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ...</span></span></code></pre>
</div><p>ÊâßË°årunInstallerÂêéÂá∫Áé∞Â¶Ç‰∏ãÂÆâË£ÖÁïåÈù¢Ôºö
ÈÄâÊã©‚Äúskip software updates‚ÄùÁÑ∂Âêé‰∏ã‰∏ÄÊ≠•Ôºö
<img src="./Oracle-RAC/80.png" alt="80"></p>
<p>ÈÄâÊã©‚ÄúInstall and Configure Oracle Grid infrastructure for a Cluster‚ÄùÁÑ∂Âêé‰∏ã‰∏ÄÊ≠•Ôºö
<img src="./Oracle-RAC/81.png" alt="81"></p>
<p>ÈÄâÊã©‚ÄúAdvanced Installation‚ÄùÔºåÁÑ∂Âêé‰∏ã‰∏ÄÊ≠•:
<img src="./Oracle-RAC/82.png" alt="82"><br>
ÈÄâÊã©ÂÆâË£ÖËØ≠Ë®ÄÔºåÈªòËÆ§‰∏∫Ëã±ËØ≠ÔºåÁõ¥Êé•ÁÇπÂáª‰∏ã‰∏ÄÊ≠•Ôºö
<img src="./Oracle-RAC/83.png" alt="83"><br>
ËæìÂÖ•Cluster Name‰∏∫epayrac-cluster, SCAN Name‰∏∫epayrac-scanÔºåSCAN Port‰∏∫1521ÔºåÊ≥®ÊÑèSCAN NameÂøÖÈ°ª‰∏é/etc/hostsÊñá‰ª∂‰∏≠ËÆæÁΩÆÁöÑ‰∏ÄËá¥ÔºõÂè¶Â§ñÔºåËøôÈáå‰∏çÈÖçGNSÔºåÁÑ∂ÂêéÁÇπÂáª‰∏ã‰∏ÄÊ≠•Ôºö
<img src="./Oracle-RAC/84.png" alt="84"><br>
Âú®ÈöèÂêéÂá∫Áé∞ÁöÑÁïåÈù¢‰∏≠ÂçïÂáª‚ÄúAdd‚ÄùÊåâÈíÆÔºö
<img src="./Oracle-RAC/85.png" alt="85"></p>
<p>ÈÖçÁΩÆsshÂçïÂáª‚ÄúSSH Connectivity‚ÄùÊåâÈíÆÔºöËæìÂÖ•gridÁöÑÂØÜÁ†ÅÂêéÁÇπÂáªsetup
<img src="./Oracle-RAC/86.png" alt="86"><br>
<img src="./Oracle-RAC/87.png" alt="87"></p>
<p>ÂÆåÊàêsshÈÖçÁΩÆ
<img src="./Oracle-RAC/88.png" alt="88"><br>
ÂçïÂáªTestÊåâÈíÆÔºåÂ∫îËØ•Âá∫Áé∞‰ª•‰∏ãÁ™óÂè£ÔºåÂ¶ÇÊûú‰ª•‰∏ãÁ™óÂè£‰∏çËÉΩÂá∫Áé∞ÔºåÂàôËØ¥ÊòéSSHÈÖçÁΩÆÊúâÈóÆÈ¢òÔºåËØ∑ÈÄÄÂá∫ÂÆâË£ÖÁ®ãÂ∫èÔºå‰øÆÊîπsshÈÖçÁΩÆÔºåÁÑ∂ÂêéÈáçÊñ∞ÊâßË°å‰∏äËø∞Ê≠•È™§Ôºö
ÂçïÂáª‚ÄúOK‚ÄùÊåâÈíÆÔºö
<img src="./Oracle-RAC/89.png" alt="89"><br>
ÂçïÂáª‚ÄúNext‚ÄùÊåâÈíÆÊâßË°å‰∏ã‰∏ÄÊ≠•Ôºö
<img src="./Oracle-RAC/90.png" alt="90"><br>
Á°ÆËÆ§Êó†ÈóÆÈ¢òÂêéÂçïÂáª‚ÄúNext‚Äù‰∏ã‰∏ÄÊ≠•Ôºö
ÈÄâÊã©‚ÄúOracle Automatic Storage Managemnet(Oracle ASM)‚ÄùÔºåÁÑ∂ÂêéÂçïÂáª‚ÄúNext‚ÄùÊåâÈíÆÊâßË°å‰∏ã‰∏ÄÊ≠•:
<img src="./Oracle-RAC/91.png" alt="91"><br>
Ê≥®ÊÑèËØ•Á™óÂè£‰∏∫ÊåáÂÆöÁî®Êù•‰øùÂ≠òocrÂíåvoting diskÁöÑASM DiskGroupÔºåÂ¶ÇÊûúÁîü‰∫ßÁéØÂ¢ÉÔºåDiskGroupName‰∏∫SYSTEMDGÂπ∂‰∏îRedundancy‰∏∫NormalÔºåÁÑ∂ÂêéÈÄâÊã©3Âùó2GÁöÑÂ∞èÁõòÔºõÂ¶ÇÊûú‰∏∫ÈùûÁîü‰∫ßÁéØÂ¢ÉÂèØ‰ª•Â∞ÜOCRÂíåDBÂÖ±‰∫´‰∏Ä‰∏™Á£ÅÁõòÁªÑÂπ∂‰∏îÂ∞ÜRedundancyËÆæÁΩÆ‰∏∫External„ÄÇÂ¶ÇÊûúÂú®Add DisksÈ°πÊ≤°ÊúâÂá∫Áé∞ASMÁ£ÅÁõòÔºåÂàôÂèØËÉΩÊòØÁ£ÅÁõòÊùÉÈôêËÆæÁΩÆÂíåÂ±û‰∏ªÊúâÈóÆÈ¢ò„ÄÇ
ÂçïÂáªChange Discovery PathÊåâÈíÆËÆæÁΩÆASMÁ£ÅÁõòËÆøÈóÆË∑ØÂæÑÔºàËøôÈáåËÆæÁΩÆÁúüÂÆûÁ£ÅÁõòËÆøÈóÆË∑ØÂæÑÔºåÊ≠§Â§Ñ‰∏∫Â§öË∑ØÂæÑÁ£ÅÁõòÁöÑËÆøÈóÆË∑ØÂæÑ/dev/asm*ÔºâÔºåÁÑ∂ÂêéÂçïÂáª‚ÄúOK‚ÄùÔºö
<img src="./Oracle-RAC/92.png" alt="92"><br>
ÈÄâÊã©Â§ßÂ∞è‰∏∫2GÁöÑ‰∏âÂùóÁõòÔºåÁÑ∂ÂêéÂçïÂáª‚ÄúNext‚ÄùÊåâÈíÆÊâßË°å‰∏ã‰∏ÄÊ≠•Ôºö
<img src="./Oracle-RAC/93.png" alt="93"><br>
ÈÄâÊã©‚ÄúUse same passwords for these accounts‚ÄùÁÑ∂ÂêéÁÑ∂ËæìÂÖ•Âè£‰ª§ÔºåÁÑ∂ÂêéÂçïÂáª‚ÄúNext‚ÄùÊåâÈíÆÊâßË°å‰∏ã‰∏ÄÊ≠•Ôºö
<img src="./Oracle-RAC/94.png" alt="94"><br>
IPMI‰∏ÄËà¨‰∏çËÆæÁΩÆÔºåÂçïÂáª‚ÄúNext‚ÄùÊåâÈíÆËøõË°å‰∏ã‰∏ÄÊ≠•Ôºö
<img src="./Oracle-RAC/95.png" alt="95"><br>
‰ΩøÁî®Áº∫ÁúÅËÆæÁΩÆÔºåÁõ¥Êé•ÂçïÂáª‚ÄúNext‚ÄùÊåâÈíÆÊâßË°å‰∏ã‰∏ÄÊ≠•Ôºö
<img src="./Oracle-RAC/96.png" alt="96"><br>
Á°ÆËÆ§gridÁî®Êà∑ÁöÑORACLE_BASEË∑ØÂæÑ‰∏∫/home/app/gridÔºåORACLE_HOMEË∑ØÂæÑ‰∏∫/home/app/11.2.0.3/gridÔºåÁ°ÆËÆ§Êó†ËØØÂêéÂçïÂáª‚ÄúNext‚ÄùÊåâÈíÆÊâßË°å‰∏ã‰∏ÄÊ≠•Ôºö
<img src="./Oracle-RAC/97.png" alt="97"><br>
Á°ÆËÆ§Inventory Directory‰∏∫/home/app/oraInventoryÔºåÁÑ∂ÂêéÂçïÂáª‚ÄúNext‚ÄùÊåâÈíÆÊâßË°å‰∏ã‰∏ÄÊ≠•Ôºö
<img src="./Oracle-RAC/98.png" alt="98"><br>
Êé•ÁùÄÂá∫Áé∞Â¶Ç‰∏ãÂÆâË£ÖÂâçÊ£ÄÊü•ÁïåÈù¢Ôºö
<img src="./Oracle-RAC/99.png" alt="99"><br>
Êé•ÁùÄÂá∫Áé∞Â¶Ç‰∏ãÊ£ÄÊü•ÁªìÊûúÁïåÈù¢Ôºö
<img src="./Oracle-RAC/100.png" alt="100"><br>
Ê≠§Â§ÑÈúÄË¶ÅËØ¥ÊòéÁöÑÊòØÔºö
1Ôºâelfutils-libelf-devel-0.97ÂíåpdkshÂú®RedHat 6ÈáåÊó†ÈúÄÂÆâË£ÖÔºåÂèØÂøΩÁï•Ôºõ
2Ôºâresolv.conf‰∏∫DNSËß£ÊûêÁöÑÈÖçÁΩÆÔºåÂèØÂøΩÁï•Ôºõ
3ÔºâNetwork Time Protocol(NTP)Ëøô‰∏ÄÈ°πÔºåÊàë‰ª¨‰ΩøÁî®CTSSDÔºå‰∏çÈÖçÁΩÆNTPÔºåÂèØÂøΩÁï•Ôºõ
4) ASMÊ£ÄÊü•Â§±Ë¥•‰πüÂèØÂøΩÁï•„ÄÇ
Èô§‰∏äËø∞ÂèØÂøΩÁï•ÁöÑÂá†È°πÂ§ñÔºåÂ¶ÇÊûúËøòÊúâÂÖ∂‰ªñÁöÑÊú™Êª°Ë∂≥È°πÔºåÂàôÈúÄË¶ÅÂÖ∑‰ΩìÈóÆÈ¢òÂÖ∑‰ΩìÂàÜÊûêÔºåÂæÖËß£ÂÜ≥ÂêéÂÜçÂÆâË£ÖGRID„ÄÇ
Âõ†Ê≠§ÂèØ‰ª•ÈÄâÊã©‚ÄúIgnore All‚Äù,ÁÑ∂ÂêéÂçïÂáª‚ÄúNext‚ÄùÊåâÈíÆÊâßË°å‰∏ã‰∏ÄÊ≠•Ôºö
<img src="./Oracle-RAC/101.png" alt="101"><br>
Êé•ÁùÄÂá∫Áé∞ÂÆâË£ÖÊ¶ÇË¶ÅÁïåÈù¢ÔºåÁ°ÆËÆ§Êó†ËØØÂêéÂçïÂáª‚ÄúInstall‚ÄùÊåâÈíÆËøõË°åËΩØ‰ª∂ÂÆâË£ÖÔºö
<img src="./Oracle-RAC/102.png" alt="102">
Â¶Ç‰∏ãÊòØÂÆâË£ÖËøõÂ∫¶ÁïåÈù¢Ôºö
<img src="./Oracle-RAC/103.png" alt="103">
Êé•ÁùÄÂá∫Áé∞Â¶Ç‰∏ãÁïåÈù¢Ôºö
<img src="./Oracle-RAC/104.png" alt="104">
‰ª•rootÁî®Êà∑ÁôªÈôÜÁ≥ªÁªüÔºåÊâßË°å‰∏äÈù¢ÁöÑËÑöÊú¨ÔºåÈ°∫Â∫èÂ¶Ç‰∏ãÔºö
1Ôºâ Âú®epayrac1‰∏äÊâßË°åËÑöÊú¨1ÔºåÂú®epayrac2‰∏äÊâßË°åËÑöÊú¨1Ôºõ
2Ôºâ Âú®epayrac1‰∏äÊâßË°åËÑöÊú¨2ÔºåÂú®epayrac2‰∏äÊâßË°åËÑöÊú¨2„ÄÇ</p>
<p>ÂêÑ‰∏™ËäÇÁÇπÊâßË°å‰∏äËø∞ËÑöÊú¨ÊÉÖÂÜµÂ¶Ç‰∏ãÔºö</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[root@epayrac1 ~]# /home/app/oraInventory/orainstRoot.sh</span></span>
<span class="line"><span>Changing permissions of /home/app/oraInventory.</span></span>
<span class="line"><span>Adding read,write permissions for group.</span></span>
<span class="line"><span>Removing read,write,execute permissions for world.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Changing groupname of /home/app/oraInventory to oinstall.</span></span>
<span class="line"><span>The execution of the script is complete.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[root@epayrac2 ~]# /home/app/oraInventory/orainstRoot.sh</span></span>
<span class="line"><span>Changing permissions of /home/app/oraInventory.</span></span>
<span class="line"><span>Adding read,write permissions for group.</span></span>
<span class="line"><span>Removing read,write,execute permissions for world.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Changing groupname of /home/app/oraInventory to oinstall.</span></span>
<span class="line"><span>The execution of the script is complete.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[root@epayrac1 ~]# /home/app/11.2.0.3/grid/root.sh</span></span>
<span class="line"><span>Performing root user operation for Oracle 11g </span></span>
<span class="line"><span></span></span>
<span class="line"><span>The following environment variables are set as:</span></span>
<span class="line"><span>    ORACLE_OWNER= grid</span></span>
<span class="line"><span>    ORACLE_HOME=  /home/app/11.2.0.3/grid</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Enter the full pathname of the local bin directory: [/usr/local/bin]: </span></span>
<span class="line"><span>   Copying dbhome to /usr/local/bin ...</span></span>
<span class="line"><span>   Copying oraenv to /usr/local/bin ...</span></span>
<span class="line"><span>   Copying coraenv to /usr/local/bin ...</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>Creating /etc/oratab file...</span></span>
<span class="line"><span>Entries will be added to the /etc/oratab file as needed by</span></span>
<span class="line"><span>Database Configuration Assistant when a database is created</span></span>
<span class="line"><span>Finished running generic part of root script.</span></span>
<span class="line"><span>Now product-specific root actions will be performed.</span></span>
<span class="line"><span>Using configuration parameter file: /home/app/11.2.0.3/grid/crs/install/crsconfig_params</span></span>
<span class="line"><span>Creating trace directory</span></span>
<span class="line"><span>User ignored Prerequisites during installation</span></span>
<span class="line"><span>OLR initialization - successful</span></span>
<span class="line"><span>  root wallet</span></span>
<span class="line"><span>  root wallet cert</span></span>
<span class="line"><span>  root cert export</span></span>
<span class="line"><span>  peer wallet</span></span>
<span class="line"><span>  profile reader wallet</span></span>
<span class="line"><span>  pa wallet</span></span>
<span class="line"><span>  peer wallet keys</span></span>
<span class="line"><span>  pa wallet keys</span></span>
<span class="line"><span>  peer cert request</span></span>
<span class="line"><span>  pa cert request</span></span>
<span class="line"><span>  peer cert</span></span>
<span class="line"><span>  pa cert</span></span>
<span class="line"><span>  peer root cert TP</span></span>
<span class="line"><span>  profile reader root cert TP</span></span>
<span class="line"><span>  pa root cert TP</span></span>
<span class="line"><span>  peer pa cert TP</span></span>
<span class="line"><span>  pa peer cert TP</span></span>
<span class="line"><span>  profile reader pa cert TP</span></span>
<span class="line"><span>  profile reader peer cert TP</span></span>
<span class="line"><span>  peer user cert</span></span>
<span class="line"><span>  pa user cert</span></span>
<span class="line"><span>Adding Clusterware entries to upstart</span></span>
<span class="line"><span>CRS-2672: Attempting to start 'ora.mdnsd' on 'epayrac1'</span></span>
<span class="line"><span>CRS-2676: Start of 'ora.mdnsd' on 'epayrac1' succeeded</span></span>
<span class="line"><span>CRS-2672: Attempting to start 'ora.gpnpd' on 'epayrac1'</span></span>
<span class="line"><span>CRS-2676: Start of 'ora.gpnpd' on 'epayrac1' succeeded</span></span>
<span class="line"><span>CRS-2672: Attempting to start 'ora.cssdmonitor' on 'epayrac1'</span></span>
<span class="line"><span>CRS-2672: Attempting to start 'ora.gipcd' on 'epayrac1'</span></span>
<span class="line"><span>CRS-2676: Start of 'ora.cssdmonitor' on 'epayrac1' succeeded</span></span>
<span class="line"><span>CRS-2676: Start of 'ora.gipcd' on 'epayrac1' succeeded</span></span>
<span class="line"><span>CRS-2672: Attempting to start 'ora.cssd' on 'epayrac1'</span></span>
<span class="line"><span>CRS-2672: Attempting to start 'ora.diskmon' on 'epayrac1'</span></span>
<span class="line"><span>CRS-2676: Start of 'ora.diskmon' on 'epayrac1' succeeded</span></span>
<span class="line"><span>CRS-2676: Start of 'ora.cssd' on 'epayrac1' succeeded</span></span>
<span class="line"><span></span></span>
<span class="line"><span>ASM created and started successfully.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Disk Group SYSTEMDG created successfully.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>clscfg: -install mode specified</span></span>
<span class="line"><span>Successfully accumulated necessary OCR keys.</span></span>
<span class="line"><span>Creating OCR keys for user 'root', privgrp 'root'..</span></span>
<span class="line"><span>Operation successful.</span></span>
<span class="line"><span>CRS-4256: Updating the profile</span></span>
<span class="line"><span>Successful addition of voting disk 26c16c734fd64ffdbf102c26d4d5a4ed.</span></span>
<span class="line"><span>Successful addition of voting disk 7684d2a722754f19bf838c65ae52494b.</span></span>
<span class="line"><span>Successful addition of voting disk 59bade4e4cea4f0bbf77567c9c17cb12.</span></span>
<span class="line"><span>Successfully replaced voting disk group with +SYSTEMDG.</span></span>
<span class="line"><span>CRS-4256: Updating the profile</span></span>
<span class="line"><span>CRS-4266: Voting file(s) successfully replaced</span></span>
<span class="line"><span>##  STATE    File Universal Id                File Name Disk group</span></span>
<span class="line"><span>--  -----    -----------------                --------- ---------</span></span>
<span class="line"><span> 1. ONLINE   26c16c734fd64ffdbf102c26d4d5a4ed (/dev/mapper/asmocrvote1) [SYSTEMDG]</span></span>
<span class="line"><span> 2. ONLINE   7684d2a722754f19bf838c65ae52494b (/dev/mapper/asmocrvote2) [SYSTEMDG]</span></span>
<span class="line"><span> 3. ONLINE   59bade4e4cea4f0bbf77567c9c17cb12 (/dev/mapper/asmocrvote3) [SYSTEMDG]</span></span>
<span class="line"><span>Located 3 voting disk(s).</span></span>
<span class="line"><span>CRS-2672: Attempting to start 'ora.asm' on 'epayrac1'</span></span>
<span class="line"><span>CRS-2676: Start of 'ora.asm' on 'epayrac1' succeeded</span></span>
<span class="line"><span>CRS-2672: Attempting to start 'ora.SYSTEMDG.dg' on 'epayrac1'</span></span>
<span class="line"><span>CRS-2676: Start of 'ora.SYSTEMDG.dg' on 'epayrac1' succeeded</span></span>
<span class="line"><span>Preparing packages for installation...</span></span>
<span class="line"><span>cvuqdisk-1.0.9-1</span></span>
<span class="line"><span>Configure Oracle Grid Infrastructure for a Cluster ... succeeded</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[root@epayrac2 ~]# /home/app/11.2.0.3/grid/root.sh</span></span>
<span class="line"><span>Performing root user operation for Oracle 11g </span></span>
<span class="line"><span></span></span>
<span class="line"><span>The following environment variables are set as:</span></span>
<span class="line"><span>    ORACLE_OWNER= grid</span></span>
<span class="line"><span>    ORACLE_HOME=  /home/app/11.2.0.3/grid</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Enter the full pathname of the local bin directory: [/usr/local/bin]: </span></span>
<span class="line"><span>   Copying dbhome to /usr/local/bin ...</span></span>
<span class="line"><span>   Copying oraenv to /usr/local/bin ...</span></span>
<span class="line"><span>   Copying coraenv to /usr/local/bin ...</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>Creating /etc/oratab file...</span></span>
<span class="line"><span>Entries will be added to the /etc/oratab file as needed by</span></span>
<span class="line"><span>Database Configuration Assistant when a database is created</span></span>
<span class="line"><span>Finished running generic part of root script.</span></span>
<span class="line"><span>Now product-specific root actions will be performed.</span></span>
<span class="line"><span>Using configuration parameter file: /home/app/11.2.0.3/grid/crs/install/crsconfig_params</span></span>
<span class="line"><span>Creating trace directory</span></span>
<span class="line"><span>User ignored Prerequisites during installation</span></span>
<span class="line"><span>OLR initialization - successful</span></span>
<span class="line"><span>Adding Clusterware entries to upstart</span></span>
<span class="line"><span>CRS-4402: The CSS daemon was started in exclusive mode but found an active CSS daemon on node epayrac1, number 1, and is terminating</span></span>
<span class="line"><span>An active cluster was found during exclusive startup, restarting to join the cluster</span></span>
<span class="line"><span>Preparing packages for installation...</span></span>
<span class="line"><span>cvuqdisk-1.0.9-1</span></span>
<span class="line"><span>Configure Oracle Grid Infrastructure for a Cluster ... succeeded</span></span></code></pre>
</div><p>‰∏äÈù¢ÁöÑËÑöÊú¨ÊâßË°åÊàêÂäüÂêéÔºåÂçïÂáª‚ÄùOK‚ÄùÊåâÈíÆÔºåËá™Âä®ÊâßË°åÂá†‰∏™ÈÖçÁΩÆÊìç‰ΩúÂêéÔºåÂá∫Áé∞Â¶Ç‰∏ãÁ™óÂè£Ôºö</p>
<p><img src="./Oracle-RAC/105.png" alt="105">
Áî±‰∫éSCAN VIP‰∏ªÊú∫Âêçepayrac-scanÊ≤°ÊúâÂú®DNSÊ≥®ÂÜåÔºåÂØºËá¥Oracle Cluster Verification UtilityÂ§±Ë¥•ÔºåÂèØ‰ª•ÂøΩÁï•Ê≠§ÈîôËØØ„ÄÇ</p>
<p>ÂçïÂáª‚ÄúOK‚ÄùÊåâÈíÆÔºö
<img src="./Oracle-RAC/106.png" alt="106"></p>
<p>ÂçïÂáª‚ÄúNext‚ÄùÊåâÈíÆÁªßÁª≠Ôºö
<img src="./Oracle-RAC/107.png" alt="107">
ÂçïÂáª‚ÄúYes‚ÄùÊåâÈíÆÔºö
<img src="./Oracle-RAC/108.png" alt="108">
ÂçïÂáª‚ÄúClose‚ÄùÊåâÈíÆÔºåËá≥Ê≠§Grid 11.2.0.3ËΩØ‰ª∂ÂÆâË£ÖÂÆåÊØï„ÄÇ</p>
<h3 id="_4-2-db-ËΩØ‰ª∂ÂÆâË£Ö" tabindex="-1">4.2 DB ËΩØ‰ª∂ÂÆâË£Ö <a class="header-anchor" href="#_4-2-db-ËΩØ‰ª∂ÂÆâË£Ö" aria-label="Permalink to &quot;4.2 DB ËΩØ‰ª∂ÂÆâË£Ö&quot;"></a></h3>
<p>‰ª•oracleÁî®Êà∑ÁôªÂΩïÁ¨¨‰∏Ä‰∏™ËäÇÁÇπÔºåÁÑ∂ÂêéÊâßË°årunInstallerÂëΩ‰ª§ÂÆâË£ÖDBËΩØ‰ª∂,ÂÖ∑‰ΩìÂÆâË£ÖÊ≠•È™§Â¶Ç‰∏ãÔºöÊâßË°å./runInstallerÂÆâË£ÖÔºö</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[oracle@epayrac1 ~]$ cd /home/oracle_install/database</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[oracle@epayrac1 database]$ ./runInstaller</span></span>
<span class="line"><span>Starting Oracle Universal Installer...</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Checking Temp space: must be greater than 120 MB.   Actual 3994 MB    Passed</span></span>
<span class="line"><span>Checking swap space: must be greater than 150 MB.   Actual 32145 MB    Passed</span></span>
<span class="line"><span>Checking monitor: must be configured to display at least 256 colors.    Actual 16777216    Passed</span></span>
<span class="line"><span>Preparing to launch Oracle Universal Installer from /tmp/OraInstall2014-08-21_07-09-01PM. Please wait ...</span></span></code></pre>
</div><p>ÊâßË°årunInstallerÂêéÂá∫Áé∞Â¶Ç‰∏ãÂÆâË£ÖÁïåÈù¢Ôºö
ÂèñÊ∂à‚ÄúI wish to receive security updates via My Oracle Support‚ÄùÈÄâÈ°πÔºåÁÑ∂ÂêéÂçïÂáª‚ÄúNext‚ÄùÊåâÈíÆÊâßË°å‰∏ã‰∏ÄÊ≠•Ôºö</p>
<p><img src="./Oracle-RAC/109.png" alt="109">
ÂçïÂáª‚ÄúYes‚ÄùÊåâÈíÆ:
<img src="./Oracle-RAC/110.png" alt="110">
ÈÄâÊã©‚ÄúSkip software updates‚ÄùÈÄâÈ°πÔºåÁÑ∂ÂêéÂçïÂáª‚ÄúNext‚ÄùÊåâÈíÆÊâßË°å‰∏ã‰∏ÄÊ≠•Ôºö
<img src="./Oracle-RAC/111.png" alt="111">
ÈÄâÊã©‚ÄúInstall database software only‚ÄùÈÄâÈ°πÔºåÁÑ∂ÂêéÂçïÂáª‚ÄúNext‚ÄùÊåâÈíÆÊâßË°å‰∏ã‰∏ÄÊ≠•Ôºö
<img src="./Oracle-RAC/112.png" alt="112">
ÈÄâÊã©‚ÄúOracle Real Application Clusters database installation‚ÄùÈÄâÈ°πÔºåÁ°Æ‰øùÁ¨¨‰∫å‰∏™ËäÇÁÇπepayrac2Â∑≤Ë¢´ÂãæÈÄâ:
<img src="./Oracle-RAC/113.png" alt="113">
ÂçïÂáªSSH ConnectivityÊåâÈíÆÂêéÔºåÂçïÂáª‚Äúsetup‚ÄùÊåâÈíÆÔºåÂá∫Áé∞‰ª•‰∏ãÊàêÂäüÁ™óÂè£Ôºö
<img src="./Oracle-RAC/114.png" alt="114">
ÂçïÂáª‚ÄúOK‚ÄùÊåâÈíÆÔºåËøîÂõûÂêéÂÜçÂçïÂáª‚ÄúNext‚ÄùÊåâÈíÆÊâßË°å‰∏ã‰∏ÄÊ≠•Ôºö
<img src="./Oracle-RAC/115.png" alt="115">
ÂçïÂáª‚ÄúNext‚ÄùÊåâÈíÆÊâßË°å‰∏ã‰∏ÄÊ≠•Ôºö
<img src="./Oracle-RAC/116.png" alt="116">
ÈÄâÊã©‚ÄúEnterprise Edition(4.5GB)‚Äù,ÂçïÂáª‚ÄúNext‚ÄùÊåâÈíÆÊâßË°å‰∏ã‰∏ÄÊ≠•Ôºö
<img src="./Oracle-RAC/117.png" alt="117">
Á°ÆËÆ§ÁõÆÂΩïÊ≠£Á°ÆÊó†ËØØÂêéÔºàOracleÁî®Êà∑ÁöÑORACLE_BASEË∑ØÂæÑÊòØ/home/app/oracleÔºåOracleÁî®Êà∑ORACLE_HOMEË∑ØÂæÑÊòØ/home/app/oracle/product/11.2.0.3/db_1ÔºâÂçïÂáª‚ÄúNext‚ÄùÊåâÈíÆÊâßË°å‰∏ã‰∏ÄÊ≠•Ôºö
<img src="./Oracle-RAC/118.png" alt="118">
Database OperatorÁªÑÂèØ‰∏çÈÄâÔºåÁõ¥Êé•ÂçïÂáª‚ÄúNext‚ÄùÊåâÈíÆÊâßË°å‰∏ã‰∏ÄÊ≠•Ôºö
<img src="./Oracle-RAC/119.png" alt="119">
Êé•ÁùÄÂá∫Áé∞Â¶Ç‰∏ãÂÆâË£ÖÊ£ÄÊü•ÁïåÈù¢Ôºö
<img src="./Oracle-RAC/120.png" alt="120">
Êé•ÁùÄÂá∫Áé∞Â¶Ç‰∏ãÊ£ÄÊü•ÁªìÊûúÁïåÈù¢Ôºö
<img src="./Oracle-RAC/121.png" alt="121">
Ê≠§Â§ÑÈúÄË¶ÅËØ¥ÊòéÁöÑÊòØÔºö
1Ôºâelfutils-libelf-devel-0.97ÂíåpdkshÂú®RedHat 6ÈáåÊó†ÈúÄÂÆâË£ÖÔºåÂèØÂøΩÁï•Ôºõ
2Ôºâresolv.conf‰∏∫DNSËß£ÊûêÁöÑÈÖçÁΩÆÔºåÂèØÂøΩÁï•Ôºõ
3ÔºâClock SynchronizationËøô‰∏ÄÈ°πÔºåÊàë‰ª¨‰ΩøÁî®CTSSDÔºå‰∏çÈÖçÁΩÆNTPÔºåÂèØÂøΩÁï•Ôºõ
4) Single Client Access Name(SCAN)Ëøô‰∏ÄÈ°πÔºå‰∏∫Ê≤°ÊúâÈÖçÁΩÆDNSÊâÄËá¥ÔºåÂèØÂøΩÁï•Ôºõ
Èô§‰∏äËø∞ÂèØÂøΩÁï•ÁöÑÂá†È°πÂ§ñÔºåÂ¶ÇÊûúËøòÊúâÂÖ∂‰ªñÁöÑÊú™Êª°Ë∂≥È°πÔºåÂàôÈúÄË¶ÅÂÖ∑‰ΩìÈóÆÈ¢òÂÖ∑‰ΩìÂàÜÊûêÔºåÂæÖËß£ÂÜ≥ÂêéÂÜçÂÆâË£ÖÊï∞ÊçÆÂ∫ìËΩØ‰ª∂„ÄÇ
Âõ†Ê≠§ÂèØ‰ª•ÈÄâÊã©‚ÄúIgnore All‚Äù,ÁÑ∂ÂêéÂçïÂáª‚ÄúNext‚ÄùÊåâÈíÆÊâßË°å‰∏ã‰∏ÄÊ≠•Ôºö
<img src="./Oracle-RAC/122.png" alt="122"></p>
<p>ÂçïÂáª‚ÄúInstall‚ÄùÊåâÈíÆÊâßË°å‰∏ã‰∏ÄÊ≠•Ôºö
<img src="./Oracle-RAC/123.png" alt="123"></p>
<p>Â¶Ç‰∏ãÊòØÂÆâË£ÖËøõÂ∫¶ÁïåÈù¢Ôºö
<img src="./Oracle-RAC/124.png" alt="124"></p>
<p>Êé•ÁùÄÂá∫Áé∞Â¶Ç‰∏ãÁïåÈù¢Ôºö
<img src="./Oracle-RAC/125.png" alt="125">
‰ª•rootÁî®Êà∑ÁôªÈôÜÁ≥ªÁªüÔºåÊâßË°å‰∏äÈù¢ÁöÑËÑöÊú¨ÔºåÈ°∫Â∫èÂ¶Ç‰∏ãÔºö
Âú®epayrac1‰∏äÊâßË°åËÑöÊú¨1ÔºåÂú®epayrac2‰∏äÊâßË°åËÑöÊú¨1Ôºõ</p>
<p>ËäÇÁÇπ1ÁöÑÊâßË°åÊÉÖÂÜµÔºö</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[root@epayrac1 ~]# /home/app/oracle/product/11.2.0.3/db_1/root.sh</span></span>
<span class="line"><span>Performing root user operation for Oracle 11g </span></span>
<span class="line"><span></span></span>
<span class="line"><span>The following environment variables are set as:</span></span>
<span class="line"><span>    ORACLE_OWNER= oracle</span></span>
<span class="line"><span>    ORACLE_HOME=  /home/app/oracle/product/11.2.0.3/db_1</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Enter the full pathname of the local bin directory: [/usr/local/bin]: </span></span>
<span class="line"><span>The contents of "dbhome" have not changed. No need to overwrite.</span></span>
<span class="line"><span>The contents of "oraenv" have not changed. No need to overwrite.</span></span>
<span class="line"><span>The contents of "coraenv" have not changed. No need to overwrite.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Entries will be added to the /etc/oratab file as needed by</span></span>
<span class="line"><span>Database Configuration Assistant when a database is created</span></span>
<span class="line"><span>Finished running generic part of root script.</span></span>
<span class="line"><span>Now product-specific root actions will be performed.</span></span>
<span class="line"><span>Finished product-specific root actions.</span></span></code></pre>
</div><p>ËäÇÁÇπ2ÁöÑÊâßË°åÊÉÖÂÜµÔºö</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[root@epayrac2 ~]# /home/app/oracle/product/11.2.0.3/db_1/root.sh</span></span>
<span class="line"><span>Performing root user operation for Oracle 11g </span></span>
<span class="line"><span></span></span>
<span class="line"><span>The following environment variables are set as:</span></span>
<span class="line"><span>    ORACLE_OWNER= oracle</span></span>
<span class="line"><span>    ORACLE_HOME=  /home/app/oracle/product/11.2.0.3/db_1</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Enter the full pathname of the local bin directory: [/usr/local/bin]: </span></span>
<span class="line"><span>The contents of "dbhome" have not changed. No need to overwrite.</span></span>
<span class="line"><span>The contents of "oraenv" have not changed. No need to overwrite.</span></span>
<span class="line"><span>The contents of "coraenv" have not changed. No need to overwrite.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Entries will be added to the /etc/oratab file as needed by</span></span>
<span class="line"><span>Database Configuration Assistant when a database is created</span></span>
<span class="line"><span>Finished running generic part of root script.</span></span>
<span class="line"><span>Now product-specific root actions will be performed.</span></span>
<span class="line"><span>Finished product-specific root actions.</span></span></code></pre>
</div><p>‰∏äÈù¢ÁöÑËÑöÊú¨ÊâßË°åÊàêÂäüÂêéÔºåÂçïÂáª‚ÄùOK‚ÄùÊåâÈíÆÔºåÂá∫Áé∞Â¶Ç‰∏ãÁïåÈù¢Ôºö
<img src="./Oracle-RAC/126.png" alt="126"></p>
<p>ÂçïÂáª‚ÄúClose‚ÄùÊåâÈíÆ,Oracle database 11.2.0.3ËΩØ‰ª∂ÂÆâË£ÖÂÆåÊØï„ÄÇ</p>
<h3 id="_4-3-ÂàõÂª∫-asm-Á£ÅÁõòÁªÑ" tabindex="-1">4.3 ÂàõÂª∫ ASM Á£ÅÁõòÁªÑ <a class="header-anchor" href="#_4-3-ÂàõÂª∫-asm-Á£ÅÁõòÁªÑ" aria-label="Permalink to &quot;4.3 ÂàõÂª∫ ASM Á£ÅÁõòÁªÑ&quot;"></a></h3>
<p>‰ª•gridÁî®Êà∑ÁôªÂΩïËäÇÁÇπ1ÊâßË°åASMCAÂàõÂª∫DATADGÂíåARCHDG</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[grid@epayrac1 ~]$ asmca</span></span></code></pre>
</div><p>ÊâßË°åasmcaÂêéÂá∫Áé∞Â¶Ç‰∏ãÂÆâË£ÖÁïåÈù¢Ôºö</p>
<p><img src="./Oracle-RAC/127.png" alt="127">
ÁÇπÂáª‚ÄúCreate‚ÄùÊåâÈíÆÔºåÈÄâÊã©asmr1datadisk1ÔºåÈÄâÊã©External RedundancyÔºåÂàõÂª∫Á£ÅÁõòÁªÑDATADG1Ôºö
<img src="./Oracle-RAC/128.png" alt="128">
ÁÇπÂáª‚ÄúOK‚ÄùÊåâÈíÆÔºö
<img src="./Oracle-RAC/129.png" alt="129"></p>
<p>‰ªéÂ¶Ç‰∏ãÁªìÊûú‰∏≠ÂèØ‰ª•ÁúãÂà∞Á£ÅÁõòÁªÑDATADGÂ∑≤ÁªèÊàêÂäüÂàõÂª∫Ôºö
<img src="./Oracle-RAC/130.png" alt="130"></p>
<p>ÁÇπÂáª‚ÄúCreate‚ÄùÊåâÈíÆÔºåÈÄâÊã©asmr5datadisk1ÔºåÂàõÂª∫Á£ÅÁõòÁªÑARCHDGÔºö
<img src="./Oracle-RAC/131.png" alt="131"></p>
<p>‰ªéÂ¶Ç‰∏ãÁªìÊûú‰∏≠ÂèØ‰ª•ÁúãÂà∞Á£ÅÁõòÁªÑFRADGÂ∑≤ÁªèÊàêÂäüÂàõÂª∫Ôºö
<img src="./Oracle-RAC/132.png" alt="132"></p>
<h3 id="_4-4-Âª∫Â∫ì" tabindex="-1">4.4 Âª∫Â∫ì <a class="header-anchor" href="#_4-4-Âª∫Â∫ì" aria-label="Permalink to &quot;4.4 Âª∫Â∫ì&quot;"></a></h3>
<p>‰ª•oracleÁî®Êà∑ÁôªÂΩïËäÇÁÇπ1ÊâßË°åDBCAÂª∫Â∫ì
Ê≥®ÊÑèË¶Å‰øÆÊîπÁõ∏ÂÖ≥ËÆæÁΩÆÔºåÂ¶ÇÂ≠óÁ¨¶ÈõÜ„ÄÅÂΩíÊ°£Ê®°Âºè„ÄÅredo logÂ§ßÂ∞è„ÄÅmultiplex redo logËÆæÁΩÆÁ≠â
[oracle@epayrac1 ~]$ dbca</p>
<p>ÊâßË°ådbcaÂêéÂá∫Áé∞Â¶Ç‰∏ãÂÆâË£ÖÁïåÈù¢Ôºö
<img src="./Oracle-RAC/133.png" alt="133">
<img src="./Oracle-RAC/134.png" alt="134">
<img src="./Oracle-RAC/135.png" alt="135">
<img src="./Oracle-RAC/136.png" alt="136">
<img src="./Oracle-RAC/137.png" alt="137">
<img src="./Oracle-RAC/138.png" alt="138">
<img src="./Oracle-RAC/139.png" alt="139">
<img src="./Oracle-RAC/140.png" alt="140">
<img src="./Oracle-RAC/141.png" alt="141">
<img src="./Oracle-RAC/142.png" alt="142">
<img src="./Oracle-RAC/143.png" alt="143">
<img src="./Oracle-RAC/144.png" alt="144">
<img src="./Oracle-RAC/145.png" alt="145">
<img src="./Oracle-RAC/146.png" alt="146">
<img src="./Oracle-RAC/147.png" alt="147"></p>
<h2 id="‰∫î„ÄÅÂ∏∏ËßÅÈóÆÈ¢òËß£ÂÜ≥" tabindex="-1">‰∫î„ÄÅÂ∏∏ËßÅÈóÆÈ¢òËß£ÂÜ≥ <a class="header-anchor" href="#‰∫î„ÄÅÂ∏∏ËßÅÈóÆÈ¢òËß£ÂÜ≥" aria-label="Permalink to &quot;‰∫î„ÄÅÂ∏∏ËßÅÈóÆÈ¢òËß£ÂÜ≥&quot;"></a></h2>
<p>Red Hat Linux6.9ÂÆâË£ÖRAC11.2.0.4.0ÔºådbcaÂª∫Â∫ìÈÖçÁΩÆASMÊó∂Êä•ÈîôÔºö
Counld not connect to ASM due to following error,ora-12547:TNS:lost comact
<img src="./Oracle-RAC/148.png" alt="148">
Ëß£ÂÜ≥ÂäûÊ≥ïÔºö</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[grid@liuqi1 oracle]$ cd $ORACLE_HOME/bin</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[grid@liuqi1 bin]$ ll oracle</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">-rwxr-x--x</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> grid</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oinstall</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 203974257</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Mar</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  9</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 20:42</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oracle</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[grid@liuqi1 bin]$ chmod 6751 oracle</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[grid@liuqi1 bin]$ ll oracle</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">-rwsr-s--x</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> grid</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oinstall</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 203974257</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Mar</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  9</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 20:42</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oracle</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[grid@liuqi1 bin]$</span></span></code></pre>
</div><p>Â∞Ü$GRID_HOME/binÂíå$ORACLE_HOME/bin‰∏ãÁöÑoracleÈÉΩËµã6751ÊùÉÈôêÔºö</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">chmod</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 6751</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> $GRID_HOME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">/bin/oracle</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">chmod</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 6751</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> $ORACLE_HOME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">/bin/oracle</span></span></code></pre>
</div>]]></content:encoded>
            <enclosure url="https://askaric.com/Oracle-RAC/01.png" length="0" type="image/png"/>
        </item>
        <item>
            <title><![CDATA[Oracle 11gÂçïÂ∫ìASMÈÉ®ÁΩ≤]]></title>
            <link>https://askaric.com/zh/work/oracle/Start-OracleÂçïÂÆû‰æãASMÈÉ®ÁΩ≤.html</link>
            <guid>https://askaric.com/zh/work/oracle/Start-OracleÂçïÂÆû‰æãASMÈÉ®ÁΩ≤.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[# Oracle 11gÂçïÂ∫ìASMÈÉ®ÁΩ≤

> [DBNEST -- ÊóßÁâàÊñáÊ°£ ‚ÄúÁÇπÂáª‚Äù Áõ¥Êé•ÊµèËßàÊàñ‰∏ãËΩΩ PDF](./Oracle11gÂçïÂÆû‰æãASMÈùôÈªòÂÆâË£Ö.pdf)

## ‰∏Ä„ÄÅÁéØÂ¢ÉËØ¥Êòé

| ÂèÇÊï∞Âêç | ÂèÇÊï∞ÂÄº |
| - | - |
| ÊúçÂä°Âô®ÁéØÂ¢É | Red Hat Enterprise Linux Server release 6.9 (Santiago) |
| OracleÁâàÊú¨ | Oracle Database 11g Enterprise Edition Release 11.2.0.4.0 |
| gridËΩØ‰ª∂ÁâàÊú¨ | 11g Enterprise Edition Release 11.2.0.4.0 |

## ‰∫å„ÄÅÂª∫Á´ãÊï∞ÊçÆÂ∫ì

### 2.1 ËôöÊãüÊú∫Âª∫Á´ãÂÖ±‰∫´Áõò

```shell
[root@jandb ~]# fdisk -l

Disk /dev/sda: 8589 MB, 8589934592 bytes
255 heads, 63 sectors/track, 1044 cylinders
Units = cylinders of 16065 * 512 = 8225280 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Disk identifier: 0x00057041

   Device Boot      Start         End      Blocks   Id  System
/dev/sda1   *           1          26      204800   83  Linux
Partition 1 does not end on cylinder boundary.
/dev/sda2              26         287     2097152   82  Linux swap / Solaris
Partition 2 does not end on cylinder boundary.
/dev/sda3             287        1045     6085632   83  Linux

Disk /dev/sdb: 10.7 GB, 10737418240 bytes
255 heads, 63 sectors/track, 1305 cylinders
Units = cylinders of 16065 * 512 = 8225280 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Disk identifier: 0x00000000

[root@jandb ~]# ls -al  /dev/sd*
brw-rw]]></description>
            <content:encoded><![CDATA[<h1 id="oracle-11gÂçïÂ∫ìasmÈÉ®ÁΩ≤" tabindex="-1">Oracle 11gÂçïÂ∫ìASMÈÉ®ÁΩ≤ <a class="header-anchor" href="#oracle-11gÂçïÂ∫ìasmÈÉ®ÁΩ≤" aria-label="Permalink to &quot;Oracle 11gÂçïÂ∫ìASMÈÉ®ÁΩ≤&quot;"></a></h1>
<blockquote>
<p><a href="./Oracle11g%E5%8D%95%E5%AE%9E%E4%BE%8BASM%E9%9D%99%E9%BB%98%E5%AE%89%E8%A3%85.pdf">DBNEST -- ÊóßÁâàÊñáÊ°£ ‚ÄúÁÇπÂáª‚Äù Áõ¥Êé•ÊµèËßàÊàñ‰∏ãËΩΩ PDF</a></p>
</blockquote>
<h2 id="‰∏Ä„ÄÅÁéØÂ¢ÉËØ¥Êòé" tabindex="-1">‰∏Ä„ÄÅÁéØÂ¢ÉËØ¥Êòé <a class="header-anchor" href="#‰∏Ä„ÄÅÁéØÂ¢ÉËØ¥Êòé" aria-label="Permalink to &quot;‰∏Ä„ÄÅÁéØÂ¢ÉËØ¥Êòé&quot;"></a></h2>
<table tabindex="0">
<thead>
<tr>
<th>ÂèÇÊï∞Âêç</th>
<th>ÂèÇÊï∞ÂÄº</th>
</tr>
</thead>
<tbody>
<tr>
<td>ÊúçÂä°Âô®ÁéØÂ¢É</td>
<td>Red Hat Enterprise Linux Server release 6.9 (Santiago)</td>
</tr>
<tr>
<td>OracleÁâàÊú¨</td>
<td>Oracle Database 11g Enterprise Edition Release 11.2.0.4.0</td>
</tr>
<tr>
<td>gridËΩØ‰ª∂ÁâàÊú¨</td>
<td>11g Enterprise Edition Release 11.2.0.4.0</td>
</tr>
</tbody>
</table>
<h2 id="‰∫å„ÄÅÂª∫Á´ãÊï∞ÊçÆÂ∫ì" tabindex="-1">‰∫å„ÄÅÂª∫Á´ãÊï∞ÊçÆÂ∫ì <a class="header-anchor" href="#‰∫å„ÄÅÂª∫Á´ãÊï∞ÊçÆÂ∫ì" aria-label="Permalink to &quot;‰∫å„ÄÅÂª∫Á´ãÊï∞ÊçÆÂ∫ì&quot;"></a></h2>
<h3 id="_2-1-ËôöÊãüÊú∫Âª∫Á´ãÂÖ±‰∫´Áõò" tabindex="-1">2.1 ËôöÊãüÊú∫Âª∫Á´ãÂÖ±‰∫´Áõò <a class="header-anchor" href="#_2-1-ËôöÊãüÊú∫Âª∫Á´ãÂÖ±‰∫´Áõò" aria-label="Permalink to &quot;2.1 ËôöÊãüÊú∫Âª∫Á´ãÂÖ±‰∫´Áõò&quot;"></a></h3>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[root@jandb </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]# fdisk -l</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Disk</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /dev/sda:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 8589</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> MB,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 8589934592</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> bytes</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">255</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> heads,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 63</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> sectors/track,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1044</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> cylinders</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Units</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> cylinders</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> of</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 16065</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 512</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 8225280</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> bytes</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Sector</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> size</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (logical/physical): 512 bytes / 512 bytes</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">I/O</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> size</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (minimum/optimal): 512 bytes / 512 bytes</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Disk</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> identifier:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 0x00057041</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">   Device</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Boot</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      Start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">         End</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      Blocks</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   Id</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  System</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">/dev/sda1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">           1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">          26</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">      204800</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   83</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Linux</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Partition</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> does</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> not</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> end</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> on</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> cylinder</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> boundary.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">/dev/sda2</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">              26</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">         287</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">     2097152</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   82</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Linux</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> swap</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Solaris</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Partition</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> does</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> not</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> end</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> on</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> cylinder</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> boundary.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">/dev/sda3</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">             287</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">        1045</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">     6085632</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   83</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Linux</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Disk</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /dev/sdb:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 10.7</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> GB,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 10737418240</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> bytes</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">255</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> heads,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 63</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> sectors/track,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1305</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> cylinders</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Units</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> cylinders</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> of</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 16065</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 512</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 8225280</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> bytes</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Sector</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> size</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (logical/physical): 512 bytes / 512 bytes</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">I/O</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> size</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (minimum/optimal): 512 bytes / 512 bytes</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Disk</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> identifier:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 0x00000000</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[root@jandb </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]# ls -al  /dev/sd</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">brw-rw----.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> root</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> disk</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 8,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Nov</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  4</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 05:21</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /dev/sda</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">brw-rw----.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> root</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> disk</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 8,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Nov</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  4</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 05:21</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /dev/sda1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">brw-rw----.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> root</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> disk</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 8,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Nov</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  4</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 05:21</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /dev/sda2</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">brw-rw----.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> root</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> disk</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 8,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  3</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Nov</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  4</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 05:21</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /dev/sda3</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">brw-rw----.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> root</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> disk</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 8,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 16</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Nov</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  4</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 05:21</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /dev/sdb</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[root@jandb </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]# fdisk /dev/sdb</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[root@jandb </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]# fdisk -l</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Disk</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /dev/sda:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 8589</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> MB,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 8589934592</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> bytes</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">255</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> heads,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 63</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> sectors/track,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1044</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> cylinders</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Units</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> cylinders</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> of</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 16065</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 512</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 8225280</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> bytes</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Sector</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> size</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (logical/physical): 512 bytes / 512 bytes</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">I/O</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> size</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (minimum/optimal): 512 bytes / 512 bytes</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Disk</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> identifier:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 0x00057041</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">   Device</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Boot</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      Start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">         End</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      Blocks</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   Id</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  System</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">/dev/sda1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">           1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">          26</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">      204800</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   83</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Linux</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Partition</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> does</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> not</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> end</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> on</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> cylinder</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> boundary.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">/dev/sda2</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">              26</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">         287</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">     2097152</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   82</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Linux</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> swap</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Solaris</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Partition</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> does</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> not</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> end</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> on</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> cylinder</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> boundary.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">/dev/sda3</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">             287</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">        1045</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">     6085632</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   83</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Linux</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Disk</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /dev/sdb:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 10.7</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> GB,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 10737418240</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> bytes</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">255</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> heads,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 63</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> sectors/track,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1305</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> cylinders</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Units</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> cylinders</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> of</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 16065</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 512</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 8225280</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> bytes</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Sector</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> size</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (logical/physical): 512 bytes / 512 bytes</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">I/O</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> size</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (minimum/optimal): 512 bytes / 512 bytes</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Disk</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> identifier:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 0xf207b5b8</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">   Device</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Boot</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      Start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">         End</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      Blocks</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   Id</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  System</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">/dev/sdb1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">               1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">         654</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     5253223+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  83</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Linux</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">/dev/sdb2</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">             655</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">        1305</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     5229157+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  83</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Linux</span></span></code></pre>
</div><h3 id="_2-2-ÂàõÂª∫ÁªÑÂíåÁî®Êà∑" tabindex="-1">2.2 ÂàõÂª∫ÁªÑÂíåÁî®Êà∑ <a class="header-anchor" href="#_2-2-ÂàõÂª∫ÁªÑÂíåÁî®Êà∑" aria-label="Permalink to &quot;2.2 ÂàõÂª∫ÁªÑÂíåÁî®Êà∑&quot;"></a></h3>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">groupadd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -g</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1000</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oinstall</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">groupadd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -g</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1001</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dba</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">groupadd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -g</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1002</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oper</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">groupadd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -g</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1003</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> asmadmin</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">groupadd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -g</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1004</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> asmdba</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">groupadd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -g</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1005</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> asmoper</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">useradd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -u</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 2000</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -g</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oinstall</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -G</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> asmadmin,asmdba,asmoper,dba</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /home/grid</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> grid</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">useradd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -u</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 2001</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -g</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oinstall</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -G</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> asmdba,asmadmin,dba,oper</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /home/oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oracle</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">passwd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> grid</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">passwd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oracle</span></span></code></pre>
</div><h3 id="_2-3-ÂàõÂª∫ÁõÆÂΩï" tabindex="-1">2.3 ÂàõÂª∫ÁõÆÂΩï <a class="header-anchor" href="#_2-3-ÂàõÂª∫ÁõÆÂΩï" aria-label="Permalink to &quot;2.3 ÂàõÂª∫ÁõÆÂΩï&quot;"></a></h3>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">mkdir</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /oracle/app/grid</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">mkdir</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /oracle/app/11.2.0/grid</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">chown</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -R</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> grid:oinstall</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /oracle</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">mkdir</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /oracle/app/oracle</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">chown</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -R</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oracle:oinstall</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /oracle/app/oracle</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">chmod</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -R</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 775</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /oracle</span></span></code></pre>
</div><h3 id="_2-4-‰øÆÊîπÂÜÖÊ†∏ÂèÇÊï∞" tabindex="-1">2.4 ‰øÆÊîπÂÜÖÊ†∏ÂèÇÊï∞ <a class="header-anchor" href="#_2-4-‰øÆÊîπÂÜÖÊ†∏ÂèÇÊï∞" aria-label="Permalink to &quot;2.4 ‰øÆÊîπÂÜÖÊ†∏ÂèÇÊï∞&quot;"></a></h3>
<p>È¶ñÂÖàÊ≥®ÈîÄÊéâÈÖçÁΩÆÊñá‰ª∂ÊúÄÂêé6Ë°åÂÜÖÂÆπÔºåÁÑ∂ÂêéÊ∑ªÂä†‰∏ãÈù¢8Ë°åÂÜÖÂÆπ„ÄÇ</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[root@jandb </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]# vim /etc/sysctl.conf</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">##################11g#############################</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">net.core.rmem_max</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">=4194304</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">net.core.wmem_max</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">=1048576</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">net.core.rmem_default</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">=262144</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">net.core.wmem_default</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">=262144</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">net.ipv4.ip_local_port_range</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">9000</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 65500</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">fs.file-max</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 6815744</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">fs.aio-max-nr</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1048576</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">kernel.shmmni</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">4096</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">net.ipv4.ipfrag_low_thresh</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 943718400</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">net.ipv4.ipfrag_high_thresh</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1073741824</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">net.ipv4.ipfrag_time</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 90</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">net.core.rmem_max</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 16777216</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">net.core.wmem_max</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 16777216</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[root@jandb </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]# sysctl -p</span></span></code></pre>
</div><h3 id="_2-5-‰øÆÊîπÊúÄÂ§ßÈôêÂà∂" tabindex="-1">2.5 ‰øÆÊîπÊúÄÂ§ßÈôêÂà∂ <a class="header-anchor" href="#_2-5-‰øÆÊîπÊúÄÂ§ßÈôêÂà∂" aria-label="Permalink to &quot;2.5 ‰øÆÊîπÊúÄÂ§ßÈôêÂà∂&quot;"></a></h3>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[root@jandb </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]# vim /etc/profile</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [ $USER </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "oracle"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">||</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[ $USER </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "grid"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ]; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">then</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [ $SHELL </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "/bin/ksh"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ]; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">then</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">                ulimit</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -p</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 16384</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">                ulimit</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -n</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 65536</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">        else</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">                ulimit</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -u</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 16384</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -n</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 65536</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">        fi</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">                umask</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 022</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">fi</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[root@jandb </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]# vim /etc/security/limits.conf</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">grid</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">            soft</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    nproc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   2047</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">grid</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">            hard</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    nproc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   16384</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">grid</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">            soft</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    nofile</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  1024</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">grid</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">            hard</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    nofile</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  65536</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">          soft</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    nproc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   2047</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">          hard</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    nproc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   16384</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">          soft</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    nofile</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  1024</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">          hard</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    nofile</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  65536</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[root@jandb </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]# vim /etc/pam.d/login</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">session</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    required</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     pam_limits.so</span></span></code></pre>
</div><h3 id="_2-6-ËÆæÁΩÆÁéØÂ¢ÉÂèòÈáè" tabindex="-1">2.6 ËÆæÁΩÆÁéØÂ¢ÉÂèòÈáè <a class="header-anchor" href="#_2-6-ËÆæÁΩÆÁéØÂ¢ÉÂèòÈáè" aria-label="Permalink to &quot;2.6 ËÆæÁΩÆÁéØÂ¢ÉÂèòÈáè&quot;"></a></h3>
<p>GridÁî®Êà∑ÔºöÊ∑ªÂä†Â¶Ç‰∏ãÂÜÖÂÆπ</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[root@jandb </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]# vim /home/grid/.bash_profile</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> EDITOR</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">vi</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ORACLE_SID</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">+ASM</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ORACLE_BASE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">/oracle/app/grid</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ORACLE_HOME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">/oracle/app/11.2.0/grid</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ORACLE_OWNER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">grid</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> LD_LIBRARY_PATH</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">$LD_LIBRARY_PATH:$ORACLE_HOME/lib:/lib:/usr/lib:/usr/local/lib</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> NLS_LANG</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"simplified chinese"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">_china.zhs16gbk</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> PATH</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">$PATH:$HOME/bin:$ORACLE_HOME/bin</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">unset</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> USERNAME</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">umask</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 022</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[root@jandb </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]# vim /home/oracle/.bash_profile</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ORACLE_UNQNAME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">prod</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ORACLE_SID</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">prod</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ORACLE_BASE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">/oracle/app/oracle</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ORACLE_HOME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">/oracle/app/oracle/product/11.2.0/db_1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ORACLE_OWNER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">oracle</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> LD_LIBRARY_PATH</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">$LD_LIBRARY_PATH:$ORACLE_HOME/lib:/lib:/usr/lib:/usr/local/lib</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> NLS_LANG</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"simplified chinese"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">_china.zhs16gbk</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> PATH</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">$PATH:$HOME/bin:$ORACLE_HOME/bin</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">unset</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> USERNAME</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">umask</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 022</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[root@jandb </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]# source /home/grid/.bash_profile</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[root@jandb </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]# source /home/oracle/.bash_profile</span></span></code></pre>
</div><h3 id="_2-7-ÈÖçÁΩÆË£∏ËÆæÂ§á" tabindex="-1">2.7 ÈÖçÁΩÆË£∏ËÆæÂ§á <a class="header-anchor" href="#_2-7-ÈÖçÁΩÆË£∏ËÆæÂ§á" aria-label="Permalink to &quot;2.7 ÈÖçÁΩÆË£∏ËÆæÂ§á&quot;"></a></h3>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[root@jandb oracle]# cat /etc/udev/rules.d/60-raw.rules </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Enter raw device bindings here.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">#</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># An example would be:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">#   ACTION=="add", KERNEL=="sda", RUN+="/bin/raw /dev/raw/raw1 %N"</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># to bind /dev/raw/raw1 to /dev/sda, or</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">#   ACTION=="add", ENV{MAJOR}=="8", ENV{MINOR}=="1", RUN+="/bin/raw /dev/raw/raw2 %M %m"</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># to bind /dev/raw/raw2 to the device with major 8, minor 1.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ACTION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">="add",</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> KERNEL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">="sdc1",</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> RUN</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"/bin/raw /dev/raw/raw1 %N"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ACTION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">="add",</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> KERNEL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">="sdc2",</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> RUN</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"/bin/raw /dev/raw/raw2 %N"</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[root@jandb oracle]# cat /etc/rc.local </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">#!/bin/sh</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">#</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># This script will be executed *after* all the other init scripts.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># You can put your own initialization stuff in here if you don't</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># want to do the full Sys V style init stuff.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">touch</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /var/lock/subsys/local</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">/bin/raw</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /dev/raw/raw1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /dev/sdb1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">/bin/raw</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /dev/raw/raw2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /dev/sdb2</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sleep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 3s</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">chown</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> grid:asmadmin</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /dev/raw/raw</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">*</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">chmod</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 660</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /dev/raw/raw</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">*</span></span></code></pre>
</div><p>ÈÖçÁΩÆËÆæÂ§áÂèÇÊï∞Êñá‰ª∂ÔºåÈáçÂêØÊúçÂä°Âô®</p>
<h2 id="‰∏â„ÄÅÂÆâË£Ögrid" tabindex="-1">‰∏â„ÄÅÂÆâË£Ögrid <a class="header-anchor" href="#‰∏â„ÄÅÂÆâË£Ögrid" aria-label="Permalink to &quot;‰∏â„ÄÅÂÆâË£Ögrid&quot;"></a></h2>
<h3 id="_3-1-‰∏ãËΩΩ‰æùËµñÂåÖ" tabindex="-1">3.1 ‰∏ãËΩΩ‰æùËµñÂåÖ <a class="header-anchor" href="#_3-1-‰∏ãËΩΩ‰æùËµñÂåÖ" aria-label="Permalink to &quot;3.1 ‰∏ãËΩΩ‰æùËµñÂåÖ&quot;"></a></h3>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -y</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> compat-libstdc++-33</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">*</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> elfutils-libelf</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">*</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> elfutils-libelf-devel</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">*</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> gcc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> gcc-c++</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">*</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> glibc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">*</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> glibc-common</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">*</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> glibc-devel</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">*</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> glibc-headers</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">*</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> libaio</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">*</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> libaio-devel</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">*</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> libgcc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">*</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> libstdc++</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">*</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> libstdc++-devel</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">*</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> libXp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">*</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> make</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">*</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> sysstat</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">*</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> unixODBC</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">*</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> unixODBC-devel</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">*</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> compat-libcap1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">*</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> compat-libstdc++-33</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">*</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> elfutils-libelf-devel</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">*</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ksh</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">*</span></span></code></pre>
</div><h3 id="_3-2-ËÑöÊú¨‰øÆÊîπÂÜÖÊ†∏ÂèÇÊï∞" tabindex="-1">3.2 ËÑöÊú¨‰øÆÊîπÂÜÖÊ†∏ÂèÇÊï∞ <a class="header-anchor" href="#_3-2-ËÑöÊú¨‰øÆÊîπÂÜÖÊ†∏ÂèÇÊï∞" aria-label="Permalink to &quot;3.2 ËÑöÊú¨‰øÆÊîπÂÜÖÊ†∏ÂèÇÊï∞&quot;"></a></h3>
<p>gridÁöÑÂåÖÊòØ Ôºöp10404530_112030_Linux-x86-64_3of7.zip</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[root@jandb /]# unzip p10404530_112030_Linux-x86-64_1of7.zip</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[root@jandb /]# unzip p10404530_112030_Linux-x86-64_2of7.zip</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[root@jandb /]# cd /soft/grid/rpm/</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[root@jandb rpm]# rpm -ivh cvuqdisk-1.0.9-1.rpm</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[root@jandb /]# chown grid:oinstall grid/</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> -R</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[grid@jandb grid]$ </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">./runcluvfy.sh</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> stage</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -pre</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> crsinst</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> jandb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -fixup</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -verbose</span></span></code></pre>
</div><h3 id="_3-3-‰øÆÊîπÂÆâË£ÖÊñá‰ª∂grid-install-rsp" tabindex="-1">3.3 ‰øÆÊîπÂÆâË£ÖÊñá‰ª∂grid_install.rsp <a class="header-anchor" href="#_3-3-‰øÆÊîπÂÆâË£ÖÊñá‰ª∂grid-install-rsp" aria-label="Permalink to &quot;3.3 ‰øÆÊîπÂÆâË£ÖÊñá‰ª∂grid_install.rsp&quot;"></a></h3>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[grid@jandb response]$ sed -i </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'s/^#.*$//g'</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> *</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.rsp </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[grid@jandb response]$ sed -i </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'/^$/d'</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> *</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.rsp</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">ORACLE_HOSTNAME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">jandb</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">INVENTORY_LOCATION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">/oracle/app/oraInventory</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">SELECTED_LANGUAGES</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">en,zh_CN</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">oracle.install.option</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">=HA_CONFIG</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">ORACLE_BASE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">/oracle/app/grid</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">ORACLE_HOME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">/oracle/app/11.2.0/grid</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">oracle.install.asm.OSDBA</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">=asmdba</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">oracle.install.asm.OSOPER</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">=asmoper</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">oracle.install.asm.OSASM</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">=asmadmin</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">oracle.install.crs.config.gpnp.scanName</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">=</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">oracle.install.crs.config.gpnp.scanPort</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">=</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">oracle.install.crs.config.clusterName</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">=</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">oracle.install.crs.config.gpnp.configureGNS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">false</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">oracle.install.crs.config.gpnp.gnsSubDomain</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">=</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">oracle.install.crs.config.gpnp.gnsVIPAddress</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">=</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">oracle.install.crs.config.autoConfigureClusterNodeVIP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">=</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">oracle.install.crs.config.clusterNodes</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">=</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">oracle.install.crs.config.storageOption</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ASM_STORAGE</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">oracle.install.crs.config.sharedFileSystemStorage.diskDriveMapping</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">=</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">oracle.install.crs.config.sharedFileSystemStorage.votingDiskLocations</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">=</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">oracle.install.crs.config.sharedFileSystemStorage.votingDiskRedundancy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">=NORMAL</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">oracle.install.crs.config.sharedFileSystemStorage.ocrLocations</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">=</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">oracle.install.crs.config.sharedFileSystemStorage.ocrRedundancy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">=NORMAL</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">oracle.install.crs.config.useIPMI</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">false</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">oracle.install.crs.config.ipmi.bmcUsername</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">=</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">oracle.install.crs.config.ipmi.bmcPassword</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">=</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">oracle.install.asm.SYSASMPassword</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">=oracle</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">oracle.install.asm.diskGroup.name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">=DATA1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">oracle.install.asm.diskGroup.redundancy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">=EXTERNAL</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">oracle.install.asm.diskGroup.disks</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">=/dev/raw/raw1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">oracle.install.asm.diskGroup.diskDiscoveryString</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">=/dev/raw/raw*</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">oracle.install.asm.monitorPassword</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">=oracle</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">oracle.install.crs.upgrade.clusterNodes</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">=</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">oracle.install.asm.upgradeASM</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">false</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">oracle.installer.autoupdates.option</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">=SKIP_UPDATES</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">oracle.installer.autoupdates.downloadUpdatesLoc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">=</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">AUTOUPDATES_MYORACLESUPPORT_USERNAME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">AUTOUPDATES_MYORACLESUPPORT_PASSWORD</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">PROXY_HOST</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">PROXY_PORT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">PROXY_USER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">PROXY_PWD</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">PROXY_REALM</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span></span></code></pre>
</div><h3 id="_3-4-ÂºÄÂßãÈùôÈªòÂÆâË£Ö" tabindex="-1">3.4 ÂºÄÂßãÈùôÈªòÂÆâË£Ö <a class="header-anchor" href="#_3-4-ÂºÄÂßãÈùôÈªòÂÆâË£Ö" aria-label="Permalink to &quot;3.4 ÂºÄÂßãÈùôÈªòÂÆâË£Ö&quot;"></a></h3>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[grid@jandb grid] ./runInstaller -responseFile /soft/grid/response/grid_install.rsp -silent -ignorePrereq -showProgress</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[grid@jandb grid]$ [WARNING] [INS-30011] The SYS password entered does not conform to the Oracle recommended standards.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">   CAUSE:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> recommends</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> that</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> password</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> entered</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> should</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> be</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> at</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> least</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 8</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> characters</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> length,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> contain</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> at</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> least</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> uppercase</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> character,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> lower</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> case</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> character</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> and</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> digit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [0-9].</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">   ACTION:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Provide</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> password</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> that</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> conforms</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> recommended</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> standards.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[WARNING] [INS-30011] The ASMSNMP password entered does not conform to the Oracle recommended standards.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">   CAUSE:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> recommends</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> that</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> password</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> entered</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> should</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> be</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> at</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> least</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 8</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> characters</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> length,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> contain</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> at</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> least</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> uppercase</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> character,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> lower</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> case</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> character</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> and</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> digit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [0-9].</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">   ACTION:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Provide</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> password</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> that</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> conforms</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> recommended</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> standards.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[WARNING] [INS-32018] The selected Oracle home is outside of Oracle base.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">   CAUSE:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> The</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> home</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> selected</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> was</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> outside</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> base.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">   ACTION:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> recommends</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> installing</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> software</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> within</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> base</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> directory.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Adjust</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> home</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> or</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> base</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> accordingly.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">You</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> can</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> find</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> log</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> this</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> session</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> at:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> /oracle/app/oraInventory/logs/installActions2020-11-05_08-38-55AM.log</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Prepare</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> progress.</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">..................................................</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   9%</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Done.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Prepare</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> successful.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Copy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> files</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> progress.</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">..................................................</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   14%</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Done.</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">..................................................</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   21%</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Done.</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">..................................................</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   26%</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Done.</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">..................................................</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   31%</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Done.</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">..................................................</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   36%</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Done.</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">..................................................</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   42%</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Done.</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">..................................................</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   49%</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Done.</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">..................................................</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   56%</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Done.</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">..................................................</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   61%</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Done.</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">..................................................</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   66%</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Done.</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">..................................................</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   71%</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Done.</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">........................................</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Copy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> files</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> successful.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Link</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> binaries</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> progress.</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">..........</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Link</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> binaries</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> successful.</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">..........</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Setup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> files</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> progress.</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">..................................................</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   76%</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Done.</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">..................................................</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   89%</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Done.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Setup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> files</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> successful.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">The</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> installation</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Grid</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Infrastructure</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 11g</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> was</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> successful.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Please</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> check</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> '/oracle/app/oraInventory/logs/silentInstall2020-11-05_08-38-55AM.log'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> more</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> details.</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">..................................................</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   94%</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Done.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Execute</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Root</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Scripts</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> progress.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">As</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> root</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> user,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> execute</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> following</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">s</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> 1.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /oracle/app/oraInventory/orainstRoot.sh</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> 2.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /oracle/app/11.2.0/grid/root.sh</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">..................................................</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   100%</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Done.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Execute</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Root</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Scripts</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> successful.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">As</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> user,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> execute</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> following</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> script</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> complete</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> configuration.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> 1.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /oracle/app/11.2.0/grid/cfgtoollogs/configToolAllCommands</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> RESPONSE_FILE=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">&#x3C;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">response_fil</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  Note:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> 1.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> This</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> script</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> must</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> be</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> on</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> same</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> host</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> where</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> installer</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> was</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> run.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> 2.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> This</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> script</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> needs</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> small</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> password</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> properties</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> file</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> configuration</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> assistants</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> that</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> require</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> passwords</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (refer </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> guide</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> documentation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">).</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Successfully</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Setup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Software.</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[root@jandb </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]# /oracle/app/oraInventory/orainstRoot.sh</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Changing</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> permissions</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /oracle/app/oraInventory.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Adding</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> read,write</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> permissions</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> group.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Removing</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> read,write,execute</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> permissions</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> world.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Changing</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> groupname</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /oracle/app/oraInventory</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oinstall.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">The</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> execution</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> script</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> complete.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[root@jandb </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]# /oracle/app/11.2.0/grid/root.sh</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Check</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /oracle/app/11.2.0/grid/install/root_jandb_2020-11-05_09-51-12.log</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> output</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> root</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> script</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[root@jandb </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]# tail -f /oracle/app/11.2.0/grid/install/root_jandb_2020-11-05_09-51-12.log</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Creating</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> trace</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> directory</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">LOCAL</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ADD</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> MODE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Creating</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> OCR</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> keys</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> user</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'grid',</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> privgrp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'oinstall'..</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Operation</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> successful.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">LOCAL</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ONLY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> MODE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Successfully</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> accumulated</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> necessary</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> OCR</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> keys.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Creating</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> OCR</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> keys</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> user</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'root',</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> privgrp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'root'..</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Operation</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> successful.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">CRS-4664:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Node</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> jandb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> successfully</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> pinned.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Adding</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Clusterware</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> entries</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> upstart</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jandb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     2020/11/05</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 09:53:36</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     /oracle/app/11.2.0/grid/cdata/jandb/backup_20201105_095336.olr</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Successfully</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> configured</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Grid</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Infrastructure</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Standalone</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Server</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[grid@jandb grid]$ ./runInstaller -responseFile /soft/grid/response/grid_install.rsp -silent -ignorePrereq -showProgress </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[grid@jandb bin]$ ./crs_stat -t</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">--------------------------------------------------------------------------------------------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ora.cssd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       ora.cssd.type</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  OFFLINE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   OFFLINE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">               </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ora.diskmon</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    ora....on.type</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> OFFLINE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   OFFLINE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">               </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ora.evmd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       ora.evm.type</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   ONLINE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    ONLINE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    jandb</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">       </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ora.ons</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">        ora.ons.type</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   OFFLINE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   OFFLINE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[grid@jandb bin]$ /oracle/app/11.2.0/grid/cfgtoollogs/configToolAllCommands RESPONSE_FILE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">/oracle/soft/grid/response/grid_install.rsp</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Setting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> invPtrLoc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /oracle/app/11.2.0/grid/oraInst.loc</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">perform</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mode</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> action:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> configure</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">perform</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mode</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> finished</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> action:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> configure</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">You</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> can</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> see</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> log</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> file:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /oracle/app/11.2.0/grid/cfgtoollogs/oui/configActions2020-11-05_09-57-46-AM.log</span></span></code></pre>
</div><p>Âà∞ËøôÈáåÊï¥‰∏™gridÂÆâË£ÖÊàêÂäü</p>
<h2 id="Âõõ„ÄÅÂª∫Á´ãasm" tabindex="-1">Âõõ„ÄÅÂª∫Á´ãASM <a class="header-anchor" href="#Âõõ„ÄÅÂª∫Á´ãasm" aria-label="Permalink to &quot;Âõõ„ÄÅÂª∫Á´ãASM&quot;"></a></h2>
<h3 id="_4-1-Ê£ÄÊü•has-css-evmÈÉΩÊòØonline" tabindex="-1">4.1 Ê£ÄÊü•has,css,evmÈÉΩÊòØonline <a class="header-anchor" href="#_4-1-Ê£ÄÊü•has-css-evmÈÉΩÊòØonline" aria-label="Permalink to &quot;4.1 Ê£ÄÊü•has,css,evmÈÉΩÊòØonline&quot;"></a></h3>
<p>[grid@jandb grid]$ crsctl check has
CRS-4638: Oracle È´òÂèØÁî®ÊÄßÊúçÂä°ËÅîÊú∫
[grid@jandb grid]$ crsctl check css
CRS-4529: ÈõÜÁæ§ÂêåÊ≠•ÊúçÂä°ËÅîÊú∫
[grid@jandb grid]$ crsctl check evm
CRS-4533: ‰∫ã‰ª∂ÁÆ°ÁêÜÂô®ËÅîÊú∫</p>
<h3 id="_4-2-ÂàõÂª∫ÂØÜÁ†ÅÊñá‰ª∂" tabindex="-1">4.2 ÂàõÂª∫ÂØÜÁ†ÅÊñá‰ª∂ <a class="header-anchor" href="#_4-2-ÂàõÂª∫ÂØÜÁ†ÅÊñá‰ª∂" aria-label="Permalink to &quot;4.2 ÂàõÂª∫ÂØÜÁ†ÅÊñá‰ª∂&quot;"></a></h3>
<p>[grid@jandb grid]$ cd $ORACLE_HOME/dbs
[grid@jandb dbs]$ orapwd file=orapw+ASM password=oracle entries=10 ignorecase=y</p>
<h3 id="_4-3-ÈÖçÁΩÆresponse-file" tabindex="-1">4.3 ÈÖçÁΩÆRESPONSE_FILE <a class="header-anchor" href="#_4-3-ÈÖçÁΩÆresponse-file" aria-label="Permalink to &quot;4.3 ÈÖçÁΩÆRESPONSE_FILE&quot;"></a></h3>
<p>gridÁî®Êà∑ÊâßË°åÈÖçÁΩÆ
[grid@jandb dbs]$ /oracle/app/11.2.0/grid/cfgtoollogs/configToolAllCommands RESPONSE_FILE=/oracle/soft/grid/response/grid_install.rsp
Setting the invPtrLoc to /oracle/app/11.2.0/grid/oraInst.loc
perform - mode is starting for action: configure
perform - mode finished for action: configure</p>
<p>You can see the log file: /oracle/app/11.2.0/grid/cfgtoollogs/oui/configActions2020-11-08_06-05-25-AM.log</p>
<h3 id="_4-4-ÈÖçÁΩÆasmÁöÑpfile" tabindex="-1">4.4 ÈÖçÁΩÆASMÁöÑpfile <a class="header-anchor" href="#_4-4-ÈÖçÁΩÆasmÁöÑpfile" aria-label="Permalink to &quot;4.4 ÈÖçÁΩÆASMÁöÑpfile&quot;"></a></h3>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[grid@jandb dbs]$ ll</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">total</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 8</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">-rw-r--r--</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> grid</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oinstall</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 2851</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> May</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 15</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  2009</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> init.ora</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">-rw-r-----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> grid</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oinstall</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 2560</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Nov</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  8</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 06:04</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> orapw+ASM</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[grid@jandb dbs]$ pwd</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">/oracle/app/11.2.0/grid/dbs</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[grid@jandb dbs]$ vi init+ASM.ora</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[grid@jandb dbs]$ cat init+ASM.ora </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">INSTANCE_TYPE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">ASM</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">DB_UNIQUE_NAME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">+ASM</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">ASM_POWER_LIMIT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">ASM_DISKSTRING</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">/dev/raw/raw*</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">ASM_DISKGROUPS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">data1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">LARGE_POOL_SIZE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">16M</span></span></code></pre>
</div><p>ÂêØÂä®Âà∞nomount</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[grid@jandb dbs]$ sqlplus / as sysasm</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">startup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> nomount</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> pfile='$ORACLE_HOME/dbs/init+ASM.ora'</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> linesize</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">col</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> path</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> a20</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">col</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> a10</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">col</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> FAILGROUP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> a15</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> GROUP_NUMBER, DISK_NUMBER, MOUNT_STATUS, NAME, FAILGROUP, CREATE_DATE, PATH from v$asm_disk;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">GROUP_NUMBER</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> DISK_NUMBER</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> MOUNT_STATUS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    FAILGROUP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    CREATE_DATE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> PATH</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">------------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -----------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --------------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> ----------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> ---------------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> ------------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --------------------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    2</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">        0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> CACHED</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  DATA2_0000</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> DATA2_0000</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    08-NOV-20</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /dev/raw/raw2</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">        0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> CACHED</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  DATA1_0000</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> DATA1_0000</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    08-NOV-20</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /dev/raw/raw1</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">select</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> GROUP_NUMBER,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> NAME,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> TYPE,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> TOTAL_MB,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> FREE_MB,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> USABLE_FILE_MB</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> v</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">$asm_diskgroup;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">no</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> rows</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> selected</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">create</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> diskgroup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> DATA1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> external</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> REDUNDANCY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> disk</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> '/dev/raw/raw1'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Diskgroup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> created.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">create</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> diskgroup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> DATA2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> external</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> REDUNDANCY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> disk</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> '/dev/raw/raw2'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Diskgroup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> created.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">select</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> group_number,name,total_mb/1024</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> total_G,free_mb/1024</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> free_G,state,type</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> v</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">$asm_diskgroup;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">GROUP_NUMBER</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    TOTAL_G</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     FREE_G</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> STATE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       TYPE</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">------------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> ----------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> ----------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> ----------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> ----------------------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> ------------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> DATA1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 5.00976563</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  4.9609375</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> MOUNTED</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       EXTERN</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> DATA2</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 4.98632813</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">     4.9375</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> MOUNTED</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       EXTERN</span></span></code></pre>
</div><h3 id="_4-5-asmÊúçÂä°Âä†ÂÖ•ÈõÜÁæ§" tabindex="-1">4.5 ASMÊúçÂä°Âä†ÂÖ•ÈõÜÁæ§ <a class="header-anchor" href="#_4-5-asmÊúçÂä°Âä†ÂÖ•ÈõÜÁæ§" aria-label="Permalink to &quot;4.5 ASMÊúçÂä°Âä†ÂÖ•ÈõÜÁæ§&quot;"></a></h3>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[grid@jandb dbs]$ srvctl add asm</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[grid@jandb dbs]$ crsctl stat res -t</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">--------------------------------------------------------------------------------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">           TARGET</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  STATE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">        SERVER</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                   STATE_DETAILS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">       </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">--------------------------------------------------------------------------------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Local</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Resources</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">--------------------------------------------------------------------------------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ora.LISTENER.lsnr</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">               ONLINE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  ONLINE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       jandb</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                        </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ora.asm</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">               OFFLINE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> OFFLINE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      jandb</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                        </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ora.ons</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">               OFFLINE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> OFFLINE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      jandb</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                        </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">--------------------------------------------------------------------------------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Resources</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">--------------------------------------------------------------------------------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ora.cssd</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">      1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">        ONLINE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  ONLINE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       jandb</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                        </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ora.diskmon</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">      1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">        OFFLINE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> OFFLINE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                                   </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ora.evmd</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">      1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">        ONLINE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  ONLINE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       jandb</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">6</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ÂàõÂª∫spfile</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[grid@jandb dbs]$ sqlplus / as sysasm</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">>  </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">create</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> spfile</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> pfile</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">>  </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">shutdown</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> immediate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">startup</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[grid@jandb </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ crsctl stat res -t</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">--------------------------------------------------------------------------------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">           TARGET</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  STATE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">        SERVER</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                   STATE_DETAILS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">       </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">--------------------------------------------------------------------------------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Local</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Resources</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">--------------------------------------------------------------------------------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ora.DATA1.dg</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">               ONLINE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  ONLINE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       jandb</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                        </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ora.LISTENER.lsnr</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">               ONLINE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  ONLINE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       jandb</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                        </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ora.asm</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">               ONLINE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  ONLINE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       jandb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                    Started</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">             </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ora.ons</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">               OFFLINE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> OFFLINE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      jandb</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                        </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">--------------------------------------------------------------------------------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Resources</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">--------------------------------------------------------------------------------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ora.cssd</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">      1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">        ONLINE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  ONLINE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       jandb</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                        </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ora.diskmon</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">      1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">        OFFLINE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> OFFLINE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                                   </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ora.evmd</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">      1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">        ONLINE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  ONLINE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       jandb</span></span></code></pre>
</div><h2 id="‰∫î„ÄÅÂÆâË£ÖÊï∞ÊçÆÂ∫ìËΩØ‰ª∂" tabindex="-1">‰∫î„ÄÅÂÆâË£ÖÊï∞ÊçÆÂ∫ìËΩØ‰ª∂ <a class="header-anchor" href="#‰∫î„ÄÅÂÆâË£ÖÊï∞ÊçÆÂ∫ìËΩØ‰ª∂" aria-label="Permalink to &quot;‰∫î„ÄÅÂÆâË£ÖÊï∞ÊçÆÂ∫ìËΩØ‰ª∂&quot;"></a></h2>
<h3 id="_5-1-‰øÆÊîπÂ∫îÁ≠îÊñá‰ª∂db-install-rsp" tabindex="-1">5.1 ‰øÆÊîπÂ∫îÁ≠îÊñá‰ª∂db_install.rsp <a class="header-anchor" href="#_5-1-‰øÆÊîπÂ∫îÁ≠îÊñá‰ª∂db-install-rsp" aria-label="Permalink to &quot;5.1 ‰øÆÊîπÂ∫îÁ≠îÊñá‰ª∂db_install.rsp&quot;"></a></h3>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[root@jandb soft]# chown oracle:oinstall database/ -R</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[root@jandb soft]#  su ‚Äì oracle</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[oracle@jandb response]$ sed -i </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'s/^#.*$//g'</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> *</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.rsp</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[oracle@jandb response]$ sed -i </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'/^$/d'</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> *</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.rsp</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">oracle.install.option</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">=INSTALL_DB_SWONLY</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">ORACLE_HOSTNAME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">prod</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">UNIX_GROUP_NAME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">oinstall</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">INVENTORY_LOCATION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">/oracle/app/oracle/oraInventory</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">SELECTED_LANGUAGES</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">en,zh_CN</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">ORACLE_HOME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">/oracle/app/oracle/product/11.2.0/db_1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">ORACLE_BASE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">/oracle/app/oracle</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">oracle.install.db.InstallEdition</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">=EE</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">oracle.install.db.DBA_GROUP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">=dba</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">oracle.install.db.OPER_GROUP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">=oinstall</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">oracle.install.db.config.starterdb.characterSet</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">=AL32UTF8</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">oracle.install.db.config.starterdb.storageType</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">=ASM_STORAGE</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">oracle.install.db.config.starterdb.fileSystemStorage.dataLocation</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">=DATA1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">oracle.install.db.config.starterdb.fileSystemStorage.recoveryLocation</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">=</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">DECLINE_SECURITY_UPDATES</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">true</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    //‰∏ÄÂÆöË¶ÅËÆæ‰∏∫true</span></span></code></pre>
</div><h3 id="_5-2-ÂºÄÂßãÂÆâË£ÖËΩØ‰ª∂" tabindex="-1">5.2 ÂºÄÂßãÂÆâË£ÖËΩØ‰ª∂ <a class="header-anchor" href="#_5-2-ÂºÄÂßãÂÆâË£ÖËΩØ‰ª∂" aria-label="Permalink to &quot;5.2 ÂºÄÂßãÂÆâË£ÖËΩØ‰ª∂&quot;"></a></h3>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[oracle@jandb response]$ pwd</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">/soft/database/response</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[oracle@jandb response]$ ../runInstaller -silent -responseFile /soft/database/response/db_install.rsp -ignorePrereq -ignoreDiskWarning  -ignoreSysPrereqs -ignorePrereq</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Universal</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Installer...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Checking</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Temp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> space:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> must</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> be</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> greater</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> than</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 120</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> MB.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   Actual</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 6390</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> MB</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    Passed</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Checking</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> swap</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> space:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> must</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> be</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> greater</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> than</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 150</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> MB.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   Actual</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 2222</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> MB</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    Passed</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Preparing</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> launch</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Universal</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Installer</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /tmp/OraInstall2020-11-08_06-39-56AM.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Please</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> wait</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ...[oracle@jandb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> response]</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">$ </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">You</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> can</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> find</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> log</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> this</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> session</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> at:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> /oracle/app/oraInventory/logs/installActions2020-11-08_06-39-56AM.log</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[oracle@jandb response]$ The installation of Oracle Database 11g was successful.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Please</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> check</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> '/oracle/app/oraInventory/logs/silentInstall2020-11-08_06-39-56AM.log'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> more</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> details.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">As</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> root</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> user,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> execute</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> following</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">s</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> 1.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /oracle/app/oracle/product/11.2.0/db_1/root.sh</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Successfully</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Setup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Software.</span></span></code></pre>
</div><h3 id="_5-3-ÊâßË°åËÑöÊú¨" tabindex="-1">5.3 ÊâßË°åËÑöÊú¨ <a class="header-anchor" href="#_5-3-ÊâßË°åËÑöÊú¨" aria-label="Permalink to &quot;5.3 ÊâßË°åËÑöÊú¨&quot;"></a></h3>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[oracle@jandb </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ /oracle/app/oracle/product/11.2.0/db_1/root.sh</span></span></code></pre>
</div><h2 id="ÂÖ≠„ÄÅÂª∫Á´ãÊï∞ÊçÆÂ∫ì" tabindex="-1">ÂÖ≠„ÄÅÂª∫Á´ãÊï∞ÊçÆÂ∫ì <a class="header-anchor" href="#ÂÖ≠„ÄÅÂª∫Á´ãÊï∞ÊçÆÂ∫ì" aria-label="Permalink to &quot;ÂÖ≠„ÄÅÂª∫Á´ãÊï∞ÊçÆÂ∫ì&quot;"></a></h2>
<h3 id="_6-1-‰øÆÊîπÂ∫îÁ≠îÊñá‰ª∂dbca-resp" tabindex="-1">6.1 ‰øÆÊîπÂ∫îÁ≠îÊñá‰ª∂dbca.resp <a class="header-anchor" href="#_6-1-‰øÆÊîπÂ∫îÁ≠îÊñá‰ª∂dbca-resp" aria-label="Permalink to &quot;6.1 ‰øÆÊîπÂ∫îÁ≠îÊñá‰ª∂dbca.resp&quot;"></a></h3>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[oracle@jandb response]$ sed -i </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'s/^#.*$//g'</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> *</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.rsp </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[oracle@jandb response]$ sed -i </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'/^$/d'</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> *</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.rsp</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[oracle@jandb response]$ pwd</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">/soft/database/response</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[oracle@jandb response]$ cat dbca.rsp </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[GENERAL]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">RESPONSEFILE_VERSION</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "11.2.0"</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">OPERATION_TYPE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "createDatabase"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[CREATEDATABASE]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">GDBNAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "prod"</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SID</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "prod"</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">TEMPLATENAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "General_Purpose.dbc"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">STORAGETYPE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">ASM</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">DATAFILEDESTINATION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">DATA1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">RECOVERYAREADESTINATION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">CHARACTERSET</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "AL32UTF8"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">NATIONALCHARACTERSET</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "AL16UTF16"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">LISTENERS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">LISTENER</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">TOTALMEMORY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "700"</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SYSPASSWORD</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "oracle"</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SYSTEMPASSWORD</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "oracle"</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[oracle@jandb response]$ dbca  -silent  -createDatabase -responseFile   /soft/database/response/dbca.rsp</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Copying</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> database</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> files</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">1%</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> complete</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">35%</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> complete</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Creating</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> and</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> instance</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">37%</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> complete</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">58%</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> complete</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Registering</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> database</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> with</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Restart</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">64%</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> complete</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Completing</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Database</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Creation</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">100%</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> complete</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Look</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> at</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> log</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> file</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "/oracle/app/oracle/cfgtoollogs/dbca/prod/prod.log"</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> further</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> details.</span></span></code></pre>
</div><h3 id="_6-2-mountÊâÄÊúâÁ£ÅÁõòÁªÑ" tabindex="-1">6.2 MountÊâÄÊúâÁ£ÅÁõòÁªÑ <a class="header-anchor" href="#_6-2-mountÊâÄÊúâÁ£ÅÁõòÁªÑ" aria-label="Permalink to &quot;6.2 MountÊâÄÊúâÁ£ÅÁõòÁªÑ&quot;"></a></h3>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[grid@jandb </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ sqlplus / as sysasm</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">select</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> group_number,name,total_mb/1024</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> total_G,free_mb/1024</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> free_G,state,type</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> v</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">$asm_diskgroup;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">GROUP_NUMBER</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  TOTAL_G</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  FREE_G</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   STATE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  TYPE</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">----------------------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  ----------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  ----------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  ------------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    ----------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  ------------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">         DATA1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 5.00976563</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  4.9609375</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  MOUNTED</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  EXTERN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">         DATA2</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       DISMOUNTED</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">alter</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> diskgroup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> DATA2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mount</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Diskgroup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> altered.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">col</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> a10</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">col</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> state</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> a10</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">select</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> group_number,name,total_mb/1024</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> total_G,free_mb/1024</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> free_G,state,type</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> v</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">$asm_diskgroup;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">GROUP_NUMBER</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    TOTAL_G</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     FREE_G</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> STATE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  TYPE</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">------------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> ----------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> ----------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> ----------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> ----------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> ------------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> DATA1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 5.00976563</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  4.9609375</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> MOUNTED</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  EXTERN</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> DATA2</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 4.98632813</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 4.93652344</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> MOUNTED</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  EXTERN</span></span></code></pre>
</div>]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[‰ΩìÁ≥ªÁÆÄ‰ªã]]></title>
            <link>https://askaric.com/zh/work/oracle/Summary-Oracle.html</link>
            <guid>https://askaric.com/zh/work/oracle/Summary-Oracle.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[‰∏Ä„ÄÅ‰ΩìÁ≥ªÊû∂ÊûÑ

 1.1 ÂÆû‰æã‰∏éÊï∞ÊçÆÂ∫ì

 1.2 SGAÁöÑÂü∫Êú¨ÁªÑ‰ª∂

 1.3 OracleÁöÑËøõÁ®ã

 1.4 PGAÁöÑÂü∫Êú¨ÁªÑ‰ª∂

 1.5 ËøûÊé•ÊñπÂºè

 ‰∫å„ÄÅÊï∞ÊçÆÂ∫ìÂÆû‰æãÁÆ°ÁêÜ]]></description>
            <content:encoded><![CDATA[<h1 id="‰ΩìÁ≥ªÁÆÄ‰ªã" tabindex="-1">‰ΩìÁ≥ªÁÆÄ‰ªã <a class="header-anchor" href="#‰ΩìÁ≥ªÁÆÄ‰ªã" aria-label="Permalink to &quot;‰ΩìÁ≥ªÁÆÄ‰ªã&quot;"></a></h1>
<h2 id="‰∏Ä„ÄÅ‰ΩìÁ≥ªÊû∂ÊûÑ" tabindex="-1">‰∏Ä„ÄÅ‰ΩìÁ≥ªÊû∂ÊûÑ <a class="header-anchor" href="#‰∏Ä„ÄÅ‰ΩìÁ≥ªÊû∂ÊûÑ" aria-label="Permalink to &quot;‰∏Ä„ÄÅ‰ΩìÁ≥ªÊû∂ÊûÑ&quot;"></a></h2>
<h3 id="_1-1-ÂÆû‰æã‰∏éÊï∞ÊçÆÂ∫ì" tabindex="-1">1.1 ÂÆû‰æã‰∏éÊï∞ÊçÆÂ∫ì <a class="header-anchor" href="#_1-1-ÂÆû‰æã‰∏éÊï∞ÊçÆÂ∫ì" aria-label="Permalink to &quot;1.1 ÂÆû‰æã‰∏éÊï∞ÊçÆÂ∫ì&quot;"></a></h3>
<h3 id="_1-2-sgaÁöÑÂü∫Êú¨ÁªÑ‰ª∂" tabindex="-1">1.2 SGAÁöÑÂü∫Êú¨ÁªÑ‰ª∂ <a class="header-anchor" href="#_1-2-sgaÁöÑÂü∫Êú¨ÁªÑ‰ª∂" aria-label="Permalink to &quot;1.2 SGAÁöÑÂü∫Êú¨ÁªÑ‰ª∂&quot;"></a></h3>
<h3 id="_1-3-oracleÁöÑËøõÁ®ã" tabindex="-1">1.3 OracleÁöÑËøõÁ®ã <a class="header-anchor" href="#_1-3-oracleÁöÑËøõÁ®ã" aria-label="Permalink to &quot;1.3 OracleÁöÑËøõÁ®ã&quot;"></a></h3>
<h3 id="_1-4-pgaÁöÑÂü∫Êú¨ÁªÑ‰ª∂" tabindex="-1">1.4 PGAÁöÑÂü∫Êú¨ÁªÑ‰ª∂ <a class="header-anchor" href="#_1-4-pgaÁöÑÂü∫Êú¨ÁªÑ‰ª∂" aria-label="Permalink to &quot;1.4 PGAÁöÑÂü∫Êú¨ÁªÑ‰ª∂&quot;"></a></h3>
<h3 id="_1-5-ËøûÊé•ÊñπÂºè" tabindex="-1">1.5 ËøûÊé•ÊñπÂºè <a class="header-anchor" href="#_1-5-ËøûÊé•ÊñπÂºè" aria-label="Permalink to &quot;1.5 ËøûÊé•ÊñπÂºè&quot;"></a></h3>
<h2 id="‰∫å„ÄÅÊï∞ÊçÆÂ∫ìÂÆû‰æãÁÆ°ÁêÜ" tabindex="-1">‰∫å„ÄÅÊï∞ÊçÆÂ∫ìÂÆû‰æãÁÆ°ÁêÜ <a class="header-anchor" href="#‰∫å„ÄÅÊï∞ÊçÆÂ∫ìÂÆû‰æãÁÆ°ÁêÜ" aria-label="Permalink to &quot;‰∫å„ÄÅÊï∞ÊçÆÂ∫ìÂÆû‰æãÁÆ°ÁêÜ&quot;"></a></h2>
<p>2.1 ÂèÇÊï∞Êñá‰ª∂</p>
<p>2.2 Êï∞ÊçÆÂ∫ìÂêØÂä®‰∏éÂÖ≥Èó≠</p>
<p>2.3 Ëá™Âä®ËØäÊñ≠‰ø°ÊÅØÂ∫ìADR</p>
<p>2.4 Âè£‰ª§Êñá‰ª∂</p>
<h2 id="‰∏â„ÄÅÊéßÂà∂Êñá‰ª∂" tabindex="-1">‰∏â„ÄÅÊéßÂà∂Êñá‰ª∂ <a class="header-anchor" href="#‰∏â„ÄÅÊéßÂà∂Êñá‰ª∂" aria-label="Permalink to &quot;‰∏â„ÄÅÊéßÂà∂Êñá‰ª∂&quot;"></a></h2>
<p>3.1 ÂäüËÉΩÂíåÁâπÁÇπ</p>
<p>3.2 ÂÆûÊó∂Êõ¥Êñ∞Êú∫Âà∂</p>
<p>3.3 Â§öÂÖÉÂåñ</p>
<p>3.4 Â§á‰ªΩ‰∏éÈáçÂª∫</p>
<p>3.5 ÊÅ¢Â§ç‰∏éÈáçÂª∫</p>
<h2 id="Âõõ„ÄÅredo-Êó•Âøó" tabindex="-1">Âõõ„ÄÅredo Êó•Âøó <a class="header-anchor" href="#Âõõ„ÄÅredo-Êó•Âøó" aria-label="Permalink to &quot;Âõõ„ÄÅredo Êó•Âøó&quot;"></a></h2>
<p>4.1‰ΩúÁî®ÂíåÁâπÂæÅ</p>
<p>4.2Êó•ÂøóÁªÑÂèäÂàáÊç¢</p>
<p>4.3 Ê∑ªÂä†Êó•ÂøóÁªÑÂíåÊàêÂëò</p>
<p>4.4 v$logËßÜÂõæÁöÑÁä∂ÊÄÅ</p>
<p>4.5Êó•ÂøóÊÅ¢Â§ç</p>
<p>4.6 ‰ΩøÊó•ÂøóÊÅ¢Â§çÂà∞ÂéüÊù•ÁöÑÈÖçÁΩÆ</p>
<h2 id="‰∫î„ÄÅÂΩíÊ°£Êó•Âøó" tabindex="-1">‰∫î„ÄÅÂΩíÊ°£Êó•Âøó <a class="header-anchor" href="#‰∫î„ÄÅÂΩíÊ°£Êó•Âøó" aria-label="Permalink to &quot;‰∫î„ÄÅÂΩíÊ°£Êó•Âøó&quot;"></a></h2>
<p>5.1 ÂΩíÊ°£ÂíåÈùûÂΩíÊ°£ÁöÑÂå∫Âà´</p>
<p>5.2 ËÆæÁΩÆÂΩíÊ°£Ê®°Âºè</p>
<p>5.3 Ë∑ØÂæÑÂèäÂëΩÂêçÊñπÊ≥ï</p>
<p>5.4 ÂΩíÊ°£ËøõÁ®ãÂíåÊâãÂä®ÂàáÊç¢</p>
<h2 id="ÂÖ≠„ÄÅÊó•ÂøóÊåñÊéò" tabindex="-1">ÂÖ≠„ÄÅÊó•ÂøóÊåñÊéò <a class="header-anchor" href="#ÂÖ≠„ÄÅÊó•ÂøóÊåñÊéò" aria-label="Permalink to &quot;ÂÖ≠„ÄÅÊó•ÂøóÊåñÊéò&quot;"></a></h2>
<p>6.1 ‰ΩúÁî®</p>
<p>6.2 ÊñπÊ≥ï</p>
<h2 id="‰∏É„ÄÅÁÆ°ÁêÜundo" tabindex="-1">‰∏É„ÄÅÁÆ°ÁêÜundo <a class="header-anchor" href="#‰∏É„ÄÅÁÆ°ÁêÜundo" aria-label="Permalink to &quot;‰∏É„ÄÅÁÆ°ÁêÜundo&quot;"></a></h2>
<p>7.1 Undo‰ΩúÁî®</p>
<p>7.2 UndoÁöÑÂèÇÊï∞</p>
<p>7.3 UndoÁ©∫Èó¥ÈáçÁî®Êú∫Âà∂</p>
<p>7.4ÂÖ≥‰∫éAUM</p>
<p>7.5 undo ‰ø°ÊÅØÁöÑÊü•ËØ¢</p>
<h2 id="ÂÖ´„ÄÅÊ£ÄÊü•ÁÇπ-checkpoint" tabindex="-1">ÂÖ´„ÄÅÊ£ÄÊü•ÁÇπÔºàcheckpoint) <a class="header-anchor" href="#ÂÖ´„ÄÅÊ£ÄÊü•ÁÇπ-checkpoint" aria-label="Permalink to &quot;ÂÖ´„ÄÅÊ£ÄÊü•ÁÇπÔºàcheckpoint)&quot;"></a></h2>
<p>8.1‰ªÄ‰πàÊòØcheckpoint</p>
<p>8.2Ê£ÄÊü•ÁÇπÂàÜÁ±ª</p>
<h2 id="‰πù„ÄÅÂÆû‰æãÊÅ¢Â§çÊú∫Âà∂" tabindex="-1">‰πù„ÄÅÂÆû‰æãÊÅ¢Â§çÊú∫Âà∂ <a class="header-anchor" href="#‰πù„ÄÅÂÆû‰æãÊÅ¢Â§çÊú∫Âà∂" aria-label="Permalink to &quot;‰πù„ÄÅÂÆû‰æãÊÅ¢Â§çÊú∫Âà∂&quot;"></a></h2>
<p>9.1‰ªÄ‰πàÊòØÂÆû‰æãÊÅ¢Â§ç</p>
<p>9.2Â¢ûÈáèÊ£ÄÊü•ÁÇπÂèëÊå•ÁöÑ‰ΩúÁî®</p>
<h2 id="ÂçÅ„ÄÅÊâãÂ∑•ÂàõÂª∫Êï∞ÊçÆÂ∫ì" tabindex="-1">ÂçÅ„ÄÅÊâãÂ∑•ÂàõÂª∫Êï∞ÊçÆÂ∫ì <a class="header-anchor" href="#ÂçÅ„ÄÅÊâãÂ∑•ÂàõÂª∫Êï∞ÊçÆÂ∫ì" aria-label="Permalink to &quot;ÂçÅ„ÄÅÊâãÂ∑•ÂàõÂª∫Êï∞ÊçÆÂ∫ì&quot;"></a></h2>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Oracle ÊñáÊ°£Áõ∏ÂÖ≥ÊôØË±°Ê¢≥ÁêÜ]]></title>
            <link>https://askaric.com/zh/work/oracle/Summary-ÂéÜÂè≤ÈïúÂÉèÊ¢≥ÁêÜ.html</link>
            <guid>https://askaric.com/zh/work/oracle/Summary-ÂéÜÂè≤ÈïúÂÉèÊ¢≥ÁêÜ.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[‰∏Ä„ÄÅOracle ÂïÜ‰∏öÁâà

| ÁâàÊú¨ÁÆÄÁß∞ | ÁâàÊú¨ÂÖ®Áß∞ | ÈÄÇÁî®Âπ≥Âè∞ | ‰∏ãËΩΩÂú∞ÂùÄ | ‰∏ãËΩΩÂØÜÁ†Å |
| - | - | - | - | - |
| Oracle 11g | enterpri]]></description>
            <content:encoded><![CDATA[<h1 id="oracle-ÊñáÊ°£Áõ∏ÂÖ≥ÊôØË±°Ê¢≥ÁêÜ" tabindex="-1">Oracle ÊñáÊ°£Áõ∏ÂÖ≥ÊôØË±°Ê¢≥ÁêÜ <a class="header-anchor" href="#oracle-ÊñáÊ°£Áõ∏ÂÖ≥ÊôØË±°Ê¢≥ÁêÜ" aria-label="Permalink to &quot;Oracle ÊñáÊ°£Áõ∏ÂÖ≥ÊôØË±°Ê¢≥ÁêÜ&quot;"></a></h1>
<h2 id="‰∏Ä„ÄÅoracle-ÂïÜ‰∏öÁâà" tabindex="-1">‰∏Ä„ÄÅOracle ÂïÜ‰∏öÁâà <a class="header-anchor" href="#‰∏Ä„ÄÅoracle-ÂïÜ‰∏öÁâà" aria-label="Permalink to &quot;‰∏Ä„ÄÅOracle ÂïÜ‰∏öÁâà&quot;"></a></h2>
<table tabindex="0">
<thead>
<tr>
<th>ÁâàÊú¨ÁÆÄÁß∞</th>
<th>ÁâàÊú¨ÂÖ®Áß∞</th>
<th>ÈÄÇÁî®Âπ≥Âè∞</th>
<th>‰∏ãËΩΩÂú∞ÂùÄ</th>
<th>‰∏ãËΩΩÂØÜÁ†Å</th>
</tr>
</thead>
<tbody>
<tr>
<td>Oracle 11g</td>
<td>enterprise</td>
<td>Linux</td>
<td>ÈìæÊé•: <a href="https://pan.baidu.com/s/18czqkSqaqrDeqJkahuyqlw" target="_blank" rel="noreferrer">https://pan.baidu.com/s/18czqkSqaqrDeqJkahuyqlw</a></td>
<td>ÊèêÂèñÁ†Å: 11oi</td>
</tr>
</tbody>
</table>
<h2 id="‰∫å„ÄÅoracle-goldern-gate-ÂïÜ‰∏öÁâà" tabindex="-1">‰∫å„ÄÅOracle Goldern Gate ÂïÜ‰∏öÁâà <a class="header-anchor" href="#‰∫å„ÄÅoracle-goldern-gate-ÂïÜ‰∏öÁâà" aria-label="Permalink to &quot;‰∫å„ÄÅOracle Goldern Gate ÂïÜ‰∏öÁâà&quot;"></a></h2>
<table tabindex="0">
<thead>
<tr>
<th>ÁâàÊú¨ÁÆÄÁß∞</th>
<th>ÁâàÊú¨ÂÖ®Áß∞</th>
<th>ÈÄÇÁî®Âπ≥Âè∞</th>
<th>‰∏ãËΩΩÂú∞ÂùÄ</th>
<th>‰∏ãËΩΩÂØÜÁ†Å</th>
</tr>
</thead>
<tbody>
<tr>
<td>OGG(11g)ËΩØ‰ª∂ËµÑÊ∫ê</td>
<td>enterprise</td>
<td>Linux</td>
<td>ÈìæÊé•: <a href="https://pan.baidu.com/s/1k6cao3rgeDrFnWO9ojaRRA" target="_blank" rel="noreferrer">https://pan.baidu.com/s/1k6cao3rgeDrFnWO9ojaRRA</a></td>
<td>ÊèêÂèñÁ†ÅÔºö0oa2</td>
</tr>
</tbody>
</table>
<h2 id="‰∏â„ÄÅÂë®Ëæπ" tabindex="-1">‰∏â„ÄÅÂë®Ëæπ <a class="header-anchor" href="#‰∏â„ÄÅÂë®Ëæπ" aria-label="Permalink to &quot;‰∏â„ÄÅÂë®Ëæπ&quot;"></a></h2>
<table tabindex="0">
<thead>
<tr>
<th>ÁâàÊú¨ÁÆÄÁß∞</th>
<th>ÁâàÊú¨ÂÖ®Áß∞</th>
<th>ÈÄÇÁî®Âπ≥Âè∞</th>
<th>‰∏ãËΩΩÂú∞ÂùÄ</th>
<th>‰∏ãËΩΩÂØÜÁ†Å</th>
</tr>
</thead>
<tbody>
<tr>
<td>NavicatËµÑÊ∫ê</td>
<td>enterprise</td>
<td>Linux</td>
<td>ÈìæÊé•: <a href="https://pan.baidu.com/s/1dAFJAk9Tu__XByLJiKHupg" target="_blank" rel="noreferrer">https://pan.baidu.com/s/1dAFJAk9Tu__XByLJiKHupg</a></td>
<td>ÊèêÂèñÁ†ÅÔºö5dko</td>
</tr>
<tr>
<td>PL/SQLËµÑÊ∫ê</td>
<td>enterprise</td>
<td>Linux</td>
<td>ÈìæÊé•: <a href="https://pan.baidu.com/s/12BgK4NXdHqAzblRGWUb1-w" target="_blank" rel="noreferrer">https://pan.baidu.com/s/12BgK4NXdHqAzblRGWUb1-w</a></td>
<td>ÊèêÂèñÁ†ÅÔºöpm6h</td>
</tr>
<tr>
<td>OGG(11g)ÂÆòÊñπÊñáÊ°£</td>
<td>enterprise</td>
<td>Linux</td>
<td>ÈìæÊé•Ôºö<a href="https://pan.baidu.com/s/1Nk6BMr-l1dCPszkH_0o0SQ" target="_blank" rel="noreferrer">https://pan.baidu.com/s/1Nk6BMr-l1dCPszkH_0o0SQ</a></td>
<td>ÊèêÂèñÁ†ÅÔºö9gki</td>
</tr>
</tbody>
</table>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Oracle DataGuard Ê¶ÇÂøµÊ¢≥ÁêÜ]]></title>
            <link>https://askaric.com/zh/work/oracle/Theory-Oracle DG.html</link>
            <guid>https://askaric.com/zh/work/oracle/Theory-Oracle DG.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[‰∏Ä„ÄÅDataGuard ‰ºòÁÇπ

 1.1 ÁÅæÈöæÊÅ¢Â§ç‰∏éÈ´òÂèØÁî®ÊÄß

Data GuardÊèê‰æõ‰∫ÜÈ´òÊïà„ÄÅÂÖ®Èù¢ÁöÑÁÅæÈöæÊÅ¢Â§çÂíåÈ´òÂèØÁî®ÊÄßËß£ÂÜ≥ÊñπÊ°à„ÄÇ
Êòì‰∫éÁÆ°ÁêÜÁöÑÂàáÊç¢ÂíåÊïÖÈöúËΩ¨ÁßªÂäüËÉΩÂÖÅËÆ∏Âú®‰∏ªÊï∞ÊçÆÂ∫ìÂíåÂ§áÁî®Êï∞ÊçÆÂ∫ì‰πãÈó¥]]></description>
            <content:encoded><![CDATA[<h1 id="oracle-dataguard-Ê¶ÇÂøµÊ¢≥ÁêÜ" tabindex="-1">Oracle DataGuard Ê¶ÇÂøµÊ¢≥ÁêÜ <a class="header-anchor" href="#oracle-dataguard-Ê¶ÇÂøµÊ¢≥ÁêÜ" aria-label="Permalink to &quot;Oracle DataGuard Ê¶ÇÂøµÊ¢≥ÁêÜ&quot;"></a></h1>
<blockquote>
<p><a href="https://www.bilibili.com/video/BV1Ep4y197JA?from=search&amp;seid=17237800447886927935&amp;spm_id_from=333.337.0.0" target="_blank" rel="noreferrer">DBNEST -- Bilibili DataGuard Âü∫Á°ÄÊê≠Âª∫ËßÜÈ¢ëÂú∞ÂùÄ</a></p>
</blockquote>
<h2 id="‰∏Ä„ÄÅdataguard-‰ºòÁÇπ" tabindex="-1">‰∏Ä„ÄÅDataGuard ‰ºòÁÇπ <a class="header-anchor" href="#‰∏Ä„ÄÅdataguard-‰ºòÁÇπ" aria-label="Permalink to &quot;‰∏Ä„ÄÅDataGuard ‰ºòÁÇπ&quot;"></a></h2>
<h3 id="_1-1-ÁÅæÈöæÊÅ¢Â§ç‰∏éÈ´òÂèØÁî®ÊÄß" tabindex="-1">1.1 ÁÅæÈöæÊÅ¢Â§ç‰∏éÈ´òÂèØÁî®ÊÄß <a class="header-anchor" href="#_1-1-ÁÅæÈöæÊÅ¢Â§ç‰∏éÈ´òÂèØÁî®ÊÄß" aria-label="Permalink to &quot;1.1 ÁÅæÈöæÊÅ¢Â§ç‰∏éÈ´òÂèØÁî®ÊÄß&quot;"></a></h3>
<p>Data GuardÊèê‰æõ‰∫ÜÈ´òÊïà„ÄÅÂÖ®Èù¢ÁöÑÁÅæÈöæÊÅ¢Â§çÂíåÈ´òÂèØÁî®ÊÄßËß£ÂÜ≥ÊñπÊ°à„ÄÇ
Êòì‰∫éÁÆ°ÁêÜÁöÑÂàáÊç¢ÂíåÊïÖÈöúËΩ¨ÁßªÂäüËÉΩÂÖÅËÆ∏Âú®‰∏ªÊï∞ÊçÆÂ∫ìÂíåÂ§áÁî®Êï∞ÊçÆÂ∫ì‰πãÈó¥ËøõË°åËßíËâ≤ËΩ¨Êç¢Ôºå
‰ªéËÄåÊúÄÂ∞èÂåñ‰∏ªÊï∞ÊçÆÂ∫ìÂú®ËÆ°ÂàíÂÜÖÂíåËÆ°ÂàíÂ§ñÂÅúÊú∫Êó∂ÁöÑÂÅúÊú∫Êó∂Èó¥„ÄÇ</p>
<h3 id="_1-2-ÂÆåÊï¥ÁöÑÊï∞ÊçÆ‰øùÊä§" tabindex="-1">1.2 ÂÆåÊï¥ÁöÑÊï∞ÊçÆ‰øùÊä§ <a class="header-anchor" href="#_1-2-ÂÆåÊï¥ÁöÑÊï∞ÊçÆ‰øùÊä§" aria-label="Permalink to &quot;1.2 ÂÆåÊï¥ÁöÑÊï∞ÊçÆ‰øùÊä§&quot;"></a></h3>
<p>Êï∞ÊçÆ‰øùÊä§ÂèØ‰ª•Á°Æ‰øùÈõ∂Êï∞ÊçÆ‰∏¢Â§±ÔºåÂç≥‰ΩøÈù¢ÂØπ‰∏çÂèØÈ¢ÑËßÅÁöÑÁÅæÈöæÔºåÂ§áÁî®Êï∞ÊçÆÂ∫ìÂèØ‰ª•Èò≤Ê≠¢Êï∞ÊçÆÊçüÂùèÂíåÁî®Êà∑ÈîôËØØ„ÄÇÁî±‰∫é‰ªé‰∏ªÂ∫ìÊé•Êî∂ÁöÑredoÈáçÂÅöÊï∞ÊçÆ‰ºöÂú®Â§áÁî®Â∫ìÈ™åËØÅÔºåÊâÄ‰ª•‰∏ªÂ∫ìÁöÑÂ≠òÂÇ®Á∫ßÁâ©ÁêÜÊçüÂùè‰∏ç‰ºö‰º†Êí≠Âà∞Â§áÂ∫ìÔºåÂèØ‰ª•Èò≤Ê≠¢ÂØºËá¥‰∏ªÂ∫ìÊ∞∏‰πÖÊçüÂùèÁöÑÈÄªËæëÊçüÂùèÊàñÁî®Êà∑ÈîôËØØ„ÄÇ</p>
<h3 id="_1-3-ÊúâÊïàÂà©Áî®Á≥ªÁªüËµÑÊ∫ê" tabindex="-1">1.3 ÊúâÊïàÂà©Áî®Á≥ªÁªüËµÑÊ∫ê <a class="header-anchor" href="#_1-3-ÊúâÊïàÂà©Áî®Á≥ªÁªüËµÑÊ∫ê" aria-label="Permalink to &quot;1.3 ÊúâÊïàÂà©Áî®Á≥ªÁªüËµÑÊ∫ê&quot;"></a></h3>
<p>‰ΩøÁî®‰ªé‰∏ªÂ∫ìÊé•Êî∂Âà∞ÁöÑÈáçÂÅöÊï∞ÊçÆÊõ¥Êñ∞ÁöÑÂ§áÂ∫ìË°®ÂèØÁî®‰∫éÂÖ∂‰ªñ‰ªªÂä°ÔºåÂ¶ÇÂ§á‰ªΩ„ÄÅÊä•Âëä„ÄÅÊ±ÇÂíåÂíåÊü•ËØ¢Ôºå
‰ªéËÄåÂáèÂ∞ë‰∏ªÂ∫ìÊâßË°åËøô‰∫õ‰ªªÂä°ÊâÄÈúÄÁöÑ‰∏ªÊï∞ÊçÆÂ∫ìÂ∑•‰ΩúË¥üËΩΩÔºåËäÇÁúÅÂÆùË¥µÁöÑCPUÂíåI/OÂë®Êúü„ÄÇ</p>
<h3 id="_1-4-ÁÅµÊ¥ªÂπ≥Ë°°ÂèØÁî®ÊÄßÂíåÊÄßËÉΩ" tabindex="-1">1.4 ÁÅµÊ¥ªÂπ≥Ë°°ÂèØÁî®ÊÄßÂíåÊÄßËÉΩ <a class="header-anchor" href="#_1-4-ÁÅµÊ¥ªÂπ≥Ë°°ÂèØÁî®ÊÄßÂíåÊÄßËÉΩ" aria-label="Permalink to &quot;1.4 ÁÅµÊ¥ªÂπ≥Ë°°ÂèØÁî®ÊÄßÂíåÊÄßËÉΩ&quot;"></a></h3>
<p>Oracle Data GuardÊèê‰æõ‰∫ÜÊúÄÂ§ßÁöÑ‰øùÊä§„ÄÅÊúÄÂ§ßÁöÑÂèØÁî®ÊÄßÂíåÊúÄÂ§ßÁöÑÊÄßËÉΩÊ®°ÂºèÔºåÂ∏ÆÂä©‰ºÅ‰∏öÂπ≥Ë°°Êï∞ÊçÆÂèØÁî®ÊÄßÂíåÁ≥ªÁªüÊÄßËÉΩÈúÄÊ±Ç„ÄÇ</p>
<h3 id="_1-5-Ëá™Âä®Èó¥ÈöôÊ£ÄÊµã" tabindex="-1">1.5 Ëá™Âä®Èó¥ÈöôÊ£ÄÊµã <a class="header-anchor" href="#_1-5-Ëá™Âä®Èó¥ÈöôÊ£ÄÊµã" aria-label="Permalink to &quot;1.5 Ëá™Âä®Èó¥ÈöôÊ£ÄÊµã&quot;"></a></h3>
<p>Â¶ÇÊûú‰∏ªÊï∞ÊçÆÂ∫ìÂíå‰∏Ä‰∏™ÊàñÂ§ö‰∏™Â§áÁî®Êï∞ÊçÆÂ∫ì‰πãÈó¥Â§±Ëøû(‰æãÂ¶ÇÔºåÁî±‰∫éÁΩëÁªúÈóÆÈ¢ò)ÔºåredoÊï∞ÊçÆÊó†Ê≥ïÊ≠£Â∏∏‰º†ÈÄÅ„ÄÇ
‰∏ÄÊó¶ÈáçÊñ∞ËøûÊé•ÔºåDG‰ºöËá™Âä®Ê£ÄÊµã‰∏¢Â§±ÁöÑÂΩíÊ°£ÈáçÂÅöÊó•ÂøóÊñá‰ª∂(Áß∞‰∏∫gap)ÔºåËá™Âä®Â∞Ü‰∏¢Â§±ÁöÑÂΩíÊ°£ÈáçÂÅöÊó•ÂøóÊñá‰ª∂‰º†ËæìÂà∞Â§áÂ∫ìÔºåÂ§áÁî®Êï∞ÊçÆÂ∫ì‰∏é‰∏ªÊï∞ÊçÆÂ∫ìÊòØÂêåÊ≠•ÁöÑÔºåDBAÊó†ÈúÄÊâãÂä®Âπ≤È¢Ñ„ÄÇ</p>
<h3 id="_1-6-ÈõÜ‰∏≠ÁÆÄÂçïÁÆ°ÁêÜ" tabindex="-1">1.6 ÈõÜ‰∏≠ÁÆÄÂçïÁÆ°ÁêÜ <a class="header-anchor" href="#_1-6-ÈõÜ‰∏≠ÁÆÄÂçïÁÆ°ÁêÜ" aria-label="Permalink to &quot;1.6 ÈõÜ‰∏≠ÁÆÄÂçïÁÆ°ÁêÜ&quot;"></a></h3>
<p>Êï∞ÊçÆ‰øùÊä§‰ª£ÁêÜÊèê‰æõÂõæÂΩ¢Áî®Êà∑ÁïåÈù¢(Data Guard Broker)ÂíåÂëΩ‰ª§Ë°åÁïåÈù¢Ôºå‰ª•‰æøÂú®Êï∞ÊçÆ‰øùÊä§ÈÖçÁΩÆ‰∏≠Ë∑®Â§ö‰∏™Êï∞ÊçÆÂ∫ìËá™Âä®ÂåñÁÆ°ÁêÜÂíåÊìç‰Ωú‰ªªÂä°„ÄÇ‰ª£ÁêÜËøòÁõëËßÜÂçï‰∏™Êï∞ÊçÆ‰øùÊä§ÈÖçÁΩÆ‰∏≠ÁöÑÊâÄÊúâÁ≥ªÁªü„ÄÇ</p>
<h3 id="_1-7-‰∏é-oracle-Êï∞ÊçÆÂ∫ìÈõÜÊàê" tabindex="-1">1.7 ‰∏é Oracle Êï∞ÊçÆÂ∫ìÈõÜÊàê <a class="header-anchor" href="#_1-7-‰∏é-oracle-Êï∞ÊçÆÂ∫ìÈõÜÊàê" aria-label="Permalink to &quot;1.7 ‰∏é Oracle Êï∞ÊçÆÂ∫ìÈõÜÊàê&quot;"></a></h3>
<p>Êï∞ÊçÆ‰øùÊä§ÊòØOracleÊï∞ÊçÆÂ∫ì‰ºÅ‰∏öÁâàÁöÑ‰∏Ä‰∏™ÁâπÊÄßÔºå‰∏çÈúÄË¶ÅÂÉèRAC‰∏ÄÊ†∑ÂçïÁã¨ÂÆâË£Ö„ÄÇ</p>
<h3 id="_1-8-Ëá™Âä®ËΩ¨Êç¢ËßíËâ≤" tabindex="-1">1.8 Ëá™Âä®ËΩ¨Êç¢ËßíËâ≤ <a class="header-anchor" href="#_1-8-Ëá™Âä®ËΩ¨Êç¢ËßíËâ≤" aria-label="Permalink to &quot;1.8 Ëá™Âä®ËΩ¨Êç¢ËßíËâ≤&quot;"></a></h3>
<p>ÂΩìÂêØÁî®Âø´ÈÄüÂêØÂä®ÊïÖÈöúËΩ¨ÁßªÊó∂ÔºåÂú®‰∏ªÁ´ôÁÇπÂèëÁîüÁÅæÈöæÊó∂ÔºåÊï∞ÊçÆ‰øùÊä§‰ª£ÁêÜËá™Âä®ÊïÖÈöúËΩ¨ÁßªÂà∞ÂêåÊ≠•Â§áÁî®Á´ôÁÇπÔºå‰∏çÈúÄË¶ÅDBAÁöÑÂπ≤È¢Ñ„ÄÇÊ≠§Â§ñÔºåËøò‰ºöËá™Âä®ÈÄöÁü•Â∫îÁî®Á®ãÂ∫èËßíËâ≤ËΩ¨Êç¢„ÄÇ</p>
<h2 id="‰∫å„ÄÅdg-Âü∫Êú¨Ê¶ÇÂøµ" tabindex="-1">‰∫å„ÄÅDG Âü∫Êú¨Ê¶ÇÂøµ <a class="header-anchor" href="#‰∫å„ÄÅdg-Âü∫Êú¨Ê¶ÇÂøµ" aria-label="Permalink to &quot;‰∫å„ÄÅDG Âü∫Êú¨Ê¶ÇÂøµ&quot;"></a></h2>
<p>Oracle Data Guard‰ºÅ‰∏öÊï∞ÊçÆÁöÑÈ´òÂèØÁî®ÊÄß„ÄÅÊï∞ÊçÆ‰øùÊä§ÂíåÁÅæÈöæÊÅ¢Â§ç,ÁÆÄÁß∞Ôºö<strong>DG</strong> „ÄÇDGÊèê‰æõ‰∏ÄÁªÑÂÖ®Èù¢ÁöÑÊúçÂä°ÔºåÁî®‰∫éÂàõÂª∫„ÄÅÁª¥Êä§„ÄÅÁÆ°ÁêÜÂíåÁõëËßÜ‰∏Ä‰∏™ÊàñÂ§ö‰∏™Â§áÁî®Êï∞ÊçÆÂ∫ìÔºå‰Ωø<strong>Áîü‰∫ßÂ∫ì</strong>ËÉΩÂ§üÂú®<strong>ÁÅæÈöæÂíåÊï∞ÊçÆÊçüÂùèÊó∂</strong>Âπ∏Â≠ò„ÄÇ</p>
<ol>
<li>DGÂ∞ÜÂ§áÂ∫ì‰Ωú‰∏∫Áîü‰∫ßÂ∫ìÂâØÊú¨ÁöÑÊñπÂºèËøõË°åÁª¥Êä§ÔºåÂΩìÁîü‰∫ßÊï∞ÊçÆÂ∫ìÁî±‰∫éËÆ°ÂàíÊàñËÆ°ÂàíÂ§ñÁöÑÂÅúÊú∫ËÄåÂèòÂæó‰∏çÂèØÁî®Êó∂ÔºåDGÂèØ‰ª•Â∞Ü‰ªª‰ΩïÂ§áÁî®Êï∞ÊçÆÂ∫ìÂàáÊç¢Âà∞‰∏ªÂ∫ìËßíËâ≤Ôºå‰ªéËÄåÊúÄÂ∞èÂåñ‰∏éÂÅúÊú∫Áõ∏ÂÖ≥ÁöÑÂÅúÊú∫Êó∂Èó¥„ÄÇ</li>
<li>DGÂèØ‰ª•‰∏é‰º†ÁªüÁöÑÂ§á‰ªΩ„ÄÅÊÅ¢Â§çÂíåÈõÜÁæ§ÊäÄÊúØ‰∏ÄËµ∑‰ΩøÁî®Ôºå‰ª•Êèê‰æõÈ´òÊ∞¥Âπ≥ÁöÑÊï∞ÊçÆ‰øùÊä§ÂíåÊï∞ÊçÆÂèØÁî®ÊÄß„ÄÇ</li>
<li>DGÂèØ‰ª•Â∞ÜËµÑÊ∫êÂØÜÈõÜÂûãÂ§á‰ªΩÂíåÊä•ÂëäÊìç‰ΩúËΩ¨ÁßªÂà∞Â§áÁî®Á≥ªÁªü‰ºòÂåñÁîü‰∫ßÂ∫ìÊÄßËÉΩ„ÄÇ</li>
</ol>
<figure><img src="http://cdn.lifemini.cn/dbblog/20210115/a501d3e4459f44dda10f896e7694ede3.png" alt="DGÂéüÁêÜÂõæ" tabindex="0"><figcaption>DGÂéüÁêÜÂõæ</figcaption></figure>
<p>DGÁî±‰∏Ä‰∏™‰∏ªÂ∫ìÂíåËã•Âπ≤Â§áÂ∫ìÁªÑÊàêÔºå‰∏ªÂ§áÂ∫ì‰πãÈó¥‰ª•ÁΩëÁªúËøûÊé•„ÄÇ
‰∏ªÂ§áÂ∫ì‰πãÈó¥Áõ∏‰∫íÊ≤üÈÄöÔºå‰∏çÂèó‰ªÖËÉΩ‰ΩøÁî®Êú¨Âú∞Â±ÄÂüüÁΩëÁªúÈôêÂà∂„ÄÇ
<strong>‰æãÂ¶Ç</strong>Ôºö‰Ω†ÂèØ‰ª•Âú®‚ÄúÂåó‰∫¨‚ÄùÂíå‚Äú‰∏äÊµ∑‚Äù‰∏§Âú∞ÁöÑ‰∏§Âè∞ÂêåÁâàÊú¨OracleÊï∞ÊçÆÂ∫ì‰πãÈó¥Êê≠Âª∫‰∏Ä‰∏™DG„ÄÇ</p>
<h3 id="_2-1-Áâ©ÁêÜÂ§áÁî®Êï∞ÊçÆÂ∫ì" tabindex="-1">2.1 Áâ©ÁêÜÂ§áÁî®Êï∞ÊçÆÂ∫ì <a class="header-anchor" href="#_2-1-Áâ©ÁêÜÂ§áÁî®Êï∞ÊçÆÂ∫ì" aria-label="Permalink to &quot;2.1 Áâ©ÁêÜÂ§áÁî®Êï∞ÊçÆÂ∫ì&quot;"></a></h3>
<p>Âú®Á£ÅÁõò‰∏äÁöÑÊï∞ÊçÆÂ∫ìÁªìÊûÑ‰∏é‰∏ªÊï∞ÊçÆÂ∫ìÂú®ÂùóÂØπÂùóÁöÑÂü∫Á°Ä‰∏äÁõ∏Âêå,Êèê‰æõ‰∏é‰∏ªÂ∫ìÁâ©ÁêÜ‰∏äÁõ∏ÂêåÁöÑÂâØÊú¨„ÄÇ
Êï∞ÊçÆÂ∫ìÊ®°Âºè(ÂåÖÊã¨Á¥¢Âºï)ÊòØÁõ∏ÂêåÁöÑ„ÄÇÁâ©ÁêÜÂ§áÁî®Êï∞ÊçÆÂ∫ìÈÄöËøáRedo Apply‰∏é‰∏ªÊï∞ÊçÆÂ∫ì‰øùÊåÅÂêåÊ≠•Ôºå
Redo ApplyÊÅ¢Â§ç‰ªé‰∏ªÊï∞ÊçÆÂ∫ìÊé•Êî∂Âà∞ÁöÑÈáçÂÅöÊï∞ÊçÆÔºåÂπ∂Â∞ÜredoÂ∫îÁî®‰∫éÁâ©ÁêÜÂ§áÂ∫ì„ÄÇ</p>
<p><strong>Active Data Guard(ADG)</strong>
‰ªéOracleÊï∞ÊçÆÂ∫ì11gÁâàÊú¨1(11.1)ÂºÄÂßãÔºåÁâ©ÁêÜÂ§áÂ∫ìÂèØ‰ª•Âú®<strong>Âè™ËØªÊ®°ÂºèÊâìÂºÄÊó∂</strong>Êé•Êî∂ÂíåÂ∫îÁî®ÈáçÂÅöredo„ÄÇ
Âõ†Ê≠§ÔºåÂèØ‰ª•ÂêåÊó∂‰ΩøÁî®Áâ©ÁêÜÂ§áÁî®Êï∞ÊçÆÂ∫ìËøõË°åÊï∞ÊçÆ‰øùÊä§ÂíåÊä•Âëä„ÄÇ
<img src="http://cdn.lifemini.cn/dbblog/20210115/2a065e73ddcf478c9954bc48af0a172e.png" alt="Áâ©ÁêÜÂ§áÂ∫ì"></p>
<h3 id="_2-2-ÈÄªËæëÂ§áÁî®Êï∞ÊçÆÂ∫ì" tabindex="-1">2.2 ÈÄªËæëÂ§áÁî®Êï∞ÊçÆÂ∫ì <a class="header-anchor" href="#_2-2-ÈÄªËæëÂ§áÁî®Êï∞ÊçÆÂ∫ì" aria-label="Permalink to &quot;2.2 ÈÄªËæëÂ§áÁî®Êï∞ÊçÆÂ∫ì&quot;"></a></h3>
<p>Êï∞ÊçÆÁöÑÁâ©ÁêÜÁªÑÁªáÂíåÁªìÊûÑÂèØËÉΩ‰∏çÂêåÔºåÂ¶ÇÔºöÂπ≥Âè∞ÂºÇÊûÑ„ÄÇ‰∏ªÂ∫ì‰∏éÂ§áÂ∫ìÈÄªËæë‰ø°ÊÅØÁõ∏Âêå„ÄÇÈÄªËæëÂ§áÂ∫ìÈÄöËøáSQL Apply‰∏é‰∏ªÂ∫ìÂêåÊ≠•ÔºåÂêéËÄÖÂ∞Ü‰ªé‰∏ªÊï∞ÊçÆÂ∫ìÊé•Êî∂ÁöÑÈáçÂÅö‰∏≠ÁöÑÊï∞ÊçÆËΩ¨Êç¢‰∏∫SQLËØ≠Âè•ÔºåÁÑ∂ÂêéÂú®Â§áÁî®Êï∞ÊçÆÂ∫ì‰∏äÊâßË°åSQLËØ≠Âè•„ÄÇ</p>
<p>Â∞Ü‰∏ªÂ∫ìÁöÑredo log‰º†ÈÄíÂà∞Â§áÂ∫ìÂêéÔºåÂÜçÂà©Áî®logminer ÁöÑÂ∑•ÂÖ∑Ôºå‰ªéredo log‰∏≠Ëß£ÊûêÂá∫sqlËØ≠Âè•ÔºåÂú®Â§áÂ∫ìÊâßË°åÔºå‰øùËØÅÂíå‰∏ªÂ∫ìÂêåÊ≠•„ÄÇÔºà‰∏ªÂ∫ìÂíåÂ§áÂ∫ìÂèØ‰ª•ÊòØ‰∏çÂêåÁöÑÁéØÂ¢ÉÔºåÂ§áÂ∫ìÂèØ‰ª•Â§Ñ‰∫éËØªÂÜôÁä∂ÊÄÅÔºâÈÄªËæëÂ§áÂ∫ìÂèØ‰ª•Áúã‰ΩúÊòØ‰∏Ä‰∏™ÂçïÁã¨ÁöÑÂ∫ìÔºåÊï∞ÊçÆÂ∫ìÂêçÂíåDBIDÂíå‰∏ªÂ∫ìÈÉΩ‰∏ç‰∏ÄÊ†∑„ÄÇÔºàÁâ©ÁêÜÁöÑÂ§áÂ∫ìÂíå‰∏ªÂ∫ìÁöÑÊï∞ÊçÆÂ∫ìÂêçÂíåDBIDÈÉΩÊòØÂêåÊ†∑ÁöÑ„ÄÇÔºâ</p>
<p>Èô§‰∫ÜÁÅæÈöæÊÅ¢Â§çÂ§ñÔºåÁî®Êà∑ÂèØ‰ª•ÈöèÊó∂ËÆøÈóÆÁî®‰∫éÊü•ËØ¢ÂíåÊä•ÂëäÁõÆÁöÑÁöÑÈÄªËæëÂ§áÂ∫ì„ÄÇ‰ΩøÁî®ÈÄªËæëÂ§áÂ∫ìÔºåÂèØÂçáÁ∫ßOracleÊï∞ÊçÆÂ∫ìËΩØ‰ª∂ÂíåË°•‰∏ÅÈõÜÔºåÂá†‰πé‰∏çÈúÄË¶ÅÂÅúÊú∫„ÄÇÂõ†Ê≠§ÔºåÂèØ‰ª•ÂêåÊó∂‰ΩøÁî®ÈÄªËæëÂ§áÁî®Êï∞ÊçÆÂ∫ìËøõË°åÊï∞ÊçÆ‰øùÊä§„ÄÅÊä•ÂëäÂíåÊï∞ÊçÆÂ∫ìÂçáÁ∫ß„ÄÇ
<img src="http://cdn.lifemini.cn/dbblog/20210115/5e0e0837d27b42b68d6e52860583637e.png" alt="ÈÄªËæëÂ§áÂ∫ì"></p>
<h3 id="_2-3-Â§áÁî®Êï∞ÊçÆÂ∫ìÂø´ÁÖß" tabindex="-1">2.3 Â§áÁî®Êï∞ÊçÆÂ∫ìÂø´ÁÖß <a class="header-anchor" href="#_2-3-Â§áÁî®Êï∞ÊçÆÂ∫ìÂø´ÁÖß" aria-label="Permalink to &quot;2.3 Â§áÁî®Êï∞ÊçÆÂ∫ìÂø´ÁÖß&quot;"></a></h3>
<h4 id="Âø´ÁÖßÂ§áÁî®Êï∞ÊçÆÂ∫ìÊòØÂÆåÂÖ®ÂèØÊõ¥Êñ∞ÁöÑÂ§áÁî®Êï∞ÊçÆÂ∫ì" tabindex="-1">Âø´ÁÖßÂ§áÁî®Êï∞ÊçÆÂ∫ìÊòØÂÆåÂÖ®ÂèØÊõ¥Êñ∞ÁöÑÂ§áÁî®Êï∞ÊçÆÂ∫ì <a class="header-anchor" href="#Âø´ÁÖßÂ§áÁî®Êï∞ÊçÆÂ∫ìÊòØÂÆåÂÖ®ÂèØÊõ¥Êñ∞ÁöÑÂ§áÁî®Êï∞ÊçÆÂ∫ì" aria-label="Permalink to &quot;Âø´ÁÖßÂ§áÁî®Êï∞ÊçÆÂ∫ìÊòØÂÆåÂÖ®ÂèØÊõ¥Êñ∞ÁöÑÂ§áÁî®Êï∞ÊçÆÂ∫ì&quot;"></a></h4>
<p>‰∏éÁâ©ÁêÜÊàñÈÄªËæëÂ§áÂ∫ì‰∏ÄÊ†∑ÔºåÂø´ÁÖßÂ§áÂ∫ì‰ªé‰∏ªÂ∫ìÊé•Êî∂Âπ∂ÂΩíÊ°£redoÊï∞ÊçÆ„ÄÇ
‰∏éÁâ©ÁêÜÊàñÈÄªËæëÂ§áÂ∫ì‰∏çÂêåÔºåÂø´ÁÖßÂ§áÁî®Êï∞ÊçÆÂ∫ì‰∏çÂ∫îÁî®ÂÆÉÊé•Êî∂Âà∞ÁöÑÈáçÂÅöÊï∞ÊçÆ„ÄÇ
Âø´ÁÖßÂ§áÂ∫ìÊé•Êî∂Âà∞ÁöÑÈáçÂÅöÊï∞ÊçÆÂú®Â∞ÜÂø´ÁÖßÂ§áÂ∫ìËΩ¨Êç¢ÂõûÁâ©ÁêÜÂ§áÂ∫ì‰πãÂâç‰∏ç‰ºöÂ∫îÁî®Ôºå
ËΩ¨Êç¢Áâ©ÁêÜÂ§áÂ∫ì‰πãÂâçÔºåÂ∞ÜÈ¶ñÂÖà‰∏¢ÂºÉÂØπÂø´ÁÖßÂ§áÂ∫ìÊâÄÂÅöÁöÑ‰ªª‰ΩïÊú¨Âú∞Êõ¥Êñ∞„ÄÇ</p>
<h2 id="‰∏â„ÄÅÊï∞ÊçÆ‰øùÊä§Ê®°Âºè" tabindex="-1">‰∏â„ÄÅÊï∞ÊçÆ‰øùÊä§Ê®°Âºè <a class="header-anchor" href="#‰∏â„ÄÅÊï∞ÊçÆ‰øùÊä§Ê®°Âºè" aria-label="Permalink to &quot;‰∏â„ÄÅÊï∞ÊçÆ‰øùÊä§Ê®°Âºè&quot;"></a></h2>
<p>Êüê‰∫õÊÉÖÂÜµ‰∏ãÔºå‰ºÅ‰∏öÈÉΩÊâøÊãÖ‰∏çËµ∑‰∏¢Â§±Êï∞ÊçÆÁöÑ‰ª£‰ª∑Ôºõ
Êüê‰∫õÊÉÖÂÜµ‰∏ãÔºåÊï∞ÊçÆÂ∫ìÁöÑÂèØÁî®ÊÄßÂèØËÉΩÊØî‰ªª‰ΩïÊΩúÂú®ÁöÑÊï∞ÊçÆ‰∏¢Â§±Êõ¥ÈáçË¶ÅÔºõ
Êüê‰∫õÊÉÖÂÜµ‰∏ãÔºå‰∏Ä‰∫õÂ∫îÁî®Á®ãÂ∫èÂú®‰ªª‰ΩïÊó∂ÂÄôÈÉΩÈúÄË¶ÅÊúÄÂ§ßÁöÑÊï∞ÊçÆÂ∫ìÊÄßËÉΩÔºåÂ¶ÇÊûú‰ªª‰ΩïÁªÑ‰ª∂Âá∫Áé∞ÊïÖÈöúÔºåÂèØ‰ª•ÂÆπÂøçÂ∞ëÈáèÁöÑÊï∞ÊçÆ‰∏¢Â§±„ÄÇ‰∏∫Êª°Ë∂≥‰ª•‰∏ä‰∏çÂêåÈúÄÊ±ÇÔºåÊïÖËÄå‰∫ßÁîü‰∏çÂêåÁöÑ‰øùÊä§Ê®°Âºè„ÄÇ</p>
<h3 id="_3-1-ÊúÄÂ§ßÊÄßËÉΩÊ®°Âºè" tabindex="-1">3.1 ÊúÄÂ§ßÊÄßËÉΩÊ®°Âºè <a class="header-anchor" href="#_3-1-ÊúÄÂ§ßÊÄßËÉΩÊ®°Âºè" aria-label="Permalink to &quot;3.1 ÊúÄÂ§ßÊÄßËÉΩÊ®°Âºè&quot;"></a></h3>
<p>ËøôÊòØÈªòËÆ§ÁöÑ‰øùÊä§Ê®°Âºè„ÄÇ
ÂÆÉÂú®‰∏çÂΩ±Âìç‰∏ªÊï∞ÊçÆÂ∫ìÊÄßËÉΩÁöÑÊÉÖÂÜµ‰∏ãÊèê‰æõ‰∫ÜÊúÄÈ´òÁ∫ßÂà´ÁöÑÊï∞ÊçÆ‰øùÊä§„ÄÇËøôÊòØÈÄöËøáÂÖÅËÆ∏‰∫ãÂä°Âú®Áî±ÈÇ£‰∫õ‰∫ãÂä°ÁîüÊàêÁöÑÊâÄÊúâÈáçÂÅöÊï∞ÊçÆË¢´ÂÜôÂÖ•Âú®Á∫øÊó•ÂøóÂêéÁ´ãÂç≥Êèê‰∫§Êù•ÂÆûÁé∞ÁöÑ„ÄÇÈáçÂÅöÊï∞ÊçÆ‰πüÂÜôÂÖ•‰∏Ä‰∏™ÊàñÂ§ö‰∏™Â§áÁî®Êï∞ÊçÆÂ∫ìÔºå‰ΩÜËøôÊòØÊ†πÊçÆ‰∫ãÂä°ÊâøËØ∫ÂºÇÊ≠•ÂÆåÊàêÁöÑÔºåÂõ†Ê≠§‰∏ªÊï∞ÊçÆÂ∫ìÊÄßËÉΩ‰∏çÂèóÂêëÂ§áÁî®Êï∞ÊçÆÂ∫ìÂÜôÂÖ•ÈáçÂÅöÊï∞ÊçÆÂª∂ËøüÁöÑÂΩ±Âìç„ÄÇ</p>
<h3 id="_3-2-ÊúÄÂ§ßÂèØÁî®ÊÄßÊ®°Âºè" tabindex="-1">3.2 ÊúÄÂ§ßÂèØÁî®ÊÄßÊ®°Âºè <a class="header-anchor" href="#_3-2-ÊúÄÂ§ßÂèØÁî®ÊÄßÊ®°Âºè" aria-label="Permalink to &quot;3.2 ÊúÄÂ§ßÂèØÁî®ÊÄßÊ®°Âºè&quot;"></a></h3>
<p>Ê≠§Ê®°ÂºèÂú®‰∏çÂΩ±Âìç‰∏ªÊï∞ÊçÆÂ∫ìÂèØÁî®ÊÄßÁöÑÊÉÖÂÜµ‰∏ãÔºåÊèê‰æõ‰∫ÜÊúÄÈ´òÁ∫ßÂà´ÁöÑÊï∞ÊçÆ‰øùÊä§„ÄÇ
‰∫ãÂä°Âè™ÊúâÂú®Â∞ÜÊÅ¢Â§çËøô‰∫õ‰∫ãÂä°ÊâÄÈúÄÁöÑÊâÄÊúâÈáçÂÅöÊï∞ÊçÆÂÜôÂÖ•Ëá≥Â∞ë‰∏Ä‰∏™ÂêåÊ≠•Â§áÁî®Êï∞ÊçÆÂ∫ìÁöÑÂú®Á∫øÈáçÂÅöÊó•ÂøóÂíåÂ§áÁî®ÈáçÂÅöÊó•Âøó‰πãÂêéÊâç‰ºöÊèê‰∫§„ÄÇÂ¶ÇÊûú‰∏ªÊï∞ÊçÆÂ∫ì‰∏çËÉΩÂ∞ÜÂÖ∂ÈáçÂÅöÊµÅÂÜôÂÖ•Ëá≥Â∞ë‰∏Ä‰∏™ÂêåÊ≠•Â§áÁî®Êï∞ÊçÆÂ∫ìÔºåÂàôÂÖ∂Êìç‰ΩúÊñπÂºèÂ∞±ÂÉèÂ§Ñ‰∫éÊúÄÂ§ßÊÄßËÉΩÊ®°ÂºèÔºå‰ª•‰øùÊåÅ‰∏ªÊï∞ÊçÆÂ∫ìÂèØÁî®ÊÄßÔºåÁõ¥Âà∞ÂÜçÊ¨°ËÉΩÂ§üÂ∞ÜÂÖ∂ÈáçÂÅöÊµÅÂÜôÂÖ•ÂêåÊ≠•Â§áÁî®Êï∞ÊçÆÂ∫ì‰∏∫Ê≠¢„ÄÇËøôÁßç‰øùÊä§Ê®°ÂºèÂèØ‰ª•Á°Æ‰øùÈõ∂Êï∞ÊçÆ‰∏¢Â§±ÔºåÈô§ÈùûÂá∫Áé∞Êüê‰∫õÂèåÈáçÊïÖÈöúÔºå‰æãÂ¶ÇÂ§áÁî®Êï∞ÊçÆÂ∫ìÂ§±Ë¥•Âêé‰∏ªÊï∞ÊçÆÂ∫ìÂ§±Ë¥•„ÄÇ
Ê≠§Ê®°ÂºèÊèê‰æõÁöÑÊï∞ÊçÆ‰øùÊä§Áï•Â∞ë‰∫éÊúÄÂ§ßÂèØÁî®ÊÄßÊ®°ÂºèÔºåÂØπ‰∏ªÊï∞ÊçÆÂ∫ìÊÄßËÉΩÁöÑÂΩ±Âìç‰πüÂæàÂ∞è„ÄÇ</p>
<h3 id="_3-3-ÊúÄÂ§ß‰øùÊä§Ê®°Âºè" tabindex="-1">3.3 ÊúÄÂ§ß‰øùÊä§Ê®°Âºè <a class="header-anchor" href="#_3-3-ÊúÄÂ§ß‰øùÊä§Ê®°Âºè" aria-label="Permalink to &quot;3.3 ÊúÄÂ§ß‰øùÊä§Ê®°Âºè&quot;"></a></h3>
<p>Ê≠§Ê®°ÂºèÁ°Æ‰øùÂú®‰∏ªÊï∞ÊçÆÂ∫ìÂ§±Ë¥•Êó∂‰∏ç‰ºöÂèëÁîüÊï∞ÊçÆ‰∏¢Â§±„ÄÇ
‰∏∫‰∫ÜÊèê‰æõËøôÁßçÁ∫ßÂà´ÁöÑ‰øùÊä§ÔºåÂú®‰∫ãÂä°Êèê‰∫§‰πãÂâçÔºåÂøÖÈ°ªÂ∞ÜÊÅ¢Â§ç‰∫ãÂä°ÊâÄÈúÄÁöÑÈáçÂÅöÊï∞ÊçÆÂÜôÂÖ•Ëá≥Â∞ë‰∏Ä‰∏™ÂêåÊ≠•Â§áÁî®Êï∞ÊçÆÂ∫ì‰∏äÁöÑredoÊó•ÂøóÂíåÂ§áÁî®redoÊó•Âøó„ÄÇ‰∏∫‰∫ÜÁ°Æ‰øù‰∏ç‰ºöÂèëÁîüÊï∞ÊçÆ‰∏¢Â§±ÔºåÂ¶ÇÊûú‰∏ªÊï∞ÊçÆÂ∫ì‰∏çËÉΩÂ∞ÜÂÖ∂ÈáçÂÅöÊµÅÂÜôÂÖ•Ëá≥Â∞ë‰∏Ä‰∏™ÂêåÊ≠•Â§áÁî®Êï∞ÊçÆÂ∫ìÔºåÂàô‰∏ªÊï∞ÊçÆÂ∫ìÂ∞ÜÂÖ≥Èó≠ÔºåËÄå‰∏çÊòØÁªßÁª≠Â§ÑÁêÜ‰∫ãÂä°„ÄÇ</p>
]]></content:encoded>
            <enclosure url="http://cdn.lifemini.cn/dbblog/20210115/a501d3e4459f44dda10f896e7694ede3.png" length="0" type="image/png"/>
        </item>
        <item>
            <title><![CDATA[Oracle]]></title>
            <link>https://askaric.com/zh/work/oracle/</link>
            <guid>https://askaric.com/zh/work/oracle/</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="oracle" tabindex="-1">Oracle <a class="header-anchor" href="#oracle" aria-label="Permalink to &quot;Oracle&quot;"></a></h1>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Start--AlwaysOnÈõÜÁæ§ÈÉ®ÁΩ≤]]></title>
            <link>https://askaric.com/zh/work/sqlserver/AlwaysOnÈõÜÁæ§ÈÉ®ÁΩ≤.html</link>
            <guid>https://askaric.com/zh/work/sqlserver/AlwaysOnÈõÜÁæ§ÈÉ®ÁΩ≤.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <content:encoded><![CDATA[<blockquote>
<p><a href="./AlwaysOn%E9%AB%98%E5%8F%AF%E7%94%A8%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2.pdf">DBNEST -- ÊóßÁâàÊñáÊ°£ ‚ÄúÁÇπÂáª‚Äù Áõ¥Êé•ÊµèËßàÊàñ‰∏ãËΩΩ PDF</a></p>
</blockquote>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[SQL Server]]></title>
            <link>https://askaric.com/zh/work/sqlserver/</link>
            <guid>https://askaric.com/zh/work/sqlserver/</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <content:encoded><![CDATA[<h1 id="sql-server" tabindex="-1">SQL Server <a class="header-anchor" href="#sql-server" aria-label="Permalink to &quot;SQL Server&quot;"></a></h1>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Ansible ÈÉ®ÁΩ≤]]></title>
            <link>https://askaric.com/zh/work/tidb/02TIDB-ÈÉ®ÁΩ≤ÂÆûË∑µ/2-1Ansible ÈÉ®ÁΩ≤ÂÆûË∑µ/01Ansible ÈÉ®ÁΩ≤‰∏éÊâ©Áº©ÂÆπ.html</link>
            <guid>https://askaric.com/zh/work/tidb/02TIDB-ÈÉ®ÁΩ≤ÂÆûË∑µ/2-1Ansible ÈÉ®ÁΩ≤ÂÆûË∑µ/01Ansible ÈÉ®ÁΩ≤‰∏éÊâ©Áº©ÂÆπ.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[
## Ansible ÈÉ®ÁΩ≤


### TiDB-AnsibleËß£ÂÜ≥ÁöÑÈóÆÈ¢ò
tidbÁöÑ‰∫åËøõÂà∂ÈÉ®ÁΩ≤Êó∂ÔºåÊüê‰∫õÁéØÂ¢É‰∏ãËäÇÁÇπ‰ºöË∂ÖËøá100+Ôºõ
ÂçïËäÇÁÇπ‰æùÊ¨°ÈÉ®ÁΩ≤ÊòØÈùûÂ∏∏È∫ªÁÉ¶ÔºåÂõ†Ê≠§tidbAnsibleÁªü‰∏ÄÈÉ®ÁΩ≤ÂèäÁÆ°ÁêÜÈùûÂ∏∏ÂøÖË¶ÅÔºõ


TiDB-AnsibleÁöÑÊìç‰ΩúÊó∂ÂπÇÁ≠âÁöÑÔºåÂú®Êìç‰ΩúËøáÁ®ã‰∏≠ÈÅáÂà∞Êä•ÈîôÔºå‰øÆÂ§çÂêéÂç≥ÂèØÁªßÁª≠ÂÆâË£Ö„ÄÇÂÆâË£ÖÊó∂Ê≥®ÊÑèÔºåTiDBÂèäTiDB-AnsibleÁâàÊú¨Ë¶ÅÂØπÂ∫îÔºõ

### TiDB-AnsibleÁõÆÂΩïÁªìÊûÑ

| ‰∏ªË¶ÅÈÉ®ÂàÜ | ËØ¥Êòé |
|]]></description>
            <content:encoded><![CDATA[<h2 id="ansible-ÈÉ®ÁΩ≤" tabindex="-1">Ansible ÈÉ®ÁΩ≤ <a class="header-anchor" href="#ansible-ÈÉ®ÁΩ≤" aria-label="Permalink to &quot;Ansible ÈÉ®ÁΩ≤&quot;"></a></h2>
<h3 id="tidb-ansibleËß£ÂÜ≥ÁöÑÈóÆÈ¢ò" tabindex="-1">TiDB-AnsibleËß£ÂÜ≥ÁöÑÈóÆÈ¢ò <a class="header-anchor" href="#tidb-ansibleËß£ÂÜ≥ÁöÑÈóÆÈ¢ò" aria-label="Permalink to &quot;TiDB-AnsibleËß£ÂÜ≥ÁöÑÈóÆÈ¢ò&quot;"></a></h3>
<p>tidbÁöÑ‰∫åËøõÂà∂ÈÉ®ÁΩ≤Êó∂ÔºåÊüê‰∫õÁéØÂ¢É‰∏ãËäÇÁÇπ‰ºöË∂ÖËøá100+Ôºõ
ÂçïËäÇÁÇπ‰æùÊ¨°ÈÉ®ÁΩ≤ÊòØÈùûÂ∏∏È∫ªÁÉ¶ÔºåÂõ†Ê≠§tidbAnsibleÁªü‰∏ÄÈÉ®ÁΩ≤ÂèäÁÆ°ÁêÜÈùûÂ∏∏ÂøÖË¶ÅÔºõ</p>
<p>TiDB-AnsibleÁöÑÊìç‰ΩúÊó∂ÂπÇÁ≠âÁöÑÔºåÂú®Êìç‰ΩúËøáÁ®ã‰∏≠ÈÅáÂà∞Êä•ÈîôÔºå‰øÆÂ§çÂêéÂç≥ÂèØÁªßÁª≠ÂÆâË£Ö„ÄÇÂÆâË£ÖÊó∂Ê≥®ÊÑèÔºåTiDBÂèäTiDB-AnsibleÁâàÊú¨Ë¶ÅÂØπÂ∫îÔºõ</p>
<h3 id="tidb-ansibleÁõÆÂΩïÁªìÊûÑ" tabindex="-1">TiDB-AnsibleÁõÆÂΩïÁªìÊûÑ <a class="header-anchor" href="#tidb-ansibleÁõÆÂΩïÁªìÊûÑ" aria-label="Permalink to &quot;TiDB-AnsibleÁõÆÂΩïÁªìÊûÑ&quot;"></a></h3>
<table tabindex="0">
<thead>
<tr>
<th>‰∏ªË¶ÅÈÉ®ÂàÜ</th>
<th>ËØ¥Êòé</th>
</tr>
</thead>
<tbody>
<tr>
<td>ymlÊñá‰ª∂</td>
<td>Â≠òÊîæplaybookÂâßÊú¨</td>
</tr>
<tr>
<td>confÁõÆÂΩï</td>
<td>ÈÖçÁΩÆÊñá‰ª∂</td>
</tr>
<tr>
<td>group_varsÁõÆÂΩï</td>
<td>Á´ØÂè£ÈÖçÁΩÆÁ≠â</td>
</tr>
<tr>
<td>inventory.iniÊñá‰ª∂</td>
<td>‰∏ªË¶ÅÁöÑÈÖçÁΩÆÊñá‰ª∂ÔºåÊåáÂÆöÊìç‰Ωú‰∏ªÊú∫</td>
</tr>
<tr>
<td>resourceÂíådownloadÁõÆÂΩï</td>
<td>binaryÂåÖ</td>
</tr>
<tr>
<td>scriptsÁõÆÂΩï</td>
<td>ÁõëÊéßÁõ∏ÂÖ≥jsonÊñá‰ª∂ÔºåÂàùÂßãÂåñ‰πãÂêéÁîüÊàêËøêÁª¥ËÑöÊú¨</td>
</tr>
<tr>
<td>rolesÁõÆÂΩï</td>
<td>ËßíËâ≤Áõ∏ÂÖ≥ÁõÆÂΩïÂíåËá™ÂÆö‰πâÂèòÈáè</td>
</tr>
</tbody>
</table>
<h3 id="tidb-ansibleÂëΩ‰ª§ÁÆÄ‰ªã" tabindex="-1">TiDB-AnsibleÂëΩ‰ª§ÁÆÄ‰ªã <a class="header-anchor" href="#tidb-ansibleÂëΩ‰ª§ÁÆÄ‰ªã" aria-label="Permalink to &quot;TiDB-AnsibleÂëΩ‰ª§ÁÆÄ‰ªã&quot;"></a></h3>
<table tabindex="0">
<thead>
<tr>
<th>ÂäüËÉΩ</th>
<th>ÂëΩ‰ª§</th>
<th>Â§áÊ≥®</th>
</tr>
</thead>
<tbody>
<tr>
<td>ÁéØÂ¢ÉÂàùÂßãÂåñ</td>
<td>ansible-playbook bootstrap.yml</td>
<td>Âú®ÊúçÂä°Âô®ÂàõÂª∫Áõ∏Â∫îÁõÆÂΩïÂπ∂Ê£ÄÊµãÁéØÂ¢É‰ø°ÊÅØ</td>
</tr>
<tr>
<td>ÈÉ®ÁΩ≤ÈõÜÁæ§</td>
<td>ansible-playbook deploy.yml</td>
<td>Ê≠£ÂºèÂºÄÂßãÈÉ®ÁΩ≤ÔºåÂåÖÂê´ÈÖçÁΩÆÊñá‰ª∂ÔºåÂêØÂä®ËÑöÊú¨ÔºåbinaryÂåÖÁöÑÂàÜÂèëÁ≠â</td>
</tr>
<tr>
<td>Êõ¥Êñ∞ÈõÜÁæ§</td>
<td>ansible-playbook rolling_update.yml</td>
<td>ÊØè‰∏™ÁªÑ‰ª∂‰∏ÄÊ≠•‰∏ÄÊ≠•ÂçáÁ∫ßÊìç‰ΩúÔºàpd-&gt;tikv-&gt;tidbÔºâ</td>
</tr>
<tr>
<td>ÂÖ≥Èó≠ÈõÜÁæ§</td>
<td>ansible-playbook stop.yml</td>
<td></td>
</tr>
<tr>
<td>ÂêØÂä®ÈõÜÁæ§</td>
<td>ansible-playbook start.yml</td>
<td></td>
</tr>
</tbody>
</table>
<p>Â∏∏Áî®ÂèÇÊï∞
-l:ÊåáÂÆöhostÊàñËÄÖÂà´Âêç
--tagsÔºöÊåáÂÆötask(tidb„ÄÅtikvÁ≠âÁªÑ‰ª∂)
-f:Ë∞ÉÊï¥Âπ∂Âèë</p>
<h3 id="tidb-ansibleÂú®Á∫øÈÉ®ÁΩ≤tidbÈõÜÁæ§" tabindex="-1">TiDB-AnsibleÂú®Á∫øÈÉ®ÁΩ≤TiDBÈõÜÁæ§ <a class="header-anchor" href="#tidb-ansibleÂú®Á∫øÈÉ®ÁΩ≤tidbÈõÜÁæ§" aria-label="Permalink to &quot;TiDB-AnsibleÂú®Á∫øÈÉ®ÁΩ≤TiDBÈõÜÁæ§&quot;"></a></h3>
<p>ÂèØ‰æõÁ¶ªÁ∫øÈÉ®ÁΩ≤Ê≠•È™§ÂèÇËÄÉ‰ΩøÁî®Ôºõ</p>
<h4 id="ÁéØÂ¢É‰∏éipËßÑÂàí" tabindex="-1">ÁéØÂ¢É‰∏éIPËßÑÂàí <a class="header-anchor" href="#ÁéØÂ¢É‰∏éipËßÑÂàí" aria-label="Permalink to &quot;ÁéØÂ¢É‰∏éIPËßÑÂàí&quot;"></a></h4>
<blockquote>
<p><strong>ÁéØÂ¢ÉËØ¥Êòé</strong></p>
</blockquote>
<p>ÊúçÂä°Âô®ÁéØÂ¢É	CentOS Linux release 7.9.2009 (Core)<br>
Êï∞ÊçÆÂ∫ìÁâàÊú¨	5.7.25-TiDB-v3.0.0<br>
ÊñáÊ°£ÂèÇËÄÉÂú∞ÂùÄ     <a href="https://docs.pingcap.com/zh/tidb/stable/production-deployment-using-tiup" target="_blank" rel="noreferrer"><strong>TiDBÂÆòÁΩëÔºöhttps://docs.pingcap.com/zh/tidb/stable/production-deployment-using-tiup</strong></a></p>
<blockquote>
<p><strong>IPËßÑÂàí</strong></p>
</blockquote>
<table tabindex="0">
<thead>
<tr>
<th>IPÂú∞ÂùÄ</th>
<th>Role‰ø°ÊÅØ</th>
<th>Â§áÊ≥®</th>
</tr>
</thead>
<tbody>
<tr>
<td>192.168.1.41</td>
<td>pd+tikv+tidb-ansible+monitor</td>
<td>ÈÉ®ÁΩ≤‰∏ªÊú∫</td>
</tr>
<tr>
<td>192.168.1.42</td>
<td>pd+tikv+tidb</td>
<td></td>
</tr>
<tr>
<td>192.168.1.43</td>
<td>pd+tikv+tidb</td>
<td></td>
</tr>
<tr>
<td>192.168.1.44</td>
<td>pd+tikv+tidb</td>
<td>Áî®‰∫éÂ¢ûÂà†ËäÇÁÇπ</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>Ê†∏ÂøÉÈÉ®ÁΩ≤Ê≠•È™§</strong></p>
</blockquote>
<ul>
<li>‰∏≠ÊéßÊú∫ÂÆâË£Ö‰æùËµñ
<ul>
<li>‰∏≠ÊéßÊú∫ÂÆâË£Ögit pip curl sshpass</li>
<li>‰∏≠ÊéßÊú∫ÂÆâË£ÖAnsible(2.5+)ÂèäÂÖ∂‰æùËµñ</li>
</ul>
</li>
<li>‰∏≠ÊéßÊú∫ÈÉ®ÁΩ≤ÈÖçÁΩÆ
<ul>
<li>‰∏≠ÊéßÊú∫ÂàõÂª∫tidbÁî®Êà∑Âπ∂ÈÖçÁΩÆ‰∫í‰ø°</li>
<li>‰∏≠ÊéßÊú∫‰∏ãËΩΩTiDB-Ansible(TiDBÁî®Êà∑‰∏ã)</li>
<li>‰∏≠ÊéßÊú∫ÈÖçÁΩÆNTP„ÄÅCPUfrep„ÄÅext4</li>
</ul>
</li>
<li>Ê≠£ÂºèÂºÄÂßãÈÉ®ÁΩ≤
<ul>
<li>ÁºñËæëinventory.ini</li>
<li>bootstrap.ymlÂàùÂßãÂåñÁéØÂ¢É</li>
<li>deploy.ymlÈÉ®ÁΩ≤‰ªªÂä°</li>
<li>start.ymlÂêØÂä®ÈõÜÁæ§</li>
</ul>
</li>
<li>ÊµãËØïÈõÜÁæ§ÈÉ®ÁΩ≤</li>
</ul>
<h4 id="‰∏≠ÊéßÊú∫ÈÖçÁΩÆ‰æùËµñ" tabindex="-1">‰∏≠ÊéßÊú∫ÈÖçÁΩÆ‰æùËµñ <a class="header-anchor" href="#‰∏≠ÊéßÊú∫ÈÖçÁΩÆ‰æùËµñ" aria-label="Permalink to &quot;‰∏≠ÊéßÊú∫ÈÖçÁΩÆ‰æùËµñ&quot;"></a></h4>
<blockquote>
<p><strong>‰∏≠ÊéßÊú∫ÂÆâË£ÖÁ≥ªÁªü‰æùËµñÂåÖ</strong></p>
</blockquote>
<p>Ê≥®ÊÑè‰∫ãÈ°πÔºö</p>
<ol>
<li>Âú®ÂèØËÅîÁΩëÁöÑ‰∏ãËΩΩÊú∫‰∏ä‰∏ãËΩΩÁ≥ªÁªü‰æùËµñÁ¶ªÁ∫øÂÆâË£ÖÂåÖÔºåÁÑ∂Âêé‰∏ä‰º†Ëá≥‰∏≠ÊéßÊú∫„ÄÇ</li>
<li>ËØ•Á¶ªÁ∫øÂåÖ‰ªÖÊîØÊåÅ CentOS 7 Á≥ªÁªüÔºåÂåÖÂê´ÂÆâË£Ögit pip curl sshpass„ÄÇ</li>
<li>pipËØ∑Á°ÆËÆ§ÁâàÊú¨ &gt;= 8.1.2ÔºåÂê¶Âàô‰ºöÊúâÂÖºÂÆπÈóÆÈ¢ò„ÄÇ</li>
</ol>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>tar -xzvf ansible-system-rpms.el7.tar.gz &#x26;&#x26;</span></span>
<span class="line"><span>cd ansible-system-rpms.el7 &#x26;&#x26;</span></span>
<span class="line"><span>chmod u+x install_ansible_system_rpms.sh &#x26;&#x26;</span></span>
<span class="line"><span>./install_ansible_system_rpms.sh</span></span>
<span class="line"><span></span></span>
<span class="line"><span>ansible-system-rpms.el7/</span></span>
<span class="line"><span>ansible-system-rpms.el7/sed-4.2.2-5.el7.x86_64.rpm</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>Installed:</span></span>
<span class="line"><span>  python-backports.x86_64 0:1.0-8.el7        python-backports-ssl_match_hostname.noarch 0:3.4.0.2-4.el7        python-setuptools.noarch 0:0.9.8-7.el7       </span></span>
<span class="line"><span>  python2-pip.noarch 0:8.1.2-5.el7           sshpass.x86_64 0:1.06-2.el7                                      </span></span>
<span class="line"><span></span></span>
<span class="line"><span>Complete!</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>pip -V</span></span>
<span class="line"><span></span></span>
<span class="line"><span>pip 8.1.2 from /usr/lib/python2.7/site-packages (python 2.7)</span></span></code></pre>
</div><blockquote>
<p><strong>‰∏≠ÊéßÊú∫tidb Áî®Êà∑ÁîüÊàê ssh key</strong></p>
</blockquote>
<p>ÂàõÂª∫ tidb Áî®Êà∑Âπ∂‰øÆÊîπÂØÜÁ†Å</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>useradd -m -d /home/tidb tidb</span></span>
<span class="line"><span></span></span>
<span class="line"><span>passwd tidb</span></span></code></pre>
</div><p>ÈÖçÁΩÆ tidb Áî®Êà∑ sudo ÂÖçÂØÜÁ†ÅÔºõ
<span style='color:red'>Â∞Ü tidb ALL=(ALL) NOPASSWD: ALL Ê∑ªÂä†Âà∞Êñá‰ª∂Êú´Â∞æÂç≥ÂèØ</span></p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>visudo</span></span>
<span class="line"><span>tidb ALL=(ALL) NOPASSWD: ALL</span></span></code></pre>
</div><p>tidb Áî®Êà∑‰∏ãÁîüÊàê SSH key,Áõ¥Êé•ÂõûËΩ¶Âç≥ÂèØ;
ÊâßË°åÊàêÂäüÂêé:
SSH ÁßÅÈí•Êñá‰ª∂‰∏∫ /home/tidb/.ssh/id_rsa;
SSH ÂÖ¨Èí•Êñá‰ª∂‰∏∫ /home/tidb/.ssh/id_rsa.pub„ÄÇ</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>su - tidb</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>ssh-keygen -t rsa</span></span>
<span class="line"><span>Generating public/private rsa key pair.</span></span>
<span class="line"><span>Enter file in which to save the key (/home/tidb/.ssh/id_rsa):</span></span>
<span class="line"><span>Created directory '/home/tidb/.ssh'.</span></span>
<span class="line"><span>Enter passphrase (empty for no passphrase):</span></span>
<span class="line"><span>Enter same passphrase again:</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>Your identification has been saved in /home/tidb/.ssh/id_rsa.</span></span>
<span class="line"><span>Your public key has been saved in /home/tidb/.ssh/id_rsa.pub.</span></span>
<span class="line"><span>The key fingerprint is:</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>SHA256:eIBykszR1KyECA/h0d7PRKz4fhAeli7IrVphhte7/So tidb@172.16.10.49</span></span>
<span class="line"><span>The key's randomart image is:</span></span>
<span class="line"><span>+---[RSA 2048]----+</span></span>
<span class="line"><span>|=+o+.o.          |</span></span>
<span class="line"><span>|o=o+o.oo         |</span></span>
<span class="line"><span>| .O.=.=          |</span></span>
<span class="line"><span>| . B.B +         |</span></span>
<span class="line"><span>|o B * B S        |</span></span>
<span class="line"><span>| * + * +         |</span></span>
<span class="line"><span>|  o + .          |</span></span>
<span class="line"><span>| o  E+ .         |</span></span>
<span class="line"><span>|o   ..+o.        |</span></span>
<span class="line"><span>+----[SHA256]-----+</span></span></code></pre>
</div><blockquote>
<p><strong>‰∏≠ÊéßÊú∫Âô®‰∏ä‰∏ãËΩΩ TiDB Ansible</strong></p>
</blockquote>
<p>Ê≥®ÊÑè‰∫ãÈ°πÔºö</p>
<ol>
<li>Âú®TiDBÁî®Êà∑‰∏ãÊìç‰ΩúÔºõ</li>
<li>‰ΩøÁî®‰ª•‰∏ãÂëΩ‰ª§‰ªé TiDB Ansible È°πÁõÆ‰∏ä‰∏ãËΩΩÁõ∏Â∫î TAG ÁâàÊú¨ÁöÑtidb-ansibleÔºå$tag ÊõøÊç¢‰∏∫ÈÄâÂÆöÁöÑ TAG ÁâàÊú¨ÁöÑÂÄºÔºå‰æãÂ¶Ç v3.0.0Ôºõ</li>
<li>‰ΩøÁî®Â§ñÈÉ®‰∏ãËΩΩÊú∫‰∏ãËΩΩÁõ∏Â∫îÁâàÊú¨TiDB AnsibleÂêéÔºåÁî®sftpÁ≠âËΩØ‰ª∂Â∞ÜÂÆâË£ÖÂåÖ‰∏ä‰º†Ôºõ</li>
<li>Â∞Ütidb-ansible‰∏ä‰º†Âà∞/home/tidb ÁõÆÂΩï‰∏ãÔºåÊùÉÈôê‰∏∫ tidb Áî®Êà∑ÔºåÂê¶ÂàôÂèØËÉΩ‰ºöÈÅáÂà∞ÊùÉÈôêÈóÆÈ¢òÔºõ</li>
<li>ÁõÆÂâçÔºåTiDB Ansible release-4.0 ÁâàÊú¨ÂÖºÂÆπ Ansible 2.5 ~ 2.7.11</li>
</ol>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>git clone -b $tag https://github.com/pingcap/tidb-ansible.git</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>scp tidb-ansible tidb@‰∏≠ÊéßÊú∫IP:/home/tidb/</span></span></code></pre>
</div><p>Ansible ÂèäÁõ∏ÂÖ≥‰æùËµñÁöÑÁâàÊú¨‰ø°ÊÅØËÆ∞ÂΩïÂú® tidb-ansible/requirements.txt Êñá‰ª∂‰∏≠„ÄÇ</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>cd /home/tidb/tidb-ansible &#x26;&#x26; \</span></span>
<span class="line"><span>sudo pip install -r ./requirements.txt</span></span></code></pre>
</div><p>Êü•Áúã Ansible ÁöÑÁâàÊú¨</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>ansible --version</span></span>
<span class="line"><span></span></span>
<span class="line"><span>ansible 2.7.11</span></span></code></pre>
</div><blockquote>
<p><strong>‰∏≠ÊéßÊú∫‰∏äÈÖçÁΩÆÈÉ®ÁΩ≤Êú∫Âô® SSH ‰∫í‰ø°Âèä sudo ËßÑÂàô</strong></p>
</blockquote>
<p>Ê≥®ÊÑè‰∫ãÈ°πÔºö
1.‰ª• tidb Áî®Êà∑ÁôªÂΩï‰∏≠ÊéßÊú∫ÔºåÁÑ∂ÂêéÊâßË°å‰ª•‰∏ãÊ≠•È™§Ôºö
2.Â∞Ü‰Ω†ÁöÑÈÉ®ÁΩ≤ÁõÆÊ†áÊú∫Âô® IP Ê∑ªÂä†Âà∞ hosts.ini Êñá‰ª∂ÁöÑ [servers] Âå∫Âùó‰∏ã„ÄÇ
3.<span style='color:red'>cn.pool.ntp.orgÊòØÁΩëÁªú‰∏äÊâæÁöÑ‰∏≠ÂõΩÂÖ¨Áî®ntpÊúçÂä°‰∏çÁ®≥ÂÆöÔºå‰ªÖÈôêÊµãËØïÊú∫‰ΩøÁî®ÔºåÁîü‰∫ßÊúçÂä°Âô®ËØ∑‰ΩøÁî®Ëá™Â∑±ÁöÑntpÊúçÂä°„ÄÇ--<a href="https://www.cnblogs.com/croso/p/6670039.html" target="_blank" rel="noreferrer"><strong>ÂõΩÂÜÖÂ∏∏Áî®NTPÊúçÂä°Âô®Âú∞ÂùÄÂèäIPÁΩëÂùÄÂèÇËÄÉÈìæÊé•</strong></a></span></p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>cd /home/tidb/tidb-ansible &#x26;&#x26; \</span></span>
<span class="line"><span>vi hosts.ini</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>[servers]</span></span>
<span class="line"><span>192.168.1.41</span></span>
<span class="line"><span>192.168.1.42</span></span>
<span class="line"><span>192.168.1.43</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[all:vars]</span></span>
<span class="line"><span>username = tidb</span></span>
<span class="line"><span>ntp_server = cn.pool.ntp.org</span></span></code></pre>
</div><p>ÊâßË°å‰ª•‰∏ãÂëΩ‰ª§Âπ∂ÊåâÊèêÁ§∫ËæìÂÖ•ÈÉ®ÁΩ≤ÁõÆÊ†áÊú∫Âô®ÁöÑ root Áî®Êà∑ÂØÜÁ†ÅÂêéÔºåÂ∞ÜÂú®ÈÉ®ÁΩ≤ÁõÆÊ†áÊú∫Âô®‰∏äÂàõÂª∫ tidb Áî®Êà∑ÔºåÂπ∂ÈÖçÁΩÆ sudo ËßÑÂàôÔºåÈÖçÁΩÆ‰∏≠ÊéßÊú∫‰∏éÈÉ®ÁΩ≤ÁõÆÊ†áÊú∫Âô®‰πãÈó¥ÁöÑ SSH ‰∫í‰ø°„ÄÇ</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>ansible-playbook -i hosts.ini create_users.yml -u root -k</span></span></code></pre>
</div><blockquote>
<p><strong>Âú®ÈÉ®ÁΩ≤ÁõÆÊ†áÊú∫Âô®‰∏äÂÆâË£Ö NTP ÊúçÂä°</strong></p>
</blockquote>
<p>Ê≥®ÊÑè‰∫ãÈ°πÔºö</p>
<ol>
<li>‰ª• tidb Áî®Êà∑ÁôªÂΩï‰∏≠ÊéßÊú∫ÔºåÊâßË°å‰ª•‰∏ãÂëΩ‰ª§Ôºõ</li>
<li>ËØ•Ê≠•È™§Â∞ÜÂú®ÈÉ®ÁΩ≤ÁõÆÊ†áÊú∫Âô®‰∏ä‰ΩøÁî®Á≥ªÁªüËá™Â∏¶ËΩØ‰ª∂Ê∫êËÅîÁΩëÂÆâË£ÖÂπ∂ÂêØÂä® NTP ÊúçÂä°;</li>
<li>ÊúçÂä°‰ΩøÁî®ÂÆâË£ÖÂåÖÈªòËÆ§ÁöÑ NTP server ÂàóË°®ÔºåËßÅÈÖçÁΩÆÊñá‰ª∂ /etc/ntp.conf ‰∏≠ server ÂèÇÊï∞ÔºåÂ¶ÇÊûú‰ΩøÁî®ÈªòËÆ§ÁöÑ NTP serverÔºå‰Ω†ÁöÑÊú∫Âô®ÈúÄË¶ÅËøûÊé•Â§ñÁΩë„ÄÇ</li>
<li>‰∏∫ËÆ© NTP Â∞ΩÂø´ÂºÄÂßãÂêåÊ≠•ÔºåÂêØÂä® NTP ÊúçÂä°ÂâçÔºåÁ≥ªÁªü‰ºöÊâßË°å ntpdate ÂëΩ‰ª§Ôºå‰∏éÁî®Êà∑Âú® hosts.ini Êñá‰ª∂‰∏≠ÊåáÂÆöÁöÑ ntp_server ÂêåÊ≠•Êó•Êúü‰∏éÊó∂Èó¥„ÄÇ</li>
<li>ÈªòËÆ§ÁöÑÊúçÂä°Âô®‰∏∫ pool.ntp.orgÔºå‰πüÂèØÊõøÊç¢‰∏∫‰Ω†ÁöÑ NTP server„ÄÇ</li>
<li><span style='color:red'>Ê≥®ÊÑèÔºöÂ¶ÇÊûú‰Ω†ÁöÑÈÉ®ÁΩ≤ÁõÆÊ†áÊú∫Âô®Êó∂Èó¥„ÄÅÊó∂Âå∫ËÆæÁΩÆ‰∏ÄËá¥ÔºåÂ∑≤ÂºÄÂêØ NTP ÊúçÂä°‰∏îÂú®Ê≠£Â∏∏ÂêåÊ≠•Êó∂Èó¥ÔºåÊ≠§Ê≠•È™§ÂèØÂøΩÁï•„ÄÇÂèØÂèÇËÄÉÂ¶Ç‰ΩïÊ£ÄÊµã NTP ÊúçÂä°ÊòØÂê¶Ê≠£Â∏∏„ÄÇ</span></li>
</ol>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>cd /home/tidb/tidb-ansible &#x26;&#x26; \</span></span>
<span class="line"><span>ansible-playbook -i hosts.ini deploy_ntp.yml -u tidb -b</span></span></code></pre>
</div><blockquote>
<p><strong>Âú®ÈÉ®ÁΩ≤ÁõÆÊ†áÊú∫Âô®‰∏äÈÖçÁΩÆ CPUfreq Ë∞ÉËäÇÂô®Ê®°Âºè</strong></p>
</blockquote>
<p>Ê≥®ÊÑè‰∫ãÈ°πÔºö</p>
<ol>
<li>Â¶ÇÊûúÊîØÊåÅËÆæÁΩÆ performance Âíå powersave Ê®°ÂºèÔºå‰∏∫ÂèëÊå•CPUÊúÄÂ§ßÊÄßËÉΩÔºåÊé®ËçêËÆæÁΩÆCPUfreqË∞ÉËäÇÂô®Ê®°ÂºèÁΩÆ‰∏∫ performance Ê®°ÂºèÔºõ</li>
<li>Êú¨‰æã‰∏≠Á≥ªÁªüËøîÂõû Not AvailableÔºåË°®Á§∫ÂΩìÂâçÁ≥ªÁªü‰∏çÊîØÊåÅÈÖçÁΩÆ CPUfreqÔºåË∑≥ËøáËØ•Ê≠•È™§Âç≥ÂèØÔºõ</li>
</ol>
<p>Êü•ÁúãÁ≥ªÁªüÊîØÊåÅÁöÑË∞ÉËäÇÂô®Ê®°Âºè</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>cpupower frequency-info --governors</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>analyzing CPU 0:</span></span>
<span class="line"><span>  available cpufreq governors: performance powersave</span></span></code></pre>
</div><p style='color:red'>
ÊàñËÄÖ
</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>cpupower frequency-info --governors</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>analyzing CPU 0:</span></span>
<span class="line"><span>  available cpufreq governors: Not Available</span></span></code></pre>
</div><p>Êü•ÁúãÁ≥ªÁªüÂΩìÂâçÁöÑ CPUfreq Ë∞ÉËäÇÂô®Ê®°ÂºèÔºåÂ¶Ç‰∏ãÈù¢‰ª£Á†ÅÊâÄÁ§∫ÔºåÂΩìÂâçÈÖçÁΩÆÊòØ powersave Ê®°Âºè„ÄÇ</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>cpupower frequency-info --policy</span></span>
<span class="line"><span>analyzing CPU 0:</span></span>
<span class="line"><span>  current policy: frequency should be within 1.20 GHz and 3.20 GHz.</span></span>
<span class="line"><span>                  The governor "powersave" may decide which speed to use</span></span>
<span class="line"><span>                  within this range.</span></span></code></pre>
</div><p>‰øÆÊîπË∞ÉËäÇÂô®Ê®°Âºè</p>
<p>ÂèØ‰ª•‰ΩøÁî® cpupower frequency-set --governor ÂëΩ‰ª§ÂçïÊú∫‰øÆÊîπÔºõ</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>cpupower frequency-set --governor performance</span></span></code></pre>
</div><p>‰πüÂèØ‰ª•‰ΩøÁî®‰ª•‰∏ãÂëΩ‰ª§Âú®ÈÉ®ÁΩ≤ÁõÆÊ†áÊú∫Âô®‰∏äÊâπÈáèËÆæÁΩÆ<span style='color:red'>  ÔºàÊé®Ëçê‰ΩøÁî®Ôºâ</span>Ôºõ</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>ansible -i hosts.ini all -m shell -a "cpupower frequency-set --governor performance" -u tidb -b</span></span></code></pre>
</div><blockquote>
<p><strong>Âú®ÈÉ®ÁΩ≤ÁõÆÊ†áÊú∫Âô®‰∏äÊ∑ªÂä†Êï∞ÊçÆÁõò ext4 Êñá‰ª∂Á≥ªÁªüÊåÇËΩΩÂèÇÊï∞</strong></p>
</blockquote>
<ol>
<li>‰ΩøÁî® root Áî®Êà∑ÁôªÂΩïÁõÆÊ†áÊú∫Âô®;</li>
<li>Â∞ÜÈÉ®ÁΩ≤ÁõÆÊ†áÊú∫Âô®Êï∞ÊçÆÁõòÊ†ºÂºèÂåñÊàê ext4 Êñá‰ª∂Á≥ªÁªü;</li>
<li>ÊåÇËΩΩÊó∂Ê∑ªÂä† nodelalloc Âíå noatime ÊåÇËΩΩÂèÇÊï∞;</li>
<li>nodelalloc ÊòØÂøÖÈÄâÂèÇÊï∞ÔºåÂê¶Âàô Ansible ÂÆâË£ÖÊó∂Ê£ÄÊµãÊó†Ê≥ïÈÄöËøá,noatime ÊòØÂèØÈÄâÂª∫ËÆÆÂèÇÊï∞;</li>
<li>Â¶ÇÊûúÊï∞ÊçÆÁõòÂ∑≤ÁªèÊ†ºÂºèÂåñÊàêext4Âπ∂ÊåÇËΩΩÔºåÂèØÂÖàÊâßË°å umount,ÁºñËæë /etc/fstab Êñá‰ª∂ÔºåÊ∑ªÂä†ÊåÇËΩΩÂèÇÊï∞ÂêéÈáçÊñ∞ÊåÇËΩΩ„ÄÇ</li>
<li>‰ΩøÁî® lsblk ÂëΩ‰ª§Êü•ÁúãÂàÜÂå∫ÁöÑËÆæÂ§áÂè∑ÔºöÂØπ‰∫é nvme Á£ÅÁõòÔºàÂõ∫ÊÄÅÁ°¨ÁõòÔºâÔºåÁîüÊàêÁöÑÂàÜÂå∫ËÆæÂ§áÂè∑‰∏ÄËà¨‰∏∫ nvme0n1p1ÔºõÂØπ‰∫éÊôÆÈÄöÁ£ÅÁõòÔºà‰æãÂ¶Ç /dev/sdbÔºâÔºåÁîüÊàêÁöÑÁöÑÂàÜÂå∫ËÆæÂ§áÂè∑‰∏ÄËà¨‰∏∫ sdb1„ÄÇ</li>
</ol>
<span style='color:red'>
‰ª• /dev/nvme0n1 Êï∞ÊçÆÁõò‰∏∫‰æãÔºåÂÖ∑‰ΩìÊìç‰ΩúÊ≠•È™§Â¶Ç‰∏ãÔºö
</span>
<p>Êü•ÁúãÊï∞ÊçÆÁõò;</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>fdisk -l</span></span>
<span class="line"><span>Disk /dev/nvme0n1: 1000 GB</span></span></code></pre>
</div><p>ÂàõÂª∫ÂàÜÂå∫Ë°®;</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>parted -s -a optimal /dev/nvme0n1 mklabel gpt -- mkpart primary ext4 1 -1</span></span></code></pre>
</div><p>Ê†ºÂºèÂåñÊñá‰ª∂Á≥ªÁªü„ÄÇ</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>mkfs.ext4 /dev/nvme0n1p1</span></span></code></pre>
</div><p>Êü•ÁúãÊï∞ÊçÆÁõòÂàÜÂå∫ UUID„ÄÇ
Êú¨‰æã‰∏≠ nvme0n1p1 ÁöÑ UUID ‰∏∫ c51eb23b-195c-4061-92a9-3fad812cc12f„ÄÇ</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>lsblk -f</span></span>
<span class="line"><span>NAME    FSTYPE LABEL UUID                                 MOUNTPOINT</span></span>
<span class="line"><span>sda</span></span>
<span class="line"><span>‚îú‚îÄsda1  ext4         237b634b-a565-477b-8371-6dff0c41f5ab /boot</span></span>
<span class="line"><span>‚îú‚îÄsda2  swap         f414c5c0-f823-4bb1-8fdf-e531173a72ed</span></span>
<span class="line"><span>‚îî‚îÄsda3  ext4         547909c1-398d-4696-94c6-03e43e317b60 /</span></span>
<span class="line"><span>sr0</span></span>
<span class="line"><span>nvme0n1</span></span>
<span class="line"><span>‚îî‚îÄnvme0n1p1 ext4         c51eb23b-195c-4061-92a9-3fad812cc12f</span></span></code></pre>
</div><p>ÁºñËæë /etc/fstab Êñá‰ª∂ÔºåÊ∑ªÂä† nodelalloc ÊåÇËΩΩÂèÇÊï∞„ÄÇ</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>vi /etc/fstab</span></span>
<span class="line"><span>UUID=c51eb23b-195c-4061-92a9-3fad812cc12f /data1 ext4 defaults,nodelalloc,noatime 0 2</span></span></code></pre>
</div><p>ÊåÇËΩΩÊï∞ÊçÆÁõò„ÄÇ</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>mkdir /data1 &#x26;&#x26; \</span></span>
<span class="line"><span>mount -a</span></span></code></pre>
</div><p>ÊâßË°å‰ª•‰∏ãÂëΩ‰ª§ÔºåÂ¶ÇÊûúÊñá‰ª∂Á≥ªÁªü‰∏∫ ext4ÔºåÂπ∂‰∏îÊåÇËΩΩÂèÇÊï∞‰∏≠ÂåÖÂê´ nodelallocÔºåÂàôË°®Á§∫Â∑≤ÁîüÊïà„ÄÇ</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>mount -t ext4</span></span>
<span class="line"><span>/dev/nvme0n1p1 on /data1 type ext4 (rw,noatime,nodelalloc,data=ordered)</span></span></code></pre>
</div><h4 id="Ê≠£ÂºèÂºÄÂßãÈÉ®ÁΩ≤" tabindex="-1">Ê≠£ÂºèÂºÄÂßãÈÉ®ÁΩ≤ <a class="header-anchor" href="#Ê≠£ÂºèÂºÄÂßãÈÉ®ÁΩ≤" aria-label="Permalink to &quot;Ê≠£ÂºèÂºÄÂßãÈÉ®ÁΩ≤&quot;"></a></h4>
<blockquote>
<p><strong>ÁºñËæë inventory.ini Êñá‰ª∂ÂàÜÈÖçÊú∫Âô®ËµÑÊ∫ê</strong></p>
</blockquote>
<p>Ê≥®ÊÑè‰∫ãÈ°πÔºö</p>
<ol>
<li>‰ª• tidb Áî®Êà∑ÁôªÂΩï‰∏≠ÊéßÊú∫ÔºåÁºñËæë /home/tidb/tidb-ansible/inventory.ini Êñá‰ª∂‰∏∫ TiDB ÈõÜÁæ§ÂàÜÈÖçÊú∫Âô®ËµÑÊ∫ê„ÄÇ</li>
<li>‰∏Ä‰∏™Ê†áÂáÜÁöÑ TiDB ÈõÜÁæ§ÈúÄË¶Å 6 Âè∞Êú∫Âô®Ôºö2 ‰∏™ TiDB ÂÆû‰æãÔºå3 ‰∏™ PD ÂÆû‰æãÔºå3 ‰∏™ TiKV ÂÆû‰æã,Ëá≥Â∞ëÈúÄÈÉ®ÁΩ≤ 3 ‰∏™ TiKV ÂÆû‰æã„ÄÇ</li>
<li>‰∏çÊé®ËçêÂ∞Ü TiKV ÂÆû‰æã‰∏é TiDB Êàñ PD ÂÆû‰æãÊ∑∑ÂêàÈÉ®ÁΩ≤Âú®Âêå‰∏ÄÂè∞Êú∫Âô®‰∏ä<span style="color:red">----Êú¨‰æãÊµãËØïÊú∫ÈááÁî®ËøôÁßçÈÉ®ÁΩ≤ÊñπÊ°àÔºÅÔºÅÔºÅ</span></li>
<li>Â∞ÜÁ¨¨‰∏ÄÂè∞ TiDB Êú∫Âô®ÂêåÊó∂Áî®‰ΩúÁõëÊéßÊú∫„ÄÇ</li>
<li>ËØ∑‰ΩøÁî®ÂÜÖÁΩë IP Êù•ÈÉ®ÁΩ≤ÈõÜÁæ§ÔºåÂ¶ÇÊûúÈÉ®ÁΩ≤ÁõÆÊ†áÊú∫Âô® SSH Á´ØÂè£ÈùûÈªòËÆ§ÁöÑ 22 Á´ØÂè£ÔºåÈúÄÊ∑ªÂä† ansible_port ÂèòÈáèÔºåÂ¶Ç TiDB1 ansible_host=172.16.10.1 ansible_port=5555„ÄÇ</li>
<li>Â¶ÇÊûúÊòØ ARM Êû∂ÊûÑÁöÑÊú∫Âô®ÔºåÈúÄË¶ÅÂ∞Ü cpu_architecture Êîπ‰∏∫ arm64„ÄÇ</li>
<li>ÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºåÂª∫ËÆÆÂú®ÊØè‰∏™ TiKV ËäÇÁÇπ‰∏ä‰ªÖÈÉ®ÁΩ≤‰∏Ä‰∏™ TiKV ÂÆû‰æãÔºå‰ª•ÊèêÈ´òÊÄßËÉΩ„ÄÇ‰ΩÜÊòØÔºåÂ¶ÇÊûú‰Ω†ÁöÑ TiKV ÈÉ®ÁΩ≤Êú∫Âô®ÁöÑ CPU ÂíåÂÜÖÂ≠òÈÖçÁΩÆÊòØÈÉ®ÁΩ≤Âª∫ËÆÆÁöÑ‰∏§ÂÄçÊàñ‰ª•‰∏äÔºåÂπ∂‰∏î‰∏Ä‰∏™ËäÇÁÇπÊã•Êúâ‰∏§Âùó SSD Á°¨ÁõòÊàñËÄÖÂçïÂùó SSD Á°¨ÁõòÁöÑÂÆπÈáèÂ§ß‰∫é 2 TBÔºåÂàôÂèØ‰ª•ËÄÉËôëÈÉ®ÁΩ≤‰∏§ÂÆû‰æãÔºå‰ΩÜ‰∏çÂª∫ËÆÆÈÉ®ÁΩ≤‰∏§‰∏™‰ª•‰∏äÂÆû‰æã„ÄÇ</li>
</ol>
<p>ÊâßË°å‰ª•‰∏ãÂëΩ‰ª§ÔºåÂ¶ÇÊûúÊâÄÊúâ server ÂùáËøîÂõû tidbÔºåË°®Á§∫ SSH ‰∫í‰ø°ÈÖçÁΩÆÊàêÂäüÔºö</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>ansible -i inventory.ini all -m shell -a 'whoami'</span></span></code></pre>
</div><p>ÊâßË°å‰ª•‰∏ãÂëΩ‰ª§ÔºåÂ¶ÇÊûúÊâÄÊúâ server ÂùáËøîÂõû rootÔºåË°®Á§∫ tidb Áî®Êà∑ sudo ÂÖçÂØÜÁ†ÅÈÖçÁΩÆÊàêÂäü„ÄÇ</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>ansible -i inventory.ini all -m shell -a 'whoami' -b</span></span></code></pre>
</div><blockquote>
<p><strong>ÈÉ®ÁΩ≤ TiDB ÈõÜÁæ§</strong></p>
</blockquote>
<ol>
<li>ansible-playbook ÊâßË°å Playbook Êó∂ÔºåÈªòËÆ§Âπ∂Âèë‰∏∫ 5;</li>
<li>ÈÉ®ÁΩ≤ÁõÆÊ†áÊú∫Âô®ËæÉÂ§öÊó∂ÔºåÂèØÊ∑ªÂä† -f ÂèÇÊï∞ÊåáÂÆöÂπ∂ÂèëÊï∞Ôºå‰æãÂ¶Ç ansible-playbook deploy.yml -f 10„ÄÇ</li>
<li>ÈªòËÆ§‰ΩøÁî®tidb Áî®Êà∑‰Ωú‰∏∫ÊúçÂä°ËøêË°åÁî®Êà∑,ÈúÄÂú®tidb-ansible/inventory.ini Êñá‰ª∂‰∏≠ÔºåÁ°ÆËÆ§ ansible_user = tidb„ÄÇ</li>
<li>‰∏çË¶ÅÂ∞Ü ansible_user ËÆæÁΩÆ‰∏∫ root Áî®Êà∑ÔºåÂõ†‰∏∫ tidb-ansible ÈôêÂà∂‰∫ÜÊúçÂä°‰ª•ÊôÆÈÄöÁî®Êà∑ËøêË°å„ÄÇ</li>
</ol>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>Connection</span></span>
<span class="line"><span>ssh via normal user</span></span>
<span class="line"><span>ansible_user = tidb</span></span></code></pre>
</div><p>ÊâßË°å local_prepare.yml playbookÔºåËÅîÁΩë‰∏ãËΩΩ TiDB binary Ëá≥‰∏≠ÊéßÊú∫„ÄÇ</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>ansible-playbook local_prepare.yml</span></span></code></pre>
</div><p><span style='color:red'>Â¶ÇÊûúÈááÁî®ÂÆûÈ™åÁéØÂ¢ÉÂæàÈöæÊª°Ë∂≥TiDBÁöÑÁ°¨‰ª∂Ë¶ÅÊ±ÇÔºàËäÇÁÇπCPUÊ†∏ÂøÉÊï∞ÊúÄ‰Ωé8Ê†∏ÔºåÂÜÖÂ≠òÊúÄ‰Ωé16000MBÔºâÔºåÂèØ‰ª•ÈááÁî®Â¶Ç‰∏ãÂÖ≥Èó≠Ëá™Ê£ÄÁöÑÊñπÂºèÊê≠Âª∫ÔºåÁîü‰∫ßÁéØÂ¢É‰∏çË¶Å‰ΩøÁî®ÔºÅ</span></p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>- name: check system</span></span>
<span class="line"><span>  hosts: all</span></span>
<span class="line"><span>  any_errors_fatal: true</span></span>
<span class="line"><span>  roles:</span></span>
<span class="line"><span>    - check_system_static</span></span>
<span class="line"><span>    #- { role: check_system_optional, when: not dev_mode|default(false) }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>- name: tikv_servers machine benchmark</span></span>
<span class="line"><span>  hosts: tikv_servers</span></span>
<span class="line"><span>  gather_facts: false</span></span>
<span class="line"><span>  roles:</span></span>
<span class="line"><span>    #- { role: machine_benchmark, when: not dev_mode|default(false) }</span></span></code></pre>
</div><blockquote>
<p><strong>bootstrap.ymlÂàùÂßãÂåñÁéØÂ¢É</strong></p>
</blockquote>
<p>ÂàùÂßãÂåñÁ≥ªÁªüÁéØÂ¢ÉÔºå‰øÆÊîπÂÜÖÊ†∏ÂèÇÊï∞„ÄÇ</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>ansible-playbook bootstrap.yml</span></span></code></pre>
</div><blockquote>
<p><strong>deploy.ymlÈÉ®ÁΩ≤‰ªªÂä°</strong></p>
</blockquote>
<p>ÈÉ®ÁΩ≤ TiDB ÈõÜÁæ§ËΩØ‰ª∂„ÄÇ</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>ansible-playbook deploy.yml</span></span></code></pre>
</div><blockquote>
<p><strong>start.ymlÂêØÂä®ÈõÜÁæ§</strong></p>
</blockquote>
<p>ÂêØÂä® TiDB ÈõÜÁæ§„ÄÇ</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>ansible-playbook start.yml</span></span></code></pre>
</div><h4 id="ÊµãËØïÈõÜÁæ§ÈÉ®ÁΩ≤" tabindex="-1">ÊµãËØïÈõÜÁæ§ÈÉ®ÁΩ≤ <a class="header-anchor" href="#ÊµãËØïÈõÜÁæ§ÈÉ®ÁΩ≤" aria-label="Permalink to &quot;ÊµãËØïÈõÜÁæ§ÈÉ®ÁΩ≤&quot;"></a></h4>
<p>TiDB ÂÖºÂÆπ MySQLÔºåÂõ†Ê≠§ÂèØ‰ΩøÁî® MySQL ÂÆ¢Êà∑Á´ØÁõ¥Êé•ËøûÊé• TiDB„ÄÇÊé®ËçêÈÖçÁΩÆË¥üËΩΩÂùáË°°‰ª•Êèê‰æõÁªü‰∏ÄÁöÑ SQL Êé•Âè£„ÄÇ</p>
<p>‰ΩøÁî® MySQL ÂÆ¢Êà∑Á´ØËøûÊé• TiDB ÈõÜÁæ§„ÄÇTiDB ÊúçÂä°ÁöÑÈªòËÆ§Á´ØÂè£‰∏∫ 4000„ÄÇ</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>mysql -u root -h 172.16.10.1 -P 4000</span></span></code></pre>
</div><h2 id="Êâ©ÂÆπ-pd-ÁªÑ‰ª∂" tabindex="-1">Êâ©ÂÆπ PD ÁªÑ‰ª∂ <a class="header-anchor" href="#Êâ©ÂÆπ-pd-ÁªÑ‰ª∂" aria-label="Permalink to &quot;Êâ©ÂÆπ PD ÁªÑ‰ª∂&quot;"></a></h2>
<h3 id="ÈÖçÁΩÆinventory-iniÊñ∞ËäÇÁÇπip‰ø°ÊÅØ" tabindex="-1">ÈÖçÁΩÆinventory.iniÊñ∞ËäÇÁÇπIP‰ø°ÊÅØ <a class="header-anchor" href="#ÈÖçÁΩÆinventory-iniÊñ∞ËäÇÁÇπip‰ø°ÊÅØ" aria-label="Permalink to &quot;ÈÖçÁΩÆinventory.iniÊñ∞ËäÇÁÇπIP‰ø°ÊÅØ&quot;"></a></h3>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>......</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[pd_servers]</span></span>
<span class="line"><span>192.168.1.41</span></span>
<span class="line"><span>192.168.1.42</span></span>
<span class="line"><span>192.168.1.43</span></span>
<span class="line"><span>192.168.1.44</span></span>
<span class="line"><span></span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span></span></span>
<span class="line"><span>#¬†node_exporter¬†and¬†blackbox_exporter¬†servers</span></span>
<span class="line"><span>[monitored_servers]</span></span>
<span class="line"><span>192.168.1.41</span></span>
<span class="line"><span>192.168.1.42</span></span>
<span class="line"><span>192.168.1.43</span></span>
<span class="line"><span>192.168.1.44</span></span>
<span class="line"><span></span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>......</span></span></code></pre>
</div><h3 id="‰∏≠ÊéßÊú∫Êìç‰ΩúÈÉ®ÁΩ≤Êú∫Âª∫Áî®Êà∑" tabindex="-1">‰∏≠ÊéßÊú∫Êìç‰ΩúÈÉ®ÁΩ≤Êú∫Âª∫Áî®Êà∑ <a class="header-anchor" href="#‰∏≠ÊéßÊú∫Êìç‰ΩúÈÉ®ÁΩ≤Êú∫Âª∫Áî®Êà∑" aria-label="Permalink to &quot;‰∏≠ÊéßÊú∫Êìç‰ΩúÈÉ®ÁΩ≤Êú∫Âª∫Áî®Êà∑&quot;"></a></h3>
<p>ÊâßË°å‰ª•‰∏ãÂëΩ‰ª§Ôºå‰æùÊçÆËæìÂÖ•<em><strong>ÈÉ®ÁΩ≤ÁõÆÊ†áÊú∫Âô®</strong></em>ÁöÑ root Áî®Êà∑ÂØÜÁ†ÅÔºõ
Êú¨‰æãÊñ∞Â¢ûËäÇÁÇπIP‰∏∫192.168.1.44Ôºõ</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tidb01-41 tidb-ansible]$ vi hosts.ini </span></span>
<span class="line"><span>[tidb@tidb01-41 tidb-ansible]$ cat hosts.ini </span></span>
<span class="line"><span>[servers]</span></span>
<span class="line"><span>192.168.1.44</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>[all:vars]</span></span>
<span class="line"><span>username = tidb</span></span>
<span class="line"><span>ntp_server = cn.pool.ntp.org</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>[tidb@tidb01-41 tidb-ansible]$ ansible-playbook -i hosts.ini create_users.yml -u root -k</span></span>
<span class="line"><span>SSH password: </span></span>
<span class="line"><span></span></span>
<span class="line"><span>PLAY [all] ***************************************************************************************************************</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Congrats! All goes well. :-)</span></span></code></pre>
</div><h3 id="‰∏≠ÊéßÊú∫Êìç‰ΩúÈÉ®ÁΩ≤Êú∫ÈÖçÁΩÆntpÊúçÂä°" tabindex="-1">‰∏≠ÊéßÊú∫Êìç‰ΩúÈÉ®ÁΩ≤Êú∫ÈÖçÁΩÆntpÊúçÂä° <a class="header-anchor" href="#‰∏≠ÊéßÊú∫Êìç‰ΩúÈÉ®ÁΩ≤Êú∫ÈÖçÁΩÆntpÊúçÂä°" aria-label="Permalink to &quot;‰∏≠ÊéßÊú∫Êìç‰ΩúÈÉ®ÁΩ≤Êú∫ÈÖçÁΩÆntpÊúçÂä°&quot;"></a></h3>
<p><em><strong>Ê≥®ÊÑèÔºöÁîü‰∫ß‰∏äÂ∫îËØ•ÊåáÂêëËá™Â∑±ÁöÑntpÊúçÂä°Âô®ÔºåÊú¨Ê¨°ÊµãËØïÈááÁî®‰∫ÜÂÖ¨ÁΩëÂÖ¨Áî®ÁöÑntpÊúçÂä°‰∏çÁ®≥ÂÆö„ÄÇ</strong></em></p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tidb01-41 tidb-ansible]$ ansible-playbook -i hosts.ini deploy_ntp.yml -u tidb -b</span></span>
<span class="line"><span></span></span>
<span class="line"><span>PLAY [all] ***************************************************************************************************************</span></span>
<span class="line"><span></span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Congrats! All goes well. :-)</span></span></code></pre>
</div><h3 id="‰∏≠ÊéßÂèäÊìç‰ΩúÈÉ®ÁΩ≤Êú∫ËÆæÁΩÆcpuÊ®°Âºè" tabindex="-1">‰∏≠ÊéßÂèäÊìç‰ΩúÈÉ®ÁΩ≤Êú∫ËÆæÁΩÆCPUÊ®°Âºè <a class="header-anchor" href="#‰∏≠ÊéßÂèäÊìç‰ΩúÈÉ®ÁΩ≤Êú∫ËÆæÁΩÆcpuÊ®°Âºè" aria-label="Permalink to &quot;‰∏≠ÊéßÂèäÊìç‰ΩúÈÉ®ÁΩ≤Êú∫ËÆæÁΩÆCPUÊ®°Âºè&quot;"></a></h3>
<p>Ë∞ÉÊï¥CPUÊ®°ÂºèÔºåÂ¶ÇÊûúÂêåÊú¨ÊñáÂá∫Áé∞‰∏ÄÊ†∑ÁöÑÊä•ÈîôÔºåËØ¥ÊòéÊ≠§ÁâàÊú¨ÁöÑÊìç‰ΩúÁ≥ªÁªü‰∏çÊîØÊåÅCPUÊ®°Âºè‰øÆÊîπÔºåÂèØÁõ¥Êé•Ë∑≥Ëøá„ÄÇ</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tidb01-41 tidb-ansible]$ ansible -i hosts.ini all -m shell -a "cpupower frequency-set --governor performance" -u tidb -b</span></span>
<span class="line"><span>192.168.1.44 | FAILED | rc=237 >></span></span>
<span class="line"><span>Setting cpu: 0</span></span>
<span class="line"><span>Error setting new values. Common errors:</span></span>
<span class="line"><span>- Do you have proper administration rights? (super-user?)</span></span>
<span class="line"><span>- Is the governor you requested available and modprobed?</span></span>
<span class="line"><span>- Trying to set an invalid policy?</span></span>
<span class="line"><span>- Trying to set a specific frequency, but userspace governor is not available,</span></span>
<span class="line"><span>   for example because of hardware which cannot be set to a specific frequency</span></span>
<span class="line"><span>   or because the userspace governor isn't loaded?non-zero return code</span></span></code></pre>
</div><p>###¬†ÊâßË°åbootstrap.ymlÁîüÊàêÊ®°ÊùøÊñá‰ª∂</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tidb01-41¬†tidb-ansible]$¬†</span></span>
<span class="line"><span>[tidb@tidb01-41¬†tidb-ansible]$¬†vi¬†inventory.ini¬†</span></span>
<span class="line"><span>[tidb@tidb01-41¬†tidb-ansible]$¬†ansible-playbook¬†bootstrap.yml¬†-l¬†192.168.1.44</span></span>
<span class="line"><span></span></span>
<span class="line"><span>PLAY¬†[initializing¬†deployment¬†target]¬†************************************************************************************</span></span>
<span class="line"><span>skipping:¬†no¬†hosts¬†matched</span></span>
<span class="line"><span></span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Congrats!¬†All¬†goes¬†well.¬†:-)</span></span></code></pre>
</div><p>###¬†ÊâßË°ådeploy.ymlÊ≠£ÂºèÈÉ®ÁΩ≤Êñ∞ËäÇÁÇπ</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tidb01-41¬†tidb-ansible]$¬†vi¬†inventory.ini¬†</span></span>
<span class="line"><span>[tidb@tidb01-41¬†tidb-ansible]$¬†ansible-playbook¬†bootstrap.yml¬†-l¬†192.168.1.44</span></span>
<span class="line"><span></span></span>
<span class="line"><span>PLAY¬†[initializing¬†deployment¬†target]¬†************************************************************************************</span></span>
<span class="line"><span>skipping:¬†no¬†hosts¬†matched</span></span>
<span class="line"><span></span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Congrats!¬†All¬†goes¬†well.¬†:-)</span></span></code></pre>
</div><h3 id="ÊªöÂä®Êõ¥Êñ∞ÊôÆÁΩóÁ±≥‰øÆÊñØ" tabindex="-1">ÊªöÂä®Êõ¥Êñ∞ÊôÆÁΩóÁ±≥‰øÆÊñØ <a class="header-anchor" href="#ÊªöÂä®Êõ¥Êñ∞ÊôÆÁΩóÁ±≥‰øÆÊñØ" aria-label="Permalink to &quot;ÊªöÂä®Êõ¥Êñ∞ÊôÆÁΩóÁ±≥‰øÆÊñØ&quot;"></a></h3>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tidb01-41 tidb-ansible]$ vi inventory.ini </span></span>
<span class="line"><span>[tidb@tidb01-41 tidb-ansible]$ ansible-playbook rolling_update_monitor.yml --tags=prometheus</span></span>
<span class="line"><span></span></span>
<span class="line"><span>PLAY [check config locally] ****************************************************************************************************</span></span>
<span class="line"><span></span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span></span></span>
<span class="line"><span>PLAY RECAP *********************************************************************************************************************</span></span>
<span class="line"><span>192.168.1.41               : ok=3    changed=0    unreachable=0    failed=0   </span></span>
<span class="line"><span>192.168.1.42               : ok=25   changed=8    unreachable=0    failed=0   </span></span>
<span class="line"><span>192.168.1.43               : ok=3    changed=0    unreachable=0    failed=0   </span></span>
<span class="line"><span>localhost                  : ok=7    changed=4    unreachable=0    failed=0   </span></span>
<span class="line"><span></span></span>
<span class="line"><span>Congrats! All goes well. :-)</span></span></code></pre>
</div><h3 id="Âü∫‰∫égrafanaÂèØËßÜÂåñÁïåÈù¢È™åËØÅ" tabindex="-1">Âü∫‰∫éGrafanaÂèØËßÜÂåñÁïåÈù¢È™åËØÅ <a class="header-anchor" href="#Âü∫‰∫égrafanaÂèØËßÜÂåñÁïåÈù¢È™åËØÅ" aria-label="Permalink to &quot;Âü∫‰∫éGrafanaÂèØËßÜÂåñÁïåÈù¢È™åËØÅ&quot;"></a></h3>
<figure><img src="http://cdn.lifemini.cn/dbblog/20201227/b5ceba7b9807484b9f385d382d5ab325.png" alt="39368d20da884d3e70484891aa58aae.png" tabindex="0"><figcaption>39368d20da884d3e70484891aa58aae.png</figcaption></figure>
<h2 id="Áº©ÂÆπ-pd-ÁªÑ‰ª∂" tabindex="-1">Áº©ÂÆπ PD ÁªÑ‰ª∂ <a class="header-anchor" href="#Áº©ÂÆπ-pd-ÁªÑ‰ª∂" aria-label="Permalink to &quot;Áº©ÂÆπ PD ÁªÑ‰ª∂&quot;"></a></h2>
<h3 id="pd-ctlÂëΩ‰ª§Ë°åÂà†Èô§pdËäÇÁÇπ" tabindex="-1">pd-ctlÂëΩ‰ª§Ë°åÂà†Èô§PDËäÇÁÇπ <a class="header-anchor" href="#pd-ctlÂëΩ‰ª§Ë°åÂà†Èô§pdËäÇÁÇπ" aria-label="Permalink to &quot;pd-ctlÂëΩ‰ª§Ë°åÂà†Èô§PDËäÇÁÇπ&quot;"></a></h3>
<p>È¶ñÂÖàÔºåÁôªÂΩïpd-ctlÂëΩ‰ª§Ë°å‰ΩøÁî®memberÂëΩ‰ª§Êü•ÁúãÂà†Èô§ËäÇÁÇπÂØπÂ∫î&quot;name&quot;: &quot;pd_tidb04-44&quot;Ôºõ
ÂÖ∂Ê¨°ÔºåÊâßË°åmember delete name pd_tidb04-44Êìç‰ΩúÂà†Èô§ËØ•PDËäÇÁÇπÔºõ
ÊúÄÂêéÔºå‰ΩøÁî®memberÂëΩ‰ª§Êü•ÁúãÂ∑≤Êó†ËØ•nameÁöÑÈõÜÁæ§ËäÇÁÇπÂá∫Áé∞„ÄÇ</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tidb01-41 tidb-ansible]$ resources/bin/pd-ctl -u http://192.168.1.41:2379 -i</span></span>
<span class="line"><span>¬ª member</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>  "header": {</span></span>
<span class="line"><span>    "cluster_id": 6909452787323084897</span></span>
<span class="line"><span>  },</span></span>
<span class="line"><span>  "members": [</span></span>
<span class="line"><span>    {</span></span>
<span class="line"><span>      "name": "pd_tidb02-42",</span></span>
<span class="line"><span>      "member_id": 986258930764209162,</span></span>
<span class="line"><span>      "peer_urls": [</span></span>
<span class="line"><span>        "http://192.168.1.42:2380"</span></span>
<span class="line"><span>      ],</span></span>
<span class="line"><span>      "client_urls": [</span></span>
<span class="line"><span>        "http://192.168.1.42:2379"</span></span>
<span class="line"><span>      ]</span></span>
<span class="line"><span>    },</span></span>
<span class="line"><span>    {</span></span>
<span class="line"><span>      "name": "pd_tidb01-41",</span></span>
<span class="line"><span>      "member_id": 3654086277121920294,</span></span>
<span class="line"><span>      "peer_urls": [</span></span>
<span class="line"><span>        "http://192.168.1.41:2380"</span></span>
<span class="line"><span>      ],</span></span>
<span class="line"><span>      "client_urls": [</span></span>
<span class="line"><span>        "http://192.168.1.41:2379"</span></span>
<span class="line"><span>      ]</span></span>
<span class="line"><span>    },</span></span>
<span class="line"><span>    {</span></span>
<span class="line"><span>      "name": "pd_tidb04-44",</span></span>
<span class="line"><span>      "member_id": 6266742378045652471,</span></span>
<span class="line"><span>      "peer_urls": [</span></span>
<span class="line"><span>        "http://192.168.1.44:2380"</span></span>
<span class="line"><span>      ],</span></span>
<span class="line"><span>      "client_urls": [</span></span>
<span class="line"><span>        "http://192.168.1.44:2379"</span></span>
<span class="line"><span>      ]</span></span>
<span class="line"><span>    },</span></span>
<span class="line"><span>    {</span></span>
<span class="line"><span>      "name": "pd_tidb03-43",</span></span>
<span class="line"><span>      "member_id": 6461985847067688046,</span></span>
<span class="line"><span>      "peer_urls": [</span></span>
<span class="line"><span>        "http://192.168.1.43:2380"</span></span>
<span class="line"><span>      ],</span></span>
<span class="line"><span>      "client_urls": [</span></span>
<span class="line"><span>        "http://192.168.1.43:2379"</span></span>
<span class="line"><span>      ]</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>  ],</span></span>
<span class="line"><span>  "leader": {</span></span>
<span class="line"><span>    "name": "pd_tidb01-41",</span></span>
<span class="line"><span>    "member_id": 3654086277121920294,</span></span>
<span class="line"><span>    "peer_urls": [</span></span>
<span class="line"><span>      "http://192.168.1.41:2380"</span></span>
<span class="line"><span>    ],</span></span>
<span class="line"><span>    "client_urls": [</span></span>
<span class="line"><span>      "http://192.168.1.41:2379"</span></span>
<span class="line"><span>    ]</span></span>
<span class="line"><span>  },</span></span>
<span class="line"><span>  "etcd_leader": {</span></span>
<span class="line"><span>    "name": "pd_tidb01-41",</span></span>
<span class="line"><span>    "member_id": 3654086277121920294,</span></span>
<span class="line"><span>    "peer_urls": [</span></span>
<span class="line"><span>      "http://192.168.1.41:2380"</span></span>
<span class="line"><span>    ],</span></span>
<span class="line"><span>    "client_urls": [</span></span>
<span class="line"><span>      "http://192.168.1.41:2379"</span></span>
<span class="line"><span>    ]</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>¬ª member delete name pd_tidb04-44</span></span>
<span class="line"><span>Success!</span></span>
<span class="line"><span>¬ª member</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>  "header": {</span></span>
<span class="line"><span>    "cluster_id": 6909452787323084897</span></span>
<span class="line"><span>  },</span></span>
<span class="line"><span>  "members": [</span></span>
<span class="line"><span>    {</span></span>
<span class="line"><span>      "name": "pd_tidb02-42",</span></span>
<span class="line"><span>      "member_id": 986258930764209162,</span></span>
<span class="line"><span>      "peer_urls": [</span></span>
<span class="line"><span>        "http://192.168.1.42:2380"</span></span>
<span class="line"><span>      ],</span></span>
<span class="line"><span>      "client_urls": [</span></span>
<span class="line"><span>        "http://192.168.1.42:2379"</span></span>
<span class="line"><span>      ]</span></span>
<span class="line"><span>    },</span></span>
<span class="line"><span>    {</span></span>
<span class="line"><span>      "name": "pd_tidb01-41",</span></span>
<span class="line"><span>      "member_id": 3654086277121920294,</span></span>
<span class="line"><span>      "peer_urls": [</span></span>
<span class="line"><span>        "http://192.168.1.41:2380"</span></span>
<span class="line"><span>      ],</span></span>
<span class="line"><span>      "client_urls": [</span></span>
<span class="line"><span>        "http://192.168.1.41:2379"</span></span>
<span class="line"><span>      ]</span></span>
<span class="line"><span>    },</span></span>
<span class="line"><span>    {</span></span>
<span class="line"><span>      "name": "pd_tidb03-43",</span></span>
<span class="line"><span>      "member_id": 6461985847067688046,</span></span>
<span class="line"><span>      "peer_urls": [</span></span>
<span class="line"><span>        "http://192.168.1.43:2380"</span></span>
<span class="line"><span>      ],</span></span>
<span class="line"><span>      "client_urls": [</span></span>
<span class="line"><span>        "http://192.168.1.43:2379"</span></span>
<span class="line"><span>      ]</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>  ],</span></span>
<span class="line"><span>  "leader": {</span></span>
<span class="line"><span>    "name": "pd_tidb01-41",</span></span>
<span class="line"><span>    "member_id": 3654086277121920294,</span></span>
<span class="line"><span>    "peer_urls": [</span></span>
<span class="line"><span>      "http://192.168.1.41:2380"</span></span>
<span class="line"><span>    ],</span></span>
<span class="line"><span>    "client_urls": [</span></span>
<span class="line"><span>      "http://192.168.1.41:2379"</span></span>
<span class="line"><span>    ]</span></span>
<span class="line"><span>  },</span></span>
<span class="line"><span>  "etcd_leader": {</span></span>
<span class="line"><span>    "name": "pd_tidb01-41",</span></span>
<span class="line"><span>    "member_id": 3654086277121920294,</span></span>
<span class="line"><span>    "peer_urls": [</span></span>
<span class="line"><span>      "http://192.168.1.41:2380"</span></span>
<span class="line"><span>    ],</span></span>
<span class="line"><span>    "client_urls": [</span></span>
<span class="line"><span>      "http://192.168.1.41:2379"</span></span>
<span class="line"><span>    ]</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>¬ª exit</span></span></code></pre>
</div><h3 id="ÊâßË°åstop-ymlÂÅúÊ≠¢pdËäÇÁÇπÊúçÂä°" tabindex="-1">ÊâßË°åstop.ymlÂÅúÊ≠¢PDËäÇÁÇπÊúçÂä° <a class="header-anchor" href="#ÊâßË°åstop-ymlÂÅúÊ≠¢pdËäÇÁÇπÊúçÂä°" aria-label="Permalink to &quot;ÊâßË°åstop.ymlÂÅúÊ≠¢PDËäÇÁÇπÊúçÂä°&quot;"></a></h3>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tidb01-41 tidb-ansible]$ ansible-playbook stop.yml -l 192.168.1.44</span></span>
<span class="line"><span></span></span>
<span class="line"><span>PLAY [check config locally] **********************************************************************************************</span></span>
<span class="line"><span>skipping: no hosts matched</span></span>
<span class="line"><span></span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Congrats! All goes well. :-)</span></span></code></pre>
</div><h3 id="‰ªéinventory-ini‰∏≠ÁßªÈô§ip‰ø°ÊÅØ" tabindex="-1">‰ªéinventory.ini‰∏≠ÁßªÈô§IP‰ø°ÊÅØ <a class="header-anchor" href="#‰ªéinventory-ini‰∏≠ÁßªÈô§ip‰ø°ÊÅØ" aria-label="Permalink to &quot;‰ªéinventory.ini‰∏≠ÁßªÈô§IP‰ø°ÊÅØ&quot;"></a></h3>
<p>Â¶Ç‰∏ãÂõæÊâÄÁ§∫Ôºõ</p>
<figure><img src="http://cdn.lifemini.cn/dbblog/20201227/9151829e15b242239ba3430e67ad6786.png" alt="4c57d18d35394ad9e15616e20402fd7.png" tabindex="0"><figcaption>4c57d18d35394ad9e15616e20402fd7.png</figcaption></figure>
<figure><img src="http://cdn.lifemini.cn/dbblog/20201227/b4645ae5c9d742f8b01615762e9bf3af.png" alt="3a63ec1627d25c3e07e5fad3aa42a69.png" tabindex="0"><figcaption>3a63ec1627d25c3e07e5fad3aa42a69.png</figcaption></figure>
<h3 id="rolling-update-ymlÊªöÂä®Êõ¥Êñ∞ÈõÜÁæ§" tabindex="-1">rolling-update.ymlÊªöÂä®Êõ¥Êñ∞ÈõÜÁæ§ <a class="header-anchor" href="#rolling-update-ymlÊªöÂä®Êõ¥Êñ∞ÈõÜÁæ§" aria-label="Permalink to &quot;rolling-update.ymlÊªöÂä®Êõ¥Êñ∞ÈõÜÁæ§&quot;"></a></h3>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tidb01-41 tidb-ansible]$ ansible-playbook rolling_update.yml</span></span>
<span class="line"><span></span></span>
<span class="line"><span>PLAY [check config locally] ****************************************************************************************************</span></span>
<span class="line"><span></span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span></span></span>
<span class="line"><span>PLAY RECAP *********************************************************************************************************************</span></span>
<span class="line"><span>192.168.1.41               : ok=117  changed=15   unreachable=0    failed=0   </span></span>
<span class="line"><span>192.168.1.42               : ok=92   changed=10   unreachable=0    failed=0   </span></span>
<span class="line"><span>192.168.1.43               : ok=116  changed=15   unreachable=0    failed=0   </span></span>
<span class="line"><span>localhost                  : ok=7    changed=4    unreachable=0    failed=0   </span></span>
<span class="line"><span></span></span>
<span class="line"><span>Congrats! All goes well. :-)</span></span></code></pre>
</div><h3 id="ÊªöÂä®Êõ¥Êñ∞ÊôÆÁΩóÁ±≥‰øÆÊñØ-1" tabindex="-1">ÊªöÂä®Êõ¥Êñ∞ÊôÆÁΩóÁ±≥‰øÆÊñØ <a class="header-anchor" href="#ÊªöÂä®Êõ¥Êñ∞ÊôÆÁΩóÁ±≥‰øÆÊñØ-1" aria-label="Permalink to &quot;ÊªöÂä®Êõ¥Êñ∞ÊôÆÁΩóÁ±≥‰øÆÊñØ&quot;"></a></h3>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tidb01-41 tidb-ansible]$ vi inventory.ini </span></span>
<span class="line"><span>[tidb@tidb01-41 tidb-ansible]$ ansible-playbook rolling_update_monitor.yml --tags=prometheus</span></span>
<span class="line"><span></span></span>
<span class="line"><span>PLAY [check config locally] ****************************************************************************************************</span></span>
<span class="line"><span></span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span></span></span>
<span class="line"><span>PLAY RECAP *********************************************************************************************************************</span></span>
<span class="line"><span>192.168.1.41               : ok=3    changed=0    unreachable=0    failed=0   </span></span>
<span class="line"><span>192.168.1.42               : ok=25   changed=8    unreachable=0    failed=0   </span></span>
<span class="line"><span>192.168.1.43               : ok=3    changed=0    unreachable=0    failed=0   </span></span>
<span class="line"><span>localhost                  : ok=7    changed=4    unreachable=0    failed=0   </span></span>
<span class="line"><span></span></span>
<span class="line"><span>Congrats! All goes well. :-)</span></span></code></pre>
</div><h3 id="Âü∫‰∫égrafanaÁöÑÂõæÂΩ¢ÂåñÁïåÈù¢Ê£ÄÊü•" tabindex="-1">Âü∫‰∫éGrafanaÁöÑÂõæÂΩ¢ÂåñÁïåÈù¢Ê£ÄÊü• <a class="header-anchor" href="#Âü∫‰∫égrafanaÁöÑÂõæÂΩ¢ÂåñÁïåÈù¢Ê£ÄÊü•" aria-label="Permalink to &quot;Âü∫‰∫éGrafanaÁöÑÂõæÂΩ¢ÂåñÁïåÈù¢Ê£ÄÊü•&quot;"></a></h3>
<figure><img src="http://cdn.lifemini.cn/dbblog/20201227/6ce5961607d0493ba7915f156eb8e971.png" alt="63d36d0af6a99f38eaafd73e664ff73.png" tabindex="0"><figcaption>63d36d0af6a99f38eaafd73e664ff73.png</figcaption></figure>
<h2 id="Êâ©ÂÆπ-tidb-ÁªÑ‰ª∂" tabindex="-1">Êâ©ÂÆπ TiDB ÁªÑ‰ª∂ <a class="header-anchor" href="#Êâ©ÂÆπ-tidb-ÁªÑ‰ª∂" aria-label="Permalink to &quot;Êâ©ÂÆπ TiDB ÁªÑ‰ª∂&quot;"></a></h2>
<h3 id="ÈÖçÁΩÆ‰∫í‰ø°ÂíåsudoËßÑÂàô" tabindex="-1">ÈÖçÁΩÆ‰∫í‰ø°ÂíåsudoËßÑÂàô <a class="header-anchor" href="#ÈÖçÁΩÆ‰∫í‰ø°ÂíåsudoËßÑÂàô" aria-label="Permalink to &quot;ÈÖçÁΩÆ‰∫í‰ø°ÂíåsudoËßÑÂàô&quot;"></a></h3>
<p>ÂØπ‰∫éTiDBÈõÜÁæ§ËäÇÁÇπÁöÑÊâ©ÂÆπÊìç‰ΩúÔºåÈ¶ñÂÖà‰øÆÊîπhosts.iniÊñá‰ª∂Ôºõ</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tidb01-41 tidb-ansible]$ vi hosts.ini </span></span>
<span class="line"><span>[tidb@tidb01-41 tidb-ansible]$ cat hosts.ini </span></span>
<span class="line"><span>[servers]</span></span>
<span class="line"><span>192.168.1.44</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[all:vars]</span></span>
<span class="line"><span>username = tidb</span></span>
<span class="line"><span>ntp_server = cn.pool.ntp.org</span></span></code></pre>
</div><figure><img src="http://cdn.lifemini.cn/dbblog/20201227/fcec4328a4294836b6d60223c1d6ce37.png" alt="029282675fd15d6d77eb0e48d227694.png" tabindex="0"><figcaption>029282675fd15d6d77eb0e48d227694.png</figcaption></figure>
<h3 id="‰∏≠ÊéßÊú∫Êìç‰ΩúÈÉ®ÁΩ≤Êú∫Âª∫Áî®Êà∑-1" tabindex="-1">‰∏≠ÊéßÊú∫Êìç‰ΩúÈÉ®ÁΩ≤Êú∫Âª∫Áî®Êà∑ <a class="header-anchor" href="#‰∏≠ÊéßÊú∫Êìç‰ΩúÈÉ®ÁΩ≤Êú∫Âª∫Áî®Êà∑-1" aria-label="Permalink to &quot;‰∏≠ÊéßÊú∫Êìç‰ΩúÈÉ®ÁΩ≤Êú∫Âª∫Áî®Êà∑&quot;"></a></h3>
<p>ÊâßË°å‰ª•‰∏ãÂëΩ‰ª§Ôºå‰æùÊçÆËæìÂÖ•<em><strong>ÈÉ®ÁΩ≤ÁõÆÊ†áÊú∫Âô®</strong></em>ÁöÑ root Áî®Êà∑ÂØÜÁ†ÅÔºõ
Êú¨‰æãÊñ∞Â¢ûËäÇÁÇπIP‰∏∫192.168.1.44Ôºõ</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tidb01-41 tidb-ansible]$ vi hosts.ini </span></span>
<span class="line"><span>[tidb@tidb01-41 tidb-ansible]$ cat hosts.ini </span></span>
<span class="line"><span>[servers]</span></span>
<span class="line"><span>192.168.1.44</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>[all:vars]</span></span>
<span class="line"><span>username = tidb</span></span>
<span class="line"><span>ntp_server = cn.pool.ntp.org</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>[tidb@tidb01-41 tidb-ansible]$ ansible-playbook -i hosts.ini create_users.yml -u root -k</span></span>
<span class="line"><span>SSH password: </span></span>
<span class="line"><span></span></span>
<span class="line"><span>PLAY [all] ***************************************************************************************************************</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Congrats! All goes well. :-)</span></span></code></pre>
</div><h3 id="‰∏≠ÊéßÊú∫Êìç‰ΩúÈÉ®ÁΩ≤Êú∫ÈÖçÁΩÆntpÊúçÂä°-1" tabindex="-1">‰∏≠ÊéßÊú∫Êìç‰ΩúÈÉ®ÁΩ≤Êú∫ÈÖçÁΩÆntpÊúçÂä° <a class="header-anchor" href="#‰∏≠ÊéßÊú∫Êìç‰ΩúÈÉ®ÁΩ≤Êú∫ÈÖçÁΩÆntpÊúçÂä°-1" aria-label="Permalink to &quot;‰∏≠ÊéßÊú∫Êìç‰ΩúÈÉ®ÁΩ≤Êú∫ÈÖçÁΩÆntpÊúçÂä°&quot;"></a></h3>
<p><em><strong>Ê≥®ÊÑèÔºöÁîü‰∫ß‰∏äÂ∫îËØ•ÊåáÂêëËá™Â∑±ÁöÑntpÊúçÂä°Âô®ÔºåÊú¨Ê¨°ÊµãËØïÈááÁî®‰∫ÜÂÖ¨ÁΩëÂÖ¨Áî®ÁöÑntpÊúçÂä°‰∏çÁ®≥ÂÆö„ÄÇ</strong></em></p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tidb01-41 tidb-ansible]$ ansible-playbook -i hosts.ini deploy_ntp.yml -u tidb -b</span></span>
<span class="line"><span></span></span>
<span class="line"><span>PLAY [all] ***************************************************************************************************************</span></span>
<span class="line"><span></span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Congrats! All goes well. :-)</span></span></code></pre>
</div><h3 id="‰∏≠ÊéßÂèäÊìç‰ΩúÈÉ®ÁΩ≤Êú∫ËÆæÁΩÆcpuÊ®°Âºè-1" tabindex="-1">‰∏≠ÊéßÂèäÊìç‰ΩúÈÉ®ÁΩ≤Êú∫ËÆæÁΩÆCPUÊ®°Âºè <a class="header-anchor" href="#‰∏≠ÊéßÂèäÊìç‰ΩúÈÉ®ÁΩ≤Êú∫ËÆæÁΩÆcpuÊ®°Âºè-1" aria-label="Permalink to &quot;‰∏≠ÊéßÂèäÊìç‰ΩúÈÉ®ÁΩ≤Êú∫ËÆæÁΩÆCPUÊ®°Âºè&quot;"></a></h3>
<p>Ë∞ÉÊï¥CPUÊ®°ÂºèÔºåÂ¶ÇÊûúÂêåÊú¨ÊñáÂá∫Áé∞‰∏ÄÊ†∑ÁöÑÊä•ÈîôÔºåËØ¥ÊòéÊ≠§ÁâàÊú¨ÁöÑÊìç‰ΩúÁ≥ªÁªü‰∏çÊîØÊåÅCPUÊ®°Âºè‰øÆÊîπÔºåÂèØÁõ¥Êé•Ë∑≥Ëøá„ÄÇ</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tidb01-41 tidb-ansible]$ ansible -i hosts.ini all -m shell -a "cpupower frequency-set --governor performance" -u tidb -b</span></span>
<span class="line"><span>192.168.1.44 | FAILED | rc=237 >></span></span>
<span class="line"><span>Setting cpu: 0</span></span>
<span class="line"><span>Error setting new values. Common errors:</span></span>
<span class="line"><span>- Do you have proper administration rights? (super-user?)</span></span>
<span class="line"><span>- Is the governor you requested available and modprobed?</span></span>
<span class="line"><span>- Trying to set an invalid policy?</span></span>
<span class="line"><span>- Trying to set a specific frequency, but userspace governor is not available,</span></span>
<span class="line"><span>   for example because of hardware which cannot be set to a specific frequency</span></span>
<span class="line"><span>   or because the userspace governor isn't loaded?non-zero return code</span></span></code></pre>
</div><h3 id="ÊâßË°åbootstrap-ymlÁîüÊàêÊ®°Êùø" tabindex="-1">ÊâßË°åbootstrap.ymlÁîüÊàêÊ®°Êùø <a class="header-anchor" href="#ÊâßË°åbootstrap-ymlÁîüÊàêÊ®°Êùø" aria-label="Permalink to &quot;ÊâßË°åbootstrap.ymlÁîüÊàêÊ®°Êùø&quot;"></a></h3>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span></span></span>
<span class="line"><span>[tidb@tidb01-41 tidb-ansible]$ ansible-playbook bootstrap.yml -l 192.168.1.44</span></span>
<span class="line"><span></span></span>
<span class="line"><span>PLAY [initializing deployment target] ************************************************************************************</span></span>
<span class="line"><span></span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Congrats! All goes well. :-)</span></span></code></pre>
</div><h3 id="ÊâßË°ådeploy-ymlÂºÄÂßãÈÉ®ÁΩ≤" tabindex="-1">ÊâßË°ådeploy.ymlÂºÄÂßãÈÉ®ÁΩ≤ <a class="header-anchor" href="#ÊâßË°ådeploy-ymlÂºÄÂßãÈÉ®ÁΩ≤" aria-label="Permalink to &quot;ÊâßË°ådeploy.ymlÂºÄÂßãÈÉ®ÁΩ≤&quot;"></a></h3>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tidb01-41 tidb-ansible]$ ansible-playbook bootstrap.yml -l 192.168.1.44</span></span>
<span class="line"><span></span></span>
<span class="line"><span>PLAY [initializing deployment target] ************************************************************************************</span></span>
<span class="line"><span>skipping: no hosts matched</span></span>
<span class="line"><span></span></span>
<span class="line"><span>.....</span></span>
<span class="line"><span>.....</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Congrats! All goes well. :-)</span></span></code></pre>
</div><h3 id="ËäÇÁÇπËΩØ‰ª∂ÈÉ®ÁΩ≤ÁõÆÂΩïÈ™åËØÅ" tabindex="-1">ËäÇÁÇπËΩØ‰ª∂ÈÉ®ÁΩ≤ÁõÆÂΩïÈ™åËØÅ <a class="header-anchor" href="#ËäÇÁÇπËΩØ‰ª∂ÈÉ®ÁΩ≤ÁõÆÂΩïÈ™åËØÅ" aria-label="Permalink to &quot;ËäÇÁÇπËΩØ‰ª∂ÈÉ®ÁΩ≤ÁõÆÂΩïÈ™åËØÅ&quot;"></a></h3>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[root@tidb04-44 ~]# cd /data/tidb/deploy/</span></span>
<span class="line"><span>[root@tidb04-44 deploy]# ll</span></span>
<span class="line"><span>total 0</span></span>
<span class="line"><span>drwxr-xr-x.  2 tidb tidb   6 Dec 27 01:18 backup</span></span>
<span class="line"><span>drwxr-xr-x.  2 tidb tidb  25 Dec 27 01:18 bin</span></span>
<span class="line"><span>drwxr-xr-x.  2 tidb tidb  23 Dec 27 01:18 conf</span></span>
<span class="line"><span>drwxr-xr-x.  2 tidb tidb   6 Dec 27 01:18 log</span></span>
<span class="line"><span>drwxr-xr-x.  2 tidb tidb  66 Dec 27 01:18 scripts</span></span>
<span class="line"><span>drwxrwxr-x. 13 tidb tidb 211 Sep 16  2018 spark</span></span></code></pre>
</div><h3 id="ÊâßË°åstart-ymlÂºÄÂêØtidbÊúçÂä°" tabindex="-1">ÊâßË°åstart.ymlÂºÄÂêØtidbÊúçÂä° <a class="header-anchor" href="#ÊâßË°åstart-ymlÂºÄÂêØtidbÊúçÂä°" aria-label="Permalink to &quot;ÊâßË°åstart.ymlÂºÄÂêØtidbÊúçÂä°&quot;"></a></h3>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tidb01-41 tidb-ansible]$ ansible-playbook start.yml -l 192.168.1.44</span></span>
<span class="line"><span></span></span>
<span class="line"><span>PLAY [check config locally] **********************************************************************************************</span></span>
<span class="line"><span>skipping: no hosts matched</span></span>
<span class="line"><span></span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Congrats! All goes well. :-)</span></span></code></pre>
</div><h3 id="tidbËäÇÁÇπÁôªÈôÜÈ™åËØÅ" tabindex="-1">TiDBËäÇÁÇπÁôªÈôÜÈ™åËØÅ <a class="header-anchor" href="#tidbËäÇÁÇπÁôªÈôÜÈ™åËØÅ" aria-label="Permalink to &quot;TiDBËäÇÁÇπÁôªÈôÜÈ™åËØÅ&quot;"></a></h3>
<p>ÁôªÈôÜÈ™åËØÅÊàêÂäü</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tidb01-41 tidb-ansible]$ mysql -u root -h 192.168.1.44 -P 4000</span></span>
<span class="line"><span>Welcome to the MariaDB monitor.  Commands end with ; or \g.</span></span>
<span class="line"><span>Your MySQL connection id is 2</span></span>
<span class="line"><span>Server version: 5.7.25-TiDB-v3.0.1 MySQL Community Server (Apache License 2.0)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>MySQL [(none)]></span></span></code></pre>
</div><h3 id="Êõ¥Êñ∞ÊôÆÁΩóÁ±≥‰øÆÊñØ" tabindex="-1">Êõ¥Êñ∞ÊôÆÁΩóÁ±≥‰øÆÊñØ <a class="header-anchor" href="#Êõ¥Êñ∞ÊôÆÁΩóÁ±≥‰øÆÊñØ" aria-label="Permalink to &quot;Êõ¥Êñ∞ÊôÆÁΩóÁ±≥‰øÆÊñØ&quot;"></a></h3>
<p>ÊôÆÁΩóÁ±≥‰øÆÊñØÊòØ‰ª•‰∏ªÂä®pullÁöÑÊñπÂºèÔºå‰ªéÁõ∏Â∫îËäÇÁÇπÊãâÂéªÊâÄÈúÄË¶ÅÁöÑ‰ø°ÊÅØÔºõ
Âõ†Ê≠§ÔºåÂ¶ÇÊûú‰∏çÊâãÂä®Êõ¥Êñ∞ÔºåÊôÆÁΩóÁ±≥‰øÆÊñØ‰æø‰∏ç‰ºöÊâãÂä®ÂéªÊãâÂèñÁõ∏Â∫î‰ø°ÊÅØÔºåÊó†Ê≥ïËææÂà∞ÁõëÊéßÁöÑÁõÆÁöÑ„ÄÇ</p>
<p>Êõ¥Êñ∞ÊôÆÁΩóÁ±≥‰øÆÊñØÂâçÔºö</p>
<figure><img src="http://cdn.lifemini.cn/dbblog/20201227/46d3e18a3fee4a5c815b5dca2aae49e6.png" alt="98796cd631809c0bb316b105822930c.png" tabindex="0"><figcaption>98796cd631809c0bb316b105822930c.png</figcaption></figure>
<p>ÊôÆÁΩóÁ±≥‰øÆÊñØÊòØÈÄöËøápullÁöÑÊñπÂºèÂéªÊñ∞ÁöÑtidbËäÇÁÇπÊãâÂèñÁöÑ„ÄÇ</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tidb01-41 tidb-ansible]$ ansible-playbook rolling_update_monitor.yml --tags=prometheus</span></span>
<span class="line"><span></span></span>
<span class="line"><span>PLAY [check config locally] **********************************************************************************************</span></span>
<span class="line"><span></span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>PLAY RECAP ***************************************************************************************************************</span></span>
<span class="line"><span>192.168.1.41               : ok=3    changed=0    unreachable=0    failed=0   </span></span>
<span class="line"><span>192.168.1.42               : ok=25   changed=8    unreachable=0    failed=0   </span></span>
<span class="line"><span>192.168.1.43               : ok=3    changed=0    unreachable=0    failed=0   </span></span>
<span class="line"><span>192.168.1.44               : ok=3    changed=0    unreachable=0    failed=0   </span></span>
<span class="line"><span>localhost                  : ok=7    changed=4    unreachable=0    failed=0   </span></span>
<span class="line"><span></span></span>
<span class="line"><span>Congrats! All goes well. :-)</span></span></code></pre>
</div><p>Êõ¥Êñ∞ÊôÆÁΩóÁ±≥‰øÆÊñØÂêéÔºö</p>
<figure><img src="http://cdn.lifemini.cn/dbblog/20201227/486672e3306b41edb86b698d36d786be.png" alt="0d15b132201b1d48c858b674ea2b923.png" tabindex="0"><figcaption>0d15b132201b1d48c858b674ea2b923.png</figcaption></figure>
<p>ÂèØ‰ª•ÁúãÂà∞ËäÇÁÇπÂ∑≤ÁªèÊõ¥Êñ∞ÂÆåÊØï„ÄÇ</p>
<h2 id="Áº©ÂÆπ-tidb-ÁªÑ‰ª∂" tabindex="-1">Áº©ÂÆπ TiDB ÁªÑ‰ª∂ <a class="header-anchor" href="#Áº©ÂÆπ-tidb-ÁªÑ‰ª∂" aria-label="Permalink to &quot;Áº©ÂÆπ TiDB ÁªÑ‰ª∂&quot;"></a></h2>
<h3 id="‰∏≠ÊéßÊú∫Êìç‰ΩúÁõÆÊ†áÊú∫ÂÅúÁî®tidbÊúçÂä°" tabindex="-1">‰∏≠ÊéßÊú∫Êìç‰ΩúÁõÆÊ†áÊú∫ÂÅúÁî®TiDBÊúçÂä° <a class="header-anchor" href="#‰∏≠ÊéßÊú∫Êìç‰ΩúÁõÆÊ†áÊú∫ÂÅúÁî®tidbÊúçÂä°" aria-label="Permalink to &quot;‰∏≠ÊéßÊú∫Êìç‰ΩúÁõÆÊ†áÊú∫ÂÅúÁî®TiDBÊúçÂä°&quot;"></a></h3>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tidb01-41 tidb-ansible]$ ansible-playbook stop.yml -l 192.168.1.44</span></span>
<span class="line"><span></span></span>
<span class="line"><span>PLAY [check config locally] **********************************************************************************************</span></span>
<span class="line"><span>skipping: no hosts matched</span></span>
<span class="line"><span></span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Congrats! All goes well. :-)</span></span></code></pre>
</div><h3 id="ÁôªÈôÜÈ™åËØÅtidbÊúçÂä°ÂÖ≥Èó≠" tabindex="-1">ÁôªÈôÜÈ™åËØÅTiDBÊúçÂä°ÂÖ≥Èó≠ <a class="header-anchor" href="#ÁôªÈôÜÈ™åËØÅtidbÊúçÂä°ÂÖ≥Èó≠" aria-label="Permalink to &quot;ÁôªÈôÜÈ™åËØÅTiDBÊúçÂä°ÂÖ≥Èó≠&quot;"></a></h3>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tidb01-41 tidb-ansible]$ mysql -u root -h 192.168.1.44 -P 4000</span></span>
<span class="line"><span>ERROR 2003 (HY000): Can't connect to MySQL server on '192.168.1.44' (111)</span></span></code></pre>
</div><h3 id="‰∏≠ÊéßÊú∫‰ªéinventory-iniÁßªÈô§ip" tabindex="-1">‰∏≠ÊéßÊú∫‰ªéinventory.iniÁßªÈô§IP <a class="header-anchor" href="#‰∏≠ÊéßÊú∫‰ªéinventory-iniÁßªÈô§ip" aria-label="Permalink to &quot;‰∏≠ÊéßÊú∫‰ªéinventory.iniÁßªÈô§IP&quot;"></a></h3>
<figure><img src="http://cdn.lifemini.cn/dbblog/20201227/b99b0347cb5d4e4ebb0097f9b8345874.png" alt="99c7436e809d9c19fd042b08a6f1eb3.png" tabindex="0"><figcaption>99c7436e809d9c19fd042b08a6f1eb3.png</figcaption></figure>
<p>node_exporter and blackbox_exporter serversÈÉ®ÂàÜÁöÑÁõëÊéßIP‰ø°ÊÅØÂêåÁêÜ‰πüË¶ÅÁßªÈô§„ÄÇ</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span># node_exporter and blackbox_exporter servers</span></span>
<span class="line"><span>[monitored_servers]</span></span>
<span class="line"><span>192.168.1.41</span></span>
<span class="line"><span>192.168.1.42</span></span>
<span class="line"><span>192.168.1.43</span></span></code></pre>
</div><h3 id="Êõ¥Êñ∞ÊôÆÂì¶Á±≥‰øÆÊñØ" tabindex="-1">Êõ¥Êñ∞ÊôÆÂì¶Á±≥‰øÆÊñØ <a class="header-anchor" href="#Êõ¥Êñ∞ÊôÆÂì¶Á±≥‰øÆÊñØ" aria-label="Permalink to &quot;Êõ¥Êñ∞ÊôÆÂì¶Á±≥‰øÆÊñØ&quot;"></a></h3>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tidb01-41 tidb-ansible]$ vi inventory.ini </span></span>
<span class="line"><span>[tidb@tidb01-41 tidb-ansible]$ ansible-playbook rolling_update_monitor.yml --tags=prometheus</span></span>
<span class="line"><span></span></span>
<span class="line"><span>PLAY [check config locally] **********************************************************************************************</span></span>
<span class="line"><span></span></span>
<span class="line"><span>.....</span></span>
<span class="line"><span>.....</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>PLAY RECAP ***************************************************************************************************************</span></span>
<span class="line"><span>192.168.1.41               : ok=3    changed=0    unreachable=0    failed=0   </span></span>
<span class="line"><span>192.168.1.42               : ok=25   changed=8    unreachable=0    failed=0   </span></span>
<span class="line"><span>192.168.1.43               : ok=3    changed=0    unreachable=0    failed=0   </span></span>
<span class="line"><span>localhost                  : ok=7    changed=4    unreachable=0    failed=0   </span></span>
<span class="line"><span></span></span>
<span class="line"><span>Congrats! All goes well. :-)</span></span></code></pre>
</div><p>Á∫¢Ëâ≤ÈÉ®ÂàÜÈúÄË¶Å‰∏ÄÊÆµÊó∂Èó¥ÊâçËÉΩÊ∂àÂ§±ÔºåÊòØÊï¥‰∏™ÈõÜÁæ§ËøòÊ≤°ÊúâÂèçÊò†ËøáÊù•Ôºõ
‰ΩÜÊòØÂèØ‰ª•ÁúãÂà∞ÔºåTiDBÁöÑÂÆû‰æãÊï∞ÈáèÂ∑≤ÁªèÈôçÂà∞‰∫Ü2„ÄÇ</p>
<figure><img src="http://cdn.lifemini.cn/dbblog/20201227/dc89babef59f4262a0ff7b12b18ab45b.png" alt="1dc88c18a7de3dcafe8c757f993eda2.png" tabindex="0"><figcaption>1dc88c18a7de3dcafe8c757f993eda2.png</figcaption></figure>
<h2 id="Êâ©ÂÆπ-tikv-ÁªÑ‰ª∂" tabindex="-1">Êâ©ÂÆπ TiKV ÁªÑ‰ª∂ <a class="header-anchor" href="#Êâ©ÂÆπ-tikv-ÁªÑ‰ª∂" aria-label="Permalink to &quot;Êâ©ÂÆπ TiKV ÁªÑ‰ª∂&quot;"></a></h2>
<h3 id="ÈÖçÁΩÆinventory-iniÁöÑtikvÈÉ®ÂàÜ" tabindex="-1">ÈÖçÁΩÆinventory.iniÁöÑTiKVÈÉ®ÂàÜ <a class="header-anchor" href="#ÈÖçÁΩÆinventory-iniÁöÑtikvÈÉ®ÂàÜ" aria-label="Permalink to &quot;ÈÖçÁΩÆinventory.iniÁöÑTiKVÈÉ®ÂàÜ&quot;"></a></h3>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tidb01-41 tidb-ansible]$ vi inventory.ini</span></span></code></pre>
</div><p>‰ΩøÁî®‰∏äËø∞ÂëΩ‰ª§ÔºåÂú®tikv_serversÂíåmonitored_servers‰∏≠ÂàÜÂà´ËøΩÂä†Êñ∞ÈÉ®ÁΩ≤ËäÇÁÇπÁöÑIPÂú∞ÂùÄÔºõ</p>
<figure><img src="http://cdn.lifemini.cn/dbblog/20201227/c45b87c46cc143f8a0def8b154e35c6c.png" alt="5132bd5af713ee6e76bf91a87f58d87.png" tabindex="0"><figcaption>5132bd5af713ee6e76bf91a87f58d87.png</figcaption></figure>
<figure><img src="http://cdn.lifemini.cn/dbblog/20201227/15323cdc7b4a49c2a7b30532829c1c83.png" alt="dea88cbf26d02fa12d699d69bf343c8.png" tabindex="0"><figcaption>dea88cbf26d02fa12d699d69bf343c8.png</figcaption></figure>
<h3 id="‰∏≠ÊéßÊú∫Êìç‰ΩúÈÉ®ÁΩ≤Êú∫Âª∫Áî®Êà∑-2" tabindex="-1">‰∏≠ÊéßÊú∫Êìç‰ΩúÈÉ®ÁΩ≤Êú∫Âª∫Áî®Êà∑ <a class="header-anchor" href="#‰∏≠ÊéßÊú∫Êìç‰ΩúÈÉ®ÁΩ≤Êú∫Âª∫Áî®Êà∑-2" aria-label="Permalink to &quot;‰∏≠ÊéßÊú∫Êìç‰ΩúÈÉ®ÁΩ≤Êú∫Âª∫Áî®Êà∑&quot;"></a></h3>
<p>ÊâßË°å‰ª•‰∏ãÂëΩ‰ª§Ôºå‰æùÊçÆËæìÂÖ•<em><strong>ÈÉ®ÁΩ≤ÁõÆÊ†áÊú∫Âô®</strong></em>ÁöÑ root Áî®Êà∑ÂØÜÁ†ÅÔºõ
Êú¨‰æãÊñ∞Â¢ûËäÇÁÇπIP‰∏∫192.168.1.44Ôºõ</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tidb01-41 tidb-ansible]$ vi hosts.ini </span></span>
<span class="line"><span>[tidb@tidb01-41 tidb-ansible]$ cat hosts.ini </span></span>
<span class="line"><span>[servers]</span></span>
<span class="line"><span>192.168.1.44</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>[all:vars]</span></span>
<span class="line"><span>username = tidb</span></span>
<span class="line"><span>ntp_server = cn.pool.ntp.org</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>[tidb@tidb01-41 tidb-ansible]$ ansible-playbook -i hosts.ini create_users.yml -u root -k</span></span>
<span class="line"><span>SSH password: </span></span>
<span class="line"><span></span></span>
<span class="line"><span>PLAY [all] ***************************************************************************************************************</span></span>
<span class="line"><span></span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Congrats! All goes well. :-)</span></span></code></pre>
</div><h3 id="‰∏≠ÊéßÊú∫Êìç‰ΩúÈÉ®ÁΩ≤Êú∫ÈÖçÁΩÆntpÊúçÂä°-2" tabindex="-1">‰∏≠ÊéßÊú∫Êìç‰ΩúÈÉ®ÁΩ≤Êú∫ÈÖçÁΩÆntpÊúçÂä° <a class="header-anchor" href="#‰∏≠ÊéßÊú∫Êìç‰ΩúÈÉ®ÁΩ≤Êú∫ÈÖçÁΩÆntpÊúçÂä°-2" aria-label="Permalink to &quot;‰∏≠ÊéßÊú∫Êìç‰ΩúÈÉ®ÁΩ≤Êú∫ÈÖçÁΩÆntpÊúçÂä°&quot;"></a></h3>
<p><em><strong>Ê≥®ÊÑèÔºöÁîü‰∫ß‰∏äÂ∫îËØ•ÊåáÂêëËá™Â∑±ÁöÑntpÊúçÂä°Âô®ÔºåÊú¨Ê¨°ÊµãËØïÈááÁî®‰∫ÜÂÖ¨ÁΩëÂÖ¨Áî®ÁöÑntpÊúçÂä°‰∏çÁ®≥ÂÆö„ÄÇ</strong></em></p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tidb01-41 tidb-ansible]$ ansible-playbook -i hosts.ini deploy_ntp.yml -u tidb -b</span></span>
<span class="line"><span></span></span>
<span class="line"><span>PLAY [all] ***************************************************************************************************************</span></span>
<span class="line"><span></span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Congrats! All goes well. :-)</span></span></code></pre>
</div><h3 id="‰∏≠ÊéßÂèäÊìç‰ΩúÈÉ®ÁΩ≤Êú∫ËÆæÁΩÆcpuÊ®°Âºè-2" tabindex="-1">‰∏≠ÊéßÂèäÊìç‰ΩúÈÉ®ÁΩ≤Êú∫ËÆæÁΩÆCPUÊ®°Âºè <a class="header-anchor" href="#‰∏≠ÊéßÂèäÊìç‰ΩúÈÉ®ÁΩ≤Êú∫ËÆæÁΩÆcpuÊ®°Âºè-2" aria-label="Permalink to &quot;‰∏≠ÊéßÂèäÊìç‰ΩúÈÉ®ÁΩ≤Êú∫ËÆæÁΩÆCPUÊ®°Âºè&quot;"></a></h3>
<p>Ë∞ÉÊï¥CPUÊ®°ÂºèÔºåÂ¶ÇÊûúÂêåÊú¨ÊñáÂá∫Áé∞‰∏ÄÊ†∑ÁöÑÊä•ÈîôÔºåËØ¥ÊòéÊ≠§ÁâàÊú¨ÁöÑÊìç‰ΩúÁ≥ªÁªü‰∏çÊîØÊåÅCPUÊ®°Âºè‰øÆÊîπÔºåÂèØÁõ¥Êé•Ë∑≥Ëøá„ÄÇ</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tidb01-41 tidb-ansible]$ ansible -i hosts.ini all -m shell -a "cpupower frequency-set --governor performance" -u tidb -b</span></span>
<span class="line"><span>192.168.1.44 | FAILED | rc=237 >></span></span>
<span class="line"><span>Setting cpu: 0</span></span>
<span class="line"><span>Error setting new values. Common errors:</span></span>
<span class="line"><span>- Do you have proper administration rights? (super-user?)</span></span>
<span class="line"><span>- Is the governor you requested available and modprobed?</span></span>
<span class="line"><span>- Trying to set an invalid policy?</span></span>
<span class="line"><span>- Trying to set a specific frequency, but userspace governor is not available,</span></span>
<span class="line"><span>   for example because of hardware which cannot be set to a specific frequency</span></span>
<span class="line"><span>   or because the userspace governor isn't loaded?non-zero return code</span></span></code></pre>
</div><h3 id="ÊâßË°åbootstrap-ymlÂàõÂª∫Ê®°Êùø" tabindex="-1">ÊâßË°åbootstrap.ymlÂàõÂª∫Ê®°Êùø <a class="header-anchor" href="#ÊâßË°åbootstrap-ymlÂàõÂª∫Ê®°Êùø" aria-label="Permalink to &quot;ÊâßË°åbootstrap.ymlÂàõÂª∫Ê®°Êùø&quot;"></a></h3>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tidb01-41 tidb-ansible]$ ansible-playbook bootstrap.yml -l 192.168.1.44</span></span>
<span class="line"><span></span></span>
<span class="line"><span>PLAY [initializing deployment target] ************************************************************************************</span></span>
<span class="line"><span>skipping: no hosts matched</span></span>
<span class="line"><span></span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Congrats! All goes well. :-)</span></span></code></pre>
</div><h3 id="ÊâßË°åstart-ymlÂêØÂä®tikvÊúçÂä°" tabindex="-1">ÊâßË°åstart.ymlÂêØÂä®tikvÊúçÂä° <a class="header-anchor" href="#ÊâßË°åstart-ymlÂêØÂä®tikvÊúçÂä°" aria-label="Permalink to &quot;ÊâßË°åstart.ymlÂêØÂä®tikvÊúçÂä°&quot;"></a></h3>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>Congrats! All goes well. :-)</span></span>
<span class="line"><span>[tidb@tidb01-41 tidb-ansible]$ ansible-playbook start.yml -l 192.168.1.44</span></span>
<span class="line"><span></span></span>
<span class="line"><span>PLAY [check config locally] **********************************************************************************************</span></span>
<span class="line"><span>skipping: no hosts matched</span></span>
<span class="line"><span></span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Congrats! All goes well. :-)</span></span></code></pre>
</div><h3 id="ÊâßË°årolling-update-ymlÊªöÂä®Êõ¥Êñ∞" tabindex="-1">ÊâßË°årolling-update.ymlÊªöÂä®Êõ¥Êñ∞ <a class="header-anchor" href="#ÊâßË°årolling-update-ymlÊªöÂä®Êõ¥Êñ∞" aria-label="Permalink to &quot;ÊâßË°årolling-update.ymlÊªöÂä®Êõ¥Êñ∞&quot;"></a></h3>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tidb01-41 tidb-ansible]$ ansible-playbook rolling_update_monitor.yml --tags=prometheus</span></span>
<span class="line"><span></span></span>
<span class="line"><span>PLAY [check config locally] **********************************************************************************************</span></span>
<span class="line"><span></span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span></span></span>
<span class="line"><span>PLAY RECAP ***************************************************************************************************************</span></span>
<span class="line"><span>192.168.1.41               : ok=3    changed=0    unreachable=0    failed=0   </span></span>
<span class="line"><span>192.168.1.42               : ok=25   changed=8    unreachable=0    failed=0   </span></span>
<span class="line"><span>192.168.1.43               : ok=3    changed=0    unreachable=0    failed=0   </span></span>
<span class="line"><span>192.168.1.44               : ok=3    changed=0    unreachable=0    failed=0   </span></span>
<span class="line"><span>localhost                  : ok=7    changed=4    unreachable=0    failed=0   </span></span>
<span class="line"><span></span></span>
<span class="line"><span>Congrats! All goes well. :-)</span></span></code></pre>
</div><h3 id="pd-ctlÂëΩ‰ª§Ë°åÈ™åËØÅÊòØÂê¶ÊàêÂäü" tabindex="-1">pd-ctlÂëΩ‰ª§Ë°åÈ™åËØÅÊòØÂê¶ÊàêÂäü <a class="header-anchor" href="#pd-ctlÂëΩ‰ª§Ë°åÈ™åËØÅÊòØÂê¶ÊàêÂäü" aria-label="Permalink to &quot;pd-ctlÂëΩ‰ª§Ë°åÈ™åËØÅÊòØÂê¶ÊàêÂäü&quot;"></a></h3>
<p>ÂèØ‰ª•‰ΩøÁî®stores showÂëΩ‰ª§ÂèØ‰ª•Âú®pd-ctl‰∫§‰∫íÂºèÂëΩ‰ª§Ë°å‰∏≠ÁúãÂà∞Ôºõ
&quot;count&quot;Ôºö4 Ë°®Á§∫ÂΩìÂâçtikvÊúâÂõõ‰∏™ËäÇÁÇπÔºåËØ¥ÊòétikvËäÇÁÇπÂ∑≤ÁªèÊ∑ªÂä†ÊàêÂäü‰∫Ü„ÄÇ</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tidb01-41 tidb-ansible]$ resources/bin/pd-ctl -u http://192.168.1.41:2379 -i</span></span>
<span class="line"><span>¬ª stores show</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>  "count": 4,</span></span>
<span class="line"><span>  "stores": [</span></span>
<span class="line"><span>    {</span></span>
<span class="line"><span>      "store": {</span></span>
<span class="line"><span>        "id": 2001,</span></span>
<span class="line"><span>        "address": "192.168.1.44:20160",</span></span>
<span class="line"><span>        "version": "3.0.1",</span></span>
<span class="line"><span>        "state_name": "Up"</span></span>
<span class="line"><span>      },</span></span>
<span class="line"><span>      "status": {</span></span>
<span class="line"><span>        "capacity": "17 GiB",</span></span>
<span class="line"><span>        "available": "15 GiB",</span></span>
<span class="line"><span>        "leader_count": 1,</span></span>
<span class="line"><span>        "leader_weight": 1,</span></span>
<span class="line"><span>        "leader_score": 1,</span></span>
<span class="line"><span>        "leader_size": 1,</span></span>
<span class="line"><span>        "region_count": 20,</span></span>
<span class="line"><span>        "region_weight": 1,</span></span>
<span class="line"><span>        "region_score": 20,</span></span>
<span class="line"><span>        "region_size": 20,</span></span>
<span class="line"><span>        "start_ts": "2020-12-27T01:53:06-05:00",</span></span>
<span class="line"><span>        "last_heartbeat_ts": "2020-12-27T01:59:36.260710913-05:00",</span></span>
<span class="line"><span>        "uptime": "6m30.260710913s"</span></span>
<span class="line"><span>      }</span></span>
<span class="line"><span>    },</span></span>
<span class="line"><span>    {</span></span>
<span class="line"><span>      "store": {</span></span>
<span class="line"><span>        "id": 1,</span></span>
<span class="line"><span>        "address": "192.168.1.41:20160",</span></span>
<span class="line"><span>        "version": "3.0.1",</span></span>
<span class="line"><span>        "state_name": "Up"</span></span>
<span class="line"><span>      },</span></span>
<span class="line"><span>      "status": {</span></span>
<span class="line"><span>        "capacity": "17 GiB",</span></span>
<span class="line"><span>        "available": "3.4 GiB",</span></span>
<span class="line"><span>        "leader_weight": 1,</span></span>
<span class="line"><span>        "region_weight": 1,</span></span>
<span class="line"><span>        "region_score": 1073738348.2304688,</span></span>
<span class="line"><span>        "start_ts": "2020-12-27T01:02:52-05:00",</span></span>
<span class="line"><span>        "last_heartbeat_ts": "2020-12-27T01:59:34.041233812-05:00",</span></span>
<span class="line"><span>        "uptime": "56m42.041233812s"</span></span>
<span class="line"><span>      }</span></span>
<span class="line"><span>    },</span></span>
<span class="line"><span>    {</span></span>
<span class="line"><span>      "store": {</span></span>
<span class="line"><span>        "id": 4,</span></span>
<span class="line"><span>        "address": "192.168.1.43:20160",</span></span>
<span class="line"><span>        "version": "3.0.1",</span></span>
<span class="line"><span>        "state_name": "Up"</span></span>
<span class="line"><span>      },</span></span>
<span class="line"><span>      "status": {</span></span>
<span class="line"><span>        "capacity": "17 GiB",</span></span>
<span class="line"><span>        "available": "14 GiB",</span></span>
<span class="line"><span>        "leader_count": 9,</span></span>
<span class="line"><span>        "leader_weight": 1,</span></span>
<span class="line"><span>        "leader_score": 9,</span></span>
<span class="line"><span>        "leader_size": 9,</span></span>
<span class="line"><span>        "region_count": 20,</span></span>
<span class="line"><span>        "region_weight": 1,</span></span>
<span class="line"><span>        "region_score": 20,</span></span>
<span class="line"><span>        "region_size": 20,</span></span>
<span class="line"><span>        "start_ts": "2020-12-27T01:01:12-05:00",</span></span>
<span class="line"><span>        "last_heartbeat_ts": "2020-12-27T01:59:32.975729011-05:00",</span></span>
<span class="line"><span>        "uptime": "58m20.975729011s"</span></span>
<span class="line"><span>      }</span></span>
<span class="line"><span>    },</span></span>
<span class="line"><span>    {</span></span>
<span class="line"><span>      "store": {</span></span>
<span class="line"><span>        "id": 5,</span></span>
<span class="line"><span>        "address": "192.168.1.42:20160",</span></span>
<span class="line"><span>        "version": "3.0.1",</span></span>
<span class="line"><span>        "state_name": "Up"</span></span>
<span class="line"><span>      },</span></span>
<span class="line"><span>      "status": {</span></span>
<span class="line"><span>        "capacity": "17 GiB",</span></span>
<span class="line"><span>        "available": "13 GiB",</span></span>
<span class="line"><span>        "leader_count": 10,</span></span>
<span class="line"><span>        "leader_weight": 1,</span></span>
<span class="line"><span>        "leader_score": 10,</span></span>
<span class="line"><span>        "leader_size": 10,</span></span>
<span class="line"><span>        "region_count": 20,</span></span>
<span class="line"><span>        "region_weight": 1,</span></span>
<span class="line"><span>        "region_score": 20,</span></span>
<span class="line"><span>        "region_size": 20,</span></span>
<span class="line"><span>        "start_ts": "2020-12-27T01:01:12-05:00",</span></span>
<span class="line"><span>        "last_heartbeat_ts": "2020-12-27T01:59:33.014833325-05:00",</span></span>
<span class="line"><span>        "uptime": "58m21.014833325s"</span></span>
<span class="line"><span>      }</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>  ]</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>¬ª exit</span></span>
<span class="line"><span>[tidb@tidb01-41 tidb-ansible]$</span></span></code></pre>
</div><p>Êõ¥Êñ∞ÊôÆÁΩóÁ±≥‰øÆÊñØÂêéÔºö</p>
<p>‰ΩøÁî®ÊôÆÁΩóÁ±≥‰øÆÊñØÁöÑGrafanaÂõæÂΩ¢ÂåñÁõëÊéßÁïåÈù¢‰πüÂèØ‰ª•ÁúãÂà∞ÂΩìÂâçÁöÑtikvÈõÜÁæ§‰πüÂ∑≤ÁªèÂä†ÂÖ•Êñ∞ËäÇÁÇπÊàêÂäü‰∫Ü„ÄÇ</p>
<figure><img src="http://cdn.lifemini.cn/dbblog/20201227/2b15553374e54489b3b3f12707d5d264.png" alt="ea85764f4fe314d64f8295232245eeb.png" tabindex="0"><figcaption>ea85764f4fe314d64f8295232245eeb.png</figcaption></figure>
<h2 id="Áº©ÂÆπ-tikv-ÁªÑ‰ª∂" tabindex="-1">Áº©ÂÆπ TiKV ÁªÑ‰ª∂ <a class="header-anchor" href="#Áº©ÂÆπ-tikv-ÁªÑ‰ª∂" aria-label="Permalink to &quot;Áº©ÂÆπ TiKV ÁªÑ‰ª∂&quot;"></a></h2>
<h3 id="pd-Âà†Èô§-tikv-ËäÇÁÇπ" tabindex="-1">pd Âà†Èô§ TiKV ËäÇÁÇπ <a class="header-anchor" href="#pd-Âà†Èô§-tikv-ËäÇÁÇπ" aria-label="Permalink to &quot;pd Âà†Èô§ TiKV ËäÇÁÇπ&quot;"></a></h3>
<p>È¶ñÂÖàÔºåÁôªÂΩïpd-ctl‰∫§‰∫íÂºèÂëΩ‰ª§Ë°åÔºåÂú®PDÈõÜÁæ§‰∏≠Â£∞ÊòéÂ∞ÜËØ•TiKVËäÇÁÇπË∏¢Âá∫TiKVÈõÜÁæ§Ôºõ
ËÄåÂêéÔºåPDÈõÜÁæ§‰ºöÂ∞ÜÂ≠òÂú®‰∏éË¢´ÊèêÂá∫ÈõÜÁæ§ËäÇÁÇπ‰∏äÁöÑRegionË∞ÉÂ∫¶Âà∞ÂÖ∂‰ªñÊú∫Âô®‰∏äÔºõ
‰ΩÜÂ∫îÂú®ÂëΩ‰ª§Ë°å‰∏ä‰∏∫OfflineÁä∂ÊÄÅÔºåÊ≥®ÊÑèÊ≠§Êó∂ÁöÑofflineÁä∂ÊÄÅÂπ∂ÈùûÊòØÂ∑≤Ë∞ÉÂ∫¶ÂÆåÊØïÁä∂ÊÄÅÔºåËÄåÊòØÊ≠£Âú®Ë∞ÉÂ∫¶Áä∂ÊÄÅÔºõ
ÁúüÊ≠£ÁöÑË∞ÉÂ∫¶ÂÆåÊàêÁä∂ÊÄÅ‰∏∫tombstoneÔºàÂ¢ìÁ¢ëÔºâÁä∂‰ΩìÔºåÂèçÂ∫îÂà∞ÂëΩ‰ª§‰∏ä‰∏∫ËØ•idÊ∂àÂ§±„ÄÇ</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tidb01-41 tidb-ansible]$ resources/bin/pd-ctl -u http://192.168.1.41:2379 -i</span></span>
<span class="line"><span>¬ª store delete 2001</span></span>
<span class="line"><span>Success!</span></span>
<span class="line"><span>¬ª stores show</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>  "count": 4,</span></span>
<span class="line"><span>  "stores": [</span></span>
<span class="line"><span>    {</span></span>
<span class="line"><span>      "store": {</span></span>
<span class="line"><span>        "id": 1,</span></span>
<span class="line"><span>        "address": "192.168.1.41:20160",</span></span>
<span class="line"><span>        "version": "3.0.1",</span></span>
<span class="line"><span>        "state_name": "Up"</span></span>
<span class="line"><span>      },</span></span>
<span class="line"><span>      "status": {</span></span>
<span class="line"><span>        "capacity": "17 GiB",</span></span>
<span class="line"><span>        "available": "3.4 GiB",</span></span>
<span class="line"><span>        "leader_weight": 1,</span></span>
<span class="line"><span>        "region_weight": 1,</span></span>
<span class="line"><span>        "region_score": 1073738348.6953125,</span></span>
<span class="line"><span>        "start_ts": "2020-12-27T01:02:52-05:00",</span></span>
<span class="line"><span>        "last_heartbeat_ts": "2020-12-27T02:01:44.059741115-05:00",</span></span>
<span class="line"><span>        "uptime": "58m52.059741115s"</span></span>
<span class="line"><span>      }</span></span>
<span class="line"><span>    },</span></span>
<span class="line"><span>    {</span></span>
<span class="line"><span>      "store": {</span></span>
<span class="line"><span>        "id": 4,</span></span>
<span class="line"><span>        "address": "192.168.1.43:20160",</span></span>
<span class="line"><span>        "version": "3.0.1",</span></span>
<span class="line"><span>        "state_name": "Up"</span></span>
<span class="line"><span>      },</span></span>
<span class="line"><span>      "status": {</span></span>
<span class="line"><span>        "capacity": "17 GiB",</span></span>
<span class="line"><span>        "available": "14 GiB",</span></span>
<span class="line"><span>        "leader_count": 9,</span></span>
<span class="line"><span>        "leader_weight": 1,</span></span>
<span class="line"><span>        "leader_score": 9,</span></span>
<span class="line"><span>        "leader_size": 9,</span></span>
<span class="line"><span>        "region_count": 20,</span></span>
<span class="line"><span>        "region_weight": 1,</span></span>
<span class="line"><span>        "region_score": 20,</span></span>
<span class="line"><span>        "region_size": 20,</span></span>
<span class="line"><span>        "start_ts": "2020-12-27T01:01:12-05:00",</span></span>
<span class="line"><span>        "last_heartbeat_ts": "2020-12-27T02:01:42.99596895-05:00",</span></span>
<span class="line"><span>        "uptime": "1h0m30.99596895s"</span></span>
<span class="line"><span>      }</span></span>
<span class="line"><span>    },</span></span>
<span class="line"><span>    {</span></span>
<span class="line"><span>      "store": {</span></span>
<span class="line"><span>        "id": 5,</span></span>
<span class="line"><span>        "address": "192.168.1.42:20160",</span></span>
<span class="line"><span>        "version": "3.0.1",</span></span>
<span class="line"><span>        "state_name": "Up"</span></span>
<span class="line"><span>      },</span></span>
<span class="line"><span>      "status": {</span></span>
<span class="line"><span>        "capacity": "17 GiB",</span></span>
<span class="line"><span>        "available": "13 GiB",</span></span>
<span class="line"><span>        "leader_count": 10,</span></span>
<span class="line"><span>        "leader_weight": 1,</span></span>
<span class="line"><span>        "leader_score": 10,</span></span>
<span class="line"><span>        "leader_size": 10,</span></span>
<span class="line"><span>        "region_count": 20,</span></span>
<span class="line"><span>        "region_weight": 1,</span></span>
<span class="line"><span>        "region_score": 20,</span></span>
<span class="line"><span>        "region_size": 20,</span></span>
<span class="line"><span>        "start_ts": "2020-12-27T01:01:12-05:00",</span></span>
<span class="line"><span>        "last_heartbeat_ts": "2020-12-27T02:01:43.033315794-05:00",</span></span>
<span class="line"><span>        "uptime": "1h0m31.033315794s"</span></span>
<span class="line"><span>      }</span></span>
<span class="line"><span>    },</span></span>
<span class="line"><span>    {</span></span>
<span class="line"><span>      "store": {</span></span>
<span class="line"><span>        "id": 2001,</span></span>
<span class="line"><span>        "address": "192.168.1.44:20160",</span></span>
<span class="line"><span>        "state": 1,</span></span>
<span class="line"><span>        "version": "3.0.1",</span></span>
<span class="line"><span>        "state_name": "Offline"</span></span>
<span class="line"><span>      },</span></span>
<span class="line"><span>      "status": {</span></span>
<span class="line"><span>        "capacity": "17 GiB",</span></span>
<span class="line"><span>        "available": "15 GiB",</span></span>
<span class="line"><span>        "leader_count": 1,</span></span>
<span class="line"><span>        "leader_weight": 1,</span></span>
<span class="line"><span>        "leader_score": 1,</span></span>
<span class="line"><span>        "leader_size": 1,</span></span>
<span class="line"><span>        "region_count": 20,</span></span>
<span class="line"><span>        "region_weight": 1,</span></span>
<span class="line"><span>        "region_score": 20,</span></span>
<span class="line"><span>        "region_size": 20,</span></span>
<span class="line"><span>        "start_ts": "2020-12-27T01:53:06-05:00",</span></span>
<span class="line"><span>        "last_heartbeat_ts": "2020-12-27T02:01:46.276789545-05:00",</span></span>
<span class="line"><span>        "uptime": "8m40.276789545s"</span></span>
<span class="line"><span>      }</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>  ]</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>¬ª</span></span></code></pre>
</div><h3 id="ÊâßË°åstop-ymlÂÅúÊ≠¢ËäÇÁÇπtikvÊúçÂä°" tabindex="-1">ÊâßË°åstop.ymlÂÅúÊ≠¢ËäÇÁÇπtikvÊúçÂä° <a class="header-anchor" href="#ÊâßË°åstop-ymlÂÅúÊ≠¢ËäÇÁÇπtikvÊúçÂä°" aria-label="Permalink to &quot;ÊâßË°åstop.ymlÂÅúÊ≠¢ËäÇÁÇπtikvÊúçÂä°&quot;"></a></h3>
<p>Á≠âÂæÖoffline‰πãÂêé,ÊâßË°åstop.ymlÂÅúÊ≠¢ËäÇÁÇπtikvÊúçÂä°Ôºõ</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tidb01-41 tidb-ansible]$ ansible-playbook stop.yml -l 192.168.1.44</span></span>
<span class="line"><span></span></span>
<span class="line"><span>PLAY [check config locally] *********************************************************************************************************************************</span></span>
<span class="line"><span>skipping: no hosts matched</span></span>
<span class="line"><span></span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Congrats! All goes well. :-)</span></span></code></pre>
</div><h3 id="‰ªéinventory-ini‰∏≠ÁßªÈô§tikvËäÇÁÇπip" tabindex="-1">‰ªéinventory.ini‰∏≠ÁßªÈô§tikvËäÇÁÇπIP <a class="header-anchor" href="#‰ªéinventory-ini‰∏≠ÁßªÈô§tikvËäÇÁÇπip" aria-label="Permalink to &quot;‰ªéinventory.ini‰∏≠ÁßªÈô§tikvËäÇÁÇπIP&quot;"></a></h3>
<p>Â¶Ç‰∏ãÂõæÊâÄÁ§∫ÔºåÂ∞ÜÊ°ÜÈÄâÂá∫IPÁßªÈô§ËØ•Êñá‰ª∂Ôºõ</p>
<figure><img src="http://cdn.lifemini.cn/dbblog/20201227/be8f5aa1d45b4107a3a32ba367b226e6.png" alt="5b9b77a5bb7f53af382a1459ab2b0fb.png" tabindex="0"><figcaption>5b9b77a5bb7f53af382a1459ab2b0fb.png</figcaption></figure>
<figure><img src="http://cdn.lifemini.cn/dbblog/20201227/52da60141a0a45f8afd9872ef198ec4b.png" alt="f27369a63cad296c22e8a014c68d0b7.png" tabindex="0"><figcaption>f27369a63cad296c22e8a014c68d0b7.png</figcaption></figure>
<h3 id="ÊªöÂä®Êõ¥Êñ∞ÊôÆÁΩóÁ±≥‰øÆÊñØ-2" tabindex="-1">ÊªöÂä®Êõ¥Êñ∞ÊôÆÁΩóÁ±≥‰øÆÊñØ <a class="header-anchor" href="#ÊªöÂä®Êõ¥Êñ∞ÊôÆÁΩóÁ±≥‰øÆÊñØ-2" aria-label="Permalink to &quot;ÊªöÂä®Êõ¥Êñ∞ÊôÆÁΩóÁ±≥‰øÆÊñØ&quot;"></a></h3>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span></span></span>
<span class="line"><span>[tidb@tidb01-41 tidb-ansible]$ vi inventory.ini </span></span>
<span class="line"><span>[tidb@tidb01-41 tidb-ansible]$ ansible-playbook rolling_update_monitor.yml --tags=prometheus</span></span>
<span class="line"><span></span></span>
<span class="line"><span>PLAY [check config locally] *********************************************************************************************************************************</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>.....</span></span>
<span class="line"><span>.....</span></span>
<span class="line"><span></span></span>
<span class="line"><span>PLAY RECAP **************************************************************************************************************************************************</span></span>
<span class="line"><span>192.168.1.41               : ok=3    changed=0    unreachable=0    failed=0   </span></span>
<span class="line"><span>192.168.1.42               : ok=25   changed=8    unreachable=0    failed=0   </span></span>
<span class="line"><span>192.168.1.43               : ok=3    changed=0    unreachable=0    failed=0   </span></span>
<span class="line"><span>localhost                  : ok=7    changed=4    unreachable=0    failed=0   </span></span>
<span class="line"><span></span></span>
<span class="line"><span>Congrats! All goes well. :-)</span></span></code></pre>
</div><h3 id="ÊôÆÁΩóÁ±≥‰øÆÊñØÊ£ÄÊü•" tabindex="-1">ÊôÆÁΩóÁ±≥‰øÆÊñØÊ£ÄÊü• <a class="header-anchor" href="#ÊôÆÁΩóÁ±≥‰øÆÊñØÊ£ÄÊü•" aria-label="Permalink to &quot;ÊôÆÁΩóÁ±≥‰øÆÊñØÊ£ÄÊü•&quot;"></a></h3>
<figure><img src="http://cdn.lifemini.cn/dbblog/20201227/13103cdaa9ef4c49afb1d89d50a334be.png" alt="84f476fc743f2cf8de27d5b2233c761.png" tabindex="0"><figcaption>84f476fc743f2cf8de27d5b2233c761.png</figcaption></figure>
<p>ÂàöÂàöÊõ¥Êñ∞ÂÆåÊØïÔºåÈõÜÁæ§ËøòÈúÄË¶Å‰∏ÄÂÆöÁöÑÊó∂Èó¥ÂèçÂ∫îÔºõ
‰∏ãÂõæÂèØ‰ª•ÁúãÂá∫ÔºåÁ∫¢Ëâ≤ÈÉ®ÂàÜÂ∑≤ÁªèÊ∂àÂ§±„ÄÇ</p>
<figure><img src="http://cdn.lifemini.cn/dbblog/20201227/f83b5cb124a0412d8c32df717c55ed38.png" alt="09c46c43533324e9562450d4224e2c4.png" tabindex="0"><figcaption>09c46c43533324e9562450d4224e2c4.png</figcaption></figure>
]]></content:encoded>
            <enclosure url="http://cdn.lifemini.cn/dbblog/20201227/b5ceba7b9807484b9f385d382d5ab325.png" length="0" type="image/png"/>
        </item>
        <item>
            <title><![CDATA[Ê†∏ÂøÉÊ≠•È™§]]></title>
            <link>https://askaric.com/zh/work/tidb/02TIDB-ÈÉ®ÁΩ≤ÂÆûË∑µ/2-1Ansible ÈÉ®ÁΩ≤ÂÆûË∑µ/02Ansible ‰øÆÊîπÈõÜÁæ§ÈÖçÁΩÆ.html</link>
            <guid>https://askaric.com/zh/work/tidb/02TIDB-ÈÉ®ÁΩ≤ÂÆûË∑µ/2-1Ansible ÈÉ®ÁΩ≤ÂÆûË∑µ/02Ansible ‰øÆÊîπÈõÜÁæ§ÈÖçÁΩÆ.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[1.‰∏≠ÊéßÊú∫Ôºàtidb01-41Ôºâ‰øÆÊîπÈõÜÁæ§ÈÖçÁΩÆ  
2.‰∏≠ÊéßÊú∫ÊâßË°årolling-updateÊªöÂä®Êõ¥Êñ∞  
3.TiKV‰ªªÊÑèÂ≠êËäÇÁÇπÈÉ®ÁΩ≤ÁõÆÂΩïÊ£ÄÊü•ÈÖçÁΩÆ  
 ‰∏≠ÊéßÊú∫Ôºàtidb01-41Ôºâ‰øÆÊîπÈõÜÁæ§ÈÖçÁΩÆ
```]]></description>
            <content:encoded><![CDATA[<h2 id="Ê†∏ÂøÉÊ≠•È™§" tabindex="-1">Ê†∏ÂøÉÊ≠•È™§ <a class="header-anchor" href="#Ê†∏ÂøÉÊ≠•È™§" aria-label="Permalink to &quot;Ê†∏ÂøÉÊ≠•È™§&quot;"></a></h2>
<p>1.‰∏≠ÊéßÊú∫Ôºàtidb01-41Ôºâ‰øÆÊîπÈõÜÁæ§ÈÖçÁΩÆ<br>
2.‰∏≠ÊéßÊú∫ÊâßË°årolling-updateÊªöÂä®Êõ¥Êñ∞<br>
3.TiKV‰ªªÊÑèÂ≠êËäÇÁÇπÈÉ®ÁΩ≤ÁõÆÂΩïÊ£ÄÊü•ÈÖçÁΩÆ</p>
<h2 id="‰∏≠ÊéßÊú∫-tidb01-41-‰øÆÊîπÈõÜÁæ§ÈÖçÁΩÆ" tabindex="-1">‰∏≠ÊéßÊú∫Ôºàtidb01-41Ôºâ‰øÆÊîπÈõÜÁæ§ÈÖçÁΩÆ <a class="header-anchor" href="#‰∏≠ÊéßÊú∫-tidb01-41-‰øÆÊîπÈõÜÁæ§ÈÖçÁΩÆ" aria-label="Permalink to &quot;‰∏≠ÊéßÊú∫Ôºàtidb01-41Ôºâ‰øÆÊîπÈõÜÁæ§ÈÖçÁΩÆ&quot;"></a></h2>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tidb01-41 tidb-ansible]$ pwd</span></span>
<span class="line"><span>/home/tidb/soft/tidb-ansible</span></span>
<span class="line"><span>[tidb@tidb01-41 tidb-ansible]$ vi conf/tidb.yml </span></span>
<span class="line"><span></span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>log:</span></span>
<span class="line"><span>  # Log level: debug, info, warn, error, fatal.</span></span>
<span class="line"><span>  # level: "info"</span></span>
<span class="line"><span>  level: "debug"</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>......</span></span></code></pre>
</div><h2 id="‰∏≠ÊéßÊú∫ÊâßË°årolling-updateÊªöÂä®Êõ¥Êñ∞" tabindex="-1">‰∏≠ÊéßÊú∫ÊâßË°årolling-updateÊªöÂä®Êõ¥Êñ∞ <a class="header-anchor" href="#‰∏≠ÊéßÊú∫ÊâßË°årolling-updateÊªöÂä®Êõ¥Êñ∞" aria-label="Permalink to &quot;‰∏≠ÊéßÊú∫ÊâßË°årolling-updateÊªöÂä®Êõ¥Êñ∞&quot;"></a></h2>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tidb01-41 soft]$ cd tidb-ansible/</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tidb01-41 tidb-ansible]$ ansible-playbook rolling_update.yml --tags</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">tidb</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">PLAY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [check </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> locally]</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> *********************************************************************************************************************************</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">PLAY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> RECAP</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> **************************************************************************************************************************************************</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">192.168.1.41</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">               :</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ok=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">34</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   changed=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">6</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    unreachable=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    failed=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">192.168.1.42</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">               :</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ok=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">8</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    changed=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    unreachable=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    failed=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">192.168.1.43</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">               :</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ok=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">33</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   changed=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">6</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    unreachable=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    failed=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">localhost</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                  :</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ok=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    changed=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    unreachable=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    failed=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Congrats!</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> All</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> goes</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> well.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> :-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span></code></pre>
</div><h2 id="tikv‰ªªÊÑèÂ≠êËäÇÁÇπÈÉ®ÁΩ≤ÁõÆÂΩïÊ£ÄÊü•ÈÖçÁΩÆ" tabindex="-1">TiKV‰ªªÊÑèÂ≠êËäÇÁÇπÈÉ®ÁΩ≤ÁõÆÂΩïÊ£ÄÊü•ÈÖçÁΩÆ <a class="header-anchor" href="#tikv‰ªªÊÑèÂ≠êËäÇÁÇπÈÉ®ÁΩ≤ÁõÆÂΩïÊ£ÄÊü•ÈÖçÁΩÆ" aria-label="Permalink to &quot;TiKV‰ªªÊÑèÂ≠êËäÇÁÇπÈÉ®ÁΩ≤ÁõÆÂΩïÊ£ÄÊü•ÈÖçÁΩÆ&quot;"></a></h2>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[root@tidb03-43 deploy]# ip addr |grep ens33</span></span>
<span class="line"><span>2: ens33: &#x3C;BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UP group default qlen 1000</span></span>
<span class="line"><span>    inet 192.168.1.43/24 brd 192.168.1.255 scope global noprefixroute ens33</span></span>
<span class="line"><span>[root@tidb03-43 deploy]# pwd</span></span>
<span class="line"><span>/data/tidb/deploy</span></span>
<span class="line"><span>[root@tidb03-43 deploy]# cat conf/tidb.toml |grep debug</span></span>
<span class="line"><span>level = "debug"</span></span></code></pre>
</div>]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[TiDB-TiUPÂ∑•ÂÖ∑ÈõÜÁæ§Á¶ªÁ∫øÈÉ®ÁΩ≤ÊñπÊ°à]]></title>
            <link>https://askaric.com/zh/work/tidb/02TIDB-ÈÉ®ÁΩ≤ÂÆûË∑µ/2-2TiUP ÈÉ®ÁΩ≤ÂÆûË∑µ/01TiUP Á¶ªÁ∫øÈÉ®ÁΩ≤ TiDB.html</link>
            <guid>https://askaric.com/zh/work/tidb/02TIDB-ÈÉ®ÁΩ≤ÂÆûË∑µ/2-2TiUP ÈÉ®ÁΩ≤ÂÆûË∑µ/01TiUP Á¶ªÁ∫øÈÉ®ÁΩ≤ TiDB.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[# TiDB-TiUPÂ∑•ÂÖ∑ÈõÜÁæ§Á¶ªÁ∫øÈÉ®ÁΩ≤ÊñπÊ°à
Êó∂Èó¥Ôºö2020-12-25

> - [‰∏ãËΩΩTiUPÁ¶ªÁ∫øÁªÑ‰ª∂](#‰∏ãËΩΩTiUPÁ¶ªÁ∫øÁªÑ‰ª∂)  
> - [TiKVÊï∞ÊçÆÁõòÊåÇËΩΩ](#‰∏ãËΩΩTiUPÁ¶ªÁ∫øÁªÑ‰ª∂)  
> - [ÈÖçÁΩÆtopologyÈÖçÁΩÆÊñá‰ª∂](#ÈÖçÁΩÆtopologyÈÖçÁΩÆÊñá‰ª∂)  
> - [ÈÉ®ÁΩ≤TiDBÈõÜÁæ§](#ÈÉ®ÁΩ≤TiDBÈõÜÁæ§)  
> - [Ê£ÄÊü•ÈõÜÁæ§Áä∂ÊÄÅ](#Ê£ÄÊü•ÈõÜÁæ§Áä∂ÊÄÅ)  
> - [TiUPÂç∏ËΩΩÈõÜÁæ§](#TiUPÂç∏ËΩΩÈõÜÁæ§)  
> - [Â∏∏ËßÅÈîôËØØËß£ÂÜ≥](#Â∏∏ËßÅÈîôËØØËß£ÂÜ≥)  

> **IPËßÑÂàí**

| IPÂú∞ÂùÄ | Role‰ø°ÊÅØ | Â§áÊ≥® |
|-|-|-|
| 192.168.169.41 | pd+tikv+tidb+cdc | ÈÉ®ÁΩ≤TiUP‰∏ªÊú∫ |
| 192.168.169.42 | pd+tikv+tidb+cdc+prometheus+grafana+alertmanager |  |
| 192.168.169.43 | pd+tikv+tidb+cdc |  |
| 192.168.169.44 | tiflash |  |



## ‰∏ãËΩΩTiUPÁ¶ªÁ∫øÁªÑ‰ª∂

```
[root@tiup-tidb41 ~]# useradd tidb

[root@tiup-tidb41 ~]# passwd tidb

[root@tidb-tidb41 ~]# visudo

[root@tidb-tidb41 ~]# tail -1 /etc/sudoers
tidb ALL=(ALL) NOPASSWD: ALL

[root@tiup-tidb41 ~]# su - tidb

[tidb@tiup-tidb44 ~]$ curl --proto '=https' --tlsv1.2 -sSf https://tiup-mirrors.pingcap.com/install.sh | sh
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
 23 8697k   23 2015k    0     0   303k      0  0:00:28  0:00:06  0:00:22  417k
```

```shell
# ${version} ÊõøÊç¢‰∏∫ÈúÄË¶Å‰∏ãËΩΩÁöÑÁâàÊú¨ÂêçÁß∞ÔºåÂ¶ÇÔºöv4.0.2„ÄÅv5.0.0-rcÁ≠â
[tidb@tiup-tidb44 ~]$ tiup mirror clone tidb-community-server-${version}-linux-amd64 ${version} --os=linux --arch=amd64

Start to clone mirror, targetDir is tidb-community-server-v4.0.2-linux-amd64, selectedVersions are []
If this does not meet expectations, please abort this process, read `tiup mirror clone --help` and run again
Arch [amd64]
OS [linux]
......
......
download https://tiup-mirrors.pingcap.com/tiup-linux-amd64.tar.gz 8.49 MiB / 8.49 MiB 100.00% 806.71 KiB p/s

[tidb@tiup-tidb44 ~]$ ll
total 0
drwxr-xr-x. 3 tidb tidb 172 Jan  9 11:40 tidb-community-server-v4.0.2-linux-amd64

[tidb@tiup-tidb44 ~]$ cd tidb-community-server-v4.0.2-linux-amd64/

[tidb@tiup-tidb44 tidb-community-server-v4.0.2-linux-amd64]$ ll

[tidb@tiup-tidb44 tidb-community-server-v4.0.2-linux-amd64]$ ./local_install.sh 

[tidb@tiup-tidb44 ~]$ tar -cvf tidb-community-server-v4.0.2-linux-amd64.tar.gz tidb-community-server-v4.0.2-linux-amd64

[tidb@tiup-tidb44 ~]$ ll -lrth
total 1.5G
drwxr-xr-x. 3 tidb tidb 4.0K Jan  9 00:26 tidb-community-server-v4.0.2-linux-amd64
-rw-rw-r--. 1 tidb tidb 1.5G Jan  9 00:28 tidb-community-server-v4.0.2-linux-amd64.tar.gz

[tidb@tiup-tidb44 ~]$ scp tidb-community-server-v4.0.2-linux-amd64.tar.gz 192.168.169.41:/home/tidb/
Warning: Permanently added '192.168.169.41' (ECDSA) to the list of known hosts.
tidb@192.168.169.41's password: 
tidb-community-server-v4.0.2-linux-amd64.tar.gz                                                                                                                                  56%  869MB 129.1MB/s   00:05 ETA

[tidb@tiup-tidb41 ~]$ tar -xvf tidb-community-server-v4.0.2-linux-amd64.tar.gz 
tidb-community-server-v4.0.2-linux-amd64/
......
......
tidb-community-server-v4.0.2-linux-amd64/local_install.sh

[tidb@tiup-tidb41 ~]$ ll -lrth
total 1.5G
drwxr-xr-x. 3 tidb tidb 4.0K Jan  9 00:26 tidb-community-server-v4.0.2-linux-amd64
-rw-rw-r--. 1 tidb tidb 1.5G Jan  9 00:30 tidb-community-server-v4.0.2-linux-amd64.tar.gz
```

ÂÆâË£ÖÁªÑ‰ª∂
```
[tidb@tiup-tidb41 ~]$ cd tidb-community-server-v4.0.2-linux-amd64

[tidb@tiup-tidb41 tidb-community-server-v4.0.2-linux-amd64]$ ll |grep install
-rwxr-xr-x. 1 tidb tidb      2086 Jan  9 00:26 local_install.sh

[tidb@tiup-tidb41 tidb-community-server-v4.0.2-linux-amd64]$ sh local_install.sh 
Set mirror to /home/tidb/tidb-community-server-v4.0.2-linux-amd64 success
Detected shell: bash
Shell profile:  /home/tidb/.bash_profile
/home/tidb/.bash_profile has been modified to to add tiup to PATH
open a new terminal or source /home/tidb/.bash_profile to use it
Installed path: /home/tidb/.tiup/bin/tiup
===============================================
1. source /home/tidb/.bash_profile
2. Have a try:   tiup playground
===============================================

[tidb@tiup-tidb41 tidb-community-server-v4.0.2-linux-amd64]$ source /home/tidb/.bash_profile
```

## TiKVÊï∞ÊçÆÁõòÊåÇËΩΩ

‰øÆÊîπHHDÁöÑÁ£ÅÁõò
```
[root@tiup-tidb41 ~]# fdisk -l

Disk /dev/sda: 107.4 GB, 107374182400 bytes, 209715200 sectors
Units = sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Disk label type: dos
Disk identifier: 0x000a1f1f

   Device Boot      Start         End      Blocks   Id  System
/dev/sda1   *        2048      391167      194560   83  Linux
/dev/sda2          391168   199628799    99618816   8e  Linux LVM

Disk /dev/sdb: 107.4 GB, 107374182400 bytes, 209715200 sectors
Units = sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes


Disk /dev/mapper/centos-root: 102.0 GB, 102001278976 bytes, 199221248 sectors
Units = sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes

[root@tiup-tidb41 ~]# parted -s -a optimal /dev/sdb mklabel gpt -- mkpart primary ext4 1 -1
[root@tiup-tidb41 ~]# ll /dev/sd*
brw-rw]]></description>
            <content:encoded><![CDATA[<h1 id="tidb-tiupÂ∑•ÂÖ∑ÈõÜÁæ§Á¶ªÁ∫øÈÉ®ÁΩ≤ÊñπÊ°à" tabindex="-1">TiDB-TiUPÂ∑•ÂÖ∑ÈõÜÁæ§Á¶ªÁ∫øÈÉ®ÁΩ≤ÊñπÊ°à <a class="header-anchor" href="#tidb-tiupÂ∑•ÂÖ∑ÈõÜÁæ§Á¶ªÁ∫øÈÉ®ÁΩ≤ÊñπÊ°à" aria-label="Permalink to &quot;TiDB-TiUPÂ∑•ÂÖ∑ÈõÜÁæ§Á¶ªÁ∫øÈÉ®ÁΩ≤ÊñπÊ°à&quot;"></a></h1>
<p>Êó∂Èó¥Ôºö2020-12-25</p>
<blockquote>
<ul>
<li><a href="#‰∏ãËΩΩTiUPÁ¶ªÁ∫øÁªÑ‰ª∂">‰∏ãËΩΩTiUPÁ¶ªÁ∫øÁªÑ‰ª∂</a></li>
<li><a href="#‰∏ãËΩΩTiUPÁ¶ªÁ∫øÁªÑ‰ª∂">TiKVÊï∞ÊçÆÁõòÊåÇËΩΩ</a></li>
<li><a href="#ÈÖçÁΩÆtopologyÈÖçÁΩÆÊñá‰ª∂">ÈÖçÁΩÆtopologyÈÖçÁΩÆÊñá‰ª∂</a></li>
<li><a href="#ÈÉ®ÁΩ≤TiDBÈõÜÁæ§">ÈÉ®ÁΩ≤TiDBÈõÜÁæ§</a></li>
<li><a href="#Ê£ÄÊü•ÈõÜÁæ§Áä∂ÊÄÅ">Ê£ÄÊü•ÈõÜÁæ§Áä∂ÊÄÅ</a></li>
<li><a href="#TiUPÂç∏ËΩΩÈõÜÁæ§">TiUPÂç∏ËΩΩÈõÜÁæ§</a></li>
<li><a href="#Â∏∏ËßÅÈîôËØØËß£ÂÜ≥">Â∏∏ËßÅÈîôËØØËß£ÂÜ≥</a></li>
</ul>
</blockquote>
<blockquote>
<p><strong>IPËßÑÂàí</strong></p>
</blockquote>
<table tabindex="0">
<thead>
<tr>
<th>IPÂú∞ÂùÄ</th>
<th>Role‰ø°ÊÅØ</th>
<th>Â§áÊ≥®</th>
</tr>
</thead>
<tbody>
<tr>
<td>192.168.169.41</td>
<td>pd+tikv+tidb+cdc</td>
<td>ÈÉ®ÁΩ≤TiUP‰∏ªÊú∫</td>
</tr>
<tr>
<td>192.168.169.42</td>
<td>pd+tikv+tidb+cdc+prometheus+grafana+alertmanager</td>
<td></td>
</tr>
<tr>
<td>192.168.169.43</td>
<td>pd+tikv+tidb+cdc</td>
<td></td>
</tr>
<tr>
<td>192.168.169.44</td>
<td>tiflash</td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="‰∏ãËΩΩtiupÁ¶ªÁ∫øÁªÑ‰ª∂" tabindex="-1">‰∏ãËΩΩTiUPÁ¶ªÁ∫øÁªÑ‰ª∂ <a class="header-anchor" href="#‰∏ãËΩΩtiupÁ¶ªÁ∫øÁªÑ‰ª∂" aria-label="Permalink to &quot;‰∏ãËΩΩTiUPÁ¶ªÁ∫øÁªÑ‰ª∂&quot;"></a></h2>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[root@tiup-tidb41 ~]# useradd tidb</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[root@tiup-tidb41 ~]# passwd tidb</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[root@tidb-tidb41 ~]# visudo</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[root@tidb-tidb41 ~]# tail -1 /etc/sudoers</span></span>
<span class="line"><span>tidb ALL=(ALL) NOPASSWD: ALL</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[root@tiup-tidb41 ~]# su - tidb</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[tidb@tiup-tidb44 ~]$ curl --proto '=https' --tlsv1.2 -sSf https://tiup-mirrors.pingcap.com/install.sh | sh</span></span>
<span class="line"><span>  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current</span></span>
<span class="line"><span>                                 Dload  Upload   Total   Spent    Left  Speed</span></span>
<span class="line"><span> 23 8697k   23 2015k    0     0   303k      0  0:00:28  0:00:06  0:00:22  417k</span></span></code></pre>
</div><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># ${version} ÊõøÊç¢‰∏∫ÈúÄË¶Å‰∏ãËΩΩÁöÑÁâàÊú¨ÂêçÁß∞ÔºåÂ¶ÇÔºöv4.0.2„ÄÅv5.0.0-rcÁ≠â</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb44 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ tiup mirror clone tidb-community-server-${version}-linux-amd64 ${version} --os</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">linux</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> --arch</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">amd64</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> clone</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mirror,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> targetDir</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-community-server-v4.0.2-linux-amd64,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> selectedVersions</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> are</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> []</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">If</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> this</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> does</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> not</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> meet</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> expectations,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> please</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> abort</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> this</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> process,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> read</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tiup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mirror clone </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">--help</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> and</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> again</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Arch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [amd64]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">OS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [linux]</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">download</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> https://tiup-mirrors.pingcap.com/tiup-linux-amd64.tar.gz</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 8.49</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> MiB</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 8.49</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> MiB</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 100.00%</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 806.71</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> KiB</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> p/s</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb44 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ ll</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">total</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">drwxr-xr-x.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 3</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 172</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Jan</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  9</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 11:40</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-community-server-v4.0.2-linux-amd64</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb44 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ cd tidb-community-server-v4.0.2-linux-amd64/</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb44 tidb-community-server-v4.0.2-linux-amd64]$ ll</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb44 tidb-community-server-v4.0.2-linux-amd64]$ ./local_install.sh </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb44 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ tar -cvf tidb-community-server-v4.0.2-linux-amd64.tar.gz tidb-community-server-v4.0.2-linux-amd64</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb44 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ ll -lrth</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">total</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 1.5G</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">drwxr-xr-x.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 3</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 4.0K</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Jan</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  9</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 00:26</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-community-server-v4.0.2-linux-amd64</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">-rw-rw-r--.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 1.5G</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Jan</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  9</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 00:28</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-community-server-v4.0.2-linux-amd64.tar.gz</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb44 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ scp tidb-community-server-v4.0.2-linux-amd64.tar.gz 192.168.169.41:/home/tidb/</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Warning:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Permanently</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> added</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> '192.168.169.41'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (ECDSA) to the list of known hosts.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tidb@192.168.169.41</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">'s password: </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tidb-community-server-v4.0.2-linux-amd64.tar.gz                                                                                                                                  56%  869MB 129.1MB/s   00:05 ETA</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">[tidb@tiup-tidb41 ~]$ tar -xvf tidb-community-server-v4.0.2-linux-amd64.tar.gz </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tidb-community-server-v4.0.2-linux-amd64/</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">......</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">......</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tidb-community-server-v4.0.2-linux-amd64/local_install.sh</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">[tidb@tiup-tidb41 ~]$ ll -lrth</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">total 1.5G</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">drwxr-xr-x. 3 tidb tidb 4.0K Jan  9 00:26 tidb-community-server-v4.0.2-linux-amd64</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">-rw-rw-r--. 1 tidb tidb 1.5G Jan  9 00:30 tidb-community-server-v4.0.2-linux-amd64.tar.gz</span></span></code></pre>
</div><p>ÂÆâË£ÖÁªÑ‰ª∂</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tiup-tidb41 ~]$ cd tidb-community-server-v4.0.2-linux-amd64</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[tidb@tiup-tidb41 tidb-community-server-v4.0.2-linux-amd64]$ ll |grep install</span></span>
<span class="line"><span>-rwxr-xr-x. 1 tidb tidb      2086 Jan  9 00:26 local_install.sh</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[tidb@tiup-tidb41 tidb-community-server-v4.0.2-linux-amd64]$ sh local_install.sh </span></span>
<span class="line"><span>Set mirror to /home/tidb/tidb-community-server-v4.0.2-linux-amd64 success</span></span>
<span class="line"><span>Detected shell: bash</span></span>
<span class="line"><span>Shell profile:  /home/tidb/.bash_profile</span></span>
<span class="line"><span>/home/tidb/.bash_profile has been modified to to add tiup to PATH</span></span>
<span class="line"><span>open a new terminal or source /home/tidb/.bash_profile to use it</span></span>
<span class="line"><span>Installed path: /home/tidb/.tiup/bin/tiup</span></span>
<span class="line"><span>===============================================</span></span>
<span class="line"><span>1. source /home/tidb/.bash_profile</span></span>
<span class="line"><span>2. Have a try:   tiup playground</span></span>
<span class="line"><span>===============================================</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[tidb@tiup-tidb41 tidb-community-server-v4.0.2-linux-amd64]$ source /home/tidb/.bash_profile</span></span></code></pre>
</div><h2 id="tikvÊï∞ÊçÆÁõòÊåÇËΩΩ" tabindex="-1">TiKVÊï∞ÊçÆÁõòÊåÇËΩΩ <a class="header-anchor" href="#tikvÊï∞ÊçÆÁõòÊåÇËΩΩ" aria-label="Permalink to &quot;TiKVÊï∞ÊçÆÁõòÊåÇËΩΩ&quot;"></a></h2>
<p>‰øÆÊîπHHDÁöÑÁ£ÅÁõò</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[root@tiup-tidb41 ~]# fdisk -l</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Disk /dev/sda: 107.4 GB, 107374182400 bytes, 209715200 sectors</span></span>
<span class="line"><span>Units = sectors of 1 * 512 = 512 bytes</span></span>
<span class="line"><span>Sector size (logical/physical): 512 bytes / 512 bytes</span></span>
<span class="line"><span>I/O size (minimum/optimal): 512 bytes / 512 bytes</span></span>
<span class="line"><span>Disk label type: dos</span></span>
<span class="line"><span>Disk identifier: 0x000a1f1f</span></span>
<span class="line"><span></span></span>
<span class="line"><span>   Device Boot      Start         End      Blocks   Id  System</span></span>
<span class="line"><span>/dev/sda1   *        2048      391167      194560   83  Linux</span></span>
<span class="line"><span>/dev/sda2          391168   199628799    99618816   8e  Linux LVM</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Disk /dev/sdb: 107.4 GB, 107374182400 bytes, 209715200 sectors</span></span>
<span class="line"><span>Units = sectors of 1 * 512 = 512 bytes</span></span>
<span class="line"><span>Sector size (logical/physical): 512 bytes / 512 bytes</span></span>
<span class="line"><span>I/O size (minimum/optimal): 512 bytes / 512 bytes</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>Disk /dev/mapper/centos-root: 102.0 GB, 102001278976 bytes, 199221248 sectors</span></span>
<span class="line"><span>Units = sectors of 1 * 512 = 512 bytes</span></span>
<span class="line"><span>Sector size (logical/physical): 512 bytes / 512 bytes</span></span>
<span class="line"><span>I/O size (minimum/optimal): 512 bytes / 512 bytes</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[root@tiup-tidb41 ~]# parted -s -a optimal /dev/sdb mklabel gpt -- mkpart primary ext4 1 -1</span></span>
<span class="line"><span>[root@tiup-tidb41 ~]# ll /dev/sd*</span></span>
<span class="line"><span>brw-rw----. 1 root disk 8,  0 Jan  8 23:29 /dev/sda</span></span>
<span class="line"><span>brw-rw----. 1 root disk 8,  1 Jan  8 23:29 /dev/sda1</span></span>
<span class="line"><span>brw-rw----. 1 root disk 8,  2 Jan  8 23:29 /dev/sda2</span></span>
<span class="line"><span>brw-rw----. 1 root disk 8, 16 Jan  8 23:46 /dev/sdb</span></span>
<span class="line"><span>brw-rw----. 1 root disk 8, 17 Jan  8 23:46 /dev/sdb1</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[root@tiup-tidb41 ~]# mkfs.ext4 /dev/sdb1 </span></span>
<span class="line"><span>mke2fs 1.42.9 (28-Dec-2013)</span></span>
<span class="line"><span>Filesystem label=</span></span>
<span class="line"><span>OS type: Linux</span></span>
<span class="line"><span>Block size=4096 (log=2)</span></span>
<span class="line"><span>Fragment size=4096 (log=2)</span></span>
<span class="line"><span>Stride=0 blocks, Stripe width=0 blocks</span></span>
<span class="line"><span>6553600 inodes, 26213888 blocks</span></span>
<span class="line"><span>1310694 blocks (5.00%) reserved for the super user</span></span>
<span class="line"><span>First data block=0</span></span>
<span class="line"><span>Maximum filesystem blocks=2174746624</span></span>
<span class="line"><span>800 block groups</span></span>
<span class="line"><span>32768 blocks per group, 32768 fragments per group</span></span>
<span class="line"><span>8192 inodes per group</span></span>
<span class="line"><span>Superblock backups stored on blocks: </span></span>
<span class="line"><span>	32768, 98304, 163840, 229376, 294912, 819200, 884736, 1605632, 2654208, </span></span>
<span class="line"><span>	4096000, 7962624, 11239424, 20480000, 23887872</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Allocating group tables: done                            </span></span>
<span class="line"><span>Writing inode tables: done                            </span></span>
<span class="line"><span>Creating journal (32768 blocks): done</span></span>
<span class="line"><span>Writing superblocks and filesystem accounting information: done   </span></span>
<span class="line"><span></span></span>
<span class="line"><span>[root@tiup-tidb41 ~]# lsblk -f</span></span>
<span class="line"><span>NAME            FSTYPE      LABEL UUID                                   MOUNTPOINT</span></span>
<span class="line"><span>sda                                                                      </span></span>
<span class="line"><span>‚îú‚îÄsda1          xfs               f5186353-9452-4395-9549-0e0f05401910   /boot</span></span>
<span class="line"><span>‚îî‚îÄsda2          LVM2_member       QjWT3C-PmGV-bIBK-kjxs-zGGE-xnLB-Kqyewx </span></span>
<span class="line"><span>  ‚îî‚îÄcentos-root xfs               1c8f5bee-8e88-44d7-99c0-c5d8b1d621bb   /</span></span>
<span class="line"><span>sdb                                                                      </span></span>
<span class="line"><span>‚îî‚îÄsdb1          ext4              003d05ff-6e97-49ec-abf4-b86be07754b8   </span></span>
<span class="line"><span>sr0                                                                      </span></span>
<span class="line"><span></span></span>
<span class="line"><span>[root@tiup-tidb41 ~]# vi /etc/fstab </span></span>
<span class="line"><span></span></span>
<span class="line"><span>[root@tiup-tidb41 ~]# tail -1 /etc/fstab </span></span>
<span class="line"><span>UUID=003d05ff-6e97-49ec-abf4-b86be07754b8 /data ext4    defaults,nodelalloc,noatime       0 2</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[root@tiup-tidb41 ~]# mkdir /data</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[root@tiup-tidb41 ~]# mount -a</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[root@tiup-tidb41 ~]# mount -t ext4</span></span>
<span class="line"><span>/dev/sdb1 on /data type ext4 (rw,noatime,seclabel,nodelalloc,data=ordered)</span></span></code></pre>
</div><h2 id="ÈÖçÁΩÆtopologyÈÖçÁΩÆÊñá‰ª∂" tabindex="-1">ÈÖçÁΩÆtopologyÈÖçÁΩÆÊñá‰ª∂ <a class="header-anchor" href="#ÈÖçÁΩÆtopologyÈÖçÁΩÆÊñá‰ª∂" aria-label="Permalink to &quot;ÈÖçÁΩÆtopologyÈÖçÁΩÆÊñá‰ª∂&quot;"></a></h2>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tiup-tidb41 tidb-community-server-v4.0.2-linux-amd64]$ vi topology.yaml</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[tidb@tiup-tidb41 tidb-community-server-v4.0.2-linux-amd64]$ cat topology.yaml</span></span>
<span class="line"><span># # Global variables are applied to all deployments and used as the default value of</span></span>
<span class="line"><span># # the deployments if a specific deployment value is missing.</span></span>
<span class="line"><span>global:</span></span>
<span class="line"><span>  user: "tidb"</span></span>
<span class="line"><span>  ssh_port: 22</span></span>
<span class="line"><span>  deploy_dir: "/data/tidb-deploy"</span></span>
<span class="line"><span>  data_dir: "/data/tidb-data"</span></span>
<span class="line"><span></span></span>
<span class="line"><span>server_configs:</span></span>
<span class="line"><span>  pd:</span></span>
<span class="line"><span>    replication.enable-placement-rules: true</span></span>
<span class="line"><span></span></span>
<span class="line"><span>pd_servers:</span></span>
<span class="line"><span>  - host: 192.168.169.41</span></span>
<span class="line"><span>  - host: 192.168.169.42</span></span>
<span class="line"><span>  - host: 192.168.169.43</span></span>
<span class="line"><span>tidb_servers:</span></span>
<span class="line"><span>  - host: 192.168.169.41</span></span>
<span class="line"><span>  - host: 192.168.169.42</span></span>
<span class="line"><span>  - host: 192.168.169.43</span></span>
<span class="line"><span>tikv_servers:</span></span>
<span class="line"><span>  - host: 192.168.169.41</span></span>
<span class="line"><span>  - host: 192.168.169.42</span></span>
<span class="line"><span>  - host: 192.168.169.43</span></span>
<span class="line"><span>tiflash_servers:</span></span>
<span class="line"><span>  - host: 192.168.169.43</span></span>
<span class="line"><span>    data_dir: /data/tiflash1/data,/data/tiflash2/data</span></span>
<span class="line"><span>cdc_servers:</span></span>
<span class="line"><span>  - host: 192.168.169.41</span></span>
<span class="line"><span>  - host: 192.168.169.42</span></span>
<span class="line"><span>  - host: 192.168.169.43</span></span>
<span class="line"><span>monitoring_servers:</span></span>
<span class="line"><span>  - host: 192.168.169.42</span></span>
<span class="line"><span>grafana_servers:</span></span>
<span class="line"><span>  - host: 192.168.169.42</span></span>
<span class="line"><span>alertmanager_servers:</span></span>
<span class="line"><span>  - host: 192.168.169.42</span></span></code></pre>
</div><h2 id="ÈÉ®ÁΩ≤tidbÈõÜÁæ§" tabindex="-1">ÈÉ®ÁΩ≤TiDBÈõÜÁæ§ <a class="header-anchor" href="#ÈÉ®ÁΩ≤tidbÈõÜÁæ§" aria-label="Permalink to &quot;ÈÉ®ÁΩ≤TiDBÈõÜÁæ§&quot;"></a></h2>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tiup-tidb41 tidb-community-server-v4.0.2-linux-amd64]$ pwd</span></span>
<span class="line"><span>/home/tidb/tidb-community-server-v4.0.2-linux-amd64</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[tidb@tiup-tidb41 tidb-community-server-v4.0.2-linux-amd64]$ export TIUP_MIRRORS=/home/tidb/tidb-community-server-v4.0.2-linux-amd64</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[tidb@tiup-tidb41 tidb-community-server-v4.0.2-linux-amd64]$ tiup cluster deploy tidb-test v4.0.2 topology.yaml --user root -p </span></span>
<span class="line"><span>Starting component `cluster`: /home/tidb/.tiup/components/cluster/v1.3.1/tiup-cluster deploy tidb-test v4.0.2 topology.yaml --user root -p</span></span>
<span class="line"><span>Please confirm your topology:</span></span>
<span class="line"><span>Cluster type:    tidb</span></span>
<span class="line"><span>Cluster name:    tidb-test</span></span>
<span class="line"><span>Cluster version: v4.0.2</span></span>
<span class="line"><span>Type          Host            Ports                            OS/Arch       Directories</span></span>
<span class="line"><span>----          ----            -----                            -------       -----------</span></span>
<span class="line"><span>pd            192.168.169.41  2379/2380                        linux/x86_64  /data/tidb-deploy/pd-2379,/data/tidb-data/pd-2379</span></span>
<span class="line"><span>pd            192.168.169.42  2379/2380                        linux/x86_64  /data/tidb-deploy/pd-2379,/data/tidb-data/pd-2379</span></span>
<span class="line"><span>pd            192.168.169.43  2379/2380                        linux/x86_64  /data/tidb-deploy/pd-2379,/data/tidb-data/pd-2379</span></span>
<span class="line"><span>tikv          192.168.169.41  20160/20180                      linux/x86_64  /data/tidb-deploy/tikv-20160,/data/tidb-data/tikv-20160</span></span>
<span class="line"><span>tikv          192.168.169.42  20160/20180                      linux/x86_64  /data/tidb-deploy/tikv-20160,/data/tidb-data/tikv-20160</span></span>
<span class="line"><span>tikv          192.168.169.43  20160/20180                      linux/x86_64  /data/tidb-deploy/tikv-20160,/data/tidb-data/tikv-20160</span></span>
<span class="line"><span>tidb          192.168.169.41  4000/10080                       linux/x86_64  /data/tidb-deploy/tidb-4000</span></span>
<span class="line"><span>tidb          192.168.169.42  4000/10080                       linux/x86_64  /data/tidb-deploy/tidb-4000</span></span>
<span class="line"><span>tidb          192.168.169.43  4000/10080                       linux/x86_64  /data/tidb-deploy/tidb-4000</span></span>
<span class="line"><span>tiflash       192.168.169.43  9000/8123/3930/20170/20292/8234  linux/x86_64  /data/tidb-deploy/tiflash-9000,/data/tiflash1/data,/data/tiflash2/data</span></span>
<span class="line"><span>cdc           192.168.169.41  8300                             linux/x86_64  /data/tidb-deploy/cdc-8300</span></span>
<span class="line"><span>cdc           192.168.169.42  8300                             linux/x86_64  /data/tidb-deploy/cdc-8300</span></span>
<span class="line"><span>cdc           192.168.169.43  8300                             linux/x86_64  /data/tidb-deploy/cdc-8300</span></span>
<span class="line"><span>prometheus    192.168.169.42  9090                             linux/x86_64  /data/tidb-deploy/prometheus-9090,/data/tidb-data/prometheus-9090</span></span>
<span class="line"><span>grafana       192.168.169.42  3000                             linux/x86_64  /data/tidb-deploy/grafana-3000</span></span>
<span class="line"><span>alertmanager  192.168.169.42  9093/9094                        linux/x86_64  /data/tidb-deploy/alertmanager-9093,/data/tidb-data/alertmanager-9093</span></span>
<span class="line"><span>Attention:</span></span>
<span class="line"><span>    1. If the topology is not what you expected, check your yaml file.</span></span>
<span class="line"><span>    2. Please confirm there is no port/directory conflicts in same host.</span></span>
<span class="line"><span>Do you want to continue? [y/N]:  y</span></span>
<span class="line"><span>Input SSH password: </span></span>
<span class="line"><span>+ Generate SSH keys ... Done</span></span>
<span class="line"><span>+ Download TiDB components</span></span>
<span class="line"><span>  - Download pd:v4.0.2 (linux/amd64) ... Done</span></span>
<span class="line"><span>  - Download tikv:v4.0.2 (linux/amd64) ... Done</span></span>
<span class="line"><span>  - Download tidb:v4.0.2 (linux/amd64) ... Done</span></span>
<span class="line"><span>  - Download tiflash:v4.0.2 (linux/amd64) ... Done</span></span>
<span class="line"><span>  - Download cdc:v4.0.2 (linux/amd64) ... Done</span></span>
<span class="line"><span>  - Download prometheus:v4.0.2 (linux/amd64) ... Done</span></span>
<span class="line"><span>  - Download grafana:v4.0.2 (linux/amd64) ... Done</span></span>
<span class="line"><span>  - Download alertmanager:v0.17.0 (linux/amd64) ... Done</span></span>
<span class="line"><span>  - Download node_exporter:v0.17.0 (linux/amd64) ... Done</span></span>
<span class="line"><span>  - Download blackbox_exporter:v0.12.0 (linux/amd64) ... Done</span></span>
<span class="line"><span>+ Initialize target host environments</span></span>
<span class="line"><span>  - Prepare 192.168.169.41:22 ... Done</span></span>
<span class="line"><span>  - Prepare 192.168.169.42:22 ... Done</span></span>
<span class="line"><span>  - Prepare 192.168.169.43:22 ... Done</span></span>
<span class="line"><span>+ Copy files</span></span>
<span class="line"><span>  - Copy pd -> 192.168.169.41 ... Done</span></span>
<span class="line"><span>  - Copy pd -> 192.168.169.42 ... Done</span></span>
<span class="line"><span>  - Copy pd -> 192.168.169.43 ... Done</span></span>
<span class="line"><span>  - Copy tikv -> 192.168.169.41 ... Done</span></span>
<span class="line"><span>  - Copy tikv -> 192.168.169.42 ... Done</span></span>
<span class="line"><span>  - Copy tikv -> 192.168.169.43 ... Done</span></span>
<span class="line"><span>  - Copy tidb -> 192.168.169.41 ... Done</span></span>
<span class="line"><span>  - Copy tidb -> 192.168.169.42 ... Done</span></span>
<span class="line"><span>  - Copy tidb -> 192.168.169.43 ... Done</span></span>
<span class="line"><span>  - Copy tiflash -> 192.168.169.43 ... Done</span></span>
<span class="line"><span>  - Copy cdc -> 192.168.169.41 ... Done</span></span>
<span class="line"><span>  - Copy cdc -> 192.168.169.42 ... Done</span></span>
<span class="line"><span>  - Copy cdc -> 192.168.169.43 ... Done</span></span>
<span class="line"><span>  - Copy prometheus -> 192.168.169.42 ... Done</span></span>
<span class="line"><span>  - Copy grafana -> 192.168.169.42 ... Done</span></span>
<span class="line"><span>  - Copy alertmanager -> 192.168.169.42 ... Done</span></span>
<span class="line"><span>  - Copy node_exporter -> 192.168.169.41 ... Done</span></span>
<span class="line"><span>  - Copy node_exporter -> 192.168.169.42 ... Done</span></span>
<span class="line"><span>  - Copy node_exporter -> 192.168.169.43 ... Done</span></span>
<span class="line"><span>  - Copy blackbox_exporter -> 192.168.169.42 ... Done</span></span>
<span class="line"><span>  - Copy blackbox_exporter -> 192.168.169.43 ... Done</span></span>
<span class="line"><span>  - Copy blackbox_exporter -> 192.168.169.41 ... Done</span></span>
<span class="line"><span>+ Check status</span></span>
<span class="line"><span>Enabling component pd</span></span>
<span class="line"><span>	Enabling instance pd 192.168.169.43:2379</span></span>
<span class="line"><span>	Enabling instance pd 192.168.169.41:2379</span></span>
<span class="line"><span>	Enabling instance pd 192.168.169.42:2379</span></span>
<span class="line"><span>	Enable pd 192.168.169.42:2379 success</span></span>
<span class="line"><span>	Enable pd 192.168.169.43:2379 success</span></span>
<span class="line"><span>	Enable pd 192.168.169.41:2379 success</span></span>
<span class="line"><span>Enabling component node_exporter</span></span>
<span class="line"><span>Enabling component blackbox_exporter</span></span>
<span class="line"><span>Enabling component node_exporter</span></span>
<span class="line"><span>Enabling component blackbox_exporter</span></span>
<span class="line"><span>Enabling component node_exporter</span></span>
<span class="line"><span>Enabling component blackbox_exporter</span></span>
<span class="line"><span>Enabling component tikv</span></span>
<span class="line"><span>	Enabling instance tikv 192.168.169.43:20160</span></span>
<span class="line"><span>	Enabling instance tikv 192.168.169.41:20160</span></span>
<span class="line"><span>	Enabling instance tikv 192.168.169.42:20160</span></span>
<span class="line"><span>	Enable tikv 192.168.169.42:20160 success</span></span>
<span class="line"><span>	Enable tikv 192.168.169.43:20160 success</span></span>
<span class="line"><span>	Enable tikv 192.168.169.41:20160 success</span></span>
<span class="line"><span>Enabling component tidb</span></span>
<span class="line"><span>	Enabling instance tidb 192.168.169.43:4000</span></span>
<span class="line"><span>	Enabling instance tidb 192.168.169.41:4000</span></span>
<span class="line"><span>	Enabling instance tidb 192.168.169.42:4000</span></span>
<span class="line"><span>	Enable tidb 192.168.169.43:4000 success</span></span>
<span class="line"><span>	Enable tidb 192.168.169.42:4000 success</span></span>
<span class="line"><span>	Enable tidb 192.168.169.41:4000 success</span></span>
<span class="line"><span>Enabling component tiflash</span></span>
<span class="line"><span>	Enabling instance tiflash 192.168.169.43:9000</span></span>
<span class="line"><span>	Enable tiflash 192.168.169.43:9000 success</span></span>
<span class="line"><span>Enabling component cdc</span></span>
<span class="line"><span>	Enabling instance cdc 192.168.169.43:8300</span></span>
<span class="line"><span>	Enabling instance cdc 192.168.169.41:8300</span></span>
<span class="line"><span>	Enabling instance cdc 192.168.169.42:8300</span></span>
<span class="line"><span>	Enable cdc 192.168.169.43:8300 success</span></span>
<span class="line"><span>	Enable cdc 192.168.169.42:8300 success</span></span>
<span class="line"><span>	Enable cdc 192.168.169.41:8300 success</span></span>
<span class="line"><span>Enabling component prometheus</span></span>
<span class="line"><span>	Enabling instance prometheus 192.168.169.42:9090</span></span>
<span class="line"><span>	Enable prometheus 192.168.169.42:9090 success</span></span>
<span class="line"><span>Enabling component grafana</span></span>
<span class="line"><span>	Enabling instance grafana 192.168.169.42:3000</span></span>
<span class="line"><span>	Enable grafana 192.168.169.42:3000 success</span></span>
<span class="line"><span>Enabling component alertmanager</span></span>
<span class="line"><span>	Enabling instance alertmanager 192.168.169.42:9093</span></span>
<span class="line"><span>	Enable alertmanager 192.168.169.42:9093 success</span></span>
<span class="line"><span>Cluster `tidb-test` deployed successfully, you can start it with command: `tiup cluster start tidb-test`</span></span></code></pre>
</div><h2 id="ÂêØÂä®tidbÈõÜÁæ§" tabindex="-1">ÂêØÂä®TiDBÈõÜÁæ§ <a class="header-anchor" href="#ÂêØÂä®tidbÈõÜÁæ§" aria-label="Permalink to &quot;ÂêØÂä®TiDBÈõÜÁæ§&quot;"></a></h2>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tiup-tidb41 tidb-community-server-v4.0.2-linux-amd64]$ tiup cluster start tidb-test</span></span>
<span class="line"><span>Starting component `cluster`: /home/tidb/.tiup/components/cluster/v1.3.1/tiup-cluster start tidb-test</span></span>
<span class="line"><span>Starting cluster tidb-test...</span></span>
<span class="line"><span>+ [ Serial ] - SSHKeySet: privateKey=/home/tidb/.tiup/storage/cluster/clusters/tidb-test/ssh/id_rsa, publicKey=/home/tidb/.tiup/storage/cluster/clusters/tidb-test/ssh/id_rsa.pub</span></span>
<span class="line"><span>+ [Parallel] - UserSSH: user=tidb, host=192.168.169.42</span></span>
<span class="line"><span>+ [Parallel] - UserSSH: user=tidb, host=192.168.169.41</span></span>
<span class="line"><span>+ [Parallel] - UserSSH: user=tidb, host=192.168.169.42</span></span>
<span class="line"><span>+ [Parallel] - UserSSH: user=tidb, host=192.168.169.43</span></span>
<span class="line"><span>+ [Parallel] - UserSSH: user=tidb, host=192.168.169.41</span></span>
<span class="line"><span>+ [Parallel] - UserSSH: user=tidb, host=192.168.169.42</span></span>
<span class="line"><span>+ [Parallel] - UserSSH: user=tidb, host=192.168.169.43</span></span>
<span class="line"><span>+ [Parallel] - UserSSH: user=tidb, host=192.168.169.41</span></span>
<span class="line"><span>+ [Parallel] - UserSSH: user=tidb, host=192.168.169.42</span></span>
<span class="line"><span>+ [Parallel] - UserSSH: user=tidb, host=192.168.169.41</span></span>
<span class="line"><span>+ [Parallel] - UserSSH: user=tidb, host=192.168.169.42</span></span>
<span class="line"><span>+ [Parallel] - UserSSH: user=tidb, host=192.168.169.43</span></span>
<span class="line"><span>+ [Parallel] - UserSSH: user=tidb, host=192.168.169.43</span></span>
<span class="line"><span>+ [Parallel] - UserSSH: user=tidb, host=192.168.169.43</span></span>
<span class="line"><span>+ [Parallel] - UserSSH: user=tidb, host=192.168.169.42</span></span>
<span class="line"><span>+ [Parallel] - UserSSH: user=tidb, host=192.168.169.42</span></span>
<span class="line"><span>+ [ Serial ] - StartCluster</span></span>
<span class="line"><span>Starting component pd</span></span>
<span class="line"><span>	Starting instance pd 192.168.169.43:2379</span></span>
<span class="line"><span>	Starting instance pd 192.168.169.42:2379</span></span>
<span class="line"><span>	Starting instance pd 192.168.169.41:2379</span></span>
<span class="line"><span>	Start pd 192.168.169.43:2379 success</span></span>
<span class="line"><span>	Start pd 192.168.169.42:2379 success</span></span>
<span class="line"><span>	Start pd 192.168.169.41:2379 success</span></span>
<span class="line"><span>Starting component node_exporter</span></span>
<span class="line"><span>	Starting instance 192.168.169.41</span></span>
<span class="line"><span>	Start 192.168.169.41 success</span></span>
<span class="line"><span>Starting component blackbox_exporter</span></span>
<span class="line"><span>	Starting instance 192.168.169.41</span></span>
<span class="line"><span>	Start 192.168.169.41 success</span></span>
<span class="line"><span>Starting component node_exporter</span></span>
<span class="line"><span>	Starting instance 192.168.169.42</span></span>
<span class="line"><span>	Start 192.168.169.42 success</span></span>
<span class="line"><span>Starting component blackbox_exporter</span></span>
<span class="line"><span>	Starting instance 192.168.169.42</span></span>
<span class="line"><span>	Start 192.168.169.42 success</span></span>
<span class="line"><span>Starting component node_exporter</span></span>
<span class="line"><span>	Starting instance 192.168.169.43</span></span>
<span class="line"><span>	Start 192.168.169.43 success</span></span>
<span class="line"><span>Starting component blackbox_exporter</span></span>
<span class="line"><span>	Starting instance 192.168.169.43</span></span>
<span class="line"><span>	Start 192.168.169.43 success</span></span>
<span class="line"><span>Starting component tikv</span></span>
<span class="line"><span>	Starting instance tikv 192.168.169.43:20160</span></span>
<span class="line"><span>	Starting instance tikv 192.168.169.41:20160</span></span>
<span class="line"><span>	Starting instance tikv 192.168.169.42:20160</span></span>
<span class="line"><span>	Start tikv 192.168.169.41:20160 success</span></span>
<span class="line"><span>	Start tikv 192.168.169.43:20160 success</span></span>
<span class="line"><span>	Start tikv 192.168.169.42:20160 success</span></span>
<span class="line"><span>Starting component tidb</span></span>
<span class="line"><span>	Starting instance tidb 192.168.169.43:4000</span></span>
<span class="line"><span>	Starting instance tidb 192.168.169.42:4000</span></span>
<span class="line"><span>	Starting instance tidb 192.168.169.41:4000</span></span>
<span class="line"><span>	Start tidb 192.168.169.41:4000 success</span></span>
<span class="line"><span>	Start tidb 192.168.169.42:4000 success</span></span>
<span class="line"><span>	Start tidb 192.168.169.43:4000 success</span></span>
<span class="line"><span>Starting component tiflash</span></span>
<span class="line"><span>	Starting instance tiflash 192.168.169.43:9000</span></span>
<span class="line"><span>	Start tiflash 192.168.169.43:9000 success</span></span>
<span class="line"><span>Starting component cdc</span></span>
<span class="line"><span>	Starting instance cdc 192.168.169.43:8300</span></span>
<span class="line"><span>	Starting instance cdc 192.168.169.41:8300</span></span>
<span class="line"><span>	Starting instance cdc 192.168.169.42:8300</span></span>
<span class="line"><span>	Start cdc 192.168.169.42:8300 success</span></span>
<span class="line"><span>	Start cdc 192.168.169.41:8300 success</span></span>
<span class="line"><span>	Start cdc 192.168.169.43:8300 success</span></span>
<span class="line"><span>Starting component prometheus</span></span>
<span class="line"><span>	Starting instance prometheus 192.168.169.42:9090</span></span>
<span class="line"><span>	Start prometheus 192.168.169.42:9090 success</span></span>
<span class="line"><span>Starting component grafana</span></span>
<span class="line"><span>	Starting instance grafana 192.168.169.42:3000</span></span>
<span class="line"><span>	Start grafana 192.168.169.42:3000 success</span></span>
<span class="line"><span>Starting component alertmanager</span></span>
<span class="line"><span>	Starting instance alertmanager 192.168.169.42:9093</span></span>
<span class="line"><span>	Start alertmanager 192.168.169.42:9093 success</span></span>
<span class="line"><span>+ [ Serial ] - UpdateTopology: cluster=tidb-test</span></span>
<span class="line"><span>Started cluster `tidb-test` successfully</span></span></code></pre>
</div><h2 id="Ê£ÄÊü•ÈõÜÁæ§Áä∂ÊÄÅ" tabindex="-1">Ê£ÄÊü•ÈõÜÁæ§Áä∂ÊÄÅ <a class="header-anchor" href="#Ê£ÄÊü•ÈõÜÁæ§Áä∂ÊÄÅ" aria-label="Permalink to &quot;Ê£ÄÊü•ÈõÜÁæ§Áä∂ÊÄÅ&quot;"></a></h2>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tiup-tidb41 ~]$ tiup cluster display tidb-test</span></span>
<span class="line"><span>Starting component `cluster`: /home/tidb/.tiup/components/cluster/v1.3.1/tiup-cluster display tidb-test</span></span>
<span class="line"><span>Cluster type:       tidb</span></span>
<span class="line"><span>Cluster name:       tidb-test</span></span>
<span class="line"><span>Cluster version:    v4.0.2</span></span>
<span class="line"><span>SSH type:           builtin</span></span>
<span class="line"><span>Dashboard URL:      http://192.168.169.42:2379/dashboard</span></span>
<span class="line"><span>ID                    Role          Host            Ports                            OS/Arch       Status   Data Dir                                 Deploy Dir</span></span>
<span class="line"><span>--                    ----          ----            -----                            -------       ------   --------                                 ----------</span></span>
<span class="line"><span>192.168.169.42:9093   alertmanager  192.168.169.42  9093/9094                        linux/x86_64  Up       /data/tidb-data/alertmanager-9093        /data/tidb-deploy/alertmanager-9093</span></span>
<span class="line"><span>192.168.169.41:8300   cdc           192.168.169.41  8300                             linux/x86_64  Up       -                                        /data/tidb-deploy/cdc-8300</span></span>
<span class="line"><span>192.168.169.42:8300   cdc           192.168.169.42  8300                             linux/x86_64  Up       -                                        /data/tidb-deploy/cdc-8300</span></span>
<span class="line"><span>192.168.169.43:8300   cdc           192.168.169.43  8300                             linux/x86_64  Up       -                                        /data/tidb-deploy/cdc-8300</span></span>
<span class="line"><span>192.168.169.42:3000   grafana       192.168.169.42  3000                             linux/x86_64  Up       -                                        /data/tidb-deploy/grafana-3000</span></span>
<span class="line"><span>192.168.169.41:2379   pd            192.168.169.41  2379/2380                        linux/x86_64  Up       /data/tidb-data/pd-2379                  /data/tidb-deploy/pd-2379</span></span>
<span class="line"><span>192.168.169.42:2379   pd            192.168.169.42  2379/2380                        linux/x86_64  Up|L|UI  /data/tidb-data/pd-2379                  /data/tidb-deploy/pd-2379</span></span>
<span class="line"><span>192.168.169.43:2379   pd            192.168.169.43  2379/2380                        linux/x86_64  Up       /data/tidb-data/pd-2379                  /data/tidb-deploy/pd-2379</span></span>
<span class="line"><span>192.168.169.42:9090   prometheus    192.168.169.42  9090                             linux/x86_64  Up       /data/tidb-data/prometheus-9090          /data/tidb-deploy/prometheus-9090</span></span>
<span class="line"><span>192.168.169.41:4000   tidb          192.168.169.41  4000/10080                       linux/x86_64  Up       -                                        /data/tidb-deploy/tidb-4000</span></span>
<span class="line"><span>192.168.169.42:4000   tidb          192.168.169.42  4000/10080                       linux/x86_64  Up       -                                        /data/tidb-deploy/tidb-4000</span></span>
<span class="line"><span>192.168.169.43:4000   tidb          192.168.169.43  4000/10080                       linux/x86_64  Up       -                                        /data/tidb-deploy/tidb-4000</span></span>
<span class="line"><span>192.168.169.44:9000   tiflash       192.168.169.44  9000/8123/3930/20170/20292/8234  linux/x86_64  Up       /data/tiflash1/data,/data/tiflash2/data  /data/tidb-deploy/tiflash-9000</span></span>
<span class="line"><span>192.168.169.41:20160  tikv          192.168.169.41  20160/20180                      linux/x86_64  Up       /data/tidb-data/tikv-20160               /data/tidb-deploy/tikv-20160</span></span>
<span class="line"><span>192.168.169.42:20160  tikv          192.168.169.42  20160/20180                      linux/x86_64  Up       /data/tidb-data/tikv-20160               /data/tidb-deploy/tikv-20160</span></span>
<span class="line"><span>192.168.169.43:20160  tikv          192.168.169.43  20160/20180                      linux/x86_64  Up       /data/tidb-data/tikv-20160               /data/tidb-deploy/tikv-20160</span></span>
<span class="line"><span>Total nodes: 16</span></span></code></pre>
</div><h2 id="tiupÂç∏ËΩΩÈõÜÁæ§" tabindex="-1">TiUPÂç∏ËΩΩÈõÜÁæ§ <a class="header-anchor" href="#tiupÂç∏ËΩΩÈõÜÁæ§" aria-label="Permalink to &quot;TiUPÂç∏ËΩΩÈõÜÁæ§&quot;"></a></h2>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tiup-tidb41 tidb-community-server-v4.0.2-linux-amd64]$ tiup cluster clean tidb-test --all</span></span>
<span class="line"><span>Starting component `cluster`: /home/tidb/.tiup/components/cluster/v1.3.1/tiup-cluster clean tidb-test --all</span></span>
<span class="line"><span>This operation will stop tidb v4.0.2 cluster tidb-test and clean its' data and log.</span></span>
<span class="line"><span>Nodes will be ignored: []</span></span>
<span class="line"><span>Roles will be ignored: []</span></span>
<span class="line"><span>Files to be deleted are: </span></span>
<span class="line"><span>192.168.169.42:</span></span>
<span class="line"><span> /tidb-deploy/cdc-8300/log/*.log</span></span>
<span class="line"><span> /tidb-deploy/tidb-4000/log/*.log</span></span>
<span class="line"><span> /tidb-deploy/tikv-20160/log/*.log</span></span>
<span class="line"><span> /tidb-deploy/alertmanager-9093/log/*.log</span></span>
<span class="line"><span> /tidb-data/alertmanager-9093/*</span></span>
<span class="line"><span> /tidb-data/prometheus-9090/*</span></span>
<span class="line"><span> /tidb-deploy/pd-2379/log/*.log</span></span>
<span class="line"><span> /tidb-data/pd-2379/*</span></span>
<span class="line"><span> /tidb-deploy/grafana-3000/log/*.log</span></span>
<span class="line"><span> /tidb-deploy/prometheus-9090/log/*.log</span></span>
<span class="line"><span> /tidb-data/tikv-20160/*</span></span>
<span class="line"><span>192.168.169.41:</span></span>
<span class="line"><span> /tidb-deploy/pd-2379/log/*.log</span></span>
<span class="line"><span> /tidb-data/pd-2379/*</span></span>
<span class="line"><span> /tidb-deploy/cdc-8300/log/*.log</span></span>
<span class="line"><span> /tidb-deploy/tidb-4000/log/*.log</span></span>
<span class="line"><span> /tidb-deploy/tikv-20160/log/*.log</span></span>
<span class="line"><span> /tidb-data/tikv-20160/*</span></span>
<span class="line"><span>192.168.169.43:</span></span>
<span class="line"><span> /tidb-deploy/tiflash-9000/log/*.log</span></span>
<span class="line"><span> /data/tiflash/data/*</span></span>
<span class="line"><span> /tidb-deploy/tidb-4000/log/*.log</span></span>
<span class="line"><span> /tidb-deploy/tikv-20160/log/*.log</span></span>
<span class="line"><span> /tidb-data/tikv-20160/*</span></span>
<span class="line"><span> /tidb-deploy/pd-2379/log/*.log</span></span>
<span class="line"><span> /tidb-data/pd-2379/*</span></span>
<span class="line"><span> /tidb-deploy/cdc-8300/log/*.log</span></span>
<span class="line"><span>Do you want to continue? [y/N]: y</span></span>
<span class="line"><span>Cleanup cluster...</span></span>
<span class="line"><span>+ [ Serial ] - SSHKeySet: privateKey=/home/tidb/.tiup/storage/cluster/clusters/tidb-test/ssh/id_rsa, publicKey=/home/tidb/.tiup/storage/cluster/clusters/tidb-test/ssh/id_rsa.pub</span></span>
<span class="line"><span>+ [Parallel] - UserSSH: user=tidb, host=192.168.169.42</span></span>
<span class="line"><span>+ [Parallel] - UserSSH: user=tidb, host=192.168.169.41</span></span>
<span class="line"><span>+ [Parallel] - UserSSH: user=tidb, host=192.168.169.42</span></span>
<span class="line"><span>+ [Parallel] - UserSSH: user=tidb, host=192.168.169.43</span></span>
<span class="line"><span>+ [Parallel] - UserSSH: user=tidb, host=192.168.169.41</span></span>
<span class="line"><span>+ [Parallel] - UserSSH: user=tidb, host=192.168.169.42</span></span>
<span class="line"><span>+ [Parallel] - UserSSH: user=tidb, host=192.168.169.43</span></span>
<span class="line"><span>+ [Parallel] - UserSSH: user=tidb, host=192.168.169.42</span></span>
<span class="line"><span>+ [Parallel] - UserSSH: user=tidb, host=192.168.169.42</span></span>
<span class="line"><span>+ [Parallel] - UserSSH: user=tidb, host=192.168.169.41</span></span>
<span class="line"><span>+ [Parallel] - UserSSH: user=tidb, host=192.168.169.43</span></span>
<span class="line"><span>+ [Parallel] - UserSSH: user=tidb, host=192.168.169.43</span></span>
<span class="line"><span>+ [Parallel] - UserSSH: user=tidb, host=192.168.169.41</span></span>
<span class="line"><span>+ [Parallel] - UserSSH: user=tidb, host=192.168.169.42</span></span>
<span class="line"><span>+ [Parallel] - UserSSH: user=tidb, host=192.168.169.43</span></span>
<span class="line"><span>+ [Parallel] - UserSSH: user=tidb, host=192.168.169.42</span></span>
<span class="line"><span>+ [ Serial ] - StopCluster</span></span>
<span class="line"><span>Stopping component alertmanager</span></span>
<span class="line"><span>	Stopping instance 192.168.169.42</span></span>
<span class="line"><span>	Stop alertmanager 192.168.169.42:9093 success</span></span>
<span class="line"><span>Stopping component grafana</span></span>
<span class="line"><span>	Stopping instance 192.168.169.42</span></span>
<span class="line"><span>	Stop grafana 192.168.169.42:3000 success</span></span>
<span class="line"><span>Stopping component prometheus</span></span>
<span class="line"><span>	Stopping instance 192.168.169.42</span></span>
<span class="line"><span>	Stop prometheus 192.168.169.42:9090 success</span></span>
<span class="line"><span>Stopping component cdc</span></span>
<span class="line"><span>	Stopping instance 192.168.169.43</span></span>
<span class="line"><span>	Stopping instance 192.168.169.42</span></span>
<span class="line"><span>	Stopping instance 192.168.169.41</span></span>
<span class="line"><span>	Stop cdc 192.168.169.42:8300 success</span></span>
<span class="line"><span>	Stop cdc 192.168.169.41:8300 success</span></span>
<span class="line"><span>	Stop cdc 192.168.169.43:8300 success</span></span>
<span class="line"><span>Stopping component tiflash</span></span>
<span class="line"><span>	Stopping instance 192.168.169.43</span></span>
<span class="line"><span>	Stop tiflash 192.168.169.43:9000 success</span></span>
<span class="line"><span>Stopping component tidb</span></span>
<span class="line"><span>	Stopping instance 192.168.169.43</span></span>
<span class="line"><span>	Stopping instance 192.168.169.42</span></span>
<span class="line"><span>	Stopping instance 192.168.169.41</span></span>
<span class="line"><span>	Stop tidb 192.168.169.42:4000 success</span></span>
<span class="line"><span>	Stop tidb 192.168.169.41:4000 success</span></span>
<span class="line"><span>	Stop tidb 192.168.169.43:4000 success</span></span>
<span class="line"><span>Stopping component tikv</span></span>
<span class="line"><span>	Stopping instance 192.168.169.43</span></span>
<span class="line"><span>	Stopping instance 192.168.169.41</span></span>
<span class="line"><span>	Stopping instance 192.168.169.42</span></span>
<span class="line"><span>	Stop tikv 192.168.169.42:20160 success</span></span>
<span class="line"><span>	Stop tikv 192.168.169.43:20160 success</span></span>
<span class="line"><span>	Stop tikv 192.168.169.41:20160 success</span></span>
<span class="line"><span>Stopping component pd</span></span>
<span class="line"><span>	Stopping instance 192.168.169.43</span></span>
<span class="line"><span>	Stopping instance 192.168.169.41</span></span>
<span class="line"><span>	Stopping instance 192.168.169.42</span></span>
<span class="line"><span>	Stop pd 192.168.169.41:2379 success</span></span>
<span class="line"><span>	Stop pd 192.168.169.43:2379 success</span></span>
<span class="line"><span>	Stop pd 192.168.169.42:2379 success</span></span>
<span class="line"><span>Stopping component node_exporter</span></span>
<span class="line"><span>Stopping component blackbox_exporter</span></span>
<span class="line"><span>Stopping component node_exporter</span></span>
<span class="line"><span>Stopping component blackbox_exporter</span></span>
<span class="line"><span>Stopping component node_exporter</span></span>
<span class="line"><span>Stopping component blackbox_exporter</span></span>
<span class="line"><span>+ [ Serial ] - CleanupCluster</span></span>
<span class="line"><span>Cleanup instance 192.168.169.43</span></span>
<span class="line"><span>Cleanup 192.168.169.43 success</span></span>
<span class="line"><span>Cleanup instance 192.168.169.42</span></span>
<span class="line"><span>Cleanup 192.168.169.42 success</span></span>
<span class="line"><span>Cleanup instance 192.168.169.41</span></span>
<span class="line"><span>Cleanup 192.168.169.41 success</span></span>
<span class="line"><span>Cleanup cluster `tidb-test` successfully</span></span></code></pre>
</div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tiup-tidb41 tidb-community-server-v4.0.2-linux-amd64]$ tiup install tiflash:v4.0.2</span></span>
<span class="line"><span>component tiflash version v4.0.2 is already installed</span></span>
<span class="line"><span>[tidb@tiup-tidb41 tidb-community-server-v4.0.2-linux-amd64]$ tiup clean tiflash:v4.0.2</span></span>
<span class="line"><span>[tidb@tiup-tidb41 tidb-community-server-v4.0.2-linux-amd64]$ tiup uninstall tiflash:v4.0.2</span></span>
<span class="line"><span>Uninstalled component `tiflash:v4.0.2` successfully!</span></span>
<span class="line"><span>[tidb@tiup-tidb41 tidb-community-server-v4.0.2-linux-amd64]$ tiup clean tiflash:v4.0.2</span></span>
<span class="line"><span>[tidb@tiup-tidb41 tidb-community-server-v4.0.2-linux-amd64]$ tiup install tiflash:v4.0.2</span></span></code></pre>
</div><h2 id="Â∏∏ËßÅÈîôËØØËß£ÂÜ≥" tabindex="-1">Â∏∏ËßÅÈîôËØØËß£ÂÜ≥ <a class="header-anchor" href="#Â∏∏ËßÅÈîôËØØËß£ÂÜ≥" aria-label="Permalink to &quot;Â∏∏ËßÅÈîôËØØËß£ÂÜ≥&quot;"></a></h2>
<p>ÊúÄÂºÄÂßãÂÆâË£ÖËøá‰∏ÄÊ¨°Ôºå‰ª•‰∏∫tiflashÂøÖÈ°ªË¶ÅÈÖçÁΩÆ‰∏§‰∏™ÊâçËÉΩÊù•Ëµ∑Êù•ÔºåÊâÄ‰ª•ÊÉ≥Â∞ùËØïÈáçÊñ∞ÈÉ®ÁΩ≤‰∏ÄÊ¨°</p>
<p>‰ΩÜÊòØÊ≠£Â∏∏ tiup clean --all Âà†Èô§ÊâÄÊúâÁªÑ‰ª∂‰πãÂêéÔºå‰øÆÊîπtopology.yamlÁöÑtiflashÈÖçÁΩÆÈáçÊñ∞ÈÉ®ÁΩ≤ÔºåÂá∫Áé∞Â¶Ç‰∏ãÊä•Èîô</p>
<p>Ëß£ÂÜ≥ÊñπÊ°à‰∏∫ÔºåËøõÂÖ•/home/tidb/.tiup/storage/cluster/clustersÁõÆÂΩï‰∏ãÂà†Èô§tidb-testÁöÑÊñá‰ª∂</p>
<p>Êú¨‰∫∫ÁåúÊµãÂèØËÉΩÊòØcleanÁöÑÊó∂ÂÄôÊ≤°ÊúâÂ∞ÜËøôÈÉ®ÂàÜÊñá‰ª∂‰∏ÄËµ∑Âà†Èô§ÂØºËá¥ÁöÑ</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> TIUP_MIRRORS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">/home/tidb/tidb-community-server-v4.0.2-linux-amd64</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ tiup cluster deploy tidb-test v4.0.2 topology.yaml --user root -p </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> component</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /home/tidb/.tiup/components/cluster/v1.3.1/tiup-cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> deploy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-test</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> v4.0.2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> topology.yaml</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --user</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> root</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -p</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Error:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'tidb-test'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> duplicated</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (deploy.name_dup)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Please</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> specify</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> another</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> name</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Error:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">/home/tidb/.tiup/components/cluster/v1.3.1/tiup-cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">wd:/home/tidb/.tiup/data/SLZjdQu</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">failed:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> exit</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> status</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Ëß£ÂÜ≥ÊñπÂºè</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 clusters]$ pwd</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">/home/tidb/.tiup/storage/cluster/clusters</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 clusters]$ rm -rf tidb-test/</span></span></code></pre>
</div>]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Êâ©ÂÆπTiDB„ÄÅTiKV„ÄÅPDËäÇÁÇπ]]></title>
            <link>https://askaric.com/zh/work/tidb/02TIDB-ÈÉ®ÁΩ≤ÂÆûË∑µ/2-2TiUP ÈÉ®ÁΩ≤ÂÆûË∑µ/02TiUP Êâ©Áº©ÂÆπ‰∏ªË¶ÅÁªÑ‰ª∂.html</link>
            <guid>https://askaric.com/zh/work/tidb/02TIDB-ÈÉ®ÁΩ≤ÂÆûË∑µ/2-2TiUP ÈÉ®ÁΩ≤ÂÆûË∑µ/02TiUP Êâ©Áº©ÂÆπ‰∏ªË¶ÅÁªÑ‰ª∂.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[


## Êâ©ÂÆπTiDB„ÄÅTiKV„ÄÅPDËäÇÁÇπ
#### ÁºñÂÜôscale-outÊñá‰ª∂
```
[tidb@tiup-tidb41 tidb-community-server-v4.0.9-linux-amd64]$ cat scale-out.yaml  

[tidb@tiup-tidb41 tidb-community-server-v4.0.9-linux-amd64]$ vi scale-out.yaml 
tidb_servers:
  - host: 192.168.169.44
    ssh_port: 22
    port: 4000
    status_port: 10080
    deploy_dir: /data/tidb-deploy/install/tidb-4000
    log_dir: /data/tidb-deploy/install/log/tidb-4000

tikv_servers:
  - host: 192.168.169.44
    ssh_port: 22
    port: 20160
    status_port: 20180
    deploy_dir: /data/tidb-deploy/install/deploy/tikv-20160
    data_dir: /data/tidb-data/install/data/tikv-20160
    log_dir: /data/tidb-deploy/install/log/tikv-20160


pd_servers:
  - host: 192.168.169.44
    ssh_port: 22
    name: pd-192.168.169.44-2379
    client_port: 2379
    peer_port: 2380
    deploy_dir: /data/tidb-deploy/install/deploy/pd-2379
    data_dir: /data/tidb-data/install/data/pd-2379
    log_dir: /data/tidb-deploy/install/log/pd-2379
```


#### ÊâßË°åscale-outÊâ©ÂÆπÊìç‰Ωú
```
[tidb@tiup-tidb41 tidb-community-server-v4.0.9-linux-amd64]$ tiup cluster scale-out tidb-test scale-out.yaml
Starting component `cluster`: /home/tidb/.tiup/components/cluster/v1.3.1/tiup-cluster scale-out tidb-test scale-out.yaml
Please confirm your topology:
Cluster type:    tidb
Cluster name:    tidb-test
Cluster version: v4.0.9
Type  Host            Ports        OS/Arch       Directories
]]></description>
            <content:encoded><![CDATA[<h2 id="Êâ©ÂÆπtidb„ÄÅtikv„ÄÅpdËäÇÁÇπ" tabindex="-1">Êâ©ÂÆπTiDB„ÄÅTiKV„ÄÅPDËäÇÁÇπ <a class="header-anchor" href="#Êâ©ÂÆπtidb„ÄÅtikv„ÄÅpdËäÇÁÇπ" aria-label="Permalink to &quot;Êâ©ÂÆπTiDB„ÄÅTiKV„ÄÅPDËäÇÁÇπ&quot;"></a></h2>
<h4 id="ÁºñÂÜôscale-outÊñá‰ª∂" tabindex="-1">ÁºñÂÜôscale-outÊñá‰ª∂ <a class="header-anchor" href="#ÁºñÂÜôscale-outÊñá‰ª∂" aria-label="Permalink to &quot;ÁºñÂÜôscale-outÊñá‰ª∂&quot;"></a></h4>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tiup-tidb41 tidb-community-server-v4.0.9-linux-amd64]$ cat scale-out.yaml  </span></span>
<span class="line"><span></span></span>
<span class="line"><span>[tidb@tiup-tidb41 tidb-community-server-v4.0.9-linux-amd64]$ vi scale-out.yaml </span></span>
<span class="line"><span>tidb_servers:</span></span>
<span class="line"><span>  - host: 192.168.169.44</span></span>
<span class="line"><span>    ssh_port: 22</span></span>
<span class="line"><span>    port: 4000</span></span>
<span class="line"><span>    status_port: 10080</span></span>
<span class="line"><span>    deploy_dir: /data/tidb-deploy/install/tidb-4000</span></span>
<span class="line"><span>    log_dir: /data/tidb-deploy/install/log/tidb-4000</span></span>
<span class="line"><span></span></span>
<span class="line"><span>tikv_servers:</span></span>
<span class="line"><span>  - host: 192.168.169.44</span></span>
<span class="line"><span>    ssh_port: 22</span></span>
<span class="line"><span>    port: 20160</span></span>
<span class="line"><span>    status_port: 20180</span></span>
<span class="line"><span>    deploy_dir: /data/tidb-deploy/install/deploy/tikv-20160</span></span>
<span class="line"><span>    data_dir: /data/tidb-data/install/data/tikv-20160</span></span>
<span class="line"><span>    log_dir: /data/tidb-deploy/install/log/tikv-20160</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>pd_servers:</span></span>
<span class="line"><span>  - host: 192.168.169.44</span></span>
<span class="line"><span>    ssh_port: 22</span></span>
<span class="line"><span>    name: pd-192.168.169.44-2379</span></span>
<span class="line"><span>    client_port: 2379</span></span>
<span class="line"><span>    peer_port: 2380</span></span>
<span class="line"><span>    deploy_dir: /data/tidb-deploy/install/deploy/pd-2379</span></span>
<span class="line"><span>    data_dir: /data/tidb-data/install/data/pd-2379</span></span>
<span class="line"><span>    log_dir: /data/tidb-deploy/install/log/pd-2379</span></span></code></pre>
</div><h4 id="ÊâßË°åscale-outÊâ©ÂÆπÊìç‰Ωú" tabindex="-1">ÊâßË°åscale-outÊâ©ÂÆπÊìç‰Ωú <a class="header-anchor" href="#ÊâßË°åscale-outÊâ©ÂÆπÊìç‰Ωú" aria-label="Permalink to &quot;ÊâßË°åscale-outÊâ©ÂÆπÊìç‰Ωú&quot;"></a></h4>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tiup-tidb41 tidb-community-server-v4.0.9-linux-amd64]$ tiup cluster scale-out tidb-test scale-out.yaml</span></span>
<span class="line"><span>Starting component `cluster`: /home/tidb/.tiup/components/cluster/v1.3.1/tiup-cluster scale-out tidb-test scale-out.yaml</span></span>
<span class="line"><span>Please confirm your topology:</span></span>
<span class="line"><span>Cluster type:    tidb</span></span>
<span class="line"><span>Cluster name:    tidb-test</span></span>
<span class="line"><span>Cluster version: v4.0.9</span></span>
<span class="line"><span>Type  Host            Ports        OS/Arch       Directories</span></span>
<span class="line"><span>----  ----            -----        -------       -----------</span></span>
<span class="line"><span>pd    192.168.169.44  2379/2380    linux/x86_64  /data/tidb-deploy/install/deploy/pd-2379,/data/tidb-data/install/data/pd-2379</span></span>
<span class="line"><span>tikv  192.168.169.44  20160/20180  linux/x86_64  /data/tidb-deploy/install/deploy/tikv-20160,/data/tidb-data/install/data/tikv-20160</span></span>
<span class="line"><span>tidb  192.168.169.44  4000/10080   linux/x86_64  /data/tidb-deploy/install/tidb-4000</span></span>
<span class="line"><span>Attention:</span></span>
<span class="line"><span>    1. If the topology is not what you expected, check your yaml file.</span></span>
<span class="line"><span>    2. Please confirm there is no port/directory conflicts in same host.</span></span>
<span class="line"><span>Do you want to continue? [y/N]:  y</span></span>
<span class="line"><span>Input SSH password: </span></span>
<span class="line"><span>+ [ Serial ] - SSHKeySet: privateKey=/home/tidb/.tiup/storage/cluster/clusters/tidb-test/ssh/id_rsa, publicKey=/home/tidb/.tiup/storage/cluster/clusters/tidb-test/ssh/id_rsa.pub</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>Scaled cluster `tidb-test` out successfully</span></span></code></pre>
</div><h4 id="displayÈ™åËØÅÊâ©ÂÆπÊìç‰Ωú" tabindex="-1">displayÈ™åËØÅÊâ©ÂÆπÊìç‰Ωú <a class="header-anchor" href="#displayÈ™åËØÅÊâ©ÂÆπÊìç‰Ωú" aria-label="Permalink to &quot;displayÈ™åËØÅÊâ©ÂÆπÊìç‰Ωú&quot;"></a></h4>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tiup-tidb41 tidb-community-server-v4.0.2-linux-amd64]$ tiup cluster display tidb-test</span></span>
<span class="line"><span>Starting component `cluster`: /home/tidb/.tiup/components/cluster/v1.3.1/</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>tikv-20160               /data/tidb-deploy/tikv-20160</span></span>
<span class="line"><span>192.168.169.44:20160  tikv          192.168.169.44  20160/20180                      linux/x86_64  Up      /data/tidb-data/install/data/tikv-20160  /data/tidb-deploy/install/deploy/tikv-20160</span></span>
<span class="line"><span>Total nodes: 19</span></span></code></pre>
</div><h2 id="Áº©ÂÆπtidb„ÄÅtikv„ÄÅpdËäÇÁÇπ" tabindex="-1">Áº©ÂÆπTiDB„ÄÅTiKV„ÄÅPDËäÇÁÇπ <a class="header-anchor" href="#Áº©ÂÆπtidb„ÄÅtikv„ÄÅpdËäÇÁÇπ" aria-label="Permalink to &quot;Áº©ÂÆπTiDB„ÄÅTiKV„ÄÅPDËäÇÁÇπ&quot;"></a></h2>
<h4 id="Áº©ÂÆπtikvËäÇÁÇπ" tabindex="-1">Áº©ÂÆπTiKVËäÇÁÇπ <a class="header-anchor" href="#Áº©ÂÆπtikvËäÇÁÇπ" aria-label="Permalink to &quot;Áº©ÂÆπTiKVËäÇÁÇπ&quot;"></a></h4>
<ul>
<li>ÈÄöËøánodeÂèÇÊï∞ÊåáÂÆöË¶ÅÁº©ÂÆπÁöÑTiKVËäÇÁÇπ</li>
</ul>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tiup-tidb41 tidb-community-server-v4.0.2-linux-amd64]$ tiup cluster scale-in tidb-test --node 192.168.169.44:20160</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Starting component `cluster`: /home/tidb/.tiup/components/cluster/v1.3.1/tiup-cluster scale-in tidb-test --node 192.168.169.44:20160</span></span>
<span class="line"><span>This operation will delete the 192.168.169.44:20160 nodes in `tidb-test` and all their data.</span></span>
<span class="line"><span>Do you want to continue? [y/N]: y</span></span>
<span class="line"><span>Scale-in nodes...</span></span>
<span class="line"><span>+ [ Serial ] - SSHKeySet: privateKey=/home/tidb/.tiup/storage/cluster/</span></span>
<span class="line"><span></span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Scaled cluster `tidb-test` in successfully</span></span></code></pre>
</div><ul>
<li>ÈÄöËøádisplayÂèÇÊï∞È™åËØÅÁº©ÂÆπÁöÑTiKVËäÇÁÇπ</li>
</ul>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tiup-tidb41 tidb-community-server-v4.0.2-linux-amd64]$ tiup cluster display tidb-test</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>There are some nodes can be pruned: </span></span>
<span class="line"><span>	Nodes: [192.168.169.44:20160]</span></span>
<span class="line"><span>	You can destroy them with the command: `tiup cluster prune tidb-test`</span></span></code></pre>
</div><ul>
<li>ÈÄöËøápruneÂ∞ÜofflineÁöÑTiKVËäÇÁÇπpruneËá≥TombstoneÁä∂ÊÄÅ</li>
</ul>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tiup-tidb41 tidb-community-server-v4.0.2-linux-amd64]$ tiup cluster prune tidb-test</span></span>
<span class="line"><span>Starting component `cluster`: /home/tidb/.tiup/components/cluster/v1.3.1/tiup-cluster prune tidb-test</span></span>
<span class="line"><span>+ [ Serial ] - SSHKeySet: privateKey=/home/tidb/.tiup/storage/cluster/clusters/tidb-test/ssh/id_rsa, publicKey=/home/tidb/.tiup/storage/cluster/clusters/tidb-test/ssh/id_rsa.pub</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>Will destroy these nodes: [192.168.169.44:20160]</span></span>
<span class="line"><span>Do you confirm this action? [y/N]: y</span></span>
<span class="line"><span>Start destroy Tombstone nodes: [192.168.169.44:20160] ...</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>  - Regenerate config tikv -> 192.168.169.43:20160 ... Done</span></span>
<span class="line"><span>  - Regenerate config tikv -> 192.168.169.44:20160 ... Error</span></span>
<span class="line"><span>  - Regenerate config tidb -> 192.168.169.41:4000 ... Done</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>Destroy success</span></span></code></pre>
</div><h2 id="displayÈ™åËØÅtikvËäÇÁÇπÁº©ÂÆπ" tabindex="-1">displayÈ™åËØÅTiKVËäÇÁÇπÁº©ÂÆπ <a class="header-anchor" href="#displayÈ™åËØÅtikvËäÇÁÇπÁº©ÂÆπ" aria-label="Permalink to &quot;displayÈ™åËØÅTiKVËäÇÁÇπÁº©ÂÆπ&quot;"></a></h2>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tiup-tidb41 tidb-community-server-v4.0.2-linux-amd64]$ tiup cluster display tidb-test</span></span>
<span class="line"><span>Starting component `cluster`: /home/tidb/.tiup/components/cluster/v1.3.1/tiup-cluster display tidb-test</span></span>
<span class="line"><span>Cluster type:       tidb</span></span>
<span class="line"><span>Cluster name:       tidb-test</span></span>
<span class="line"><span>Cluster version:    v4.0.2</span></span>
<span class="line"><span>SSH type:           builtin</span></span>
<span class="line"><span>Dashboard URL:      http://192.168.169.41:2379/dashboard</span></span>
<span class="line"><span>ID                    Role          Host            Ports                            OS/Arch       Status  Data Dir                                 Deploy Dir</span></span>
<span class="line"><span>--                    ----          ----            -----                            -------       ------  --------                                 ----------</span></span>
<span class="line"><span>192.168.169.42:9093   alertmanager  192.168.169.42  9093/9094                        linux/x86_64  Up      /data/tidb-data/alertmanager-9093        /data/tidb-deploy/alertmanager-9093</span></span>
<span class="line"><span>192.168.169.41:8300   cdc           192.168.169.41  8300                             linux/x86_64  Up      -                                        /data/tidb-deploy/cdc-8300</span></span>
<span class="line"><span>192.168.169.42:8300   cdc           192.168.169.42  8300                             linux/x86_64  Up      -                                        /data/tidb-deploy/cdc-8300</span></span>
<span class="line"><span>192.168.169.43:8300   cdc           192.168.169.43  8300                             linux/x86_64  Up      -                                        /data/tidb-deploy/cdc-8300</span></span>
<span class="line"><span>192.168.169.42:3000   grafana       192.168.169.42  3000                             linux/x86_64  Up      -                                        /data/tidb-deploy/grafana-3000</span></span>
<span class="line"><span>192.168.169.41:2379   pd            192.168.169.41  2379/2380                        linux/x86_64  Up|UI   /data/tidb-data/pd-2379                  /data/tidb-deploy/pd-2379</span></span>
<span class="line"><span>192.168.169.42:2379   pd            192.168.169.42  2379/2380                        linux/x86_64  Up      /data/tidb-data/pd-2379                  /data/tidb-deploy/pd-2379</span></span>
<span class="line"><span>192.168.169.43:2379   pd            192.168.169.43  2379/2380                        linux/x86_64  Up      /data/tidb-data/pd-2379                  /data/tidb-deploy/pd-2379</span></span>
<span class="line"><span>192.168.169.44:2379   pd            192.168.169.44  2379/2380                        linux/x86_64  Up|L    /data/tidb-data/install/data/pd-2379     /data/tidb-deploy/install/deploy/pd-2379</span></span>
<span class="line"><span>192.168.169.42:9090   prometheus    192.168.169.42  9090                             linux/x86_64  Up      /data/tidb-data/prometheus-9090          /data/tidb-deploy/prometheus-9090</span></span>
<span class="line"><span>192.168.169.41:4000   tidb          192.168.169.41  4000/10080                       linux/x86_64  Up      -                                        /data/tidb-deploy/tidb-4000</span></span>
<span class="line"><span>192.168.169.42:4000   tidb          192.168.169.42  4000/10080                       linux/x86_64  Up      -                                        /data/tidb-deploy/tidb-4000</span></span>
<span class="line"><span>192.168.169.43:4000   tidb          192.168.169.43  4000/10080                       linux/x86_64  Up      -                                        /data/tidb-deploy/tidb-4000</span></span>
<span class="line"><span>192.168.169.44:4000   tidb          192.168.169.44  4000/10080                       linux/x86_64  Up      -                                        /data/tidb-deploy/install/tidb-4000</span></span>
<span class="line"><span>192.168.169.44:9000   tiflash       192.168.169.44  9000/8123/3930/20170/20292/8234  linux/x86_64  Up      /data/tiflash1/data,/data/tiflash2/data  /data/tidb-deploy/tiflash-9000</span></span>
<span class="line"><span>192.168.169.41:20160  tikv          192.168.169.41  20160/20180                      linux/x86_64  Up      /data/tidb-data/tikv-20160               /data/tidb-deploy/tikv-20160</span></span>
<span class="line"><span>192.168.169.42:20160  tikv          192.168.169.42  20160/20180                      linux/x86_64  Up      /data/tidb-data/tikv-20160               /data/tidb-deploy/tikv-20160</span></span>
<span class="line"><span>192.168.169.43:20160  tikv          192.168.169.43  20160/20180                      linux/x86_64  Up      /data/tidb-data/tikv-20160               /data/tidb-deploy/tikv-20160</span></span></code></pre>
</div><h4 id="Áº©ÂÆπtidbËäÇÁÇπ" tabindex="-1">Áº©ÂÆπTiDBËäÇÁÇπ <a class="header-anchor" href="#Áº©ÂÆπtidbËäÇÁÇπ" aria-label="Permalink to &quot;Áº©ÂÆπTiDBËäÇÁÇπ&quot;"></a></h4>
<ul>
<li>ÂºÄÂßãÁº©ÂÆπTiDBËäÇÁÇπ</li>
</ul>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tiup-tidb41 tidb-community-server-v4.0.2-linux-amd64]$ tiup cluster scale-in tidb-test --node 192.168.169.44:4000</span></span>
<span class="line"><span>Starting component `cluster`: /home/tidb/.tiup/components/cluster/v1.3.1/tiup-cluster scale-in tidb-test --node 192.168.169.44:4000</span></span>
<span class="line"><span>This operation will delete the 192.168.169.44:4000 nodes in `tidb-test` and all their data.</span></span>
<span class="line"><span>Do you want to continue? [y/N]: y</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>Scaled cluster `tidb-test` in successfully</span></span></code></pre>
</div><ul>
<li>È™åËØÅÁº©ÂÆπTiDBËäÇÁÇπ</li>
</ul>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tiup-tidb41 tidb-community-server-v4.0.2-linux-amd64]$ tiup cluster display tidb-test</span></span>
<span class="line"><span>Starting component `cluster`: /home/tidb/.tiup/components/cluster/v1.3.1/tiup-cluster display tidb-test</span></span>
<span class="line"><span>Cluster type:       tidb</span></span>
<span class="line"><span>Cluster name:       tidb-test</span></span>
<span class="line"><span>Cluster version:    v4.0.2</span></span>
<span class="line"><span>SSH type:           builtin</span></span>
<span class="line"><span>Dashboard URL:      http://192.168.169.41:2379/dashboard</span></span>
<span class="line"><span>ID                    Role          Host            Ports                            OS/Arch       Status  Data Dir                                 Deploy Dir</span></span>
<span class="line"><span>--                    ----          ----            -----                            -------       ------  --------                                 ----------</span></span>
<span class="line"><span>192.168.169.42:9093   alertmanager  192.168.169.42  9093/9094                        linux/x86_64  Up      /data/tidb-data/alertmanager-9093        /data/tidb-deploy/alertmanager-9093</span></span>
<span class="line"><span>192.168.169.41:8300   cdc           192.168.169.41  8300                             linux/x86_64  Up      -                                        /data/tidb-deploy/cdc-8300</span></span>
<span class="line"><span>192.168.169.42:8300   cdc           192.168.169.42  8300                             linux/x86_64  Up      -                                        /data/tidb-deploy/cdc-8300</span></span>
<span class="line"><span>192.168.169.43:8300   cdc           192.168.169.43  8300                             linux/x86_64  Up      -                                        /data/tidb-deploy/cdc-8300</span></span>
<span class="line"><span>192.168.169.42:3000   grafana       192.168.169.42  3000                             linux/x86_64  Up      -                                        /data/tidb-deploy/grafana-3000</span></span>
<span class="line"><span>192.168.169.41:2379   pd            192.168.169.41  2379/2380                        linux/x86_64  Up|UI   /data/tidb-data/pd-2379                  /data/tidb-deploy/pd-2379</span></span>
<span class="line"><span>192.168.169.42:2379   pd            192.168.169.42  2379/2380                        linux/x86_64  Up      /data/tidb-data/pd-2379                  /data/tidb-deploy/pd-2379</span></span>
<span class="line"><span>192.168.169.43:2379   pd            192.168.169.43  2379/2380                        linux/x86_64  Up      /data/tidb-data/pd-2379                  /data/tidb-deploy/pd-2379</span></span>
<span class="line"><span>192.168.169.44:2379   pd            192.168.169.44  2379/2380                        linux/x86_64  Up|L    /data/tidb-data/install/data/pd-2379     /data/tidb-deploy/install/deploy/pd-2379</span></span>
<span class="line"><span>192.168.169.42:9090   prometheus    192.168.169.42  9090                             linux/x86_64  Up      /data/tidb-data/prometheus-9090          /data/tidb-deploy/prometheus-9090</span></span>
<span class="line"><span>192.168.169.41:4000   tidb          192.168.169.41  4000/10080                       linux/x86_64  Up      -                                        /data/tidb-deploy/tidb-4000</span></span>
<span class="line"><span>192.168.169.42:4000   tidb          192.168.169.42  4000/10080                       linux/x86_64  Up      -                                        /data/tidb-deploy/tidb-4000</span></span>
<span class="line"><span>192.168.169.43:4000   tidb          192.168.169.43  4000/10080                       linux/x86_64  Up      -                                        /data/tidb-deploy/tidb-4000</span></span>
<span class="line"><span>192.168.169.44:9000   tiflash       192.168.169.44  9000/8123/3930/20170/20292/8234  linux/x86_64  Up      /data/tiflash1/data,/data/tiflash2/data  /data/tidb-deploy/tiflash-9000</span></span>
<span class="line"><span>192.168.169.41:20160  tikv          192.168.169.41  20160/20180                      linux/x86_64  Up      /data/tidb-data/tikv-20160               /data/tidb-deploy/tikv-20160</span></span>
<span class="line"><span>192.168.169.42:20160  tikv          192.168.169.42  20160/20180                      linux/x86_64  Up      /data/tidb-data/tikv-20160               /data/tidb-deploy/tikv-20160</span></span>
<span class="line"><span>192.168.169.43:20160  tikv          192.168.169.43  20160/20180                      linux/x86_64  Up      /data/tidb-data/tikv-20160               /data/tidb-deploy/tikv-20160</span></span>
<span class="line"><span>Total nodes: 17</span></span></code></pre>
</div><h2 id="Áº©ÂÆπpdËäÇÁÇπ" tabindex="-1">Áº©ÂÆπPDËäÇÁÇπ <a class="header-anchor" href="#Áº©ÂÆπpdËäÇÁÇπ" aria-label="Permalink to &quot;Áº©ÂÆπPDËäÇÁÇπ&quot;"></a></h2>
<ul>
<li>ÂºÄÂßãÁº©ÂÆπPDËäÇÁÇπ</li>
</ul>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tiup-tidb41 tidb-community-server-v4.0.2-linux-amd64]$ tiup cluster scale-in tidb-test --node 192.168.169.44:2379</span></span>
<span class="line"><span>Starting component `cluster`: /home/tidb/.tiup/components/cluster/v1.3.1/tiup-cluster scale-in tidb-test --node 192.168.169.44:2379</span></span>
<span class="line"><span>This operation will delete the 192.168.169.44:2379 nodes in `tidb-test` and all their data.</span></span>
<span class="line"><span>Do you want to continue? [y/N]: y</span></span>
<span class="line"><span>Scale-in nodes...</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>Scaled cluster `tidb-test` in successfully</span></span></code></pre>
</div><ul>
<li>È™åËØÅPDËäÇÁÇπÁº©ÂÆπ</li>
</ul>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tiup-tidb41 tidb-community-server-v4.0.2-linux-amd64]$ tiup cluster display tidb-test</span></span>
<span class="line"><span>Starting component `cluster`: /home/tidb/.tiup/components/cluster/v1.3.1/tiup-cluster display tidb-test</span></span>
<span class="line"><span>Cluster type:       tidb</span></span>
<span class="line"><span>Cluster name:       tidb-test</span></span>
<span class="line"><span>Cluster version:    v4.0.2</span></span>
<span class="line"><span>SSH type:           builtin</span></span>
<span class="line"><span>Dashboard URL:      http://192.168.169.41:2379/dashboard</span></span>
<span class="line"><span>ID                    Role          Host            Ports                            OS/Arch       Status   Data Dir                                 Deploy Dir</span></span>
<span class="line"><span>--                    ----          ----            -----                            -------       ------   --------                                 ----------</span></span>
<span class="line"><span>192.168.169.42:9093   alertmanager  192.168.169.42  9093/9094                        linux/x86_64  Up       /data/tidb-data/alertmanager-9093        /data/tidb-deploy/alertmanager-9093</span></span>
<span class="line"><span>192.168.169.41:8300   cdc           192.168.169.41  8300                             linux/x86_64  Up       -                                        /data/tidb-deploy/cdc-8300</span></span>
<span class="line"><span>192.168.169.42:8300   cdc           192.168.169.42  8300                             linux/x86_64  Up       -                                        /data/tidb-deploy/cdc-8300</span></span>
<span class="line"><span>192.168.169.43:8300   cdc           192.168.169.43  8300                             linux/x86_64  Up       -                                        /data/tidb-deploy/cdc-8300</span></span>
<span class="line"><span>192.168.169.42:3000   grafana       192.168.169.42  3000                             linux/x86_64  Up       -                                        /data/tidb-deploy/grafana-3000</span></span>
<span class="line"><span>192.168.169.41:2379   pd            192.168.169.41  2379/2380                        linux/x86_64  Up|L|UI  /data/tidb-data/pd-2379                  /data/tidb-deploy/pd-2379</span></span>
<span class="line"><span>192.168.169.42:2379   pd            192.168.169.42  2379/2380                        linux/x86_64  Up       /data/tidb-data/pd-2379                  /data/tidb-deploy/pd-2379</span></span>
<span class="line"><span>192.168.169.43:2379   pd            192.168.169.43  2379/2380                        linux/x86_64  Up       /data/tidb-data/pd-2379                  /data/tidb-deploy/pd-2379</span></span>
<span class="line"><span>192.168.169.42:9090   prometheus    192.168.169.42  9090                             linux/x86_64  Up       /data/tidb-data/prometheus-9090          /data/tidb-deploy/prometheus-9090</span></span>
<span class="line"><span>192.168.169.41:4000   tidb          192.168.169.41  4000/10080                       linux/x86_64  Up       -                                        /data/tidb-deploy/tidb-4000</span></span>
<span class="line"><span>192.168.169.42:4000   tidb          192.168.169.42  4000/10080                       linux/x86_64  Up       -                                        /data/tidb-deploy/tidb-4000</span></span>
<span class="line"><span>192.168.169.43:4000   tidb          192.168.169.43  4000/10080                       linux/x86_64  Up       -                                        /data/tidb-deploy/tidb-4000</span></span>
<span class="line"><span>192.168.169.44:9000   tiflash       192.168.169.44  9000/8123/3930/20170/20292/8234  linux/x86_64  Up       /data/tiflash1/data,/data/tiflash2/data  /data/tidb-deploy/tiflash-9000</span></span>
<span class="line"><span>192.168.169.41:20160  tikv          192.168.169.41  20160/20180                      linux/x86_64  Up       /data/tidb-data/tikv-20160               /data/tidb-deploy/tikv-20160</span></span>
<span class="line"><span>192.168.169.42:20160  tikv          192.168.169.42  20160/20180                      linux/x86_64  Up       /data/tidb-data/tikv-20160               /data/tidb-deploy/tikv-20160</span></span>
<span class="line"><span>192.168.169.43:20160  tikv          192.168.169.43  20160/20180                      linux/x86_64  Up       /data/tidb-data/tikv-20160               /data/tidb-deploy/tikv-20160</span></span>
<span class="line"><span>Total nodes: 16</span></span></code></pre>
</div>]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[TiDB-TiUPÂ∑•ÂÖ∑ÈõÜÁæ§ÊªöÂä®ÂçáÁ∫ß]]></title>
            <link>https://askaric.com/zh/work/tidb/02TIDB-ÈÉ®ÁΩ≤ÂÆûË∑µ/2-2TiUP ÈÉ®ÁΩ≤ÂÆûË∑µ/03TiUP ÊªöÂä®ÂçáÁ∫ß TiDB.html</link>
            <guid>https://askaric.com/zh/work/tidb/02TIDB-ÈÉ®ÁΩ≤ÂÆûË∑µ/2-2TiUP ÈÉ®ÁΩ≤ÂÆûË∑µ/03TiUP ÊªöÂä®ÂçáÁ∫ß TiDB.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[# TiDB-TiUPÂ∑•ÂÖ∑ÈõÜÁæ§ÊªöÂä®ÂçáÁ∫ß
Êó∂Èó¥Ôºö2020-12-25

> [Ëé∑ÂèñÂçáÁ∫ßÁâàÊú¨ÈïúÂÉèÂåÖ](#Ëé∑ÂèñÂçáÁ∫ßÁâàÊú¨ÈïúÂÉèÂåÖ)  
> [ÂçáÁ∫ßÂâçÁéØÂ¢ÉÊ£ÄÊü•](#ÂçáÁ∫ßÂâçÁéØÂ¢ÉÊ£ÄÊü•)  
> [Â∞ÜÈõÜÁæ§ÂçáÁ∫ßÂà∞ÊåáÂÆöÁâàÊú¨](#Â∞ÜÈõÜÁæ§ÂçáÁ∫ßÂà∞ÊåáÂÆöÁâàÊú¨)  
> [TiUPÂ∑•ÂÖ∑ÊªöÂä®ÂçáÁ∫ß](#TiUPÂ∑•ÂÖ∑ÊªöÂä®ÂçáÁ∫ß)  
> [È™åËØÅÈõÜÁæ§ÂçáÁ∫ß](#È™åËØÅÈõÜÁæ§ÂçáÁ∫ß)  
> [Â∏∏ËßÅÈóÆÈ¢òËß£ÂÜ≥ÊñπÊ°à](#Â∏∏ËßÅÈóÆÈ¢òËß£ÂÜ≥ÊñπÊ°à)



## Ëé∑ÂèñÂçáÁ∫ßÁâàÊú¨ÈïúÂÉèÂåÖ

ÊñπÂºè‰∏ÄÔºö[**TiDBÁ§æÂå∫ÁâàËé∑ÂèñÊñπÂºèÔºöhttps://pingcap.com/download-cn/community/**](https://pingcap.com/download-cn/community/)

ÊñπÂºè‰∫åÔºöËÅîÁΩëTiUPÊúçÂä°Âô®ÊâìÂåÖscp
```
[tidb@tiup-tidb44 ~]$ tiup mirror clone tidb-community-server-v4.0.9-linux-amd64 v4.0.9 --os=linux --arch=amd64
Start to clone mirror, targetDir is tidb-community-server-v4.0.9-linux-amd64, selectedVersions are [v4.0.9]
If this does not meet expectations, please abort this process, read `tiup mirror clone --help` and run again
Arch [amd64]
OS [linux]
download https://tiup-mirrors.pingcap.com/alertmanager-v0.17.0-linux-amd64.tar.gz 22.54 MiB / 22.54 MiB 100.00% 5.48 MiB p/s                                                                                                
......
......                                          
download https://tiup-mirrors.pingcap.com/tiup-linux-amd64.tar.gz 8.49 MiB / 8.49 MiB 100.00% 12.42 MiB p/s 

[tidb@tiup-tidb44 ~]$ scp tidb-community-server-v4.0.9-linux-amd64.tar.gz 192.168.169.41:/home/tidb/
tidb@192.168.169.41's password: 
tidb-community-server-v4.0.9-linux-amd64.tar.gz                                                                                                                                 100% 1498MB  82.2MB/s   00:18    


[tidb@tiup-tidb41 ~]$ tar -zxvf tidb-community-server-v4.0.9-linux-amd64.tar.gz 
tidb-community-server-v4.0.9-linux-amd64/
......
......
tidb-community-server-v4.0.9-linux-amd64/local_install.sh

[tidb@tiup-tidb41 ~]$ ll
total 3101252
drwxr-xr-x. 3 tidb tidb       4096 Jan  9 01:40 tidb-community-server-v4.0.2-linux-amd64
-rw-rw-r--. 1 tidb tidb 1604720640 Jan  9 00:30 tidb-community-server-v4.0.2-linux-amd64.tar.gz
drwxr-xr-x. 3 tidb tidb       4096 Jan  9 02:44 tidb-community-server-v4.0.9-linux-amd64
-rw-rw-r--. 1 tidb tidb 1570949987 Jan  9 02:48 tidb-community-server-v4.0.9-linux-amd64.tar.gz

[tidb@tiup-tidb41 ~]$ cd tidb-community-server-v4.0.9-linux-amd64

[tidb@tiup-tidb41 tidb-community-server-v4.0.9-linux-amd64]$ ./local_install.sh 
Set mirror to /home/tidb/tidb-community-server-v4.0.9-linux-amd64 success
Detected shell: bash
Shell profile:  /home/tidb/.bash_profile
Installed path: /home/tidb/.tiup/bin/tiup
===============================================
1. source /home/tidb/.bash_profile
2. Have a try:   tiup playground
===============================================

[tidb@tiup-tidb41 tidb-community-server-v4.0.9-linux-amd64]$ source /home/tidb/.bash_profile


```

## ÂçáÁ∫ßÂâçÁéØÂ¢ÉÊ£ÄÊü•

 - Ê≥®ÊÑèÔºöÂú®ÂçáÁ∫ßÁöÑËøáÁ®ã‰∏≠‰∏çË¶ÅÊâßË°å DDL ËØ∑Ê±ÇÔºåÂê¶ÂàôÂèØËÉΩ‰ºöÂá∫Áé∞Ë°å‰∏∫Êú™ÂÆö‰πâÁöÑÈóÆÈ¢ò

Â¶Ç‰∏ãÊÉÖÂÜµ‰æø‰∏çËÉΩÊâßË°åÊªöÂä®‰∏äÁ∫ßÊìç‰Ωú
```
MySQL [(none)]> admin show ddl jobs where state !='synced'\G
*************************** 1. row ***************************
      JOB_ID: 90
     DB_NAME: jan
  TABLE_NAME: 
    JOB_TYPE: drop schema
SCHEMA_STATE: delete only
   SCHEMA_ID: 46
    TABLE_ID: 0
   ROW_COUNT: 0
  START_TIME: 2021-01-13 04:15:22
    END_TIME: NULL
       STATE: running
1 row in set (0.01 sec)
```


## Â∞ÜÈõÜÁæ§ÂçáÁ∫ßÂà∞ÊåáÂÆöÁâàÊú¨

ÂçáÁ∫ßÂâçÁâàÊú¨Êü•Áúã

```
[tidb@tiup-tidb41 ~]$ tiup cluster display tidb-test 
Starting component `cluster`: /home/tidb/.tiup/components/cluster/v1.3.1/tiup-cluster display tidb-test
Cluster type:       tidb
Cluster name:       tidb-test
Cluster version:    v4.0.2
SSH type:           builtin
Dashboard URL:      http://192.168.169.42:2379/dashboard

......
......
```

## TiUPÂ∑•ÂÖ∑ÊªöÂä®ÂçáÁ∫ß

```
[tidb@tiup-tidb41 tidb-community-server-v4.0.9-linux-amd64]$ tiup cluster upgrade tidb-test v4.0.9
Starting component `cluster`: /home/tidb/.tiup/components/cluster/v1.3.1/tiup-cluster upgrade tidb-test v4.0.9
This operation will upgrade tidb v4.0.2 cluster tidb-test to v4.0.9.
Do you want to continue? [y/N]: y

Upgrading cluster...
+ [ Serial ] - SSHKeySet: privateKey=/home/tidb/.tiup/storage/cluster/clusters/tidb-test/ssh/id_rsa, publicKey=/home/tidb/.tiup/storage/cluster/clusters/tidb-test/ssh/id_rsa.pub
+ [Parallel] - UserSSH: user=tidb, host=192.168.169.42
+ [Parallel] - UserSSH: user=tidb, host=192.168.169.41

......
......

Upgraded cluster `tidb-test` successfully
```

## È™åËØÅÈõÜÁæ§ÂçáÁ∫ß

ËßÇÂØüÂà∞Cluster versionÂ∑≤ÁªèÂèòÊõ¥‰∏∫‰∫Üv4.0.9

```
[tidb@tiup-tidb41 tidb-community-server-v4.0.9-linux-amd64]$ tiup cluster display tidb-test
Starting component `cluster`: /home/tidb/.tiup/components/cluster/v1.3.1/tiup-cluster display tidb-test
Cluster type:       tidb
Cluster name:       tidb-test
Cluster version:    v4.0.9
SSH type:           builtin
Dashboard URL:      http://192.168.169.42:2379/dashboard
ID                    Role          Host            Ports                            OS/Arch       Status   Data Dir                                 Deploy Dir
--                    ]]></description>
            <content:encoded><![CDATA[<h1 id="tidb-tiupÂ∑•ÂÖ∑ÈõÜÁæ§ÊªöÂä®ÂçáÁ∫ß" tabindex="-1">TiDB-TiUPÂ∑•ÂÖ∑ÈõÜÁæ§ÊªöÂä®ÂçáÁ∫ß <a class="header-anchor" href="#tidb-tiupÂ∑•ÂÖ∑ÈõÜÁæ§ÊªöÂä®ÂçáÁ∫ß" aria-label="Permalink to &quot;TiDB-TiUPÂ∑•ÂÖ∑ÈõÜÁæ§ÊªöÂä®ÂçáÁ∫ß&quot;"></a></h1>
<p>Êó∂Èó¥Ôºö2020-12-25</p>
<blockquote>
<p><a href="#Ëé∑ÂèñÂçáÁ∫ßÁâàÊú¨ÈïúÂÉèÂåÖ">Ëé∑ÂèñÂçáÁ∫ßÁâàÊú¨ÈïúÂÉèÂåÖ</a><br>
<a href="#ÂçáÁ∫ßÂâçÁéØÂ¢ÉÊ£ÄÊü•">ÂçáÁ∫ßÂâçÁéØÂ¢ÉÊ£ÄÊü•</a><br>
<a href="#Â∞ÜÈõÜÁæ§ÂçáÁ∫ßÂà∞ÊåáÂÆöÁâàÊú¨">Â∞ÜÈõÜÁæ§ÂçáÁ∫ßÂà∞ÊåáÂÆöÁâàÊú¨</a><br>
<a href="#TiUPÂ∑•ÂÖ∑ÊªöÂä®ÂçáÁ∫ß">TiUPÂ∑•ÂÖ∑ÊªöÂä®ÂçáÁ∫ß</a><br>
<a href="#È™åËØÅÈõÜÁæ§ÂçáÁ∫ß">È™åËØÅÈõÜÁæ§ÂçáÁ∫ß</a><br>
<a href="#Â∏∏ËßÅÈóÆÈ¢òËß£ÂÜ≥ÊñπÊ°à">Â∏∏ËßÅÈóÆÈ¢òËß£ÂÜ≥ÊñπÊ°à</a></p>
</blockquote>
<h2 id="Ëé∑ÂèñÂçáÁ∫ßÁâàÊú¨ÈïúÂÉèÂåÖ" tabindex="-1">Ëé∑ÂèñÂçáÁ∫ßÁâàÊú¨ÈïúÂÉèÂåÖ <a class="header-anchor" href="#Ëé∑ÂèñÂçáÁ∫ßÁâàÊú¨ÈïúÂÉèÂåÖ" aria-label="Permalink to &quot;Ëé∑ÂèñÂçáÁ∫ßÁâàÊú¨ÈïúÂÉèÂåÖ&quot;"></a></h2>
<p>ÊñπÂºè‰∏ÄÔºö<a href="https://pingcap.com/download-cn/community/" target="_blank" rel="noreferrer"><strong>TiDBÁ§æÂå∫ÁâàËé∑ÂèñÊñπÂºèÔºöhttps://pingcap.com/download-cn/community/</strong></a></p>
<p>ÊñπÂºè‰∫åÔºöËÅîÁΩëTiUPÊúçÂä°Âô®ÊâìÂåÖscp</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tiup-tidb44 ~]$ tiup mirror clone tidb-community-server-v4.0.9-linux-amd64 v4.0.9 --os=linux --arch=amd64</span></span>
<span class="line"><span>Start to clone mirror, targetDir is tidb-community-server-v4.0.9-linux-amd64, selectedVersions are [v4.0.9]</span></span>
<span class="line"><span>If this does not meet expectations, please abort this process, read `tiup mirror clone --help` and run again</span></span>
<span class="line"><span>Arch [amd64]</span></span>
<span class="line"><span>OS [linux]</span></span>
<span class="line"><span>download https://tiup-mirrors.pingcap.com/alertmanager-v0.17.0-linux-amd64.tar.gz 22.54 MiB / 22.54 MiB 100.00% 5.48 MiB p/s                                                                                                </span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>......                                          </span></span>
<span class="line"><span>download https://tiup-mirrors.pingcap.com/tiup-linux-amd64.tar.gz 8.49 MiB / 8.49 MiB 100.00% 12.42 MiB p/s </span></span>
<span class="line"><span></span></span>
<span class="line"><span>[tidb@tiup-tidb44 ~]$ scp tidb-community-server-v4.0.9-linux-amd64.tar.gz 192.168.169.41:/home/tidb/</span></span>
<span class="line"><span>tidb@192.168.169.41's password: </span></span>
<span class="line"><span>tidb-community-server-v4.0.9-linux-amd64.tar.gz                                                                                                                                 100% 1498MB  82.2MB/s   00:18    </span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>[tidb@tiup-tidb41 ~]$ tar -zxvf tidb-community-server-v4.0.9-linux-amd64.tar.gz </span></span>
<span class="line"><span>tidb-community-server-v4.0.9-linux-amd64/</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>tidb-community-server-v4.0.9-linux-amd64/local_install.sh</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[tidb@tiup-tidb41 ~]$ ll</span></span>
<span class="line"><span>total 3101252</span></span>
<span class="line"><span>drwxr-xr-x. 3 tidb tidb       4096 Jan  9 01:40 tidb-community-server-v4.0.2-linux-amd64</span></span>
<span class="line"><span>-rw-rw-r--. 1 tidb tidb 1604720640 Jan  9 00:30 tidb-community-server-v4.0.2-linux-amd64.tar.gz</span></span>
<span class="line"><span>drwxr-xr-x. 3 tidb tidb       4096 Jan  9 02:44 tidb-community-server-v4.0.9-linux-amd64</span></span>
<span class="line"><span>-rw-rw-r--. 1 tidb tidb 1570949987 Jan  9 02:48 tidb-community-server-v4.0.9-linux-amd64.tar.gz</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[tidb@tiup-tidb41 ~]$ cd tidb-community-server-v4.0.9-linux-amd64</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[tidb@tiup-tidb41 tidb-community-server-v4.0.9-linux-amd64]$ ./local_install.sh </span></span>
<span class="line"><span>Set mirror to /home/tidb/tidb-community-server-v4.0.9-linux-amd64 success</span></span>
<span class="line"><span>Detected shell: bash</span></span>
<span class="line"><span>Shell profile:  /home/tidb/.bash_profile</span></span>
<span class="line"><span>Installed path: /home/tidb/.tiup/bin/tiup</span></span>
<span class="line"><span>===============================================</span></span>
<span class="line"><span>1. source /home/tidb/.bash_profile</span></span>
<span class="line"><span>2. Have a try:   tiup playground</span></span>
<span class="line"><span>===============================================</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[tidb@tiup-tidb41 tidb-community-server-v4.0.9-linux-amd64]$ source /home/tidb/.bash_profile</span></span></code></pre>
</div><h2 id="ÂçáÁ∫ßÂâçÁéØÂ¢ÉÊ£ÄÊü•" tabindex="-1">ÂçáÁ∫ßÂâçÁéØÂ¢ÉÊ£ÄÊü• <a class="header-anchor" href="#ÂçáÁ∫ßÂâçÁéØÂ¢ÉÊ£ÄÊü•" aria-label="Permalink to &quot;ÂçáÁ∫ßÂâçÁéØÂ¢ÉÊ£ÄÊü•&quot;"></a></h2>
<ul>
<li>Ê≥®ÊÑèÔºöÂú®ÂçáÁ∫ßÁöÑËøáÁ®ã‰∏≠‰∏çË¶ÅÊâßË°å DDL ËØ∑Ê±ÇÔºåÂê¶ÂàôÂèØËÉΩ‰ºöÂá∫Áé∞Ë°å‰∏∫Êú™ÂÆö‰πâÁöÑÈóÆÈ¢ò</li>
</ul>
<p>Â¶Ç‰∏ãÊÉÖÂÜµ‰æø‰∏çËÉΩÊâßË°åÊªöÂä®‰∏äÁ∫ßÊìç‰Ωú</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>MySQL [(none)]> admin show ddl jobs where state !='synced'\G</span></span>
<span class="line"><span>*************************** 1. row ***************************</span></span>
<span class="line"><span>      JOB_ID: 90</span></span>
<span class="line"><span>     DB_NAME: jan</span></span>
<span class="line"><span>  TABLE_NAME: </span></span>
<span class="line"><span>    JOB_TYPE: drop schema</span></span>
<span class="line"><span>SCHEMA_STATE: delete only</span></span>
<span class="line"><span>   SCHEMA_ID: 46</span></span>
<span class="line"><span>    TABLE_ID: 0</span></span>
<span class="line"><span>   ROW_COUNT: 0</span></span>
<span class="line"><span>  START_TIME: 2021-01-13 04:15:22</span></span>
<span class="line"><span>    END_TIME: NULL</span></span>
<span class="line"><span>       STATE: running</span></span>
<span class="line"><span>1 row in set (0.01 sec)</span></span></code></pre>
</div><h2 id="Â∞ÜÈõÜÁæ§ÂçáÁ∫ßÂà∞ÊåáÂÆöÁâàÊú¨" tabindex="-1">Â∞ÜÈõÜÁæ§ÂçáÁ∫ßÂà∞ÊåáÂÆöÁâàÊú¨ <a class="header-anchor" href="#Â∞ÜÈõÜÁæ§ÂçáÁ∫ßÂà∞ÊåáÂÆöÁâàÊú¨" aria-label="Permalink to &quot;Â∞ÜÈõÜÁæ§ÂçáÁ∫ßÂà∞ÊåáÂÆöÁâàÊú¨&quot;"></a></h2>
<p>ÂçáÁ∫ßÂâçÁâàÊú¨Êü•Áúã</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tiup-tidb41 ~]$ tiup cluster display tidb-test </span></span>
<span class="line"><span>Starting component `cluster`: /home/tidb/.tiup/components/cluster/v1.3.1/tiup-cluster display tidb-test</span></span>
<span class="line"><span>Cluster type:       tidb</span></span>
<span class="line"><span>Cluster name:       tidb-test</span></span>
<span class="line"><span>Cluster version:    v4.0.2</span></span>
<span class="line"><span>SSH type:           builtin</span></span>
<span class="line"><span>Dashboard URL:      http://192.168.169.42:2379/dashboard</span></span>
<span class="line"><span></span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>......</span></span></code></pre>
</div><h2 id="tiupÂ∑•ÂÖ∑ÊªöÂä®ÂçáÁ∫ß" tabindex="-1">TiUPÂ∑•ÂÖ∑ÊªöÂä®ÂçáÁ∫ß <a class="header-anchor" href="#tiupÂ∑•ÂÖ∑ÊªöÂä®ÂçáÁ∫ß" aria-label="Permalink to &quot;TiUPÂ∑•ÂÖ∑ÊªöÂä®ÂçáÁ∫ß&quot;"></a></h2>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tiup-tidb41 tidb-community-server-v4.0.9-linux-amd64]$ tiup cluster upgrade tidb-test v4.0.9</span></span>
<span class="line"><span>Starting component `cluster`: /home/tidb/.tiup/components/cluster/v1.3.1/tiup-cluster upgrade tidb-test v4.0.9</span></span>
<span class="line"><span>This operation will upgrade tidb v4.0.2 cluster tidb-test to v4.0.9.</span></span>
<span class="line"><span>Do you want to continue? [y/N]: y</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Upgrading cluster...</span></span>
<span class="line"><span>+ [ Serial ] - SSHKeySet: privateKey=/home/tidb/.tiup/storage/cluster/clusters/tidb-test/ssh/id_rsa, publicKey=/home/tidb/.tiup/storage/cluster/clusters/tidb-test/ssh/id_rsa.pub</span></span>
<span class="line"><span>+ [Parallel] - UserSSH: user=tidb, host=192.168.169.42</span></span>
<span class="line"><span>+ [Parallel] - UserSSH: user=tidb, host=192.168.169.41</span></span>
<span class="line"><span></span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Upgraded cluster `tidb-test` successfully</span></span></code></pre>
</div><h2 id="È™åËØÅÈõÜÁæ§ÂçáÁ∫ß" tabindex="-1">È™åËØÅÈõÜÁæ§ÂçáÁ∫ß <a class="header-anchor" href="#È™åËØÅÈõÜÁæ§ÂçáÁ∫ß" aria-label="Permalink to &quot;È™åËØÅÈõÜÁæ§ÂçáÁ∫ß&quot;"></a></h2>
<p>ËßÇÂØüÂà∞Cluster versionÂ∑≤ÁªèÂèòÊõ¥‰∏∫‰∫Üv4.0.9</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tiup-tidb41 tidb-community-server-v4.0.9-linux-amd64]$ tiup cluster display tidb-test</span></span>
<span class="line"><span>Starting component `cluster`: /home/tidb/.tiup/components/cluster/v1.3.1/tiup-cluster display tidb-test</span></span>
<span class="line"><span>Cluster type:       tidb</span></span>
<span class="line"><span>Cluster name:       tidb-test</span></span>
<span class="line"><span>Cluster version:    v4.0.9</span></span>
<span class="line"><span>SSH type:           builtin</span></span>
<span class="line"><span>Dashboard URL:      http://192.168.169.42:2379/dashboard</span></span>
<span class="line"><span>ID                    Role          Host            Ports                            OS/Arch       Status   Data Dir                                 Deploy Dir</span></span>
<span class="line"><span>--                    ----          ----            -----                            -------       ------   --------                                 ----------</span></span>
<span class="line"><span>192.168.169.42:9093   alertmanager  192.168.169.42  9093/9094                        linux/x86_64  Up       /data/tidb-data/alertmanager-9093        /data/tidb-deploy/alertmanager-9093</span></span>
<span class="line"><span>192.168.169.41:8300   cdc           192.168.169.41  8300                             linux/x86_64  Up       -                                        /data/tidb-deploy/cdc-8300</span></span>
<span class="line"><span>192.168.169.42:8300   cdc           192.168.169.42  8300                             linux/x86_64  Up       -                                        /data/tidb-deploy/cdc-8300</span></span>
<span class="line"><span>192.168.169.43:8300   cdc           192.168.169.43  8300                             linux/x86_64  Up       -                                        /data/tidb-deploy/cdc-8300</span></span>
<span class="line"><span>192.168.169.42:3000   grafana       192.168.169.42  3000                             linux/x86_64  Up       -                                        /data/tidb-deploy/grafana-3000</span></span>
<span class="line"><span>192.168.169.41:2379   pd            192.168.169.41  2379/2380                        linux/x86_64  Up       /data/tidb-data/pd-2379                  /data/tidb-deploy/pd-2379</span></span>
<span class="line"><span>192.168.169.42:2379   pd            192.168.169.42  2379/2380                        linux/x86_64  Up|L|UI  /data/tidb-data/pd-2379                  /data/tidb-deploy/pd-2379</span></span>
<span class="line"><span>192.168.169.43:2379   pd            192.168.169.43  2379/2380                        linux/x86_64  Up       /data/tidb-data/pd-2379                  /data/tidb-deploy/pd-2379</span></span>
<span class="line"><span>192.168.169.42:9090   prometheus    192.168.169.42  9090                             linux/x86_64  Up       /data/tidb-data/prometheus-9090          /data/tidb-deploy/prometheus-9090</span></span>
<span class="line"><span>192.168.169.41:4000   tidb          192.168.169.41  4000/10080                       linux/x86_64  Up       -                                        /data/tidb-deploy/tidb-4000</span></span>
<span class="line"><span>192.168.169.42:4000   tidb          192.168.169.42  4000/10080                       linux/x86_64  Up       -                                        /data/tidb-deploy/tidb-4000</span></span>
<span class="line"><span>192.168.169.43:4000   tidb          192.168.169.43  4000/10080                       linux/x86_64  Up       -                                        /data/tidb-deploy/tidb-4000</span></span>
<span class="line"><span>192.168.169.44:9000   tiflash       192.168.169.44  9000/8123/3930/20170/20292/8234  linux/x86_64  Up       /data/tiflash1/data,/data/tiflash2/data  /data/tidb-deploy/tiflash-9000</span></span>
<span class="line"><span>192.168.169.41:20160  tikv          192.168.169.41  20160/20180                      linux/x86_64  Up       /data/tidb-data/tikv-20160               /data/tidb-deploy/tikv-20160</span></span>
<span class="line"><span>192.168.169.42:20160  tikv          192.168.169.42  20160/20180                      linux/x86_64  Up       /data/tidb-data/tikv-20160               /data/tidb-deploy/tikv-20160</span></span>
<span class="line"><span>192.168.169.43:20160  tikv          192.168.169.43  20160/20180                      linux/x86_64  Up       /data/tidb-data/tikv-20160               /data/tidb-deploy/tikv-20160</span></span>
<span class="line"><span>Total nodes: 16</span></span></code></pre>
</div><h2 id="Â∏∏ËßÅÈóÆÈ¢òËß£ÂÜ≥ÊñπÊ°à" tabindex="-1">Â∏∏ËßÅÈóÆÈ¢òËß£ÂÜ≥ÊñπÊ°à <a class="header-anchor" href="#Â∏∏ËßÅÈóÆÈ¢òËß£ÂÜ≥ÊñπÊ°à" aria-label="Permalink to &quot;Â∏∏ËßÅÈóÆÈ¢òËß£ÂÜ≥ÊñπÊ°à&quot;"></a></h2>
<ul>
<li>v4.0.9ÁâàÊú¨ÂçáÁ∫ßÊó∂Âá∫Áé∞Run Command TimeoutÈîôËØØËß£ÂÜ≥</li>
</ul>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tiup-tidb41 tidb-community-server-v4.0.9-linux-amd64]$ tiup cluster upgrade tidb-test v4.0.9</span></span>
<span class="line"><span>Starting component `cluster`: /home/tidb/.tiup/components/cluster/v1.3.1/tiup-cluster upgrade tidb-test v4.0.9</span></span>
<span class="line"><span>This operation will upgrade tidb v4.0.2 cluster tidb-test to v4.0.9.</span></span>
<span class="line"><span>Do you want to continue? [y/N]: y</span></span>
<span class="line"><span>Upgrading cluster...</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>+ [ Serial ] - InitConfig: cluster=tidb-test, user=tidb, host=192.168.169.42, path=/home/tidb/.tiup/storage/cluster/clusters/tidb-test/config-cache/tikv-20160.service, deploy_dir=/data/tidb-deploy/tikv-20160, data_dir=[/data/tidb-data/tikv-20160], log_dir=/data/tidb-deploy/tikv-20160/log, cache_dir=/home/tidb/.tiup/storage/cluster/clusters/tidb-test/config-cache</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Error: stderr: Run Command Timeout!</span></span>
<span class="line"><span>: executor.ssh.execute_timedout: Execute command over SSH timedout for 'tidb@192.168.169.44:22' {ssh_stderr: Run Command Timeout!</span></span>
<span class="line"><span>, ssh_stdout: , ssh_command: export LANG=C; PATH=$PATH:/usr/bin:/usr/sbin tar --no-same-owner -zxf /data/tidb-deploy/tiflash-9000/bin/tiflash-v4.0.9-linux-amd64.tar.gz -C /data/tidb-deploy/tiflash-9000/bin &#x26;&#x26; rm /data/tidb-deploy/tiflash-9000/bin/tiflash-v4.0.9-linux-amd64.tar.gz}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Verbose debug logs has been written to /home/tidb/.tiup/logs/tiup-cluster-debug-2021-01-10-01-04-18.log.</span></span>
<span class="line"><span>Error: run `/home/tidb/.tiup/components/cluster/v1.3.1/tiup-cluster` (wd:/home/tidb/.tiup/data/SLfUqGv) failed: exit status 1</span></span></code></pre>
</div><p>ÈÄöËøáÊåáÂÆöwait-timeoutÂèÇÊï∞Â¢ûÂ§ßSSH CommandÁöÑÊâßË°åÊó∂Èó¥</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tiup-tidb41 tidb-community-server-v4.0.9-linux-amd64]$ tiup cluster upgrade tidb-test v4.0.9 --ssh-timeout 100000000 --wait-timeout 100000000</span></span>
<span class="line"><span>Starting component `cluster`: /home/tidb/.tiup/components/cluster/v1.3.1/tiup-cluster upgrade tidb-test v4.0.9 --wait-timeout 100000000</span></span>
<span class="line"><span>This operation will upgrade tidb v4.0.2 cluster tidb-test to v4.0.9.</span></span>
<span class="line"><span>Do you want to continue? [y/N]: y</span></span>
<span class="line"><span>Upgrading cluster...</span></span>
<span class="line"><span>+ [ Serial ] - SSHKeySet: privateKey=/home/tidb/.tiup/storage/cluster/clusters/tidb-test/ssh/id_rsa, publicKey=/home/tidb/.tiup/storage/cluster/clusters/tidb-test/ssh/id_rsa.pub</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>Upgraded custer `tidb-test` successfully</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>[tidb@tiup-tidb41 tidb-community-server-v4.0.9-linux-amd64]$ tiup cluster display tidb-test</span></span>
<span class="line"><span>Starting component `cluster`: /home/tidb/.tiup/components/cluster/v1.3.1/tiup-cluster display tidb-test</span></span>
<span class="line"><span>Cluster type:       tidb</span></span>
<span class="line"><span>Cluster name:       tidb-test</span></span>
<span class="line"><span>Cluster version:    v4.0.9</span></span>
<span class="line"><span>SSH type:           builtin</span></span>
<span class="line"><span>Dashboard URL:      http://192.168.169.41:2379/dashboard</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>......</span></span></code></pre>
</div>]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[TiDB-ÂçïÊú∫Â§öTiKVÂÆû‰æã„ÄÅÂ§öTiDBÂÆû‰æãÈÉ®ÁΩ≤]]></title>
            <link>https://askaric.com/zh/work/tidb/02TIDB-ÈÉ®ÁΩ≤ÂÆûË∑µ/2-2TiUP ÈÉ®ÁΩ≤ÂÆûË∑µ/04TiUP ÂçïÊú∫Ê∑∑ÈÉ®Â§öÂÆû‰æã.html</link>
            <guid>https://askaric.com/zh/work/tidb/02TIDB-ÈÉ®ÁΩ≤ÂÆûË∑µ/2-2TiUP ÈÉ®ÁΩ≤ÂÆûË∑µ/04TiUP ÂçïÊú∫Ê∑∑ÈÉ®Â§öÂÆû‰æã.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[Êó∂Èó¥Ôºö2021-01-06
 summary

&gt; - ÈõÜÁæ§ËäÇÁÇπÁéØÂ¢ÉÈÖçÁΩÆ‰∏éÂèÇÊï∞ÈôêÂà∂
&gt;   - ‰∏≠ÊéßÊú∫Êìç‰ΩúÈÉ®ÁΩ≤Êú∫Âª∫Áî®Êà∑
&gt;   - ‰∏≠ÊéßÊú∫Êìç‰ΩúÈÉ®ÁΩ≤Êú∫ÈÖçÁΩÆntpÊúçÂä°
&gt;   - ]]></description>
            <content:encoded><![CDATA[<h1 id="tidb-ÂçïÊú∫Â§ötikvÂÆû‰æã„ÄÅÂ§ötidbÂÆû‰æãÈÉ®ÁΩ≤" tabindex="-1">TiDB-ÂçïÊú∫Â§öTiKVÂÆû‰æã„ÄÅÂ§öTiDBÂÆû‰æãÈÉ®ÁΩ≤ <a class="header-anchor" href="#tidb-ÂçïÊú∫Â§ötikvÂÆû‰æã„ÄÅÂ§ötidbÂÆû‰æãÈÉ®ÁΩ≤" aria-label="Permalink to &quot;TiDB-ÂçïÊú∫Â§öTiKVÂÆû‰æã„ÄÅÂ§öTiDBÂÆû‰æãÈÉ®ÁΩ≤&quot;"></a></h1>
<p>Êó∂Èó¥Ôºö2021-01-06</p>
<h2 id="summary" tabindex="-1">summary <a class="header-anchor" href="#summary" aria-label="Permalink to &quot;summary&quot;"></a></h2>
<blockquote>
<ul>
<li><a href="#ÈÖçÁΩÆinventoryÁöÑTiKVÈÉ®ÂàÜ">ÈÖçÁΩÆinventoryÁöÑTiKVÈÉ®ÂàÜ</a></li>
<li><a href="#ÈõÜÁæ§ËäÇÁÇπÁéØÂ¢ÉÈÖçÁΩÆ‰∏éÂèÇÊï∞ÈôêÂà∂">ÈõÜÁæ§ËäÇÁÇπÁéØÂ¢ÉÈÖçÁΩÆ‰∏éÂèÇÊï∞ÈôêÂà∂</a>
<ul>
<li><a href="#‰∏≠ÊéßÊú∫Êìç‰ΩúÈÉ®ÁΩ≤Êú∫Âª∫Áî®Êà∑">‰∏≠ÊéßÊú∫Êìç‰ΩúÈÉ®ÁΩ≤Êú∫Âª∫Áî®Êà∑</a></li>
<li><a href="#‰∏≠ÊéßÊú∫Êìç‰ΩúÈÉ®ÁΩ≤Êú∫ÈÖçÁΩÆntpÊúçÂä°">‰∏≠ÊéßÊú∫Êìç‰ΩúÈÉ®ÁΩ≤Êú∫ÈÖçÁΩÆntpÊúçÂä°</a></li>
<li><a href="#‰∏≠ÊéßÂèäÊìç‰ΩúÈÉ®ÁΩ≤Êú∫ËÆæÁΩÆCPUÊ®°Âºè">‰∏≠ÊéßÂèäÊìç‰ΩúÈÉ®ÁΩ≤Êú∫ËÆæÁΩÆCPUÊ®°Âºè</a></li>
</ul>
</li>
<li><a href="#ansibleÈÉ®ÁΩ≤ÂëΩ‰ª§ÈªÑÈáë‰∫îÊ≠•È™§Ëµ∞">ansibleÈÉ®ÁΩ≤ÂëΩ‰ª§ÈªÑÈáë‰∫îÊ≠•È™§Ëµ∞</a>
<ul>
<li><a href="#ÊâßË°ålocal_prepareËÅîÁΩë‰∏ãËΩΩbinaryÂåÖ">ÊâßË°ålocal_prepareËÅîÁΩë‰∏ãËΩΩbinaryÂåÖ</a></li>
<li><a href="#ÂàùÂßãÂåñÁ≥ªÁªüÁéØÂ¢ÉÂπ∂‰øÆÊîπÂÜÖÊ†∏ÂèÇÊï∞">ÂàùÂßãÂåñÁ≥ªÁªüÁéØÂ¢ÉÂπ∂‰øÆÊîπÂÜÖÊ†∏ÂèÇÊï∞</a></li>
<li><a href="#ÈÉ®ÁΩ≤TiDBÈõÜÁæ§ËΩØ‰ª∂">ÈÉ®ÁΩ≤TiDBÈõÜÁæ§ËΩØ‰ª∂</a></li>
<li><a href="#ÂÆâË£ÖDashboard‰æùËµñÂåÖ">ÂÆâË£ÖDashboard‰æùËµñÂåÖ</a></li>
<li><a href="#ÊâßË°åstartÂêØÂä®TiDBÈõÜÁæ§">ÊâßË°åstartÂêØÂä®TiDBÈõÜÁæ§</a></li>
</ul>
</li>
<li><a href="#È™åËØÅÊòØÂê¶ÂÆâË£ÖÊàêÂäü">È™åËØÅÊòØÂê¶ÂÆâË£ÖÊàêÂäü</a></li>
</ul>
</blockquote>
<h2 id="ÈÖçÁΩÆinventoryÁöÑtikvÈÉ®ÂàÜ" tabindex="-1">ÈÖçÁΩÆinventoryÁöÑTiKVÈÉ®ÂàÜ <a class="header-anchor" href="#ÈÖçÁΩÆinventoryÁöÑtikvÈÉ®ÂàÜ" aria-label="Permalink to &quot;ÈÖçÁΩÆinventoryÁöÑTiKVÈÉ®ÂàÜ&quot;"></a></h2>
<p>ÈÖçÁΩÆËåÉ‰æãÔºö</p>
<div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">@</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">tidb01</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">41</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> tidb</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">ansible]</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">$</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> vi inventory.ini</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb_servers]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">TiDB1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">11</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ansible_host</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">192.168</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.1.42 deploy_dir</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">data1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">deploy tikv_port</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">4000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> tikv_status_port</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">10080</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">TiDB1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">12</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ansible_host</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">192.168</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.1.42 deploy_dir</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">data2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">deploy tikv_port</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">4001</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> tikv_status_port</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">10081</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">TiDB2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">21</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ansible_host</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">192.168</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.1.43 deploy_dir</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">data1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">deploy tikv_port</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">4000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> tikv_status_port</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">10080</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">TiDB2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">22</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ansible_host</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">192.168</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.1.43 deploy_dir</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">data2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">deploy tikv_port</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">4001</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> tikv_status_port</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">10081</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[pd_servers]</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">192.168</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.1.41</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">192.168</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.1.42</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">192.168</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.1.43</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Ê≥®ÊÑèÔºöË¶Å‰ΩøÁî® TiKV ÁöÑ labelsÔºåÂøÖÈ°ªÂêåÊó∂ÈÖçÁΩÆ PD ÁöÑ location_labels ÂèÇÊï∞ÔºåÂê¶Âàô labels ËÆæÁΩÆ‰∏çÁîüÊïà„ÄÇ</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Â§öÂÆû‰æãÂú∫ÊôØÈúÄË¶ÅÈ¢ùÂ§ñÈÖçÁΩÆ status Á´ØÂè£ÔºåÁ§∫‰æãÂ¶Ç‰∏ãÔºö</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tikv_servers]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">TiKV1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">11</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ansible_host</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">192.168</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.1.41 deploy_dir</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">data1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">deploy tikv_port</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20171</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> tikv_status_port</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20181</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> labels</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"host=tikv1"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">TiKV1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">12</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ansible_host</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">192.168</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.1.41 deploy_dir</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">data2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">deploy tikv_port</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20172</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> tikv_status_port</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20182</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> labels</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"host=tikv1"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">TiKV2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">21</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ansible_host</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">192.168</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.1.42 deploy_dir</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">data1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">deploy tikv_port</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20171</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> tikv_status_port</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20181</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> labels</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"host=tikv2"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">TiKV2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">22</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ansible_host</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">192.168</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.1.42 deploy_dir</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">data2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">deploy tikv_port</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20172</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> tikv_status_port</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20182</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> labels</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"host=tikv2"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">TiKV3</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">31</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ansible_host</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">192.168</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.1.43 deploy_dir</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">data1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">deploy tikv_port</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20171</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> tikv_status_port</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20181</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> labels</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"host=tikv3"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">TiKV3</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ansible_host</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">192.168</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.1.43 deploy_dir</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">data2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">deploy tikv_port</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20172</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> tikv_status_port</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20182</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> labels</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"host=tikv3"</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[monitoring_servers]</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">192.168</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.1.42</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[grafana_servers]</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">192.168</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.1.42</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[monitored_servers]</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># 192.168.1.41</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">192.168</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.1.42</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">192.168</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.1.43</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># ‰∏∫‰Ωø TiKV ÁöÑ labels ËÆæÁΩÆÁîüÊïàÔºåÈÉ®ÁΩ≤ÈõÜÁæ§Êó∂ÂøÖÈ°ªËÆæÁΩÆ PD ÁöÑ location_labels ÂèÇÊï∞</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[pd_servers:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">vars</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">location_labels </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"host"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]</span></span></code></pre>
</div><p>labelsÂèÇÊï∞‰ΩúÁî®Ôºö</p>
<ul>
<li>labels ÊòØ Region Ë∞ÉÂ∫¶ÁöÑÊúÄÂ∞èÂçïÂÖÉÔºåÊØè‰∏Ä‰∏™ raft group ‰∏≠‰∏çÂêåÁöÑ replica ‰∏ç‰ºöÂú®Êâ©Â±ïËøáÁ®ã‰∏≠Ë¢´ËøÅÁßªÂà∞Âêå‰∏Ä‰∏™lableÂçïÂÖÉÔºåÈÅøÂÖçËøôÁßçÊÉÖÂÜµ‰∏ã server ÂÆïÊú∫ÂØºËá¥ÁöÑÂçïÁÇπÈóÆÈ¢òÔºà3ÂâØÊú¨Ôºå2ÂâØÊú¨ËêΩÂú®Âêå‰∏Ä‰∏™serverÔºâ„ÄÇ</li>
<li>raft group ÁöÑ multi-replica ‰∏ªË¶ÅËß£ÂÜ≥ÁöÑÊòØÊï∞ÊçÆÁöÑÂÆπÁÅæÈóÆÈ¢òÔºålabels ÂèÇÊï∞ÂèØ‰ª•ÊúâÊïàÈò≤Ê≠¢ÈöèÊï∞ÊçÆÊâ©Â±ïÔºåÂú®Region ËøÅÁßªËøáÁ®ã‰∏≠Âõ†Êï£ÂàóËÆ°ÁÆó Region ËøÅÁßª‰ΩçÁΩÆÊó∂ÔºåÁî±‰∫éÂÜ≤ÊíûÂØºËá¥ÁöÑÂêå‰∏Ä‰∏™ server Â≠òÂÇ®Âêå‰∏Ä‰∏™ Region group ÁöÑÂ§ö‰∏™ replica ÁöÑÊÉÖÂÜµ„ÄÇ</li>
<li>ÂèØ‰ª•Áªô‰∏Ä‰∏™ÊúçÂä°Âô®Êâì‰∏Ä‰∏™ labels„ÄÅÂèØ‰ª•Áªô‰∏Ä‰∏™ÊúçÂä°Âô®Êú∫ÊüúÊâì‰∏Ä‰∏™ labelsÔºå‰πüÂèØ‰ª•ÊòØ‰∏Ä‰∏™ IDC Êâì‰∏Ä‰∏™ labels„ÄÇ</li>
</ul>
<h2 id="ÈõÜÁæ§ËäÇÁÇπÁéØÂ¢ÉÈÖçÁΩÆ‰∏éÂèÇÊï∞ÈôêÂà∂" tabindex="-1">ÈõÜÁæ§ËäÇÁÇπÁéØÂ¢ÉÈÖçÁΩÆ‰∏éÂèÇÊï∞ÈôêÂà∂ <a class="header-anchor" href="#ÈõÜÁæ§ËäÇÁÇπÁéØÂ¢ÉÈÖçÁΩÆ‰∏éÂèÇÊï∞ÈôêÂà∂" aria-label="Permalink to &quot;ÈõÜÁæ§ËäÇÁÇπÁéØÂ¢ÉÈÖçÁΩÆ‰∏éÂèÇÊï∞ÈôêÂà∂&quot;"></a></h2>
<h4 id="block-cache-size‰∏ãÁöÑcapacityÂèÇÊï∞Ë∞ÉÊï¥" tabindex="-1">block-cache-size‰∏ãÁöÑcapacityÂèÇÊï∞Ë∞ÉÊï¥ <a class="header-anchor" href="#block-cache-size‰∏ãÁöÑcapacityÂèÇÊï∞Ë∞ÉÊï¥" aria-label="Permalink to &quot;block-cache-size‰∏ãÁöÑcapacityÂèÇÊï∞Ë∞ÉÊï¥&quot;"></a></h4>
<p>Â§öÂÆû‰æãÊÉÖÂÜµ‰∏ãÔºåÈúÄË¶Å‰øÆÊîπ tidb-ansible/conf/tikv.yml ‰∏≠ block-cache-size ‰∏ãÈù¢ÁöÑ capacity ÂèÇÊï∞;
Áî®‰ª•ÈôêÂà∂ÊØè‰∏™TiKVÂÆû‰æãÁî®‰∫éblock-cacheÁöÑÂÜÖÂ≠ò‰ΩøÁî®ÈôêÂà∂„ÄÇ</p>
<p>ÂÆòÊñπÊé®ËçêËÆæÁΩÆÔºöcapacity = MEM_TOTAL * 0.5 / TiKV ÂÆû‰æãÊï∞Èáè</p>
<p>Êú¨‰æãÔºöÂêÑËäÇÁÇπÂÜÖÂ≠ò3GÔºåÊØè‰∏™ËäÇÁÇπÈÉ®ÁΩ≤‰∏§Âè∞ÂÆû‰æãÔºåÂõ†Ê≠§ capacity = 3 * 0.5 / 2 = 0.75GB</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tidb01-41 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ vi </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">/tidb-ansible/conf/tikv.yml</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">storage:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  block-cache:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    capacity:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "0.75GB"</span></span></code></pre>
</div><h4 id="readpool‰∏ãcoprocessorÁöÑÂπ∂ÂèëÂ∫¶Ë∞ÉÊï¥" tabindex="-1">readpool‰∏ãcoprocessorÁöÑÂπ∂ÂèëÂ∫¶Ë∞ÉÊï¥ <a class="header-anchor" href="#readpool‰∏ãcoprocessorÁöÑÂπ∂ÂèëÂ∫¶Ë∞ÉÊï¥" aria-label="Permalink to &quot;readpool‰∏ãcoprocessorÁöÑÂπ∂ÂèëÂ∫¶Ë∞ÉÊï¥&quot;"></a></h4>
<p>ÂÆòÊñπÊé®ËçêËÆæÁΩÆÔºö ÂèÇÊï∞ÂÄº = ( CPU Ê†∏ÂøÉÊï∞Èáè * 0.8 ) / TiKV ÂÆû‰æãÊï∞Èáè</p>
<p>Êú¨‰æãÔºöÂêÑËäÇÁÇπÈÉ®ÁΩ≤‰∏§‰∏™ÂÆû‰æãÔºåCPU Ê†∏ÂøÉÊï∞Èáè 8 ‰∏™ÔºåÂèÇÊï∞ÂÄº = ( 8 * 0.8 ) / 2 = 3</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># ‰ΩøÁî® shell ÂëΩ‰ª§Êü•ÁúãÈÄªËæëÊ†∏ÂøÉÊï∞Èáè</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tidb01-41 tidb-ansible]$ cat /proc/cpuinfo</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "processor"</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> wc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -l</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">8</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tidb01-41 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ vi </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">/tidb-ansible/conf/tikv.yml</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">readpool:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  coprocessor:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    # Notice: if CPU_NUM > 8, default thread pool size for coprocessors</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    # will be set to CPU_NUM * 0.8.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    high-concurrency:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 3</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    normal-concurrency:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 3</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    low-concurrency:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 3</span></span></code></pre>
</div><h4 id="raftstore‰∏ãÁöÑcapacityÂèÇÊï∞Ë∞ÉÊï¥" tabindex="-1">raftstore‰∏ãÁöÑcapacityÂèÇÊï∞Ë∞ÉÊï¥ <a class="header-anchor" href="#raftstore‰∏ãÁöÑcapacityÂèÇÊï∞Ë∞ÉÊï¥" aria-label="Permalink to &quot;raftstore‰∏ãÁöÑcapacityÂèÇÊï∞Ë∞ÉÊï¥&quot;"></a></h4>
<p>Â¶ÇÊûúÂ§ö‰∏™ TiKV ÂÆû‰æãÈÉ®ÁΩ≤Âú®Âêå‰∏ÄÂùóÁâ©ÁêÜÁ£ÅÁõò‰∏äÔºåÈúÄË¶Å‰øÆÊîπ conf/tikv.yml ‰∏≠ÁöÑ capacity ÂèÇÊï∞ÔºåÈôêÂà∂ÊØè‰∏™ TiKV ÂÆû‰æãÊâÄËÉΩ‰ΩøÁî®ÁöÑÁ£ÅÁõòÂÆπÈáèÔºåÂÆòÊñπÊé®ËçêÈÖçÁΩÆÔºöcapacity = Á£ÅÁõòÊÄªÂÆπÈáè / TiKV ÂÆû‰æãÊï∞Èáè„ÄÇ</p>
<p>Êú¨‰æãÔºöÂêÑËäÇÁÇπÈôêÂà∂‰ΩøÁî®Á£ÅÁõòÂÆπÈáè‰∏∫ 5 GB Ôºåcapacity = 5GB</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>vi ~/tidb-ansible/conf/tikv.yml</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>raftstore:</span></span>
<span class="line"><span>  capacity = 5GB</span></span></code></pre>
</div><h2 id="‰∏≠ÊéßÊú∫Êìç‰ΩúÈÉ®ÁΩ≤Êú∫Âª∫Áî®Êà∑" tabindex="-1">‰∏≠ÊéßÊú∫Êìç‰ΩúÈÉ®ÁΩ≤Êú∫Âª∫Áî®Êà∑ <a class="header-anchor" href="#‰∏≠ÊéßÊú∫Êìç‰ΩúÈÉ®ÁΩ≤Êú∫Âª∫Áî®Êà∑" aria-label="Permalink to &quot;‰∏≠ÊéßÊú∫Êìç‰ΩúÈÉ®ÁΩ≤Êú∫Âª∫Áî®Êà∑&quot;"></a></h2>
<p>ÊâßË°å‰ª•‰∏ãÂëΩ‰ª§Ôºå‰æùÊçÆËæìÂÖ•<em><strong>ÈÉ®ÁΩ≤ÁõÆÊ†áÊú∫Âô®</strong></em>ÁöÑ root Áî®Êà∑ÂØÜÁ†ÅÔºõ
Êú¨‰æãÊñ∞Â¢ûËäÇÁÇπIP‰∏∫192.168.1.44Ôºõ</p>
<div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">@</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">tidb01</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">41</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> tidb</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">ansible]</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">$</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> vi hosts.ini </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">@</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">tidb01</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">41</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> tidb</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">ansible]</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">$</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> cat hosts.ini </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[servers]</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">192.168</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.1.44</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">all</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">vars</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">username </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> tidb</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">ntp_server </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> cn.pool.ntp.org</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">@</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">tidb01</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">41</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> tidb</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">ansible]</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">$</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ansible</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">playbook </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">i hosts.ini create_users.yml </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">u root </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">k</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">SSH</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> password: </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">PLAY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">all</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">***************************************************************************************************************</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">Congrats! All goes well. :</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span></code></pre>
</div><p>È™åËØÅ‰∫í‰ø°Êó∂ÂÄôÊàêÂäü</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tidb01-41 tidb-ansible]$ ansible -i inventory.ini all -m shell -a 'whoami'</span></span>
<span class="line"><span>192.168.1.43 | SUCCESS | rc=0 >></span></span>
<span class="line"><span>tidb</span></span>
<span class="line"><span></span></span>
<span class="line"><span>192.168.1.42 | SUCCESS | rc=0 >></span></span>
<span class="line"><span>tidb</span></span>
<span class="line"><span></span></span>
<span class="line"><span>TiDB1-21 | SUCCESS | rc=0 >></span></span>
<span class="line"><span>tidb</span></span>
<span class="line"><span></span></span>
<span class="line"><span>TiDB1-22 | SUCCESS | rc=0 >></span></span>
<span class="line"><span>tidb</span></span>
<span class="line"><span></span></span>
<span class="line"><span>TiDB1-12 | SUCCESS | rc=0 >></span></span>
<span class="line"><span>tidb</span></span>
<span class="line"><span></span></span>
<span class="line"><span>192.168.1.41 | SUCCESS | rc=0 >></span></span>
<span class="line"><span>tidb</span></span>
<span class="line"><span></span></span>
<span class="line"><span>TiDB1-11 | SUCCESS | rc=0 >></span></span>
<span class="line"><span>tidb</span></span>
<span class="line"><span></span></span>
<span class="line"><span>TiKV3-31 | SUCCESS | rc=0 >></span></span>
<span class="line"><span>tidb</span></span>
<span class="line"><span></span></span>
<span class="line"><span>TiKV3-32 | SUCCESS | rc=0 >></span></span>
<span class="line"><span>tidb</span></span>
<span class="line"><span></span></span>
<span class="line"><span>TiKV2-21 | SUCCESS | rc=0 >></span></span>
<span class="line"><span>tidb</span></span>
<span class="line"><span></span></span>
<span class="line"><span>TiKV2-22 | SUCCESS | rc=0 >></span></span>
<span class="line"><span>tidb</span></span>
<span class="line"><span></span></span>
<span class="line"><span>TiKV1-11 | SUCCESS | rc=0 >></span></span>
<span class="line"><span>tidb</span></span>
<span class="line"><span></span></span>
<span class="line"><span>TiKV1-12 | SUCCESS | rc=0 >></span></span>
<span class="line"><span>tidb</span></span></code></pre>
</div><p>È™åËØÅsudo ÂÖçÂØÜÁ†ÅÈÖçÁΩÆÊàêÂäü</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tidb01-41 tidb-ansible]$ ansible -i inventory.ini all -m shell -a 'whoami' -b</span></span>
<span class="line"><span>192.168.1.43 | SUCCESS | rc=0 >></span></span>
<span class="line"><span>root</span></span>
<span class="line"><span></span></span>
<span class="line"><span>TiDB1-12 | SUCCESS | rc=0 >></span></span>
<span class="line"><span>root</span></span>
<span class="line"><span></span></span>
<span class="line"><span>192.168.1.41 | SUCCESS | rc=0 >></span></span>
<span class="line"><span>root</span></span>
<span class="line"><span></span></span>
<span class="line"><span>192.168.1.42 | SUCCESS | rc=0 >></span></span>
<span class="line"><span>root</span></span>
<span class="line"><span></span></span>
<span class="line"><span>TiDB1-11 | SUCCESS | rc=0 >></span></span>
<span class="line"><span>root</span></span>
<span class="line"><span></span></span>
<span class="line"><span>TiDB1-21 | SUCCESS | rc=0 >></span></span>
<span class="line"><span>root</span></span>
<span class="line"><span></span></span>
<span class="line"><span>TiDB1-22 | SUCCESS | rc=0 >></span></span>
<span class="line"><span>root</span></span>
<span class="line"><span></span></span>
<span class="line"><span>TiKV2-21 | SUCCESS | rc=0 >></span></span>
<span class="line"><span>root</span></span>
<span class="line"><span></span></span>
<span class="line"><span>TiKV2-22 | SUCCESS | rc=0 >></span></span>
<span class="line"><span>root</span></span>
<span class="line"><span></span></span>
<span class="line"><span>TiKV3-31 | SUCCESS | rc=0 >></span></span>
<span class="line"><span>root</span></span>
<span class="line"><span></span></span>
<span class="line"><span>TiKV3-32 | SUCCESS | rc=0 >></span></span>
<span class="line"><span>root</span></span>
<span class="line"><span></span></span>
<span class="line"><span>TiKV1-11 | SUCCESS | rc=0 >></span></span>
<span class="line"><span>root</span></span>
<span class="line"><span></span></span>
<span class="line"><span>TiKV1-12 | SUCCESS | rc=0 >></span></span>
<span class="line"><span>root</span></span></code></pre>
</div><h2 id="‰∏≠ÊéßÊú∫Êìç‰ΩúÈÉ®ÁΩ≤Êú∫ÈÖçÁΩÆntpÊúçÂä°" tabindex="-1">‰∏≠ÊéßÊú∫Êìç‰ΩúÈÉ®ÁΩ≤Êú∫ÈÖçÁΩÆntpÊúçÂä° <a class="header-anchor" href="#‰∏≠ÊéßÊú∫Êìç‰ΩúÈÉ®ÁΩ≤Êú∫ÈÖçÁΩÆntpÊúçÂä°" aria-label="Permalink to &quot;‰∏≠ÊéßÊú∫Êìç‰ΩúÈÉ®ÁΩ≤Êú∫ÈÖçÁΩÆntpÊúçÂä°&quot;"></a></h2>
<p><em><strong>Ê≥®ÊÑèÔºöÁîü‰∫ß‰∏äÂ∫îËØ•ÊåáÂêëËá™Â∑±ÁöÑntpÊúçÂä°Âô®ÔºåÊú¨Ê¨°ÊµãËØïÈááÁî®‰∫ÜÂÖ¨ÁΩëÂÖ¨Áî®ÁöÑntpÊúçÂä°‰∏çÁ®≥ÂÆö„ÄÇ</strong></em></p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tidb01-41 tidb-ansible]$ ansible-playbook -i hosts.ini deploy_ntp.yml -u tidb -b</span></span>
<span class="line"><span></span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Congrats! All goes well. :-)</span></span></code></pre>
</div><h2 id="‰∏≠ÊéßÂèäÊìç‰ΩúÈÉ®ÁΩ≤Êú∫ËÆæÁΩÆcpuÊ®°Âºè" tabindex="-1">‰∏≠ÊéßÂèäÊìç‰ΩúÈÉ®ÁΩ≤Êú∫ËÆæÁΩÆCPUÊ®°Âºè <a class="header-anchor" href="#‰∏≠ÊéßÂèäÊìç‰ΩúÈÉ®ÁΩ≤Êú∫ËÆæÁΩÆcpuÊ®°Âºè" aria-label="Permalink to &quot;‰∏≠ÊéßÂèäÊìç‰ΩúÈÉ®ÁΩ≤Êú∫ËÆæÁΩÆCPUÊ®°Âºè&quot;"></a></h2>
<p>Ë∞ÉÊï¥CPUÊ®°ÂºèÔºåÂ¶ÇÊûúÂêåÊú¨ÊñáÂá∫Áé∞‰∏ÄÊ†∑ÁöÑÊä•ÈîôÔºåËØ¥ÊòéÊ≠§ÁâàÊú¨ÁöÑÊìç‰ΩúÁ≥ªÁªü‰∏çÊîØÊåÅCPUÊ®°Âºè‰øÆÊîπÔºåÂèØÁõ¥Êé•Ë∑≥Ëøá„ÄÇ</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tidb01-41 tidb-ansible]$ ansible -i hosts.ini all -m shell -a </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"cpupower frequency-set --governor performance"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> -u tidb -b</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">192.168.1.44</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> FAILED</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> rc</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">237</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> >></span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Setting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> cpu:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Error</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> setting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> new</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> values.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Common</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> errors:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">-</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Do</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> you</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> have</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> proper</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> administration</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> rights?</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (super-user?)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">-</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Is</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> governor</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> you</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> requested</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> available</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> and</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> modprobed?</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">-</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Trying</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> an</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> invalid</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> policy?</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">-</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Trying</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> specific</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> frequency,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> but</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> userspace</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> governor</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> not</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> available,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">   for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> example because of hardware which cannot be set to a specific frequency</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">   or</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> because</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> userspace</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> governor</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> isn't loaded?non-zero return code</span></span></code></pre>
</div><h2 id="ansibleÈÉ®ÁΩ≤ÂëΩ‰ª§ÈªÑÈáë‰∫îÊ≠•È™§Ëµ∞" tabindex="-1">ansibleÈÉ®ÁΩ≤ÂëΩ‰ª§ÈªÑÈáë‰∫îÊ≠•È™§Ëµ∞ <a class="header-anchor" href="#ansibleÈÉ®ÁΩ≤ÂëΩ‰ª§ÈªÑÈáë‰∫îÊ≠•È™§Ëµ∞" aria-label="Permalink to &quot;ansibleÈÉ®ÁΩ≤ÂëΩ‰ª§ÈªÑÈáë‰∫îÊ≠•È™§Ëµ∞&quot;"></a></h2>
<h4 id="ÊâßË°ålocal-prepareËÅîÁΩë‰∏ãËΩΩbinaryÂåÖ" tabindex="-1">ÊâßË°ålocal_prepareËÅîÁΩë‰∏ãËΩΩbinaryÂåÖ <a class="header-anchor" href="#ÊâßË°ålocal-prepareËÅîÁΩë‰∏ãËΩΩbinaryÂåÖ" aria-label="Permalink to &quot;ÊâßË°ålocal_prepareËÅîÁΩë‰∏ãËΩΩbinaryÂåÖ&quot;"></a></h4>
<p>ÊâßË°å local_prepare.yml playbookÔºåËÅîÁΩë‰∏ãËΩΩ TiDB binary Ëá≥‰∏≠ÊéßÊú∫„ÄÇ</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tidb01-41 tidb-ansible]$ ansible-playbook local_prepare.yml</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">PLAY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [do </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">local</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> preparation]</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> ***************************************************************************</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Congrats!</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> All</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> goes</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> well.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> :-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span></code></pre>
</div><h4 id="ÂàùÂßãÂåñÁ≥ªÁªüÁéØÂ¢ÉÂπ∂‰øÆÊîπÂÜÖÊ†∏ÂèÇÊï∞" tabindex="-1">ÂàùÂßãÂåñÁ≥ªÁªüÁéØÂ¢ÉÂπ∂‰øÆÊîπÂÜÖÊ†∏ÂèÇÊï∞ <a class="header-anchor" href="#ÂàùÂßãÂåñÁ≥ªÁªüÁéØÂ¢ÉÂπ∂‰øÆÊîπÂÜÖÊ†∏ÂèÇÊï∞" aria-label="Permalink to &quot;ÂàùÂßãÂåñÁ≥ªÁªüÁéØÂ¢ÉÂπ∂‰øÆÊîπÂÜÖÊ†∏ÂèÇÊï∞&quot;"></a></h4>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tidb01-41 tidb-ansible]$ ansible-playbook bootstrap.yml</span></span>
<span class="line"><span></span></span>
<span class="line"><span>PLAY [initializing deployment target] *****************************************************************</span></span>
<span class="line"><span></span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Congrats! All goes well. :-)</span></span></code></pre>
</div><h4 id="ÈÉ®ÁΩ≤tidbÈõÜÁæ§ËΩØ‰ª∂" tabindex="-1">ÈÉ®ÁΩ≤TiDBÈõÜÁæ§ËΩØ‰ª∂ <a class="header-anchor" href="#ÈÉ®ÁΩ≤tidbÈõÜÁæ§ËΩØ‰ª∂" aria-label="Permalink to &quot;ÈÉ®ÁΩ≤TiDBÈõÜÁæ§ËΩØ‰ª∂&quot;"></a></h4>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tidb01-41 tidb-ansible]$ ansible-playbook deploy.yml</span></span>
<span class="line"><span></span></span>
<span class="line"><span>PLAY [check config locally] ***************************************************************************</span></span>
<span class="line"><span></span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span></span></span>
<span class="line"><span>PLAY RECAP ********************************************************************************************</span></span>
<span class="line"><span>192.168.1.41               : ok=53   changed=4    unreachable=0    failed=0   </span></span>
<span class="line"><span>192.168.1.42               : ok=121  changed=16   unreachable=0    failed=0   </span></span>
<span class="line"><span>192.168.1.43               : ok=52   changed=4    unreachable=0    failed=0   </span></span>
<span class="line"><span>TiDB1-11                   : ok=26   changed=1    unreachable=0    failed=0   </span></span>
<span class="line"><span>TiDB1-12                   : ok=26   changed=2    unreachable=0    failed=0   </span></span>
<span class="line"><span>TiDB1-21                   : ok=26   changed=2    unreachable=0    failed=0   </span></span>
<span class="line"><span>TiDB1-22                   : ok=26   changed=1    unreachable=0    failed=0   </span></span>
<span class="line"><span>TiKV1-11                   : ok=28   changed=5    unreachable=0    failed=0   </span></span>
<span class="line"><span>TiKV1-12                   : ok=28   changed=4    unreachable=0    failed=0   </span></span>
<span class="line"><span>TiKV2-21                   : ok=28   changed=3    unreachable=0    failed=0   </span></span>
<span class="line"><span>TiKV2-22                   : ok=28   changed=3    unreachable=0    failed=0   </span></span>
<span class="line"><span>TiKV3-31                   : ok=28   changed=3    unreachable=0    failed=0   </span></span>
<span class="line"><span>TiKV3-32                   : ok=28   changed=3    unreachable=0    failed=0   </span></span>
<span class="line"><span>localhost                  : ok=7    changed=4    unreachable=0    failed=0   </span></span>
<span class="line"><span></span></span>
<span class="line"><span>Congrats! All goes well. :-)</span></span></code></pre>
</div><h4 id="ÂÆâË£Ödashboard‰æùËµñÂåÖ" tabindex="-1">ÂÆâË£ÖDashboard‰æùËµñÂåÖ <a class="header-anchor" href="#ÂÆâË£Ödashboard‰æùËµñÂåÖ" aria-label="Permalink to &quot;ÂÆâË£ÖDashboard‰æùËµñÂåÖ&quot;"></a></h4>
<p>Grafana Dashboard ‰∏äÁöÑ Report ÊåâÈíÆÂèØÁî®Êù•ÁîüÊàê PDF Êñá‰ª∂ÔºåÊ≠§ÂäüËÉΩ‰æùËµñ fontconfig ÂåÖÂíåËã±ÊñáÂ≠ó‰Ωì„ÄÇÂ¶Ç</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[root@tidb01-41 tmp]# sudo yum install fontconfig open-sans-fonts</span></span></code></pre>
</div><h4 id="ÊâßË°åstartÂêØÂä®tidbÈõÜÁæ§" tabindex="-1">ÊâßË°åstartÂêØÂä®TiDBÈõÜÁæ§ <a class="header-anchor" href="#ÊâßË°åstartÂêØÂä®tidbÈõÜÁæ§" aria-label="Permalink to &quot;ÊâßË°åstartÂêØÂä®TiDBÈõÜÁæ§&quot;"></a></h4>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tidb01-41 tidb-ansible]$ ansible-playbook start.yml</span></span>
<span class="line"><span></span></span>
<span class="line"><span>PLAY [check config locally] **********************************************************************************************</span></span>
<span class="line"><span></span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span></span></span>
<span class="line"><span>PLAY RECAP *******************************************************************************************************************************************************************************************************</span></span>
<span class="line"><span>192.168.1.41               : ok=9    changed=2    unreachable=0    failed=0   </span></span>
<span class="line"><span>192.168.1.42               : ok=34   changed=10   unreachable=0    failed=0   </span></span>
<span class="line"><span>192.168.1.43               : ok=12   changed=3    unreachable=0    failed=0   </span></span>
<span class="line"><span>TiDB1-11                   : ok=6    changed=1    unreachable=0    failed=0   </span></span>
<span class="line"><span>TiDB1-12                   : ok=6    changed=1    unreachable=0    failed=0   </span></span>
<span class="line"><span>TiDB2-21                   : ok=6    changed=1    unreachable=0    failed=0   </span></span>
<span class="line"><span>TiDB2-22                   : ok=6    changed=1    unreachable=0    failed=0   </span></span>
<span class="line"><span>TiKV1-11                   : ok=8    changed=1    unreachable=0    failed=0   </span></span>
<span class="line"><span>TiKV1-12                   : ok=8    changed=1    unreachable=0    failed=0   </span></span>
<span class="line"><span>TiKV2-21                   : ok=8    changed=1    unreachable=0    failed=0   </span></span>
<span class="line"><span>TiKV2-22                   : ok=8    changed=1    unreachable=0    failed=0   </span></span>
<span class="line"><span>TiKV3-31                   : ok=8    changed=1    unreachable=0    failed=0   </span></span>
<span class="line"><span>TiKV3-32                   : ok=8    changed=1    unreachable=0    failed=0   </span></span>
<span class="line"><span>localhost                  : ok=7    changed=4    unreachable=0    failed=0   </span></span>
<span class="line"><span></span></span>
<span class="line"><span>Congrats! All goes well. :-)</span></span></code></pre>
</div><h2 id="È™åËØÅÊòØÂê¶ÂÆâË£ÖÊàêÂäü" tabindex="-1">È™åËØÅÊòØÂê¶ÂÆâË£ÖÊàêÂäü <a class="header-anchor" href="#È™åËØÅÊòØÂê¶ÂÆâË£ÖÊàêÂäü" aria-label="Permalink to &quot;È™åËØÅÊòØÂê¶ÂÆâË£ÖÊàêÂäü&quot;"></a></h2>
<ul>
<li>MySQLÂÆ¢Êà∑Á´ØËøûÊé•È™åËØÅ</li>
</ul>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tidb01-41 tidb-ansible]$ mysql -uroot -P4000 -h192.168.1.43</span></span>
<span class="line"><span>Welcome to the MariaDB monitor.  Commands end with ; or \g.</span></span>
<span class="line"><span>Your MySQL connection id is 18</span></span>
<span class="line"><span>Server version: 5.7.25-TiDB-v3.0.1 MySQL Community Server (Apache License 2.0)</span></span>
<span class="line"><span>MySQL [(none)]> exit</span></span>
<span class="line"><span>Bye</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[tidb@tidb01-41 tidb-ansible]$ mysql -uroot -P4000 -h192.168.1.42</span></span>
<span class="line"><span>Welcome to the MariaDB monitor.  Commands end with ; or \g.</span></span>
<span class="line"><span>Your MySQL connection id is 17</span></span>
<span class="line"><span>Server version: 5.7.25-TiDB-v3.0.1 MySQL Community Server (Apache License 2.0)</span></span>
<span class="line"><span>MySQL [(none)]> exit</span></span>
<span class="line"><span>Bye</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[tidb@tidb01-41 tidb-ansible]$ mysql -uroot -P4001 -h192.168.1.43</span></span>
<span class="line"><span>ERROR 2003 (HY000): Can't connect to MySQL server on '192.168.1.43' (111)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[tidb@tidb01-41 tidb-ansible]$ mysql -uroot -P4001 -h192.168.1.42</span></span>
<span class="line"><span>ERROR 2003 (HY000): Can't connect to MySQL server on '192.168.1.42' (111)</span></span></code></pre>
</div><p><strong>Âá∫Áé∞‰∫ÜTiDBÂÆû‰æãÊ≤°ÊúâËµ∑Êù•ÁöÑÁä∂ÂÜµÔºå‰ΩÜÊòØansibleÊ≤°ÊúâÊä•ÈîôÔºÅ</strong></p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tidb02-42 deploy]$ pwd</span></span>
<span class="line"><span>/data1/deploy</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[tidb@tidb02-42 deploy]$ ./bin/tidb-server -P 4001 --status=10081 1-advertise-address=192.168.1.42 --path=192.168.1.42:2379,192.168.1.43:2379 --config=conf/tidb.toml --log-slow-query=/data1/deploy/log/tidb_slow_query.log --log-file=/data1/deploy/log/tidb.log</span></span>
<span class="line"><span></span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[2021/01/06 10:08:41.846 -05:00] [INFO] [domain.go:554] ["domain closed"] ["take time"=82.116¬µs]</span></span>
<span class="line"><span>sync log err: sync /dev/stdout: invalid argument</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[tidb@tidb01-41 tidb-ansible]$ mysql -uroot -P4001 -h192.168.1.42</span></span>
<span class="line"><span>Welcome to the MariaDB monitor.  Commands end with ; or \g.</span></span>
<span class="line"><span>Your MySQL connection id is 1</span></span>
<span class="line"><span>Server version: 5.7.25-TiDB-v3.0.1 MySQL Community Server (Apache License 2.0)</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>MySQL [(none)]> exit</span></span>
<span class="line"><span>Bye</span></span></code></pre>
</div><ul>
<li>grafanaÂõæÂΩ¢ÁïåÈù¢È™åËØÅ
<img src="http://cdn.lifemini.cn/dbblog/20210106/9e1e0fde9ec446c7ae32df0a6f1f5338.png" alt="grafanaËäÇÁÇπÊ†°È™å"></li>
</ul>
<h2 id="ÂèÇËÄÉÊñáÁ´†" tabindex="-1">ÂèÇËÄÉÊñáÁ´† <a class="header-anchor" href="#ÂèÇËÄÉÊñáÁ´†" aria-label="Permalink to &quot;ÂèÇËÄÉÊñáÁ´†&quot;"></a></h2>
<p><a href="https://docs.pingcap.com/zh/tidb/stable/online-deployment-using-ansible#%E5%8D%95%E6%9C%BA%E5%A4%9A-tikv-%E5%AE%9E%E4%BE%8B%E9%9B%86%E7%BE%A4%E6%8B%93%E6%89%91" target="_blank" rel="noreferrer">PingCAPÂÆòÊñπÊñáÊ°£-ÂçïÊú∫Âçï TiKV ÂÆû‰æãÈõÜÁæ§ÊãìÊâë</a></p>
]]></content:encoded>
            <enclosure url="http://cdn.lifemini.cn/dbblog/20210106/9e1e0fde9ec446c7ae32df0a6f1f5338.png" length="0" type="image/png"/>
        </item>
        <item>
            <title><![CDATA[TiDB-TiSpark‰æùÈù†TiUPÂ∑•ÂÖ∑ÂçèÂä©ÈÉ®ÁΩ≤ÈõÜÁæ§]]></title>
            <link>https://askaric.com/zh/work/tidb/02TIDB-ÈÉ®ÁΩ≤ÂÆûË∑µ/2-2TiUP ÈÉ®ÁΩ≤ÂÆûË∑µ/05TiUP ÈÉ®ÁΩ≤ TiSpark.html</link>
            <guid>https://askaric.com/zh/work/tidb/02TIDB-ÈÉ®ÁΩ≤ÂÆûË∑µ/2-2TiUP ÈÉ®ÁΩ≤ÂÆûË∑µ/05TiUP ÈÉ®ÁΩ≤ TiSpark.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[# TiDB-TiSpark‰æùÈù†TiUPÂ∑•ÂÖ∑ÂçèÂä©ÈÉ®ÁΩ≤ÈõÜÁæ§
Êó∂Èó¥Ôºö2021-01-16

> - [TiSparkÂéüÁêÜËÆ≤Ëß£](#TiSparkÂéüÁêÜËÆ≤Ëß£)  
> - [TiSpark‰∏éSpark‰∏ãËΩΩ](#TiSpark‰∏éSpark‰∏ãËΩΩ)  
> - [SparkÁéØÂ¢ÉÈÉ®ÁΩ≤‰∏éÊ£ÄÈ™å](#SparkÁéØÂ¢ÉÈÉ®ÁΩ≤‰∏éÊ£ÄÈ™å)  
> - [ÊãìÂ±ïTiSpark‰∏éspark-shellÈ™åËØÅ](#ÊãìÂ±ïTiSpark‰∏éspark-shellÈ™åËØÅ)  
> - [ÂèÇËÄÉÊñáÁ´†](#ÂèÇËÄÉÊñáÁ´†)

## TiSparkÂéüÁêÜËÆ≤Ëß£
 - TiSparkÊòØÊûÑÂª∫Âú® Spark Catalyst ÂºïÊìé‰πã‰∏äÁöÑÔºå‰ΩøÁî® TiSpark ‰πãÂâçÈúÄË¶ÅÂÆâË£ÖÂπ∂ËøêË°å Spark ÈõÜÁæ§Ôºõ   
 - TiSpark ÂÆûÁé∞‰∫ÜÂ¶Ç TiDB ‰∏ÄÊ†∑ÁöÑÂ§öÁßçËÆ°ÁÆó‰∏ãÊé®Âà∞ TiKV Â±ÇÈù¢ËÆ°ÁÆóÔºåÂáèÂ∞ë Spark ÈúÄË¶ÅÂ§ÑÁêÜÊï∞ÊçÆÂä†ÈÄüÊü•ËØ¢Ôºõ  
 - TiSpark ÂèØ‰ª•Âà©Áî® TiDB ÁöÑÂÜÖÂª∫ÁöÑÁªüËÆ°‰ø°ÊÅØÈÄâÊã©Êõ¥‰ºòÁöÑÊü•ËØ¢ËÆ°Âàí;  
 - TiSpark Áõ¥Êé•Êìç‰Ωú TiKVÔºåÁõ∏ÊØî‰ΩøÁî® Spark ÁªìÂêà JDBC ÁöÑÊñπÂºèÂÜôÂÖ•Ôºå‰∏ç‰ªÖÂèØ‰ª•ÂÆûÁé∞‰∫ãÂä°ËÄå‰∏îÂÜôÂÖ•ÈÄüÂ∫¶‰ºöÊõ¥Âø´;
![TiSpark](https://download.pingcap.com/images/docs-cn/tispark-architecture.png)

## TiSpark‰∏éSpark‰∏ãËΩΩ
```shell
# tiup ÂÆâË£Ö spark
[tidb@tiup-tidb41 conf]$ tiup install spark

# tiup ÂÆâË£Ö tispark
[tidb@tiup-tidb41 conf]$ tiup install tispark

# Êü•ÁúãÂÆâË£ÖÁªìÊûú
[tidb@tiup-tidb41 conf]$ tiup list --installed
Available components:
Name            Owner    Description
]]></description>
            <content:encoded><![CDATA[<h1 id="tidb-tispark‰æùÈù†tiupÂ∑•ÂÖ∑ÂçèÂä©ÈÉ®ÁΩ≤ÈõÜÁæ§" tabindex="-1">TiDB-TiSpark‰æùÈù†TiUPÂ∑•ÂÖ∑ÂçèÂä©ÈÉ®ÁΩ≤ÈõÜÁæ§ <a class="header-anchor" href="#tidb-tispark‰æùÈù†tiupÂ∑•ÂÖ∑ÂçèÂä©ÈÉ®ÁΩ≤ÈõÜÁæ§" aria-label="Permalink to &quot;TiDB-TiSpark‰æùÈù†TiUPÂ∑•ÂÖ∑ÂçèÂä©ÈÉ®ÁΩ≤ÈõÜÁæ§&quot;"></a></h1>
<p>Êó∂Èó¥Ôºö2021-01-16</p>
<blockquote>
<ul>
<li><a href="#TiSparkÂéüÁêÜËÆ≤Ëß£">TiSparkÂéüÁêÜËÆ≤Ëß£</a></li>
<li><a href="#TiSpark‰∏éSpark‰∏ãËΩΩ">TiSpark‰∏éSpark‰∏ãËΩΩ</a></li>
<li><a href="#SparkÁéØÂ¢ÉÈÉ®ÁΩ≤‰∏éÊ£ÄÈ™å">SparkÁéØÂ¢ÉÈÉ®ÁΩ≤‰∏éÊ£ÄÈ™å</a></li>
<li><a href="#ÊãìÂ±ïTiSpark‰∏éspark-shellÈ™åËØÅ">ÊãìÂ±ïTiSpark‰∏éspark-shellÈ™åËØÅ</a></li>
<li><a href="#ÂèÇËÄÉÊñáÁ´†">ÂèÇËÄÉÊñáÁ´†</a></li>
</ul>
</blockquote>
<h2 id="tisparkÂéüÁêÜËÆ≤Ëß£" tabindex="-1">TiSparkÂéüÁêÜËÆ≤Ëß£ <a class="header-anchor" href="#tisparkÂéüÁêÜËÆ≤Ëß£" aria-label="Permalink to &quot;TiSparkÂéüÁêÜËÆ≤Ëß£&quot;"></a></h2>
<ul>
<li>TiSparkÊòØÊûÑÂª∫Âú® Spark Catalyst ÂºïÊìé‰πã‰∏äÁöÑÔºå‰ΩøÁî® TiSpark ‰πãÂâçÈúÄË¶ÅÂÆâË£ÖÂπ∂ËøêË°å Spark ÈõÜÁæ§Ôºõ</li>
<li>TiSpark ÂÆûÁé∞‰∫ÜÂ¶Ç TiDB ‰∏ÄÊ†∑ÁöÑÂ§öÁßçËÆ°ÁÆó‰∏ãÊé®Âà∞ TiKV Â±ÇÈù¢ËÆ°ÁÆóÔºåÂáèÂ∞ë Spark ÈúÄË¶ÅÂ§ÑÁêÜÊï∞ÊçÆÂä†ÈÄüÊü•ËØ¢Ôºõ</li>
<li>TiSpark ÂèØ‰ª•Âà©Áî® TiDB ÁöÑÂÜÖÂª∫ÁöÑÁªüËÆ°‰ø°ÊÅØÈÄâÊã©Êõ¥‰ºòÁöÑÊü•ËØ¢ËÆ°Âàí;</li>
<li>TiSpark Áõ¥Êé•Êìç‰Ωú TiKVÔºåÁõ∏ÊØî‰ΩøÁî® Spark ÁªìÂêà JDBC ÁöÑÊñπÂºèÂÜôÂÖ•Ôºå‰∏ç‰ªÖÂèØ‰ª•ÂÆûÁé∞‰∫ãÂä°ËÄå‰∏îÂÜôÂÖ•ÈÄüÂ∫¶‰ºöÊõ¥Âø´;
<img src="https://download.pingcap.com/images/docs-cn/tispark-architecture.png" alt="TiSpark"></li>
</ul>
<h2 id="tispark‰∏éspark‰∏ãËΩΩ" tabindex="-1">TiSpark‰∏éSpark‰∏ãËΩΩ <a class="header-anchor" href="#tispark‰∏éspark‰∏ãËΩΩ" aria-label="Permalink to &quot;TiSpark‰∏éSpark‰∏ãËΩΩ&quot;"></a></h2>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># tiup ÂÆâË£Ö spark</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 conf]$ tiup install spark</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># tiup ÂÆâË£Ö tispark</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 conf]$ tiup install tispark</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Êü•ÁúãÂÆâË£ÖÁªìÊûú</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 conf]$ tiup list --installed</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Available</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> components:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">            Owner</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    Description</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">            -----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    -----------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">spark</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">           pingcap</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Spark</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> fast</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> and</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> general</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> computing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tispark</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">         pingcap</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  tispark</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># ËøõÂÖ•Âà∞ tiup ÈöêËóèÁõÆÂΩï‰∏ãÔºåÊü•ÊâæÁõ∏ÂÖ≥ÈïúÂÉèÊñá‰ª∂</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 spark-2.4.3-bin-hadoop2.7]$ cd </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">/.tiup/components/</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 components]$ ll </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> spark</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">drwxr-xr-x</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  3</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 20</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Jan</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 16</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 05:40</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> spark</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">drwxr-xr-x</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  3</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 21</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Jan</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 11</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 07:51</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tispark</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Â§çÂà∂ Spark Âà∞ÁõÆÂΩï TiDB ÈÉ®ÁΩ≤ÁõÆÂΩï‰∏ãÔºåÁªü‰∏ÄÈÉ®ÁΩ≤Ë∑ØÂæÑÔºåÊñπ‰æø‰ª•ÂêéËøêÁª¥</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 components]$ cd spark/v2.4.3/</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 v2.4.3]$ ll</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">drwxr-xr-x</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 13</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 211</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Jan</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 16</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 05:40</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> spark-2.4.3-bin-hadoop2.7</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 v2.4.3]$ cp -rp spark-2.4.3-bin-hadoop2.7 /data/tidb-deploy/</span></span></code></pre>
</div><h2 id="sparkÁéØÂ¢ÉÈÉ®ÁΩ≤‰∏éÊ£ÄÈ™å" tabindex="-1">SparkÁéØÂ¢ÉÈÉ®ÁΩ≤‰∏éÊ£ÄÈ™å <a class="header-anchor" href="#sparkÁéØÂ¢ÉÈÉ®ÁΩ≤‰∏éÊ£ÄÈ™å" aria-label="Permalink to &quot;SparkÁéØÂ¢ÉÈÉ®ÁΩ≤‰∏éÊ£ÄÈ™å&quot;"></a></h2>
<ul>
<li>Âú®Ê≠£Âºè‰ΩøÁî® TiSpark ‰πãÂâçÈúÄË¶ÅÂÖàÈÉ®ÁΩ≤ Spark ÈõÜÁæ§ÔºåÂõ†‰∏∫ TiSpark ‰ªÖÊòØÊòØ‰∏Ä‰∏™ Jar ÂåÖÔºåÂÆûÁé∞‰∫Ü Spark ÁöÑÊâ©Â±ï</li>
<li>Êú¨‰æã‰ªÖ‰ΩøÁî®‰∏Ä‰∏™ Spark Master Âíå‰∏Ä‰∏™ Spark Slave Êù•ÂÆåÊàêÊºîÁ§∫(Stand alone)ÔºåÂ§ßÂÆ∂ÂèØ‰ª•‰∏ÄÂè•Ëá™Â∑±ÈúÄÊ±ÇÊê≠Âª∫ÂÆåÊï¥ÁöÑ Spark ÈõÜÁæ§</li>
</ul>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># ËøõÂÖ•ÈÉ®ÁΩ≤Ë∑ØÂæÑ conf Ë∑ØÂæÑ‰∏ã</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 conf]$ cd /data/tidb-deploy/spark-2.4.3-bin-hadoop2.7/conf/</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 conf]$ cp spark-defaults.conf.template spark-defaults.conf</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># ÁºñÂÜô spark-defaults ÈÖçÁΩÆÊñá‰ª∂ÔºåÂä†ÂÖ• PD ÈõÜÁæ§‰ø°ÊÅØ„ÄÅTiSpark Êâ©Â±ï</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 conf]$ vi spark-defaults.conf</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 conf]$ cat spark-defaults.conf</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">spark.tispark.pd.addresses</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 192.168.169.41:2379,192.168.169.42:2379,192.168.169.43:2379</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">spark.sql.extensions</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> org.apache.spark.sql.TiExtensions</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 conf]$ cp spark-env.sh.template spark-env.sh</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># ÁºñÂÜô Spark-env Êâ©Â±ïÊñá‰ª∂</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 conf]$ vi spark-env.sh</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 conf]$ cat spark-env.sh</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> SPARK_MASTER_IP</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">192.168.169.41</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> SPARK_LOCAL_IP</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">192.168.169.41</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> SPARK_EXECUTOR_MEMORY</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">1G           </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># SPARK EXECUTOR ÊâÄËÉΩ‰ΩøÁî®ÁöÑÂÜÖÂ≠ò</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> SPARK_EXECUTOR_cores</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">             # SPARK EXECUTOR ÊâÄËÉΩ‰ΩøÁî®ÁöÑÊ†∏ÂøÉÊï∞</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> SPARK_WORKER_CORES</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">               # SPARK WORKER ÊâÄËÉΩ‰ΩøÁî®ÁöÑÊ†∏ÂøÉÊï∞</span></span></code></pre>
</div><ul>
<li>ÂêØÂä® Spark Master Âíå Spark Slave</li>
</ul>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># ÂêØÂä® Spark Master</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 sbin]$ cd /data/tidb/deploy/spark/sbin</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 sbin]$ sh start-master.sh</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># ÂêØÂä® Spark SlaveÔºàÂú®tikv‰∏äÊìç‰ΩúÔºâ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 sbin]$ cd /data/tidb-deploy/spark-2.4.3-bin-hadoop2.7/sbin</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 sbin]$ ./start-slave.sh spark://192.168.169.41:7077</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Ê£ÄÊü• Spark Master Âíå Slave ÊòØÂê¶ÂùáÂ∑≤ÂêØÂä®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 conf]$ ps -ef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> spark</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tidb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">      10091</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">      1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 06:10</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> pts/0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    00:00:27</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /usr/lib/jvm/java-1.8.0-openjdk-1.8.0.275.b01-0.el7_9.x86_64/jre/bin/java</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -cp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /data/tidb-deploy/spark-2.4.3-bin-hadoop2.7/conf/:/data/tidb-deploy/spark-2.4.3-bin-hadoop2.7/jars/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -Xmx1g</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> org.apache.spark.deploy.master.Master</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --host</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tiup-tidb41</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --port</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 7077</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --webui-port</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 8080</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tidb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">      10155</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">      1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 06:12</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> pts/0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    00:00:21</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /usr/lib/jvm/java-1.8.0-openjdk-1.8.0.275.b01-0.el7_9.x86_64/jre/bin/java</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -cp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /data/tidb-deploy/spark-2.4.3-bin-hadoop2.7/conf/:/data/tidb-deploy/spark-2.4.3-bin-hadoop2.7/jars/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -Xmx1g</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> org.apache.spark.deploy.worker.Worker</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --webui-port</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 8081</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> spark://192.168.169.41:7077</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tidb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">      11487</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   8542</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 08:25</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> pts/0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    00:00:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> grep</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --color=auto</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> spark</span></span></code></pre>
</div><p>Ëá≥Ê≠§Ôºåtidb+sparkÈõÜÁæ§Â∞±Êê≠Âª∫ÂÆåÊàê</p>
<h2 id="ÊãìÂ±ïtispark‰∏éspark-shellÈ™åËØÅ" tabindex="-1">ÊãìÂ±ïTiSpark‰∏éspark-shellÈ™åËØÅ <a class="header-anchor" href="#ÊãìÂ±ïtispark‰∏éspark-shellÈ™åËØÅ" aria-label="Permalink to &quot;ÊãìÂ±ïTiSpark‰∏éspark-shellÈ™åËØÅ&quot;"></a></h2>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># ËøõÂÖ• spark ÂëΩ‰ª§Ë°åÂÆ¢Êà∑Á´ØÔºåÂπ∂ÊâßË°å spark.sql("show databases").show Êü•Áúã TiDB ‰∏≠ÊâÄÊúâÊï∞ÊçÆÂ∫ì</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">scala</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">> [tidb@tiup-tidb41 </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">conf]</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">$ </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">spark-shell</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">21/01/16</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 07:13:55</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> WARN</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> NativeCodeLoader:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Unable</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> load</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> native-hadoop</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> library</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> your</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> platform...</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> using</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> builtin-java</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> classes</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> where</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> applicable</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Setting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> default</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> log</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> level</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "WARN".</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">To</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> adjust</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> logging</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> level</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> use</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> sc.setLogLevel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">newLevel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> For</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> SparkR,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> use</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> setLogLevel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">newLevel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">21/01/16</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 07:14:11</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> INFO</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> TiSparkInfo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Supported</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Spark</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Version:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 2.3</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 2.4</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Current</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Spark</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Version:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 2.4.3</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Current</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Spark</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Major</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Version:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 2.4</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Spark</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> context</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Web</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> UI</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> available</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> at</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> http://tiup-tidb41:4040</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Spark</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> context</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> available</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> as</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'sc'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (master </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> local[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">*</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">],</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> app</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> id</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> local-1610799251405</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">).</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Spark</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> session</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> available</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> as</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'spark'.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Welcome</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> to</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">      ____</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">              __</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">     /</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> __/__</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  ___</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> _____/</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /__</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    _\</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \/</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> _</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \/</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> _</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">/</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> __/  '_/</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   /___/ .__/\_,_/_/ /_/\_\   version 2.4.3</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      /_/</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">         </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">Using Scala version 2.11.12 (OpenJDK 64-Bit Server VM, Java 1.8.0_275)</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">Type in expressions to have them evaluated.</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">Type :help for more information.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">scala> spark.sql("show databases").show</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">21/01/16 07:14:34 INFO ReflectionUtil$: tispark class url: file:/data/tidb-deploy/spark-2.4.3-bin-hadoop2.7/jars/tispark-assembly-2.3.11.jar</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">21/01/16 07:14:34 INFO ReflectionUtil$: spark wrapper class url: jar:file:/data/tidb-deploy/spark-2.4.3-bin-hadoop2.7/jars/tispark-assembly-2.3.11.jar!/resources/spark-wrapper-spark-2_4/</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">21/01/16 07:14:50 WARN ObjectStore: Version information not found in metastore. hive.metastore.schema.verification is not enabled so recording the schema version 1.2.0</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">21/01/16 07:14:50 WARN ObjectStore: Failed to get database default, returning NoSuchObjectException</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">+------------+</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">|databaseName|</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">+------------+</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">|     default|</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">|   dumptest2|</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">|   user_east|</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">|         jan|</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">+------------+</span></span></code></pre>
</div><h2 id="ÂèÇËÄÉÊñáÁ´†" tabindex="-1">ÂèÇËÄÉÊñáÁ´† <a class="header-anchor" href="#ÂèÇËÄÉÊñáÁ´†" aria-label="Permalink to &quot;ÂèÇËÄÉÊñáÁ´†&quot;"></a></h2>
<ul>
<li>
<p><a href="https://www.cndba.cn/Marvinn/article/3283" target="_blank" rel="noreferrer">TiSpark Ê∑∑ÂêàÈÉ®ÁΩ≤‰ª•Âèä‰ΩøÁî®: https://www.cndba.cn/Marvinn/article/3283</a></p>
</li>
<li>
<p><a href="https://blog.csdn.net/weixin_30814319/article/details/95494841" target="_blank" rel="noreferrer">9Ê†ã108-tisparkÈÉ®ÁΩ≤Ê≠•È™§Ôºöhttps://blog.csdn.net/weixin_30814319/article/details/95494841</a></p>
</li>
<li>
<p><a href="https://github.com/tidb-incubator/tidb-in-action/blob/master/session1/chapter11/tispark-in-action.md" target="_blank" rel="noreferrer">TiSpark ÁöÑ‰ΩøÁî®:https://github.com/tidb-incubator/tidb-in-action/blob/master/session1/chapter11/tispark-in-action.md</a></p>
</li>
</ul>
]]></content:encoded>
            <enclosure url="https://download.pingcap.com/images/docs-cn/tispark-architecture.png" length="0" type="image/png"/>
        </item>
        <item>
            <title><![CDATA[TiDB-TLSÂä†ÂØÜ‰º†ËæìÂÆâÂÖ®ÂçèËÆÆÂéüÁêÜ‰∏éÂ∫îÁî®]]></title>
            <link>https://askaric.com/zh/work/tidb/03TiDB-ËøêÁª¥ÁÆ°ÁêÜ/3-1TiDB ÁõëÊéßËØ¶Ëß£/01TLS ÂéüÁêÜ‰∏éÂ∫îÁî®.html</link>
            <guid>https://askaric.com/zh/work/tidb/03TiDB-ËøêÁª¥ÁÆ°ÁêÜ/3-1TiDB ÁõëÊéßËØ¶Ëß£/01TLS ÂéüÁêÜ‰∏éÂ∫îÁî®.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[Êó∂Èó¥Ôºö2021-01-15
- TLS (Transport Layer Security) ÂÆâÂÖ®‰º†ËæìÂ±ÇÂçèËÆÆÊòØÊûÑÂª∫Â∫îÁî® TCP/IP ÂõõÂ±ÇÂçèËÆÆ‰∫éÂ∫îÁî®Â±ÇÁöÑ‰º†ËæìÂçèËÆÆÔºå‰øùËØÅÁΩëÁªúÂçèËÆÆ‰πãÈó¥‰º†Ëæì‰ø°ÊÅØÁöÑÂÆâÂÖ®ÊÄß
 
]]></description>
            <content:encoded><![CDATA[<h1 id="tidb-tlsÂä†ÂØÜ‰º†ËæìÂÆâÂÖ®ÂçèËÆÆÂéüÁêÜ‰∏éÂ∫îÁî®" tabindex="-1">TiDB-TLSÂä†ÂØÜ‰º†ËæìÂÆâÂÖ®ÂçèËÆÆÂéüÁêÜ‰∏éÂ∫îÁî® <a class="header-anchor" href="#tidb-tlsÂä†ÂØÜ‰º†ËæìÂÆâÂÖ®ÂçèËÆÆÂéüÁêÜ‰∏éÂ∫îÁî®" aria-label="Permalink to &quot;TiDB-TLSÂä†ÂØÜ‰º†ËæìÂÆâÂÖ®ÂçèËÆÆÂéüÁêÜ‰∏éÂ∫îÁî®&quot;"></a></h1>
<p>Êó∂Èó¥Ôºö2021-01-15</p>
<ul>
<li>TLS (Transport Layer Security) ÂÆâÂÖ®‰º†ËæìÂ±ÇÂçèËÆÆÊòØÊûÑÂª∫Â∫îÁî® TCP/IP ÂõõÂ±ÇÂçèËÆÆ‰∫éÂ∫îÁî®Â±ÇÁöÑ‰º†ËæìÂçèËÆÆÔºå‰øùËØÅÁΩëÁªúÂçèËÆÆ‰πãÈó¥‰º†Ëæì‰ø°ÊÅØÁöÑÂÆâÂÖ®ÊÄß</li>
</ul>
<figure><img src="https://img2018.cnblogs.com/blog/1769223/201910/1769223-20191019181046559-603567130.png" alt="TLS" tabindex="0"><figcaption>TLS</figcaption></figure>
<h2 id="ÈùûÂØπÁß∞Âä†ÂØÜ" tabindex="-1">ÈùûÂØπÁß∞Âä†ÂØÜ <a class="header-anchor" href="#ÈùûÂØπÁß∞Âä†ÂØÜ" aria-label="Permalink to &quot;ÈùûÂØπÁß∞Âä†ÂØÜ&quot;"></a></h2>
<ul>
<li>
<p>ÈùûÂØπÁß∞Âä†ÂØÜÈÄöËøáÂÖ¨ÁßÅÈí•ÂÆûÁé∞</p>
<ul>
<li>ÂÖ¨ÁßÅÈí•ÂÖ≥Á≥ªÔºö‰ΩøÁî®ÈùûÂØπÁß∞ÂØÜÁ†ÅÁÆóÊ≥ïÂèØ‰ª•ÁîüÊàêÂÖ¨ÁßÅÈí•Ôºõ
<ul>
<li>ÂÖ¨Èí•Âä†ÂØÜÁöÑÁöÑÂÜÖÂÆπÁßÅÈí•ÂèØ‰ª•Ëß£ÂØÜÔºåÁßÅÈí•Âä†ÂØÜÁöÑÂÜÖÂÆπÂÖ¨Èí•ÂèØ‰ª•Ëß£ÂØÜÔºõ</li>
<li>ÈÄöËøáÁßÅÈí•ËÆ°ÁÆóÂæóÂà∞ÂÖ¨Èí•Ôºå‰ΩÜÊòØÈÄöËøáÂÖ¨Èí•Âæó‰∏çÂà∞ÁßÅÈí•ÔºåÂõ†Ê≠§ÈÄöÂ∏∏ÊÉÖÂÜµÊòØÂ∞ÜÂÖ¨Èí•ÂÖ¨ÂºÄÔºõ</li>
</ul>
</li>
</ul>
</li>
<li>
<p>ÈùûÂØπÁß∞ÂØÜÁ†ÅÁÆóÊ≥ïTLS‰∏§Áßç‰ΩøÁî®Âú∫ÊôØ</p>
<ul>
<li>Âä†Ëß£ÂØÜÔºõÂä†Ëß£ÂØÜÁî®Ê≥ïÁî®‰∫éTLSÂçèËÆÆ‰∏≠ÁöÑÁî®Êà∑ËÆ§ËØÅÂíåÂØπÁß∞Âä†ÂØÜÁÆóÊ≥ïÂçèÂïÜÔºåAÁî®BÁöÑÂÖ¨Èí•Âä†ÂØÜ‰º†ÁªôBÔºåÂè™ÊúâBËÉΩÁî®Ëá™Â∑±ÁöÑÁßÅÈí•Ëß£ÂØÜÂæóÂà∞ÊòéÊñáÔºõ</li>
<li>Êï∞Â≠óÁ≠æÂêçÔºöÂÅáÂ¶ÇA‰ΩøÁî®Ëá™Â∑±ÁöÑÁßÅÈí•Âä†ÂØÜÊï∞ÊçÆÔºåBÂæóÂà∞ËøôÈÉ®ÂàÜÊï∞ÊçÆÂêéÔºå‰ΩøÁî®AÁöÑÂÖ¨Èí•ËøõË°åËß£ÂØÜÂæóÂà∞ÊòéÊñáÔºåÂ∞ÜÊòéÊñáÂíåÂéüÂßãÊï∞ÊçÆÊØîÂØπÔºåÂèëÁé∞‰∏ÄËá¥ÔºåÂàôÂèØ‰ª•ËØÅÊòéÊòØA‰ΩøÁî®Ëá™Â∑±ÁöÑÁßÅÈí•Á≠æÂêçÁöÑÔºõ</li>
</ul>
</li>
</ul>
<h2 id="Êï∞Â≠óËØÅ‰π¶" tabindex="-1">Êï∞Â≠óËØÅ‰π¶ <a class="header-anchor" href="#Êï∞Â≠óËØÅ‰π¶" aria-label="Permalink to &quot;Êï∞Â≠óËØÅ‰π¶&quot;"></a></h2>
<ul>
<li>
<p>Êï∞Â≠óËØÅ‰π¶ÁöÑ‰ΩúÁî®</p>
<ul>
<li>ËØÅ‰π¶‰∏≠ÁöÑÊï∞Â≠óÁ≠æÂêçÂèØ‰ª•È™åËØÅÊòØÂê¶Êã•ÊúâÊüê‰∏ÄÁ´ØÔºàÁî®Êà∑ÔºâÂÖ¨Èí•ÁöÑÁßÅÈí•</li>
</ul>
</li>
<li>
<p>Êï∞Â≠óËØÅ‰π¶ÁöÑÊûÑÊàê</p>
<ul>
<li>ËØÅ‰π¶ÊòØÂåÖÂê´Ëã•Âπ≤Â≠óÊÆµÁöÑÊñá‰ª∂</li>
<li>ËØÅ‰π¶‰∏≠‰∏ÄËà¨ÂåÖÂê´ÂÖ¨Èí•„ÄÅÁî®Êà∑‰ø°ÊÅØ.....Á≠â</li>
</ul>
</li>
<li>
<p>Êï∞Â≠óËØÅ‰π¶ÁöÑÁâπÊÄß</p>
<ul>
<li>Êï∞Â≠óËØÅ‰π¶ÂèØ‰ª•Á≠æÂèëÊï∞Â≠óËØÅ‰π¶ÔºàÂ¶ÇÔºöÂ∞ÜËØÅ‰π¶AÁ≠æÂèëÔºàÂä†ÂØÜÔºâ‰∏∫ËØÅ‰π¶BÔºâ
<ul>
<li>Person1ÂØπËØÅ‰π¶AÂÖ®ÈÉ®ÂÜÖÂÆπÂÅöhashÔºå‰ΩøÁî®ÂØÜÈí•ÂØπhashÂÄºÂä†ÂØÜÂæóÂà∞ËØÅ‰π¶B</li>
<li>Persion2ÂèØ‰ª•‰ΩøÁî®Persion1ÁöÑÂÖ¨Èí•Ëß£ÂØÜÈ™åËØÅËØÅ‰π¶Á≠æÂèëËÄÖÊòØÂê¶‰∏∫Persion1</li>
</ul>
</li>
<li>Ê†πËØÅ‰π¶ÊòØÁâπÊÆäÁöÑËØÅ‰π¶ÔºåÊ≤°ÊúâÁ≠æÂèëËÄÖÔºåÊòØÁªùÂØπÂèØ‰ø°ÁöÑËØÅ‰π¶</li>
</ul>
</li>
<li>
<p>x.509 ËØÅ‰π¶Ê†áÂáÜÔºöÊï∞Â≠óËÆ§ËØÅËØÅ‰π¶ÊúâÂæàÂ§öÊ†áÂáÜÔºåx.509 Â∞±ÊòØÊØîËæÉÈÄöÁî®ÁöÑÂÖ∂‰∏≠‰∏ÄÁßç</p>
</li>
<li>
<p>x.509 ËØÅ‰π¶ÂÜÖÂÆπ</p>
<ul>
<li>versionÔºö                  # ÁâàÊú¨Âè∑</li>
<li>Serial Number:             # Â∫èÂàóÂè∑</li>
<li>Signature AlgorithmÔºö      # Âä†ÂØÜÁÆóÊ≥ï</li>
<li>Validity:                  # ÊúâÊïàÊúü</li>
<li>Subject:                   # ËØÅ‰π¶Êã•ÊúâËÄÖ‰ø°ÊÅØ</li>
<li>Subject Public Key Info:   # ËØÅ‰π¶Êã•ÊúâËÄÖÂÖ¨Èí•‰ø°ÊÅØ</li>
<li>Signature Algorithm:       # ÂØπËØÅ‰π¶Ê≠£ÊñáÂèñhashÂêéÔºå‰ΩøÁî®ÂÖ¨Èí•Âä†ÂØÜÁöÑÁªìÊûú</li>
</ul>
</li>
</ul>
<h2 id="tlsÂçèËÆÆ" tabindex="-1">TLSÂçèËÆÆ <a class="header-anchor" href="#tlsÂçèËÆÆ" aria-label="Permalink to &quot;TLSÂçèËÆÆ&quot;"></a></h2>
<ul>
<li>
<p>TLSÂçèËÆÆ‰ΩøÁî®ÂØπÁß∞Âä†ÂØÜÂíåÈùûÂØπÁß∞Âä†ÂØÜÈÄöËÆØ</p>
<ul>
<li>Áî®ÈùûÂØπÁß∞Âä†ÂØÜÁ°Æ‰øùËé∑ÂèñÁöÑ‰ø°ÊÅØÊòØÂèØ‰ø°ÂÆ¢Êà∑Á´ØÂèëÊù•ÁöÑ‰ø°ÊÅØ</li>
<li>Áî®ÂØπÁß∞Âä†ÂØÜ‰øùËØÅ‰º†Âá∫ËøáÁ®ã‰∏≠Ë¢´Âä†ÂØÜÁöÑ‰ø°ÊÅØÂú®‰∏çÁü•ÈÅìÂä†ÂØÜÁÆóÊ≥ïÁöÑÊÉÖÂÜµ‰∏ãÊó†Ê≥ïË¢´Á†¥Ëß£</li>
</ul>
</li>
<li>
<p>ËØÅ‰π¶Á≠æÂèëËøáÁ®ã</p>
</li>
</ul>
<ol>
<li>ÁîüÊàêÂÆ¢Êà∑Á´ØÁöÑÂØÜÈí•ÔºåÂç≥ÂÆ¢Êà∑Á´ØÁöÑÂÖ¨ÁßÅÈí•ÂØπÔºå‰∏îË¶Å‰øùËØÅÁßÅÈí•Âè™ÊúâÂÆ¢Êà∑Á´ØËá™Â∑±Êã•Êúâ„ÄÇ</li>
<li>‰ª•ÂÆ¢Êà∑Á´ØÁöÑÂÖ¨Èí•ÂíåÂÆ¢Êà∑Á´ØËá™Ë∫´ÁöÑ‰ø°ÊÅØ(ÂõΩÂÆ∂„ÄÅÊú∫ÊûÑ„ÄÅÂüüÂêç„ÄÅÈÇÆÁÆ±Á≠â)‰∏∫ËæìÂÖ•ÔºåÁîüÊàêËØÅ‰π¶ËØ∑Ê±ÇÊñá‰ª∂
<ul>
<li>ÂÖ∂‰∏≠ÂÆ¢Êà∑Á´ØÁöÑÂÖ¨Èí•ÂíåÂÆ¢Êà∑Á´Ø‰ø°ÊÅØÊòØÊòéÊñá‰øùÂ≠òÂú®ËØÅ‰π¶ËØ∑Ê±ÇÊñá‰ª∂‰∏≠ÁöÑ</li>
<li>ÂÆ¢Êà∑Á´ØÁßÅÈí•ÁöÑ‰ΩúÁî®ÊòØÂØπÂÆ¢Êà∑Á´ØÂÖ¨Èí•ÂèäÂÆ¢Êà∑Á´Ø‰ø°ÊÅØÂÅöÁ≠æÂêçÔºåËá™Ë∫´ÊòØ‰∏çÂåÖÂê´Âú®ËØÅ‰π¶ËØ∑Ê±Ç‰∏≠ÁöÑ</li>
<li>ÁÑ∂ÂêéÊääËØÅ‰π¶ËØ∑Ê±ÇÊñá‰ª∂ÂèëÈÄÅÁªô CA Êú∫ÊûÑÔºåCA ‰ΩøÁî®ÁßÅÈí•Á≠æÂèëÂä†ÂØÜÁîüÊàêÂÆ¢Êà∑Á´ØËØÅ‰π¶Êù•Ë°®ÊòéÁî®Êà∑ÁöÑË∫´‰ªΩ
<ul>
<li>CAÊú∫ÊûÑÊé•Êî∂Âà∞ÂÆ¢Êà∑Á´ØÁöÑËØÅ‰π¶ËØ∑Ê±ÇÊñá‰ª∂ÂêéÔºåÈ¶ñÂÖàÊ†°È™åÂÖ∂Á≠æÂêç</li>
<li>ÁÑ∂ÂêéÂÆ°Ê†∏ÂÆ¢Êà∑Á´ØÁöÑ‰ø°ÊÅØ</li>
<li>ÊúÄÂêéCAÊú∫ÊûÑ‰ΩøÁî®Ëá™Â∑±ÁöÑÁßÅÈí•‰∏∫ËØÅ‰π¶ËØ∑Ê±ÇÊñá‰ª∂Á≠æÂêçÔºåÁîüÊàêËØÅ‰π¶Êñá‰ª∂Ôºå‰∏ãÂèëÁªôÂÆ¢Êà∑Á´Ø</li>
</ul>
</li>
</ul>
</li>
</ol>
<ul>
<li>ÂÖ∑‰ΩìÈÄö‰ø°ËøáÁ®ã</li>
</ul>
<ol>
<li>ÂÆ¢Êà∑Á´ØÂêëÊúçÂä°Âô® 443 Á´ØÂè£ËØ∑Ê±ÇÂçèÂÆö‰ª•ÂêéÈÄöËÆØÁöÑÂä†ÂØÜÁÆóÊ≥ï
<ul>
<li>CA ‰ΩøÁî®ÁßÅÈí•Âä†ÂØÜÊúçÂä°Âô®Á´ØÁöÑÂÖ¨Èí•„ÄÅÂüüÂêç„ÄÅÂÖ¨Èí•ÊëòË¶ÅÁîüÊàêÂØÜÊñáÔºàÂÖ¨Èí•„ÄÅÂüüÂêç„ÄÅÂÖ¨Èí•ÊëòË¶Å=&gt;ÂØÜÊñáÔºâ</li>
</ul>
</li>
<li>ÊúçÂä°Á´ØÊî∂Âà∞ÂÆ¢Êà∑Á´ØËØ∑Ê±ÇÂêéÔºå‰ΩøÁî®ÊúçÂä°Á´ØÁßÅÈí•Âä†ÂØÜÈÄâ‰∏≠ÁöÑÈÄöËÆØÂä†ÂØÜÁÆóÊ≥ïÂíå CA ËØÅ‰π¶ÂæóÂà∞ÁöÑÂØÜÊñáÂèëÈÄÅÁªôÂÆ¢Êà∑Á´Ø
<ul>
<li>Âú® CA Âä†ÂØÜÂêéÁöÑÂØÜÊñá‰∏ä‰ΩøÁî®Ê†áÊ≥® CA ËØÅ‰π¶ÁöÑÁ≠æÂèëËÄÖÔºåÂèëÈÄÅÁªôÂÆ¢Êà∑Á´ØÁ´ØÔºàÂØÜÊñá + CA Á≠æÂèëËÄÖÂêç=&gt;ÂèëÂæÄÂÆ¢Êà∑Á´ØÁ´ØÊ∂àÊÅØÔºâ</li>
<li>ÂÆ¢Êà∑Á´ØÈÄöËøáÂØÜÊñá‰∏äÊ†áÊ≥®ÁöÑ CA Á≠æÂèëËÄÖÔºåÊâæÂà∞ÂØπÂ∫îÂÜÖÁΩÆÂú®ÂÆ¢Êà∑Á´ØÁîµËÑë‰∏≠ÁöÑÂÖ¨Èí•ÔºàÊ≠§Êó∂Â¶ÇÊûú‰∏≠Èó¥Êã¶Êà™ËÄÖÔºåÂè™ËÉΩÊü•Áúã‰ΩÜÊòØÊó†Ê≥ï‰º™ÈÄ†ÂÜÖÂÆπÁªôÂÆ¢Êà∑Á´ØÔºåÂõ†‰∏∫Êã¶Êà™ËÄÖÊ≤°Êúâ CA Êú∫ÊûÑÁöÑÁßÅÈí•ÔºåÂè™ËÉΩ‰ΩøÁî®ÂÖ¨Èí•Ëß£ÂØÜÊü•ÁúãÔºâ</li>
</ul>
</li>
<li>ÂÆ¢Êà∑Á´Ø‰ΩøÁî®ÂçèÂÆöÁöÑÂØπÁß∞Âä†ÂØÜÁÆóÊ≥ïÂä†ÂØÜ‰ø°ÊÅØÂæóÂà∞ÂØÜÊñáÂêëÊúçÂä°Âô® 80/3306 Á´ØÂè£ÂèëÈÄÅËØ∑Ê±Ç
<ul>
<li>‰ΩøÁî®ÂÖ¨Èí•Á†¥Ëß£Ëé∑ÂèñÁöÑÂØÜÊñáÔºåÂæóÂà∞ÊúçÂä°Âô®Á´ØÁöÑÂÖ¨Èí•„ÄÅÂüüÂêç„ÄÅÂÖ¨Èí•ÊëòË¶ÅÔºàCA ÁßÅÈí• + ÂØÜÊñá=&gt;ÂÖ¨Èí•„ÄÅÂüüÂêç„ÄÅÂÖ¨Èí•ÊëòË¶ÅÔºâ</li>
</ul>
</li>
<li>ÂÆ¢Êà∑Á´ØÂæóÂà∞ÊúçÂä°Âô®Á´ØËøîÂõûÂØÜÊñáÂêéÔºå‰ΩøÁî®ÂçèÂÆöÁöÑÂØπÁß∞Âä†ÂØÜÁÆóÊ≥ïËß£ÂØÜ‰ªéÊúçÂä°Âô®ÂæóÂà∞ÁöÑÂØÜÊñáÔºå‰∏ÄËá¥ÈÄö‰ø°‰∏ãÂéª</li>
</ol>
<figure><img src="http://cdn.lifemini.cn/dbblog/20210115/fdf2c3ef163940d6a3b4d9103ca0575b.png" alt="SSLTLS ‰º†ËæìÂçèËÆÆÂéüÁêÜ.png" tabindex="0"><figcaption>SSLTLS ‰º†ËæìÂçèËÆÆÂéüÁêÜ.png</figcaption></figure>
<h2 id="tidb‰ΩøÁî®" tabindex="-1">TiDB‰ΩøÁî® <a class="header-anchor" href="#tidb‰ΩøÁî®" aria-label="Permalink to &quot;TiDB‰ΩøÁî®&quot;"></a></h2>
<h3 id="Âà∂‰ΩúcaÂØÜÈí•ÂíåcaËØÅ‰π¶" tabindex="-1">Âà∂‰ΩúCAÂØÜÈí•ÂíåCAËØÅ‰π¶ <a class="header-anchor" href="#Âà∂‰ΩúcaÂØÜÈí•ÂíåcaËØÅ‰π¶" aria-label="Permalink to &quot;Âà∂‰ΩúCAÂØÜÈí•ÂíåCAËØÅ‰π¶&quot;"></a></h3>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># ÂÆâË£Öopenssl</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> openssl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -y</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># ‰ΩøÁî® RSA ÁÆóÊ≥ïÁîüÊàê 2048 ‰Ωç CA ÁßÅÈí•‰øùÂ≠òÂú® ca-key.pem</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># ËôΩÁÑ∂ server-key.pem Êñá‰ª∂ÁöÑÂ§¥Â∞æÈÉΩÊ†áÊ≥®ÁùÄ‚ÄúRSA PRIVATE KEY‚ÄùÔºåÂÆûÈôÖÊñá‰ª∂‰∏≠ÂåÖÊã¨‰∫ÜÂÖ¨Èí•ÂíåÁßÅÈí•,ÂÖ¨Èí•ÂíåÁßÅÈí•ÊÄªÊòØÊàêÂØπÂÑøÂá∫Áé∞</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> openssl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> genrsa</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 2048</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> ></span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ca-key.pem</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Âü∫‰∫é X509 Ê†áÂáÜ‰ΩøÁî® CA ÂØÜÈí•ÁîüÊàêÂØπÂ∫îÁöÑ CA ËØÅ‰π¶‰øùÂ≠òÂú® ca-cert.pem</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Âõ†‰∏∫ ca-key.pem ÊòØËá™Á≠æÂêçÁöÑ CA Ë∫´‰ªΩËØÅÔºåÊâÄ‰ª•‰∏äÈù¢Ê≠•È™§‰∏≠Ê≤°ÊúâÁîüÊàêË∫´‰ªΩËØÅÁî≥ËØ∑Êñá‰ª∂ÔºàCSRÔºâÁöÑËøáÁ®ãÔºåÁõ¥Êé•ËæìÂá∫‰∫Ü CA ËØÅ‰π¶</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> openssl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> req</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -new</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -x509</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -nodes</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -days</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 365000</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -key</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ca-key.pem</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -out</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ca-cert.pem</span></span></code></pre>
</div><h3 id="Âà∂‰ΩúÊúçÂä°Á´ØÂØÜÈí•ÂíåËØÅ‰π¶" tabindex="-1">Âà∂‰ΩúÊúçÂä°Á´ØÂØÜÈí•ÂíåËØÅ‰π¶ <a class="header-anchor" href="#Âà∂‰ΩúÊúçÂä°Á´ØÂØÜÈí•ÂíåËØÅ‰π¶" aria-label="Permalink to &quot;Âà∂‰ΩúÊúçÂä°Á´ØÂØÜÈí•ÂíåËØÅ‰π¶&quot;"></a></h3>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># ‰ΩøÁî® RSA ÁÆóÊ≥ïÁîüÊàê 2048 ‰ΩçÔºåÊúâÊïàÊúü 365000 Â§©ÁöÑÊúçÂä°Âô®Á´ØËØÅ‰π¶ËØ∑Ê±ÇÊñá‰ª∂„ÄÅÊúçÂä°Âô®Á´ØÊú™Âä†ÂØÜÁßÅÈí• server-key.pem  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># ÊúçÂä°Âô®Á´ØÂÖ¨Èí•ÂíåÊúçÂä°Âô®Á´Ø‰ø°ÊÅØ‰øùÂ≠òÂú®ËØÅ‰π¶ËØ∑Ê±ÇÊñá‰ª∂ server-req.pem ‰∏≠ÔºåÊúçÂä°Âô®Á´ØÂÖ¨Èí•ÊòØ‰ªé server-key.pem ÈáåÊèêÂèñÂá∫Êù•ÁöÑ  </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> openssl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> req</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -newkey</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> rsa:2048</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -days</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 365000</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -nodes</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -out</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> server-req.pem</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -keyout</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> server-key.pem</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Âü∫‰∫éÊúçÂä°Âô®Á´ØÂÖ¨ÁßÅÈí•ÂØπ server-key.pemÔºå‰ΩøÁî® RSA ÁÆóÊ≥ïÁîüÊàêÊúçÂä°Âô®Á´Ø RSA ÁßÅÈí•‰øùÂ≠òÂú® server-key.pem</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> openssl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> rsa</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> server-key.pem</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -out</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> server-key.pem</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Âü∫‰∫é X509 Ê†áÂáÜ‰ΩøÁî® CA ÁßÅÈí•ÂØπÊúçÂä°Âô®Á´ØËØÅ‰π¶ËØ∑Ê±ÇÊñá‰ª∂ server-req.pem Âä†ÂØÜÔºåÁîüÊàêÊúâÊïàÊúü365000Â§©ÔºåÂ∫èÂàóÂè∑‰Ωç 01 ÁöÑÊúçÂä°Á´ØËØÅ‰π¶</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># CA Êú∫ÊûÑÈ¶ñÂÖàÊ†°È™åÁ≠æÂêçÔºåÁÑ∂ÂêéÂÆ°Ê†∏ÂÆ¢Êà∑Á´ØÁöÑ‰ø°ÊÅØÔºåÊúÄÂêé‰ΩøÁî® CA ÁßÅÈí•‰∏∫ËØÅ‰π¶ËØ∑Ê±ÇÊñá‰ª∂Á≠æÂêçÔºåÁîüÊàêÊúçÂä°Á´ØËØÅ‰π¶Êñá‰ª∂ server-cert.pem</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> openssl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> x509</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -req</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> server-req.pem</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -days</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 365000</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -CA</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ca-cert.pem</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -CAkey</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ca-key.pem</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -set_serial</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 01</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -out</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> server-cert.pem</span></span></code></pre>
</div><p>ÁîüÊàê‰∫ÜÊúçÂä°Âô®ËØÅ‰π¶„ÄÅÊúçÂä°Âô®Á´ØÁßÅÈí•„ÄÅÊúçÂä°Âô®Á´ØÂÖ¨Èí•„ÄÅÈÄöËøáCAÁßÅÈí•Á≠æÂèëÊúçÂä°Âô®Á´ØËØÅ‰π¶</p>
<h3 id="Âà∂‰ΩúÂÆ¢Êà∑Á´ØÂØÜÈí•ÂíåËØÅ‰π¶" tabindex="-1">Âà∂‰ΩúÂÆ¢Êà∑Á´ØÂØÜÈí•ÂíåËØÅ‰π¶ <a class="header-anchor" href="#Âà∂‰ΩúÂÆ¢Êà∑Á´ØÂØÜÈí•ÂíåËØÅ‰π¶" aria-label="Permalink to &quot;Âà∂‰ΩúÂÆ¢Êà∑Á´ØÂØÜÈí•ÂíåËØÅ‰π¶&quot;"></a></h3>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># ‰ΩøÁî® RSA ÁÆóÊ≥ïÁîüÊàê 2048 ‰ΩçÔºåÊúâÊïàÊúü365000Â§©ÁöÑÂÆ¢Êà∑Á´ØÂØÜÈí•„ÄÅÂÆ¢Êà∑Á´ØËØÅ‰π¶ËØ∑Ê±ÇÊñá‰ª∂</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> openssl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> req</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -newkey</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> rsa:2048</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -days</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 365000</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -nodes</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -keyout</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> client-key.pem</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -out</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> client-req.pem</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Âü∫‰∫éÂÆ¢Êà∑Á´ØÂØÜÈí•‰ΩøÁî® RSA ÁÆóÊ≥ïËøõË°åÂÜçÂä†ÂØÜÔºåÁîüÊàêÂÆ¢Êà∑Á´Ø RSA ÁßÅÈí•</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> openssl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> rsa</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> client-key.pem</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -out</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> client-key.pem</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Âü∫‰∫é X509 Ê†áÂáÜ‰ΩøÁî®ÂÆ¢Êà∑Á´ØËØÅ‰π¶ËØ∑Ê±ÇÊñá‰ª∂Âíå CA ÁßÅÈí•ÁîüÊàêÊúâÊïàÊúü365000Â§©ÔºåÂ∫èÂàóÂè∑‰Ωç01ÁöÑÂÆ¢Êà∑Á´ØËØÅ‰π¶</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> openssl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> x509</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -req</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> client-req.pem</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -days</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 365000</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -CA</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ca-cert.pem</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -CAkey</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ca-key.pem</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -set_serial</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 01</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -out</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> client-cert.pem</span></span></code></pre>
</div><h3 id="È™åËØÅÊúçÂä°Á´ØÂíåÂÆ¢Êà∑Á´ØËØÅ‰π¶" tabindex="-1">È™åËØÅÊúçÂä°Á´ØÂíåÂÆ¢Êà∑Á´ØËØÅ‰π¶ <a class="header-anchor" href="#È™åËØÅÊúçÂä°Á´ØÂíåÂÆ¢Êà∑Á´ØËØÅ‰π¶" aria-label="Permalink to &quot;È™åËØÅÊúçÂä°Á´ØÂíåÂÆ¢Êà∑Á´ØËØÅ‰π¶&quot;"></a></h3>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># ÁîüÊàêÊúçÂä°Á´ØÂíåÂÆ¢Êà∑Á´ØËØÅ‰π¶‰πãÂêéÔºåÈÄöËøáCAËØÅ‰π¶È™åËØÅÊúçÂä°Á´ØËØÅ‰π¶„ÄÅÂÆ¢Êà∑Á´ØËØÅ‰π¶</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 CA]$ openssl verify -CAfile ca-cert.pem server-cert.pem client-cert.pem</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">server-cert.pem:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> OK</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">client-cert.pem:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> OK</span></span></code></pre>
</div><p>ÁîüÊàê‰∫ÜÂÆ¢Êà∑Á´ØËØÅ‰π¶„ÄÅÂÆ¢Êà∑Á´ØÁßÅÈí•„ÄÅÂÆ¢Êà∑Á´ØÂÖ¨Èí•„ÄÅÈÄöËøáCAÁßÅÈí•Á≠æÂèëÂê´ÊúâÂÆ¢Êà∑Á´ØËØÅ‰π¶ÁöÑÂÆ¢Êà∑Á´ØËØÅ‰π¶</p>
<p>ÈÖçÁΩÆ TiDB ÂêØÁî®ËØÅ‰π¶È™åËØÅ</p>
<div class="language-toml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">toml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">security</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">ssl-cert =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"path/to/server-cert.pem"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">ssl-key =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"path/to/server-key.pem"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">ssl-ca=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"path/to/ca-cert.pem"</span></span></code></pre>
</div><p>È™åËØÅ TLS ÂÆâÂÖ®ÈÖçÁΩÆÁîüÊïà</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 log]$ tail -20 tidb.log </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> secure</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[2021/01/15 09:30:13.356 -05:00] [INFO] [server.go:226] [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"mysql protocol server secure connection is enabled"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">] [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"client verification enabled"</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb44 CA]$ mysql -uroot -h192.168.169.41 -P4000 --ssl-cert /home/tidb/CA/client-cert.pem --ssl-key /home/tidb/CA/client-key.pem --ssl-ca /home/tidb/CA/ca-cert.pem</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Welcome</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> MySQL</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> monitor.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Commands</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> end</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> with</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">or</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \g</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Your</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> MySQL</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> connection</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> id</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> is</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 2</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Server</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> version:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 5.7.25-TiDB-v4.0.9</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> TiDB</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Server</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (Apache </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">License</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 2.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) Community Edition, MySQL 5.7 compatible</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Copyright</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (c) 2000, 2020, Oracle and/or its affiliates. All rights reserved.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> registered</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> trademark</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Oracle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Corporation</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> and/or</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> its</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">affiliates.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Other</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> names</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> may</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> be</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> trademarks</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> their</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> respective</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">owners.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Type</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'help;'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> or</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> '\h'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> help.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Type</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> '\c'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> clear</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> current</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> input</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> statement.</span></span></code></pre>
</div><h2 id="ÂèÇËÄÉÊñáÁ´†" tabindex="-1">ÂèÇËÄÉÊñáÁ´† <a class="header-anchor" href="#ÂèÇËÄÉÊñáÁ´†" aria-label="Permalink to &quot;ÂèÇËÄÉÊñáÁ´†&quot;"></a></h2>
<ol>
<li><a href="https://blog.csdn.net/liitdar/article/details/80755073" target="_blank" rel="noreferrer">liitdarÁöÑÊñáÁ´†Ôºöhttps://blog.csdn.net/liitdar/article/details/80755073</a></li>
<li><a href="https://www.cnblogs.com/struggle-1216/p/11704726.html" target="_blank" rel="noreferrer">‰∏ÄÂè∂Áü•ÁßãÁöÑÊñáÁ´†Ôºöhttps://www.cnblogs.com/struggle-1216/p/11704726.html</a></li>
</ol>
]]></content:encoded>
            <enclosure url="https://img2018.cnblogs.com/blog/1769223/201910/1769223-20191019181046559-603567130.png" length="0" type="image/png"/>
        </item>
        <item>
            <title><![CDATA[TIKV ÁõëÊéßÈù¢Êùø - Approximate region size]]></title>
            <link>https://askaric.com/zh/work/tidb/03TiDB-ËøêÁª¥ÁÆ°ÁêÜ/3-1TiDB ÁõëÊéßËØ¶Ëß£/03TiKV Details ËØ¶Ëß£.html</link>
            <guid>https://askaric.com/zh/work/tidb/03TiDB-ËøêÁª¥ÁÆ°ÁêÜ/3-1TiDB ÁõëÊéßËØ¶Ëß£/03TiKV Details ËØ¶Ëß£.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[Server
 Approximate region size
tikv_raftstore_region_size_bucket
region_size = (Mem Size + CF Stora]]></description>
            <content:encoded><![CDATA[<h1 id="tikv-ÁõëÊéßÈù¢Êùø-approximate-region-size" tabindex="-1">TIKV ÁõëÊéßÈù¢Êùø - Approximate region size <a class="header-anchor" href="#tikv-ÁõëÊéßÈù¢Êùø-approximate-region-size" aria-label="Permalink to &quot;TIKV ÁõëÊéßÈù¢Êùø - Approximate region size&quot;"></a></h1>
<h1 id="server" tabindex="-1">Server <a class="header-anchor" href="#server" aria-label="Permalink to &quot;Server&quot;"></a></h1>
<h2 id="approximate-region-size" tabindex="-1">Approximate region size <a class="header-anchor" href="#approximate-region-size" aria-label="Permalink to &quot;Approximate region size&quot;"></a></h2>
<p>tikv_raftstore_region_size_bucket</p>
<p>region_size = (Mem Size + CF Storage Size)[&quot;default&quot;, &quot;lock&quot;, &quot;write&quot;]</p>
<p>there're 2 ways, TiKV gets RegionSize(accurate scan/approximate estimate), but, only one scenario has used &quot;accurate scan&quot; which's <a href="https://github.com/tikv/tikv/blob/0e3806935c11be6bf9a75d8666a183520d3c4556/components/raftstore/src/store/fsm/peer.rs#L6185" target="_blank" rel="noreferrer">after split command executing and checking</a>, or, there's <a href="https://github.com/tikv/tikv/blob/0e3806935c11be6bf9a75d8666a183520d3c4556/components/raftstore/src/store/worker/pd.rs#L1998" target="_blank" rel="noreferrer">no splitKey from pd</a>:</p>
<ol>
<li><a href="https://github.com/tikv/tikv/blob/0e3806935c11be6bf9a75d8666a183520d3c4556/components/raftstore/src/store/worker/split_check.rs#L631" target="_blank" rel="noreferrer">CheckPolicy::Scan</a> --&gt;  <a href="https://github.com/tikv/tikv/blob/0e3806935c11be6bf9a75d8666a183520d3c4556/components/raftstore/src/store/worker/split_check.rs#L852" target="_blank" rel="noreferrer">router.update_approximate_size</a> --&gt; <a href="https://github.com/tikv/tikv/blob/0e3806935c11be6bf9a75d8666a183520d3c4556/components/raftstore/src/store/fsm/peer.rs#L6276" target="_blank" rel="noreferrer">SplitCheckTrigger</a></li>
<li><a href="https://github.com/tikv/tikv/blob/0e3806935c11be6bf9a75d8666a183520d3c4556/components/raftstore/src/store/worker/split_check.rs#L653" target="_blank" rel="noreferrer">CheckPolicy::Approximate</a>  _ _ _ _ _ _ _ _ $\uparrow$</li>
</ol>
<p>Tracking List:</p>
<ol>
<li><a href="https://github.com/tikv/tikv/issues/6161" target="_blank" rel="noreferrer">Thoughts of improving region approximate size accuracy and efficiency</a></li>
<li><a href="https://github.com/tikv/tikv/issues/12025" target="_blank" rel="noreferrer">https://github.com/tikv/tikv/issues/12025</a></li>
<li></li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[KV Backoff OPS]]></title>
            <link>https://askaric.com/zh/work/tidb/03TiDB-ËøêÁª¥ÁÆ°ÁêÜ/3-1TiDB ÁõëÊéßËØ¶Ëß£/04ÊåáÊ†áÁÆÄ‰ªã/KV Backoff OPS.html</link>
            <guid>https://askaric.com/zh/work/tidb/03TiDB-ËøêÁª¥ÁÆ°ÁêÜ/3-1TiDB ÁõëÊéßËØ¶Ëß£/04ÊåáÊ†áÁÆÄ‰ªã/KV Backoff OPS.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[123
Á±ªÂûãÔºö
1. tikvRPC, tiflashRPC
send tiflash request error, send tikv request error, tikv server time]]></description>
            <content:encoded><![CDATA[<h1 id="kv-backoff-ops" tabindex="-1">KV Backoff OPS <a class="header-anchor" href="#kv-backoff-ops" aria-label="Permalink to &quot;KV Backoff OPS&quot;"></a></h1>
<p><a href="https://github.com/tikv/client-go/blob/6beede6998b6b23aee8e816f95f293d4d0363704/metrics/metrics.go#L156-L164" target="_blank" rel="noreferrer">123</a></p>
<p>Á±ªÂûãÔºö</p>
<ol>
<li>tikvRPC, tiflashRPC</li>
</ol>
<p>send tiflash request error, send tikv request error, tikv server timeout, tiflash server timeout</p>
<ol start="2">
<li>pdRPC
RegionCache</li>
</ol>
<p>failed to decode region range key, key
loadRegion from PD failed, key:
region not found for key
receive Region with no available peer</p>
<p>failed to decode region range key, regionID:
loadRegion from PD failed, regionID:
region not found for regionID
receive Region with no available peer</p>
<p>scanregion
failed to decode region range key, limit:
scanRegion from PD failed, limit:
PD returned no region, limit:
PD returned regions have gaps, limit:</p>
<p>batchscan
failed to decode region range key, range num:
batchScanRegion from PD failed, range num:</p>
<p>TiDB --&gt; KV Request --&gt; Load Region Duration --&gt; get_region_when_miss</p>
<p>StoreCache
loadStore from PD failed, id</p>
<p>get timestamp failed:
get minimum timestamp failed:</p>
<p>scatterRegion
batch split regions complete
start scatter region --&gt; backoff
batch split regions, scatter region complete
batch split regions, scatter region failed</p>
<ol start="3">
<li>
<p>tikvLockFast -&gt; resolve lock timeout --&gt; <a href="https://docs.pingcap.com/zh/tidb/v8.4/system-variables#tidb_backoff_lock_fast" target="_blank" rel="noreferrer">https://docs.pingcap.com/zh/tidb/v8.4/system-variables#tidb_backoff_lock_fast</a>
backoffer.maxSleep %dms is exceeded, errors:
total-backoff-times: %v, backoff-detail: %v, maxBackoffTimeExceeded: %v, maxExcludedTimeExceeded:
longest sleep type: %s, time: %dms&quot;</p>
</li>
<li>
<p>txnLock --&gt; resolve lock timeout</p>
<ol>
<li>&quot;remain locks: &quot; --„Äã <a href="https://docs.pingcap.com/tidb/stable/garbage-collection-overview#resolve-locks" target="_blank" rel="noreferrer">https://docs.pingcap.com/tidb/stable/garbage-collection-overview#resolve-locks</a></li>
<li>&quot;[pipelined dml] flush lockedKeys: &quot;, &quot;[pipelined dml] backoff failed during flush&quot;</li>
<li>&quot;2PC prewrite lockedKeys:&quot;</li>
</ol>
</li>
<li>
<p>regionMiss
regionScheduling
serverBusy
tikvDiskFull
regionRecoveryInProgress
staleCommand
dataNotReady
isWitness
...</p>
</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <link>https://askaric.com/zh/work/tidb/03TiDB-ËøêÁª¥ÁÆ°ÁêÜ/3-1TiDB ÁõëÊéßËØ¶Ëß£/TIDB Panel - Disconnection Count.html</link>
            <guid>https://askaric.com/zh/work/tidb/03TiDB-ËøêÁª¥ÁÆ°ÁêÜ/3-1TiDB ÁõëÊéßËØ¶Ëß£/TIDB Panel - Disconnection Count.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[1. Èù¢ÊùøÁÆÄ‰ªã
   ËØ•Èù¢ÊùøÁªüËÆ° APP &lt;--
2. Èù¢Êùø‰ΩçÁΩÆ
Cluster-TiDB --&gt; Server --&gt; Disconnection Count
ÂõæÁâá
3. Èù¢ÊùøËØ¶ÊÉÖ]]></description>
            <content:encoded><![CDATA[<ol>
<li>
<p>Èù¢ÊùøÁÆÄ‰ªã
ËØ•Èù¢ÊùøÁªüËÆ° APP &lt;--&gt; TiDB ‰πãÈó¥Êñ≠ÂºÄËøûÊé•ÁöÑÊï∞ÈáèÂèäÂàÜÁ±ª„ÄÇ</p>
</li>
<li>
<p>Èù¢Êùø‰ΩçÁΩÆ
Cluster-TiDB --&gt; Server --&gt; Disconnection Count
ÂõæÁâá</p>
</li>
<li>
<p>Èù¢ÊùøËØ¶ÊÉÖ
‰∏ªË¶ÅÁî± 3 Á±ªÊûÑÊàê
error
ok
undetermined</p>
<p>ok : Ê≠§Á±ªÂûãÊåáÊ†áÂè™ÊúâÂú®Êé•Âà∞ APP ‰∏ªÂä®Êñ≠ËÅîËØ∑Ê±ÇÂêéÊâç‰ºöÂ¢ûÈïø„ÄÇ
ÂõæÁâá
error : Ê≠§Á±ªÊåáÊ†áÈÄöÂ∏∏ÊåáÂêëÁΩëÁªúÂºÇÂ∏∏ÔºåÂºïÂèëÁöÑÊÑèÂ§ñÊñ≠ËÅîÔºå‰∏ªË¶ÅÁî±‰∏ãËø∞ 3 Á±ªÊÉÖÂÜµÊûÑÊàê„ÄÇ
a. Â¶ÇÂõækill query/session ÂºïÂèëÁöÑÊñ≠ËÅîÔºåÂèØÂú® tidb.log ÁúãÂà∞ÂÖ≥ÈîÆÂ≠ó ‚Äúread packet timeout because of killed connection‚Äù Êàñ ‚Äúread packet timeout, close this connection‚Äù„ÄÇ
ÂõæÁâá
b. Ë∂ÖËøáÂèÇÊï∞ max_allowed_packet ÈôêÂà∂ÔºåÂºïÂèëÊñ≠ËÅîÔºåÂèØÂú® tidb.log ‰∏≠ÂèëÁé∞ÂÖ≥ÈîÆÂ≠ó ‚ÄúGot a packet bigger than 'max_allowed_packet' bytes‚Äù„ÄÇ
c. ÈìæÊé•Ë¢´‰∏≠Èó¥‰ª∂Êàñ‰ΩçÁΩÆÁªÑÂª∫ÊùÄÊéâÔºàÊó¢‰∏çÊòØ APP Âèà‰∏çÊòØ TiDBÔºâÔºå‰æùÁÖßÁªèÈ™åÁúãÈÄöÂ∏∏ÊòØÁî±‰∫é Haproxy/Nginx/F5 Á≠â‰∏≠Èó¥‰ª∂ÈÖçÁΩÆÂØºËá¥ÔºåÂ¶ÇÔºöÊú™ÈÖçÁΩÆÊé¢Ê¥ªÂèÇÊï∞ÂÆöÊúüÊùÄ‰∏çÊ¥ªË∑ÉÈìæÊé•„ÄÇÂú® tidb.log ‰∏≠‰ºöÂèëÁé∞ÂÖ≥ÈîÆÂ≠ó ‚Äúuse of closed network connection‚Äù Êàñ ‚Äúread packet failed, close this connection‚Äù„ÄÇ
undetermined : Ê≠§Á±ªÊåáÊ†áÊåá tidb-server Êó†Ê≥ïÁ°ÆÂÆö‰∫ãÂä°ÊòØÂê¶Â∑≤ÊàêÂäüÊèê‰∫§Êó∂Êä•ÈîôËá≥ÊúÄ‰∏äÂ±ÇÔºåÂç≥ÔºöÊ≤°Êî∂Âà∞ TXN Primary key ÁöÑËØ∑Ê±ÇÁöÑÂìçÂ∫îÔºåÈúÄË¶ÅÁªìÂêà‰∏ä‰∏ãÊñáËøõ‰∏ÄÊ≠•ÂàÜÊûê„ÄÇÂú® tidb.log ‰∏≠ÂèØ‰ª•ÁúãÂà∞ ‚Äúresult undetermined, close this connection‚Äù„ÄÇ
ÂõæÁâá</p>
</li>
<li>
<p>ÂèÇËÄÉÊñáÁåÆ
refine errors for undetermined result : <a href="https://github.com/pingcap/tidb/pull/3423" target="_blank" rel="noreferrer">https://github.com/pingcap/tidb/pull/3423</a>
tidb ÂÆòÊñπÊñáÊ°£ : <a href="https://docs.pingcap.com/zh/tidb/v7.5/grafana-tidb-dashboard#server" target="_blank" rel="noreferrer">https://docs.pingcap.com/zh/tidb/v7.5/grafana-tidb-dashboard#server</a></p>
</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <link>https://askaric.com/zh/work/tidb/03TiDB-ËøêÁª¥ÁÆ°ÁêÜ/3-1TiDB ÁõëÊéßËØ¶Ëß£/TIDB Panel - KV Backoff OPS.html</link>
            <guid>https://askaric.com/zh/work/tidb/03TiDB-ËøêÁª¥ÁÆ°ÁêÜ/3-1TiDB ÁõëÊéßËØ¶Ëß£/TIDB Panel - KV Backoff OPS.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[1. Èù¢ÊùøÁÆÄ‰ªã
   ËØ•Èù¢ÊùøÁöÑÁªüËÆ°‰Ωç‰∫é‰∏ãÂõæÁöÑ tikv client Ê®°ÂùóÔºåÂ¶ÇÂõæÊâÄÁ§∫Ôºå‰∏ªË¶ÅÁî®‰∫éÁªüËÆ°ÈõÜÁæ§Â±ÇÈù¢ TiDB-Server ‰∏é TiKV-Server ‰∫§‰∫íËøáÁ®ã‰∏≠Ôºå‰∏çÂêå‚ÄúÈáçËØï‚ÄùÁ±ªÂûãÁöÑÈ¢ëÊ¨°„ÄÇ
Âõæ]]></description>
            <content:encoded><![CDATA[<ol>
<li>
<p>Èù¢ÊùøÁÆÄ‰ªã</p>
<p>ËØ•Èù¢ÊùøÁöÑÁªüËÆ°‰Ωç‰∫é‰∏ãÂõæÁöÑ tikv client Ê®°ÂùóÔºåÂ¶ÇÂõæÊâÄÁ§∫Ôºå‰∏ªË¶ÅÁî®‰∫éÁªüËÆ°ÈõÜÁæ§Â±ÇÈù¢ TiDB-Server ‰∏é TiKV-Server ‰∫§‰∫íËøáÁ®ã‰∏≠Ôºå‰∏çÂêå‚ÄúÈáçËØï‚ÄùÁ±ªÂûãÁöÑÈ¢ëÊ¨°„ÄÇ</p>
</li>
</ol>
<p>ÂõæÁâá
Âú® TiDB ÁöÑÂàÜÂ∏ÉÂºè‰∫§‰∫í‰∏≠Ôºå&quot;ÈáçËØï&quot; Êó†Ê≥ïÊ†πÊú¨‰∏äÂÆåÂÖ®ÈÅøÂÖçÔºå‰∏éÂÖ∂ÂÆåÂÖ®ÈÅøÂÖçÔºåÈááÁî®‰∏ÄÁßçÊõ¥‰∏∫ÂêàÁêÜÁöÑËß£ÂÜ≥ÊñπÊ°àÔºà‰æãÂ¶ÇÊòì‰∫éÁêÜËß£ÂíåÂÆûÁé∞ÁöÑ‰ºòÁÇπÔºâÊõ¥‰∏∫Â∏∏ËßÅ„ÄÇÂÆûÁé∞‰∏äÂÄüÈâ¥‰∫Ü OCC Ôºà‰πêËßÇÂπ∂ÂèëÊéßÂà∂ÔºâÁÆóÊ≥ï‰∏∫ÂÜ≤Á™ÅÂ¢ûÂä†Áù°Áú†Êó∂Èó¥ÔºåÈÄöËøáÂºïÂÖ•Áù°Áú†Êó∂Èó¥Êù•ÂáèÂ∞ëÂÜ≤Á™ÅÁöÑÂèëÁîüÈ¢ëÊ¨°Ôºå‰ªéËÄåÈôç‰Ωé‰∫âÁî®„ÄÇ</p>
<p>ÂõæÁâá
ËØ•Èù¢ÊùøÊúâÂä©‰∫éÂàÜÊûêÂú®ÊÄßËÉΩÈóÆÈ¢òÂèëÁîüÊó∂ÊòØÂê¶Âõ†‚ÄúÈáçËØï‚ÄùÂØºËá¥ÊÄßËÉΩ‰∏ãÈôçÔºåÂπ∂‰∏îÁªìÂêà‰∏çÂêåÁöÑ‚ÄúÈáçËØïÁ±ªÂûã‚ÄùÂèØ‰ª•Ëøõ‰∏ÄÊ≠•ÂÖ≥ËÅî‰∏ä‰∏ãÊñáÂàÜÊûêÈóÆÈ¢òÁöÑÊ†πÊ∫ê„ÄÇ</p>
<ol start="2">
<li>
<p>Èù¢Êùø‰ΩçÁΩÆ</p>
<p>Cluster-TiDB --&gt; KV Errors --&gt; KV Backoff OPS</p>
</li>
</ol>
<p>ÂõæÁâá</p>
<ol start="3">
<li>
<p>Èù¢ÊùøËØ¶ÊÉÖ</p>
<p>ÈáçËØïÁ±ªÂûãÔºö</p>
</li>
</ol>
<p>tikvRPC</p>
<p>tiflashRPC</p>
<p>pdRPC</p>
<p>tikvLockFast</p>
<p>txnLock</p>
<p>regionMiss</p>
<p>regionScheduling</p>
<p>serverBusy</p>
<p>tikvDiskFull</p>
<p>regionRecoveryInProgress</p>
<p>staleCommand</p>
<p>isWitness</p>
<ol>
<li>
<p>tikvRPC, tiflashRPC</p>
<p>ËøôÁ±ªÈáçËØïÈÄöÂ∏∏‰º¥ÈöèÂá∫Áé∞Âú®TiDBÊó•Âøó‰∏≠ÔºåÈúÄË¶ÅÁªìÂêà‰∏ä‰∏ãÊñáÂàÜÊûê„ÄÇÊó•Âøó‰∏≠ÁöÑ &quot;send tiflash request error&quot; Âíå &quot;tiflash server timeout&quot; Ë°®Á§∫tiflashÂèØËÉΩÂèëÁîü‰∫Ü‰∏çÂèØÁî®ÔºõËÄå &quot;send tikv request error&quot; Âíå &quot;tikv server timeout&quot; Ë°®Á§∫tikvÂèØËÉΩ‰∏çÂèØÁî®„ÄÇ</p>
</li>
<li>
<p>pdRPC</p>
<p>ËøôÁßçÈáçËØïÂèØËÉΩÂèëÁîüÂú® RegionCache„ÄÅStoreCache„ÄÅKvStore Âíå Split &amp; ScatterRegion Á≠âË∞ÉÁî®ËøáÁ®ã‰∏≠„ÄÇÈÄöÂ∏∏ÊòØÂú®‰∏éPDÈÄö‰ø°Êó∂ÂèëÁîüÈîôËØØÔºö</p>
<p>RegionCacheÔºöTiDB-Server ÂÜÖÈÉ®Áª¥Êä§ÁºìÂ≠òÔºåÁî®‰∫éÂø´ÈÄüÂÆö‰ΩçÂíåËÆøÈóÆ Region„ÄÇÂ¶ÇÊûú RegionCache ‰∏≠ÁöÑÁºìÂ≠ò‰ø°ÊÅØËøáÊó∂Ôºå‰ºöÈÄöËøá PD Ëé∑ÂèñÊúÄÊñ∞ÁöÑRegion‰ø°ÊÅØ„ÄÇ</p>
</li>
</ol>
<p>ÂõæÁâá
Â¶ÇÊûú RegionCache ÂèëÁé∞Ëá™Â∑±ÁºìÂ≠òÁöÑ Region ÊòØËøáÊóßÁöÑ‰ºöÈ¶ñÂÖà‰ªé PD Ëé∑ÂèñÂπ∂Êõ¥Êñ∞ÔºåÂõ†‰∏∫ PD Áª¥Êä§ÁùÄÂÖ®Â±ÄÁöÑ Region ‰ø°ÊÅØ„ÄÇÂõ†Ê≠§ÔºåË∞ÉÁî®Â¶ÇÊûúÂèëÁîüÈîôËØØ‰ºöÂΩíÂ±ûÂà∞ pdRPC ÈáåÈù¢„ÄÇ</p>
<pre><code>   Âú® tidb.log ‰∏≠ÈÄöÂ∏∏‰ºöÂá∫Áé∞ÂØπÂ∫îÂÖ≥ÈîÆÂ≠óÁöÑÊó•Âøó„ÄÇ
</code></pre>
<p>failed to decode region range key, key</p>
<p>loadRegion from PD failed, key</p>
<p>region not found for key</p>
<p>receive Region with no available peer</p>
<p>failed to decode region range key, regionID</p>
<p>loadRegion from PD failed, regionID</p>
<p>region not found for regionID</p>
<p>receive Region with no available peer</p>
<p>failed to decode region range key, limit</p>
<p>scanRegion from PD failed, limit</p>
<p>PD returned no region, limit</p>
<p>PD returned regions have gaps, limit</p>
<p>failed to decode region range key, range num</p>
<p>batchScanRegion from PD failed, range num</p>
<p>RegionCache ‰πü‰ºöÁª¥Êä§ Store(TiKV) ÁöÑ‰ø°ÊÅØÔºåÂ¶ÇÊûúËØ∑Ê±Ç PD ÂèëÁîüÂ§±Ë¥•‰πü‰ºöÈáçËØïÔºåÂèØÂú® tidb.log ‰∏≠ÂèëÁé∞‰∏ãËø∞ÂÖ≥ÈîÆÂ≠ó loadStore from PD failed, id„ÄÇ</p>
<p>KvStore : ÊØè‰∏™‰∫ãÂä°ÈÉΩ‰ºöËøá KvStoreÔºåÊúâÂèØËÉΩ‰ºöÂú®ËøôÈáåËé∑Âèñ TSOÔºàÊØèÊ¨°Ëé∑Âèñ‰∏ÄÊâπ TSOÔºâÔºåÂ¶ÇÊûúËé∑ÂèñÂ§±Ë¥•‰ºöÂú® tidb.log ‰∏≠Âá∫Áé∞ ‚Äúget timestamp failed‚ÄùÔºå‚Äúget minimum timestamp failed‚Äù„ÄÇ</p>
<p>Split &amp;ScatterRegion ÔºöTiDB ÊúâÂæàÂ§ö Split Region ÁöÑÂú∞ÊñπÔºåÁî±Ë∞ÉÂ∫¶Ëá™Âä®Ëß¶ÂèëÊàñÊâãÂä®Ëß¶ÂèëÔºåÂÖà Split ‰∏Ä‰∏™ Region ‰∏∫ 2 ‰∏™ÔºåÂÜçÂ∞Ü Region Ë∞ÉÂ∫¶Âà∞‰∏çÂêå Store ‰∏ä‰ª•Ëß£ÂÜ≥ÁÉ≠ÁÇπÈóÆÈ¢ò„ÄÇ‰∏ªË¶ÅËØ∑Ê±ÇÂèëÁªô PD ÂéªË∞ÉÂ∫¶ÔºåÂõ†Ê≠§‰πüÂΩíÁ±ªÂà∞ pdRPC Á±ªÂûã‰∏ä„ÄÇÈÄöÂ∏∏Âú® tidb.log ‰∏≠‰ºö‰º¥Êúâ‰∏ãËø∞Êó•ÂøóÂÖ≥ÈîÆÂ≠óÔºå‚Äústart scatter region‚Äù</p>
<p>batch split regions complete</p>
<p>start scatter region</p>
<p>batch split regions, scatter region complete</p>
<p>batch split regions, scatter region failed</p>
<ol start="3">
<li>
<p>tikvLockFast, txnLock</p>
<p>Ê≠§Á±ªÈáçËØï‰∏ªË¶ÅÁî±ÈîÅÊú∫Âà∂ÂºïÂèëÔºåÊòØÂ∏∏ËßÅÁöÑÂëäË≠¶Á±ªÂûãÔºåÊú¨Ë¥®‰∏äÊó†ËÆ∫ ‚ÄúËØªÂÜôÂÜ≤Á™Å‚Äù Êàñ ‚ÄúÂÜôÂÜôÂÜ≤Á™Å‚Äù ÈÉΩÊòØÁî±‰∫ãÂä°ÂÆåÊàêÁöÑ‰∏çÂ§üÂø´ÈÄ†ÊàêÁöÑÔºåÈÅáÂà∞ËØ•Á±ªÈóÆÈ¢òËøòÊòØÂª∫ËÆÆÊõ¥ÁªÜËäÇÂàÜÊûê‰∏çÂ§üÂø´ÁöÑ‚ÄúÊ†πÂõ†‚ÄùÔºåÂπ∂ÈíàÂØπÊÄßÁöÑËß£ÂÜ≥„ÄÇ</p>
<p>tikvLockFastÔºö‰ª£Ë°®Âá∫Áé∞‰∫ÜËØªÂÜôÂÜ≤Á™Å, Â¶Ç‰∏ãÂõæÊâÄÁ§∫„ÄÇ</p>
</li>
</ol>
<p>ÂõæÁâá</p>
<p>txnLockÔºö‰ª£Ë°®Âá∫Áé∞‰∫ÜÂÜôÂÜôÂÜ≤Á™ÅÔºå‰∫ãÂä°Âú® Prewrite Èò∂ÊÆµÁöÑÁ¨¨‰∏ÄÊ≠•Â∞±‰ºöÊ£ÄÊü•ÊòØÂê¶ÊúâÂÜôÂÜôÂÜ≤Á™ÅÔºåÁ¨¨‰∫åÊ≠•‰ºöÊ£ÄÊü•ÁõÆÊ†á key ÊòØÂê¶Â∑≤ÁªèË¢´Âè¶‰∏Ä‰∏™‰∫ãÂä°‰∏äÈîÅ„ÄÇÂΩìÊ£ÄÊµãÂà∞ËØ• key Ë¢´ lock ÂêéÔºå‰ºöËá™Âä®ËøõË°å backoff ÈáçËØïÂπ∂ËÆ∞ÂΩï‰∏∫ txnLock„ÄÇ</p>
<ol start="4">
<li>
<p>regionMiss, regionScheduling</p>
<p>regionMiss : Ê≠§ÈáçËØïÁî± TiDB-Server ÂèëÂæÄ TiKV-Server ËøáÁ®ã‰∏≠, Region Cache ‰∏≠ÁºìÂ≠òÁùÄÈîôËØØÁöÑ region ‰ø°ÊÅØÂØºËá¥Ôºå Âõ†‰∏∫ Region Â∑≤ÁªèË¢´Ë∞ÉÂ∫¶Ëµ∞‰∫Ü„ÄÇÂèØËÉΩÂú® splitRegion, deleteRange, 2PC Txn, Ê∏ÖÈîÅ, Âä†ÈîÅ, Ê∏Ö‰∫ãÁâ©, piplineFlush, prewrite, scanRegion, snapshot ËøáÁ®ã‰∏≠ÈÅ≠ÈÅá„ÄÇ</p>
<p>regionScheduling : Ê≠§Á±ªÈáçËØï‰∏é regionMiss Á±ª‰ººÔºå‰ΩÜÊõ¥Â§öÁâπÊåáÊ≠§Êó∂ Region Ê≠£Âú®ÈÄâ‰∏æÊàñÊ≠£Âú®Ë∞ÉÂ∫¶ÔºåÊâÄ‰ª• tidb.log ‰ºöÁúãÂà∞ÂÖ≥ÈîÆÂ≠ó &quot;read index not ready, ctx&quot;, &quot;region is merging, ctx&quot;, &quot;no leader, ctx&quot;„ÄÇ</p>
</li>
<li>
<p>regionRecoveryInProgress</p>
</li>
</ol>
<p>Ê≠§Á±ªÈáçËØïÔºåÁâπÊåáÈõÜÁæ§Ê≠£Âú®ËøõË°å Online recovery ÔºåÊãíÁªùÂÜôÂÖ•‰ª•ÈÅøÂÖçÊΩúÂú®ÈóÆÈ¢òÂèëÁîüÁöÑÈáçËØï„ÄÇ</p>
<ol start="6">
<li>
<p>È°æÂêçÊÄù‰πâ serverBusy, tikvDiskFull</p>
<p>serverBusy : ÂèØ‰ª•ÂàÜ‰∏∫ tiflashServerBusy Âíå tikvServerBusyÔºå</p>
</li>
<li>
<p>staleCommand</p>
<p>StaleCommand : Ë°®Á§∫ËØ∑Ê±ÇÂèëÈÄÅÁªô‰∫ÜÊóß Region LeaderÔºå‰∏îÂÖ∂ Term Â∑≤Êõ¥ÊîπÔºåÊó†Ê≥ïÁü•ÈÅì‰∏ä‰∏Ä‰∏™ËØ∑Ê±ÇÊòØÂê¶Â∑≤Êèê‰∫§ÔºåÈúÄË¶ÅÈáçËØïËØ∑Ê±Ç„ÄÇ</p>
</li>
<li>
<p>isWitness</p>
<p>isWitness : ËøôÊòØTiKVÁöÑ‰∏ÄÈ°πÊú™Ê≠£ÂºèÂèëÂ∏ÉÁöÑÂäüËÉΩ„ÄÇÂú®‰∫ëÁéØÂ¢É‰∏ãÔºå‰∏∫‰∫Ü‰øùËØÅ99.99%ÁöÑÂèØÁî®ÊÄßÔºå‰ΩøÁî®TiKVÁöÑRaft‰∏âÂâØÊú¨‰ºöÊµ™Ë¥πËµÑÊ∫ê„ÄÇËØ•ÂäüËÉΩÈÄöËøáÂºïÂÖ•ËßÅËØÅÔºàWitnessÔºâËßíËâ≤Êù•ÊèêÈ´òËµÑÊ∫êÂà©Áî®ÁéáÔºåÈáçËØïÈÄöÂ∏∏ÂèëÁîüÂú®Áõ∏ÂÖ≥ÂäüËÉΩ‰∏ã„ÄÇ</p>
</li>
<li>
<p>ÂèÇËÄÉÊñáÁåÆ</p>
</li>
</ol>
<p>Exponential Backoff And Jitter | AWS Architecture Blog : <a href="https://aws.amazon.com/cn/blogs/architecture/exponential-backoff-and-jitter" target="_blank" rel="noreferrer">https://aws.amazon.com/cn/blogs/architecture/exponential-backoff-and-jitter</a></p>
<p>TiDB ÈîÅÂÜ≤Á™ÅÈóÆÈ¢òÂ§ÑÁêÜ : <a href="https://docs.pingcap.com/zh/tidb/stable/troubleshoot-lock-conflicts" target="_blank" rel="noreferrer">https://docs.pingcap.com/zh/tidb/stable/troubleshoot-lock-conflicts</a></p>
<p>Github client-go repo : <a href="https://github.com/tikv/client-go" target="_blank" rel="noreferrer">https://github.com/tikv/client-go</a></p>
<p>witness feature : <a href="https://github.com/tikv/tikv/issues/12876" target="_blank" rel="noreferrer">https://github.com/tikv/tikv/issues/12876</a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[TiDB‰πãPrometheus]]></title>
            <link>https://askaric.com/zh/work/tidb/03TiDB-ËøêÁª¥ÁÆ°ÁêÜ/3-1TiDB ÁõëÊéßËØ¶Ëß£/TiDB-Prometheus.html</link>
            <guid>https://askaric.com/zh/work/tidb/03TiDB-ËøêÁª¥ÁÆ°ÁêÜ/3-1TiDB ÁõëÊéßËØ¶Ëß£/TiDB-Prometheus.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[# TiDB‰πãPrometheus

Â¶ÇÊûúÊÇ®ÈúÄË¶Å100%ÁöÑÂáÜÁ°ÆÊÄßÔºå‰æãÂ¶ÇÊåâËØ∑Ê±ÇËÆ°Ë¥πÔºåÊôÆÁΩóÁ±≥‰øÆÊñØ‰∏çÊòØ‰∏Ä‰∏™Â•ΩÈÄâÊã©ÔºåÂõ†‰∏∫Êî∂ÈõÜÁöÑÊï∞ÊçÆÂèØËÉΩ‰∏çÂ§üËØ¶ÁªÜÂíåÂÆåÊï¥„ÄÇÂú®ËøôÁßçÊÉÖÂÜµ‰∏ãÔºåÊÇ®ÊúÄÂ•Ω‰ΩøÁî®ÂÖ∂‰ªñÁ≥ªÁªüÊù•Êî∂ÈõÜÂíåÂàÜÊûêËÆ°Ë¥πÊï∞ÊçÆÔºåÂπ∂‰ΩøÁî®ÊôÆÁΩóÁ±≥‰øÆÊñØËøõË°åÂÖ∂‰ΩôÁöÑÁõëÊéß„ÄÇ

## ‰∏Ä„ÄÅprometheus ÁâπÊÄßÂÆö‰πâ

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‰æùÊçÆ [Prometheus ÂÆòÁΩëÁöÑÂÆö‰πâ](https://prometheus.io/docs/introduction/overview/#what-is-prometheus),Prometheus ÊòØ‰∏Ä‰∏™ÂºÄÊ∫êÁöÑ„ÄÅÁ≥ªÁªüÁõëÊéßÂèäË≠¶Êä•ÁöÑÂ∑•ÂÖ∑ÂåÖ„ÄÇÂÖ∑ÊúâÂ¶Ç‰∏ãÁâπÁÇπÔºö

1. **Â§öÁª¥Êó∂Â∫èÊï∞ÊçÆÔºö** Prometheus ‰ª•Êó∂Èó¥Â∫èÂàó‰∏∫Âü∫Á°ÄÔºåÈÄöËøáËøΩÂä†ÈîÆÂÄºÂØπÊ†áËØÜÁöÑÊñπÂºèÔºåÂÆûÁé∞‰∫ÜÂ§öÁª¥Â∫¶ÁöÑÊï∞ÊçÆÊ®°Âûã„ÄÇ
2. **Êü•ËØ¢ËØ≠Âè•ÊîØÊåÅÔºö** Prometheus ÊîØÊåÅ PromQL ÂÖÅËÆ∏ÂØπÊó∂Èó¥Â∫èÂàóÊï∞ÊçÆÂàáÁâáËÆ°ÁÆóÔºå‰ª•‰æøÁîüÊàêÂõæË°®„ÄÅË°®Ê†º„ÄÅË≠¶Êä•„ÄÇPromQL ‰∏é SQL Á±ª‰ººÔºåÂêåÂ±ûÂ£∞ÊòéÂºèÊü•ËØ¢ËØ≠Ë®ÄÔºåPrometheus Êèê‰æõ‰∫ÜÂ§öÁßçÂáΩÊï∞ÂÆåÊàêÔºåÊó∂Â∫èÊï∞ÊçÆÁöÑËÅöÂêàÔºåÂ¶ÇÔºörate„ÄÅirate„ÄÅdelta Á≠âÁ≠â„ÄÇ
3. **ÂèØËßÜÊïàÊûúÁæéËßÇÔºö** Prometheus ÊîØÊåÅÂ§öÁßçÁöÑÂèØËßÜÂåñÊ®°ÂºèÔºåÂ¶ÇÔºöÂÜÖÁΩÆÁöÑ Dashboard ÊµèËßàÂô®ÊàñÈõÜÊàê Grafana Á≠â„ÄÇ
4. **Â≠òÂÇ®ÊñπÂºèÈ´òÊïàÔºö** Prometheus ‰ª•Ëá™ÂÆö‰πâÊ†ºÂºèÂ∞ÜÊó∂Èó¥Â∫èÂàóÂ≠òÂÇ®Âú®ÂÜÖÂ≠òÂèäÊú¨Âú∞Á£ÅÁõòÔºåÁº©ÊîæÈÄöËøáÂàÜÁâáÂíåËÅîÂêàÂÆûÁé∞„ÄÇËá™ v2 ‰ª•ÂêéÔºåPrometheus ÂÆûÁé∞‰∫ÜÁ±ª‰ºº‰∫é LSM Êï∞ÊçÆÂ∫ìÁöÑ Block„ÄÅWAL„ÄÅCompaction Á≠âÁªìÊûÑÔºåÊûÅÂ§ßÈÅøÂÖçÈöèÊú∫ËØª„ÄÅÈöèÊú∫ÂÜôÔºåÂä†Âø´ËØªÂÜôÈÄüÁéá„ÄÇ  
5. **ÈÉ®ÁΩ≤Êìç‰ΩúÁÆÄÂçïÔºö** Prometheus Áî® Go ÁºñÂÜôÔºåÊØèÂè∞ÊúçÂä°Âô®‰ªÖ‰æùËµñÊú¨Âú∞Â≠òÂÇ®ÔºåÁã¨Á´ã‰∫éÂèØÈù†‰∏îÊòì‰∫éÈÉ®ÁΩ≤„ÄÇ
6. **ÂëäË≠¶Á≥ªÁªüÁ≤æÁ°ÆÔºö** Prometheus ÁöÑË≠¶Êä•ÊòØ‰æùÊçÆ PromQL ÂÆö‰πâÔºåalertManager Â§ÑÁêÜÊù•Â§ÑÁêÜÊòØÂê¶ÂëäË≠¶„ÄÇ
7. **Â§öÂÆ¢Êà∑Á´ØÊîØÊåÅÔºö** Prometheus ÊîØÊåÅÂçÅÂ§öÁßçËØ≠Ë®ÄÂÆ¢Êà∑Á´ØÂ∫ìÔºåÂÖÅËÆ∏ËΩªÈáèÂåñÊ£ÄÊµãÊúçÂä°ÔºåËá™ÂÆö‰πâÂ∫ìÊòì‰∫éÂÆûÁé∞„ÄÇ
8. **‰∏âÊñπÈõÜÊàê‰ºóÂ§öÔºö** Prometheus ÂèØ‰ª•ËΩªÊùæËøûÊé•Á¨¨‰∏âÊñπ exporter Êï∞ÊçÆ„ÄÇÂ¶ÇÔºöÁ≥ªÁªü‰ø°ÊÅØ„ÄÅDocker„ÄÅHAProxy„ÄÅJMX Á≠âÊåáÊ†á„ÄÇTiDB ÁõëÊéßÁ≥ªÁªü‰∏≠Â∞±ÂºïÁî®‰∫Ü Node_exporter„ÄÅBlackbox_exporter Á≠â‰∏âÊñπÂºÄÊ∫ê exporter ÁõëÊéßÊìç‰ΩúÁ≥ªÁªü„ÄÅÁΩëÁªúËøêË°åÊÉÖÂÜµ„ÄÇ  

## ‰∫å„ÄÅprometheus ÈÄªËæëÁªìÊûÑ  

```yaml
Time Series Data  

Data Schema : idnetifier -> (t0, v0),(t1, v1),(t3, v3)...
Prometheus Data Model : <metric name{<label name>=<label value>, ...}
Typical set of identifiers :  
```

| Merics Name | Labels | Timestamp | Sample Value |
| - | - | - | - |
| {**name**}="" |  | @143417561287 | 94934 |
| {**name**}="" |  | @143417561287 | 94934 |
| {**name**}="" |  | @143417561287 | 94934 |

![Prometheus01](./Class-01-prometheus‰∏égrafana/Prometheus01.png)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Prometheus Metric ÈÖçÂêà Label ‰ºöÂàÜÊãÜÊàêÊúâÈôê‰∏™ÊåáÊ†áÔºåÂèçÊò†Êàê‰∫åÁª¥Âπ≥Èù¢‰∏äÁöÑÁÇπÔºåÂú®ËøêÁÆóÊó∂ÈÄöËøáÂèñ `‰∫§ÈõÜ` Êàñ `Âπ∂ÈõÜ` ÂÆûÁé∞ Metric ÁöÑËÅöÂêà„ÄÇÊØè‰∏™ÊåáÊ†áÁÇπÈöèÊó∂Èó¥ÁöÑÂ¢ûÂä†ÊåáÊ†áÂÄºÁöÑÂèòÂåñÊÉÖÂÜµ‰ºö‰øùÂ≠òÂú®‰∏Ä‰∏™Êñá‰ª∂‰∏≠ÔºåÂÆûÁé∞‰∫ÜÂπ∂Ë°åËØª„ÄÅÂÜôÊûÅÂ§ßÔºåÊèêÈ´ò‰∫ÜÊÄßËÉΩ„ÄÇ

## ‰∏â„ÄÅprometheus Êó∂Èó¥ËøáÊª§

Áû¨Êó∂ÂêëÈáèËøáÊª§Âô® : ÊåáÂÆöÊó∂Èó¥Êà≥ÂÜÖ,ÈÄâÊã©‰∏ÄÁªÑÊ†áÁ≠æÁöÑÊó∂Èó¥Â∫èÂàóÂíåÂØπÂ∫îÁöÑÂçï‰∏™Ê†∑Êú¨ÂÄºÔºõ

Â¶ÇÔºö`tidb_server_handle_query_duration_seconds_bucket{tidb_cluster="$tidb_cluster",type="select"}` ÔºåË°®Á§∫ TiDB ‰∏≠ tidb_server_handle_query_duration_seconds ÊåáÊ†áÂú® `tidb_cluster` Âíå `type` ÁöÑÊ†áÁ≠æÁªÑÂêà‰∏ãÔºå Ëé∑ÂèñÂΩìÂâçÊó∂Èó¥ÁöÑÁû¨Êó∂Ê†∑Êú¨ÂÄº„ÄÇ

Âå∫Èó¥ÂêëÈáèËøáÊª§Âô® : ÈÄöËøá `[]` ÂÆö‰πâÊåáÊ†áÊó∂Èó¥ËåÉÂõ¥ÔºåËé∑Âèñ `Áû¨Êó∂ÂêëÈáèËøáÊª§Âô®` ÊâÄÊúâÊó∂Èó¥ËåÉÂõ¥ÂÜÖËØ•ÊåáÊ†áÁöÑÂçï‰∏™Ê†∑Êú¨ÂÄºÔºõ
Â¶ÇÔºö`tidb_server_handle_query_duration_seconds_bucket{tidb_cluster="$tidb_cluster",type="select"}` ÔºåË°®Á§∫ TIDB ‰∏≠ tidb_server_handle_query_duration_seconds_bucket ÊåáÊ†áÂú®Êó∂Èó¥ËåÉÂõ¥ÂÜÖÁöÑÊâÄÊúâÂÄº„ÄÇ

Êó∂Èó¥‰ΩçÁßªÊìç‰Ωú   : ÈÄöËøá `offset` ÊåáÂÆöËá™ÂΩìÂâçÊó∂ÂàªËµ∑ÂêëÂêéÂÅèÁßªÁöÑÊó∂ÈïøÔºõ
Â¶ÇÔºö`tidb_server_handle_query_duration_seconds_bucket offset 5m` ÔºåË°®Á§∫ TIDB ‰∏≠ tidb_server_handle_query_duration_seconds_bucket ÊåáÊ†á 5 min ‰πãÂâçÈÇ£‰∏™Êó∂ÂàªÁöÑÁû¨Êó∂ÂÄº„ÄÇ

## Âõõ„ÄÅprometheus ËÅöÂêàÊìç‰Ωú

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‰ª•Áî± Label ‰∏∫ instance„ÄÅjob„ÄÅle„ÄÅsql_type ÁªÑÂêàÊûÑÊàêÁöÑ tidb_server_handle_query_duration_seconds_bucket Metric ‰∏∫‰æãÔºõ

```json
{ 
    name = "tidb_server_handle_query_duration_seconds_bucket", # Metric Name : __name__
    instance = "172.16.6.155:10080",                           # Label : instance
    job = "tidb",                                              # Label : job
    le = "+Inf",                                               # Label : le
    sql_type = "Select"                                        # Label : sql_type
}
```

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÂÅáËÆæÂèñ tidb_server_handle_query_duration_seconds_bucket { instance = "172.16.6.155:10080" , sql_type = "Select" , le = "+Inf" } [2m] ÁöÑÁû¨Êó∂ÂÄº„ÄÇÁ¨¨‰∏ÄÊ≠•Ôºå‰ªé prometheus Â≠òÂÇ®‰∏≠Êà™ÂèñÂØπÂ∫îÊó∂ÊÆµÁöÑÊï∞ÊçÆÂêéÂØπÊï∞ÊçÆÁªìÊûúÂÄíÊéíÈáçÊûÑ„ÄÇÁ¨¨‰∫åÊ≠•ÔºåÂèñÂêÑÊñá‰ª∂ÁªìÊûú‰∫§ÈõÜÂæóÂá∫ Metric Âú® 2min ÂÜÖÁöÑÊâÄÊúâÂÄº„ÄÇ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**Ê≥®ÊÑèÔºö** Á¨¨‰∏ÄÊ≠•ÂÄíÊéíÁöÑÁõÆÁöÑÊòØ‰∏∫‰∫ÜÂÆûÁé∞ÔºåÂú®ÊúâÂ∫èÊï∞ÁªÑ‰∏ãÁöÑÂø´ÈÄüÂΩíÂπ∂Êü•ÊâæÔºåÊòØÂü∫‰∫éÊÄßËÉΩÂ±ÇÈù¢ËÄÉËôëÁöÑÊìç‰Ωú„ÄÇ

![Prometheus02](./Class-01-prometheus‰∏égrafana/prometheus02.png)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Âú® Prometheus Dashboard ‰∏≠Ê±áËÅöÁªìÊûúÔºåÂ¶Ç‰∏ãÂõæÊâÄÁ§∫„ÄÇ

![Prometheus03](./Class-01-prometheus‰∏égrafana/prometheus03.jpg)

## ‰∫î„ÄÅprometheus ÊåáÊ†áÁ±ªÂûã

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‰æùÊçÆ [promehteus ÂÆòÁΩë‰ªãÁªç](https://prometheus.fuckcloudnative.io/di-er-zhang-gai-nian/metric_types) ÊåáÊ†áÁ±ªÂûã‰ªÖÂ≠òÂú®‰∫é client Á´ØÔºåÂú® server Á´Ø‰∏çÂå∫ÂàÜÊåáÊ†áÁ±ªÂûãÔºåÂùáËßÜ‰∏∫Êó†Â∫èÊó∂Â∫èÊï∞ÊçÆ„ÄÇÈÇ£‰πà‰∏∫‰ªÄ‰πàË¶ÅÂå∫ÂàÜ‰∏çÂêåÊåáÊ†áÁ±ªÂûãÂë¢Ôºü    --> "ÂæÖËß£Èáä"
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TiDB ‰∏≠Â∞ÅË£Ö Prometheus ÂêéÔºåÊï∞ÊçÆÊµÅËΩ¨Â¶Ç‰∏ãÂõæÊâÄÁ§∫Ôºõ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;![Prometheus04](./Class-01-prometheus‰∏égrafana/prometheus04.png)

### 5.1 Counter

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Counter Á±ªÂûãË°®Á§∫Ê†∑Êú¨Êï∞ÊçÆÂçïË∞ÉÈÄíÂ¢ûÔºåÂç≥Âè™Â¢û‰∏çÂáèÔºåÈô§ÈùûÁõëÊéßÁ≥ªÁªüÂèëÁîü‰∫ÜÈáçÁΩÆ„ÄÇ‰æãÂ¶ÇÔºösql statement operation per second„ÄÇ

### 5.2 Gauge

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gauge Á±ªÂûãË°®Á§∫Ê†∑Êú¨Êï∞ÊçÆÂèØ‰ª•‰ªªÊÑèÂèòÂåñÁöÑÊåáÊ†áÔºåÂç≥ÂèØÂ¢ûÂèØÂáè„ÄÇ‰æãÂ¶ÇÔºötikv region ÁöÑÊï∞ÈáèÔºõ

### 5.3 Histogram

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Histogram Á±ªÂûãÂú®‰∏ÄÊÆµÊó∂Èó¥ËåÉÂõ¥ÂÜÖÂØπÊï∞ÊçÆËøõË°åÈááÊ†∑ÔºåÂ∞ÜÂÖ∂ËÆ∞ÂÖ•Ëá™ÂÆö‰πâÈÖçÁΩÆÁöÑ bucket ‰∏≠ÔºåÂêéÁª≠ÂèØÈÄöËøáÂà∂ÂÆöÂå∫Èó¥ÂØπÁ≠õÈÄâÊï∞ÊçÆ„ÄÅÁªüËÆ°Ê†∑Êú¨Êï∞ÈáèÔºåÊúÄÂêéÂëàÁé∞Âá∫Áõ¥ÊñπÂõæÁöÑË°®Áé∞ÂΩ¢Âºè„ÄÇ

### 5.4 Summary

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Summary ‰∏é Histogram ÁöÑÂäüËÉΩÁ±ª‰ººÔºåË°®Á§∫‰∏ÄÊÆµÊó∂Èó¥ÂÜÖÁöÑÊï∞ÊçÆÊ†∑Êú¨ÁªìÊûúÔºåÂå∫Âà´‰ΩìÁé∞Âú®ËÆ°ÁÆóÂàÜ‰ΩçÊï∞Êó∂ summary Áõ¥Êé•Âü∫‰∫é client Á´ØÂ≠òÂÇ®ÁöÑÊ†∑Êú¨Êï∞ÊçÆËÆ°ÁÆóÂá∫ÁôæÂàÜ‰ΩçÁªìÊûúÂÄºÔºåÂæÖ prometheus ÂÆöÊúü pull Êï∞ÊçÆÊó∂**Â≠òÂÇ®ÁôæÂàÜ‰ΩçÁªìÊûúÂÄº**„ÄÇËÄå Histogram ÂàôÊòØÂ∞Ü**Â≠òÂÇ®ÁöÑÊ†∑Êú¨Êï∞ÊçÆ**Â≠òÂÇ®Âà∞ prometheus ‰∏≠„ÄÇ

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**Ê≥®ÊÑè**ÔºöÊ†πÊçÆ Breezewish Âú® [TiKV Ê∫êÁ†ÅËß£ÊûêÁ≥ªÂàóÊñáÁ´†Ôºà‰∏âÔºâPrometheusÔºà‰∏äÔºâ](https://pingcap.com/zh/blog/tikv-source-code-reading-3) ‰∏≠‰ªãÁªçÁöÑ **‚Äúrust-prometheus Â∫ìÁõÆÂâçËøòÂè™ÂÆûÁé∞‰∫ÜÂâç‰∏âÁßç„ÄÇTiKV Â§ßÈÉ®ÂàÜÊåáÊ†áÈÉΩÊòØ Counter Âíå HistogramÔºåÂ∞ëÈÉ®ÂàÜÊòØ Gauge‚Äù** ÔºåÂèØ‰ª•ÂèëÁé∞ rust prometheus client Âπ∂Ê≤°ÊúâÂÆûÁé∞ summary Á±ªÂûãÔºåÂπ∂‰∏îÂú® tikv ‰∏≠‰∏ªË¶ÅÊòØÁî®ÂÖ∂‰ªñ‰∏âÁßçÁ±ªÂûã„ÄÇSummary Á±ªÂûãÂú® [rust prometheus client doc](https://docs.rs/prometheus/latest/prometheus/proto/enum.MetricType.html?search=summary#variant.SUMMARY) Âè™ÊúâÂØπÂ∫îÁöÑ protocol type ÂÆö‰πâÔºåËÄåÊ≤°ÊúâÂØπÂ∫îÁöÑ struct ÂÆûÁé∞„ÄÇ

## ÂÖ≠„ÄÅprometheus ËÅöÂêàÂáΩÊï∞

### 6.1 Rate

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‰ªé‰ª£Á†ÅÁúã [Rate](https://github.com/prometheus/prometheus/blob/9fcf0b3d46cc3cdff96e6e7baabfaf63d89a5a9d/promql/functions.go#L134-L146) ÂáΩÊï∞ÂÜÖÈÉ®Ë∞ÉÁî® [extrapolatedRate](https://github.com/prometheus/prometheus/blob/9fcf0b3d46cc3cdff96e6e7baabfaf63d89a5a9d/promql/functions.go#L59) ËÆ°ÁÆóÔºåÁªèËøáÁÆÄÂåñÂêé‰ª£Á†ÅÂ¶Ç‰∏ãÔºõ

```go
func extrapolatedRate(vals []parser.Value, args parser.Expressions, enh *EvalNodeHelper, isCounter, isRate bool) Vector {
 ms := args[0].(*parser.MatrixSelector)
 vs := ms.VectorSelector.(*parser.VectorSelector)
 var (
  samples    = vals[0].(Matrix)[0]                                        // Ê†∑Êú¨ÁõëÊéßÊï∞ÊçÆ
  rangeStart = enh.Ts - durationMilliseconds(ms.Range+vs.Offset)          // Ê†∑Êú¨ÂºÄÂßãÊó∂Èó¥
  rangeEnd   = enh.Ts - durationMilliseconds(vs.Offset)                   // Ê†∑Êú¨ÁªàÊ≠¢Êó∂Èó¥
 )
    resultValue := samples.Points[len(samples.Points)-1].V - samples.Points[0].V// ÁªàÊ≠¢Êó∂Èó¥Ê†∑Êú¨Êï∞ÊçÆÂáèÂºÄÂßãÊó∂Èó¥Ê†∑Êú¨Êï∞ÊçÆ
 if isCounter {
  var lastValue float64                                                   // Counter Á±ªÂûã‰ºöÂæ™ÁéØÊó∂Èó¥Âå∫Èó¥ÂÜÖÊï∞ÊçÆ
  for _, sample := range samples.Points {                                 // ÔºåÂ¶ÇÊûú‰∏ã‰∏Ä‰∏™ÂÄºÊØî‰∏ä‰∏Ä‰∏™ÂÄºÂ§ßÔºåËØ¥ÊòéÂèë
   if sample.V < lastValue {                                           // Áîü‰∫ÜËÆ°Êï∞Âô®ÈáçÁΩÆÔºåÂ¶Ç: ËøõÁ®ã crash Êï∞
    resultValue += lastValue                                        // ÊçÆ‰∏¢Â§±Ôºå‰ºöË°•‰∏ä crash ÂêéÈù¢ÁöÑÂ¢ûÈáè„ÄÇ
   }
   lastValue = sample.V
  }
 }
    // Ê†∑Êú¨ÂºÄÂßãÊó∂Èó¥ÁÇπÊåÅÁª≠ÁöÑÊó∂Èó¥Âà∞ÔºåÂΩìÂâçÊó∂Èó¥ÂâçÊé®ÂêéÁöÑÊó∂Èó¥Ë∑ùÁ¶ªÔºåÂ¶Ç: ÊåáÊ†á X[1m] ‰∏∫ X ÂâçÊé® 1minÔºåÂΩìÂâçÊó∂Èó¥ 02:03:02 ÔºåÈÇ£‰πàÂâçÊé®ÁªìÊûú‰∏∫
    // 02:02:02Ôºå‰πüÂ∞±ÊòØÂèñ 02:02:02 --> 02:03:02 Âå∫Èó¥ÂÜÖÁöÑÊâÄÊúâÊï∞ÊçÆ„ÄÇÂÅáËÆæÊåáÊ†áÊØè 15s Èáá‰∏ÄÊ¨°ÔºåÂç≥: ÈááÈõÜÊó∂Èó¥ÁÇπ‰∏∫ [02:02:16„ÄÅ02:0
    // 2:31„ÄÅ02:02:46„ÄÅ02:03:01];
    // ÈÇ£‰πà durationToStart ‰∏∫ 02:02:16 - 02:02:02 = 00:00:14;
    // ÂêåÁêÜ durationToEnd   ‰∏∫ 02:03:02 - 02:03:01 = 00:00:01;    
    durationToStart := float64(samples.Points[0].T-rangeStart) / 1000           
 durationToEnd := float64(rangeEnd-samples.Points[len(samples.Points)-1].T) / 1000 // 
                                                     
    // sampledInterval Ë°®Á§∫Ê†∑Êú¨Êï∞ÊçÆÁöÑÁ¨¨‰∏Ä‰∏™ÁÇπÂíåÊúÄÂêé‰∏Ä‰∏™ÁÇπÈó¥ÁöÑÊó∂Èó¥Èó¥Èöî;
 sampledInterval := float64(samples.Points[len(samples.Points)-1].T-samples.Points[0].T) / 1000
    // averageDurationBetweenSamples Ë°®Á§∫Ê†∑Êú¨Êï∞ÊçÆÂú®Âå∫Èó¥ÂÜÖÊØè‰∏™ÁÇπÁöÑÊó∂Èó¥Èó¥ÈöîÔºåÈªòËÆ§ÊòØ 15s;
 averageDurationBetweenSamples := sampledInterval / float64(len(samples.Points)-1)

    if isCounter && resultValue > 0 && samples.Points[0].V >= 0 {
        // Âú® Counter ÊåáÊ†áÁ±ªÂûãÊó∂ÔºåÁî®ÊñúÁéáÂÖ¨Âºè ‚ÄúÈõ∂ÁÇπÊó∂Èó¥/Âå∫Èó¥Êó∂Èó¥ = ÂºÄÂßãÊó∂Èó¥Ê†∑Êú¨ÂÄº/ÁªìÊùüÊó∂Èó¥Âà∞ÂºÄÂßãÊó∂Èó¥Ê†∑Êú¨Â¢ûÈáè‚Äù ÁÆóÂá∫ Êé®Êñ≠ÁöÑÂ§ñÂª∂Êó∂Èó¥ÁÇπ
        durationToZero := sampledInterval * (samples.Points[0].V / resultValue)
        // Â¶ÇÊûú durationToZero ‰Ωé‰∫é durationToStartÔºåÈÄâÂèñËÆ°Êó∂Âô®ÈáçÁΩÆÁöÑÊó∂Èó¥ÁÇπÂà∞Á¨¨‰∏Ä‰∏™ÈááÊ†∑Êó∂Èó¥ÁÇπÁöÑÊó∂Èó¥Âå∫Èó¥‰Ωú‰∏∫ durationToStart
        if durationToZero < durationToStart {
            durationToStart = durationToZero
        }
 }

    extrapolationThreshold := averageDurationBetweenSamples * 1.1
 extrapolateToInterval := sampledInterval

    // Êé®Êñ≠ÂäüËÉΩ‰∏ªË¶ÅËß£ÂÜ≥ÔºåÊúÄÂêé‰∏Ä‰∏™ÈááÊ†∑ÁÇπÂèëÁîüÊó∂Èó¥Âà∞Êü•ËØ¢Êó∂Èó¥Â≠òÂú®‰∏ÄÂÆöË∑ùÁ¶ªÔºåÂç≥ÔºöÊü•ËØ¢ÁöÑÊòØ 02:03:02 ÁöÑÁªìÊûúÔºå‰ΩÜ prometheus ÊúÄÂêé‰∏ÄÊ¨°ÊãâÊï∞ÊçÆ‰∏∫ 02:03:01
    // Âõ†‰∏∫ËÆæÂÆö‰∫Ü‰∏Ä‰∏™ÈòàÂÄº extrapolationThresholdÔºåÂ¶ÇÊûúË∂ÖËøáËøõË°å‰∏ÄÂÆöËøΩÂä†ÔºåËææÂà∞Âª∂ÈïøÊó∂Èó¥ÈááÊ†∑ÁÇπËá≥Êü•ËØ¢ÁõÆÂú∞Êó∂Èó¥ÁöÑÁõÆÁöÑÔºõ
    // ÊúÄÂêéÔºåÈÄöËøáÂÖ¨Âºè ‚ÄúÊé®Êñ≠ÁªìÊûú/ÁúüÂÆûÁªìÊûú = Êé®Êñ≠Ê†∑Êú¨Êó∂Èó¥/ÁúüÂÆûÊ†∑Êú¨Êó∂Èó¥‚Äù Ëß£Âá∫ ‚ÄúÊü•ËØ¢Êó∂Èó¥ÔºåÂ¶Ç 02:03:02 ÁöÑÊé®Êñ≠ÁªìÊûú‚ÄùÔºõ
    // ‰ª£Á†Å‰∏∫ resultValue = resultValue * (extrapolateToInterval / sampledInterval)
 if durationToStart < extrapolationThreshold {                   
  extrapolateToInterval += durationToStart                    
 } else {
  extrapolateToInterval += averageDurationBetweenSamples / 2  
 }
 if durationToEnd < extrapolationThreshold {
  extrapolateToInterval += durationToEnd                      
 } else {
  extrapolateToInterval += averageDurationBetweenSamples / 2  
 }
 resultValue = resultValue * (extrapolateToInterval / sampledInterval) 
 if isRate {
  resultValue = resultValue / ms.Range.Seconds()             
 }

 return append(enh.Out, Sample{
  Point: Point{V: resultValue},
 })
```

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ÂáΩÊï∞ÊÑè‰πâÔºöËÆ°ÁÆóÂå∫Èó¥ÊåáÊ†áÊó∂Èó¥Á™óÂè£ÂÜÖÂπ≥ÂùáÂ¢ûÈïøÈÄüÁéá„ÄÇ

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‰ªé‰ª£Á†ÅÁúã [funcRate](https://github.com/prometheus/prometheus/blob/9fcf0b3d46cc3cdff96e6e7baabfaf63d89a5a9d/promql/functions.go#L139) Ë∞ÉÁî®ËøîÂõû `extrapolatedRate(vals, args, enh, true, true)`„ÄÇ‰æùÊçÆ‰∏äÊñáËß£ËØªÔºå‰ºöËøîÂõûÊ†∑Êú¨Âå∫Èó¥ÂÜÖ (ÊúÄÂ§ßÂÄº-ÊúÄÂ∞èÂÄº)/Êó∂Èó¥Âå∫Èó¥ÁöÑÁªìÊûúÔºåÂõ†‰∏∫ counter Êàñ histogram(ÂÜÖÈÉ®Â∞ÅË£Ö‰∫Ü counter) ÊòØÁ¥ØËÆ°ÂÄºÔºåÊÑèÂë≥ÁùÄÈöèÊó∂Èó¥Â¢ûÈïøÁõëÊéßÊåáÊ†áÂßãÁªàÂ¢ûÈïø„ÄÇÈÄöËøáËÆ°ÁÆóÈááÊ†∑Êó∂Èó¥ÁöÑÂ¢ûÈáè‰ª£Ë°®ÈááÊ†∑Êó∂Èó¥ÂÜÖÁöÑÊåáÊ†áÂÄºÔºåÂÜçÈô§‰ª•Êó∂Èó¥ÂæóÂá∫ ‚ÄúÊØèÁßíÊåáÊ†áÁöÑÂ¢ûÈïø‚ÄùÔºåÁªèËøáÊé®Êñ≠ËÆ°ÁÆóÂá∫Êü•ËØ¢Êó∂Èó¥ÁÇπÁöÑÂπ≥ÂùáÂ¢ûÈïøÁéá„ÄÇ

### 6.2 increase

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÂáΩÊï∞ÊÑè‰πâÔºöÊ†∑Êú¨ÈááÈõÜÂå∫Èó¥ÂÜÖÔºåÊåáÊ†áÊ†∑Êú¨ÁöÑÁ¨¨‰∏Ä‰∏™ÂÄºÂíåÊúÄÂêé‰∏Ä‰∏™ÂÄº‰πãÈó¥ÁöÑÂ¢ûÈïøÈáè„ÄÇ

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‰ªé‰ª£Á†ÅÁúã [funcIncrease](https://github.com/prometheus/prometheus/blob/9fcf0b3d46cc3cdff96e6e7baabfaf63d89a5a9d/promql/functions.go#L144) `extrapolatedRate(vals, args, enh, true, false)`„ÄÇ‰æùÊçÆ‰∏äÊñáËß£ËØªÔºå‰ºöËøîÂõûÊ†∑Êú¨Âå∫Èó¥ (ÊúÄÂ§ßÂÄº-ÊúÄÂ∞èÂÄº) ÁöÑÁªìÊûúÔºåÂêåÁêÜÂõ†‰∏∫ Counter ÊòØÁ¥ØËÆ°ÂÄºÔºå‰ª£Ë°®Ê†∑Êú¨Â¢ûÈáèÔºåÁªèËøáÊé®Êñ≠ËÆ°ÁÆóÂá∫Êü•ËØ¢Êó∂Èó¥ÁÇπÁöÑÊ†∑Êú¨Â¢ûÈáè„ÄÇ

### 6.3 delta

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÂáΩÊï∞ÊÑè‰πâÔºöËÆ°ÁÆóÊ†∑Êú¨Âå∫Èó¥ÂÜÖÔºåÊåáÊ†áÁöÑÁ¨¨‰∏Ä‰∏™ÂÖÉÁ¥†ÂíåÊúÄÂêé‰∏Ä‰∏™ÂÖÉÁ¥†ÁöÑÂ∑ÆÂÄº„ÄÇ

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‰ªé‰ª£Á†ÅÁúã [funcDelta](https://github.com/prometheus/prometheus/blob/9fcf0b3d46cc3cdff96e6e7baabfaf63d89a5a9d/promql/functions.go#L134) `extrapolatedRate(vals, args, enh, false, false)`„ÄÇÂÖ∂ÂÆûÊú¨Ë¥®‰∏äÂäüËÉΩ‰∏é increase ÂáΩÊï∞Á±ª‰ººÔºåÂè™ÊòØÂ∞ë‰∫ÜËÆ°Êï∞Âô®ÈáçÁΩÆÊñπÈù¢ÁöÑËÄÉÈáè„ÄÇ

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Áî±‰∫éËøô‰∏™ÂÄºË¢´Â§ñÊé®Âà∞ÊåáÂÆöÁöÑÊï¥‰∏™Êó∂Èó¥ËåÉÂõ¥ÔºåÊâÄ‰ª•Âç≥‰ΩøÊ†∑Êú¨ÂÄºÈÉΩÊòØÊï¥Êï∞Ôºå‰Ω†‰ªçÁÑ∂ÂèØËÉΩ‰ºöÂæóÂà∞‰∏Ä‰∏™ÈùûÊï¥Êï∞ÂÄº„ÄÇ

### 6.4 irate

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÂáΩÊï∞ÊÑè‰πâÔºöÊ†∑Êú¨ÈááÈõÜÂå∫Èó¥ÂÜÖÔºåÊåáÊ†áÊ†∑Êú¨ÁöÑÊúÄÂêé‰∏Ä‰∏™ÂÄºÂíåÂÄíÊï∞Á¨¨‰∫å‰∏™ÂÄº‰πãÈó¥ÁöÑÂ¢ûÈïøÈáè„ÄÇ

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‰ªé‰ª£Á†ÅÁúã [funcIrate](https://github.com/prometheus/prometheus/blob/87ffac3e9d2104cd368d2e8962723d9fc3ee126f/promql/functions.go#L149) `instantValue(vals, enh.Out, true)`„ÄÇÂáΩÊï∞ÂÜÖÈÉ®Ë∞ÉÁî® [instantValue](https://github.com/prometheus/prometheus/blob/87ffac3e9d2104cd368d2e8962723d9fc3ee126f/promql/functions.go#L158)  

### 6.5 histogram_quantile

ÂØπ‰∫é histogram ÔºåÂèñ `rate + []` Ë°®Á§∫Êó∂Èó¥Âå∫Èó¥ÂÜÖÊåáÊ†áÁöÑÂπ≥ÂùáÂ¢ûÈáèÔºå

## ‰∏É„ÄÅTiDB Duration ËÅöÂêàËß£ËØª

### 7.1 Ëé∑ÂèñÂÆö‰πâ

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Âú® Grafana ÂèØÂèëÁé∞ Duration 999 Á∫øÁöÑÂÆö‰πâÔºåÂ¶Ç‰∏ã‰ª£Á†ÅÂùó„ÄÇ  

```sql
histogram_quantile(0.999, sum(rate(tidb_server_handle_query_duration_seconds_bucket{k8s_cluster="$k8s_cluster", tidb_cluster="$tidb_cluster"}[1m])) by (le))
```

![Prometheus05](./Class-01-prometheus‰∏égrafana/prometheus05.jpg)  

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ëá≥‰∫é {k8s_cluster="$k8s_cluster", tidb_cluster="$tidb_cluster"} Ê†áÁ≠æËøáÊª§ÂèØ‰ª•ÊöÇÊó∂ÂøΩÁï•Ôºå‰ªñÊòØÈÄöËøá Grafana ÂèòÈáèÊú∫Âà∂ÂÆûÁé∞ÁöÑËøáÊª§ TiDB Cluster Áõ∏ÂÖ≥ÊåáÊ†áÁöÑÊú∫Âà∂„ÄÇËøôÈáå‰∏ªË¶ÅÂÖ≥Ê≥® Prometheus Â¶ÇÊûúÂÆûÁé∞Êï∞ÊçÆÁöÑËÅöÂêàÔºåÊöÇÊó∂ÂøΩÁï•Â§öÈõÜÁæ§Êï∞ÊçÆÁöÑÈóÆÈ¢ò„ÄÇÂØπËØ•ÈóÆÈ¢òÔºåËØ¶ÊÉÖÂèÇËÄÉ [grafana ÂèòÈáèÊú∫Âà∂](https://www.mianshigee.com/tutorial/prometheus-book/grafana-templating.md) Ê∑±ÂÖ•Á†îÁ©∂„ÄÇ

![Prometheus06](./Class-01-prometheus‰∏égrafana/prometheus06.jpg)  

### 7.2 Metric Âå∫Èó¥

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÁªèËøáÁÆÄÂåñÂ¶Ç‰∏ãÊâÄÁ§∫Ôºå‰∏ãÈù¢ÂºÄÂßã **‚ÄúÁúüÊ≠£‚Äù** ËøõÂÖ•ËÅöÂêàËøáÁ®ãÂàÜÊûê„ÄÇ

```sql
tidb_server_handle_query_duration_seconds_bucket[1m]  
```

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÈõÜÂêàËøáÁ®ã‰∏≠ÔºåÊúÄÂÜÖÂ±ÇÂÖàÂØπÊåáÊ†á tidb_server_handle_query_duration_seconds_bucket ÈÄöËøá **‚ÄúÂå∫Èó¥ÂêëÈáèËøáÊª§Âô®‚Äù** ËøáÊª§Âá∫ 1min ÂÜÖËØ•ÊåáÊ†áÁöÑÊâÄÊúâÊï∞ÊçÆ„ÄÇÁªèËøáÊó∂Èó¥Êà≥ËΩ¨ËØëÁªìÊûú,Â¶Ç‰∏ã‰ª£Á†ÅÂùóÊâÄÁ§∫„ÄÇ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‰ªéÁúüÂÆû‰∏ñÁïåÊó∂Èó¥ÁúãÔºåÊØèË°åÊï∞ÊçÆ‰∏é‰∏ä‰∏ÄË°åÁõ∏ÊØîÂàöÂ•ΩÂ¢ûÂä† 15sÔºåÂõ†‰∏∫Âú® TiDB ‰∏≠ÈªòËÆ§ÈÖçÁΩÆÊØèÈöî 15s prometheus ‰ªé TiDB„ÄÅTiKV„ÄÅPD ‰∏≠ÊãâÂèñÁºìÂ≠òÁöÑÊï∞ÊçÆ„ÄÇ 4 * 15 = 60s ÂàöÂ•Ω‰ª£Ë°® 1min ÂÜÖÊâÄÊúâÁöÑÊï∞ÊçÆ„ÄÇ

```yaml
            131 @ 1650531198.144           131 @ 2022-04-21 16:53:18   
            131 @ 1650531213.144   ]]></description>
            <content:encoded><![CDATA[<h1 id="tidb‰πãprometheus" tabindex="-1">TiDB‰πãPrometheus <a class="header-anchor" href="#tidb‰πãprometheus" aria-label="Permalink to &quot;TiDB‰πãPrometheus&quot;"></a></h1>
<p>Â¶ÇÊûúÊÇ®ÈúÄË¶Å100%ÁöÑÂáÜÁ°ÆÊÄßÔºå‰æãÂ¶ÇÊåâËØ∑Ê±ÇËÆ°Ë¥πÔºåÊôÆÁΩóÁ±≥‰øÆÊñØ‰∏çÊòØ‰∏Ä‰∏™Â•ΩÈÄâÊã©ÔºåÂõ†‰∏∫Êî∂ÈõÜÁöÑÊï∞ÊçÆÂèØËÉΩ‰∏çÂ§üËØ¶ÁªÜÂíåÂÆåÊï¥„ÄÇÂú®ËøôÁßçÊÉÖÂÜµ‰∏ãÔºåÊÇ®ÊúÄÂ•Ω‰ΩøÁî®ÂÖ∂‰ªñÁ≥ªÁªüÊù•Êî∂ÈõÜÂíåÂàÜÊûêËÆ°Ë¥πÊï∞ÊçÆÔºåÂπ∂‰ΩøÁî®ÊôÆÁΩóÁ±≥‰øÆÊñØËøõË°åÂÖ∂‰ΩôÁöÑÁõëÊéß„ÄÇ</p>
<h2 id="‰∏Ä„ÄÅprometheus-ÁâπÊÄßÂÆö‰πâ" tabindex="-1">‰∏Ä„ÄÅprometheus ÁâπÊÄßÂÆö‰πâ <a class="header-anchor" href="#‰∏Ä„ÄÅprometheus-ÁâπÊÄßÂÆö‰πâ" aria-label="Permalink to &quot;‰∏Ä„ÄÅprometheus ÁâπÊÄßÂÆö‰πâ&quot;"></a></h2>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‰æùÊçÆ <a href="https://prometheus.io/docs/introduction/overview/#what-is-prometheus" target="_blank" rel="noreferrer">Prometheus ÂÆòÁΩëÁöÑÂÆö‰πâ</a>,Prometheus ÊòØ‰∏Ä‰∏™ÂºÄÊ∫êÁöÑ„ÄÅÁ≥ªÁªüÁõëÊéßÂèäË≠¶Êä•ÁöÑÂ∑•ÂÖ∑ÂåÖ„ÄÇÂÖ∑ÊúâÂ¶Ç‰∏ãÁâπÁÇπÔºö</p>
<ol>
<li><strong>Â§öÁª¥Êó∂Â∫èÊï∞ÊçÆÔºö</strong> Prometheus ‰ª•Êó∂Èó¥Â∫èÂàó‰∏∫Âü∫Á°ÄÔºåÈÄöËøáËøΩÂä†ÈîÆÂÄºÂØπÊ†áËØÜÁöÑÊñπÂºèÔºåÂÆûÁé∞‰∫ÜÂ§öÁª¥Â∫¶ÁöÑÊï∞ÊçÆÊ®°Âûã„ÄÇ</li>
<li><strong>Êü•ËØ¢ËØ≠Âè•ÊîØÊåÅÔºö</strong> Prometheus ÊîØÊåÅ PromQL ÂÖÅËÆ∏ÂØπÊó∂Èó¥Â∫èÂàóÊï∞ÊçÆÂàáÁâáËÆ°ÁÆóÔºå‰ª•‰æøÁîüÊàêÂõæË°®„ÄÅË°®Ê†º„ÄÅË≠¶Êä•„ÄÇPromQL ‰∏é SQL Á±ª‰ººÔºåÂêåÂ±ûÂ£∞ÊòéÂºèÊü•ËØ¢ËØ≠Ë®ÄÔºåPrometheus Êèê‰æõ‰∫ÜÂ§öÁßçÂáΩÊï∞ÂÆåÊàêÔºåÊó∂Â∫èÊï∞ÊçÆÁöÑËÅöÂêàÔºåÂ¶ÇÔºörate„ÄÅirate„ÄÅdelta Á≠âÁ≠â„ÄÇ</li>
<li><strong>ÂèØËßÜÊïàÊûúÁæéËßÇÔºö</strong> Prometheus ÊîØÊåÅÂ§öÁßçÁöÑÂèØËßÜÂåñÊ®°ÂºèÔºåÂ¶ÇÔºöÂÜÖÁΩÆÁöÑ Dashboard ÊµèËßàÂô®ÊàñÈõÜÊàê Grafana Á≠â„ÄÇ</li>
<li><strong>Â≠òÂÇ®ÊñπÂºèÈ´òÊïàÔºö</strong> Prometheus ‰ª•Ëá™ÂÆö‰πâÊ†ºÂºèÂ∞ÜÊó∂Èó¥Â∫èÂàóÂ≠òÂÇ®Âú®ÂÜÖÂ≠òÂèäÊú¨Âú∞Á£ÅÁõòÔºåÁº©ÊîæÈÄöËøáÂàÜÁâáÂíåËÅîÂêàÂÆûÁé∞„ÄÇËá™ v2 ‰ª•ÂêéÔºåPrometheus ÂÆûÁé∞‰∫ÜÁ±ª‰ºº‰∫é LSM Êï∞ÊçÆÂ∫ìÁöÑ Block„ÄÅWAL„ÄÅCompaction Á≠âÁªìÊûÑÔºåÊûÅÂ§ßÈÅøÂÖçÈöèÊú∫ËØª„ÄÅÈöèÊú∫ÂÜôÔºåÂä†Âø´ËØªÂÜôÈÄüÁéá„ÄÇ</li>
<li><strong>ÈÉ®ÁΩ≤Êìç‰ΩúÁÆÄÂçïÔºö</strong> Prometheus Áî® Go ÁºñÂÜôÔºåÊØèÂè∞ÊúçÂä°Âô®‰ªÖ‰æùËµñÊú¨Âú∞Â≠òÂÇ®ÔºåÁã¨Á´ã‰∫éÂèØÈù†‰∏îÊòì‰∫éÈÉ®ÁΩ≤„ÄÇ</li>
<li><strong>ÂëäË≠¶Á≥ªÁªüÁ≤æÁ°ÆÔºö</strong> Prometheus ÁöÑË≠¶Êä•ÊòØ‰æùÊçÆ PromQL ÂÆö‰πâÔºåalertManager Â§ÑÁêÜÊù•Â§ÑÁêÜÊòØÂê¶ÂëäË≠¶„ÄÇ</li>
<li><strong>Â§öÂÆ¢Êà∑Á´ØÊîØÊåÅÔºö</strong> Prometheus ÊîØÊåÅÂçÅÂ§öÁßçËØ≠Ë®ÄÂÆ¢Êà∑Á´ØÂ∫ìÔºåÂÖÅËÆ∏ËΩªÈáèÂåñÊ£ÄÊµãÊúçÂä°ÔºåËá™ÂÆö‰πâÂ∫ìÊòì‰∫éÂÆûÁé∞„ÄÇ</li>
<li><strong>‰∏âÊñπÈõÜÊàê‰ºóÂ§öÔºö</strong> Prometheus ÂèØ‰ª•ËΩªÊùæËøûÊé•Á¨¨‰∏âÊñπ exporter Êï∞ÊçÆ„ÄÇÂ¶ÇÔºöÁ≥ªÁªü‰ø°ÊÅØ„ÄÅDocker„ÄÅHAProxy„ÄÅJMX Á≠âÊåáÊ†á„ÄÇTiDB ÁõëÊéßÁ≥ªÁªü‰∏≠Â∞±ÂºïÁî®‰∫Ü Node_exporter„ÄÅBlackbox_exporter Á≠â‰∏âÊñπÂºÄÊ∫ê exporter ÁõëÊéßÊìç‰ΩúÁ≥ªÁªü„ÄÅÁΩëÁªúËøêË°åÊÉÖÂÜµ„ÄÇ</li>
</ol>
<h2 id="‰∫å„ÄÅprometheus-ÈÄªËæëÁªìÊûÑ" tabindex="-1">‰∫å„ÄÅprometheus ÈÄªËæëÁªìÊûÑ <a class="header-anchor" href="#‰∫å„ÄÅprometheus-ÈÄªËæëÁªìÊûÑ" aria-label="Permalink to &quot;‰∫å„ÄÅprometheus ÈÄªËæëÁªìÊûÑ&quot;"></a></h2>
<div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">Time Series Data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">Data Schema</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> : </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">idnetifier -> (t0, v0),(t1, v1),(t3, v3)...</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">Prometheus Data Model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> : </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">&#x3C;metric name{&#x3C;label name>=&#x3C;label value>, ...}</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">Typical set of identifiers</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> :</span></span></code></pre>
</div><table tabindex="0">
<thead>
<tr>
<th>Merics Name</th>
<th>Labels</th>
<th>Timestamp</th>
<th>Sample Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>{<strong>name</strong>}=&quot;&quot;</td>
<td></td>
<td>@143417561287</td>
<td>94934</td>
</tr>
<tr>
<td>{<strong>name</strong>}=&quot;&quot;</td>
<td></td>
<td>@143417561287</td>
<td>94934</td>
</tr>
<tr>
<td>{<strong>name</strong>}=&quot;&quot;</td>
<td></td>
<td>@143417561287</td>
<td>94934</td>
</tr>
</tbody>
</table>
<figure><img src="./Class-01-prometheus‰∏égrafana/Prometheus01.png" alt="Prometheus01" tabindex="0"><figcaption>Prometheus01</figcaption></figure>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Prometheus Metric ÈÖçÂêà Label ‰ºöÂàÜÊãÜÊàêÊúâÈôê‰∏™ÊåáÊ†áÔºåÂèçÊò†Êàê‰∫åÁª¥Âπ≥Èù¢‰∏äÁöÑÁÇπÔºåÂú®ËøêÁÆóÊó∂ÈÄöËøáÂèñ <code>‰∫§ÈõÜ</code> Êàñ <code>Âπ∂ÈõÜ</code> ÂÆûÁé∞ Metric ÁöÑËÅöÂêà„ÄÇÊØè‰∏™ÊåáÊ†áÁÇπÈöèÊó∂Èó¥ÁöÑÂ¢ûÂä†ÊåáÊ†áÂÄºÁöÑÂèòÂåñÊÉÖÂÜµ‰ºö‰øùÂ≠òÂú®‰∏Ä‰∏™Êñá‰ª∂‰∏≠ÔºåÂÆûÁé∞‰∫ÜÂπ∂Ë°åËØª„ÄÅÂÜôÊûÅÂ§ßÔºåÊèêÈ´ò‰∫ÜÊÄßËÉΩ„ÄÇ</p>
<h2 id="‰∏â„ÄÅprometheus-Êó∂Èó¥ËøáÊª§" tabindex="-1">‰∏â„ÄÅprometheus Êó∂Èó¥ËøáÊª§ <a class="header-anchor" href="#‰∏â„ÄÅprometheus-Êó∂Èó¥ËøáÊª§" aria-label="Permalink to &quot;‰∏â„ÄÅprometheus Êó∂Èó¥ËøáÊª§&quot;"></a></h2>
<p>Áû¨Êó∂ÂêëÈáèËøáÊª§Âô® : ÊåáÂÆöÊó∂Èó¥Êà≥ÂÜÖ,ÈÄâÊã©‰∏ÄÁªÑÊ†áÁ≠æÁöÑÊó∂Èó¥Â∫èÂàóÂíåÂØπÂ∫îÁöÑÂçï‰∏™Ê†∑Êú¨ÂÄºÔºõ</p>
<p>Â¶ÇÔºö<code>tidb_server_handle_query_duration_seconds_bucket{tidb_cluster=&quot;$tidb_cluster&quot;,type=&quot;select&quot;}</code> ÔºåË°®Á§∫ TiDB ‰∏≠ tidb_server_handle_query_duration_seconds ÊåáÊ†áÂú® <code>tidb_cluster</code> Âíå <code>type</code> ÁöÑÊ†áÁ≠æÁªÑÂêà‰∏ãÔºå Ëé∑ÂèñÂΩìÂâçÊó∂Èó¥ÁöÑÁû¨Êó∂Ê†∑Êú¨ÂÄº„ÄÇ</p>
<p>Âå∫Èó¥ÂêëÈáèËøáÊª§Âô® : ÈÄöËøá <code>[]</code> ÂÆö‰πâÊåáÊ†áÊó∂Èó¥ËåÉÂõ¥ÔºåËé∑Âèñ <code>Áû¨Êó∂ÂêëÈáèËøáÊª§Âô®</code> ÊâÄÊúâÊó∂Èó¥ËåÉÂõ¥ÂÜÖËØ•ÊåáÊ†áÁöÑÂçï‰∏™Ê†∑Êú¨ÂÄºÔºõ
Â¶ÇÔºö<code>tidb_server_handle_query_duration_seconds_bucket{tidb_cluster=&quot;$tidb_cluster&quot;,type=&quot;select&quot;}</code> ÔºåË°®Á§∫ TIDB ‰∏≠ tidb_server_handle_query_duration_seconds_bucket ÊåáÊ†áÂú®Êó∂Èó¥ËåÉÂõ¥ÂÜÖÁöÑÊâÄÊúâÂÄº„ÄÇ</p>
<p>Êó∂Èó¥‰ΩçÁßªÊìç‰Ωú   : ÈÄöËøá <code>offset</code> ÊåáÂÆöËá™ÂΩìÂâçÊó∂ÂàªËµ∑ÂêëÂêéÂÅèÁßªÁöÑÊó∂ÈïøÔºõ
Â¶ÇÔºö<code>tidb_server_handle_query_duration_seconds_bucket offset 5m</code> ÔºåË°®Á§∫ TIDB ‰∏≠ tidb_server_handle_query_duration_seconds_bucket ÊåáÊ†á 5 min ‰πãÂâçÈÇ£‰∏™Êó∂ÂàªÁöÑÁû¨Êó∂ÂÄº„ÄÇ</p>
<h2 id="Âõõ„ÄÅprometheus-ËÅöÂêàÊìç‰Ωú" tabindex="-1">Âõõ„ÄÅprometheus ËÅöÂêàÊìç‰Ωú <a class="header-anchor" href="#Âõõ„ÄÅprometheus-ËÅöÂêàÊìç‰Ωú" aria-label="Permalink to &quot;Âõõ„ÄÅprometheus ËÅöÂêàÊìç‰Ωú&quot;"></a></h2>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‰ª•Áî± Label ‰∏∫ instance„ÄÅjob„ÄÅle„ÄÅsql_type ÁªÑÂêàÊûÑÊàêÁöÑ tidb_server_handle_query_duration_seconds_bucket Metric ‰∏∫‰æãÔºõ</p>
<div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{ </span></span>
<span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">    name</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> "tidb_server_handle_query_duration_seconds_bucket"</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">,</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic"> #</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic"> Metric</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic"> Name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> : </span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">__name__</span></span>
<span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">    instance</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "172.16.6.155:10080"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,                           </span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">#</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic"> Label</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> : </span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">instance</span></span>
<span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">    job</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "tidb"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,                                              </span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">#</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic"> Label</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> : </span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">job</span></span>
<span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">    le</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "+Inf"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,                                               </span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">#</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic"> Label</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> : </span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">le</span></span>
<span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">    sql_type</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "Select"</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">                                        #</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic"> Label</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic"> :</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic"> sql_type</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
</div><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÂÅáËÆæÂèñ tidb_server_handle_query_duration_seconds_bucket { instance = &quot;172.16.6.155:10080&quot; , sql_type = &quot;Select&quot; , le = &quot;+Inf&quot; } [2m] ÁöÑÁû¨Êó∂ÂÄº„ÄÇÁ¨¨‰∏ÄÊ≠•Ôºå‰ªé prometheus Â≠òÂÇ®‰∏≠Êà™ÂèñÂØπÂ∫îÊó∂ÊÆµÁöÑÊï∞ÊçÆÂêéÂØπÊï∞ÊçÆÁªìÊûúÂÄíÊéíÈáçÊûÑ„ÄÇÁ¨¨‰∫åÊ≠•ÔºåÂèñÂêÑÊñá‰ª∂ÁªìÊûú‰∫§ÈõÜÂæóÂá∫ Metric Âú® 2min ÂÜÖÁöÑÊâÄÊúâÂÄº„ÄÇ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>Ê≥®ÊÑèÔºö</strong> Á¨¨‰∏ÄÊ≠•ÂÄíÊéíÁöÑÁõÆÁöÑÊòØ‰∏∫‰∫ÜÂÆûÁé∞ÔºåÂú®ÊúâÂ∫èÊï∞ÁªÑ‰∏ãÁöÑÂø´ÈÄüÂΩíÂπ∂Êü•ÊâæÔºåÊòØÂü∫‰∫éÊÄßËÉΩÂ±ÇÈù¢ËÄÉËôëÁöÑÊìç‰Ωú„ÄÇ</p>
<figure><img src="./Class-01-prometheus‰∏égrafana/prometheus02.png" alt="Prometheus02" tabindex="0"><figcaption>Prometheus02</figcaption></figure>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Âú® Prometheus Dashboard ‰∏≠Ê±áËÅöÁªìÊûúÔºåÂ¶Ç‰∏ãÂõæÊâÄÁ§∫„ÄÇ</p>
<figure><img src="./Class-01-prometheus‰∏égrafana/prometheus03.jpg" alt="Prometheus03" tabindex="0"><figcaption>Prometheus03</figcaption></figure>
<h2 id="‰∫î„ÄÅprometheus-ÊåáÊ†áÁ±ªÂûã" tabindex="-1">‰∫î„ÄÅprometheus ÊåáÊ†áÁ±ªÂûã <a class="header-anchor" href="#‰∫î„ÄÅprometheus-ÊåáÊ†áÁ±ªÂûã" aria-label="Permalink to &quot;‰∫î„ÄÅprometheus ÊåáÊ†áÁ±ªÂûã&quot;"></a></h2>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‰æùÊçÆ <a href="https://prometheus.fuckcloudnative.io/di-er-zhang-gai-nian/metric_types" target="_blank" rel="noreferrer">promehteus ÂÆòÁΩë‰ªãÁªç</a> ÊåáÊ†áÁ±ªÂûã‰ªÖÂ≠òÂú®‰∫é client Á´ØÔºåÂú® server Á´Ø‰∏çÂå∫ÂàÜÊåáÊ†áÁ±ªÂûãÔºåÂùáËßÜ‰∏∫Êó†Â∫èÊó∂Â∫èÊï∞ÊçÆ„ÄÇÈÇ£‰πà‰∏∫‰ªÄ‰πàË¶ÅÂå∫ÂàÜ‰∏çÂêåÊåáÊ†áÁ±ªÂûãÂë¢Ôºü    --&gt; &quot;ÂæÖËß£Èáä&quot;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TiDB ‰∏≠Â∞ÅË£Ö Prometheus ÂêéÔºåÊï∞ÊçÆÊµÅËΩ¨Â¶Ç‰∏ãÂõæÊâÄÁ§∫Ôºõ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="./Class-01-prometheus‰∏égrafana/prometheus04.png" alt="Prometheus04"></p>
<h3 id="_5-1-counter" tabindex="-1">5.1 Counter <a class="header-anchor" href="#_5-1-counter" aria-label="Permalink to &quot;5.1 Counter&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Counter Á±ªÂûãË°®Á§∫Ê†∑Êú¨Êï∞ÊçÆÂçïË∞ÉÈÄíÂ¢ûÔºåÂç≥Âè™Â¢û‰∏çÂáèÔºåÈô§ÈùûÁõëÊéßÁ≥ªÁªüÂèëÁîü‰∫ÜÈáçÁΩÆ„ÄÇ‰æãÂ¶ÇÔºösql statement operation per second„ÄÇ</p>
<h3 id="_5-2-gauge" tabindex="-1">5.2 Gauge <a class="header-anchor" href="#_5-2-gauge" aria-label="Permalink to &quot;5.2 Gauge&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gauge Á±ªÂûãË°®Á§∫Ê†∑Êú¨Êï∞ÊçÆÂèØ‰ª•‰ªªÊÑèÂèòÂåñÁöÑÊåáÊ†áÔºåÂç≥ÂèØÂ¢ûÂèØÂáè„ÄÇ‰æãÂ¶ÇÔºötikv region ÁöÑÊï∞ÈáèÔºõ</p>
<h3 id="_5-3-histogram" tabindex="-1">5.3 Histogram <a class="header-anchor" href="#_5-3-histogram" aria-label="Permalink to &quot;5.3 Histogram&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Histogram Á±ªÂûãÂú®‰∏ÄÊÆµÊó∂Èó¥ËåÉÂõ¥ÂÜÖÂØπÊï∞ÊçÆËøõË°åÈááÊ†∑ÔºåÂ∞ÜÂÖ∂ËÆ∞ÂÖ•Ëá™ÂÆö‰πâÈÖçÁΩÆÁöÑ bucket ‰∏≠ÔºåÂêéÁª≠ÂèØÈÄöËøáÂà∂ÂÆöÂå∫Èó¥ÂØπÁ≠õÈÄâÊï∞ÊçÆ„ÄÅÁªüËÆ°Ê†∑Êú¨Êï∞ÈáèÔºåÊúÄÂêéÂëàÁé∞Âá∫Áõ¥ÊñπÂõæÁöÑË°®Áé∞ÂΩ¢Âºè„ÄÇ</p>
<h3 id="_5-4-summary" tabindex="-1">5.4 Summary <a class="header-anchor" href="#_5-4-summary" aria-label="Permalink to &quot;5.4 Summary&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Summary ‰∏é Histogram ÁöÑÂäüËÉΩÁ±ª‰ººÔºåË°®Á§∫‰∏ÄÊÆµÊó∂Èó¥ÂÜÖÁöÑÊï∞ÊçÆÊ†∑Êú¨ÁªìÊûúÔºåÂå∫Âà´‰ΩìÁé∞Âú®ËÆ°ÁÆóÂàÜ‰ΩçÊï∞Êó∂ summary Áõ¥Êé•Âü∫‰∫é client Á´ØÂ≠òÂÇ®ÁöÑÊ†∑Êú¨Êï∞ÊçÆËÆ°ÁÆóÂá∫ÁôæÂàÜ‰ΩçÁªìÊûúÂÄºÔºåÂæÖ prometheus ÂÆöÊúü pull Êï∞ÊçÆÊó∂<strong>Â≠òÂÇ®ÁôæÂàÜ‰ΩçÁªìÊûúÂÄº</strong>„ÄÇËÄå Histogram ÂàôÊòØÂ∞Ü<strong>Â≠òÂÇ®ÁöÑÊ†∑Êú¨Êï∞ÊçÆ</strong>Â≠òÂÇ®Âà∞ prometheus ‰∏≠„ÄÇ</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>Ê≥®ÊÑè</strong>ÔºöÊ†πÊçÆ Breezewish Âú® <a href="https://pingcap.com/zh/blog/tikv-source-code-reading-3" target="_blank" rel="noreferrer">TiKV Ê∫êÁ†ÅËß£ÊûêÁ≥ªÂàóÊñáÁ´†Ôºà‰∏âÔºâPrometheusÔºà‰∏äÔºâ</a> ‰∏≠‰ªãÁªçÁöÑ <strong>‚Äúrust-prometheus Â∫ìÁõÆÂâçËøòÂè™ÂÆûÁé∞‰∫ÜÂâç‰∏âÁßç„ÄÇTiKV Â§ßÈÉ®ÂàÜÊåáÊ†áÈÉΩÊòØ Counter Âíå HistogramÔºåÂ∞ëÈÉ®ÂàÜÊòØ Gauge‚Äù</strong> ÔºåÂèØ‰ª•ÂèëÁé∞ rust prometheus client Âπ∂Ê≤°ÊúâÂÆûÁé∞ summary Á±ªÂûãÔºåÂπ∂‰∏îÂú® tikv ‰∏≠‰∏ªË¶ÅÊòØÁî®ÂÖ∂‰ªñ‰∏âÁßçÁ±ªÂûã„ÄÇSummary Á±ªÂûãÂú® <a href="https://docs.rs/prometheus/latest/prometheus/proto/enum.MetricType.html?search=summary#variant.SUMMARY" target="_blank" rel="noreferrer">rust prometheus client doc</a> Âè™ÊúâÂØπÂ∫îÁöÑ protocol type ÂÆö‰πâÔºåËÄåÊ≤°ÊúâÂØπÂ∫îÁöÑ struct ÂÆûÁé∞„ÄÇ</p>
<h2 id="ÂÖ≠„ÄÅprometheus-ËÅöÂêàÂáΩÊï∞" tabindex="-1">ÂÖ≠„ÄÅprometheus ËÅöÂêàÂáΩÊï∞ <a class="header-anchor" href="#ÂÖ≠„ÄÅprometheus-ËÅöÂêàÂáΩÊï∞" aria-label="Permalink to &quot;ÂÖ≠„ÄÅprometheus ËÅöÂêàÂáΩÊï∞&quot;"></a></h2>
<h3 id="_6-1-rate" tabindex="-1">6.1 Rate <a class="header-anchor" href="#_6-1-rate" aria-label="Permalink to &quot;6.1 Rate&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‰ªé‰ª£Á†ÅÁúã <a href="https://github.com/prometheus/prometheus/blob/9fcf0b3d46cc3cdff96e6e7baabfaf63d89a5a9d/promql/functions.go#L134-L146" target="_blank" rel="noreferrer">Rate</a> ÂáΩÊï∞ÂÜÖÈÉ®Ë∞ÉÁî® <a href="https://github.com/prometheus/prometheus/blob/9fcf0b3d46cc3cdff96e6e7baabfaf63d89a5a9d/promql/functions.go#L59" target="_blank" rel="noreferrer">extrapolatedRate</a> ËÆ°ÁÆóÔºåÁªèËøáÁÆÄÂåñÂêé‰ª£Á†ÅÂ¶Ç‰∏ãÔºõ</p>
<div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">func</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> extrapolatedRate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">vals</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> []</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">parser</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">args</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> parser</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Expressions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">enh</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> *</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">EvalNodeHelper</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">isCounter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">isRate</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> bool</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Vector</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ms </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> args[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">].(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">parser</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">MatrixSelector</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> vs </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ms.VectorSelector.(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">parser</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">VectorSelector</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  samples    </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> vals[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">].(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Matrix</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]                                        </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// Ê†∑Êú¨ÁõëÊéßÊï∞ÊçÆ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  rangeStart </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> enh.Ts </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> durationMilliseconds</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(ms.Range</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">vs.Offset)          </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// Ê†∑Êú¨ÂºÄÂßãÊó∂Èó¥</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  rangeEnd   </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> enh.Ts </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> durationMilliseconds</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(vs.Offset)                   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// Ê†∑Êú¨ÁªàÊ≠¢Êó∂Èó¥</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> )</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    resultValue </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> samples.Points[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(samples.Points)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">].V </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> samples.Points[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">].V</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// ÁªàÊ≠¢Êó∂Èó¥Ê†∑Êú¨Êï∞ÊçÆÂáèÂºÄÂßãÊó∂Èó¥Ê†∑Êú¨Êï∞ÊçÆ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> isCounter {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> lastValue </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">float64</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">                                                   // Counter Á±ªÂûã‰ºöÂæ™ÁéØÊó∂Èó¥Âå∫Èó¥ÂÜÖÊï∞ÊçÆ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> _, sample </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> range</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> samples.Points {                                 </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// ÔºåÂ¶ÇÊûú‰∏ã‰∏Ä‰∏™ÂÄºÊØî‰∏ä‰∏Ä‰∏™ÂÄºÂ§ßÔºåËØ¥ÊòéÂèë</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">   if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> sample.V </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">&#x3C;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> lastValue {                                           </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// Áîü‰∫ÜËÆ°Êï∞Âô®ÈáçÁΩÆÔºåÂ¶Ç: ËøõÁ®ã crash Êï∞</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    resultValue </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> lastValue                                        </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// ÊçÆ‰∏¢Â§±Ôºå‰ºöË°•‰∏ä crash ÂêéÈù¢ÁöÑÂ¢ûÈáè„ÄÇ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   lastValue </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> sample.V</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> }</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    // Ê†∑Êú¨ÂºÄÂßãÊó∂Èó¥ÁÇπÊåÅÁª≠ÁöÑÊó∂Èó¥Âà∞ÔºåÂΩìÂâçÊó∂Èó¥ÂâçÊé®ÂêéÁöÑÊó∂Èó¥Ë∑ùÁ¶ªÔºåÂ¶Ç: ÊåáÊ†á X[1m] ‰∏∫ X ÂâçÊé® 1minÔºåÂΩìÂâçÊó∂Èó¥ 02:03:02 ÔºåÈÇ£‰πàÂâçÊé®ÁªìÊûú‰∏∫</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    // 02:02:02Ôºå‰πüÂ∞±ÊòØÂèñ 02:02:02 --> 02:03:02 Âå∫Èó¥ÂÜÖÁöÑÊâÄÊúâÊï∞ÊçÆ„ÄÇÂÅáËÆæÊåáÊ†áÊØè 15s Èáá‰∏ÄÊ¨°ÔºåÂç≥: ÈááÈõÜÊó∂Èó¥ÁÇπ‰∏∫ [02:02:16„ÄÅ02:0</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    // 2:31„ÄÅ02:02:46„ÄÅ02:03:01];</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    // ÈÇ£‰πà durationToStart ‰∏∫ 02:02:16 - 02:02:02 = 00:00:14;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    // ÂêåÁêÜ durationToEnd   ‰∏∫ 02:03:02 - 02:03:01 = 00:00:01;    </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    durationToStart </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> float64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(samples.Points[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">].T</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">rangeStart) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">           </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> durationToEnd </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> float64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(rangeEnd</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">samples.Points[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(samples.Points)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">].T) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1000</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"> // </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                                     </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    // sampledInterval Ë°®Á§∫Ê†∑Êú¨Êï∞ÊçÆÁöÑÁ¨¨‰∏Ä‰∏™ÁÇπÂíåÊúÄÂêé‰∏Ä‰∏™ÁÇπÈó¥ÁöÑÊó∂Èó¥Èó¥Èöî;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> sampledInterval </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> float64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(samples.Points[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(samples.Points)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">].T</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">samples.Points[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">].T) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1000</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    // averageDurationBetweenSamples Ë°®Á§∫Ê†∑Êú¨Êï∞ÊçÆÂú®Âå∫Èó¥ÂÜÖÊØè‰∏™ÁÇπÁöÑÊó∂Èó¥Èó¥ÈöîÔºåÈªòËÆ§ÊòØ 15s;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> averageDurationBetweenSamples </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> sampledInterval </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> float64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(samples.Points)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> isCounter </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">&#x26;&#x26;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> resultValue </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> &#x26;&#x26;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> samples.Points[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">].V </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">        // Âú® Counter ÊåáÊ†áÁ±ªÂûãÊó∂ÔºåÁî®ÊñúÁéáÂÖ¨Âºè ‚ÄúÈõ∂ÁÇπÊó∂Èó¥/Âå∫Èó¥Êó∂Èó¥ = ÂºÄÂßãÊó∂Èó¥Ê†∑Êú¨ÂÄº/ÁªìÊùüÊó∂Èó¥Âà∞ÂºÄÂßãÊó∂Èó¥Ê†∑Êú¨Â¢ûÈáè‚Äù ÁÆóÂá∫ Êé®Êñ≠ÁöÑÂ§ñÂª∂Êó∂Èó¥ÁÇπ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        durationToZero </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> sampledInterval </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (samples.Points[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">].V </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> resultValue)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">        // Â¶ÇÊûú durationToZero ‰Ωé‰∫é durationToStartÔºåÈÄâÂèñËÆ°Êó∂Âô®ÈáçÁΩÆÁöÑÊó∂Èó¥ÁÇπÂà∞Á¨¨‰∏Ä‰∏™ÈááÊ†∑Êó∂Èó¥ÁÇπÁöÑÊó∂Èó¥Âå∫Èó¥‰Ωú‰∏∫ durationToStart</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> durationToZero </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">&#x3C;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> durationToStart {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">            durationToStart </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> durationToZero</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    extrapolationThreshold </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> averageDurationBetweenSamples </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1.1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> extrapolateToInterval </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> sampledInterval</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    // Êé®Êñ≠ÂäüËÉΩ‰∏ªË¶ÅËß£ÂÜ≥ÔºåÊúÄÂêé‰∏Ä‰∏™ÈááÊ†∑ÁÇπÂèëÁîüÊó∂Èó¥Âà∞Êü•ËØ¢Êó∂Èó¥Â≠òÂú®‰∏ÄÂÆöË∑ùÁ¶ªÔºåÂç≥ÔºöÊü•ËØ¢ÁöÑÊòØ 02:03:02 ÁöÑÁªìÊûúÔºå‰ΩÜ prometheus ÊúÄÂêé‰∏ÄÊ¨°ÊãâÊï∞ÊçÆ‰∏∫ 02:03:01</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    // Âõ†‰∏∫ËÆæÂÆö‰∫Ü‰∏Ä‰∏™ÈòàÂÄº extrapolationThresholdÔºåÂ¶ÇÊûúË∂ÖËøáËøõË°å‰∏ÄÂÆöËøΩÂä†ÔºåËææÂà∞Âª∂ÈïøÊó∂Èó¥ÈááÊ†∑ÁÇπËá≥Êü•ËØ¢ÁõÆÂú∞Êó∂Èó¥ÁöÑÁõÆÁöÑÔºõ</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    // ÊúÄÂêéÔºåÈÄöËøáÂÖ¨Âºè ‚ÄúÊé®Êñ≠ÁªìÊûú/ÁúüÂÆûÁªìÊûú = Êé®Êñ≠Ê†∑Êú¨Êó∂Èó¥/ÁúüÂÆûÊ†∑Êú¨Êó∂Èó¥‚Äù Ëß£Âá∫ ‚ÄúÊü•ËØ¢Êó∂Èó¥ÔºåÂ¶Ç 02:03:02 ÁöÑÊé®Êñ≠ÁªìÊûú‚ÄùÔºõ</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    // ‰ª£Á†Å‰∏∫ resultValue = resultValue * (extrapolateToInterval / sampledInterval)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> durationToStart </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">&#x3C;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> extrapolationThreshold {                   </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  extrapolateToInterval </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> durationToStart                    </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  extrapolateToInterval </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> averageDurationBetweenSamples </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> durationToEnd </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">&#x3C;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> extrapolationThreshold {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  extrapolateToInterval </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> durationToEnd                      </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  extrapolateToInterval </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> averageDurationBetweenSamples </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> resultValue </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> resultValue </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (extrapolateToInterval </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> sampledInterval) </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> isRate {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  resultValue </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> resultValue </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ms.Range.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Seconds</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">()             </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> append</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(enh.Out, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Sample</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  Point: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Point</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{V: resultValue},</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> })</span></span></code></pre>
</div><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ÂáΩÊï∞ÊÑè‰πâÔºöËÆ°ÁÆóÂå∫Èó¥ÊåáÊ†áÊó∂Èó¥Á™óÂè£ÂÜÖÂπ≥ÂùáÂ¢ûÈïøÈÄüÁéá„ÄÇ</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‰ªé‰ª£Á†ÅÁúã <a href="https://github.com/prometheus/prometheus/blob/9fcf0b3d46cc3cdff96e6e7baabfaf63d89a5a9d/promql/functions.go#L139" target="_blank" rel="noreferrer">funcRate</a> Ë∞ÉÁî®ËøîÂõû <code>extrapolatedRate(vals, args, enh, true, true)</code>„ÄÇ‰æùÊçÆ‰∏äÊñáËß£ËØªÔºå‰ºöËøîÂõûÊ†∑Êú¨Âå∫Èó¥ÂÜÖ (ÊúÄÂ§ßÂÄº-ÊúÄÂ∞èÂÄº)/Êó∂Èó¥Âå∫Èó¥ÁöÑÁªìÊûúÔºåÂõ†‰∏∫ counter Êàñ histogram(ÂÜÖÈÉ®Â∞ÅË£Ö‰∫Ü counter) ÊòØÁ¥ØËÆ°ÂÄºÔºåÊÑèÂë≥ÁùÄÈöèÊó∂Èó¥Â¢ûÈïøÁõëÊéßÊåáÊ†áÂßãÁªàÂ¢ûÈïø„ÄÇÈÄöËøáËÆ°ÁÆóÈááÊ†∑Êó∂Èó¥ÁöÑÂ¢ûÈáè‰ª£Ë°®ÈááÊ†∑Êó∂Èó¥ÂÜÖÁöÑÊåáÊ†áÂÄºÔºåÂÜçÈô§‰ª•Êó∂Èó¥ÂæóÂá∫ ‚ÄúÊØèÁßíÊåáÊ†áÁöÑÂ¢ûÈïø‚ÄùÔºåÁªèËøáÊé®Êñ≠ËÆ°ÁÆóÂá∫Êü•ËØ¢Êó∂Èó¥ÁÇπÁöÑÂπ≥ÂùáÂ¢ûÈïøÁéá„ÄÇ</p>
<h3 id="_6-2-increase" tabindex="-1">6.2 increase <a class="header-anchor" href="#_6-2-increase" aria-label="Permalink to &quot;6.2 increase&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÂáΩÊï∞ÊÑè‰πâÔºöÊ†∑Êú¨ÈááÈõÜÂå∫Èó¥ÂÜÖÔºåÊåáÊ†áÊ†∑Êú¨ÁöÑÁ¨¨‰∏Ä‰∏™ÂÄºÂíåÊúÄÂêé‰∏Ä‰∏™ÂÄº‰πãÈó¥ÁöÑÂ¢ûÈïøÈáè„ÄÇ</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‰ªé‰ª£Á†ÅÁúã <a href="https://github.com/prometheus/prometheus/blob/9fcf0b3d46cc3cdff96e6e7baabfaf63d89a5a9d/promql/functions.go#L144" target="_blank" rel="noreferrer">funcIncrease</a> <code>extrapolatedRate(vals, args, enh, true, false)</code>„ÄÇ‰æùÊçÆ‰∏äÊñáËß£ËØªÔºå‰ºöËøîÂõûÊ†∑Êú¨Âå∫Èó¥ (ÊúÄÂ§ßÂÄº-ÊúÄÂ∞èÂÄº) ÁöÑÁªìÊûúÔºåÂêåÁêÜÂõ†‰∏∫ Counter ÊòØÁ¥ØËÆ°ÂÄºÔºå‰ª£Ë°®Ê†∑Êú¨Â¢ûÈáèÔºåÁªèËøáÊé®Êñ≠ËÆ°ÁÆóÂá∫Êü•ËØ¢Êó∂Èó¥ÁÇπÁöÑÊ†∑Êú¨Â¢ûÈáè„ÄÇ</p>
<h3 id="_6-3-delta" tabindex="-1">6.3 delta <a class="header-anchor" href="#_6-3-delta" aria-label="Permalink to &quot;6.3 delta&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÂáΩÊï∞ÊÑè‰πâÔºöËÆ°ÁÆóÊ†∑Êú¨Âå∫Èó¥ÂÜÖÔºåÊåáÊ†áÁöÑÁ¨¨‰∏Ä‰∏™ÂÖÉÁ¥†ÂíåÊúÄÂêé‰∏Ä‰∏™ÂÖÉÁ¥†ÁöÑÂ∑ÆÂÄº„ÄÇ</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‰ªé‰ª£Á†ÅÁúã <a href="https://github.com/prometheus/prometheus/blob/9fcf0b3d46cc3cdff96e6e7baabfaf63d89a5a9d/promql/functions.go#L134" target="_blank" rel="noreferrer">funcDelta</a> <code>extrapolatedRate(vals, args, enh, false, false)</code>„ÄÇÂÖ∂ÂÆûÊú¨Ë¥®‰∏äÂäüËÉΩ‰∏é increase ÂáΩÊï∞Á±ª‰ººÔºåÂè™ÊòØÂ∞ë‰∫ÜËÆ°Êï∞Âô®ÈáçÁΩÆÊñπÈù¢ÁöÑËÄÉÈáè„ÄÇ</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Áî±‰∫éËøô‰∏™ÂÄºË¢´Â§ñÊé®Âà∞ÊåáÂÆöÁöÑÊï¥‰∏™Êó∂Èó¥ËåÉÂõ¥ÔºåÊâÄ‰ª•Âç≥‰ΩøÊ†∑Êú¨ÂÄºÈÉΩÊòØÊï¥Êï∞Ôºå‰Ω†‰ªçÁÑ∂ÂèØËÉΩ‰ºöÂæóÂà∞‰∏Ä‰∏™ÈùûÊï¥Êï∞ÂÄº„ÄÇ</p>
<h3 id="_6-4-irate" tabindex="-1">6.4 irate <a class="header-anchor" href="#_6-4-irate" aria-label="Permalink to &quot;6.4 irate&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÂáΩÊï∞ÊÑè‰πâÔºöÊ†∑Êú¨ÈááÈõÜÂå∫Èó¥ÂÜÖÔºåÊåáÊ†áÊ†∑Êú¨ÁöÑÊúÄÂêé‰∏Ä‰∏™ÂÄºÂíåÂÄíÊï∞Á¨¨‰∫å‰∏™ÂÄº‰πãÈó¥ÁöÑÂ¢ûÈïøÈáè„ÄÇ</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‰ªé‰ª£Á†ÅÁúã <a href="https://github.com/prometheus/prometheus/blob/87ffac3e9d2104cd368d2e8962723d9fc3ee126f/promql/functions.go#L149" target="_blank" rel="noreferrer">funcIrate</a> <code>instantValue(vals, enh.Out, true)</code>„ÄÇÂáΩÊï∞ÂÜÖÈÉ®Ë∞ÉÁî® <a href="https://github.com/prometheus/prometheus/blob/87ffac3e9d2104cd368d2e8962723d9fc3ee126f/promql/functions.go#L158" target="_blank" rel="noreferrer">instantValue</a></p>
<h3 id="_6-5-histogram-quantile" tabindex="-1">6.5 histogram_quantile <a class="header-anchor" href="#_6-5-histogram-quantile" aria-label="Permalink to &quot;6.5 histogram_quantile&quot;"></a></h3>
<p>ÂØπ‰∫é histogram ÔºåÂèñ <code>rate + []</code> Ë°®Á§∫Êó∂Èó¥Âå∫Èó¥ÂÜÖÊåáÊ†áÁöÑÂπ≥ÂùáÂ¢ûÈáèÔºå</p>
<h2 id="‰∏É„ÄÅtidb-duration-ËÅöÂêàËß£ËØª" tabindex="-1">‰∏É„ÄÅTiDB Duration ËÅöÂêàËß£ËØª <a class="header-anchor" href="#‰∏É„ÄÅtidb-duration-ËÅöÂêàËß£ËØª" aria-label="Permalink to &quot;‰∏É„ÄÅTiDB Duration ËÅöÂêàËß£ËØª&quot;"></a></h2>
<h3 id="_7-1-Ëé∑ÂèñÂÆö‰πâ" tabindex="-1">7.1 Ëé∑ÂèñÂÆö‰πâ <a class="header-anchor" href="#_7-1-Ëé∑ÂèñÂÆö‰πâ" aria-label="Permalink to &quot;7.1 Ëé∑ÂèñÂÆö‰πâ&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Âú® Grafana ÂèØÂèëÁé∞ Duration 999 Á∫øÁöÑÂÆö‰πâÔºåÂ¶Ç‰∏ã‰ª£Á†ÅÂùó„ÄÇ</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">histogram_quantile(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">999</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">sum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(rate(tidb_server_handle_query_duration_seconds_bucket{k8s_cluster</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"$k8s_cluster"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, tidb_cluster</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"$tidb_cluster"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}[1m])) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">by</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (le))</span></span></code></pre>
</div><figure><img src="./Class-01-prometheus‰∏égrafana/prometheus05.jpg" alt="Prometheus05" tabindex="0"><figcaption>Prometheus05</figcaption></figure>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ëá≥‰∫é {k8s_cluster=&quot;$k8s_cluster&quot;, tidb_cluster=&quot;$tidb_cluster&quot;} Ê†áÁ≠æËøáÊª§ÂèØ‰ª•ÊöÇÊó∂ÂøΩÁï•Ôºå‰ªñÊòØÈÄöËøá Grafana ÂèòÈáèÊú∫Âà∂ÂÆûÁé∞ÁöÑËøáÊª§ TiDB Cluster Áõ∏ÂÖ≥ÊåáÊ†áÁöÑÊú∫Âà∂„ÄÇËøôÈáå‰∏ªË¶ÅÂÖ≥Ê≥® Prometheus Â¶ÇÊûúÂÆûÁé∞Êï∞ÊçÆÁöÑËÅöÂêàÔºåÊöÇÊó∂ÂøΩÁï•Â§öÈõÜÁæ§Êï∞ÊçÆÁöÑÈóÆÈ¢ò„ÄÇÂØπËØ•ÈóÆÈ¢òÔºåËØ¶ÊÉÖÂèÇËÄÉ <a href="https://www.mianshigee.com/tutorial/prometheus-book/grafana-templating.md" target="_blank" rel="noreferrer">grafana ÂèòÈáèÊú∫Âà∂</a> Ê∑±ÂÖ•Á†îÁ©∂„ÄÇ</p>
<figure><img src="./Class-01-prometheus‰∏égrafana/prometheus06.jpg" alt="Prometheus06" tabindex="0"><figcaption>Prometheus06</figcaption></figure>
<h3 id="_7-2-metric-Âå∫Èó¥" tabindex="-1">7.2 Metric Âå∫Èó¥ <a class="header-anchor" href="#_7-2-metric-Âå∫Èó¥" aria-label="Permalink to &quot;7.2 Metric Âå∫Èó¥&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÁªèËøáÁÆÄÂåñÂ¶Ç‰∏ãÊâÄÁ§∫Ôºå‰∏ãÈù¢ÂºÄÂßã <strong>‚ÄúÁúüÊ≠£‚Äù</strong> ËøõÂÖ•ËÅöÂêàËøáÁ®ãÂàÜÊûê„ÄÇ</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">tidb_server_handle_query_duration_seconds_bucket[1m]</span></span></code></pre>
</div><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÈõÜÂêàËøáÁ®ã‰∏≠ÔºåÊúÄÂÜÖÂ±ÇÂÖàÂØπÊåáÊ†á tidb_server_handle_query_duration_seconds_bucket ÈÄöËøá <strong>‚ÄúÂå∫Èó¥ÂêëÈáèËøáÊª§Âô®‚Äù</strong> ËøáÊª§Âá∫ 1min ÂÜÖËØ•ÊåáÊ†áÁöÑÊâÄÊúâÊï∞ÊçÆ„ÄÇÁªèËøáÊó∂Èó¥Êà≥ËΩ¨ËØëÁªìÊûú,Â¶Ç‰∏ã‰ª£Á†ÅÂùóÊâÄÁ§∫„ÄÇ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‰ªéÁúüÂÆû‰∏ñÁïåÊó∂Èó¥ÁúãÔºåÊØèË°åÊï∞ÊçÆ‰∏é‰∏ä‰∏ÄË°åÁõ∏ÊØîÂàöÂ•ΩÂ¢ûÂä† 15sÔºåÂõ†‰∏∫Âú® TiDB ‰∏≠ÈªòËÆ§ÈÖçÁΩÆÊØèÈöî 15s prometheus ‰ªé TiDB„ÄÅTiKV„ÄÅPD ‰∏≠ÊãâÂèñÁºìÂ≠òÁöÑÊï∞ÊçÆ„ÄÇ 4 * 15 = 60s ÂàöÂ•Ω‰ª£Ë°® 1min ÂÜÖÊâÄÊúâÁöÑÊï∞ÊçÆ„ÄÇ</p>
<div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">            131 @ 1650531198.144           131 @ 2022-04-21 16:53:18</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">            131 @ 1650531213.144   ---->   131 @ 2022-04-21 16:53:33      Â¢ûÂä† 15s</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">            131 @ 1650531228.144   ---->   131 @ 2022-04-21 16:53:48      Â¢ûÂä† 15s</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">            131 @ 1650531243.144           131 @ 2022-04-21 16:54:03      Â¢ûÂä† 15s</span></span></code></pre>
</div><figure><img src="./Class-01-prometheus‰∏égrafana/prometheus07.jpg" alt="Prometheus07" tabindex="0"><figcaption>Prometheus07</figcaption></figure>
<h3 id="_7-3-rete-ËøêÁÆó" tabindex="-1">7.3 Rete ËøêÁÆó <a class="header-anchor" href="#_7-3-rete-ËøêÁÆó" aria-label="Permalink to &quot;7.3 Rete ËøêÁÆó&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ËøõÂÖ•Á¨¨‰∫åÂ±ÇËøêÁÆóÔºåÂ¶Ç‰∏ã‰ª£Á†ÅÂùóÊâÄÁ§∫„ÄÇ</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">rate(tidb_server_handle_query_duration_seconds_bucket[1m])</span></span></code></pre>
</div><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rate ÂáΩÊï∞Ë°®Á§∫Êï∞ÊçÆÁÇπÂÅöÂ∑ÆÔºåÂáΩÊï∞ÂéüÁêÜÂèÇËÄÉ‰∏äÊñá„ÄÇÁªìÊûúÊòæÁ§∫ 1min ÂÜÖÊ†áÁ≠æ‰∏∫ {instance=&quot;172.16.6.155:10080&quot;, job=&quot;tidb&quot;, le=&quot;+Inf&quot;, sql_type=&quot;Begin&quot;} ÁöÑÊåáÊ†áËÅöÂêàÁªìÊûúÁöÑÂ¢ûÈáè‰∏∫ 0ÔºåÂèàÂõ†‰∏∫ prometheus ‰∏≠‰øùÂ≠òÁöÑÊòØÁ¥ØËÆ°ÂÄºÔºåÂú® rate ÂÅöÂ∑ÆÂêéÔºåÂàöÂ•ΩË°®Á§∫Ëøô 1min ÂÜÖÁ¨¶Âêà Lable ÁöÑÊåáÊ†áËÅöÂêàÁöÑÂ¢ûÈáè„ÄÇ</p>
<figure><img src="./Class-01-prometheus‰∏égrafana/prometheus08.jpg" alt="Prometheus08" tabindex="0"><figcaption>Prometheus08</figcaption></figure>
<h3 id="_7-4-sum-ËøêÁÆó" tabindex="-1">7.4 Sum ËøêÁÆó <a class="header-anchor" href="#_7-4-sum-ËøêÁÆó" aria-label="Permalink to &quot;7.4 Sum ËøêÁÆó&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ËøõÂÖ•Á¨¨‰∏âÂ±ÇËøêÁÆóÔºåÂ¶Ç‰∏ã‰ª£Á†ÅÂùóÊâÄÁ§∫„ÄÇ</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">sum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(rate(tidb_server_handle_query_duration_seconds_bucket[1m])) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">by</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (le)</span></span></code></pre>
</div><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<code>sum( Metric_XXX ) by (le)</code> ËøêÁÆóÁõÆÁöÑÊòØ‰∏∫‰∫ÜÔºåËÅöÂêàÈô§ le Ê†áÁ≠æÂ§ñÁöÑÊâÄÊúâÂÖ∂‰ªñÊåáÊ†áÁªìÊûúÔºå‰πüÂ∞±ÊòØÂ±èËîΩ sql_type„ÄÅjob„ÄÅinstance ÁöÑ Label Â∑ÆÂºÇÔºåÁªìÊûúÂ¶Ç‰∏ãÔºö</p>
<figure><img src="./Class-01-prometheus‰∏égrafana/prometheus09.jpg" alt="Prometheus09" tabindex="0"><figcaption>Prometheus09</figcaption></figure>
<h3 id="_7-5-histogram-quantile-ËøêÁÆó" tabindex="-1">7.5 Histogram_quantile ËøêÁÆó <a class="header-anchor" href="#_7-5-histogram-quantile-ËøêÁÆó" aria-label="Permalink to &quot;7.5 Histogram_quantile ËøêÁÆó&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ËøõÂÖ•Á¨¨ÂõõÂ±ÇËøêÁÆóÔºåÂ¶Ç‰∏ã‰ª£Á†ÅÂùóÊâÄÁ§∫„ÄÇ</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">histogram_quantile(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">999</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">sum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(rate(tidb_server_handle_query_duration_seconds_bucket[1m])) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">by</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (le))</span></span></code></pre>
</div><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;È¶ñÂÖàÔºåÂü∫‰∫éÊâÄÊúâ le ÂÅö sortÔºåle Ë°®Á§∫ÊØè‰∏™ bucket ÁöÑ‰∏äËæπÁïåÔºå‰∏ãËæπÁïåÁî± Âà´ÁöÑ le ÂÜ≥ÂÆö„ÄÇÈ¶ñÂÖàÂà§ÂÆöÁ¨¨ 99.9% ‰∏™Êï∞ËΩΩÂì™‰∏™ bucket Âå∫Èó¥ÔºåÂú®Áî®‰∫åÂÖÉ‰∏ÄÊ¨°ÊñπÁ®ãÊé®Êñ≠Âá∫ËØ•Âå∫Èó¥ÁöÑÁ¨¨ 99.9% ÁöÑÊï∞ÂÄº„ÄÇ</p>
<h2 id="ÂÖ´„ÄÅreference" tabindex="-1">ÂÖ´„ÄÅReference <a class="header-anchor" href="#ÂÖ´„ÄÅreference" aria-label="Permalink to &quot;ÂÖ´„ÄÅReference&quot;"></a></h2>
<p><a href="https://www.bilibili.com/video/BV1a64y1X7ys?from=search&amp;seid=16358382673192401481&amp;spm_id_from=333.337.0.0" target="_blank" rel="noreferrer">Prometheus ÊòØÊÄé‰πàÂ≠òÂÇ®Êï∞ÊçÆÁöÑÔºàÈôàÁöìÔºâ</a>
<a href="https://prometheus.fuckcloudnative.io/di-er-zhang-gai-nian/metric_types" target="_blank" rel="noreferrer">Prometheus ÊåáÊ†áÁ±ªÂûã</a><br>
<a href="https://zhuanlan.zhihu.com/p/348863302" target="_blank" rel="noreferrer">prometheus‰∏§ÁßçÂàÜ‰ΩçÂÄºhistogramÂíåsummaryÂØπÊØîhistogramÁ∫øÊÄßÊèíÂÄºÊ≥ïÂéüÁêÜ</a><br>
<a href="https://www.infoq.cn/article/Prometheus-theory-source-code" target="_blank" rel="noreferrer">Prometheus ÂéüÁêÜÂíåÊ∫êÁ†ÅÂàÜÊûê</a><br>
<a href="https://www.bianchengquan.com/article/559917.html" target="_blank" rel="noreferrer">PrometheusÂéüÁêÜÂíåÊ∫êÁ†ÅÂàÜÊûê</a></p>
]]></content:encoded>
            <enclosure url="https://askaric.com/Class-01-prometheus%E4%B8%8Egrafana/Prometheus01.png" length="0" type="image/png"/>
        </item>
        <item>
            <title><![CDATA[TIKV ÁõëÊéßÈù¢Êùø - Allocator Stats]]></title>
            <link>https://askaric.com/zh/work/tidb/03TiDB-ËøêÁª¥ÁÆ°ÁêÜ/3-2TiKV ÁõëÊéßËØ¶Ëß£/TIKV ÁõëÊéßÈù¢Êùø - Allocator Stats.html</link>
            <guid>https://askaric.com/zh/work/tidb/03TiDB-ËøêÁª¥ÁÆ°ÁêÜ/3-2TiKV ÁõëÊéßËØ¶Ëß£/TIKV ÁõëÊéßÈù¢Êùø - Allocator Stats.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[1. Èù¢ÊùøÁÆÄ‰ªã
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÁÆÄËÄåË®Ä‰πãÔºåJemalloc¬†ÊòØ‰∏Ä‰∏™ÈÄöÁî®ÁöÑ¬†malloc(3) ÂÆûÁé∞ÔºåÁùÄÈáç‰∫éÂáèÂ∞ëÂÜÖÂ≠òÁ¢éÁâáÂíå]]></description>
            <content:encoded><![CDATA[<h1 id="tikv-ÁõëÊéßÈù¢Êùø-allocator-stats" tabindex="-1">TIKV ÁõëÊéßÈù¢Êùø - Allocator Stats <a class="header-anchor" href="#tikv-ÁõëÊéßÈù¢Êùø-allocator-stats" aria-label="Permalink to &quot;TIKV ÁõëÊéßÈù¢Êùø - Allocator Stats&quot;"></a></h1>
<h2 id="_1-Èù¢ÊùøÁÆÄ‰ªã" tabindex="-1">1. Èù¢ÊùøÁÆÄ‰ªã <a class="header-anchor" href="#_1-Èù¢ÊùøÁÆÄ‰ªã" aria-label="Permalink to &quot;1. Èù¢ÊùøÁÆÄ‰ªã&quot;"></a></h2>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÁÆÄËÄåË®Ä‰πãÔºåJemalloc¬†ÊòØ‰∏Ä‰∏™ÈÄöÁî®ÁöÑ¬†malloc(3) ÂÆûÁé∞ÔºåÁùÄÈáç‰∫éÂáèÂ∞ëÂÜÖÂ≠òÁ¢éÁâáÂíåÊèêÈ´òÂ§öÁ∫øÁ®ãÂπ∂ÂèëÊÄßËÉΩÔºåTiKV ‰ΩøÁî® Jemalloc ÁÆ°ÁêÜÂÜÖÂ≠ò„ÄÇTiKV ÁöÑ Allocator Stats Èù¢ÊùøÂØπÂàÜÊûê TiKV ÂÜÖÂ≠òÊ∂àËÄóËá≥ÂÖ≥ÈáçË¶Å„ÄÇ</p>
<figure><img src="./../../../../../images/tidb/03TiDB-Maintaining/3-1.tikv.01.jpg" alt="3-1.tikv.01" tabindex="0"><figcaption>3-1.tikv.01</figcaption></figure>
<h2 id="_2-Èù¢Êùø‰ΩçÁΩÆ" tabindex="-1">2. Èù¢Êùø‰ΩçÁΩÆ <a class="header-anchor" href="#_2-Èù¢Êùø‰ΩçÁΩÆ" aria-label="Permalink to &quot;2. Èù¢Êùø‰ΩçÁΩÆ&quot;"></a></h2>
<blockquote>
<p>Cluster-TiKV-Details --&gt; Memory --&gt; Allocator Stats</p>
</blockquote>
<figure><img src="./../../../../../images/tidb/03TiDB-Maintaining/3-1.tikv.02.jpg" alt="3-1.tikv.02" tabindex="0"><figcaption>3-1.tikv.02</figcaption></figure>
<h2 id="_3-Èù¢ÊùøËØ¶ÊÉÖ" tabindex="-1">3. Èù¢ÊùøËØ¶ÊÉÖ <a class="header-anchor" href="#_3-Èù¢ÊùøËØ¶ÊÉÖ" aria-label="Permalink to &quot;3. Èù¢ÊùøËØ¶ÊÉÖ&quot;"></a></h2>
<p>Á±ªÂûãÂ¶Ç‰∏ãÔºö</p>
<ul>
<li>mapped</li>
<li>resident</li>
<li>active</li>
<li>allocated</li>
<li>fragmentation</li>
<li>metadata</li>
<li>retained</li>
<li>dirty</li>
</ul>
<hr>
<ol>
<li><strong>allocated</strong>¬†: Jemalloc Êé•Âà∞ APP Áî≥ËØ∑ÁöÑÁâ©ÁêÜÂÜÖÂ≠òÊÄªÂ≠óËäÇÊï∞„ÄÇ</li>
<li><strong>active</strong>¬†: Jemalloc ‰∏∫ËøõÁ®ãÂàÜÈÖçÁöÑÁâ©ÁêÜÂÜÖÂ≠òÊÄªÂ≠óËäÇÊï∞ÔºåÈÄöÂ∏∏ active &gt;= allocatedÔºåË°®Á§∫Â∑≤ÂàÜÈÖç‰∏îÊ≠£Âú®‰ΩøÁî®ÁöÑÂÜÖÂ≠ò„ÄÇ</li>
<li><strong>metadata</strong>¬†: Jemalloc ‰∏∫ÁÆ°ÁêÜÂÜÖÂ≠òÈ¢ùÂ§ñÁöÑ metadata¬†Áâ©ÁêÜÂÜÖÂ≠òÊ∂àËÄó„ÄÇ</li>
<li><strong>mapped</strong>¬†: Jemalloc Êò†Â∞ÑÁöÑÂÜÖÂ≠òÊÄªÂ≠óËäÇÊï∞Ôºåmapped &gt; active(‰∏∫ APP Êò†Â∞ÑÁöÑ)„ÄÇ</li>
<li><strong>resident</strong>¬†: Jemalloc ‰ªéÂΩìÂâçÂÆûÈôÖÈ©ªÁïôÂú®Áâ©ÁêÜÂÜÖÂ≠ò‰∏≠ÁöÑÂÜÖÂ≠òÈáè„ÄÇÂç≥ÔºöÈÄöËøáÁ≥ªÁªüË∞ÉÁî®‰ªéÊìç‰ΩúÁ≥ªÁªüÁî≥ËØ∑ÁöÑ OS ÂÜÖÂ≠òÔºåÂèçÊò†‰∫ÜÂÆûÈôÖÂç†Áî®Áâ©ÁêÜÂÜÖÂ≠òÁöÑÂ§ßÂ∞è„ÄÇ</li>
<li><strong>retained</strong>¬†: Jemalloc ‰øùÁïôÁöÑËôöÊãüÂÜÖÂ≠ò(virtual memory)Êò†Â∞ÑÂ§ßÂ∞èÔºå‰∏éÁâ©ÁêÜÂÜÖÂ≠òÔºàphysical memoryÔºâÊ≤°ÊúâÂº∫ÂÖ≥Á≥ª„ÄÇ</li>
<li><strong>dirty</strong>¬†:¬†<strong>resident - active - metadata</strong>,¬†‰∏Ä‰∏™Áâ©ÁêÜÂÜÖÂ≠òÂå∫ÂüüË¢´ÂàÜÈÖçÂèàË¢´ÈáäÊîæÔºåËØ¥ÊòéÂèØ‰ª•Ë¢´ Jemalloc GC ‰∫ÜÔºåÂ∞±ÊòØ‚ÄúËÑè‚ÄùÁöÑ„ÄÇJemalloc ‰ºöÂÆöÊúüÁî®¬†madvise() Ê∏ÖÁêÜËÑèÈ°µÔºå‰ºöÁªèÂéÜ¬†dirty -&gt; muzzy -&gt; retained ÁöÑËøáÁ®ã„ÄÇ</li>
<li><strong>fragmentation</strong>¬†:¬†<strong>active - allocated</strong>, ‰ª£Ë°®ÂÜÖÂ≠òÁ¢éÁâá(ÂÜÖÈÉ®Á¢éÁâá + Â§ñÈÉ®Á¢éÁâá)ÁöÑÂç†Áî®ÊÉÖÂÜµ„ÄÇ</li>
</ol>
<figure><img src="./../../../../../images/tidb/03TiDB-Maintaining/3-1.tikv.03.jpg" alt="3-1.tikv.03" tabindex="0"><figcaption>3-1.tikv.03</figcaption></figure>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ‰∏Ä‰∏™ÁªèÂÖ∏ÁöÑÂú∫ÊôØÔºåÂ¶ÇÊûú TiKV Âú® Region ÂùáË°°ÁöÑÂâçÊèê‰∏ãÔºåÂÜÖÂ≠òÈ´òÂ∫¶‰∏çÂùáË°°ÔºàGB Á∫ßÂà´ÔºâÊúâÂèØËÉΩÊòØÂÜÖÂ≠òÁ¢éÁâáÂØºËá¥ÁöÑÔºåÂ¶Ç‰∏ãÂõæÊâÄÁ§∫„ÄÇ</p>
<figure><img src="./../../../../../images/tidb/03TiDB-Maintaining/3-1.tikv.04.jpg" alt="3-1.tikv.04" tabindex="0"><figcaption>3-1.tikv.04</figcaption></figure>
<h2 id="_4-ÂèÇËÄÉÊñáÁåÆ" tabindex="-1">4. ÂèÇËÄÉÊñáÁåÆ <a class="header-anchor" href="#_4-ÂèÇËÄÉÊñáÁåÆ" aria-label="Permalink to &quot;4. ÂèÇËÄÉÊñáÁåÆ&quot;"></a></h2>
<ol>
<li><a href="https://jemalloc.net/jemalloc.3.html#stats.active" target="_blank" rel="noreferrer">jemalloc doc</a></li>
<li><a href="https://github.com/tikv/tikv/blob/568b414e99bebf118eedd9b50f24f299efbcab79/components/tikv_alloc/src/jemalloc.rs#L169-L189" target="_blank" rel="noreferrer">tikv code addr</a></li>
<li><a href="https://youjiali1995.github.io/allocator/jemalloc" target="_blank" rel="noreferrer">youjiali blog</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/48957114" target="_blank" rel="noreferrer">Jemalloc analysis</a></li>
<li><a href="https://www.youtube.com/watch?v=RcWp5vwGlYU&amp;list=PLn0nrSd4xjjZoaFwsTnmS1UFj3ob7gf7s" target="_blank" rel="noreferrer">Tick Tock, malloc Needs a Clock</a></li>
</ol>
]]></content:encoded>
            <enclosure url="https://askaric.com/images/tidb/03TiDB-Maintaining/3-1.tikv.01.jpg" length="0" type="image/jpg"/>
        </item>
        <item>
            <title><![CDATA[Âú∫ÊôØÊèèËø∞]]></title>
            <link>https://askaric.com/zh/work/tidb/03TiDB-ËøêÁª¥ÁÆ°ÁêÜ/3-4ÈùûÂ∏∏ËßÑÊÅ¢Â§ç/01ÈáçÂª∫PD.html</link>
            <guid>https://askaric.com/zh/work/tidb/03TiDB-ËøêÁª¥ÁÆ°ÁêÜ/3-4ÈùûÂ∏∏ËßÑÊÅ¢Â§ç/01ÈáçÂª∫PD.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[TiDB ÈáçÂª∫ PD
&lt;!-- TOC --

- Âú∫ÊôØÊèèËø∞
- Êìç‰ΩúÈ£éÈô©
- ÂÆûÈ™åÁéØÂ¢É
- TiUPÊ∫êÊï∞ÊçÆÂ§á‰ªΩ
- ÂÆûÈ™å
    - ÈÉ®ÁΩ≤ÈõÜÁæ§
    - ÈáçÂª∫PD
- ÊÄª]]></description>
            <content:encoded><![CDATA[<p>TiDB ÈáçÂª∫ PD</p>
<!-- TOC -->
<ul>
<li><a href="#Âú∫ÊôØÊèèËø∞">Âú∫ÊôØÊèèËø∞</a></li>
<li><a href="#Êìç‰ΩúÈ£éÈô©">Êìç‰ΩúÈ£éÈô©</a></li>
<li><a href="#ÂÆûÈ™åÁéØÂ¢É">ÂÆûÈ™åÁéØÂ¢É</a></li>
<li><a href="#tiupÊ∫êÊï∞ÊçÆÂ§á‰ªΩ">TiUPÊ∫êÊï∞ÊçÆÂ§á‰ªΩ</a></li>
<li><a href="#ÂÆûÈ™å">ÂÆûÈ™å</a>
<ul>
<li><a href="#ÈÉ®ÁΩ≤ÈõÜÁæ§">ÈÉ®ÁΩ≤ÈõÜÁæ§</a></li>
<li><a href="#ÈáçÂª∫pd">ÈáçÂª∫PD</a></li>
</ul>
</li>
<li><a href="#ÊÄªÁªì">ÊÄªÁªì</a></li>
</ul>
<!-- /TOC -->
<h2 id="Âú∫ÊôØÊèèËø∞" tabindex="-1">Âú∫ÊôØÊèèËø∞ <a class="header-anchor" href="#Âú∫ÊôØÊèèËø∞" aria-label="Permalink to &quot;Âú∫ÊôØÊèèËø∞&quot;"></a></h2>
<ol>
<li>Êõ¥Êç¢ IPÔºö‰æãÂ¶ÇÈÉ®ÁΩ≤ÁöÑÊó∂ÂÄô‰ΩøÁî®‰∫ÜÂä®ÊÄÅ IPÔºåÈõÜÁæ§ÈáçÂêØÂØºËá¥ IP Êó†Ê≥ïÊâæÂõû</li>
<li>Êõ¥Êç¢ÈÉ®ÁΩ≤Á´ØÂè£</li>
<li>Êõ¥Êç¢ÈÉ®ÁΩ≤ÁõÆÂΩïÔºà‰æãÂ¶ÇÈÉ®ÁΩ≤Êó∂Êú™ÈÄâÊã©ÂÆπÈáèËæÉÂ§ßÁöÑÁ£ÅÁõòÔºåÊµ™Ë¥πÊú∫Âô®Á©∫Èó¥Ôºâ</li>
</ol>
<h2 id="Êìç‰ΩúÈ£éÈô©" tabindex="-1">Êìç‰ΩúÈ£éÈô© <a class="header-anchor" href="#Êìç‰ΩúÈ£éÈô©" aria-label="Permalink to &quot;Êìç‰ΩúÈ£éÈô©&quot;"></a></h2>
<p>Âõ†‰∏∫ PD Êç¢‰∫Ü IP ÊàñÁ´ØÂè£‰πãÂêé TiDB Âíå TiKV ‰ºöÊåÇÔºåÊâÄ‰ª•‰∏äËø∞Âú∫ÊôØÈÉΩÈúÄÂÅúÊú∫„ÄÇ
Âπ∂‰∏îÊ∂âÂèä PD Êõ¥Êç¢ IP /  Á´ØÂè£ÈúÄË¶ÅÈîÄÊØÅ PD ÈáçÂª∫ÔºåÂ±û‰∫éÈ´òÈ£éÈô©Êìç‰ΩúÔºå
Âõ†Ê≠§Âú® TiUP ‰∏≠Êú™Áõ¥Êé•ÊîØÊåÅ</p>
<h2 id="ÂÆûÈ™åÁéØÂ¢É" tabindex="-1">ÂÆûÈ™åÁéØÂ¢É <a class="header-anchor" href="#ÂÆûÈ™åÁéØÂ¢É" aria-label="Permalink to &quot;ÂÆûÈ™åÁéØÂ¢É&quot;"></a></h2>
<p>‰∏∫‰∫ÜÂèòÊõ¥ IPÔºåÊàë‰ª¨ÈúÄË¶ÅÊúâ‰∏§‰∏™ IP Âú∞ÂùÄÁöÑÈõÜÁæ§Ôºå‰∏§‰∏™ IP Âú∞ÂùÄÂàÜÂà´Áî® 127.0.0.1 Âíå‰∏Ä‰∏™ÂÜÖÁΩëÂú∞ÂùÄÔºåËøôÈáåÁî® IDC Êú∫Âô® 172.16.5.140 Êù•ÂÅöÔºåÂú®ËØ•Êú∫Âô®‰∏äÈÉ®ÁΩ≤‰∏Ä‰∏™ 2 db, 3 pd, 3 kv ÁöÑÂçïÊú∫ÈõÜÁæ§„ÄÇ
Ê≠•È™§
ÂáÜÂ§á topo Êñá‰ª∂</p>
<div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">global</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">  user</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">test</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">  deploy_dir</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">/data</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">tidb_servers</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">host</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">127.0.0.1</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">    port</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">4000</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">    status_port</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">10080</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">host</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">127.0.0.1</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">    port</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">4001</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">    status_port</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">10081</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">pd_servers</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">host</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">127.0.0.1</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">    port</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2379</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">    status_port</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2380</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">host</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">127.0.0.1</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">    port</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2389</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">    status_port</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2390</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">host</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">127.0.0.1</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">    port</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2399</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">    status_port</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2400</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">tikv_servers</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">host</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">127.0.0.1</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">    port</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20160</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">    status_port</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20180</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">host</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">127.0.0.1</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">    port</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20161</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">    status_port</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20181</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">host</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">127.0.0.1</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">    port</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20162</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">    status_port</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20182</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">monitoring_servers</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">host</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">127.0.0.1</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">grafana_servers</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">host</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">127.0.0.1</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">monitored</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">    node_exporter_port</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">9100</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">    blackbox_exporter_port</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">9115</span></span></code></pre>
</div><h2 id="tiupÊ∫êÊï∞ÊçÆÂ§á‰ªΩ" tabindex="-1">TiUPÊ∫êÊï∞ÊçÆÂ§á‰ªΩ <a class="header-anchor" href="#tiupÊ∫êÊï∞ÊçÆÂ§á‰ªΩ" aria-label="Permalink to &quot;TiUPÊ∫êÊï∞ÊçÆÂ§á‰ªΩ&quot;"></a></h2>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">/.tiup/storage/cluster/clusters/</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">&#x3C;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">cluster-name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ÁõÆÂΩï</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">/.tiup/storage/cluster/clusters/</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">&#x3C;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">cluster-name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">/meta.yaml ‰∏≠ÊòæÁ§∫ÁöÑÊâÄÊúâÊï∞ÊçÆÁõÆÂΩï(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">data_dir</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span></code></pre>
</div><h2 id="ÂÆûÈ™å" tabindex="-1">ÂÆûÈ™å <a class="header-anchor" href="#ÂÆûÈ™å" aria-label="Permalink to &quot;ÂÆûÈ™å&quot;"></a></h2>
<p>ËÉåÊôØ
Âú®Êüê‰∫õÁâπÊÆäÁöÑÊÉÖÂÜµ‰∏ãÔºåÁî®Êà∑ÂèØËÉΩÊÉ≥Ë¶ÅÔºö
Êõ¥Êç¢ IPÔºö‰æãÂ¶ÇÈÉ®ÁΩ≤ÁöÑÊó∂ÂÄô‰ΩøÁî®‰∫ÜÂä®ÊÄÅ IPÔºåÈõÜÁæ§ÈáçÂêØÂØºËá¥ IP Êó†Ê≥ïÊâæÂõû
Êõ¥Êç¢Á´ØÂè£
Êõ¥Êç¢ÁõÆÂΩïÔºö‰æãÂ¶ÇÈÉ®ÁΩ≤Êó∂Êú™ÈÄâÊã©ÂÆπÈáèËæÉÂ§ßÁöÑÁ£ÅÁõòÔºåÊµ™Ë¥πÊú∫Âô®Á©∫Èó¥
Áî±‰∫éËøô‰∏âÁßç case ÈÉΩÈúÄË¶ÅÂÅúÊú∫ÔºàÂõ†‰∏∫ PD Êç¢‰∫Ü IP ÊàñÁ´ØÂè£‰πãÂêé TiDB Âíå TiKV ‰ºöÊåÇ)ÔºåÂπ∂‰∏îÊ∂âÂèä PD Êõ¥Êç¢ IP /  Á´ØÂè£ÈúÄË¶ÅÈîÄÊØÅ PD ÈáçÂª∫ÔºåÂ±û‰∫éÈ´òÈ£éÈô©Êìç‰ΩúÔºåÂõ†Ê≠§Âú® TiUP ‰∏≠Êú™Áõ¥Êé•ÊîØÊåÅÔºå‰ªÖÂØπÂÜÖÊèê‰æõÊ≠§ÊñáÊ°£‰ª•Â§á‰∏çÊó∂‰πãÈúÄ„ÄÇ</p>
<p>Ê≥®ÊÑèÔºöÁ∫ø‰∏äÁéØÂ¢ÉÊìç‰ΩúÔºåÂøÖÈ°ªÂÖàÂ§á‰ªΩÊï∞ÊçÆÔºåËã•Êìç‰ΩúËøáÁ®ãÂØºËá¥Êï∞ÊçÆ‰∏¢Â§±ÔºåÂàôÂèØËÉΩÂÜç‰πüÊó†Ê≥ïÊÅ¢Â§çÈõÜÁæ§ÔºåËá≥Â∞ëÈúÄË¶ÅÂ§á‰ªΩÔºö
‰∏≠ÊéßÊú∫ÁöÑ <code>~/.tiup/storage/cluster/clusters/&lt;cluster-name&gt;</code> ÁõÆÂΩï
<code>~/.tiup/storage/cluster/clusters/&lt;cluster-name&gt;/meta.yaml ‰∏≠ÊòæÁ§∫ÁöÑÊâÄÊúâÊï∞ÊçÆÁõÆÂΩï(data_dir)</code></p>
<h3 id="ÈÉ®ÁΩ≤ÈõÜÁæ§" tabindex="-1">ÈÉ®ÁΩ≤ÈõÜÁæ§ <a class="header-anchor" href="#ÈÉ®ÁΩ≤ÈõÜÁæ§" aria-label="Permalink to &quot;ÈÉ®ÁΩ≤ÈõÜÁæ§&quot;"></a></h3>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>tiup cluster deploy test v4.0.0 ~/topology.yml</span></span></code></pre>
</div><p>Áî±‰∫éÊòØÂçïÊú∫ÈÉ®ÁΩ≤ÔºåÊâßË°åÊ≠§ÂëΩ‰ª§ÂâçÈúÄË¶ÅË∞ÉÊï¥  /etc/ssh/sshd_config ‰∏≠ÁöÑ MaxSessions Âíå MaxStartups Ëá≥‰∏Ä‰∏™ËæÉÂ§ßÁöÑÂÄºÔºåÁÑ∂ÂêéÊâßË°å systemctl reload sshd.service
ÂêØÂä®ÈõÜÁæ§Âπ∂ÊèíÂÖ•Êï∞ÊçÆ
ÂêØÂä®ÈõÜÁæ§ÁöÑÂëΩ‰ª§Ôºö</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>tiup cluster start test</span></span></code></pre>
</div><p>ÊèíÂÖ•Êï∞ÊçÆÊòØ‰∏∫‰∫ÜÈ™åËØÅËøÅÁßª‰πãÂêéÊòØÂê¶‰ºöÂØºËá¥Êï∞ÊçÆ‰∏¢Â§±ÔºåÈöèÊÑèÊèíÂÖ•‰∏Ä‰∫õÊï∞ÊçÆÂç≥ÂèØÔºåÂèØ‰ª•Áî® tiup bench:</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>tiup bench tpcc --warehouses 4 --parts 4 prepare</span></span></code></pre>
</div><p>ÂÆÉ‰ºöÂêëÊú¨Êú∫ÁöÑ 4000 Á´ØÂè£ÊèíÂÖ•Êï∞ÊçÆ„ÄÇ
‰øÆÊîπ IP Âú∞ÂùÄ
ÁõÆÂâçÊàë‰ª¨ÈÉ®ÁΩ≤‰ΩøÁî®ÁöÑÊòØ 127.0.0.1Ôºö
ÂÖàÂÅúÊ≠¢ÈõÜÁæ§Ôºö</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>tiup cluster stop test</span></span></code></pre>
</div><p>ÁÑ∂Âêé‰øÆÊîπ meta.yamlÔºö
ÈÄöËøáÁºñËæë ~/.tiup/storage/cluster/clusters/test/meta.yaml Êù•‰øÆÊîπÂÆÉ‰∏∫ÂÜÖÁΩëÂú∞ÂùÄ 172.16.5.140:</p>
<h3 id="ÈáçÂª∫pd" tabindex="-1">ÈáçÂª∫PD <a class="header-anchor" href="#ÈáçÂª∫pd" aria-label="Permalink to &quot;ÈáçÂª∫PD&quot;"></a></h3>
<p>Áî±‰∫é PD ‰ºöÂ∞Ü IP ÂíåÁ´ØÂè£‰ø°ÊÅØÊåÅ‰πÖÂåñÂà∞ etcd ‰∏≠ÔºåÊîπ‰∏ç‰∫ÜÔºåÊàë‰ª¨Ê®°ÊãüÊûÅÁ´ØÊÉÖÂÜµÈùûÊîπ‰∏çÂèØÔºåÊâÄ‰ª•
ÂèÇËÄÉ PD Recover ÊñáÊ°£Ôºå ‰∏ªÂä®ÈîÄÊØÅ PD ÈáçÂª∫Ôºö
È¶ñÂÖàÂà∞ tidb ÁöÑÊó•ÂøóÁõÆÂΩïÈáåÊâæÂà∞ cluster id:</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[root@localhost data]# cat /data/pd-*/log/pd.log | grep "init cluster id" | head -10</span></span>
<span class="line"><span>[2020/08/18 16:27:28.661 +08:00] [INFO] [server.go:336] ["init cluster id"] [cluster-id=6862237818241127771]</span></span>
<span class="line"><span>[2020/08/18 16:43:24.156 +08:00] [INFO] [server.go:336] ["init cluster id"] [cluster-id=6862237818241127771]</span></span>
<span class="line"><span>[2020/08/18 16:27:28.660 +08:00] [INFO] [server.go:336] ["init cluster id"] [cluster-id=6862237818241127771]</span></span>
<span class="line"><span>[2020/08/18 16:43:27.098 +08:00] [INFO] [server.go:336] ["init cluster id"] [cluster-id=6862237818241127771]</span></span>
<span class="line"><span>[2020/08/18 16:27:28.659 +08:00] [INFO] [server.go:336] ["init cluster id"] [cluster-id=6862237818241127771]</span></span></code></pre>
</div><p>ÁÑ∂ÂêéÊâæÂà∞ allocates idÔºö</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[root@localhost data]# cat /data/pd-*/log/pd* | grep "allocates" | head -10</span></span>
<span class="line"><span>[2020/08/18 16:27:33.083 +08:00] [INFO] [id.go:110] ["idAllocator allocates a new id"] [alloc-id=1000]</span></span></code></pre>
</div><p>Â∞ÜËÄÅÁöÑ PD Êï∞ÊçÆÁõÆÂΩïÁßªËµ∞ÔºàÂèØ‰ª•Âà†ÊéâÔºå‰ΩÜÊòØÂÆâÂÖ®Ëµ∑ËßÅÁî® mv)</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>cd /data/pd-2379</span></span>
<span class="line"><span>mkdir data-backup</span></span>
<span class="line"><span>mv data/* data-backup/</span></span>
<span class="line"><span></span></span>
<span class="line"><span>cd /data/pd-2389</span></span>
<span class="line"><span>mkdir data-backup</span></span>
<span class="line"><span>mv data/* data-backup/</span></span>
<span class="line"><span></span></span>
<span class="line"><span>cd /data/pd-2399</span></span>
<span class="line"><span>mkdir data-backup</span></span>
<span class="line"><span>mv data/* data-backup/</span></span></code></pre>
</div><p>Reload PDÔºö</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>tiup cluster reload test -R pd --force</span></span></code></pre>
</div><p>ÊâßË°å pd-recover:
¬∑¬∑¬∑
tiup pd-recover -endpoints <a href="http://172.16.5.140:2379" target="_blank" rel="noreferrer">http://172.16.5.140:2379</a> -cluster-id 6862237818241127771 -alloc-id 1001
¬∑¬∑¬∑
Reload ÈõÜÁæ§</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>tiup cluster reload test</span></span></code></pre>
</div><p>ÁÑ∂ÂêéÈ™åËØÅ‰∏Ä‰∏ãÊï∞ÊçÆÊòØ‰∏çÊòØËøòÊ≠£Â∏∏Ôºö</p>
<p>‰øÆÊîπÁ´ØÂè£
ÂÅúÊ≠¢ÈõÜÁæ§Ôºö</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>tiup cluster stop test</span></span></code></pre>
</div><p>‰øÆÊîπ meta.yamlÔºö
‰øÆÊîπÁ´ØÂè£Âíå‰øÆÊîπ IP Âú∞ÂùÄÊ≠•È™§Âü∫Êú¨Áõ∏ÂêåÔºåÂÖà‰øÆÊîπ ~/.tiup/storage/cluster/clusters/test/meta.yamlÔºåÊääÊâÄÊúâÁöÑÁ´ØÂè£ÈÉΩÊîπ‰∏ÄÈÅçÔºà‰ΩÜÊòØ‰∏çÊîπÁõÆÂΩï‰∏äÁöÑÁ´ØÂè£ÔºåÁõÆÂΩï‰∏ã‰∏ÄËäÇÊîπÔºâÔºö</p>
<p>ÈáçÂª∫ PD:
ÂèÇËÄÉ PD Recover ÊñáÊ°£Ôºå ÊâæÂà∞ cluster id Âíå allocates id:
cluster id:</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[root@localhost data]# cat /data/pd-*/log/pd.log | grep "init cluster id" | head -10</span></span>
<span class="line"><span>[2020/08/18 16:27:28.661 +08:00] [INFO] [server.go:336] ["init cluster id"] [cluster-id=6862237818241127771]</span></span>
<span class="line"><span>[2020/08/18 16:43:24.156 +08:00] [INFO] [server.go:336] ["init cluster id"] [cluster-id=6862237818241127771]</span></span>
<span class="line"><span>[2020/08/18 17:17:16.381 +08:00] [INFO] [server.go:336] ["init cluster id"] [cluster-id=6862250655043446671]</span></span>
<span class="line"><span>[2020/08/18 17:20:00.075 +08:00] [INFO] [server.go:336] ["init cluster id"] [cluster-id=6862237818241127771]</span></span>
<span class="line"><span>[2020/08/18 17:20:37.488 +08:00] [INFO] [server.go:336] ["init cluster id"] [cluster-id=6862237818241127771]</span></span>
<span class="line"><span>[2020/08/18 16:27:28.660 +08:00] [INFO] [server.go:336] ["init cluster id"] [cluster-id=6862237818241127771]</span></span>
<span class="line"><span>[2020/08/18 16:43:27.098 +08:00] [INFO] [server.go:336] ["init cluster id"] [cluster-id=6862237818241127771]</span></span>
<span class="line"><span>[2020/08/18 17:17:16.382 +08:00] [INFO] [server.go:336] ["init cluster id"] [cluster-id=6862250655043446671]</span></span>
<span class="line"><span>[2020/08/18 17:20:00.078 +08:00] [INFO] [server.go:336] ["init cluster id"] [cluster-id=6862237818241127771]</span></span>
<span class="line"><span>[2020/08/18 17:20:37.508 +08:00] [INFO] [server.go:336] ["init cluster id"] [cluster-id=6862237818241127771]</span></span></code></pre>
</div><p>allocates id:</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[root@localhost data]# cat /data/pd-*/log/pd* | grep "allocates" | head -10</span></span>
<span class="line"><span>[2020/08/18 16:27:33.083 +08:00] [INFO] [id.go:110] ["idAllocator allocates a new id"] [alloc-id=1000]</span></span></code></pre>
</div><p>Â∞ÜËÄÅÁöÑ PD Êï∞ÊçÆÁõÆÂΩïÁßªËµ∞ÔºàÂèØ‰ª•Âà†ÊéâÔºå‰ΩÜÊòØÂÆâÂÖ®Ëµ∑ËßÅÁî® mv)</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>cd /data/pd-2379</span></span>
<span class="line"><span>mkdir data-backup2</span></span>
<span class="line"><span>mv data/* data-backup2/</span></span>
<span class="line"><span></span></span>
<span class="line"><span>cd /data/pd-2389</span></span>
<span class="line"><span>mkdir data-backup2</span></span>
<span class="line"><span>mv data/* data-backup2/</span></span>
<span class="line"><span></span></span>
<span class="line"><span>cd /data/pd-2399</span></span>
<span class="line"><span>mkdir data-backup2</span></span>
<span class="line"><span>mv data/* data-backup2/</span></span></code></pre>
</div><p>ÊâßË°å pd-recover:
¬∑¬∑¬∑
tiup pd-recover -endpoints <a href="http://172.16.5.140:2699" target="_blank" rel="noreferrer">http://172.16.5.140:2699</a> -cluster-id 6862237818241127771 -alloc-id 1001    # ËøôÈáåÁî® 2699 ÊòØÂõ†‰∏∫Êàë‰ª¨Êîπ‰∫Ü pd ÁöÑÁ´ØÂè£
¬∑¬∑¬∑
Reload ÈõÜÁæ§</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>tiup cluster reload test</span></span></code></pre>
</div><p>ÁÑ∂ÂêéÈ™åËØÅ‰∏Ä‰∏ãÊï∞ÊçÆÊòØ‰∏çÊòØËøòÊ≠£Â∏∏Ôºö</p>
<p>‰øÆÊîπÁõÆÂΩï
TiUP ÁöÑÈªòËÆ§ÈÉ®ÁΩ≤ÁõÆÂΩï‰∏ä‰ºöÊúâÁ´ØÂè£Âè∑ÔºåÂú®‰∏äÈù¢‰øÆÊîπÁ´ØÂè£ÁöÑÊó∂ÂÄôÊ≤°ÊúâÂéª‰øÆÊîπ‰ªñÔºàÂÆûÈôÖ‰∏ä‰∏ç‰øÆÊîπ‰πüÊ≤°ÈóÆÈ¢òÔºâÔºå‰ΩÜÊòØ‰∏∫‰∫ÜËÆ©ÂÆÉÁúãËµ∑Êù•Êõ¥Âä†Ê≠£Á°ÆÔºåËøòÊòØÊääÂÆÉÊõ¥Ê≠£ËøáÊù•ÔºàÊ∂âÂèäÁõÆÂΩïÁßªÂä®ÁöÑÂú∫ÊôØÊìç‰Ωú‰πü‰∏ÄÊ†∑Ôºâ„ÄÇ
È¶ñÂÖàËøòÊòØÂÅúÊ≠¢ÈõÜÁæ§Ôºö</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>tiup cluster stop test</span></span></code></pre>
</div><p>ÁÑ∂ÂêéÁºñËæë  ~/.tiup/storage/cluster/clusters/test/meta.yaml:</p>
<p>ÁºñËæëÂÆå‰πãÂêéÈúÄË¶ÅÊääÁõÆÂΩïÁßªÂä®Âà∞Ê≠£Á°ÆÁöÑ‰ΩçÁΩÆÔºåÊØîÂ¶Ç‰∏äÈù¢ÈúÄË¶ÅÔºö</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>mv /data/monitor-9100 /data/monitor-9200</span></span></code></pre>
</div><p>‰∏∫‰∫ÜÈò≤Ê≠¢ÁñèÂøΩÊºèÊéâ mv ÁõÆÂΩïÁöÑÊìç‰ΩúÔºåÊé®ËçêÂºÄ‰∏§‰∏™Á™óÂè£‰∏Ä‰∏™ÁºñËæë meta ‰∏Ä‰∏™ÂêåÊó∂ mv ÁõÆÂΩï„ÄÇÁßªÂä®ÁöÑÊó∂ÂÄôÊ≥®ÊÑèÊñá‰ª∂ÊùÉÈôê„ÄÇ
Âà†Èô§ tikv ÁöÑÊï∞ÊçÆÁõÆÂΩï‰∏≠ÁöÑ last_tikv.tomlÔºö
last_tikv.toml ‰∏≠‰ºöËÆ∞ÂΩï tikv ‰∏ä‰∏ÄÊ¨°ÁöÑÂêØÂä®ÂèÇÊï∞Ôºåtikv ÂêØÂä®Âêé‰ºöÊ£ÄÊü•Âì™‰∫õÂèÇÊï∞‰øÆÊîπ‰∫ÜÔºåÁÑ∂Âêé tikv ÊòØ‰∏çÂÖÅËÆ∏‰øÆÊîπÊï∞ÊçÆÁõÆÂΩïÁöÑÔºåÊâÄ‰ª•Ë¶ÅÊääËøô‰∏™Êñá‰ª∂Âà†ÊéâÔºå‚ÄúÊ¨∫È™ó‚Äù tikvÔºö</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>rm /data/tikv-*/data/last_tikv.toml</span></span></code></pre>
</div><p>ÁÑ∂ÂêéÈáçÊñ∞ÂêØÂä®ÈõÜÁæ§Ôºö</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>tiup cluster reload test -R pd --force</span></span>
<span class="line"><span>tiup cluster reload test</span></span></code></pre>
</div><p>Ê£ÄÊü•Êï∞ÊçÆÊòØÂê¶Ê≠£Á°ÆÔºö</p>
<h2 id="ÊÄªÁªì" tabindex="-1">ÊÄªÁªì <a class="header-anchor" href="#ÊÄªÁªì" aria-label="Permalink to &quot;ÊÄªÁªì&quot;"></a></h2>
<p>Âú®ÊûÅÁ´ØÊÉÖÂÜµ‰∏ã‰øÆÊîπ  IPÔºå Á´ØÂè£ÂíåÁõÆÂΩïÊòØÂèØË°åÁöÑ
Ëøô‰∏âÁßçÊìç‰Ωú‰∫íÁõ∏Áã¨Á´ãÔºåÂèØÂçïÁã¨ÊâßË°å
Ëøô‰∏âÁßçÊìç‰ΩúÂùáÈúÄË¶ÅÂÅúÊú∫ÔºåÂπ∂‰∏îË¶ÅÂú®‰øÆÊîπ meta.yaml ‰πãÂâçÂÅúÊú∫ÔºàÂê¶Âàô‰øÆÊîπ‰∫ÜÁ´ØÂè£‰πãÂêé tiup Â∞±Ê≤°Ê≥ïÂÅúÊ≠¢‰πãÂâçÁöÑËøõÁ®ã‰∫ÜÔºâ
Ëøô‰∏âÁßçÊìç‰ΩúÂùáÊúâ‰∏¢Â§±Êï∞ÊçÆÁöÑÈ£éÈô©ÔºåÁî®Êà∑Á∫ø‰∏äÊìç‰ΩúÂª∫ËÆÆÂú® DBA ÊåáÂØº‰∏ãËøõË°å</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[SQL Duration ÊäñÂä®Áé∞Ë±°ÈóÆÈ¢òÊéíÊü•    ]]></title>
            <link>https://askaric.com/zh/work/tidb/04TiDB-Ë∞É‰ºòÂÆûË∑µ/4-1Áîü‰∫ßÊ°à‰æãÊÄªÁªì/01Á£ÅÁõòÊäñÂä®ÂØºËá¥ Duration ÊäñÂä®.html</link>
            <guid>https://askaric.com/zh/work/tidb/04TiDB-Ë∞É‰ºòÂÆûË∑µ/4-1Áîü‰∫ßÊ°à‰æãÊÄªÁªì/01Á£ÅÁõòÊäñÂä®ÂØºËá¥ Duration ÊäñÂä®.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[Êó∂Èó¥Ôºö2021-02-02  
 ÈóÆÈ¢òÁé∞Ë±°
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Âú®ÂÆ¢Êà∑ TiDB Áîü‰∫ßÂ∫ìËøõË°åÂ∑°Ê£ÄÔºåÂèëÁé∞ SQL Durati]]></description>
            <content:encoded><![CDATA[<h1 id="sql-duration-ÊäñÂä®Áé∞Ë±°ÈóÆÈ¢òÊéíÊü•" tabindex="-1">SQL Duration ÊäñÂä®Áé∞Ë±°ÈóÆÈ¢òÊéíÊü• <a class="header-anchor" href="#sql-duration-ÊäñÂä®Áé∞Ë±°ÈóÆÈ¢òÊéíÊü•" aria-label="Permalink to &quot;SQL Duration ÊäñÂä®Áé∞Ë±°ÈóÆÈ¢òÊéíÊü•&quot;"></a></h1>
<p>Êó∂Èó¥Ôºö2021-02-02</p>
<h2 id="ÈóÆÈ¢òÁé∞Ë±°" tabindex="-1">ÈóÆÈ¢òÁé∞Ë±° <a class="header-anchor" href="#ÈóÆÈ¢òÁé∞Ë±°" aria-label="Permalink to &quot;ÈóÆÈ¢òÁé∞Ë±°&quot;"></a></h2>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Âú®ÂÆ¢Êà∑ TiDB Áîü‰∫ßÂ∫ìËøõË°åÂ∑°Ê£ÄÔºåÂèëÁé∞ SQL Duration Â≠òÂú®Á™ÅÁÑ∂Â∞èÂπÖÂ∫¶ÂçáÈ´òÂêéÂèàÂõûËêΩÁöÑÁé∞Ë±°ÔºåÈúÄÂàÜÊûêÂØºËá¥Ê≠§Áé∞Ë±°ÁöÑÂÖ∑‰ΩìÂéüÂõ†Ôºå‰ª•ËßÑÈÅøÊΩúÂú®È£éÈô©„ÄÇ</p>
<ul>
<li>Metrics ‰∏≠ÂèçÊò†ÁöÑÈóÆÈ¢òÁé∞Ë±°<br>
<img src="./images/check-report-pic/0.png" alt="0"></li>
</ul>
<h2 id="ÊéíÊü•ËøáÁ®ã" tabindex="-1">ÊéíÊü•ËøáÁ®ã <a class="header-anchor" href="#ÊéíÊü•ËøáÁ®ã" aria-label="Permalink to &quot;ÊéíÊü•ËøáÁ®ã&quot;"></a></h2>
<h4 id="Ê†∏ÂøÉÊåáÊ†á" tabindex="-1">Ê†∏ÂøÉÊåáÊ†á <a class="header-anchor" href="#Ê†∏ÂøÉÊåáÊ†á" aria-label="Permalink to &quot;Ê†∏ÂøÉÊåáÊ†á&quot;"></a></h4>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Êú¨Ê¨°‰ªÖ‰ªãÁªçÂú®ÊéíÊü•ÈóÆÈ¢òËøáÁ®ã‰∏≠Ê∂âÂèäÂà∞ÁöÑÊåáÊ†á</p>
<ul>
<li>PingLatency</li>
<li>QPS„ÄÅStatement OPS</li>
<li>Parse Duration„ÄÅCompile Duration„ÄÅExecution Duration„ÄÅDistsql Duration„ÄÅCoprocessor Seconds</li>
<li>KV Request OPS„ÄÅKV Request Duration 99 by store„ÄÅKV Request Duration 99 by type</li>
<li>gRPC poll CPU„ÄÅScheduler worker CPU„ÄÅRaft store CPUAsync aapply CPU</li>
<li>Scheduler writing bytes„ÄÅScheduler pending commands</li>
<li>Propose wait duration per server„ÄÅApply wait duration per server</li>
<li>Append log duration per server„ÄÅApply log per server„ÄÅCommit log duration per server</li>
<li>Disk Lantency„ÄÅDisk Load„ÄÅDisk IOps</li>
</ul>
<h2 id="ÊéíÊü•ÊÄùË∑Ø" tabindex="-1">ÊéíÊü•ÊÄùË∑Ø <a class="header-anchor" href="#ÊéíÊü•ÊÄùË∑Ø" aria-label="Permalink to &quot;ÊéíÊü•ÊÄùË∑Ø&quot;"></a></h2>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;È¶ñÂÖàÔºåÂØπÂèØËÉΩÂºïËµ∑ SQL Duration ÊäñÂä®ÂéüÂõ†ËøõË°åÂàÜÁ±ªÔºåËøΩ‰∏ÄÊéíÊü•Âê¶ÂÆö‰∏çÂèØËÉΩÂõ†Á¥†ÔºåÁõ¥Ëá≥ÂÆö‰ΩçÊ†πÊú¨ÂéüÂõ†Ôºõ</p>
<ul>
<li>Ê°à‰æãÊéíÊü•ÊÄùË∑ØÂàÜÁ±ª
<ol>
<li>ÁΩëÁªúÂª∂ËøüÊäñÂä®ÊÄßÂçáÈ´òÔºåÂØºËá¥ Duration ‰∏äÂçáÔºõ</li>
<li>ÊÖ¢ SQL ÂØºËá¥ÁöÑ Duration ‰∏äÂçáÔºõ</li>
<li>ÈõÜÁæ§ÁªÑ‰ª∂ÊÄßËÉΩÈóÆÈ¢òÂØºËá¥ÁöÑ Duration ‰∏äÂçáÔºõ</li>
</ol>
</li>
</ul>
<h3 id="ÁΩëÁªúÂª∂ËøüÊäñÂä®ÊÄßÊñπÂêëÊéíÊü•" tabindex="-1">ÁΩëÁªúÂª∂ËøüÊäñÂä®ÊÄßÊñπÂêëÊéíÊü• <a class="header-anchor" href="#ÁΩëÁªúÂª∂ËøüÊäñÂä®ÊÄßÊñπÂêëÊéíÊü•" aria-label="Permalink to &quot;ÁΩëÁªúÂª∂ËøüÊäñÂä®ÊÄßÊñπÂêëÊéíÊü•&quot;"></a></h3>
<ul>
<li>
<p>ÊéíÊü•ÊÄùË∑Ø<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÁΩëÁªúÂª∂ËøüÂèØËÉΩÂØºËá¥ RPC Ê∂àÊÅØ‰º†ËæìÊÖ¢ÔºåËøõËÄåÂØºËá¥ SQL CMD ÊâßË°åÂá∫Áé∞ Duration ÁöÑÁé∞Ë±°„ÄÇ</p>
<ul>
<li>PingLatencyÔºöÊåáÊ†áËÆ∞ÂΩïÁΩëÁªúÂª∂ËøüÊÉÖÂÜµÔºåÈóÆÈ¢òÊó∂ÊÆµÂπ∂Êú™Âá∫Áé∞ÁΩëÁªúÂºÇÂ∏∏Áé∞Ë±°Ôºõ</li>
</ul>
</li>
<li>
<p>ÊéíÊü•ÁªìÊûú<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÊéíÈô§ÁΩëÁªúÂéüÂõ†ÂØºËá¥ÁöÑ SQL Duration ÂçáÈ´òÁöÑÂéüÂõ†Ôºõ</p>
</li>
<li>
<p>Ê°à‰æã Top SQL Êà™Âõæ<br>
<img src="./images/check-report-pic/11.png" alt="11"></p>
</li>
</ul>
<h3 id="top-sqlÊñπÂêëÊéíÊü•" tabindex="-1">TOP_SQLÊñπÂêëÊéíÊü• <a class="header-anchor" href="#top-sqlÊñπÂêëÊéíÊü•" aria-label="Permalink to &quot;TOP_SQLÊñπÂêëÊéíÊü•&quot;"></a></h3>
<ul>
<li>
<p>ÊéíÊü•ÊÄùË∑Ø</p>
<ol>
<li>ÈÄöËøá slow_query Á≥ªÁªü‰ø°ÊÅØË°®Áõ∏Â∫îÂ≠óÊÆµÂàÜÁªÑÊéíÂ∫èÔºåÊü•Âá∫Â∑°Ê£ÄÊó∂Èó¥ÂÜÖÊâÄÈúÄÁöÑ Top SQL ‰ø°ÊÅØÔºõ</li>
<li>Â¶ÇÊûúÊñ≠ÂÆö SQL ÊòØÂºïËµ∑ Duration ÂçáÈ´òÁöÑ‰∏ªË¶ÅÂéüÂõ†ÔºåÂèØÈÄöËøá Slow Query File Ëøõ‰∏ÄÊ≠•ÂàÜÊûêÔºõ
<ul>
<li>Êü•ËØ¢ SQL ÊÖ¢ÁöÑÈò∂ÊÆµÔºåÂ¶ÇÔºöParse_time„ÄÅCompile_time Á≠âÁ≠âÔºåËØ¶ÁªÜ‰ø°ÊÅØÂèÇËÄÉ-<a href="https://docs.pingcap.com/zh/tidb/stable/identify-slow-queries#%E5%AD%97%E6%AE%B5%E5%90%AB%E4%B9%89%E8%AF%B4%E6%98%8E" target="_blank" rel="noreferrer">ÊÖ¢Êü•ËØ¢Êó•ÂøóÂ≠óÊÆµÂê´‰πâËØ¥Êòé</a></li>
<li>Êü•ËØ¢ SQL ÂéÜÂè≤ÊâßË°åËÆ°ÂàíÔºåÂ¶ÇÔºöselect tidb_decode_plan(...)Ôºå‰ºòÂåñÂØπÊÄßËÉΩÁì∂È¢àËµ∑ÂÜ≥ÂÆöÊÄß‰ΩúÁî®ÁöÑÊâßË°åËÆ°ÂàíÔºåËØ¶ÁªÜ‰ø°ÊÅØÂèÇËÄÉ-<a href="https://docs.pingcap.com/zh/tidb/stable/identify-slow-queries#%E7%9B%B8%E5%85%B3%E7%B3%BB%E7%BB%9F%E5%8F%98%E9%87%8F" target="_blank" rel="noreferrer">Êü•Áúã Plan</a></li>
<li>ÂÆö‰ΩçÂéüÂõ†ÂêéÈÄöËøá Hint Êàñ Index ‰ºòÂåñÊÖ¢ SQL</li>
</ul>
</li>
</ol>
</li>
<li>
<p>ÊéíÊü•ÁªìÊûú<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ê°à‰æã‰∏≠ TiDB ÈõÜÁæ§ÂÖ±Êúâ4Âè∞ TiDB ÂÆû‰æãÔºåÂàÜÂà´ÊòØ IP88„ÄÅIP89„ÄÅIP91„ÄÅIP93ÔºåÂú®Âõõ‰∏™Âè∞ TiDB ÂÆû‰æã‰∏äÂàÜÂà´ÂèñÈóÆÈ¢òÊó∂Èó¥ÊÆµÂçäÂ∞èÊó∂ÁöÑ Slow Query ÊÉÖÂÜµÔºåÂèëÁé∞Âπ∂Ê≤°ÊúâÊÖ¢ SQL ÊâßË°åÊ¨°Êï∞Â§öÂà∞Ë∂≥Â§üÂΩ±ÂìçÊï¥‰∏™ÈõÜÁæ§ 99% ÂàÜ‰ΩçÊï∞ÁöÑ Duration ÂçáÈ´ò„ÄÇ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Âõ†Ê≠§ÔºåÊÖ¢ SQL ÂØºËá¥ Duration ÁöÑÊñπÂêëÈîÅÂÆöÈóÆÈ¢òÂéüÂõ†ÁöÑÊÄùË∑ØË¢´ÊéíÈô§„ÄÇ</p>
</li>
<li>
<p>Ê°à‰æã Top SQL Êà™Âõæ</p>
<ul>
<li>
<p>IP88<br>
<img src="./images/check-report-pic/2.png" alt="2"></p>
</li>
<li>
<p>IP89<br>
<img src="./images/check-report-pic/3.png" alt="3"></p>
</li>
<li>
<p>IP91<br>
<img src="./images/check-report-pic/4.png" alt="4"></p>
</li>
<li>
<p>IP93<br>
<img src="./images/check-report-pic/5.png" alt="5"></p>
</li>
</ul>
</li>
</ul>
<h3 id="ÈõÜÁæ§ÁªÑ‰ª∂ÊÄßËÉΩÈóÆÈ¢òÊñπÂêëÊéíÊü•" tabindex="-1">ÈõÜÁæ§ÁªÑ‰ª∂ÊÄßËÉΩÈóÆÈ¢òÊñπÂêëÊéíÊü• <a class="header-anchor" href="#ÈõÜÁæ§ÁªÑ‰ª∂ÊÄßËÉΩÈóÆÈ¢òÊñπÂêëÊéíÊü•" aria-label="Permalink to &quot;ÈõÜÁæ§ÁªÑ‰ª∂ÊÄßËÉΩÈóÆÈ¢òÊñπÂêëÊéíÊü•&quot;"></a></h3>
<ul>
<li>
<p>ÁªÑ‰ª∂ÂÖ≥Á≥ªÂõæÔºåÂèÇËÄÉ<a href="https://download.pingcap.com/images/docs-cn/performance-map.png" target="_blank" rel="noreferrer">ÂÆòÊñπÈóÆÊñáÊ°£ Performance-map</a> ÊÄªÁªì
<img src="./images/check-report-pic/ComponentsOverview.png" alt="ÁªÑ‰ª∂ÂÖ≥Á≥ªÂõæ"></p>
</li>
<li>
<p>ÊéíÊü•ÊÄùË∑Ø<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÂØºËá¥ SQL Duration ÁöÑÂéüÂõ†‰πüÂèØËÉΩÊòØÈõÜÁæ§ÁªÑ‰ª∂Âá∫Áé∞ÈóÆÈ¢òÂØºËá¥ÁöÑÔºåÊéíÊü•ÊÄùË∑Ø‰∏∫‰æùÊçÆ TiDB ÂêÑÁªÑ‰ª∂Èó¥ÂÖ≥Á≥ª„ÄÅSQL ÊâßË°åÊµÅÁ®ãÁ≠â‰ΩìÁ≥ªÁü•ËØÜÔºåÊääÊè° Promethus Ê†∏ÂøÉÁõëÊéßÊåáÊ†áÔºåËá™ÂÆöÂêë‰∏ãÈÄêÂ±ÇÊ∑±ÊåñÂêÑÁªÑ‰ª∂ÂΩ±ÂìçÊÄßËÉΩÊúÄÂ§ßÁöÑÂõ†Á¥†„ÄÇ</p>
</li>
</ul>
<h3 id="query-summary" tabindex="-1">Query-Summary <a class="header-anchor" href="#query-summary" aria-label="Permalink to &quot;Query-Summary&quot;"></a></h3>
<ul>
<li>
<p>ÊéíÊü•ÊÄùË∑ØÔºö<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT„ÄÅINSERT„ÄÅUPDATE„ÄÅDELETE ‰∏≠‰ªª‰ΩïÁ±ªÂûã SQL ÁöÑ‰ªª‰Ωï‰∏ÄÁßçÈÉΩÊúâÂèØËÉΩÂØºËá¥ Duration ÂçáÈ´òÔºåÂ∫îËØ•ÈÄöËøá Statement OPS ÊâæÂá∫ÂÖ∂‰∏≠Âç†ÊØîÈáçÊØîËæÉÂ§ßÁöÑ SQL Êìç‰Ωú„ÄÇÂõ†‰∏∫ SQL Âç†ÊØîÈáçËæÉÂ∞èÁöÑ SQL Âç≥‰ΩøÂæàÊÖ¢Ôºå‰πüÂæàÂ∞èÊ¶ÇÁéá‰ºöÂá∫Áé∞Âú® 99% ÂàÜ‰ΩçÊï∞ÁöÑËßÜÂõæ‰∏≠ÔºåÊâÄ‰ª•Â∫îÂÖàÂØπ SQL Êìç‰ΩúÂàÜÁ±ªÊéíÊü•;</p>
<ul>
<li>QPSÔºöÊåáÊ†áÊäòÁ∫øÂõæÊòæÁ§∫ÈóÆÈ¢òÊó∂ÊÆµ QPS ‰∏éÊ≠£Â∏∏Êó∂ÊÆµÊó†Â∑ÆÂºÇÔºåËØ¥Êòé Client ËØ∑Ê±ÇÊ≤°ÊúâÂ¢ûÂ§öÔºõ</li>
<li>Statement OPSÔºöÊåáÊ†áÊòæÁ§∫ select„ÄÅInsert Êìç‰ΩúÂ±ÖÂ§öÔºåupdate„ÄÅdelete ÊûÅÂ∞ëÔºåÂõ†‰∏∫Â∑≤ÁªèÊéíÈô§ÊÖ¢ SQL ÈóÆÈ¢òÔºåÊâÄ‰ª•Êõ¥ÂÄæÂêë‰∫éÊÄÄÁñë Insert CMD ÂØºËá¥ Duration ÂçáÈ´òÔºõ</li>
</ul>
</li>
<li>
<p>ÊéíÊü•ÁªìÊûú<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQL Duration ÊäñÂä®ÁöÑÂéüÂõ†Ôºå‰ªé Metrics ‰∏≠Êé®Êñ≠Êõ¥ÂèØËÉΩÊòØ INSERT ÂØºËá¥ÁöÑ‰∏î Client Á´ØËØ∑Ê±ÇÊ≤°ÊúâÂ¢ûÂä†Ôºå‰ΩêËØÅ‰∫ÜÂèØËÉΩÊòØÈõÜÁæ§‰∏≠ÁªÑ‰ª∂Âá∫Áé∞ÊÄßËÉΩÁì∂È¢àÂØºËá¥ Duration ÊäñÂä®Ôºõ</p>
</li>
<li>
<p>Ê°à‰æã Metrics<br>
<img src="./images/check-report-pic/1.png" alt="1"></p>
</li>
</ul>
<h2 id="ÊéíÊü•ÁªÜËäÇ" tabindex="-1">ÊéíÊü•ÁªÜËäÇ <a class="header-anchor" href="#ÊéíÊü•ÁªÜËäÇ" aria-label="Permalink to &quot;ÊéíÊü•ÁªÜËäÇ&quot;"></a></h2>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÈÄöËøáÂú®‰∏â‰∏™ÊñπÂêëÁöÑÊé¢Á¥¢ÂèëÁé∞ÔºåÂü∫Êú¨ÈîÅÂÆöÂØºËá¥ Duration ÊäñÂä®ÁöÑÂéüÂõ†ÊûÅÊúâÂèØËÉΩÊòØÂõ†‰∏∫ÈõÜÁæ§ÁªÑ‰ª∂ÊÄßËÉΩÈóÆÈ¢òÂØºËá¥ÁöÑ Duration ‰∏äÂçáÔºõ‰∏ãÈù¢ÔºåÈÄöËøá Metrics ÈÄêÂ±ÇÊéíÊü•ÂéüÂõ†„ÄÇ</p>
<h3 id="tidbÈÉ®ÂàÜÁªÑ‰ª∂ÊéíÊü•" tabindex="-1">TiDBÈÉ®ÂàÜÁªÑ‰ª∂ÊéíÊü• <a class="header-anchor" href="#tidbÈÉ®ÂàÜÁªÑ‰ª∂ÊéíÊü•" aria-label="Permalink to &quot;TiDBÈÉ®ÂàÜÁªÑ‰ª∂ÊéíÊü•&quot;"></a></h3>
<h4 id="tidb-executer" tabindex="-1">TiDB-Executer <a class="header-anchor" href="#tidb-executer" aria-label="Permalink to &quot;TiDB-Executer&quot;"></a></h4>
<ul>
<li>
<p>ÊéíÊü•ÊÄùË∑Ø<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Executer ‰∏ªË¶ÅËÅåË¥£‰∏∫ AST --&gt; Logical Plan --&gt; Physcial Plan ÊâßË°åÈìæË∑Ø‰∏äÁöÑËΩ¨Êç¢‰∏é‰ºòÂåñÊìç‰ΩúÔºõ</p>
<ul>
<li>Parse Duration ‰∏éÊ≠£Â∏∏Èò∂ÊÆµÁõ∏ÊØîÊó†ÊòéÊòæÂºÇÂ∏∏Ôºõ</li>
<li>Compile Duration ‰∏éÊ≠£Â∏∏Èò∂ÊÆµÁõ∏ÊØîÊó†ÊòéÊòæÂºÇÂ∏∏Ôºõ</li>
</ul>
</li>
<li>
<p>ÊéíÊü•ÁªìÊûú<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Âü∫Êú¨ÊéíÈô§ TiDB Executer Â±ÇÁªÑ‰ª∂Áì∂È¢àÈóÆÈ¢òÂØºËá¥ÁöÑ SQL Duration ÂçáÈ´òÔºõ‰ΩÜ Execution Duration ÊúâÊòéÊòæÊäñÂä®ÔºåÈúÄÊ∑±ÊåñÂéüÂõ†Ôºõ</p>
</li>
<li>
<p>Ê°à‰æã Metrics<br>
<img src="./images/check-report-pic/6.png" alt="6"></p>
</li>
</ul>
<h4 id="tidb-distsql" tabindex="-1">TiDB-DistSQL <a class="header-anchor" href="#tidb-distsql" aria-label="Permalink to &quot;TiDB-DistSQL&quot;"></a></h4>
<ul>
<li>
<p>ÊéíÊü•ÊÄùË∑Ø<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DistSQL Âπ∂Ë°åÂ§ÑÁêÜÂêÑ SQL ‰∏ãÊé®Âà∞ÂêÑ TiKV ËäÇÁÇπÁöÑ Coprocessor Â§ÑÁêÜÊìç‰ΩúÔºåIP91 ËôΩÁÑ∂ËæÉÈ´òÔºå‰ΩÜÂ≥∞ÂÄº 23ms ÁöÑ Duration Âπ∂‰∏çËÉΩËØ¥ÊòéÈóÆÈ¢òÔºõ</p>
<ul>
<li><strong>DistSQL Duration ÊúâÂ∞èÂπÖÂ∫¶ÂçáÈ´ò</strong>ÔºåËØ¥ÊòéÊ≠§Êó∂ÂèØËÉΩÂ≠òÂú®Ê±áÊÄªÊü•ËØ¢Á±ªÁöÑÊÖ¢ SQLÔºåÂú® TOP SQL ÊñπÂêëÊéíÊü•ËøáÁ®ã‰∏≠‰πüÂèØ‰ª•ÁúãÂà∞ IP91 ËäÇÁÇπÂ≠òÂú®‰∏ÄÊù°ÊâßË°å‰∏§Ê¨°ÁöÑÂπ≥ÂùáÊâßË°åÊó∂Èó¥ SQL Ëææ 26s ÁöÑÊÖ¢SQLÔºå‰ΩÜ‰∏çË∂≥‰ª•ÂΩ±ÂìçÊï¥‰∏™ÈõÜÁæ§ SQL DurationÔºõ</li>
<li><strong>Coprocessor Seconds 0.999 ÂàÜ‰ΩçÊï∞</strong>ÔºåÂõõÂè∞ TiDB ÂÆû‰æãÂùáÂπÖÂ∫¶‰∏çÁ≠âÂçáÈ´òÔºåÂπ∂‰∏çËÉΩËØ¥ÊòéÈóÆÈ¢òÔºõ</li>
</ul>
</li>
<li>
<p>ÊéíÊü•ÁªìÊûú<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TiDB Âú® DistSQL Â§ÑÁêÜÈò∂ÊÆµ‰∏çÂ≠òÂú®ÊÄßËÉΩÈóÆÈ¢òÔºõÁªº‰∏äÊâÄËø∞ÔºåÂü∫Êú¨ÊéíÈô§ TiDB Â±ÇÂ≠òÂú®ÊÄßËÉΩÈóÆÈ¢òÁöÑÊÉÖÂÜµÔºõ</p>
</li>
<li>
<p>Ê°à‰æã Metrics<br>
<img src="./images/check-report-pic/7.png" alt="7"><br>
<img src="./images/check-report-pic/18.png" alt="18"></p>
</li>
</ul>
<h4 id="tidb-kv" tabindex="-1">TiDB-KV <a class="header-anchor" href="#tidb-kv" aria-label="Permalink to &quot;TiDB-KV&quot;"></a></h4>
<ul>
<li>
<p>ÊéíÊü•ÊÄùË∑ØÔºö<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KV Á∫øÁ®ãÊ±†Â§ÑÁêÜÈò∂ÊÆµÂ§Ñ‰∫é Transaction Â§ÑÁêÜÈò∂ÊÆµÂíå TiKV Client Èò∂ÊÆµÂ§ÑÁêÜ‰πãÈó¥ÔºåÂà§Êñ≠ TiDB Âú®ÂºÄÂêØ‰∫ãÂä°ÂêéÂ§ÑÁêÜ KV Êï∞ÊçÆÊòØÂê¶Â≠òÂú®ÊÄßËÉΩÁì∂È¢à„ÄÇ</p>
<ul>
<li>KV Request OPSÔºöÊåáÊ†áÊäòÁ∫øÊòæÁ§∫ÂÖ∂‰ªñËäÇÁÇπ OPS Èò∂ÊÆµÊõ≤Á∫øÂú®ÈóÆÈ¢òÊó∂Èó¥‰∏çÂ≠òÂú®ÊòéÊòæÁâπÂà´Ôºå‰ªÖÊúâ IP91:10080-Cop Âú®ÈóÆÈ¢òÈò∂ÊÆµÂá∫Áé∞ OPS ÂçáÈ´òÁöÑÊÉÖÂÜµÔºå‰ΩÜ‰ªéÊÖ¢Êü•ËØ¢ÁªìÊûúÊù•ÁúãÔºåÂπ∂Êó†‰∏é SELECT ÊúâÂÖ≥ÊÖ¢Êü•ËØ¢Ôºå<strong>ÂèØËÉΩÂçïÁ∫ØÊòØÂèëÂæÄ IP91:10080 ÁöÑ Cop Êìç‰ΩúËøáÂ§ö</strong>ÔºåÊé®ÊµãÊúâÂèØËÉΩÊòØ IP91 ‰∏ä‰∏§Êù°Âπ≥ÂùáÊâßË°å 26s ÊÖ¢ SQL ÂØºËá¥ÁöÑÔºå<strong>‰∏çÂ∫îËØ•ÊòØ‰∏ªË¶ÅÂÖ≥Ê≥®ÁÇπ</strong>Ôºõ</li>
<li>KV Request Duration 99 by storeÔºöTiDB ‰∏≠ÁöÑ KV Èò∂ÊÆµÂèëÂêë store4 ÁöÑËØ∑Ê±ÇÂ≠òÂú®ÊâßË°åÁºìÊÖ¢Áé∞Ë±°Ôºå<strong>ÊäòÁ∫øÂèçÊò†È£ûÈùûÂ∏∏ÊòéÊòæ</strong>Ôºõ</li>
<li>KV Request Duration 99 by typeÔºöÂæàÊúâÂèØËÉΩ‰∏éÂÜôÂÖ•ÊúâÂÖ≥ÔºåÂèëÁîüÂú® Prewrite Èò∂ÊÆµÔºå<strong>ÊäòÁ∫øÂèçÊò†È£ûÈùûÂ∏∏ÊòéÊòæ</strong>Ôºõ</li>
</ul>
</li>
<li>
<p>ÊéíÊü•ÁªìÊûú<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Âü∫Êú¨Âà§Êñ≠Âú® Prewrite Èò∂ÊÆµÂá∫Áé∞‰∫ÜÈóÆÈ¢òÔºåÊé•‰∏ãÊù•Âà§Êñ≠ÊòØÂì™‰∏™ÊàñÈÇ£Âá†‰∏™ËäÇÁÇπÂú® Prewrite Èò∂ÊÆµÂá∫Áé∞‰∫ÜÈóÆÈ¢òÔºõ</p>
</li>
<li>
<p>Ê°à‰æã Metrics<br>
<img src="./images/check-report-pic/8.png" alt="8"><br>
<img src="./images/check-report-pic/9.png" alt="9"></p>
</li>
</ul>
<h3 id="tikvÈÉ®ÂàÜÁªÑ‰ª∂ÊéíÊü•" tabindex="-1">TiKVÈÉ®ÂàÜÁªÑ‰ª∂ÊéíÊü• <a class="header-anchor" href="#tikvÈÉ®ÂàÜÁªÑ‰ª∂ÊéíÊü•" aria-label="Permalink to &quot;TiKVÈÉ®ÂàÜÁªÑ‰ª∂ÊéíÊü•&quot;"></a></h3>
<h4 id="tikv-grpc" tabindex="-1">TiKV-gRPC <a class="header-anchor" href="#tikv-grpc" aria-label="Permalink to &quot;TiKV-gRPC&quot;"></a></h4>
<ul>
<li>
<p>ÊéíÊü•ÊÄùË∑Ø<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gRPC Èò∂ÊÆµÂ±û‰∫é TiKV Á´ØÔºåÁî®‰ª•Êé•Êî∂Êù•Ëá™ TiDB Á´Ø TiKV Client ÁªÑ‰ª∂ÂèëÈÄÅÁöÑËØ∑Ê±Ç„ÄÇ</p>
<ul>
<li>99% ÂàÜ‰ΩçÊï∞ÊòæÁ§∫ kv_prewrite-IP92:270172 Âú®Â§ÑÁêÜ kv-write Duration Â≥∞ÂÄºÂú® 7s Â∑¶Âè≥ÔºåÊòéÊòæÂå∫Âà´‰∫éÂÖ∂‰ªñËäÇÁÇπ<strong>ÊäòÁ∫øÊòæÁ§∫ÈùûÂ∏∏ÊòéÊòæ</strong>Ôºõ</li>
<li>Âõæ‰∫åÊâÄÁ§∫ÔºåÂü∫Êú¨ÊéíÈô§Âõ†‰∏∫ÂàÜÈÖç CPU Ê†∏Êï∞‰∏çË∂≥ÂØºËá¥ÁöÑÂêÑÈò∂ÊÆµ ThreadPool Áì∂È¢àÈóÆÈ¢òÔºå<strong>gRPC poll CPU„ÄÅScheduler worker CPU„ÄÅRaft store CPU„ÄÅAsync apply CPU ÂùáÊúâÂæàÂ§ßÂèØÂà©Áî®Á©∫Èó¥</strong>Ôºõ</li>
</ul>
</li>
<li>
<p>ÊéíÊü•ÁªìÊûú<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Âü∫Êú¨Âà§Êñ≠ IP92:270172 Âá∫Áé∞ÈóÆÈ¢ò„ÄÇÊé•‰∏ãÊù•Ê∑±ÊåñÈóÆÈ¢òÂéüÂõ†ÔºåÂ§ßÊ¶ÇÁéá‰∏é Prewrite Èò∂ÊÆµ I/O ÈóÆÈ¢òÊúâÂÖ≥„ÄÇ</p>
</li>
<li>
<p>Ê°à‰æã Metrics<br>
<img src="./images/check-report-pic/10.png" alt="10"><br>
<img src="./images/check-report-pic/19.png" alt="19"></p>
</li>
</ul>
<h4 id="tikv-scheduler" tabindex="-1">TiKV-Scheduler <a class="header-anchor" href="#tikv-scheduler" aria-label="Permalink to &quot;TiKV-Scheduler&quot;"></a></h4>
<ul>
<li>
<p>ÊéíÊü•ÊÄùË∑Ø<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scheduler Èò∂ÊÆµË¥üË¥£Â§ÑÁêÜÂèëÂæÄ TiKV Èò∂ÊÆµÁöÑÂÜôËØ∑Ê±ÇÔºå‰æùÊçÆÊ≠§Èò∂ÊÆµ Metrics Ëøõ‰∏ÄÊ≠•‰ΩêËØÅÂú® gRPC Èò∂ÊÆµÂæóÂá∫ÁöÑ kv_prewrite-IP92:270172 ËäÇÁÇπÂÜôËØ∑Ê±ÇÂá∫Áé∞ÊÄßËÉΩÈóÆÈ¢òÁöÑÁªìËÆ∫ÔºåÂπ∂ÈÄöËøá IP:Port ÊâÄÂêØÂä®ÁöÑËøõÁ®ãÊü•Âá∫ÂÖ∑‰ΩìÁöÑ StoreÔºõ</p>
<ul>
<li>Scheduler writing bytesÔºöÊåáÊ†áÊòæÁ§∫ IP92„ÄÅIP100 Âú®ÈóÆÈ¢òÊó∂ÊÆµÁ≠âÂæÖÂÜôÂÖ•ÁöÑÊï∞ÊçÆÈáèÂ≠òÂú®ÊòéÊòæÂ¢ûÈïøÔºåÊûÅÊúâÂèØËÉΩÂ≠òÂú®Êï∞ÊçÆÁßØÂéãÔºåÊú™ËÉΩÂèäÊó∂Â∞ÜÊï∞ÊçÆÂÜôÂÖ•Âà∞ RaftStore ‰∏≠ÁöÑÊÉÖÂÜµÔºõ</li>
<li>Scheduler pending commandsÔºöÊåáÊ†áÊòæÁ§∫ IP92 Âú®ÈóÆÈ¢òÊó∂Èó¥ÂæÖÂ§ÑÁêÜÁöÑÂëΩ‰ª§Âá∫Áé∞ÁßØÂéãÔºå<strong>Ëøõ‰∏ÄÊ≠•‰ΩêËØÅ IP92 ÂÜôÂÖ•Âá∫Áé∞ÈóÆÈ¢ò</strong>Ôºõ</li>
</ul>
</li>
<li>
<p>ÊéíÊü•ÁªìÊûú<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Âü∫Êú¨Á°ÆÂÆö IP92:270172 ÂØπÂ∫îÁöÑ Store Âá∫Áé∞‰∫ÜÊÄßËÉΩÈóÆÈ¢òÔºåÈúÄÊü•ÁúãÈóÆÈ¢òÊó∂ÊÆµ Disk-Performance ÊúÄÁªàÂèëÊéòÈóÆÈ¢òÊ†πÊú¨ÂéüÂõ†Ôºõ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÈÄöËøáÁ¨¨‰∫åÂº†ÂõæÁâáÔºåÈîÅÂÆöÂØπÂ∫î Store ‰∏∫ /dev/sdc Á£ÅÁõòÔºõ</p>
</li>
<li>
<p>Ê°à‰æã Metrics<br>
<img src="./images/check-report-pic/12.png" alt="12"><br>
<img src="./images/check-report-pic/13.png" alt="13"></p>
</li>
</ul>
<h4 id="tikv-raftio" tabindex="-1">TiKV-RaftIO <a class="header-anchor" href="#tikv-raftio" aria-label="Permalink to &quot;TiKV-RaftIO&quot;"></a></h4>
<ul>
<li>
<p>ÊéíÊü•ÊÄùË∑Ø<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RaftIO ÁõëÊéß RaftStore Èò∂ÊÆµÔºåRaftStore Áî®‰∫éÂ≠òÂÇ®ÂÆûÁé∞ Raft ÂçèËÆÆÈò∂ÊÆµÊâÄÈúÄË¶ÅÁöÑÊï∞ÊçÆ„ÄÇÂêÑÊåáÊ†áÂèëÁîüÈò∂ÊÆµ„ÄÅÂèÇÊï∞ÁêÜÊÉ≥ÂÄºËØ¶ÁªÜÂèÇÊìç-<a href="https://download.pingcap.com/images/docs-cn/performance-map.png" target="_blank" rel="noreferrer">ÂÆòÊñπÈóÆÊñáÊ°£ Performance-map</a></p>
<ul>
<li>Propose wait duration per serverÔºöÊåáÊ†áÊòæÁ§∫  IP92:270172 Â≥∞ÂÄºËææÂà∞ 3.936sÔºå<strong>ËØ¥ÊòéÂú®Â§ÑÁêÜ raft Log Êó∂ÊØîËæÉÊÖ¢</strong>Ôºõ</li>
<li>Apply wait duration per serverÔºöÊåáÊ†áÊòæÁ§∫ IP92:270172 Â≥∞ÂÄºËææÂà∞ 213msÔºåperformance-map Êé®Ëçê 99% ÂàÜ‰ΩçÊï∞ÂÄºÂ∞è‰∫é 50msÔºå<strong>ËØ¥ÊòéÂú® raft Êï∞ÊçÆËêΩÁõòÊó∂ÊØîËæÉÊÖ¢</strong>Ôºõ</li>
</ul>
</li>
<li>
<p>ÊéíÊü•ÁªìÊûú<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Êé®ÊµãÂèØËÉΩÂ§ßÈáè RaftStore Êï∞ÊçÆÂ≠òÂú®‰∫é RaftStore Á∫øÁ®ãÊ±†ÁöÑ channel ‰∏≠ÔºåÊú™ËÉΩÂèäÊó∂Ë¢´Áõ∏Â∫îÂ§ÑÁêÜÁ∫øÁ®ãÊ∂àË¥πÂÜôÂÖ• rocksDB raft ‰∏≠Ôºå<strong>Ê≠§Êó∂Âõ†‰∏∫ CPU Êú™Ë¢´ÊâìÊª°ÔºåÊâÄ‰ª•Êõ¥Âä†ÊÄÄÁñëÁ£ÅÁõòÊÄßËÉΩÈóÆÈ¢ò</strong>Ôºõ</p>
</li>
<li>
<p>Ê°à‰æã Metrics<br>
<img src="./images/check-report-pic/17.png" alt="17"></p>
</li>
</ul>
<h4 id="tikv-apply" tabindex="-1">TiKV-Apply <a class="header-anchor" href="#tikv-apply" aria-label="Permalink to &quot;TiKV-Apply&quot;"></a></h4>
<ul>
<li>
<p>ÊéíÊü•ÊÄùË∑Ø</p>
<ul>
<li>Append log duration per serverÔºöÊåáÊ†áÊòæÁ§∫ IP92:270172 Â≥∞ÂÄºËææÂà∞ 488msÔºå<strong>ËØ¥ÊòéÂú® raft Log Êó∂Âá∫Áé∞ÈóÆÈ¢ò</strong>Ôºõ</li>
<li>Apply log per serverÔºöÊåáÊ†áÊòæÁ§∫ IP92:270172 Â≥∞ÂÄºËææÂà∞ 471msÔºåperformance-map Êé®Ëçê 99% ÂàÜ‰ΩçÊï∞ÂÄºÂ∞è‰∫é 100msÔºå<strong>ËØ¥ÊòéÂú® raft Êï∞ÊçÆËêΩÁõòÊó∂Âá∫Áé∞ÈóÆÈ¢ò</strong>Ôºõ</li>
<li>Commit log duration per serverÔºöÊåáÊ†áÊòæÁ§∫ IP92:270172 Â≥∞ÂÄºËææÂà∞ 1.95sÔºå<strong>ËØ¥ÊòéËÆ∞ÂΩï Commit Log Êó∂Âá∫Áé∞ÈóÆÈ¢ò</strong>Ôºõ</li>
</ul>
</li>
<li>
<p>ÊéíÊü•ÁªìÊûú<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IP92:270172 ÂØπÂ∫î Store ‰∏äËøõË°åÁöÑ Append„ÄÅApply„ÄÅCommit Êìç‰ΩúÂùáÂá∫Áé∞Âª∂ËøüÁé∞Ë±°ÔºåÈúÄË¶ÅÊü•Áúã apply Èò∂ÊÆµ IP92:270172 Store Á£ÅÁõòÁöÑÂÜôÂÖ•ÊÉÖÂÜµÔºåËøõ‰∏ÄÊ≠•‰ΩêËØÅ‰∫ÜÁ£ÅÁõòÊÄßËÉΩÂá∫Áé∞ÈóÆÈ¢òÁöÑÁåúÊÉ≥Ôºõ</p>
</li>
<li>
<p>Ê°à‰æã Metrics<br>
<img src="./images/check-report-pic/16.png" alt="16"></p>
</li>
</ul>
<h4 id="disk-performance" tabindex="-1">Disk-Performance <a class="header-anchor" href="#disk-performance" aria-label="Permalink to &quot;Disk-Performance&quot;"></a></h4>
<ul>
<li>
<p>ÊéíÊü•ÊÄùË∑Ø<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Disk-Performance Metrics ÁõëÊéßÂêÑ Store ÁöÑÁ£ÅÁõòÊÄßËÉΩÔºåÂåÖÂê´ Lantency„ÄÅIOps„ÄÅBandWidth„ÄÅLoad Á≠â‰ø°ÊÅØÔºõ</p>
<ul>
<li>Disk LantencyÔºöÊåáÊ†áÊòæÁ§∫ÈóÆÈ¢òÊó∂ÊÆµÂª∂ËøüÈ´òËææ 15msÔºå<strong>‰∏éÊ≠£Â∏∏Êó∂ÊÆµÊØîËæÉÂ±û‰∫éÈ´òÂª∂Êó∂</strong>Ôºõ</li>
<li>Disk LoadÔºöÊåáÊ†áÊòæÁ§∫ÈóÆÈ¢òÊó∂ÊÆµË¥üËΩΩÈ´òËææ 8.77Ôºå<strong>‰∏éÊ≠£Â∏∏Êó∂ÊÆµÊØîËæÉÂ±û‰∫éÈ´òË¥üËΩΩÁä∂ÊÄÅ</strong>Ôºõ</li>
<li>Disk IOpsÔºöÊåáÊ†áÊòæÁ§∫ÈóÆÈ¢òÊó∂ÊÆµ IOps Âú® 107 Â∑¶Âè≥Ôºå<strong>Âú®Ê≠£Â∏∏Êó∂ÊÆµÊØîËæÉÂ±û‰∫éÊûÅ‰ΩéÁä∂ÊÄÅ</strong>Ôºõ</li>
</ul>
</li>
<li>
<p>ÊéíÊü•ÁªìÊûú<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Êü•Áúã Store ÈóÆÈ¢òÊó∂ÊÆµÁä∂ÊÄÅÔºåÂèëÁé∞Á£ÅÁõòÂª∂Êó∂„ÄÅË¥üËΩΩÈ´òÂá∫Ê≠£Â∏∏Ê∞¥Âπ≥Ôºå‰ΩÜ IOps Âç¥ÊûÅ‰ΩéÔºåËØ¥ÊòéÈóÆÈ¢òÊó∂ÊÆµÂá∫Áé∞‰∫ÜÁ£ÅÁõòÊÄßËÉΩÊäñÂä®„ÄÇ</p>
</li>
<li>
<p>Ê°à‰æã Metrics<br>
<img src="./images/check-report-pic/14.png" alt="14"><br>
<img src="./images/check-report-pic/15.png" alt="15"></p>
</li>
</ul>
<h2 id="ÈóÆÈ¢òËß£ÂÜ≥" tabindex="-1">ÈóÆÈ¢òËß£ÂÜ≥ <a class="header-anchor" href="#ÈóÆÈ¢òËß£ÂÜ≥" aria-label="Permalink to &quot;ÈóÆÈ¢òËß£ÂÜ≥&quot;"></a></h2>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Âõ†‰∏∫Ê≠§Ê¨° SQL Duration ÂçáÈ´òÊòØ IP92 ËäÇÁÇπ Store ÂØπÂ∫îÁ£ÅÁõòÂá∫Áé∞ÊÄßËÉΩÊäñÂä®ÂØºËá¥ÁöÑÔºåÊó†Ê≥ïÂº•Ë°•‰∏î‰∏çÂ≠òÂú®ÂÆûË¥®ÊÄßÈ£éÈô©ÔºåÊâÄ‰ª•‰∏çÁî®Ëß£ÂÜ≥„ÄÇ</p>
<h2 id="ÂΩíÁ∫≥ÊÄªÁªì" tabindex="-1">ÂΩíÁ∫≥ÊÄªÁªì <a class="header-anchor" href="#ÂΩíÁ∫≥ÊÄªÁªì" aria-label="Permalink to &quot;ÂΩíÁ∫≥ÊÄªÁªì&quot;"></a></h2>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÂØπ‰∫éÁªÑ‰ª∂Èó¥ÁöÑÊÄßËÉΩÊéíÊü•ÔºåÁÜüÁü• <a href="https://download.pingcap.com/images/docs-cn/performance-map.png" target="_blank" rel="noreferrer">ÂÆòÊñπÈóÆÊñáÊ°£ Performance-map</a> ÂêÑÁªÑ‰ª∂Èó¥ÂÖ≥Á≥ªÔºåÂèäÂØπÂ∫î Metrics ÁöÑÊÄßËÉΩÁêÜÊÉ≥ÂÄºÈùûÂ∏∏ÂÖ≥ÈîÆ„ÄÇ</p>
<h2 id="ÂèÇËÄÉÊñáÁ´†" tabindex="-1">ÂèÇËÄÉÊñáÁ´† <a class="header-anchor" href="#ÂèÇËÄÉÊñáÁ´†" aria-label="Permalink to &quot;ÂèÇËÄÉÊñáÁ´†&quot;"></a></h2>
<p><a href="https://download.pingcap.com/images/docs-cn/performance-map.png" target="_blank" rel="noreferrer">ÂÆòÊñπÈóÆÊñáÊ°£ Performance-map</a></p>
<p><a href="https://docs.pingcap.com/zh/tidb/stable/identify-slow-queries#%E5%AD%97%E6%AE%B5%E5%90%AB%E4%B9%89%E8%AF%B4%E6%98%8E" target="_blank" rel="noreferrer">ÊÖ¢Êü•ËØ¢Êó•ÂøóÂ≠óÊÆµÂê´‰πâËØ¥Êòé</a></p>
]]></content:encoded>
            <enclosure url="https://askaric.com/images/check-report-pic/0.png" length="0" type="image/png"/>
        </item>
        <item>
            <title><![CDATA[CASE-ÁΩëÂç°Â∏¶ÂÆΩÊâìÊª°ÂØºËá¥DurationÂçáÈ´òÈóÆÈ¢ò]]></title>
            <link>https://askaric.com/zh/work/tidb/04TiDB-Ë∞É‰ºòÂÆûË∑µ/4-1Áîü‰∫ßÊ°à‰æãÊÄªÁªì/02ÁΩëÂç°ÊâìÊª°ÂØºËá¥ Duration ÂçáÈ´ò.html</link>
            <guid>https://askaric.com/zh/work/tidb/04TiDB-Ë∞É‰ºòÂÆûË∑µ/4-1Áîü‰∫ßÊ°à‰æãÊÄªÁªì/02ÁΩëÂç°ÊâìÊª°ÂØºËá¥ Duration ÂçáÈ´ò.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[# CASE-ÁΩëÂç°Â∏¶ÂÆΩÊâìÊª°ÂØºËá¥DurationÂçáÈ´òÈóÆÈ¢ò
Êó∂Èó¥Ôºö2021-05-07


## ‰∏Ä„ÄÅÈóÆÈ¢òÁé∞Ë±°
1.1 ÂÆ¢Êà∑ÂèçÈ¶àÈóÆÈ¢ò
ÊçÆÂÆ¢Êà∑ÂèçÈ¶àÔºåÂú® 13:30 Â∑¶Âè≥Âá∫Áé∞ SQL Êï¥‰ΩìÂèòÊÖ¢ÁöÑÁé∞Ë±°ÔºåËØ¢ÈóÆÂéüÂõ†ÂèäËß£ÂÜ≥ÊñπÊ°à„ÄÇ
1.2 Grafana ÁõëÊéß
È¶ñÂÖàÔºå‰∏ÄÂè•ËßÇÂØüÁ°ÆÂÆûÂ≠òÂú® Duration Êï¥‰ΩìÂçáÈ´òÁöÑÁé∞Ë±°Ôºõ    
  ![01.jpg](./images/CASE-ÁΩëÂç°Â∏¶ÂÆΩÊâìÊª°ÂØºËá¥DurationÂçáÈ´òÈóÆÈ¢ò/01.jpg)      
‰ΩÜÊòØÔºåËØ•Êó∂ÊÆµÁöÑ SQL OPS Âç¥Êú™ÂçáÈ´òÔºåËØ¥ÊòéÊ≠§Êó∂ÊÆµÂπ∂Êú™Âá∫Áé∞Â∫îÁî®Êö¥Â¢ûÂ§ßÈáè SQL ÊÉÖÂÜµÔºõ  
  ![02.jpg](./images/CASE-ÁΩëÂç°Â∏¶ÂÆΩÊâìÊª°ÂØºËá¥DurationÂçáÈ´òÈóÆÈ¢ò/02.jpg)    
ËßÇÂØüÂÜÖÂ≠òÂèòÂåñÔºåÂèëÁé∞ TIDB ËäÇÁÇπÔºàIP15„ÄÅIP16Ôºâ‰∏≠ÔºåIP15 ËäÇÁÇπÂÜÖÂ≠ò‰ΩøÁî®ÊòéÊòæÂçáÈ´òÔºåÂèØËÉΩÈóÆÈ¢òÂá∫Âú®‰º†ÈÄÅÂà∞ËØ•ËäÇÁÇπÁöÑ SQL Âá∫Áé∞ÂºÇÂ∏∏Ôºõ  
  ![03.jpg](./images/CASE-ÁΩëÂç°Â∏¶ÂÆΩÊâìÊª°ÂØºËá¥DurationÂçáÈ´òÈóÆÈ¢ò/03.jpg)    
ÂêåÊó∂ÔºåËßÇÂØüÂà∞ TiKV CPU ‰ΩøÁî®ÁéáÊï¥‰ΩìÂçáÈ´òÔºå‰∏çÂ§™ÂèØËÉΩÁî±‰∫é TiKV ÊÄßËÉΩÊäñÂä®„ÄÅÁΩëÁªúÊäñÂä®Á≠âÂéüÂõ†Ôºõ   
  ![04.jpg](./images/CASE-ÁΩëÂç°Â∏¶ÂÆΩÊâìÊª°ÂØºËá¥DurationÂçáÈ´òÈóÆÈ¢ò/04.jpg)    
ËßÇÂØüÁΩëÁªúÊµÅÈáèÔºåÂèëÁé∞ IP15 ËäÇÁÇπÁöÑ Inbound ËææÂà∞ 1GÔºåÂêåÊó∂ÂÖ∂‰ªñ TiKV ËäÇÁÇπÁöÑ Outbound ÂçáÈ´òÔºåËØ¥ÊòéIP15 ÂèØËÉΩË¢´ÊâìÊª°ÔºåËøõËÄåÂΩ±ÂìçÊï¥‰∏™ÈõÜÁæ§ÊÄßËÉΩ„ÄÇ
  ![05.jpg](./images/CASE-ÁΩëÂç°Â∏¶ÂÆΩÊâìÊª°ÂØºËá¥DurationÂçáÈ´òÈóÆÈ¢ò/05.jpg)    
1.3 ÁΩëÂç°Â∏¶ÂÆΩ
ËØ•Áîü‰∫ßÈõÜÁæ§‰∏∫‰∏áÂÖÜÁΩëÂç°Ôºõ

```Shell
[tidb@ip-9-23-3-15 log]$ ethtool bond0 
Settings for bond0: 
        ......
        Speed: 10000Mb/s
        ......
```

## ‰∫å„ÄÅÂÆö‰ΩçÂéüÂõ†

2.1 Ê£ÄÊü•ËØ≠Âè•

```SQL
select query sql_text,
       sum_query_time,
       mnt as executions,
       avg_query_time,
       avg_proc_time,
       avg_wait_time,
       max_query_time,
       avg_backoff_time,
       (case
         when avg_proc_time = 0 then
          'point_get or commit'
         when (avg_proc_time > avg_wait_time and
              avg_proc_time > avg_backoff_time) then
          'coprocessor_process'
         when (avg_backoff_time > avg_wait_time and
              avg_proc_time < avg_backoff_time) then
          'backoff'
         else
          'coprocessor_wait'
       end) as type
  from (select substr(query, 1, 100) query,
               count(*) mnt,
               avg(query_time) avg_query_time,
               avg(process_time) avg_proc_time,
               avg(wait_time) avg_wait_time,
               max(query_time) max_query_time,
               sum(query_time) sum_query_time,
               avg(backoff_time) avg_backoff_time
          from information_schema.slow_query
         where time >= '2021-05-07 13:20:00'
           and time <= '2021-05-07 13:35:00'
           and (lower(query) not like 'analyze%' or
               lower(query) not like 'alter%')
         group by substr(query, 1, 100)) t
 order by sum_query_time desc,
          executions     desc,
          avg_query_time desc limit 20;
```
2.2 ËæìÂá∫ÁªìÊûú

```SQL
*************************** 1. row *************************** 
        sql_text: SELECT  id AS id, code AS code, relationNo AS relationNo, proposalNo AS proposalNo, ssProposalNo AS  
  sum_query_time: 904.0470936730003 
      executions: 1040 
  avg_query_time: 0.8692760516086542 
   avg_proc_time: 0.00001153846153846154 
   avg_wait_time: 0.00000576923076923077 
  max_query_time: 4.691674843 
avg_backoff_time: 0 
            type: coprocessor_process 
*************************** 2. row *************************** 
        sql_text: SELECT  id AS id, orderId AS orderId, type AS type, insuredType AS insuredType, changeInsuredType AS 
  sum_query_time: 399.65042316099994 
      executions: 437 
  avg_query_time: 0.9145318607803202 
   avg_proc_time: 0.00043935926773455404 
   avg_wait_time: 0.001796338672768879 
  max_query_time: 3.965649058 
avg_backoff_time: 0.000004576659038901602 
            type: coprocessor_wait 
*************************** 3. row *************************** 
        sql_text: SELECT  id AS id, orderId AS orderId, orderType AS orderType, funNo AS funNo, funUrl AS funUrl, isCo 
  sum_query_time: 286.730882666 
      executions: 255 
  avg_query_time: 1.1244348339843138 
   avg_proc_time: 0.0003490196078431374 
   avg_wait_time: 0.0027568627450980394 
  max_query_time: 5.012617706 
avg_backoff_time: 0 
            type: coprocessor_wait 
*************************** 4. row *************************** 
        sql_text: select id, product_model_id,message_template_id,         relation_list,product_statement_title,fixed 
  sum_query_time: 218.80345473799997 
      executions: 193 
  avg_query_time: 1.1336966566735749 
   avg_proc_time: 0.00021761658031088085 
   avg_wait_time: 0 
  max_query_time: 5.437438295 
avg_backoff_time: 0 
            type: coprocessor_process 
*************************** 5. row *************************** 
        sql_text: INSERT INTO insurance_order_to_org  (id, orderId, orderType, funNo, funUrl, isCompleted, sort, creat 
  sum_query_time: 213.487945341 
      executions: 173 
  avg_query_time: 1.234034366132948 
   avg_proc_time: 0 
   avg_wait_time: 0 
  max_query_time: 5.538053322 
avg_backoff_time: 0 
            type: point_get or commit 
*************************** 6. row *************************** 
        sql_text: SELECT  id AS id, orderId AS orderId, pdfType AS pdfType, createDate AS createDate, updateDate AS up 
  sum_query_time: 185.341252661 
      executions: 188 
  avg_query_time: 0.9858577269202128 
   avg_proc_time: 0.0002553191489361702 
   avg_wait_time: 0.002398936170212766 
  max_query_time: 3.783315653 
avg_backoff_time: 0 
            type: coprocessor_wait 
*************************** 7. row *************************** 
        sql_text: commit; 
  sum_query_time: 169.47936289400002 
      executions: 155 
  avg_query_time: 1.0934152444774194 
   avg_proc_time: 0 
   avg_wait_time: 0 
  max_query_time: 2.877081402 
avg_backoff_time: 0 
            type: point_get or commit 
*************************** 8. row *************************** 
        sql_text: select id, product_id,main_clause_code,main_clause_name,clause_type, liability_type,clause_code,medi 
  sum_query_time: 157.704614038 
      executions: 144 
  avg_query_time: 1.0951709308194444 
   avg_proc_time: 0.0004097222222222223 
   avg_wait_time: 0.0001388888888888889 
  max_query_time: 4.499073241 
avg_backoff_time: 0 
            type: coprocessor_process 
*************************** 9. row *************************** 
        sql_text: INSERT IGNORE  INTO rabbitmq_consume_record  (id, orderId, pdfType, createDate, updateDate, consumeS 
  sum_query_time: 137.144392501 
      executions: 112 
  avg_query_time: 1.2245035044732142 
   avg_proc_time: 0 
   avg_wait_time: 0 
  max_query_time: 4.619352579 
avg_backoff_time: 0 
            type: point_get or commit 
*************************** 10. row *************************** 
        sql_text: SELECT * FROM `ncisp_orders` LIMIT 8729000, 1000; 
  sum_query_time: 136.27416871 
      executions: 1 
  avg_query_time: 136.27416871 
   avg_proc_time: 630.249 
   avg_wait_time: 20.584 
  max_query_time: 136.27416871 
avg_backoff_time: 0 
            type: coprocessor_process 
10 rows in set (1.23 sec) 
```
2.3 ÊâßË°åËÆ°Âàí

```SQL
[ogg33@9.23.3.9:4000] [ncisp]> explain SELECT * FROM `ncisp_orders` LIMIT 8729000, 1000; 
+]]></description>
            <content:encoded><![CDATA[<h1 id="case-ÁΩëÂç°Â∏¶ÂÆΩÊâìÊª°ÂØºËá¥durationÂçáÈ´òÈóÆÈ¢ò" tabindex="-1">CASE-ÁΩëÂç°Â∏¶ÂÆΩÊâìÊª°ÂØºËá¥DurationÂçáÈ´òÈóÆÈ¢ò <a class="header-anchor" href="#case-ÁΩëÂç°Â∏¶ÂÆΩÊâìÊª°ÂØºËá¥durationÂçáÈ´òÈóÆÈ¢ò" aria-label="Permalink to &quot;CASE-ÁΩëÂç°Â∏¶ÂÆΩÊâìÊª°ÂØºËá¥DurationÂçáÈ´òÈóÆÈ¢ò&quot;"></a></h1>
<p>Êó∂Èó¥Ôºö2021-05-07</p>
<h2 id="‰∏Ä„ÄÅÈóÆÈ¢òÁé∞Ë±°" tabindex="-1">‰∏Ä„ÄÅÈóÆÈ¢òÁé∞Ë±° <a class="header-anchor" href="#‰∏Ä„ÄÅÈóÆÈ¢òÁé∞Ë±°" aria-label="Permalink to &quot;‰∏Ä„ÄÅÈóÆÈ¢òÁé∞Ë±°&quot;"></a></h2>
<p>1.1 ÂÆ¢Êà∑ÂèçÈ¶àÈóÆÈ¢ò
ÊçÆÂÆ¢Êà∑ÂèçÈ¶àÔºåÂú® 13:30 Â∑¶Âè≥Âá∫Áé∞ SQL Êï¥‰ΩìÂèòÊÖ¢ÁöÑÁé∞Ë±°ÔºåËØ¢ÈóÆÂéüÂõ†ÂèäËß£ÂÜ≥ÊñπÊ°à„ÄÇ
1.2 Grafana ÁõëÊéß
È¶ñÂÖàÔºå‰∏ÄÂè•ËßÇÂØüÁ°ÆÂÆûÂ≠òÂú® Duration Êï¥‰ΩìÂçáÈ´òÁöÑÁé∞Ë±°Ôºõ<br>
<img src="./images/CASE-ÁΩëÂç°Â∏¶ÂÆΩÊâìÊª°ÂØºËá¥DurationÂçáÈ´òÈóÆÈ¢ò/01.jpg" alt="01.jpg"><br>
‰ΩÜÊòØÔºåËØ•Êó∂ÊÆµÁöÑ SQL OPS Âç¥Êú™ÂçáÈ´òÔºåËØ¥ÊòéÊ≠§Êó∂ÊÆµÂπ∂Êú™Âá∫Áé∞Â∫îÁî®Êö¥Â¢ûÂ§ßÈáè SQL ÊÉÖÂÜµÔºõ<br>
<img src="./images/CASE-ÁΩëÂç°Â∏¶ÂÆΩÊâìÊª°ÂØºËá¥DurationÂçáÈ´òÈóÆÈ¢ò/02.jpg" alt="02.jpg"><br>
ËßÇÂØüÂÜÖÂ≠òÂèòÂåñÔºåÂèëÁé∞ TIDB ËäÇÁÇπÔºàIP15„ÄÅIP16Ôºâ‰∏≠ÔºåIP15 ËäÇÁÇπÂÜÖÂ≠ò‰ΩøÁî®ÊòéÊòæÂçáÈ´òÔºåÂèØËÉΩÈóÆÈ¢òÂá∫Âú®‰º†ÈÄÅÂà∞ËØ•ËäÇÁÇπÁöÑ SQL Âá∫Áé∞ÂºÇÂ∏∏Ôºõ<br>
<img src="./images/CASE-ÁΩëÂç°Â∏¶ÂÆΩÊâìÊª°ÂØºËá¥DurationÂçáÈ´òÈóÆÈ¢ò/03.jpg" alt="03.jpg"><br>
ÂêåÊó∂ÔºåËßÇÂØüÂà∞ TiKV CPU ‰ΩøÁî®ÁéáÊï¥‰ΩìÂçáÈ´òÔºå‰∏çÂ§™ÂèØËÉΩÁî±‰∫é TiKV ÊÄßËÉΩÊäñÂä®„ÄÅÁΩëÁªúÊäñÂä®Á≠âÂéüÂõ†Ôºõ<br>
<img src="./images/CASE-ÁΩëÂç°Â∏¶ÂÆΩÊâìÊª°ÂØºËá¥DurationÂçáÈ´òÈóÆÈ¢ò/04.jpg" alt="04.jpg"><br>
ËßÇÂØüÁΩëÁªúÊµÅÈáèÔºåÂèëÁé∞ IP15 ËäÇÁÇπÁöÑ Inbound ËææÂà∞ 1GÔºåÂêåÊó∂ÂÖ∂‰ªñ TiKV ËäÇÁÇπÁöÑ Outbound ÂçáÈ´òÔºåËØ¥ÊòéIP15 ÂèØËÉΩË¢´ÊâìÊª°ÔºåËøõËÄåÂΩ±ÂìçÊï¥‰∏™ÈõÜÁæ§ÊÄßËÉΩ„ÄÇ
<img src="./images/CASE-ÁΩëÂç°Â∏¶ÂÆΩÊâìÊª°ÂØºËá¥DurationÂçáÈ´òÈóÆÈ¢ò/05.jpg" alt="05.jpg"><br>
1.3 ÁΩëÂç°Â∏¶ÂÆΩ
ËØ•Áîü‰∫ßÈõÜÁæ§‰∏∫‰∏áÂÖÜÁΩëÂç°Ôºõ</p>
<div class="language-Shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">Shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@ip-9-23-3-15 log]$ ethtool bond0 </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Settings</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> bond0:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">        ......</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">        Speed:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 10000Mb/s</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">        ......</span></span></code></pre>
</div><h2 id="‰∫å„ÄÅÂÆö‰ΩçÂéüÂõ†" tabindex="-1">‰∫å„ÄÅÂÆö‰ΩçÂéüÂõ† <a class="header-anchor" href="#‰∫å„ÄÅÂÆö‰ΩçÂéüÂõ†" aria-label="Permalink to &quot;‰∫å„ÄÅÂÆö‰ΩçÂéüÂõ†&quot;"></a></h2>
<p>2.1 Ê£ÄÊü•ËØ≠Âè•</p>
<div class="language-SQL vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> query sql_text,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">       sum_query_time,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">       mnt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> executions,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">       avg_query_time,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">       avg_proc_time,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">       avg_wait_time,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">       max_query_time,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">       avg_backoff_time,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">       (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">case</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">         when</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> avg_proc_time </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> then</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">          'point_get or commit'</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">         when</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (avg_proc_time </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> avg_wait_time </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">and</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">              avg_proc_time </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> avg_backoff_time) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">then</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">          'coprocessor_process'</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">         when</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (avg_backoff_time </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> avg_wait_time </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">and</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">              avg_proc_time </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">&#x3C;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> avg_backoff_time) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">then</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">          'backoff'</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">         else</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">          'coprocessor_wait'</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">       end</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">as</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> type</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> substr(query, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) query,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">               count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) mnt,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">               avg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(query_time) avg_query_time,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">               avg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(process_time) avg_proc_time,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">               avg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(wait_time) avg_wait_time,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">               max</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(query_time) max_query_time,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">               sum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(query_time) sum_query_time,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">               avg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(backoff_time) avg_backoff_time</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">          from</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> information_schema</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">slow_query</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">         where</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> time</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> >=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> '2021-05-07 13:20:00'</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">           and</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> time</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> &#x3C;=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> '2021-05-07 13:35:00'</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">           and</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">lower</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(query) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">not</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> like</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'analyze%'</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> or</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">               lower</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(query) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">not</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> like</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'alter%'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">         group by</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> substr(query, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)) t</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> order by</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> sum_query_time </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">desc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">          executions     </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">desc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">          avg_query_time </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">desc</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> limit</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span></code></pre>
</div><p>2.2 ËæìÂá∫ÁªìÊûú</p>
<div class="language-SQL vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">***************************</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">. </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">row</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> ***************************</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        sql_text: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> id, code </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> code, relationNo </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> relationNo, proposalNo </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> proposalNo, ssProposalNo </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  sum_query_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">904</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0470936730003</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">      executions: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1040</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  avg_query_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">8692760516086542</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   avg_proc_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00001153846153846154</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   avg_wait_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00000576923076923077</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  max_query_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">691674843</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">avg_backoff_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">            type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: coprocessor_process </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">***************************</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">. </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">row</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> ***************************</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        sql_text: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> id, orderId </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> orderId, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">type</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> AS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, insuredType </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> insuredType, changeInsuredType </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  sum_query_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">399</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">65042316099994</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">      executions: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">437</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  avg_query_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">9145318607803202</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   avg_proc_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00043935926773455404</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   avg_wait_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">001796338672768879</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  max_query_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">965649058</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">avg_backoff_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">000004576659038901602</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">            type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: coprocessor_wait </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">***************************</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">. </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">row</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> ***************************</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        sql_text: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> id, orderId </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> orderId, orderType </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> orderType, funNo </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> funNo, funUrl </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> funUrl, isCo </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  sum_query_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">286</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">730882666</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">      executions: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">255</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  avg_query_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1244348339843138</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   avg_proc_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0003490196078431374</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   avg_wait_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0027568627450980394</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  max_query_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">012617706</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">avg_backoff_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">            type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: coprocessor_wait </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">***************************</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">. </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">row</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> ***************************</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        sql_text: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> id, product_model_id,message_template_id,         relation_list,product_statement_title,fixed </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  sum_query_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">218</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">80345473799997</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">      executions: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">193</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  avg_query_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1336966566735749</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   avg_proc_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00021761658031088085</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   avg_wait_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  max_query_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">437438295</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">avg_backoff_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">            type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: coprocessor_process </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">***************************</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">. </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">row</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> ***************************</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        sql_text: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">INSERT INTO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> insurance_order_to_org  (id, orderId, orderType, funNo, funUrl, isCompleted, sort, creat </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  sum_query_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">213</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">487945341</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">      executions: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">173</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  avg_query_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">234034366132948</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   avg_proc_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   avg_wait_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  max_query_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">538053322</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">avg_backoff_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">            type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: point_get </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">or</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> commit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">***************************</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">. </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">row</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> ***************************</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        sql_text: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> id, orderId </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> orderId, pdfType </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> pdfType, createDate </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> createDate, updateDate </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> up </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  sum_query_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">185</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">341252661</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">      executions: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">188</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  avg_query_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">9858577269202128</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   avg_proc_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0002553191489361702</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   avg_wait_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">002398936170212766</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  max_query_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">783315653</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">avg_backoff_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">            type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: coprocessor_wait </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">***************************</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 7</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">. </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">row</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> ***************************</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        sql_text: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">commit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">; </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  sum_query_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">169</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">47936289400002</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">      executions: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">155</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  avg_query_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0934152444774194</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   avg_proc_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   avg_wait_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  max_query_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">877081402</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">avg_backoff_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">            type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: point_get </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">or</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> commit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">***************************</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">. </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">row</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> ***************************</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        sql_text: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> id, product_id,main_clause_code,main_clause_name,clause_type, liability_type,clause_code,medi </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  sum_query_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">157</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">704614038</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">      executions: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">144</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  avg_query_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0951709308194444</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   avg_proc_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0004097222222222223</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   avg_wait_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0001388888888888889</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  max_query_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">499073241</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">avg_backoff_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">            type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: coprocessor_process </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">***************************</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 9</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">. </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">row</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> ***************************</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        sql_text: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">INSERT IGNORE  INTO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> rabbitmq_consume_record  (id, orderId, pdfType, createDate, updateDate, consumeS </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  sum_query_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">137</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">144392501</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">      executions: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">112</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  avg_query_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2245035044732142</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   avg_proc_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   avg_wait_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  max_query_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">619352579</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">avg_backoff_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">            type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: point_get </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">or</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> commit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">***************************</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">. </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">row</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> ***************************</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        sql_text: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> FROM</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `ncisp_orders`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> LIMIT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 8729000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">; </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  sum_query_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">136</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">27416871</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">      executions: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  avg_query_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">136</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">27416871</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   avg_proc_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">630</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">249</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   avg_wait_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">584</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  max_query_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">136</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">27416871</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">avg_backoff_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">            type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: coprocessor_process </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">10</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> rows</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> in</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">23</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> sec)</span></span></code></pre>
</div><p>2.3 ÊâßË°åËÆ°Âàí</p>
<div class="language-SQL vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[ogg33@9.23.3.9:4000] [ncisp]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> explain </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> FROM</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `ncisp_orders`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> LIMIT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 8729000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">; </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">----------------------------+------------+-----------+--------------------+----------------------------+ </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| id                         | estRows    | task      | access </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">      | operator info              | </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">----------------------------+------------+-----------+--------------------+----------------------------+ </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| Limit_7                    | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">root</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">      |                    | offset:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">8729000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, count:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| ¬©‚àè¬©¬ßTableReader_12           | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">8730000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">root</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">      |                    | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:Limit_11              | </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">|   ¬©‚àè¬©¬ßLimit_11               | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">8730000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | cop[tikv] |                    | offset:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, count:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">8730000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    | </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">|     ¬©‚àè¬©¬ßTableFullScan_10     | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">8730000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | cop[tikv] | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">table</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:ncisp_orders | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">keep</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> order:false           | </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">----------------------------+------------+-----------+--------------------+----------------------------+ </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">4</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> rows</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> in</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> sec) </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[ogg33@9.23.3.9:4000] [ncisp]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> select</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ncisp_orders; </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">----------+ </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) | </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">----------+ </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">|  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">8789461</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">----------+ </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> row</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> in</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">83</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> sec)</span></span></code></pre>
</div><p>2.4 ‰º∞ÁÆóÊï∞ÊçÆÈáè</p>
<div class="language-SQL vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[ogg33@9.23.3.9:4000] [ncisp]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> show </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">table</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> status</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> like</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> '%ncisp_orders'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">\G  </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">***************************</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">. </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">row</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> ***************************</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">           Name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: ncisp_orders </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">         Engine: InnoDB </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">        Version</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">     Row_format: Compact </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">           Rows</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">8788191</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Avg_row_length: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">16710</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    Data_length: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">146854445481</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">Max_data_length: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   Index_length: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1678429127</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">      Data_free: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Auto_increment: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    Create_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2021</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">04</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">26</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 21</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">05</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">17</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    Update_time: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">     Check_time: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">      Collation: utf8mb4_bin </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">       Checksum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:  </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Create_options:  </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        Comment: ‚àÇ¬©¬µ‚Ä¢¬±√å </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> row</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> in</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">09</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> sec)</span></span></code></pre>
</div><p>Âπ≥ÂùáË°åÈïø 16710 bytesÔºà16KÔºâÔºåÊâßË°åËÆ°ÂàíËØ•Êù° SQL ÁöÑÁâ©ÁêÜÊâßË°å‰∏≠ÂåÖÂê´‚ÄúÂÖ®Ë°®Êâ´Êèè‚ÄùÔºåÂú® TiKV Â±ÇÊâ´ÊèèÂá∫ 8730000 Ë°åÔºåÊç¢ÁÆóÂêéÊé•Ëøë 8730000 * 16K = 133GÔºõ
‰∏áÂÖÜÁΩëÂç° 10000M bit/s Êç¢ÁÆóÂêéÁ∫¶‰∏∫ 120G Bytes/sÔºåÂèØËßÅÔºåÊ≠§Êó∂ IP15 ËäÇÁÇπÁöÑÁΩëÂç°Âõ†ËøôÊù° SELECT Ë¢´ÊâìÊª°„ÄÇ</p>
<h2 id="‰∏â„ÄÅËß£ÂÜ≥ÊñπÊ°à" tabindex="-1">‰∏â„ÄÅËß£ÂÜ≥ÊñπÊ°à <a class="header-anchor" href="#‰∏â„ÄÅËß£ÂÜ≥ÊñπÊ°à" aria-label="Permalink to &quot;‰∏â„ÄÅËß£ÂÜ≥ÊñπÊ°à&quot;"></a></h2>
<p>ÈúÄÂêëÂ∫îÁî®Êü•ÊòéËØ•Êù° SQL ÁöÑÊâßË°åÁõÆÁöÑÔºåÂ¶ÇÈùûÂøÖË¶ÅÔºåÂ∞ΩÂäõËßÑÈÅøÊàñÂ∞ÜËØ• SQL ÊãÜÂàÜ‰∏∫Â§öÊâπÊ¨°Â∞èÊï∞ÊçÆÈáèÊü•ËØ¢„ÄÇ</p>
]]></content:encoded>
            <enclosure url="https://askaric.com/images/CASE-%E7%BD%91%E5%8D%A1%E5%B8%A6%E5%AE%BD%E6%89%93%E6%BB%A1%E5%AF%BC%E8%87%B4Duration%E5%8D%87%E9%AB%98%E9%97%AE%E9%A2%98/01.jpg" length="0" type="image/jpg"/>
        </item>
        <item>
            <link>https://askaric.com/zh/work/tidb/06TiDB-Ëß£ÂÜ≥ÊñπÊ°à/6-1ËøÅÁßªMyCatËá≥TiDBÊñπÊ°à/01TiChangeËÑöÊú¨ËΩ¨Êç¢csvÊñá‰ª∂ÈÄÇÈÖçtidb-lightning.html</link>
            <guid>https://askaric.com/zh/work/tidb/06TiDB-Ëß£ÂÜ≥ÊñπÊ°à/6-1ËøÅÁßªMyCatËá≥TiDBÊñπÊ°à/01TiChangeËÑöÊú¨ËΩ¨Êç¢csvÊñá‰ª∂ÈÄÇÈÖçtidb-lightning.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
        </item>
        <item>
            <title><![CDATA[OGGÊï∞ÊçÆÂ∫ìÁ≥ªÁªüoracleÂà∞TiDBÂºÇÂú∞ÁÅæÂ§áÊñπÊ°à]]></title>
            <link>https://askaric.com/zh/work/tidb/06TiDB-Ëß£ÂÜ≥ÊñπÊ°à/6-2ËøÅÁßªOracleËá≥TiDBÊñπÊ°à/01OracleÂà∞TiDBÁöÑOGGÈÉ®ÁΩ≤ÊñπÊ°à.html</link>
            <guid>https://askaric.com/zh/work/tidb/06TiDB-Ëß£ÂÜ≥ÊñπÊ°à/6-2ËøÅÁßªOracleËá≥TiDBÊñπÊ°à/01OracleÂà∞TiDBÁöÑOGGÈÉ®ÁΩ≤ÊñπÊ°à.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[# OGGÊï∞ÊçÆÂ∫ìÁ≥ªÁªüoracleÂà∞TiDBÂºÇÂú∞ÁÅæÂ§áÊñπÊ°à

## ÁõÆÂΩï  

> - [Ê¶ÇËø∞](#Ê¶ÇËø∞)  
>   - [ÊñπÊ°àËÉåÊôØ](#ÊñπÊ°àËÉåÊôØ)  
>   - [ÈúÄÊ±ÇÂàÜÊûê](#ÈúÄÊ±ÇÂàÜÊûê)  
>   - [Á≥ªÁªüÁé∞Áä∂](#Á≥ªÁªüÁé∞Áä∂)  
>   - [ÁÅæÂ§áË¶ÅÊ±Ç](#ÁÅæÂ§áË¶ÅÊ±Ç)  
> - [Ëß£ÂÜ≥ÊñπÊ°à](#Ëß£ÂÜ≥ÊñπÊ°à)  
>   - [ÊñπÊ°àÊ¶ÇËø∞](#ÊñπÊ°àÊ¶ÇËø∞)  
>   - [ÊäÄÊúØÊñπÊ°à](#ÊäÄÊúØÊñπÊ°à)  
>     - [Êï¥‰ΩìÊû∂ÊûÑ](#Êï¥‰ΩìÊû∂ÊûÑ)  
>     - [ÁéØÂ¢ÉËØ¥Êòé](#ÁéØÂ¢ÉËØ¥Êòé)  
>     - [Ê∫êÁ´ØÊù°‰ª∂Ê£ÄÊü•](#Ê∫êÁ´ØÊù°‰ª∂Ê£ÄÊü•)  
>     - [Ê∫êÁ´ØOGGÂÆâË£Ö](#Ê∫êÁ´ØoggÂÆâË£Ö)  
>     - [ÁõÆÊ†áÁ´ØTiDBÈÖçÁΩÆ](#ÁõÆÊ†áÁ´ØTiDBÈÖçÁΩÆ)  
>     - [Ê∫êÁ´ØÂØπË±°Ëé∑Âèñ](#Ê∫êÁ´ØÂØπË±°Ëé∑Âèñ)
>     - [ÁõÆÊ†áÁ´ØÂØπË±°Âª∫Á´ã](#ÁõÆÊ†áÁ´ØÂØπË±°Âª∫Á´ã)  
>     - [ÁõÆÊ†áÁ´ØOGGÂÆâË£Ö](#ÁõÆÊ†áÁ´ØOGGÂÆâË£Ö)  
>     - [ÈÖçÁΩÆÂ¢ûÈáèÂêåÊ≠•](#ÈÖçÁΩÆÂ¢ûÈáèÂêåÊ≠•)
>     - [Ê∫êÁ´ØÊ£ÄÊü•ÂΩíÊ°£Êó•Âøó](#Ê∫êÁ´ØÊ£ÄÊü•ÂΩíÊ°£Êó•Âøó)
>     - [ÈÖçÁΩÆÂÖ®ÈáèÂêåÊ≠•](#ÈÖçÁΩÆÂÖ®ÈáèÂêåÊ≠•)  
>     - [ÂêØÂä®ÂÖ®ÈáèÂêåÊ≠•](#ÂêØÂä®ÂÖ®ÈáèÂêåÊ≠•)   
>     - [ÂêØÂä®Â¢ûÈáèÂêåÊ≠•](#ÂêØÂä®Â¢ûÈáèÂêåÊ≠•)  
> - [Ê≠£Á°ÆÊÄßÈ™åËØÅ](#Ê≠£Á°ÆÊÄßÈ™åËØÅ)  


## Ê¶ÇËø∞

### ÊñπÊ°àËÉåÊôØ

### ÈúÄÊ±ÇÂàÜÊûê

### Á≥ªÁªüÁé∞Áä∂

### ÁÅæÂ§áË¶ÅÊ±Ç

## Ëß£ÂÜ≥ÊñπÊ°à

### ÊñπÊ°àÊ¶ÇËø∞

‰∏∫Êª°Ë∂≥ÂºÇÂú∞ÁÅæÂ§á‰∏≠ÂøÉÂ∞ΩÂèØËÉΩÂ∞ëÁöÑ‰∏¢Â§±Êï∞ÊçÆÔºàRPOÔºâÂπ∂Êèê‰æõÂø´ÈÄü‰∏öÂä°ÂèØÁî®ÁöÑÈúÄÊ±ÇÔºàRTOÔºâÔºå‰∏äÊµ∑ÁÅæÂ§áÊê≠Âª∫ÈááÂèñÂÆûÊó∂ÂêåÊ≠•ÊñπÂºèÔºåÂ∞ÜÂåó‰∫¨Êï∞ÊçÆ‰∏≠ÂøÉÊï∞ÊçÆÂêåÊ≠•Âà∞‰∏äÊµ∑Êï∞ÊçÆ‰∏≠ÂøÉÔºåÂÆûÊó∂ÂêåÊ≠•ÈááÂèñ OGG Â∑•ÂÖ∑ËøõË°åÂêåÊ≠•„ÄÇ

### ÊäÄÊúØÊñπÊ°à

#### Êï¥‰ΩìÊû∂ÊûÑ
Ê∫êÁ´ØÊï∞ÊçÆ‰∏≠ÂøÉ Oracle ÈÄöËøá OGG Â∑•ÂÖ∑ÂÆûÊó∂ÊäΩÂèñÊó•ÂøóÂêåÊ≠•Âà∞‰∏ãÊ∏∏ TiDB„ÄÇ

#### ÁéØÂ¢ÉËØ¥Êòé


| ‰ΩçÁΩÆ | ËΩØ‰ª∂	| ÁâàÊú¨ | ÈÉ®ÁΩ≤Ë∑ØÂæÑ |
| ]]></description>
            <content:encoded><![CDATA[<h1 id="oggÊï∞ÊçÆÂ∫ìÁ≥ªÁªüoracleÂà∞tidbÂºÇÂú∞ÁÅæÂ§áÊñπÊ°à" tabindex="-1">OGGÊï∞ÊçÆÂ∫ìÁ≥ªÁªüoracleÂà∞TiDBÂºÇÂú∞ÁÅæÂ§áÊñπÊ°à <a class="header-anchor" href="#oggÊï∞ÊçÆÂ∫ìÁ≥ªÁªüoracleÂà∞tidbÂºÇÂú∞ÁÅæÂ§áÊñπÊ°à" aria-label="Permalink to &quot;OGGÊï∞ÊçÆÂ∫ìÁ≥ªÁªüoracleÂà∞TiDBÂºÇÂú∞ÁÅæÂ§áÊñπÊ°à&quot;"></a></h1>
<h2 id="ÁõÆÂΩï" tabindex="-1">ÁõÆÂΩï <a class="header-anchor" href="#ÁõÆÂΩï" aria-label="Permalink to &quot;ÁõÆÂΩï&quot;"></a></h2>
<blockquote>
<ul>
<li><a href="#Ê¶ÇËø∞">Ê¶ÇËø∞</a>
<ul>
<li><a href="#ÊñπÊ°àËÉåÊôØ">ÊñπÊ°àËÉåÊôØ</a></li>
<li><a href="#ÈúÄÊ±ÇÂàÜÊûê">ÈúÄÊ±ÇÂàÜÊûê</a></li>
<li><a href="#Á≥ªÁªüÁé∞Áä∂">Á≥ªÁªüÁé∞Áä∂</a></li>
<li><a href="#ÁÅæÂ§áË¶ÅÊ±Ç">ÁÅæÂ§áË¶ÅÊ±Ç</a></li>
</ul>
</li>
<li><a href="#Ëß£ÂÜ≥ÊñπÊ°à">Ëß£ÂÜ≥ÊñπÊ°à</a>
<ul>
<li><a href="#ÊñπÊ°àÊ¶ÇËø∞">ÊñπÊ°àÊ¶ÇËø∞</a></li>
<li><a href="#ÊäÄÊúØÊñπÊ°à">ÊäÄÊúØÊñπÊ°à</a>
<ul>
<li><a href="#Êï¥‰ΩìÊû∂ÊûÑ">Êï¥‰ΩìÊû∂ÊûÑ</a></li>
<li><a href="#ÁéØÂ¢ÉËØ¥Êòé">ÁéØÂ¢ÉËØ¥Êòé</a></li>
<li><a href="#Ê∫êÁ´ØÊù°‰ª∂Ê£ÄÊü•">Ê∫êÁ´ØÊù°‰ª∂Ê£ÄÊü•</a></li>
<li><a href="#Ê∫êÁ´ØoggÂÆâË£Ö">Ê∫êÁ´ØOGGÂÆâË£Ö</a></li>
<li><a href="#ÁõÆÊ†áÁ´ØTiDBÈÖçÁΩÆ">ÁõÆÊ†áÁ´ØTiDBÈÖçÁΩÆ</a></li>
<li><a href="#Ê∫êÁ´ØÂØπË±°Ëé∑Âèñ">Ê∫êÁ´ØÂØπË±°Ëé∑Âèñ</a></li>
<li><a href="#ÁõÆÊ†áÁ´ØÂØπË±°Âª∫Á´ã">ÁõÆÊ†áÁ´ØÂØπË±°Âª∫Á´ã</a></li>
<li><a href="#ÁõÆÊ†áÁ´ØOGGÂÆâË£Ö">ÁõÆÊ†áÁ´ØOGGÂÆâË£Ö</a></li>
<li><a href="#ÈÖçÁΩÆÂ¢ûÈáèÂêåÊ≠•">ÈÖçÁΩÆÂ¢ûÈáèÂêåÊ≠•</a></li>
<li><a href="#Ê∫êÁ´ØÊ£ÄÊü•ÂΩíÊ°£Êó•Âøó">Ê∫êÁ´ØÊ£ÄÊü•ÂΩíÊ°£Êó•Âøó</a></li>
<li><a href="#ÈÖçÁΩÆÂÖ®ÈáèÂêåÊ≠•">ÈÖçÁΩÆÂÖ®ÈáèÂêåÊ≠•</a></li>
<li><a href="#ÂêØÂä®ÂÖ®ÈáèÂêåÊ≠•">ÂêØÂä®ÂÖ®ÈáèÂêåÊ≠•</a></li>
<li><a href="#ÂêØÂä®Â¢ûÈáèÂêåÊ≠•">ÂêØÂä®Â¢ûÈáèÂêåÊ≠•</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#Ê≠£Á°ÆÊÄßÈ™åËØÅ">Ê≠£Á°ÆÊÄßÈ™åËØÅ</a></li>
</ul>
</blockquote>
<h2 id="Ê¶ÇËø∞" tabindex="-1">Ê¶ÇËø∞ <a class="header-anchor" href="#Ê¶ÇËø∞" aria-label="Permalink to &quot;Ê¶ÇËø∞&quot;"></a></h2>
<h3 id="ÊñπÊ°àËÉåÊôØ" tabindex="-1">ÊñπÊ°àËÉåÊôØ <a class="header-anchor" href="#ÊñπÊ°àËÉåÊôØ" aria-label="Permalink to &quot;ÊñπÊ°àËÉåÊôØ&quot;"></a></h3>
<h3 id="ÈúÄÊ±ÇÂàÜÊûê" tabindex="-1">ÈúÄÊ±ÇÂàÜÊûê <a class="header-anchor" href="#ÈúÄÊ±ÇÂàÜÊûê" aria-label="Permalink to &quot;ÈúÄÊ±ÇÂàÜÊûê&quot;"></a></h3>
<h3 id="Á≥ªÁªüÁé∞Áä∂" tabindex="-1">Á≥ªÁªüÁé∞Áä∂ <a class="header-anchor" href="#Á≥ªÁªüÁé∞Áä∂" aria-label="Permalink to &quot;Á≥ªÁªüÁé∞Áä∂&quot;"></a></h3>
<h3 id="ÁÅæÂ§áË¶ÅÊ±Ç" tabindex="-1">ÁÅæÂ§áË¶ÅÊ±Ç <a class="header-anchor" href="#ÁÅæÂ§áË¶ÅÊ±Ç" aria-label="Permalink to &quot;ÁÅæÂ§áË¶ÅÊ±Ç&quot;"></a></h3>
<h2 id="Ëß£ÂÜ≥ÊñπÊ°à" tabindex="-1">Ëß£ÂÜ≥ÊñπÊ°à <a class="header-anchor" href="#Ëß£ÂÜ≥ÊñπÊ°à" aria-label="Permalink to &quot;Ëß£ÂÜ≥ÊñπÊ°à&quot;"></a></h2>
<h3 id="ÊñπÊ°àÊ¶ÇËø∞" tabindex="-1">ÊñπÊ°àÊ¶ÇËø∞ <a class="header-anchor" href="#ÊñπÊ°àÊ¶ÇËø∞" aria-label="Permalink to &quot;ÊñπÊ°àÊ¶ÇËø∞&quot;"></a></h3>
<p>‰∏∫Êª°Ë∂≥ÂºÇÂú∞ÁÅæÂ§á‰∏≠ÂøÉÂ∞ΩÂèØËÉΩÂ∞ëÁöÑ‰∏¢Â§±Êï∞ÊçÆÔºàRPOÔºâÂπ∂Êèê‰æõÂø´ÈÄü‰∏öÂä°ÂèØÁî®ÁöÑÈúÄÊ±ÇÔºàRTOÔºâÔºå‰∏äÊµ∑ÁÅæÂ§áÊê≠Âª∫ÈááÂèñÂÆûÊó∂ÂêåÊ≠•ÊñπÂºèÔºåÂ∞ÜÂåó‰∫¨Êï∞ÊçÆ‰∏≠ÂøÉÊï∞ÊçÆÂêåÊ≠•Âà∞‰∏äÊµ∑Êï∞ÊçÆ‰∏≠ÂøÉÔºåÂÆûÊó∂ÂêåÊ≠•ÈááÂèñ OGG Â∑•ÂÖ∑ËøõË°åÂêåÊ≠•„ÄÇ</p>
<h3 id="ÊäÄÊúØÊñπÊ°à" tabindex="-1">ÊäÄÊúØÊñπÊ°à <a class="header-anchor" href="#ÊäÄÊúØÊñπÊ°à" aria-label="Permalink to &quot;ÊäÄÊúØÊñπÊ°à&quot;"></a></h3>
<h4 id="Êï¥‰ΩìÊû∂ÊûÑ" tabindex="-1">Êï¥‰ΩìÊû∂ÊûÑ <a class="header-anchor" href="#Êï¥‰ΩìÊû∂ÊûÑ" aria-label="Permalink to &quot;Êï¥‰ΩìÊû∂ÊûÑ&quot;"></a></h4>
<p>Ê∫êÁ´ØÊï∞ÊçÆ‰∏≠ÂøÉ Oracle ÈÄöËøá OGG Â∑•ÂÖ∑ÂÆûÊó∂ÊäΩÂèñÊó•ÂøóÂêåÊ≠•Âà∞‰∏ãÊ∏∏ TiDB„ÄÇ</p>
<h4 id="ÁéØÂ¢ÉËØ¥Êòé" tabindex="-1">ÁéØÂ¢ÉËØ¥Êòé <a class="header-anchor" href="#ÁéØÂ¢ÉËØ¥Êòé" aria-label="Permalink to &quot;ÁéØÂ¢ÉËØ¥Êòé&quot;"></a></h4>
<table tabindex="0">
<thead>
<tr>
<th>‰ΩçÁΩÆ</th>
<th>ËΩØ‰ª∂</th>
<th>ÁâàÊú¨</th>
<th>ÈÉ®ÁΩ≤Ë∑ØÂæÑ</th>
</tr>
</thead>
<tbody>
<tr>
<td>ÁõÆÊ†áÁ´Ø</td>
<td>TiDB-Cluster</td>
<td>4.0.8</td>
<td></td>
</tr>
<tr>
<td>ÁõÆÊ†áÁ´Ø</td>
<td>OGG_for_MySQL</td>
<td>19.1.0.0.3</td>
<td>/data/ogg_for_mysql</td>
</tr>
<tr>
<td>Ê∫êÁ´Ø</td>
<td>Oracle</td>
<td>19.0.0.0</td>
<td>/home/oracle/ogg_for_oracle</td>
</tr>
<tr>
<td>Ê∫êÁ´Ø</td>
<td>OGG_for_Oracle</td>
<td>19.1.0.0.4</td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="ÂâçÁΩÆÊ£ÄÊü•" tabindex="-1">ÂâçÁΩÆÊ£ÄÊü• <a class="header-anchor" href="#ÂâçÁΩÆÊ£ÄÊü•" aria-label="Permalink to &quot;ÂâçÁΩÆÊ£ÄÊü•&quot;"></a></h3>
<p>Êó†‰∏ªÈîÆË°®Ê¢≥ÁêÜ</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> owner</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,table_name</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> DBA_TABLES a</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> where</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> not</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> exists</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> *</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">          from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> DBA_constraints b</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">         where</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> b</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">constraint_type</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'P'</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">           and</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">table_name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> b</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">table_name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">   and</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">owner</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">upper</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'scott'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">upper</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'scott'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">));</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    -- upper ÂÜÖÂ°´ÂÖ•ÊâÄÈúÄË¶ÅÊü•ËØ¢ÁöÑ schema ÂêçÔºåÂèØÂ°´ÂÜôÂ§ö‰∏™Ôºõ</span></span></code></pre>
</div><h3 id="Ê∫êÁ´ØÊù°‰ª∂Ê£ÄÊü•" tabindex="-1">Ê∫êÁ´ØÊù°‰ª∂Ê£ÄÊü• <a class="header-anchor" href="#Ê∫êÁ´ØÊù°‰ª∂Ê£ÄÊü•" aria-label="Permalink to &quot;Ê∫êÁ´ØÊù°‰ª∂Ê£ÄÊü•&quot;"></a></h3>
<ol>
<li>ÂΩíÊ°£Ê®°ÂºèÁ°ÆËÆ§</li>
</ol>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> SQL></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> archive </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> list</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> Database</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> mode	 ¬† ¬† ¬† Archive Mode</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> Automatic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> archival¬† ¬† ¬† 	</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">Enabled</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Archive destination ¬† ¬† 	USE_DB_RECOVERY_FILE_DEST</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Oldest </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">online</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> log</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> sequence</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 	6731</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> Next</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> log</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> sequence</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> to</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> archive ¬† </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">6742</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Current </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">log</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> sequence</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">¬† 	6742</span></span></code></pre>
</div><p>2. ÂõûÊî∂Á´ôÂÖ≥Èó≠</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> SQL></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> show parameter recyclebin</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ¬†</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> NAME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> ¬† ¬† ¬† ¬† 	 	TYPE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">¬† VALUE</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"> ------------------------------------ ----------- ------------------------------</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> recyclebin ¬† ¬† ¬† 	 ¬† ¬† string ¬† </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">on</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> SQL></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> alter</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> system</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> recyclebin</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=off</span></span></code></pre>
</div><p>3. force logging</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">SQL></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> force_logging </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> v$</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">database</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">¬†</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">FORCE_LOGGING</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">---------------------------------------</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">YES</span></span></code></pre>
</div><p>4. supplemental log</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">SQL></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> supplemental_log_data_min </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> v$</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">database</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">¬†</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">SUPPLEME</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">--------</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">YES</span></span></code></pre>
</div><p>5. Ê∫êÁ´ØÂ≠óÁ¨¶ÈõÜÊü•Áúã</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>select (select PROPERTY_VALUE from DATABASE_PROPERTIES where PROPERTY_NAME = 'NLS_LANGUAGE')||'_'||</span></span>
<span class="line"><span>¬†¬†¬†¬†	(select PROPERTY_VALUE from DATABASE_PROPERTIES where PROPERTY_NAME = 'NLS_TERRITORY')||'.'||</span></span>
<span class="line"><span>¬†¬†¬†¬†	(select PROPERTY_VALUE from DATABASE_PROPERTIES where PROPERTY_NAME = 'NLS_CHARACTERSET') characters</span></span>
<span class="line"><span>¬†¬†¬†from dual;</span></span>
<span class="line"><span>¬†</span></span>
<span class="line"><span>CHARACTERS</span></span>
<span class="line"><span>------------------------------------------------------------</span></span>
<span class="line"><span>AMERICAN_AMERICA.AL32UTF8</span></span></code></pre>
</div><p></p>
<h3 id="Ê∫êÁ´ØoggÂÆâË£Ö" tabindex="-1">Ê∫êÁ´ØOGGÂÆâË£Ö <a class="header-anchor" href="#Ê∫êÁ´ØoggÂÆâË£Ö" aria-label="Permalink to &quot;Ê∫êÁ´ØOGGÂÆâË£Ö&quot;"></a></h3>
<ol>
<li>
<p>‰∏ä‰º† 19c OGG for oracle on linuxÂÆâË£ÖÂåÖ</p>
</li>
<li>
<p>ÈÖçÁΩÆÂìçÂ∫îÊñá‰ª∂</p>
</li>
</ol>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">vi </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">home</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">oracle</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">ogg</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">fbo_ggs_Linux_x64_shiphome</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">Disk1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">response</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">oggcore</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">rsp</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">‰øÆÊîπ‰ª•‰∏ãÈÖçÁΩÆ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">INSTALL_OPTION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">ORA19c</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">SOFTWARE_LOCATION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">home</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">oracle</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">ogg_for_oracle</span></span></code></pre>
</div><p>3. ÈùôÈªòÂÆâË£Ö</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">cd </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">home</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">oracle</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">ogg</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">fbo_ggs_Linux_x64_shiphome</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">Disk1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">runInstaller </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">silent </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">responseFile </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">home</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">oracle</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">ogg</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">fbo_ggs_Linux_x64_shiphome</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">Disk1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">response</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">oggcore</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">rsp</span></span></code></pre>
</div><p>4. ÂàõÂª∫ ogg ÁõÆÂΩï</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">ggsic</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> subdirs</span></span></code></pre>
</div><p>5. ÈÖçÁΩÆ mgr</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">edit </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">param</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> mgr</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">¬†</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">PORT </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">8809</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ¬† ¬† ¬† ¬† 	</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">DYNAMICPORTLIST </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">8810</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">8889</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">AUTOSTART ER </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">AUTORESTART EXTRACT </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,RETRIES </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,WAITMINUTES </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">3</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">ACCESSRULE, PROG </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, IPADDR </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, ALLOW</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">PURGEOLDEXTRACTS .</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">dirdat</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">/*,usecheckpoints, minkeepdays 7</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">--PURGEDDLHISTORY MINKEEPDAYS 3, MAXKEEPDAYS 5, FREQUENCYMINUTES 30</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">--PURGEMARKERHISTORY MINKEEPDAYS 3, MAXKEEPDAYS 5, FREQUENCYMINUTES 30</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">LAGREPORTHOURS 1</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">LAGINFOMINUTES 30</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">LAGCRITICALMINUTES 45</span></span></code></pre>
</div><p>6. ÁîüÊàê defgen Êñá‰ª∂</p>
<p>Ôºà1ÔºâÁºñËæë defgen ÂèÇÊï∞Êñá‰ª∂</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">edit </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">param</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> defgen</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">defsfile </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">home</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">oracle</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">ogg_for_oracle</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">dirdef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">MES</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">def</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">userid goldengate, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">password</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Go2d_g8t</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">table</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> MESCARDUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">MES_CAR_CODE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">table</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> MESCARDUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">QK_POSITION</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">table</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> MESORDERUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">MES_CLAUSE_BASE_INFO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">table</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> MESORDERUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">MES_CLAUSE_BASE_INFO_SELECTED</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">table</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> MESORDERUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">MES_ELECTRIC_CODE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">table</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> MESSALESUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">SALES_APP_CODE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">table</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> MESSALESUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">SALES_APP_CODE_ELEC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">table</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> MESSALESUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">SALES_AREA_COMCODE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">table</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> MESSALESUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">SALES_CHANNEL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">table</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> MESSALESUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">SALES_COMPANY_COMMISSIONER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">table</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> MESSALESUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">SALES_IMG_TYPE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">table</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> MESSALESUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">SALES_IMG_TYPE_ELEC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">table</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> MESSALESUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">SALES_INTERACTION_COMMISSIONER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">table</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> MESSALESUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">SALES_MECHANISM_STAFF</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">table</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> MESSALESUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">SALES_SYSTEM_SOURCE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span></code></pre>
</div><p>Ôºà2ÔºâÁîüÊàê defgen Êñá‰ª∂</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">./defgen</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> paramfile</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ./dirprm/defgen.prm</span></span></code></pre>
</div><p>Ôºà3Ôºâ‰º†Ëæì defgen Ëá≥ TiDB Á´Ø ogg</p>
<ol start="7">
<li>Ê∑ªÂä†Ë°®Á∫ßÈôÑÂä†Êó•Âøó</li>
</ol>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">./ggsci</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">dblogin</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> userid</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> goldengate,password</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Go2d_g8t</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">¬†</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">add</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> trandata</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> MESORDERUSER.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">*</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">add</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> trandata</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> MESCARDUSER.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">*</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">add</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> trandata</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> MESCUSTOMERUSER.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">*</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">add</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> trandata</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> MESSALESUSER.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">*</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">¬†</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sqlplus</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> as</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> sysdba</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Select</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> *</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dba_log_groups</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> where</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> owner</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'MESORDERUSER'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'MESCARDUSER'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'MESCUSTOMERUSER'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'MESSALESUSER'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">);</span></span></code></pre>
</div><h3 id="ÁõÆÊ†áÁ´ØtidbÈÖçÁΩÆ" tabindex="-1">ÁõÆÊ†áÁ´ØTiDBÈÖçÁΩÆ <a class="header-anchor" href="#ÁõÆÊ†áÁ´ØtidbÈÖçÁΩÆ" aria-label="Permalink to &quot;ÁõÆÊ†áÁ´ØTiDBÈÖçÁΩÆ&quot;"></a></h3>
<ol>
<li>ÈÖçÁΩÆ TiDB ÂèÇÊï∞Ôºåedit-config ‰øÆÊîπÂπ∂ÈáçÂêØ TiDB ÁîüÊïà</li>
</ol>
<div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">binlog.enable</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">true</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">log.level</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">info</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">log.slow-threshold</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">300</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">lower-case-table-names</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">max-index-length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">6144</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">mem-quota-query</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">68719476736</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">oom-action</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">cancel</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">performance.max-procs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">performance.max-txn-ttl</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">7200000</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">performance.stats-lease</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">3s</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">performance.stmt-count-limit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">50000</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">performance.txn-total-size-limit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2147483648</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">pessimistic-txn.enable</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">true</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">pessimistic-txn.max-retry-count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">256</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">prepared-plan-cache.capacity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">100</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">prepared-plan-cache.enabled</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">false</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">prepared-plan-cache.memory-guard-ratio</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0.1</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">token-limit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">3000</span></span></code></pre>
</div><ol start="2">
<li>ÂàõÂª∫ ogg ÂêåÊ≠•Áî®Êà∑</li>
</ol>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> user</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> ogg33</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> identified </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">by</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'ogg'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">grant</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> all privileges </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">on</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> *</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">¬† to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ' ogg33'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">@</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'%'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> identified </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">by</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'ogg'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span></code></pre>
</div><p>3. ÈÖçÁΩÆ tidb_constraint_check_in_place ÁéØÂ¢ÉÂèòÈáè</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">set</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> global</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> tidb_constraint_check_in_place </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span></code></pre>
</div><h4 id="Ê∫êÁ´ØÂØπË±°Ëé∑Âèñ" tabindex="-1">Ê∫êÁ´ØÂØπË±°Ëé∑Âèñ <a class="header-anchor" href="#Ê∫êÁ´ØÂØπË±°Ëé∑Âèñ" aria-label="Permalink to &quot;Ê∫êÁ´ØÂØπË±°Ëé∑Âèñ&quot;"></a></h4>
<p></p>
<ol>
<li>Ê∫êÁ´ØÁî®Êà∑Á°ÆËÆ§</li>
</ol>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">MESORDERUSER,MESCARDUSER,MESCUSTOMERUSER,MESSALESUSER</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> username </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> dba_users </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> username </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'MESORDERUSER'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'MESCARDUSER'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'MESCUSTOMERUSER'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'MESSALESUSER'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">¬†</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">USERNAME</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">--------------------------------------------------------------------------------</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">MESSALESUSER</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">MESORDERUSER</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">MESCUSTOMERUSER</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">MESCARDUSER</span></span></code></pre>
</div><ol start="2">
<li>ÂØπË±°Ê¢≥ÁêÜ</li>
</ol>
<p>Ôºà1ÔºâÂØπË±°Êï¥‰ΩìÊÉÖÂÜµÔºåÊúâ table,index,sequence</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> owner</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,object_type,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> dba_objects </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">where</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> owner</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'MESORDERUSER'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'MESCARDUSER'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'MESCUSTOMERUSER'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'MESSALESUSER'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">group by</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> owner</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,object_type;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">MESORDERUSER ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† 	 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">INDEX</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† 	 86</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">MESCARDUSER¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†     </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">INDEX</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† 	 20</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">MESORDERUSER ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† 	 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">SEQUENCE</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† 	¬† 1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">MESCUSTOMERUSER ¬† ¬† ¬† ¬† ¬† 	         </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">TABLE</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† 	¬† 5</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">MESCARDUSER¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† LOB ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† 	¬† </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">7</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">MESORDERUSER ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† 	 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">TABLE</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† 	 25</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">MESORDERUSER ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† 	 LOB ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† 	 </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">11</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">MESORDERUSER ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† 	 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">TABLE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> PARTITION</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> ¬† ¬† ¬† ¬† 	106</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">MESCARDUSER¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">TABLE</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† 	¬† 7</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">MESCUSTOMERUSER ¬† ¬† ¬† ¬† ¬† 	         </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">INDEX</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† 	¬† 6</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">MESORDERUSER ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† 	 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">INDEX</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> PARTITION</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> ¬† ¬† ¬† ¬† 	156</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">MESORDERUSER ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† 	 LOB </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">PARTITION</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">¬† ¬† ¬† ¬† ¬† ¬† ¬† 	 95</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">MESCARDUSER¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†     </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">SEQUENCE</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† 	¬† 1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">MESSALESUSER¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† 	 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">TABLE</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† 	 15</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">MESSALESUSER¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† 	 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">INDEX</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† 	 18</span></span></code></pre>
</div><p>Ôºà2ÔºâÁ¥¢ÂºïÂèäË°®Êï∞ÈáèÊ£ÄÊü•</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">col </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">owner</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> a20</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> owner</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,object_type,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> dba_objects </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">where</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> owner</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'MESORDERUSER'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'MESCARDUSER'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'MESCUSTOMERUSER'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'MESSALESUSER'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">and</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> object_type </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'TABLE'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'INDEX'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)¬† </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">group by</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> owner</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,object_type </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">order by</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> owner</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,object_type;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">¬†</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">OWNER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">¬† ¬† ¬† ¬† ¬† ¬† 	OBJECT_TYPE ¬† ¬† ¬† ¬† ¬† 	</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">COUNT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">-------------------- ----------------------- ----------</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">MESCARDUSER¬† ¬† ¬† 	</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">INDEX</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† 	22</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">MESCARDUSER¬† ¬† ¬† 	</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">TABLE</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† 	8</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">MESCUSTOMERUSER¬† 	</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">INDEX</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† 	6</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">MESCUSTOMERUSER¬† 	</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">TABLE</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† 	5</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">MESORDERUSER ¬† ¬† 	</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">INDEX</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† 	86</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">MESORDERUSER ¬† ¬† 	</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">TABLE</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† 	25</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">MESSALESUSER ¬† ¬† 	</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">INDEX</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† 	18</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">MESSALESUSER ¬† ¬† 	</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">TABLE</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† 15</span></span></code></pre>
</div><p>Ôºà3ÔºâË°®ÁªìÊûÑËé∑Âèñ
‚ë† ÂØºÂá∫ Oracle Ë°®ÁªìÊûÑÂÖÉ‰ø°ÊÅØ</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">expdp \</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"/ as sysdba\"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> directory</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">EXP_DIR dumpfile</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">metadata</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">dump</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> logfile</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">metadata</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> schemas</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">MESCARDUSER,MESORDERUSER,MESCUSTOMERUSER,MESSALESUSER CONTENT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">METADATA_ONLY</span></span></code></pre>
</div><p>‚ë° Êê≠Âª∫ÊµãËØïÂ∫ì Oracle Âπ∂ÂØºÂÖ• dump Êñá‰ª∂</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">impdp \</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"/ as sysdba\"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> directory</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">expdp_dir dumpfile</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">metadata</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">dump</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> logfile</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">impdp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">log</span></span></code></pre>
</div><p>‚ë¢ ‰ªéÊµãËØïÂ∫ì‰ΩøÁî® navicat ÂØºÂá∫Ë°®ÂÆö‰πâ</p>
<p>ÂêåÊ≠•Áîü‰∫ßÊñá‰ª∂</p>
<p>Ôºà4ÔºâÊôÆÈÄöÁ¥¢ÂºïÊ¢≥ÁêÜ</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> long </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1000000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> pagesize </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> linesize </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">10000</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">spool </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">create_index</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">sql</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'ALTER TABLE '</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">||</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'`'</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">||</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">t1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">owner</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">||</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'`.`'</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">||</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">t1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">table_name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">||</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'` ADD INDEX `'</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">||</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">t1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">index_name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">||</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'`('</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">||</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">listagg(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'`'</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">||</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">t2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">column_name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">||</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'`'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">','</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">WITHIN</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> GROUP</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">ORDER BY</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> t2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">COLUMN_POSITION</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">||</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">');'</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> dba_indexes t1, dba_ind_columns t2</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">where</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> t1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">owner</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'MESORDERUSER'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'MESCARDUSER'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'MESCUSTOMERUSER'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'MESSALESUSER'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">and</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> t1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">index_type</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'NORMAL'</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">and</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> t1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">UNIQUENESS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'NONUNIQUE'</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">and</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> t2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">table_owner</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">t1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">owner</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">and</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> t2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">index_name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">t1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">index_name</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">and</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">t1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">owner</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">t1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">index_name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">not</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> owner</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,index_name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> dba_constraints </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> constraint_type</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'P'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">group by</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> t1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">owner</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">t1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">table_name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">t1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">index_name</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">union</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'ALTER TABLE '</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">||</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'`'</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">||</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">t1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">owner</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">||</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'`.`'</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">||</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">t1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">table_name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">||</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'` ADD UNIQUE INDEX `'</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">||</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">t1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">index_name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">||</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'`('</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">||</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">listagg(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'`'</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">||</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">t2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">column_name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">||</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'`'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">','</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">WITHIN</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> GROUP</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">ORDER BY</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> t2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">COLUMN_POSITION</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">||</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">');'</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> dba_indexes t1, dba_ind_columns t2</span></span></code></pre>
</div><p>Ôºà5ÔºâÂáΩÊï∞Á¥¢ÂºïÊ¢≥ÁêÜ</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">EXECUTE</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> DBMS_METADATA</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">SET_TRANSFORM_PARAM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">DBMS_METADATA</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">SESSION_TRANSFORM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'SEGMENT_ATTRIBUTES'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,false);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> owner</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,table_name,index_name,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">dbms_metadata</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">get_ddl</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'INDEX'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,index_name,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">owner</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) DDL </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> dba_indexes </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">where</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> owner</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">¬† (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'MESORDERUSER'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'MESCARDUSER'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'MESCUSTOMERUSER'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'MESSALESUSER'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">and</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> index_type</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'FUNCTION-BASED NORMAL'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">¬†</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">CREATE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> UNIQUEINDEX </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"MESORDERUSER"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"COMCODECLAUSE"</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> ON</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "ME SORDERUSER"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"MES_CLAUSE_BASE_INFO_SELECTED"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"COM_CODE"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"PR ODUCT_CODE"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"CLAUSE_CODE"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,DECODE(TO_NUMBER(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"SOURCE_TYPE"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">),</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"SOURCE_TYPE"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"SET _MEAL_NO"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">));</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> UNIQUE INDEX</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> "</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">MESORDERUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">".</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"USERDEFAULTCLAUSE"</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> ON</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "MESORDERUSER"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"MES_CLAUSE_BASE_INFO_SELECTED"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"USER_CODE"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> , </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"PRODUCT_CODE"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"CLAUSE_CODE"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, DECODE( TO_NUMBER(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"USER_DEFA ULT_FLAG"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">),</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"USER_D EFAULT_FLAG"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"SET_ME AL_NO"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">));</span></span></code></pre>
</div><p>Ôºà5Ôºâ‰ΩçÂõæÁ¥¢ÂºïÊ¢≥ÁêÜ</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">EXECUTE</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> DBMS_METADATA</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">SET_TRANSFORM_PARAM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">DBMS_METADATA</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">SESSION_TRANSFORM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'SEGMENT_ATTRIBUTES'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,false);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> owner</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,table_name,index_name,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">dbms_metadata</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">get_ddl</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'INDEX'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,index_name,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">owner</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) DDL </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> dba_indexes </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">where</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> owner</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">¬† (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'MESORDERUSER'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'MESCARDUSER'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'MESCUSTOMERUSER'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'MESSALESUSER'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">and</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> index_type</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'BITMAP'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span></code></pre>
</div><p>Ôºà6Ôºâsequence ÂÆö‰πâËé∑Âèñ</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> dbms_metadata</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">get_ddl</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'SEQUENCE'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,SEQUENCE_NAME,sequence_owner) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> dba_sequences </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> sequence_owner </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'MESORDERUSER'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'MESCARDUSER'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'MESCUSTOMERUSER'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'MESSALESUSER'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">¬†</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> SEQUENCE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">¬† `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">MESCARDUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">`.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`SEQ_MES_CAR_CODE_ID`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">¬† MINVALUE </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> MAXVALUE </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">99999999</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> INCREMENT </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">BY</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> START</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> WITH</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> NOCYCLE;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">¬†</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> SEQUENCE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">¬† `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">MESORDERUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">`.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`SEQ_MES_ELECTRIC_CODE_ID`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">¬† MINVALUE </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> MAXVALUE </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">99999999</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> INCREMENT </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">BY</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> START</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> WITH</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">¬† NOCYCLE;</span></span></code></pre>
</div><p>Ôºà7Ôºâcomments ÂÆö‰πâËé∑Âèñ</p>
<ol start="3">
<li>Ë°®ÂØπË±°Ê¢≥ÁêÜ</li>
</ol>
<p>Ôºà1ÔºâÊï∞ÊçÆÈáèÊ¢≥ÁêÜ</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> sum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(bytes</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1024</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1024</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1024</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">),</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">owner</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,segment_name,segment_type </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> dba_segments </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">where</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> owner</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'MESORDERUSER'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'MESCARDUSER'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'MESCUSTOMERUSER'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'MESSALESUSER'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">group by</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> owner</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,segment_name,segment_type </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">order by</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> sum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(bytes</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1024</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1024</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1024</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">desc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> rownum</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">&#x3C;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">11</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">¬†</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">¬†</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">SUM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(BYTES</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1024</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1024</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1024</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">OWNER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">¬† ¬† ¬† ¬† ¬† ¬† 	SEGMENT_NAME ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† 	¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† SEGMENT_TYPE</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">------------------------- -------------------- -------------------------------------------------------------------------------------------------------------------------------- ------------------</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†	301</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">903992</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> MESORDERUSER ¬† ¬† 	MES_CLAUSE_INFO¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">TABLE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> PARTITION</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†	153</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">866333</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> MESCARDUSER¬† ¬† ¬† 	SYS_LOB0000073399C00002$$¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† LOBSEGMENT</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†	92</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">6340942</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> MESORDERUSER ¬† ¬† 	PK_MES_CLAUSE_INFO12_NEW¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† 	 ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">INDEX</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†	80</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0906372</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> MESORDERUSER ¬† ¬† 	IDX_MES_CLAUSE_INFO__ORDER_NO12¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">INDEX</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> PARTITION</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†	76</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2442017</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> MESORDERUSER ¬† ¬† 	MES_CLAUSE_INFO11¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">TABLE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> PARTITION</span></span></code></pre>
</div><p>Ôºà2ÔºâÈúÄË¶ÅÂêåÊ≠•Êï∞ÊçÆË°®Ê¢≥ÁêÜ</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> owner</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,segment_name,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">sum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(bytes</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1024</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1024</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1024</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> dba_segments </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">owner=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'MESCARDUSER'</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> and</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> segment_name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'MES_CAR_CODE'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'QK_POSITION'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">))</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">or</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">owner=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'MESORDERUSER'</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> and</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> segment_name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'MES_CLAUSE_BASE_INFO'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'MES_CLAUSE_BASE_INFO_SELECTED'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'MES_ELECTRIC_CODE'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">))</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">or</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">owner=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'MESSALESUSER'</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> and</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> segment_name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'SALES_APP_CODE'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'SALES_APP_CODE_ELEC'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'SALES_AREA_COMCODE'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'SALES_CHANNEL'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'SALES_COMPANY_COMMISSIONER'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'SALES_IMG_TYPE'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'SALES_IMG_TYPE_ELEC'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'SALES_INTERACTION_COMMISSIONER'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'SALES_MECHANISM_STAFF'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'SALES_SYSTEM_SOURCE'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">))</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">group by</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> owner</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,segment_name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">order by</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> sum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(bytes</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1024</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1024</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1024</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">desc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">¬†</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">OWNER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">¬† ¬† ¬† ¬† ¬† ¬† 	SEGMENT_NAME ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">SUM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(BYTES</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1024</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1024</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1024</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">-------------------- -------------------------------------------------------------------------------------------------------------------------------- -------------------------</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">MESORDERUSER ¬† ¬† 	MES_CLAUSE_BASE_INFO_SELECTED ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† .</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">026367188</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">MESSALESUSER ¬† ¬† 	SALES_INTERACTION_COMMISSIONER¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† .</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">001953125</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">MESCARDUSER¬† ¬† ¬† 	MES_CAR_CODE</span></span></code></pre>
</div><p></p>
<h3 id="ÁõÆÊ†áÁ´ØÂØπË±°Âª∫Á´ã" tabindex="-1">ÁõÆÊ†áÁ´ØÂØπË±°Âª∫Á´ã <a class="header-anchor" href="#ÁõÆÊ†áÁ´ØÂØπË±°Âª∫Á´ã" aria-label="Permalink to &quot;ÁõÆÊ†áÁ´ØÂØπË±°Âª∫Á´ã&quot;"></a></h3>
<p></p>
<ol>
<li>Âª∫Â∫ì</li>
</ol>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> database</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> MESORDERUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> database</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> MESCARDUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> database</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> MESCUSTOMERUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> database</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> MESSALESUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span></code></pre>
</div><ol start="2">
<li>Âª∫Áî®Êà∑ÊéàÊùÉ</li>
</ol>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> user</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> MESCARDUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">@</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'%'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> identified </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">by</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "Mescard!3435Yonghu"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> user</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> MESORDERUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">@</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'%'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> identified </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">by</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "Mesorder!3435Yonghu"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> user</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> MESCUSTOMERUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">@</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'%'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> identified </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">by</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "Mescustomer!3435Yonghu"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> user</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> MESSALESUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">@</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'%'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> identified </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">by</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "Messales!3435Yonghu"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">grant</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> all </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">on</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> MESCARDUSER.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> to</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> MESCARDUSER@</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'%'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">grant</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> all </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">on</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> MESORDERUSER.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> to</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> MESORDERUSER@</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'%'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">grant</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> all </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">on</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> MESCUSTOMERUSER.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> to</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> MESCUSTOMERUSER@</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'%'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">grant</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> all </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">on</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> MESSALESUSER.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> to</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> MESSALESUSER@</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'%'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span></code></pre>
</div><ol start="3">
<li>‰øÆÊîπOracle Êï¥ÁêÜÁöÑË°®ÁªìÊûÑËÑöÊú¨ÔºåÂèÇËÄÉ‰ª•‰∏ãËßÑÂàôÔºåÂª∫ËÆÆ‰ΩøÁî® UE ÊõøÊç¢</li>
</ol>
<p>Ôºà1ÔºâÂàóÊò†Â∞ÑËßÑÂàô</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">number</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> -></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> decimal</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">varchar2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> -></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> varchar</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">clob </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> longtext</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">date</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> -></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> datetime</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">number</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> decimal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">number</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> bigint</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">decimal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">Ôºà</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">65</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">ÔºâÊ†πÊçÆ‰∏öÂä°ÈúÄÊ±Ç‰øÆÊîπ‰∏∫ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">bigint</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">text</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ÈúÄË¶ÅÁâπÊÆäÊ≥®ÊÑè</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">Ê®°Á≥äÊõøÊç¢ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">decimal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">([0-9], </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) ÊàñËÄÖ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">decimal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">([0-9][1-9], </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) ‰∏∫ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">bigint</span></span></code></pre>
</div><p>Ôºà2Ôºâpk int -&gt; unique key
Ôºà3ÔºâÂ¢ûÂä† shard_row_id_bits=4 pre_split_regions=3 ÊâìÊï£Â±ûÊÄß„ÄÇ
Ôºà4ÔºâÂÖ®ÈÉ®Â≠óÁ¨¶ËΩ¨Êç¢‰∏∫Â§ßÂÜô„ÄÇ
4. Âª∫Á´ãË°®ÂíåÁõ∏ÂÖ≥Á¥¢Âºï</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> mescarduser;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">source </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">mescarduser</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">sql</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> mesorderuser;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">source </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">mesorderuser</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">sql</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> mescustomeruser;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">source </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">mescustomeruser</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">sql</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> messalesuser;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">source </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">messalesuser</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">sql</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">source </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">create_index</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">txt</span></span></code></pre>
</div><ol start="5">
<li>È™åËØÅË°®ÂàõÂª∫</li>
</ol>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">distinct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> table_name) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> information_schema</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">tables</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> where</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> schema</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'MESORDERUSER'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">¬†</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">distinct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> table_name) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> information_schema</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">tables</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> where</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> schema</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'MESCARDUSER'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">¬†</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">distinct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> table_name) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> information_schema</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">tables</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> where</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> schema</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'MESCUSTOMERUSER'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">¬†</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">distinct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> table_name) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> information_schema</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">tables</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> where</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> schema</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'MESSALESUSER'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span></code></pre>
</div><p>6. Âª∫Á´ã sequence</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> SEQUENCE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">¬† `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">MESCARDUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">`.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`SEQ_MES_CAR_CODE_ID`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">¬† MINVALUE </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> MAXVALUE </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">99999999</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> INCREMENT </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">BY</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> START</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> WITH</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> NOCYCLE;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">¬†</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> SEQUENCE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">¬† `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">MESORDERUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">`.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`SEQ_MES_ELECTRIC_CODE_ID`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">¬† MINVALUE </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> MAXVALUE </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">99999999</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> INCREMENT </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">BY</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> START</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> WITH</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">¬† NOCYCLE;</span></span></code></pre>
</div><p><span style="color: red">Ê≥®ÊÑèÔºöÂàáÊç¢Êó∂ÈúÄË¶ÅÂú®TiDBÂ§áÂ∫ìÁ´Ø‰øÆÊîπsequenceÂΩìÂâçÂÄºÔºõ
SELECT setval(SEQ_MES_CAR_CODE_ID, Oracle );
SELECT setval(SEQ_MES_ELECTRIC_CODE_ID, 10);
</span></p>
<p>7.ÂêåÊ≠•Ë°®Â§ßÂ∞èÁ°ÆËÆ§ÔºåÊÄªÂÖ± 260MB„ÄÇ</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">MESORDERUSER¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† 	 MES_CLAUSE_BASE_INFO_SELECTED¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† 	 ¬† 	 ¬† .</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0234375</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">MESSALESUSER ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† 	 SALES_INTERACTION_COMMISSIONER ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† 	 .</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">001953125</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">MESCARDUSER¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† 	 MES_CAR_CODE¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† 	 .</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">000366211</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">MESORDERUSER¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† 	 MES_CLAUSE_BASE_INFO¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† 	 .</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">000183105</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">MESSALESUSER ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† 	 SALES_MECHANISM_STAFF ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† 	¬† .</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00012207</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">MESSALESUSER ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† 	 SALES_COMPANY_COMMISSIONER¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† 	 .</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">000061035</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">MESSALESUSER ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† 	 SALES_IMG_TYPE¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† 	 .</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">000061035</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">MESSALESUSER ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† 	 SALES_AREA_COMCODE¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† 	 .</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">000061035</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">MESCARDUSER¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† 	 QK_POSITION¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† 	 .</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">000061035</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">MESSALESUSER ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† 	 SALES_APP_CODE_ELEC</span></span></code></pre>
</div><h4 id="ÁõÆÊ†áÁ´ØoggÂÆâË£Ö" tabindex="-1">ÁõÆÊ†áÁ´ØOGGÂÆâË£Ö <a class="header-anchor" href="#ÁõÆÊ†áÁ´ØoggÂÆâË£Ö" aria-label="Permalink to &quot;ÁõÆÊ†áÁ´ØOGGÂÆâË£Ö&quot;"></a></h4>
<p>1.ÂàõÂª∫ÁõÆÂΩï„ÄÅ‰∏ä‰º† 19c OGG for oracle on linuxÂÆâË£ÖÂåÖ</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">su</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">mkdir</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /data/ogg_for_mysql</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /data/ogg_for_mysql</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">./ggsci</span></span></code></pre>
</div><p>2. ÈÖçÁΩÆ mgr</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">edit params mgr</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">¬†</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">PORT </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">7809</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">¬† 	</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">DYNAMICPORTLIST </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">7810</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">7889</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">AUTOSTART ER </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">AUTORESTART EXTRACT </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,RETRIES </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,WAITMINUTES </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">3</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">ACCESSRULE, PROG </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, IPADDR </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, ALLOW</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">PURGEOLDEXTRACTS .</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">dirdat</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">/*,usecheckpoints, minkeepdays 7</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">--PURGEDDLHISTORY MINKEEPDAYS 3, MAXKEEPDAYS 5, FREQUENCYMINUTES 30</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">--PURGEMARKERHISTORY MINKEEPDAYS 3, MAXKEEPDAYS 5, FREQUENCYMINUTES 30</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">LAGREPORTHOURS 1</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">LAGINFOMINUTES 30</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">LAGCRITICALMINUTES 45</span></span></code></pre>
</div><ol start="3">
<li>ÈÖçÁΩÆGLOBALS</li>
</ol>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">edit params .</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">GLOBALS</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">checkpointtable </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">ogg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">ggs_checkpoint</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">ALLOWOUTPUTDIR </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/data/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">ogg_for_mysql</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">¬†</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">dblogin sourcedb MESCARDUSER@9.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">23</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">17</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">4000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,userid ogg33,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">password</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ogg</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">¬†</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> checkpointtable </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">ogg33</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">ggs_checkpoint</span></span></code></pre>
</div><ol start="4">
<li>ÂàõÂª∫ÁõÆÂΩï</li>
</ol>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">ggsic</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> subdirs</span></span></code></pre>
</div><p></p>
<h4 id="ÈÖçÁΩÆÂ¢ûÈáèÂêåÊ≠•" tabindex="-1">ÈÖçÁΩÆÂ¢ûÈáèÂêåÊ≠• <a class="header-anchor" href="#ÈÖçÁΩÆÂ¢ûÈáèÂêåÊ≠•" aria-label="Permalink to &quot;ÈÖçÁΩÆÂ¢ûÈáèÂêåÊ≠•&quot;"></a></h4>
<ol>
<li>Ê∫êÁ´ØÈÖçÁΩÆÂ¢ûÈáèextract</li>
</ol>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">ggsci</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">¬†</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">ADD</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> EXTRACT extcx </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">INTEGRATED</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> TRANLOG, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">BEGIN</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> NOW</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> exttrail .</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">dirdat</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">cx,extract extcx,MEGABYTES </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">100</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">¬†</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">register extract extcx </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">database</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">¬†</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">edit params extcx</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">¬†</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">extract extcx</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">setenv (NLS_LANG</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">AMERICAN_AMERICA</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">AL32UTF8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">userid goldengate, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">password</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Go2d_g8t</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">--tranlogoptions excludeuser ogg</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">--TRANLOGOPTIONS INTEGRATEDPARAMS (max_sga_size 15000, parallelism 6)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">exttrail .</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">dirdat</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">cx</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">DISCARDFILE .</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">dirrpt</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">cx</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">dsc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">APPEND</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,MEGABYTES </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">10</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">NOCOMPRESSUPDATES</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">--ThreadOptions MaxCommitPropagationDelay 10000 IOLatency 3000</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">CACHEMGR CACHESIZE 16G</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">BR BROFF</span></span></code></pre>
</div><p>2. Ê∫êÁ´ØÈÖçÁΩÆpumpÊäïÈÄíËøõÁ®ã</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">ggsci</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> extract pumpcx ,exttrailsource .</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">dirdat</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">cx,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">begin</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> now</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">¬†</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> rmttrail </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/data/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">ogg_for_mysql</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">dirdat</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">rd ,extract pumpcx</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">¬†</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">edit params pumpcx</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">¬†</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">extract pumpcx</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">setenv (NLS_LANG</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">AMERICAN_AMERICA</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">AL32UTF8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">dynamicresolution</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">passthru</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">userid goldengate, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">password</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Go2d_g8t</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">rmthost </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">9</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">23</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">17</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,mgrport </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">7809</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,TCPBUFSIZE </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">120000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, TCPFLUSHBYTES </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">120000</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">rmttrail </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/data/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">ogg_for_mysql</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">dirdat</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">rd</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">table</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> MESCARDUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">MES_CAR_CODE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">table</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> MESCARDUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">QK_POSITION</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">table</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> MESORDERUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">MES_CLAUSE_BASE_INFO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">table</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> MESORDERUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">MES_CLAUSE_BASE_INFO_SELECTED</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">table</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> MESORDERUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">MES_ELECTRIC_CODE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">table</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> MESSALESUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">SALES_APP_CODE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span></code></pre>
</div><ol start="3">
<li>TiDB Ëé∑Âèñ replicate Á´Ø COLMAP</li>
</ol>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">MySQL [(none)]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> set</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> session</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> group_concat_max_len</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'4096'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">¬†</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">MySQL [(none)]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> show variables </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">like</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> '%concat%'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">----------------------+-------+</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| Variable_name¬† ¬† 	| </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">Value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">----------------------+-------+</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| group_concat_max_len | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">4096</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">¬† |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">----------------------+-------+</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> table_name,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">       concat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'MAP '</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">upper</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(TABLE_SCHEMA),</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'.'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">upper</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(TABLE_NAME),</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">', TARGET '</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">upper</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(TABLE_SCHEMA),</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'.'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">upper</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(TABLE_NAME),</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">',COLMAP ( usedefaults,'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">              group_concat(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">concat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(column_name,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                  '=@IF(@COLTEST('</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                  column_name,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                  ',PRESENT),'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                  column_name,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                  ',@COLSTAT(MISSING))'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) separator </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">','</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">),</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">              ');'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  from</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> information_schema</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">columns</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> IS_NULLABLE </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'YES'</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">   and</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (table_schema </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'kcwl_aggregate'</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> and</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> table_name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'app_aggregate_rule'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'app_api_info'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)) </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">   -- fill information of the first schema and tables</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">   or</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (table_schema</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'MESORDERUSER'</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> and</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> table_name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'MES_CLAUSE_BASE_INFO'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'MES_CLAUSE_BASE_INFO_SELECTED'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'MES_ELECTRIC_CODE'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)) </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">   -- fill information of the second√ü schema and tables</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> group by</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> TABLE_SCHEMA,table_name</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> order by</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> table_name;</span></span></code></pre>
</div><p></p>
<h3 id="ÁõÆÊ†áÁ´ØÈÖçÁΩÆÂ¢ûÈáèreplicate" tabindex="-1">ÁõÆÊ†áÁ´ØÈÖçÁΩÆÂ¢ûÈáèreplicate <a class="header-anchor" href="#ÁõÆÊ†áÁ´ØÈÖçÁΩÆÂ¢ûÈáèreplicate" aria-label="Permalink to &quot;ÁõÆÊ†áÁ´ØÈÖçÁΩÆÂ¢ûÈáèreplicate&quot;"></a></h3>
<p>1.Â¢ûÂä†Â¢ûÈáè replicate ÈÖçÁΩÆ</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> replicat repcx ,exttrail </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/data/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">ogg_for_mysql</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">dirdat</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">rd,checkpointtable </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">ogg33</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">ggs_checkpoint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">begin</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> now</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">¬†</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">edit params repcx</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">¬†</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">replicat repcx</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">SETENV(NLS_LANG</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">AMERICAN_AMERICA</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">ZHS16GBK</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">handlecollisions</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">sourcecharset AL32UTF8</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">reperror(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">default</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,discard)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">DISCARDFILE .</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">dirrpt</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">repcx</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">dsc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">APPEND</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, MEGABYTES </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">100</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">targetdb ogg@9.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">23</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">17</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">4000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> userid ogg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">password</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ogg</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">sourcedefs </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/data/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">ogg</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">dirdef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">MES</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">def</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">MAP </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">MESCARDUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">MES_CAR_CODE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">TARGET</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> MESCARDUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">MES_CAR_CODE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,COLMAP ( usedefaults,PARENT_KIND</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">@IF(@COLTEST(PARENT_KIND,PRESENT),PARENT_KIND,@COLSTAT(MISSING)),</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">NAME=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">@IF(@COLTEST(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">NAME</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,PRESENT),</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">NAME</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,@COLSTAT(MISSING)),</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">TYPE=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">@IF(@COLTEST(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">TYPE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,PRESENT),</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">TYPE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,@COLSTAT(MISSING)),LEVELS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">@IF(@COLTEST(LEVELS,PRESENT),LEVELS,@COLSTAT(MISSING)));</span></span></code></pre>
</div><p></p>
<h3 id="Ê∫êÁ´ØÊ£ÄÊü•ÂΩíÊ°£Êó•Âøó" tabindex="-1">Ê∫êÁ´ØÊ£ÄÊü•ÂΩíÊ°£Êó•Âøó <a class="header-anchor" href="#Ê∫êÁ´ØÊ£ÄÊü•ÂΩíÊ°£Êó•Âøó" aria-label="Permalink to &quot;Ê∫êÁ´ØÊ£ÄÊü•ÂΩíÊ°£Êó•Âøó&quot;"></a></h3>
<p>Á°Æ‰øùÂ¢ûÈáèÊäΩÂèñËøõÁ®ãÁöÑÊó∂Èó¥ÁÇπÔºåÊâÄÂú®Âå∫Èó¥ÁöÑÂΩíÊ°£Êó•ÂøóÊ≤°ÊúâË¢´Âà†Èô§Ôºõ</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> FIRST_TIME,DELETED </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> v$archived_log</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> first_time</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">>=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">to_date(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'2021-03-17 18:00:00'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'yyyy-mm-dd hh24:mi:ss'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">order by</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> first_time </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">asc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> rownum</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">&#x3C;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">¬†</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">strings </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">archived</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">|less¬† Á¨¨‰∏ÄË°åÊï∞Â∞±ÊòØscnÔºåÂ¶Ç34607271</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">¬†</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> to_char(scn_to_timestamp(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">34607271</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">), </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'yyyy-mm-dd hh24:mi:ss'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)¬† </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> dual;</span></span></code></pre>
</div><p></p>
<h3 id="ÈÖçÁΩÆÂÖ®ÈáèÂêåÊ≠•" tabindex="-1">ÈÖçÁΩÆÂÖ®ÈáèÂêåÊ≠• <a class="header-anchor" href="#ÈÖçÁΩÆÂÖ®ÈáèÂêåÊ≠•" aria-label="Permalink to &quot;ÈÖçÁΩÆÂÖ®ÈáèÂêåÊ≠•&quot;"></a></h3>
<p>1.Ê∫êÁ´ØÂ¢ûÂä†ÂÖ®ÈáèÊäΩÂèñ extract ËøõÁ®ã</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> extract initext,sourceistable</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">¬†</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">edit params initext</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">¬†</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">extract initext</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">userid goldengate, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">password</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Go2d_g8t</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">rmthost </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">9</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">23</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">17</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, mgrport </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">8809</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">rmttask replicat,group initrep</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">table</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> MESCARDUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">MES_CAR_CODE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">table</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> MESCARDUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">QK_POSITION</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">table</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> MESORDERUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">MES_CLAUSE_BASE_INFO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">table</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> MESORDERUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">MES_CLAUSE_BASE_INFO_SELECTED</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">table</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> MESORDERUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">MES_ELECTRIC_CODE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">table</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> MESSALESUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">SALES_APP_CODE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">table</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> MESSALESUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">SALES_APP_CODE_ELEC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">table</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> MESSALESUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">SALES_AREA_COMCODE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">table</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> MESSALESUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">SALES_CHANNEL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">table</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> MESSALESUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">SALES_COMPANY_COMMISSIONER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">table</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> MESSALESUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">SALES_IMG_TYPE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">table</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> MESSALESUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">SALES_IMG_TYPE_ELEC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span></code></pre>
</div><p>2.ÁõÆÊ†áÁ´ØÂ¢ûÂä†ÂÖ®ÈáèÂ§çÂà∂ replicateËøõÁ®ã</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> replicat initrep,specialrun</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">¬†</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">edit params initrep</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">¬†</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">replicat initrep</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">SETENV(NLS_LANG</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">SIMPLIFIED </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">CHINESE_CHINA</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">ZHS16GBK</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">handlecollisions</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">reperror(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">default</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,discard)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">SOURCECHARSET AL32UTF8</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">DISCARDFILE .</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">dirrpt</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">repint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">dsc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">APPEND</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, MEGABYTES </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">100</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">targetdb ogg33@9.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">23</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">17</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">4000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> userid ogg33 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">password</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ogg</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">sourcedefs </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">mdata</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">ogg_for_mysql</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">dirdef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">MES</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">def</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">MAP </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">MESCARDUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">MES_CAR_CODE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">TARGET</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> MESCARDUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">MES_CAR_CODE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,COLMAP ( usedefaults,PARENT_KIND</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">@IF(@COLTEST(PARENT_KIND,PRESENT),PARENT_KIND,@COLSTAT(MISSING)),</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">NAME=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">@IF(@COLTEST(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">NAME</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,PRESENT),</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">NAME</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,@COLSTAT(MISSING)),</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">TYPE=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">@IF(@COLTEST(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">TYPE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,PRESENT),</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">TYPE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,@COLSTAT(MISSING)),LEVELS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">@IF(@COLTEST(LEVELS,PRESENT),LEVELS,@COLSTAT(MISSING)));</span></span></code></pre>
</div><p></p>
<h4 id="ÂêØÂä®ÂÖ®ÈáèÂêåÊ≠•" tabindex="-1">ÂêØÂä®ÂÖ®ÈáèÂêåÊ≠• <a class="header-anchor" href="#ÂêØÂä®ÂÖ®ÈáèÂêåÊ≠•" aria-label="Permalink to &quot;ÂêØÂä®ÂÖ®ÈáèÂêåÊ≠•&quot;"></a></h4>
<ol>
<li>Ê∫êÁ´ØÂêØÂä® extinit</li>
</ol>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">ggsci</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">start</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> initext</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">stats</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> initext</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">¬†</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">info initext</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">EXTRACT	INITEXT ¬† </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">Last</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> Started</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 2020</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">12</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">17</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 19</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">18</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> ¬† Status</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> STOPPED</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">......</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">......</span></span></code></pre>
</div><ol start="2">
<li>ËßÇÂØüËá≥ÂÖ®ÈáèÁªìÊùü</li>
</ol>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">ggsci</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">Info initext</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">¬†</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">Info initrep</span></span></code></pre>
</div><h4 id="ÂêØÂä®Â¢ûÈáèÂêåÊ≠•" tabindex="-1">ÂêØÂä®Â¢ûÈáèÂêåÊ≠• <a class="header-anchor" href="#ÂêØÂä®Â¢ûÈáèÂêåÊ≠•" aria-label="Permalink to &quot;ÂêØÂä®Â¢ûÈáèÂêåÊ≠•&quot;"></a></h4>
<ol>
<li>Á°ÆÂÆöÂÖ®ÈáèÂêåÊ≠•Ëµ∑ÂßãÁÇπ</li>
</ol>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">info initext</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">¬†</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">EXTRACT	INITEXT ¬† </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">Last</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> Started</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 2020</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">12</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">17</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 19</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">18</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> ¬† Status</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> STOPPED</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">Checkpoint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Lag ¬† 	</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">Not</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Available</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">Log</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> Read</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> Checkpoint</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">¬† Table</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> XXX</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†	2020</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">12</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">18</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">18</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">04</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">¬† Record </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">174812</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">Task ¬† ¬† ¬† ¬† ¬† ¬† 	SOURCEISTABLE</span></span></code></pre>
</div><ol start="2">
<li>‰øÆÊîπÊ∫êÁ´ØÁõÆÊ†áÁ´ØÂ¢ûÈáèËøõÁ®ãÂºÄÂßãÊó∂Èó¥</li>
</ol>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">ALTER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> EXTRACT extcx¬† ,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">begin</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 2021</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">17</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 22</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">ALTER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> EXTRACT pumpcx ,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">begin</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 2021</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">17</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 22</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">ALTER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> replicat repcx ,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">begin</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 2021</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">18</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 01</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span></span></code></pre>
</div><p></p>
<ol start="3">
<li>Ê∫êÁ´ØÂêØÂä® extract Âíå pump ËøõÁ®ã</li>
</ol>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">start</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> extcx</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">start</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> pumpcx</span></span></code></pre>
</div><p>4. ÁõÆÊ†áÁ´ØÂêØÂä® replicate Â∫îÁî®ËøõÁ®ã</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">start</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> repcx</span></span></code></pre>
</div><p></p>
<ol start="5">
<li>Ê£ÄÊü•ÂêåÊ≠•ËøõÂ∫¶ÂíåÁä∂ÊÄÅ</li>
</ol>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">stats</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> repcx</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">info repcx</span></span></code></pre>
</div><p></p>
<h2 id="Ê≠£Á°ÆÊÄßÈ™åËØÅ" tabindex="-1">Ê≠£Á°ÆÊÄßÈ™åËØÅ <a class="header-anchor" href="#Ê≠£Á°ÆÊÄßÈ™åËØÅ" aria-label="Permalink to &quot;Ê≠£Á°ÆÊÄßÈ™åËØÅ&quot;"></a></h2>
<ol>
<li>Êï∞ÊçÆÂ∫ìÈ™åËØÅ</li>
</ol>
<ul>
<li>Á¥¢ÂºïÈ™åËØÅ</li>
</ul>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">Select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> table_schema,table_name,KEY_NAME </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> information_schema</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">TiDB_INDEXES</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  table_name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'MES_CAR_CODE'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'QK_POSITION'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'MES_CLAUSE_BASE_INFO'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,   </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'MES_CLAUSE_BASE_INFO_SELECTED'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'MES_ELECTRIC_CODE'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'SALES_APP_CODE'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,   </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'SALES_APP_CODE_ELEC'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'SALES_AREA_COMCODE'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'SALES_CHANNEL'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,   </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'SALES_COMPANY_COMMISSIONER'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'SALES_IMG_TYPE'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'SALES_IMG_TYPE_ELEC'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,   </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'SALES_INTERACTION_COMMISSIONER'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'SALES_MECHANISM_STAFF'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'SALES_SYSTEM_SOURCE'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)  </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">group by</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> table_schema,table_name,KEY_NAME;</span></span></code></pre>
</div><p></p>
<ul>
<li>Êï∞ÊçÆÈáèÈ™åËØÅ</li>
</ul>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> # Ê∫êÁ´Ø ÁõÆÊ†áÁ´Ø ÂàÜÂà´È™åËØÅ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> select</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> MESCARDUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">MES_CAR_CODE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> select</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> MESORDERUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">MES_CLAUSE_BASE_INFO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> select</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> MESORDERUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">MES_CLAUSE_BASE_INFO_SELECTED</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> select</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> MESORDERUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">MES_ELECTRIC_CODE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> select</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> MESCARDUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">QK_POSITION</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> select</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> MESSALESUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">SALES_APP_CODE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> select</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> MESSALESUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">SALES_APP_CODE_ELEC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> select</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> MESSALESUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">SALES_AREA_COMCODE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> select</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> MESSALESUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">SALES_CHANNEL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> select</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> MESSALESUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">SALES_COMPANY_COMMISSIONER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> select</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> MESSALESUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">SALES_IMG_TYPE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> select</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> MESSALESUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">SALES_IMG_TYPE_ELEC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> select</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> MESSALESUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">SALES_INTERACTION_COMMISSIONER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> select</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> MESSALESUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">SALES_MECHANISM_STAFF</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> select</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> MESSALESUSER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">SALES_SYSTEM_SOURCE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span></code></pre>
</div><ol start="2">
<li>OGGÈ™åËØÅ</li>
</ol>
<ul>
<li>
<p>oggËøõÁ®ãÈ™åËØÅ</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">ggsci</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">info all</span></span></code></pre>
</div></li>
<li>
<p>Êü•ÁúãÊó•Âøó</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tail</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -100f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ggserr.log</span></span></code></pre>
</div></li>
</ul>
<ol start="3">
<li>‰∏öÂä°È™åËØÅÊµÅÁ®ãÊû∂ÊûÑ</li>
</ol>
<ul>
<li>‰∏öÂä°È™åËØÅÂÜÖÂÆπ</li>
</ul>
<p></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[TiDB run and debug on M1]]></title>
            <link>https://askaric.com/zh/work/tidb/07TiDB-Ê∫êÁ†ÅÈòÖËØª/7-1TiDB/01TiDB run and debug on M1.html</link>
            <guid>https://askaric.com/zh/work/tidb/07TiDB-Ê∫êÁ†ÅÈòÖËØª/7-1TiDB/01TiDB run and debug on M1.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[‰∏Ä„ÄÅSummary

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ââç‰∏ç‰πÖÂàöÊç¢ Mac M1 Êó∂Ôºå‰∏çÁ¶ÅË¢´Ëá™Â∑±ÁöÑÁõ≤ÁõÆÁöÑ ‚ÄúÂêÉËûÉËüπü¶ÄÔ∏èË°å‰∏∫‚Äù Ë†¢Âì≠‰∫Ü]]></description>
            <content:encoded><![CDATA[<h1 id="tidb-run-and-debug-on-m1" tabindex="-1">TiDB run and debug on M1 <a class="header-anchor" href="#tidb-run-and-debug-on-m1" aria-label="Permalink to &quot;TiDB run and debug on M1&quot;"></a></h1>
<h2 id="‰∏Ä„ÄÅsummary" tabindex="-1">‰∏Ä„ÄÅSummary <a class="header-anchor" href="#‰∏Ä„ÄÅsummary" aria-label="Permalink to &quot;‰∏Ä„ÄÅSummary&quot;"></a></h2>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ââç‰∏ç‰πÖÂàöÊç¢ Mac M1 Êó∂Ôºå‰∏çÁ¶ÅË¢´Ëá™Â∑±ÁöÑÁõ≤ÁõÆÁöÑ ‚ÄúÂêÉËûÉËüπü¶ÄÔ∏èË°å‰∏∫‚Äù Ë†¢Âì≠‰∫Ü„ÄÇÁî±‰∫é M1 ÁöÑÊòØ arm ÊúçÂä°Âô®ÔºåÂú®ÂÅöÂêÑÁßçÊï∞ÊçÆÂ∫ìÊµãËØïÊó∂Êê≠Âª∫Êú¨Âú∞ÁéØÂ¢ÉÂæàÊòØ‰∏ç‰æøÔºåÂ∞§ÂÖ∂ÊòØ DEBUG Êï∞ÊçÆÂ∫ì‰ª£Á†Å„ÄÇ</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>ÊàëÊõæÂÅöËøáÂ¶Ç‰∏ãÂ∞ùËØïÔºö</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1. Âú®ËøúÁ®ãÂÆ∂‰∏≠ windows Êê≠Âª∫ËôöÊãüÊú∫ÔºåË¥≠‰π∞ËÖæËÆØ‰∫ëÊúçÂä°Âô®‰Ωú‰∏∫‰∏≠Èó¥Ë∑≥ÊùøÊú∫Ôºå‰ΩøÁî® frp ËΩØ‰ª∂Á©øÈÄèÂÜÖÁΩëÊò†Â∞ÑËôöÊãüÊú∫ IP Ëá≥‰∫ëÊúçÂä°Âô® IPÔºö<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ‰ºòÁÇπÔºöOracle„ÄÅTiDB„ÄÅMySQL„ÄÅPG ÈöèÊú∫Êê≠Âª∫Ôºå‰∏çÂèóÂπ≥Âè∞„ÄÅÊú∫Âô®Êåá‰ª§ÈõÜÈôêÂà∂„ÄÇ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Áº∫ÁÇπÔºöÂÜÖÁΩëÁ©øÈÄèÊïàÁéáÊïàÁéáÂèóÂ§ñÁΩëÁΩëÈÄüÈôêÂà∂ÔºåÊúâÊó∂Âú®ÂÆ¢Êà∑Áé∞Âú∫ÊÉ≥ÂÅö‰∏™ÂÆûÈ™åÁõ¥Êé•Âç°Ê≠ª„ÄÇ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Ê≠§Â§ñÔºåÊõ¥‰∏ç‰æøÁöÑÊòØ‰ΩøÁî® vscode ÁöÑ remote code ÂäüËÉΩÊàñ TiDE Âéª debug tidb Êó∂ÁÅµÊòØ‰∏çÁÅµ„ÄÇ</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2. Âú® M1 arch Êû∂ÊûÑÈïøÂØªÊâæËøêË°å x86 ËΩØÊåá‰ª§ÈõÜÁöÑ VMÔºåÁõÆÂâçÂ∑≤ÁªèÊúâ‰∫õËΩØ‰ª∂ÊîØÊåÅ‰∫ÜÔºåÂ¶ÇÔºöQEMU„ÄÅACVM„ÄÅUTM„ÄÅToyVM Á≠âÔºåËØ¶ÊÉÖÂèØÊµèËßà <a href="https://www.youtube.com/watch?v=vm8fvNxByHU" target="_blank" rel="noreferrer">Ê≤πÁÆ°ËßÜÈ¢ë-Apple Silicon M1 Virtualization: Running x86 and ARM Virtual Machines</a>ÔºåÁªìÊûú‰∏çÊòØËøêË°åÊïàÁéá‰Ωé‰∏ãÂá†‰πéÂç°Ê≠ªÔºåÂ∞±ÊòØ‰∏çÂÆö‰∏çÁ®≥ÂÆö‰ºöÂΩ±ÂìçÊï∞ÊçÆÂ∫ì‰ΩøÁî®ÔºåÊäïÂÖ•‰∫ßÂá∫ÊØî‰∏çÈ´ò„ÄÇ</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>ÊúÄÂêéÊÉäÂñúÁöÑÂèëÁé∞Ôºå TiDB ÂéüÁîüÊîØÊåÅ‰∫Ü TiDB running on M1Ôºå<a href="https://docs.pingcap.com/zh/tidb/stable/quick-start-with-tidb#%E5%9C%A8-mac-os-%E4%B8%8A%E9%83%A8%E7%BD%B2%E6%9C%AC%E5%9C%B0%E6%B5%8B%E8%AF%95%E7%8E%AF%E5%A2%83" target="_blank" rel="noreferrer">ËØ¶ÊÉÖÂèÇËÄÉÂÆòÁΩë</a></strong><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1. Ëµ∑ÂàùÔºåÊàëÊõæÂ∞ùËØïËøáÁõ¥Êé•Âú® M1 ‰∏ä build tidbÔºåÂΩìÊó∂Â∫î‰∏∫‰æùËµñÂ∫ìÊúâÈóÆÈ¢òÔºåÂ∞öÊú™ÊàêÂäü„ÄÇÂú®Áúã‰∫Ü‰∏ÄÁØá <a href="https://www.jianshu.com/p/e07928fb7577" target="_blank" rel="noreferrer">TiDB ‰ΩúËÄÖÊñáÁ´†-Âú® ARM64 ‰∏äÈù¢ËøêË°å TiDB</a> ÂèëÁé∞Âú® arm ‰∏äÊòØÂ∫îÊúâÊàêÂäüÁªèÈ™åÁöÑÔºå‰∫éÊòØÈáçÊñ∞Â∞ùËØï„ÄÇ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2. ËøôÊòØ build Áõ¥Êé•Â∞±ÊàêÂäü‰∫ÜÔºåÊü•ÈòÖ tidb ÂÆòÊñπÊñáÊ°£ÂèëÁé∞‰ªé v5.2.2 ÂºÄÂßãÂ∑≤ÁªèÊèê‰æõ‰∫Ü tiup playground ÂÆûÈ™åÈõÜÁæ§ÊîØÊåÅ„ÄÇ</p>
<h2 id="‰∫å„ÄÅtiup-operations" tabindex="-1">‰∫å„ÄÅTiup Operations <a class="header-anchor" href="#‰∫å„ÄÅtiup-operations" aria-label="Permalink to &quot;‰∫å„ÄÅTiup Operations&quot;"></a></h2>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ÂàÜÂà´ÂÆâË£Ö„ÄÅÂêØÂä®ÂèØÊåÅ‰πÖÂåñ tidb Â≠òÂÇ®Â±ÇÊï∞ÊçÆÁöÑÈõÜÁæ§ÔºåÂêç‰∏∫ mycluster„ÄÇÂêØÂä®‰πãÂêé Dashboard„ÄÅPromethus ÂùáÂèØËßÇÂØüÂà∞ÈÉ®ÂàÜÂõæÂÉè„ÄÇ‰ΩÜÁæé‰∏≠‰∏çË∂≥ÁöÑÊòØÔºåÂΩìÊàëÊÉ≥ tiup cluster cluster-name deploy topology.yaml ÁúüÊ≠£ÈÉ®ÁΩ≤‰∏Ä‰∏™ÈõÜÁæ§Êó∂ÔºåÂèëÁé∞ tiup ‰πãÂâçÂü∫‰∫é linux Ëá™ÂÆö‰πâÁöÑ serviceÔºå‰ΩÜ M1 ‰∏≠Âπ∂‰∏çÊòØ‰∏ÄÂ•óÊåá‰ª§ÔºåÊâÄ‰ª•‰ºöÊä•Èîô„ÄÇ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>‰∏çËøáÂ∑≤ÁªèËÉΩÊª°Ë∂≥Êó•Â∏∏ÂÆûÈ™å„ÄÅDEBUGÈúÄÊ±Ç‰∫Ü</strong></p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --proto</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> '=https'</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --tlsv1.2</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -sSf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> https://tiup-mirrors.pingcap.com/install.sh</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> sh</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">tiup </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">--tag</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mycluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> playground</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> v5.2.1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --db</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --pd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 3</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --kv</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 3</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --monitor</span></span></code></pre>
</div><h2 id="‰∏â„ÄÅpatching-tidb" tabindex="-1">‰∏â„ÄÅPatching TiDB <a class="header-anchor" href="#‰∏â„ÄÅpatching-tidb" aria-label="Permalink to &quot;‰∏â„ÄÅPatching TiDB&quot;"></a></h2>
<h3 id="_3-1-ÊîπÂÜô‰ª£Á†Å" tabindex="-1">3.1 ÊîπÂÜô‰ª£Á†Å <a class="header-anchor" href="#_3-1-ÊîπÂÜô‰ª£Á†Å" aria-label="Permalink to &quot;3.1 ÊîπÂÜô‰ª£Á†Å&quot;"></a></h3>
<ol>
<li>
<p>Clone Repo Â∫ì‰ª£Á†ÅÔºõ</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> clone</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> https://github.com/pingcap/tidb.git</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  \</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&#x26;&#x26; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb/util/printer</span></span></code></pre>
</div></li>
<li>
<p>ÊâãÂä®Â∞ÜÊó•ÂøóÂÜÖÂÆπ logutil.BgLogger().Info(&quot;Welcome to TiDB version.&quot; ‰øÆÊîπ‰∏∫ logutil.BgLogger().Info(&quot;Welcome to TiDB <strong>which is special Jan</strong> version.&quot;Ôºõ</p>
</li>
</ol>
<h3 id="_3-2-ÊâãÂä®-build-tidb" tabindex="-1">3.2 ÊâãÂä® Build TiDB <a class="header-anchor" href="#_3-2-ÊâãÂä®-build-tidb" aria-label="Permalink to &quot;3.2 ÊâãÂä® Build TiDB&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Build TiDB ËßÇÂØüÂà∞ Build TiDB Server successfully! ËØ¥ÊòéÂ∑≤ÁªèÁºñËØëÊàêÂäü„ÄÇ</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ../..</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> &#x26;&#x26; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">make</span></span></code></pre>
</div><h3 id="_3-3-ÊâãÂä®-patch-tidb" tabindex="-1">3.3 ÊâãÂä® Patch TiDB <a class="header-anchor" href="#_3-3-ÊâãÂä®-patch-tidb" aria-label="Permalink to &quot;3.3 ÊâãÂä® Patch TiDB&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÊâãÂä®Â∞ÜÊñ∞ÁºñËØëÂ•ΩÁöÑ tidb-server ‰∫åËøõÂà∂Êñá‰ª∂ÊîæÂÖ• tiup ÂêØÂä®ÁõÆÂΩï„ÄÇ**Ê≥®ÊÑèÔºö**ÊõøÊç¢ YOUR_COMPUTER_USERNAME ‰∏∫Ëá™Â∑±ÁúüÊ≠£Áî®Êà∑Âêç„ÄÇ</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> bin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> &#x26;&#x26; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">mv</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-server</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-server.version_jan</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">mv </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">tidb-server.version_jan</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /Users/YOUR_COMPUTER_USERNAME/.tiup/components/tidb/v5.2.1/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">mv </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">tidb-server.bak</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> &#x26;&#x26; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">mv</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-server.version_jan</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-server</span></span></code></pre>
</div><h3 id="_3-4-Êó•ÂøóÈ™åËØÅ" tabindex="-1">3.4 Êó•ÂøóÈ™åËØÅ <a class="header-anchor" href="#_3-4-Êó•ÂøóÈ™åËØÅ" aria-label="Permalink to &quot;3.4 Êó•ÂøóÈ™åËØÅ&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  ÂêØÂä® tidb Âπ∂È™åËØÅÊîπÂä®ÊòØÂê¶ÁîüÊïà„ÄÇcat ËßÇÂØüÂà∞‰ø°ÊÅØ ‚ÄúWelcome to TiDB which is special Jan version‚Äù ËØ¥ÊòéÊîπÂä®ÊàêÂäü„ÄÇ</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tiup</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --tag</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mycluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> playground</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> v5.2.1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --db</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --pd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 3</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --kv</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 3</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --monitor</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">cd </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">/Users/YOUR_COMPUTER_USERNAME/.tiup/data/mycluster/tidb-0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">cat </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">tidb.log</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "Jan version"</span></span></code></pre>
</div><h2 id="Âõõ„ÄÅtide-debug-tidb" tabindex="-1">Âõõ„ÄÅTiDE DEBUG TiDB <a class="header-anchor" href="#Âõõ„ÄÅtide-debug-tidb" aria-label="Permalink to &quot;Âõõ„ÄÅTiDE DEBUG TiDB&quot;"></a></h2>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VsCode ÂÆâË£Ö TiDE ÊåâÁÖß ‰∏é TiDE Step-by-Step Guide ‰∏ÄÊ≠•Ê≠•Êìç‰Ωú‰æøÂèØ DEBUG ‰∫ÜÔºåÊàñËÄÖÂèÇËÄÉ <a href="https://blog.csdn.net/qq_35423190/article/details/115676932" target="_blank" rel="noreferrer">AikyÂìá</a> ÂÜôÁöÑÊåáÂºï‰πüÊå∫Â•ΩÔºåÂü∫Êú¨ÂÜÖÂÆπ‰∏ÄËá¥„ÄÇ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>‰∏ãÈù¢Â±ïÁ§∫‰∏ÄÂº†ÊàëÊú¨Âú∞ÁîµËÑë DEBUG ÊàêÂäüÁöÑÂõæÁâáÔºå‚úåÔ∏èÔºÅ</strong>
<img src="./../../../../../images/tidb/07TiDB-CodeReading/debug_m1.png" alt="debug_m1"></p>
]]></content:encoded>
            <enclosure url="https://askaric.com/images/tidb/07TiDB-CodeReading/debug_m1.png" length="0" type="image/png"/>
        </item>
        <item>
            <title><![CDATA[‰∏Ä„ÄÅÂâçË®Ä]]></title>
            <link>https://askaric.com/zh/work/tidb/07TiDB-Ê∫êÁ†ÅÈòÖËØª/7-1TiDB/02TiDB Point_Get ÁÇπÊü•ÁöÑ‰∏ÄÁîü.html</link>
            <guid>https://askaric.com/zh/work/tidb/07TiDB-Ê∫êÁ†ÅÈòÖËØª/7-1TiDB/02TiDB Point_Get ÁÇπÊü•ÁöÑ‰∏ÄÁîü.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[## ‰∏Ä„ÄÅÂâçË®Ä

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ê≠§ÂâçÔºå‰Ωú‰∏∫ DBA ËßâÂæóËÉΩÁúãÊ∫êÁ†ÅÊòØ‰∏Ä‰ª∂ÂæàÁâõÁöÑ‰∫ãÊÉÖÔºåËä±‰∫Ü**Â§ßÂçäÂπ¥Êó∂Èó¥**ÂØπ Golang Âíå Rust ÂÖ•‰∫Ü‰∏™Èó®Ôºà**ÂèØËÉΩÂÖ•Èó®ÈÉΩ‰∏çÁÆó**ÔºâÔºåÂπ∂ÂÜô‰∫Ü‰∏™ Rust Â∞èÂ∑•ÂÖ∑: [TiHC(TiDB Healthy Check)](https://github.com/jansu-dev/tihc) ÊúâÂÖ¥Ë∂£ÁöÑÂ∞è‰ºô‰º¥ÂèØ‰ª•Ëá™Âèñ„ÄÇ  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÊúüÈó¥ÔºåÁúãËøáÊüê‰∫õÊ®°ÂùóÔºåÂ¶ÇÔºö[PD Â¶Ç‰ΩïË∞ÉÂ∫¶ Region](https://asktug.com/t/topic/242808)Ôºå‰πüÂè™ÊòØÁ™•Êé¢Êï∞ÊçÆÂ∫ìÁöÑÂ±ÄÈÉ®ÂäüËÉΩÔºåÊÄªÊúâ‰∏ÄÁßç **‚ÄúÊ†πÊú¨‰∏ç‰∫ÜËß£Êï∞ÊçÆÂ∫ìÈÄªËæëÊ¶ÇÂøµÂíå‰ª£Á†ÅÊòØÊÄéÊ†∑ÂÖ≥ËÅîÁöÑÔºÅ‚Äù** ÁöÑÊÑüËßâ„ÄÇÂõ†Ê≠§ÂÄüÁùÄ **‚ÄúÁÇπÊü•‚Äù** ÈÅøÂºÄÂ§ßÈáèÂ§çÊùÇ‰ºòÂåñÂô®‰ª£Á†ÅÁöÑÊú∫‰ºöÔºåÂ∞ΩÂ∑±ÊâÄËÉΩÁöÑ‰∏≤ËÅî‰∏Ä‰∏ãÁÇπÊü•Âú® TiDB Âíå TiKV Èó¥ÁöÑÊâßË°åÊµÅÁ®ã„ÄÇ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ê≠§ÂêéÔºåË∂äÂèëËßâÂæó **‚Äú‰∫ßÁ†î‚Äù** Âèä **‚Äú‰∫§‰ªò‚Äù** ‰ª∑ÂÄºÁöÑ‰∏çÂêåÔºåÊØîÂ¶ÇÔºö‰∏çËÉΩËØ¥Áúã‰ª£Á†ÅÂ∞±ÂæàÁâõÔºåÂú®ÊñáÊ°£‰∏∞ÂØå„ÄÅ‰∫ßÂìÅÊàêÁÜüÁöÑÂâçÊèê‰∏ãÔºå**Â≠¶‰π†ÊñáÊ°£ÊâçÊòØËæÉÂø´ÈÄü„ÄÅËæÉÂÖ®Èù¢„ÄÅËæÉÊúâ‰ª∑ÂÄºÁöÑÊñπÊ≥ï**ÔºåÊõ¥Â§öÊÄùËÄÉËßÅÊÄªÁªìÈÉ®ÂàÜ„ÄÇ

> **Tips**
> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.‰∏∫Èò≤Ê≠¢ÂêéÁª≠‰ª£Á†ÅÈáçÊûÑÂΩ±ÂìçÔºåÊú¨Ê¨°ÂØπ TiDB v5.3.0 tidb Âíå tikv ËøõË°åÊñ≠ÁÇπË∞ÉËØï„ÄÇ
> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.‰∏∫‰æø‰∫éËØªËÄÖÁêÜËß£ÔºåÂú®Êú¨ÊñáÈ¶ñÊ¨°Âá∫Áé∞ÁöÑÂáΩÊï∞ÊàñÊñπÊ≥ïÂùá‰ºöÁªôÂá∫ Github ÈîöÁÇπÈìæÊé•ÔºåÈáçÂ§çÂá∫Áé∞Â∞Ü‰∏çÂÜçÊ†áËÆ∞ URL ÈìæÊé•„ÄÇ

## ‰∫å„ÄÅÊëòË¶Å

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Êú¨Êñá‰∏ªË¶ÅÂÜÖÂÆπÂàÜÂ∏ÉÂú® **‚Äú‰∏â„ÄÅÁÇπÊü•ÊµÅÁ®ã‚Äù**Ôºå**‚Äú3.1 TiDB ÈÉ®ÂàÜ‚Äù**‰ªãÁªç‰∫ÜÁÇπÊü• SQL Âú® TiDB ÂÜÖÈÉ®ÊµÅËΩ¨ËøáÁ®ã„ÄÇ**‚Äú3.2 TiKV ÈÉ®ÂàÜ‚Äù**‰ªãÁªç‰∫ÜÁÇπÊü•ÁªèÁî± TiDB Â§ÑÁêÜÂπ∂ËØ∑Ê±ÇÁªô TiKV ÂêéÔºåÂ¶Ç‰ΩïÂú® TiKV ÂÜÖÈÉ®ÊµÅËΩ¨„ÄÅÂ§ÑÁêÜ„ÄÅËøîÂõûÁöÑËøáÁ®ã„ÄÇ**‚Äú3.3 ÊÄªÁªì‚Äù** ÁÆÄË¶Å‰ªãÁªç‰∫Ü tidb ÁÇπÊü•Âø´ÁöÑÂéüÂõ†„ÄÇ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ÊØè‰∏™Ê®°ÂùóÁöÑ ‚ÄúModel Tips‚Äù Âùá‰ºöËØ¥ÊòéËØ•Ê®°ÂùóÂú® TIDB ÂêÑÊâÄÂ±ûÁªÑ‰ª∂‰∏≠ÁöÑ‰ΩúÁî®„ÄÇÂπ∂‰∏îÂ∞ΩÂäõÈááÁî®ÂàÜÂ±ÇÊèèËø∞ÁöÑÊñπÂºèËØ¥ÊòéÔºåÊâÄË∞ìÂàÜÂ±ÇÔºåÊØîÂ¶ÇÔºöExecutor Ë∞ÉÁî®‰∫Ü PD ClientÔºåÈÇ£‰πàÂè™Âú® Executor ÈÉ®ÂàÜÊèèËø∞ÈÇ£‰∏™ÂáΩÊï∞Ëß¶ÂèëË∞ÉÁî® PD Client ÁöÑÈÄªËæëÔºåËÄå‰∏çÂú®Ëøô‰∏ÄÂ±ÇËØ¶Ëø∞ PD Client Â¶Ç‰ΩïÂ∑•‰Ωú„ÄÇ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ÊúÄÂêéÔºåÂú® **‚ÄúÂõõ„ÄÅÂ≠¶‰π†ÊÄªÁªì‚Äù** ‰∏≠Ôºå‰ªãÁªç‰∫Ü**‰∏™‰∫∫ÂØπ DBA ÁöÑÁúã‰ª£Á†ÅË°å‰∏∫ÁöÑ‰ª∑ÂÄº**ÁöÑËßÇÁÇπ„ÄÇ

## ‰∏â„ÄÅÁÇπÊü•ÊµÅÁ®ã

### 3.1 TiDB

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‰∏ãËø∞ **3.1** ÈÉ®ÂàÜÂùá‰∏∫ÁÇπÊü•Âú® TiDB ÁªÑ‰ª∂‰∏≠Ê∂âÂèäÂ§ÑÁêÜÊµÅÁ®ã‰ªãÁªç„ÄÇÂ§ßËá¥Â¶Ç‰∏ãÂõæÔºö
**1. È¶ñÂÖà**ÔºåÂÆ¢Êà∑Á´ØËøûÊé•ËøõÂÖ• MySQL Protocol Layer Êé•ÂÖ• TiDB ÔºåÂú®Ëé∑Âèñ TokenÂêéÔºå‰º†ÈÄÅ SQL ÊâßË°åÔºõ
**2. ÂÖ∂Ê¨°**ÔºåSQL Â§ÑÁêÜËøõÂÖ• Parser Â±ÇÔºåËß£ÊûêÊàê ASTÔºàÊäΩË±°ËØ≠Ê≥ïÊ†ëÔºâÔºõ
**3. ÂÜçÊ¨°**ÔºåSQL Â§ÑÁêÜËøõÂÖ• Compile Â±ÇÔºåÈÄâÂá∫ TSO Âπ∂Â∞Ü AST ÁºñËØëÊàêÊâßË°åËÆ°ÂàíÔºõ  
**4. ÁÑ∂Âêé**ÔºåSQL Â§ÑÁêÜËøõÂÖ• Executor Â±Ç[ÔºàÂèØ ‚ÄúBatch Â§ÑÁêÜ‚Äù ÁöÑÁÅ´Â±±Ê®°ÂûãÔºâ](https://github.com/pingcap/tidb/blob/ad9430039f54bb9af78d44831c176bc5eafcbba0/executor/executor.go#L249-L265)ÔºåÂ∞ÜÊâßË°åËÆ°Âàí Open„ÄÅNext„ÄÅClose ÂÆåÊàê TiKV Êï∞ÊçÆËé∑Âèñ;  
**5. ÊúÄÂêé**ÔºåSQL Â§ÑÁêÜÂõûÂà∞ MySQL Protocol Layer Ë∞ÉÁî® writeChunks Â∞Ü MemBuffer ‰∏≠Êï∞ÊçÆÂØºÂá∫ÊàêÂÆ¢Êà∑Á´ØÊâÄÈúÄÂΩ¢ÂºèËøîÂõûÔºõ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÈÄöËøáËøΩÊ∫Ø func (cc \*clientConn) handleQuery(...) --> func (cc \*clientConn) handleStmt(...) --> func (tc \*TiDBContext) ExecuteStmt(...) ÊòØ‰∏≤ËÅîÁÇπÊü•Ôºå‰ªéËß£Êûê„ÄÅÁºñËØë„ÄÅÊâßË°å„ÄÅÂçèËÆÆÂõûÊòæÁöÑÊñπÊ≥ïÔºåÁúãÊáÇÊ≠§ÂáΩÊï∞ÂØπ‰∫éÁêÜËß£ÂÖ®ÊñáËá≥ÂÖ≥ÈáçË¶Å„ÄÇ

![01tidb-arch](../../../../../images/tidb/07TiDB-CodeReading/01tidb-arch.jpg)

#### 3.1.1 SQL Protol Deal  

> **Model Tips:**
> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TiDB SQL Protol Â§ÑÁêÜÂ±Ç‰ªÖÊòØ TiDB ‰∏∫ÂÆûÁé∞ MySQL Protocol ÂÖºÂÆπÔºåÊâÄÂÅöÁöÑ‰ª£Á†ÅÂ§ÑÁêÜ„ÄÇ ‰∏ªË¶ÅÂäüËÉΩÂåÖÂê´ÔºöÁõëÂê¨ÂÆ¢Êà∑Á´ØËØ∑Ê±Ç„ÄÅÂàÜÂèë‰∏çÂêå SQL Â§ÑÁêÜ„ÄÅË∞ÉÁî® Parser„ÄÅCompiler„ÄÅExecutor ÂÆåÊàê SQL Â§ÑÁêÜÔºåÂõûÂÜôÁªìÊûúÈõÜÁ≠âÂäüËÉΩ„ÄÇ

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**1. È¶ñÂÖà**ÔºåÂêØÂä® Server Êó∂Âú® Struct clientConn ÂÜÖÈÉ®Â∞ÅË£Ö‰∫Ü go ÂéüÁîüÂåÖ net ËøõË°å TCP ÈÄö‰ø°ÔºåÂπ∂Âú® for Âæ™ÁéØËµ∑‰∏§‰∏™ Listener goroutine Â§ÑÁêÜÂÆ¢Êà∑Á´ØÂèëËøáÊù•ÁöÑÊ∂àÊÅØ„ÄÇ

```go
// Run runs the server.
func (s *Server) Run() error {
 go s.startNetworkListener(s.listener, false, errChan)
 go s.startNetworkListener(s.socket, true, errChan)
        ......
}

func (s *Server) startNetworkListener(listener net.Listener, isUnixSocket bool, errChan chan error) {
 for {
  conn, err := listener.Accept()
        ......
  go s.onConn(clientConn)
     }
}
```

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**2. ÂÖ∂Ê¨°**ÔºåÂú® Dispatch ÊñπÊ≥ï‰∏≠‰ºöÈ¶ñÂÖàËé∑Âèñ [token](https://github.com/pingcap/tidb/blob/ad9430039f54bb9af78d44831c176bc5eafcbba0/server/conn.go#L1291) ÔºåÁî®‰∫éÈôêÂà∂Âçï‰∏™ TiDB Instance ÂèØÂ§ÑÁêÜÁöÑÂêåÊó∂ÊâßË°åËØ∑Ê±ÇÁöÑ session ‰∏™Êï∞,ËØ¶ÊÉÖËßÅ: [token-limit](https://docs.pingcap.com/zh/tidb/v4.0/tidb-configuration-file/#token-limit);  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; **3. ÂÜçÊ¨°**ÔºåÂú®  [Struct clientConn](https://github.com/pingcap/tidb/blob/bc7304c99538643e2464d884da627979cbfddf02/server/conn.go#L172) ÂÆûÁé∞‰∫Ü Run„ÄÅreadPacket„ÄÅwritePacket„ÄÅhandshake„ÄÅopenSession„ÄÅhandleQuery„ÄÅhandleStmt Á≠âÁ≠âÊñπÊ≥ïÔºåÁî®‰∫éÂÆûÁé∞ [MySQL Client/Server Protocol](https://dev.mysql.com/doc/internals/en/overview.html)„ÄÇÊú¨‰æã‰∏≠Ôºå‰ªé MySQL Client ÂèëÊù•ÁöÑÁÇπÊü• SQL ÈÄöËøá [dispatch ÊñπÊ≥ï](https://github.com/pingcap/tidb/blob/ad9430039f54bb9af78d44831c176bc5eafcbba0/server/conn.go#L1237) ÈÅµÁÖß MySQL Protocol ËøõÂÖ• [handleQuery](https://github.com/pingcap/tidb/blob/ad9430039f54bb9af78d44831c176bc5eafcbba0/server/conn.go#L1341) ÂàÜÊîØÂ§ÑÁêÜÔºõ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; **4. ÁÑ∂Âêé**ÔºåhandleQuery ‰ºöÂæ™ÁéØÂ§ÑÁêÜ Session ‰∏≠ÊØè‰∏Ä‰∏™ SQLÔºåÂú® handleStmt ‰∏≠ÂØπÊØè‰∏ÄÊù° SQL ËøõË°åËß£Êûê„ÄÅÁºñËØë„ÄÅÊâßË°åÔºõ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; **5. ÊúÄÂêé**ÔºåÂú® handleStmt ‰∏≠Ë∞ÉÁî® writeResultset ÊñπÊ≥ïÔºåËß¶ÂèëÁªÑÁªáÂ•ΩÁöÑ Executor ÁöÑ Next() ÊñπÊ≥ï‰ªé TiKV Ëé∑ÂèñÊï∞ÊçÆÔºõ

#### 3.1.2 SQL Parser Deal

> **Model Tips:**
> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQL Parser Â§ÑÁêÜÂ±ÇÈÄöËøáÂ∞ÅË£Ö YACC ÂÆûÁé∞ MySQL ÁöÑËØçÊ≥ïËß£ÊûêÔºåÂ∞Ü SQL ËΩ¨Âåñ‰∏∫ AST„ÄÇ

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**1. È¶ñÂÖà**ÔºåÂú® handleQuery ‰∏≠ÔºåË∞ÉÁî® [func (s *session) Parse(...)](https://github.com/pingcap/tidb/blob/ad9430039f54bb9af78d44831c176bc5eafcbba0/server/conn.go#L1795) ÊñπÊ≥ïÂÆûÁé∞ AST ÁöÑËΩ¨Âåñ‰∏éËøîÂõûÔºõ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; **2. ÂÖ∂Ê¨°**ÔºåÊ∑±ÂÖ•‰∫ÜËß£‰ºöÂèëÁé∞ÔºåËØ• Parse ÊñπÊ≥ï‰∏∫Ë∞ÉÁî® [func (s *session) ParseSQL(...)](https://github.com/pingcap/tidb/blob/27348d67951c5d9e409c84ca095f0e5d3332c1fd/session/session.go#L1459-L1489) ÂáΩÊï∞ÂÆûÁé∞ÁúüÊ≠£ÁöÑËØçÊ≥ïËß£ÊûêÂä®‰ΩúÔºåÂπ∂ËÆ∞ÂΩïËß£Êûê SQL ÊòØÂê¶ÊàêÂäüÂèäËß£ÊûêËÄóË¥πÁöÑÊó∂Èó¥„ÄÇ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; **3. ÊúÄÂêé**ÔºåËøõÂÖ• [func (s *session) Parse(...)](https://github.com/pingcap/tidb/blob/27348d67951c5d9e409c84ca095f0e5d3332c1fd/session/session.go#L1298-L1318) È¶ñÂÖàÂ∞ÅË£Ö‰∏Ä‰∏™ sync.Pool ‰Ωú‰∏∫ parserPool ÂáèËΩª GC struct ÁöÑÂéãÂäõÔºåÂπ∂ Copy AST ÁªìÊûúËøîÂõûÁªô‰∏äÂ±ÇË∞ÉÁî®ÔºåÂÜçÊ∑±Â±Ç DEBUG Â∞Ü‰ºöËøõÂÖ• Parser Ê®°Âùó„ÄÇ

```go
func (s *session) ParseSQL(ctx context.Context, sql string, params ...parser.ParseParam) ([]ast.StmtNode, []error, error) {
 ......
 p := parserPool.Get().(*parser.Parser)
 defer parserPool.Put(p)
 p.SetSQLMode(s.sessionVars.SQLMode)
 p.SetParserConfig(s.sessionVars.BuildParserConfig())
 tmp, warn, err := p.ParseSQL(sql, params...)
 res := make([]ast.StmtNode, len(tmp))
 copy(res, tmp)
 return res, warn, err
}

```

#### 3.1.3 SQL Compile Deal

> **Model Tips:**
> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQL Compiler Â§ÑÁêÜÂ±ÇÂÆåÊàê SQL ËØ≠ÊÑèÊ£ÄÊü•(Preprocess)„ÄÅÁºñËØëÊâßË°åËÆ°Âàí(Logical Optimize„ÄÅPhysical Optimize) Â∑•‰ΩúÔºåÂ∞Ü SQL ÁºñËØëÊàêÂèØÊâßË°åÁöÑÁâ©ÁêÜÊâßË°åËÆ°Âàí„ÄÇ

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**1. È¶ñÂÖà**Ôºå‰ªé MySQL Protocol Layer ‰∏≤ËÅîËµ∑ ‚ÄúËß£Êûê‚Äù„ÄÅ‚ÄúÊâßË°å‚Äù Êìç‰ΩúÔºåÂπ∂Âú® [func (s *session) ExecuteStmt(...)](https://github.com/pingcap/tidb/blob/27348d67951c5d9e409c84ca095f0e5d3332c1fd/session/session.go#L1735) ‰∏≠Ë∞ÉÁî® [func (c *Compiler) Compile(...)](https://github.com/pingcap/tidb/blob/27348d67951c5d9e409c84ca095f0e5d3332c1fd/executor/compiler.go#L51-L109) ËøõË°åÁúüÊ≠£ÁöÑÁºñËØëÂ§ÑÁêÜ„ÄÇ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; **2. ÂÖ∂Ê¨°**ÔºåÂú® Compile ÂÜÖÈÉ®Ë∞ÉÁî® [func Preprocess(...)](https://github.com/pingcap/tidb/blob/27348d67951c5d9e409c84ca095f0e5d3332c1fd/planner/core/preprocess.go#L114-L130)ÔºåËøõË°å Preprocess ÂÆåÊàêÂâçÁΩÆÊ£ÄÊü•ÔºåÂ¶ÇÔºöËØ≠‰πâÊ£ÄÊü•„ÄÇÂÖ∑‰ΩìÂÆûÁé∞ÊµÅÁ®ã‰∏∫ÔºåÈÄöËøá AST ÁöÑ [Accept ÊñπÊ≥ï](https://github.com/pingcap/tidb/blob/27348d67951c5d9e409c84ca095f0e5d3332c1fd/parser/ast/ast.go#L40), ÊûÑÈÄ†‰∏Ä‰∏™ Vistor ÂÆûÁé∞ÂØπ AST ÁöÑÈÅçÂéÜ„ÄÇ ÊØè‰∏™ Visitor Êé•Âè£ÂåÖÂê´ Enter„ÄÅLeave ÊñπÊ≥ïÔºå[Âπ∂Âú® Enter Êàñ Leave Êó∂](https://github.com/pingcap/tidb/blob/27348d67951c5d9e409c84ca095f0e5d3332c1fd/planner/core/preprocess.go#L192)Ôºå‰æùÊçÆ SQL Á±ªÂûãËøõË°åÂà§Êñ≠„ÄÇÊú¨‰æã point get ‰ºöË∑≥Âà∞ [func (n *SelectStmt) Accept(v Visitor)](https://github.com/pingcap/tidb/blob/27348d67951c5d9e409c84ca095f0e5d3332c1fd/parser/ast/dml.go#L1391-L1503) ‰∏≠Ôºå‰∏çÊñ≠ÂàÜÊîØÂ§ÑÁêÜÂÆåÊàêÈÅçÂéÜ„ÄÇËØ¶ÊÉÖÂèÇËÄÉ [TiDB Ê∫êÁ†ÅÈòÖËØª‰πã Compiler --> ËøõÂ∫¶ 10min Â∑¶Âè≥](https://www.bilibili.com/video/BV1m4411g7Yy?from=search&seid=10358982920062599002&spm_id_from=333.337.0.0)„ÄÇ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; **3. ÊúÄÂêé**ÔºåËøõÂÖ• Optimizer Â§ÑÁêÜÔºåÊú¨‰æã‰∏≠Âõ†‰∏∫ÊòØÁÇπÊü•‰ºöË∂äËøáÂ§ßÈáè‰ºòÂåñÂô®Â§ÑÁêÜËøáÁ®ãÔºåÁõ¥Êé•ËøõÂÖ• [func TryFastPlan(...)](https://github.com/pingcap/tidb/blob/27348d67951c5d9e409c84ca095f0e5d3332c1fd/planner/optimize.go#L131) ËøõË°åÁÆÄÂçïÁöÑ ‚ÄúÊùÉÈôêÊ£ÄÊü•‚Äù Âèä ‚ÄúÊï∞ÊçÆÂ∫ìÂêçÊ£ÄÊü•‚Äù„ÄÇ

```sql
// TryFastPlan tries to use the PointGetPlan for the query.
func TryFastPlan(ctx sessionctx.Context, node ast.Node) (p Plan) {
    ......
 case *ast.SelectStmt:
  if fp := tryPointGetPlan(ctx, x, isForUpdateReadSelectLock(x.LockInfo)); fp != nil {
   if checkFastPlanPrivilege(ctx, fp.dbName, fp.TblInfo.Name.L, mysql.SelectPriv) != nil {
    return nil
   }
   if tidbutil.IsMemDB(fp.dbName) {
    return nil
   }
   if fp.IsTableDual {
    return
   }
   p = fp
   return
  }
 }
 return nil
}
```

#### 3.1.4 SQL Executor Deal

> **Model Tips:**
> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQL Executor ÈÄöËøáÊé•Êî∂ÁªèËøá Optimizer ÁöÑ PlanÔºåÂπ∂ÊûÑÈÄ†„ÄÅÊâßË°åÁÅ´Â±±Ê®°ÂûãËé∑ÂèñÊâßË°åÁªìÊûúÔºåÁÅ´Â±±Ê®°ÂûãËØ¶ËßÅ [Áü•‰πé -- SQL ‰ºòÂåñ‰πãÁÅ´Â±±Ê®°Âûã](https://zhuanlan.zhihu.com/p/219516250)„ÄÇ

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**1. È¶ñÂÖà**ÔºåÂú® [func (s *session) ExecuteStmt(...)](https://github.com/pingcap/tidb/blob/ad9430039f54bb9af78d44831c176bc5eafcbba0/session/session.go#L1757) ‰∏≠Ë∞ÉÁî®  [func (a *ExecStmt) Exec(...)](https://github.com/pingcap/tidb/blob/ad9430039f54bb9af78d44831c176bc5eafcbba0/session/session.go#L1880)ÔºåË∞ÉÁî® [Open()](https://github.com/pingcap/tidb/blob/ad9430039f54bb9af78d44831c176bc5eafcbba0/executor/adapter.go#L407) ÊñπÊ≥ï‰ªéËÄåÂÆåÊàê Executor ÂèòÂºÇÁâàÁÅ´Â±±Ê®°ÂûãÁöÑÊûÑÈÄ†ÔºåÊúÄÂêéËøîÂõû‰∏Ä‰∏™ RecordSet„ÄÇ  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; **2. ÂÖ∂Ê¨°**ÔºåExecuteStmt ËøîÂõûÁöÑ RecordSet ÂåÖÂê´‰∫Ü Executor ÈúÄË¶ÅÁöÑÊâÄÊúâ‰ø°ÊÅØÔºåÊ≠§Êó∂ÂèØ‰ª•Êää RecordSet ÂΩìÊàêËøîÂõûÁöÑÁªìÊûúÈõÜÔºå‰ΩÜËØ•ÊâßË°åÊµÅ‰ªéÊú™Ëß¶ÂèëËøá Next() ÊñπÊ≥ïÔºåÂç≥ÔºöÊ≤°ÊúâÁúüÊ≠£ÁöÑËé∑ÂèñÊï∞ÊçÆ„ÄÇ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; **3. ÊúÄÂêé**ÔºåÂÆûÈôÖ‰∏ä NextÔºàÔºâ Ëß¶ÂèëÁî±  ÁöÑ writeResultset Ëß¶Âèë,ËØ¶ÁªÜÊµÅÁ®ãÂ¶Ç‰∏ãÔºö**func (cc \*clientConn) handleStmt(...) --> func (cc \*clientConn) writeResultset(...) --> func (cc \*clientConn) writeChunks(...) --> func (trs \*tidbResultSet) Next(...) --> func (a \*recordSet) Next(...) --> func Next(...) --> func (e \*PointGetExecutor) Next(...) --> func (e \*PointGetExecutor) Next(...) --> func (e \*PointGetExecutor) getAndLock(...) --> func (e \*PointGetExecutor) get(...)** Â±ÇÂ±ÇË∞ÉÁî®ÔºåÁõ¥Ëá≥ Executor ÂÆåÊàêÊâÄÊúâÊï∞ÊçÆÁöÑËé∑Âèñ„ÄÇ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; **4. Âè¶Â§ñ**ÔºåÂÄºÂæó‰∏ÄÊèêÁöÑÊòØÂú® func (a *ExecStmt) Exec(...) --> Build Executor Êó∂ÔºåÂõ†‰∏∫ÁÇπÊü•‰ΩøÁî®‚Äú‰∏ªÈîÆ‚ÄùÊàñ‚ÄúÂîØ‰∏ÄÁ¥¢Âºï‚ÄùÊ†áÂÆö‰∏ÄË°åÔºå**‰∏çÂ≠òÂú®ÈáçÂ§çÊï∞ÊçÆËØª**ÔºåÊâÄ‰ª•Âú® `autoCommit` ÊÉÖÂÜµ‰∏ãÁõ¥Êé•Âèñ `MaxUint64` ‰Ωú‰∏∫‰∫ãÂä°ÁöÑ StartTSÔºàËØ•‰∫ãÂä°Âè™Êúâ‰∏Ä‰∏™ÁÇπÊü•ÔºâÔºåÂç≥ÔºöÊó†Á©∑Â§ß +‚àû„ÄÇÂêåÊó∂ÔºåËøò‰ºöËµã‰∫à `PriorityHigh` ‰ºòÂÖàÁ∫ßËøõË°åÂ§ÑÁêÜÔºåËØ¶ÊÉÖËßÅ [force-priority](https://docs.pingcap.com/zh/tidb/v5.2/tidb-configuration-file/#force-priority)„ÄÇ

```go
func (a *ExecStmt) buildExecutor() (Executor, error) {
        ...... 
  } else {
   // Do not sync transaction for Execute statement, because the real optimization work is done in
   // "ExecuteExec.Build".
   useMaxTS, err := plannercore.IsPointGetWithPKOrUniqueKeyByAutoCommit(ctx, a.Plan)
   if useMaxTS {
    if err := ctx.InitTxnWithStartTS(math.MaxUint64); err != nil {
     return nil, err
    }
   }
   if stmtPri := stmtCtx.Priority; stmtPri == mysql.NoPriority {
    switch {
    case useMaxTS:
     stmtCtx.Priority = kv.PriorityHigh
    case a.LowerPriority:
     stmtCtx.Priority = kv.PriorityLow
    }
   }
  }
 }
 b := newExecutorBuilder(ctx, a.InfoSchema, a.Ti, a.SnapshotTS, a.IsStaleness, a.ReplicaReadScope)
 e := b.build(a.Plan)
 return e, nil
}
```

#### 3.1.5 TiKV & PD Client Deal

> **Model Tips:**
> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TiKV Client Ë¢´Â∞ÅË£ÖÂú® TiDB ‰æßÔºå‰∏ªË¶ÅÊâøÊãÖ‰ªé TiKV Ëé∑Âèñ KV Êï∞ÊçÆÁöÑ‰ΩúÁî®„ÄÇ  

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**1. È¶ñÂÖà**ÔºåÈÄöËøáÊâßË°åÊµÅËøΩÊ∫Ø func (s \*tikvSnapshot) Get(...) --> func (i \*TemporaryTableSnapshotInterceptor) OnGet(...)  --> func (s \*tikvSnapshot) Get(...) ‰ºöÁõ¥Êé•Ë∞ÉÁî®Â∞ÅË£Ö‰∫Ü tikv client ÁöÑ tikvSnapshot ÁªìÊûÑ‰ΩìÁöÑ [Get(...)](https://github.com/pingcap/tidb/blob/cd56aba07e9c9c2a87df5f28fe9d81a3e3dd50a8/store/driver/txn/snapshot.go#L58) ÊñπÊ≥ïÔºå‰ªé TiKV Ëé∑Âèñ KV Êï∞ÊçÆ„ÄÇ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; **2. ÂÖ∂Ê¨°**ÔºåDEBUG Âà∞ TiKV Client ÂÜÖÈÉ®ÁªÜËäÇ‰ºöÂèëÁé∞ TiKV Client ÈÅµÁÖßÊú¨Âú∞ÁºìÂ≠òÊòØÂê¶Â≠òÂú®Êï∞ÊçÆÔºåÂ¶ÇÊûú‰∏çÂ≠òÂú®ÊûÑÈÄ†ËØ∑Ê±ÇÂ§¥ÔºåÂπ∂Âú® for{} Âæ™ÁéØ‰∏≠Ë∞ÉÁî® GetRegionCache() Êü•ËØ¢ PD Client ÁöÑ Region Cache Ëé∑ÂèñÊâÄË¶ÅÊü•ËØ¢ Region Âú® TiKV ‰∏≠ÁöÑ‰ΩçÁΩÆÔºåÂêë TiKV ÂèëÈÄÅËØ∑Ê±ÇËé∑ÂèñÊï∞ÊçÆ„ÄÇ‰πãÊâÄ‰ª•‰ΩøÁî® for Âæ™ÁéØÔºåÊòØÂõ†‰∏∫ Region Cache ‰ø°ÊÅØ‰ªé PD Ëé∑ÂèñÔºåÊâÄ‰ª•Âπ∂‰∏ç‰∏ÄÂÆöÊòØÊúÄÊñ∞ÁöÑ„ÄÅÊúÄÂáÜÁ°ÆÁöÑ Region Location ‰ø°ÊÅØÔºåÂåÖÂê´‰∏Ä‰∫õÈîôËØØÈáçÊãæÊìç‰Ωú,Â¶ÇÔºöEpochNotMatch Á≠âÁ≠âÔºåËØ¶ÊÉÖËßÅ: [Region Cache ÁºìÂ≠òÂíåÊ∏ÖÁêÜÈÄªËæëËß£Èáä](https://docs.google.com/document/d/1BHkeN8W2iWSdgWLK3U16QGwq9K7DA6Le7zxVhLPaQgc/edit) Êàñ [TiDB Ê∫êÁ†ÅÈòÖËØªÁ≥ªÂàóÊñáÁ´†ÔºàÂçÅÂÖ´Ôºâtikv-clientÔºà‰∏äÔºâ](https://pingcap.com/zh/blog/tidb-source-code-reading-18)„ÄÇ

```go
func (s *KVSnapshot) get(ctx context.Context, bo *retry.Backoffer, k []byte) ([]byte, error) {
 // Check the cached values first.
 s.mu.RLock()
 if s.mu.cached != nil {
  if value, ok := s.mu.cached[string(k)]; ok {
   atomic.AddInt64(&s.mu.hitCnt, 1)
   s.mu.RUnlock()
   return value, nil
  }
 }
 s.mu.RUnlock()
 ......
 s.mu.RLock()
 req := tikvrpc.NewReplicaReadRequest(tikvrpc.CmdGet,
  &kvrpcpb.GetRequest{
   Key:     k,
   Version: s.version,
  }, s.mu.replicaRead, &s.replicaReadSeed, kvrpcpb.Context{
   Priority:         s.priority.ToPB(),
   NotFillCache:     s.notFillCache,
   TaskId:           s.mu.taskID,
   ResourceGroupTag: s.resourceGroupTag,
  })
 s.mu.RUnlock()

 for {
  loc, err := s.store.GetRegionCache().LocateKey(bo, k)
  resp, _, _, err := cli.SendReqCtx(bo, req, loc.Region, client.ReadTimeoutShort, tikvrpc.TiKV, "", ops...)
  regionErr, err := resp.GetRegionError()
  val := cmdGetResp.GetValue()
  return val, nil
 }
}
```

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; **3. ÊúÄÂêé**ÔºåÂú® [func (e *PointGetExecutor) Next(...)](https://github.com/pingcap/tidb/blob/ad9430039f54bb9af78d44831c176bc5eafcbba0/executor/point_get.go#L215) Â§ÑÁêÜ‰∏≠‰ºöÈÄöËøá `isCommonHandleRead` ÊòØÊôÆÈÄöÊü•ËØ¢ËøòÊòØÁÇπÊü•ÔºåÁÇπÊü• executor ‰ºöÁõ¥Êé• get ËØ• key ÁöÑ value„ÄÇÁî±‰∫é TiDB KV ‰∏ªË¶Å‰ΩúÁî®ÊòØÂØπ TiKV Êï∞ÊçÆËé∑ÂèñÂ§ÑÁêÜÁöÑÂ∞ÅË£ÖÔºå‰æø‰∏çÂçïÁã¨ÊèêÂèñÊ®°ÂùóËµòËø∞„ÄÇ

```go
// Next implements the Executor interface.
func (e *PointGetExecutor) Next(ctx context.Context, req *chunk.Chunk) error {
 if e.idxInfo != nil {
  if isCommonHandleRead(e.tblInfo, e.idxInfo) {
   handleBytes, err := EncodeUniqueIndexValuesForKey(e.ctx, e.tblInfo, e.idxInfo, e.idxVals)
   e.handle, err = kv.NewCommonHandle(handleBytes)
  } else {
   e.idxKey, err = EncodeUniqueIndexKey(e.ctx, e.tblInfo, e.idxInfo, e.idxVals, tblID)
   e.handleVal, err = e.get(ctx, e.idxKey)
  }
 }
    ......
 return nil
}
```

### 3.2 TiKV

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‰∏ãËø∞ **3.2** ÈÉ®ÂàÜÂùá‰∏∫ÁÇπÊü•Âú® TiKV ÁªÑ‰ª∂‰∏≠Ê∂âÂèäÂ§ÑÁêÜÊµÅÁ®ã‰ªãÁªç„ÄÇ

![02tikv-arch](../../../../../images/tidb/07TiDB-CodeReading/02tikv-arch.jpg)

#### 3.2.1 KV Grpc & Service Deal

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**1. È¶ñÂÖà**ÔºåTiKV ËøõÁ®ãÂêØÂä®ÂêéÔºåÊâÄÊúâÁöÑ Grpc ËØ∑Ê±ÇÂ§ÑÁêÜÈÉΩÁî± Service Â±ÇÊé•ÁÆ°„ÄÇ‰Ωç‰∫é `src/server/service/kv.rs` Êñá‰ª∂‰∏≠Ôºå‰æãÂ¶ÇÊú¨Ê¨°ÁöÑÁÇπÊü•ËØ∑Ê±Ç‰ºöÁî± [`handle_request!(kv_get, future_get, GetRequest, GetResponse);`](https://github.com/tikv/tikv/blob/005efd56d3405b72a26bf623b5895cf3d9da0a6f/src/server/service/kv.rs#L196) ËøôÊ†∑‰∏Ä‰∏™Â£∞ÊòéÂÆèÂ§ÑÁêÜÔºåË∞ÉÁî® future_get ÂºÇÊ≠•Â§ÑÁêÜ„ÄÇ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; **2. ÂÖ∂Ê¨°**Ôºå‰ªé Grpc ÁöÑËØ∑Ê±Ç‰∏≠Ëß£ÊûêÂá∫ key Á≠âÁõ∏ÂÖ≥‰ø°ÊÅØÔºå‰Ωú‰∏∫ÂèÇÊï∞‰º†ÈÄíË∞ÉÁî®Â≠òÂÇ®ÂºïÊìéÊñπÊ≥ï [storage.get(...)](https://github.com/tikv/tikv/blob/005efd56d3405b72a26bf623b5895cf3d9da0a6f/src/server/service/kv.rs#L1302-L1305) ËøõË°åÂÆûÈôÖÁöÑË∞ÉÁî®Â§ÑÁêÜ,ÂåÖÂê´ÊûÑÈÄ† snapshot„ÄÅËé∑Âèñ  value Á≠â„ÄÇ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; **5. ÊúÄÂêé**ÔºåÂú® v(value) ÂºÇÊ≠•ÁªìÊûúËé∑ÂèñÂêéÔºåÊûÑÈÄ† Grpc ËøîÂõûÁªôËØ∑Ê±ÇÁ´Ø„ÄÇ  

```rust
fn future_get<E: Engine, L: LockManager>(
    storage: &Storage<E, L>,
    mut req: GetRequest,
) -> impl Future<Output = ServerResult<GetResponse>> {

    let v = storage.get(
        req.take_context(),
        Key::from_raw(req.get_key()),
        req.get_version().into(),
    );

    async move {
        let mut resp = GetResponse::default();
            match v {
                Ok((val, stats)) => {
                    match val {
                        Some(val) => resp.set_value(val),
                        None => resp.set_not_found(true),
                    }
                }
                Err(e) => resp.set_error(extract_key_error(&e)),
            }
        Ok(resp)
    }
}
```

#### 3.2.2 KV Storage ReadPool Deal

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**1. È¶ñÂÖà**ÔºåËØ•ÂáΩÊï∞ÁöÑ‰ΩúÁî®ÊòØ‰ªé snapshot ‰∏≠ÔºåÊêúÂØªÊª°Ë∂≥ ‚ÄúÊï∞ÊçÆË°åÊèê‰∫§Êó∂Èó¥Êà≥ < Êú¨Ê¨°Êï∞ÊçÆË°åÂèëËµ∑ËØ∑Ê±ÇÊó∂Èó¥Êà≥‚Äù Ë¶ÅÊ±ÇÁöÑÔºåÊó†ÈîÅÁöÑÔºå‰∏î MVCC Â§öÁâàÊú¨Êï∞ÊçÆ‰∏≠Êó∂Èó¥Êà≥ÊúÄÊñ∞ÁöÑËØ∑Ê±ÇË°åÊï∞ÊçÆ „ÄÇ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; **2. ÂÖ∂Ê¨°**ÔºåËßÇÂØüÂáΩÊï∞ÈÄªËæëÔºåÂÖà‰ºöÂØπËØ∑Ê±ÇÁöÑ‰ºòÂÖàÁ∫ßËøõË°åÂà§Êñ≠ÔºåÁÑ∂Âêé‰ªé read_pool Á∫øÁ®ãÊ±†‰∏≠ spawn ‰∏Ä‰∏™ handleÔºåÂπ∂‰∏∫ËØ• handle ÊåáÂÆöËß£ÊûêÂá∫Êù•ÁöÑ ‚Äú‰ºòÂÖàÁ∫ß‚Äù Âú®Â≠òÂÇ®Â±ÇÊâßË°åËØ∑Ê±ÇÔºåÂÖ≥‰∫é SQL ‰ºòÂÖàÁ∫ßËØ¶ËßÅ --> [force-priority ËØ¥Êòé](https://docs.pingcap.com/zh/tidb/stable/tidb-configuration-file#force-priority)„ÄÇ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; **3. ÂÜçÊ¨°**Ôºåprepare_snap_ctx(...) ‰ºöËøõË°åÂÜÖÂ≠òÈîÅÂÜ≤Á™ÅÊ£ÄÊü•ÔºåÂπ∂Âü∫‰∫é key„ÄÅstart_ts Á≠â‰ø°ÊÅØÊûÑÈÄ† snapshot context„ÄÇ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; **4. ÁÑ∂Âêé**ÔºåÈÄöËøá‰º†ÂÖ• snap_ctx ,Âú® [`let snapshot = Self::with_tls_engine(|engine| Self::snapshot(engine, snap_ctx)).await?;`](https://github.com/tikv/tikv/blob/005efd56d3405b72a26bf623b5895cf3d9da0a6f/src/storage/mod.rs#L566) Ê≠•ÊûÑÈÄ†Âá∫Â≠òÂÇ®ÂºïÊìéÁöÑ snapshot„ÄÇ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; **5. ÊúÄÂêé**ÔºåÂπ∂Âú® [`let result = snap_store.get(&key, &mut statistics)});`](https://github.com/tikv/tikv/blob/005efd56d3405b72a26bf623b5895cf3d9da0a6f/src/storage/mod.rs#L581-L588) ‰∏≠Ëé∑Âèñ result ÁªìÊûú„ÄÇ

```rust
pub fn get(
        &self,
        mut ctx: Context,
        key: Key,
        start_ts: TimeStamp,
    ) -> impl Future<Output = Result<(Option<Value>, KvGetStatistics)>> {

        let priority = ctx.get_priority();

        let res = self.read_pool.spawn_handle(
            async move {

                let snap_ctx = prepare_snap_ctx(
                    &ctx,
                    iter::once(&key),
                    start_ts,
                    &bypass_locks,
                    &concurrency_manager,
                    CMD,
                )?;
                let snapshot = Self::with_tls_engine(|engine| Self::snapshot(engine, snap_ctx)).await?;
                {
                    let snap_store = SnapshotStore::new(
                        snapshot,
                        start_ts,
                        ctx.get_isolation_level(),
                        !ctx.get_not_fill_cache(),
                        bypass_locks,
                        access_locks,
                        false,
                    );
                    let result = snap_store.get(&key, &mut statistics)});

                    Ok((
                        result?,
                        KvGetStatistics {
                            stats: statistics,
                            perf_stats: delta,
                            latency_stats,
                        },
                    ))
                }
            }
            .in_resource_metering_tag(resource_tag),
            priority,
            thread_rng().next_u64(),
        );
    }

```

#### 3.2.3 KV RocksDB Snapshot Deal

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**1. È¶ñÂÖà**Ôºå**‰ªé 3.2.2 Á¨¨ 4 Ê≠•ÊûÑÈÄ† snapshot ÈÉ®ÂàÜÊ∑±ÂÖ•**Ôºå‰ªîÁªÜ DEBUG ‰ºöÂèëÁé∞ÊûÑÈÄ† snapshot ‰πãÂâç [fn async_snapshot(...)](https://github.com/tikv/tikv/blob/005efd56d3405b72a26bf623b5895cf3d9da0a6f/src/server/raftkv.rs#L420) ‰ºöÂèëËµ∑ ReadIndex ÔºåÂà§Êñ≠Ê≠§Êó∂ leader ÊòØÂê¶ÁúüÁöÑÊòØ leader „ÄÇÊó©Êúü Read Index ÊòØÈÄöËøáÂèëÈÄÅ‰∏ÄÊ¨°ÂøÉË∑≥ÁöÑÊñπÂºèÂÆûÁé∞ÁöÑÔºå[ÂÖ≥‰∫é read index ËØ¶ÊÉÖÂèÇËÄÉ --> TiKV ÂäüËÉΩ‰ªãÁªç - Lease Read](https://pingcap.com/zh/blog/lease-read)„ÄÇÈöèÂêé TiKV ÂºïÂÖ• Lease Read ‰ºòÂåñÔºå[ÂÖ∑‰ΩìÊ¶ÇÂøµÂèäÁî±Êù•ÂèÇËÄÉ --> read index Âíå local read ÊÉÖÊôØÂàÜÊûê](https://pingcap.com/zh/blog/tikv-source-code-reading-19)ÔºåÂÖ≥‰∫éÊú¨‰æãÁÇπÊü• Lease Read ÈÉ®ÂàÜÈÄªËæëÂú® [pub fn propose_raft_command](https://github.com/tikv/tikv/blob/005efd56d3405b72a26bf623b5895cf3d9da0a6f/components/raftstore/src/store/worker/read.rs#L606-L689) ÂáΩÊï∞‰∏ã„ÄÇ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; **2. ÂÖ∂Ê¨°**Ôºå**‰ªé 3.2.2 Á¨¨ 5 Ê≠•ÊûÑÈÄ† snap_store.get(...) ÈÉ®ÂàÜÊ∑±ÂÖ•**ÔºåÂØπ‰∫éÁÇπÊü•‰ºöÊûÑÈÄ†‰∏Ä‰∏™ point_getter ÔºåÂÜç get ÂØπÂ∫î value,Â§ßÊ¶ÇÈÄªËæëÊòØÈÄöËøá‰∫ãÂä°ÁöÑÈöîÁ¶ªÁ∫ßÂà´ÂàÜÊîØÂ§ÑÁêÜÔºàÁé∞Èò∂ÊÆµÊâÄÊúâËØ∑Ê±ÇÂùáÊòØ SI ÈöîÁ¶ªÁïåÂà´Ôºâ„ÄÇÂú® SI ÂàÜÊîØ‰∏≠ÔºåÈíàÂØπËØ• User Key Êâ´‰∏ÄÈÅç lock CF ,ËØ¶ÊÉÖÂèÇËßÅ‰ª£Á†Å --> [`impl<S: Snapshot> PointGetter<S>`](https://github.com/tikv/tikv/blob/005efd56d3405b72a26bf623b5895cf3d9da0a6f/src/storage/mvcc/reader/point_getter.rs#L202-L210)Ôºõ Âõ†‰∏∫Ëá™Âä®Êèê‰∫§ÁöÑÁÇπÊü•‰ΩøÁî® max_tsÔºåÊâÄ‰ª•Ëøô‰∏ÄÊ≠•‰ºöËøîÂõûÁ©∫ÔºåÊÑèÂë≥ÁùÄÊü•ËØ¢ÊúÄÊñ∞ÁöÑÂ∑≤Êèê‰∫§ÁöÑ Default CF Êï∞ÊçÆÂç≥ÂèØ„ÄÇ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; **3. ÊúÄÂêé**ÔºåÊéíÈô§ÈîÅ‰ø°ÊÅØÂêéÔºåËøõÂÖ• load_data(user_key) ‰ºöËµ∑‰∏Ä‰∏™ loop ÔºåÊûÑÈÄ†‰∏Ä‰∏™ÂåÖÂê´ cursor ÁöÑWriteRef ‰∏çÊñ≠ÁöÑÊâ´ Write CF„ÄÇÂõ†‰∏∫‰∫ãÂä°Êèê‰∫§ÂêéÔºå‰ºöÂú® Write CF ‰∏≠ÂÜô‰∏Ä‰∏™ key ‰∏∫ {user_key}{commit_ts}Ôºåvalue ‰∏∫ {type}{start_ts} ÁöÑËÆ∞ÂΩïÔºåÊâÄ‰ª•Êâ´ PUT Á±ªÂûãÁöÑ Write CF ÊÑèÂë≥ÁùÄÂèØ‰ª•Âà§Êñ≠Âá∫ÔºöÊü•ËØ¢ÁöÑÊï∞ÊçÆÊòØÂê¶Â≠òÂú® Write CF ‰∏≠ÔºåÂõ†‰∏∫ [MVCC Êï∞ÊçÆËØªÂèñ](https://pingcap.com/zh/blog/tikv-source-code-reading-13) ÊåáÂá∫Â∞è‰∫é 64 Â≠óËäÇÁöÑÊï∞ÊçÆ‰ºöÁõ¥Êé•ÂÜÖÂµåÂú® Lock Info Êàñ Write InfoÔºåÂê¶ÂàôË∞ÉÁî® load_data_from_default_cf(...) ‰ªé Default CF ‰∏≠Ëé∑ÂèñÊü•ËØ¢ÁöÑÁªìÊûúÂÄº„ÄÇ

```rust
fn load_data(&mut self, user_key: &Key) -> Result<Option<Value>> {

        loop {
            let write = WriteRef::parse(self.write_cursor.value(&mut self.statistics.write))?;

            match write.write_type {
                WriteType::Put => {
                    match write.short_value {
                        Some(value) => {
                            // Value is carried in `write`.
                            self.statistics.processed_size += user_key.len() + value.len();
                            println!("-short-->{}<]]></description>
            <content:encoded><![CDATA[<h2 id="‰∏Ä„ÄÅÂâçË®Ä" tabindex="-1">‰∏Ä„ÄÅÂâçË®Ä <a class="header-anchor" href="#‰∏Ä„ÄÅÂâçË®Ä" aria-label="Permalink to &quot;‰∏Ä„ÄÅÂâçË®Ä&quot;"></a></h2>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ê≠§ÂâçÔºå‰Ωú‰∏∫ DBA ËßâÂæóËÉΩÁúãÊ∫êÁ†ÅÊòØ‰∏Ä‰ª∂ÂæàÁâõÁöÑ‰∫ãÊÉÖÔºåËä±‰∫Ü<strong>Â§ßÂçäÂπ¥Êó∂Èó¥</strong>ÂØπ Golang Âíå Rust ÂÖ•‰∫Ü‰∏™Èó®Ôºà<strong>ÂèØËÉΩÂÖ•Èó®ÈÉΩ‰∏çÁÆó</strong>ÔºâÔºåÂπ∂ÂÜô‰∫Ü‰∏™ Rust Â∞èÂ∑•ÂÖ∑: <a href="https://github.com/jansu-dev/tihc" target="_blank" rel="noreferrer">TiHC(TiDB Healthy Check)</a> ÊúâÂÖ¥Ë∂£ÁöÑÂ∞è‰ºô‰º¥ÂèØ‰ª•Ëá™Âèñ„ÄÇ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÊúüÈó¥ÔºåÁúãËøáÊüê‰∫õÊ®°ÂùóÔºåÂ¶ÇÔºö<a href="https://asktug.com/t/topic/242808" target="_blank" rel="noreferrer">PD Â¶Ç‰ΩïË∞ÉÂ∫¶ Region</a>Ôºå‰πüÂè™ÊòØÁ™•Êé¢Êï∞ÊçÆÂ∫ìÁöÑÂ±ÄÈÉ®ÂäüËÉΩÔºåÊÄªÊúâ‰∏ÄÁßç <strong>‚ÄúÊ†πÊú¨‰∏ç‰∫ÜËß£Êï∞ÊçÆÂ∫ìÈÄªËæëÊ¶ÇÂøµÂíå‰ª£Á†ÅÊòØÊÄéÊ†∑ÂÖ≥ËÅîÁöÑÔºÅ‚Äù</strong> ÁöÑÊÑüËßâ„ÄÇÂõ†Ê≠§ÂÄüÁùÄ <strong>‚ÄúÁÇπÊü•‚Äù</strong> ÈÅøÂºÄÂ§ßÈáèÂ§çÊùÇ‰ºòÂåñÂô®‰ª£Á†ÅÁöÑÊú∫‰ºöÔºåÂ∞ΩÂ∑±ÊâÄËÉΩÁöÑ‰∏≤ËÅî‰∏Ä‰∏ãÁÇπÊü•Âú® TiDB Âíå TiKV Èó¥ÁöÑÊâßË°åÊµÅÁ®ã„ÄÇ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ê≠§ÂêéÔºåË∂äÂèëËßâÂæó <strong>‚Äú‰∫ßÁ†î‚Äù</strong> Âèä <strong>‚Äú‰∫§‰ªò‚Äù</strong> ‰ª∑ÂÄºÁöÑ‰∏çÂêåÔºåÊØîÂ¶ÇÔºö‰∏çËÉΩËØ¥Áúã‰ª£Á†ÅÂ∞±ÂæàÁâõÔºåÂú®ÊñáÊ°£‰∏∞ÂØå„ÄÅ‰∫ßÂìÅÊàêÁÜüÁöÑÂâçÊèê‰∏ãÔºå<strong>Â≠¶‰π†ÊñáÊ°£ÊâçÊòØËæÉÂø´ÈÄü„ÄÅËæÉÂÖ®Èù¢„ÄÅËæÉÊúâ‰ª∑ÂÄºÁöÑÊñπÊ≥ï</strong>ÔºåÊõ¥Â§öÊÄùËÄÉËßÅÊÄªÁªìÈÉ®ÂàÜ„ÄÇ</p>
<blockquote>
<p><strong>Tips</strong>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.‰∏∫Èò≤Ê≠¢ÂêéÁª≠‰ª£Á†ÅÈáçÊûÑÂΩ±ÂìçÔºåÊú¨Ê¨°ÂØπ TiDB v5.3.0 tidb Âíå tikv ËøõË°åÊñ≠ÁÇπË∞ÉËØï„ÄÇ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.‰∏∫‰æø‰∫éËØªËÄÖÁêÜËß£ÔºåÂú®Êú¨ÊñáÈ¶ñÊ¨°Âá∫Áé∞ÁöÑÂáΩÊï∞ÊàñÊñπÊ≥ïÂùá‰ºöÁªôÂá∫ Github ÈîöÁÇπÈìæÊé•ÔºåÈáçÂ§çÂá∫Áé∞Â∞Ü‰∏çÂÜçÊ†áËÆ∞ URL ÈìæÊé•„ÄÇ</p>
</blockquote>
<h2 id="‰∫å„ÄÅÊëòË¶Å" tabindex="-1">‰∫å„ÄÅÊëòË¶Å <a class="header-anchor" href="#‰∫å„ÄÅÊëòË¶Å" aria-label="Permalink to &quot;‰∫å„ÄÅÊëòË¶Å&quot;"></a></h2>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Êú¨Êñá‰∏ªË¶ÅÂÜÖÂÆπÂàÜÂ∏ÉÂú® <strong>‚Äú‰∏â„ÄÅÁÇπÊü•ÊµÅÁ®ã‚Äù</strong>Ôºå<strong>‚Äú3.1 TiDB ÈÉ®ÂàÜ‚Äù<strong>‰ªãÁªç‰∫ÜÁÇπÊü• SQL Âú® TiDB ÂÜÖÈÉ®ÊµÅËΩ¨ËøáÁ®ã„ÄÇ</strong>‚Äú3.2 TiKV ÈÉ®ÂàÜ‚Äù<strong>‰ªãÁªç‰∫ÜÁÇπÊü•ÁªèÁî± TiDB Â§ÑÁêÜÂπ∂ËØ∑Ê±ÇÁªô TiKV ÂêéÔºåÂ¶Ç‰ΩïÂú® TiKV ÂÜÖÈÉ®ÊµÅËΩ¨„ÄÅÂ§ÑÁêÜ„ÄÅËøîÂõûÁöÑËøáÁ®ã„ÄÇ</strong>‚Äú3.3 ÊÄªÁªì‚Äù</strong> ÁÆÄË¶Å‰ªãÁªç‰∫Ü tidb ÁÇπÊü•Âø´ÁöÑÂéüÂõ†„ÄÇ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ÊØè‰∏™Ê®°ÂùóÁöÑ ‚ÄúModel Tips‚Äù Âùá‰ºöËØ¥ÊòéËØ•Ê®°ÂùóÂú® TIDB ÂêÑÊâÄÂ±ûÁªÑ‰ª∂‰∏≠ÁöÑ‰ΩúÁî®„ÄÇÂπ∂‰∏îÂ∞ΩÂäõÈááÁî®ÂàÜÂ±ÇÊèèËø∞ÁöÑÊñπÂºèËØ¥ÊòéÔºåÊâÄË∞ìÂàÜÂ±ÇÔºåÊØîÂ¶ÇÔºöExecutor Ë∞ÉÁî®‰∫Ü PD ClientÔºåÈÇ£‰πàÂè™Âú® Executor ÈÉ®ÂàÜÊèèËø∞ÈÇ£‰∏™ÂáΩÊï∞Ëß¶ÂèëË∞ÉÁî® PD Client ÁöÑÈÄªËæëÔºåËÄå‰∏çÂú®Ëøô‰∏ÄÂ±ÇËØ¶Ëø∞ PD Client Â¶Ç‰ΩïÂ∑•‰Ωú„ÄÇ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ÊúÄÂêéÔºåÂú® <strong>‚ÄúÂõõ„ÄÅÂ≠¶‰π†ÊÄªÁªì‚Äù</strong> ‰∏≠Ôºå‰ªãÁªç‰∫Ü<strong>‰∏™‰∫∫ÂØπ DBA ÁöÑÁúã‰ª£Á†ÅË°å‰∏∫ÁöÑ‰ª∑ÂÄº</strong>ÁöÑËßÇÁÇπ„ÄÇ</p>
<h2 id="‰∏â„ÄÅÁÇπÊü•ÊµÅÁ®ã" tabindex="-1">‰∏â„ÄÅÁÇπÊü•ÊµÅÁ®ã <a class="header-anchor" href="#‰∏â„ÄÅÁÇπÊü•ÊµÅÁ®ã" aria-label="Permalink to &quot;‰∏â„ÄÅÁÇπÊü•ÊµÅÁ®ã&quot;"></a></h2>
<h3 id="_3-1-tidb" tabindex="-1">3.1 TiDB <a class="header-anchor" href="#_3-1-tidb" aria-label="Permalink to &quot;3.1 TiDB&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‰∏ãËø∞ <strong>3.1</strong> ÈÉ®ÂàÜÂùá‰∏∫ÁÇπÊü•Âú® TiDB ÁªÑ‰ª∂‰∏≠Ê∂âÂèäÂ§ÑÁêÜÊµÅÁ®ã‰ªãÁªç„ÄÇÂ§ßËá¥Â¶Ç‰∏ãÂõæÔºö
<strong>1. È¶ñÂÖà</strong>ÔºåÂÆ¢Êà∑Á´ØËøûÊé•ËøõÂÖ• MySQL Protocol Layer Êé•ÂÖ• TiDB ÔºåÂú®Ëé∑Âèñ TokenÂêéÔºå‰º†ÈÄÅ SQL ÊâßË°åÔºõ
<strong>2. ÂÖ∂Ê¨°</strong>ÔºåSQL Â§ÑÁêÜËøõÂÖ• Parser Â±ÇÔºåËß£ÊûêÊàê ASTÔºàÊäΩË±°ËØ≠Ê≥ïÊ†ëÔºâÔºõ
<strong>3. ÂÜçÊ¨°</strong>ÔºåSQL Â§ÑÁêÜËøõÂÖ• Compile Â±ÇÔºåÈÄâÂá∫ TSO Âπ∂Â∞Ü AST ÁºñËØëÊàêÊâßË°åËÆ°ÂàíÔºõ<br>
<strong>4. ÁÑ∂Âêé</strong>ÔºåSQL Â§ÑÁêÜËøõÂÖ• Executor Â±Ç<a href="https://github.com/pingcap/tidb/blob/ad9430039f54bb9af78d44831c176bc5eafcbba0/executor/executor.go#L249-L265" target="_blank" rel="noreferrer">ÔºàÂèØ ‚ÄúBatch Â§ÑÁêÜ‚Äù ÁöÑÁÅ´Â±±Ê®°ÂûãÔºâ</a>ÔºåÂ∞ÜÊâßË°åËÆ°Âàí Open„ÄÅNext„ÄÅClose ÂÆåÊàê TiKV Êï∞ÊçÆËé∑Âèñ;<br>
<strong>5. ÊúÄÂêé</strong>ÔºåSQL Â§ÑÁêÜÂõûÂà∞ MySQL Protocol Layer Ë∞ÉÁî® writeChunks Â∞Ü MemBuffer ‰∏≠Êï∞ÊçÆÂØºÂá∫ÊàêÂÆ¢Êà∑Á´ØÊâÄÈúÄÂΩ¢ÂºèËøîÂõûÔºõ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÈÄöËøáËøΩÊ∫Ø func (cc *clientConn) handleQuery(...) --&gt; func (cc *clientConn) handleStmt(...) --&gt; func (tc *TiDBContext) ExecuteStmt(...) ÊòØ‰∏≤ËÅîÁÇπÊü•Ôºå‰ªéËß£Êûê„ÄÅÁºñËØë„ÄÅÊâßË°å„ÄÅÂçèËÆÆÂõûÊòæÁöÑÊñπÊ≥ïÔºåÁúãÊáÇÊ≠§ÂáΩÊï∞ÂØπ‰∫éÁêÜËß£ÂÖ®ÊñáËá≥ÂÖ≥ÈáçË¶Å„ÄÇ</p>
<figure><img src="./../../../../../images/tidb/07TiDB-CodeReading/01tidb-arch.jpg" alt="01tidb-arch" tabindex="0"><figcaption>01tidb-arch</figcaption></figure>
<h4 id="_3-1-1-sql-protol-deal" tabindex="-1">3.1.1 SQL Protol Deal <a class="header-anchor" href="#_3-1-1-sql-protol-deal" aria-label="Permalink to &quot;3.1.1 SQL Protol Deal&quot;"></a></h4>
<blockquote>
<p><strong>Model Tips:</strong>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TiDB SQL Protol Â§ÑÁêÜÂ±Ç‰ªÖÊòØ TiDB ‰∏∫ÂÆûÁé∞ MySQL Protocol ÂÖºÂÆπÔºåÊâÄÂÅöÁöÑ‰ª£Á†ÅÂ§ÑÁêÜ„ÄÇ ‰∏ªË¶ÅÂäüËÉΩÂåÖÂê´ÔºöÁõëÂê¨ÂÆ¢Êà∑Á´ØËØ∑Ê±Ç„ÄÅÂàÜÂèë‰∏çÂêå SQL Â§ÑÁêÜ„ÄÅË∞ÉÁî® Parser„ÄÅCompiler„ÄÅExecutor ÂÆåÊàê SQL Â§ÑÁêÜÔºåÂõûÂÜôÁªìÊûúÈõÜÁ≠âÂäüËÉΩ„ÄÇ</p>
</blockquote>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>1. È¶ñÂÖà</strong>ÔºåÂêØÂä® Server Êó∂Âú® Struct clientConn ÂÜÖÈÉ®Â∞ÅË£Ö‰∫Ü go ÂéüÁîüÂåÖ net ËøõË°å TCP ÈÄö‰ø°ÔºåÂπ∂Âú® for Âæ™ÁéØËµ∑‰∏§‰∏™ Listener goroutine Â§ÑÁêÜÂÆ¢Êà∑Á´ØÂèëËøáÊù•ÁöÑÊ∂àÊÅØ„ÄÇ</p>
<div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// Run runs the server.</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">func</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">s </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Server</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Run</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> go</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> s.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">startNetworkListener</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(s.listener, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, errChan)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> go</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> s.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">startNetworkListener</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(s.socket, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, errChan)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">        ......</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">func</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">s </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Server</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">startNetworkListener</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">listener</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> net</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Listener</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">isUnixSocket</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> bool</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">errChan</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> chan</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  conn, err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> listener.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Accept</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">        ......</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  go</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> s.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">onConn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(clientConn)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">     }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
</div><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>2. ÂÖ∂Ê¨°</strong>ÔºåÂú® Dispatch ÊñπÊ≥ï‰∏≠‰ºöÈ¶ñÂÖàËé∑Âèñ <a href="https://github.com/pingcap/tidb/blob/ad9430039f54bb9af78d44831c176bc5eafcbba0/server/conn.go#L1291" target="_blank" rel="noreferrer">token</a> ÔºåÁî®‰∫éÈôêÂà∂Âçï‰∏™ TiDB Instance ÂèØÂ§ÑÁêÜÁöÑÂêåÊó∂ÊâßË°åËØ∑Ê±ÇÁöÑ session ‰∏™Êï∞,ËØ¶ÊÉÖËßÅ: <a href="https://docs.pingcap.com/zh/tidb/v4.0/tidb-configuration-file/#token-limit" target="_blank" rel="noreferrer">token-limit</a>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>3. ÂÜçÊ¨°</strong>ÔºåÂú®  <a href="https://github.com/pingcap/tidb/blob/bc7304c99538643e2464d884da627979cbfddf02/server/conn.go#L172" target="_blank" rel="noreferrer">Struct clientConn</a> ÂÆûÁé∞‰∫Ü Run„ÄÅreadPacket„ÄÅwritePacket„ÄÅhandshake„ÄÅopenSession„ÄÅhandleQuery„ÄÅhandleStmt Á≠âÁ≠âÊñπÊ≥ïÔºåÁî®‰∫éÂÆûÁé∞ <a href="https://dev.mysql.com/doc/internals/en/overview.html" target="_blank" rel="noreferrer">MySQL Client/Server Protocol</a>„ÄÇÊú¨‰æã‰∏≠Ôºå‰ªé MySQL Client ÂèëÊù•ÁöÑÁÇπÊü• SQL ÈÄöËøá <a href="https://github.com/pingcap/tidb/blob/ad9430039f54bb9af78d44831c176bc5eafcbba0/server/conn.go#L1237" target="_blank" rel="noreferrer">dispatch ÊñπÊ≥ï</a> ÈÅµÁÖß MySQL Protocol ËøõÂÖ• <a href="https://github.com/pingcap/tidb/blob/ad9430039f54bb9af78d44831c176bc5eafcbba0/server/conn.go#L1341" target="_blank" rel="noreferrer">handleQuery</a> ÂàÜÊîØÂ§ÑÁêÜÔºõ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>4. ÁÑ∂Âêé</strong>ÔºåhandleQuery ‰ºöÂæ™ÁéØÂ§ÑÁêÜ Session ‰∏≠ÊØè‰∏Ä‰∏™ SQLÔºåÂú® handleStmt ‰∏≠ÂØπÊØè‰∏ÄÊù° SQL ËøõË°åËß£Êûê„ÄÅÁºñËØë„ÄÅÊâßË°åÔºõ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>5. ÊúÄÂêé</strong>ÔºåÂú® handleStmt ‰∏≠Ë∞ÉÁî® writeResultset ÊñπÊ≥ïÔºåËß¶ÂèëÁªÑÁªáÂ•ΩÁöÑ Executor ÁöÑ Next() ÊñπÊ≥ï‰ªé TiKV Ëé∑ÂèñÊï∞ÊçÆÔºõ</p>
<h4 id="_3-1-2-sql-parser-deal" tabindex="-1">3.1.2 SQL Parser Deal <a class="header-anchor" href="#_3-1-2-sql-parser-deal" aria-label="Permalink to &quot;3.1.2 SQL Parser Deal&quot;"></a></h4>
<blockquote>
<p><strong>Model Tips:</strong>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQL Parser Â§ÑÁêÜÂ±ÇÈÄöËøáÂ∞ÅË£Ö YACC ÂÆûÁé∞ MySQL ÁöÑËØçÊ≥ïËß£ÊûêÔºåÂ∞Ü SQL ËΩ¨Âåñ‰∏∫ AST„ÄÇ</p>
</blockquote>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>1. È¶ñÂÖà</strong>ÔºåÂú® handleQuery ‰∏≠ÔºåË∞ÉÁî® <a href="https://github.com/pingcap/tidb/blob/ad9430039f54bb9af78d44831c176bc5eafcbba0/server/conn.go#L1795" target="_blank" rel="noreferrer">func (s *session) Parse(...)</a> ÊñπÊ≥ïÂÆûÁé∞ AST ÁöÑËΩ¨Âåñ‰∏éËøîÂõûÔºõ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>2. ÂÖ∂Ê¨°</strong>ÔºåÊ∑±ÂÖ•‰∫ÜËß£‰ºöÂèëÁé∞ÔºåËØ• Parse ÊñπÊ≥ï‰∏∫Ë∞ÉÁî® <a href="https://github.com/pingcap/tidb/blob/27348d67951c5d9e409c84ca095f0e5d3332c1fd/session/session.go#L1459-L1489" target="_blank" rel="noreferrer">func (s *session) ParseSQL(...)</a> ÂáΩÊï∞ÂÆûÁé∞ÁúüÊ≠£ÁöÑËØçÊ≥ïËß£ÊûêÂä®‰ΩúÔºåÂπ∂ËÆ∞ÂΩïËß£Êûê SQL ÊòØÂê¶ÊàêÂäüÂèäËß£ÊûêËÄóË¥πÁöÑÊó∂Èó¥„ÄÇ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>3. ÊúÄÂêé</strong>ÔºåËøõÂÖ• <a href="https://github.com/pingcap/tidb/blob/27348d67951c5d9e409c84ca095f0e5d3332c1fd/session/session.go#L1298-L1318" target="_blank" rel="noreferrer">func (s *session) Parse(...)</a> È¶ñÂÖàÂ∞ÅË£Ö‰∏Ä‰∏™ sync.Pool ‰Ωú‰∏∫ parserPool ÂáèËΩª GC struct ÁöÑÂéãÂäõÔºåÂπ∂ Copy AST ÁªìÊûúËøîÂõûÁªô‰∏äÂ±ÇË∞ÉÁî®ÔºåÂÜçÊ∑±Â±Ç DEBUG Â∞Ü‰ºöËøõÂÖ• Parser Ê®°Âùó„ÄÇ</p>
<div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">func</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">s </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">session</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ParseSQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">ctx</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">sql</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">params</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> ...</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">parser</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ParseParam</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) ([]</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ast</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">StmtNode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, []</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> ......</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> p </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> parserPool.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">().(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">parser</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Parser</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> defer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> parserPool.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Put</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(p)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> p.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SetSQLMode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(s.sessionVars.SQLMode)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> p.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SetParserConfig</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(s.sessionVars.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">BuildParserConfig</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">())</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> tmp, warn, err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> p.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ParseSQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(sql, params</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> res </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> make</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">([]</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ast</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">StmtNode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(tmp))</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> copy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(res, tmp)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> res, warn, err</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
</div><h4 id="_3-1-3-sql-compile-deal" tabindex="-1">3.1.3 SQL Compile Deal <a class="header-anchor" href="#_3-1-3-sql-compile-deal" aria-label="Permalink to &quot;3.1.3 SQL Compile Deal&quot;"></a></h4>
<blockquote>
<p><strong>Model Tips:</strong>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQL Compiler Â§ÑÁêÜÂ±ÇÂÆåÊàê SQL ËØ≠ÊÑèÊ£ÄÊü•(Preprocess)„ÄÅÁºñËØëÊâßË°åËÆ°Âàí(Logical Optimize„ÄÅPhysical Optimize) Â∑•‰ΩúÔºåÂ∞Ü SQL ÁºñËØëÊàêÂèØÊâßË°åÁöÑÁâ©ÁêÜÊâßË°åËÆ°Âàí„ÄÇ</p>
</blockquote>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>1. È¶ñÂÖà</strong>Ôºå‰ªé MySQL Protocol Layer ‰∏≤ËÅîËµ∑ ‚ÄúËß£Êûê‚Äù„ÄÅ‚ÄúÊâßË°å‚Äù Êìç‰ΩúÔºåÂπ∂Âú® <a href="https://github.com/pingcap/tidb/blob/27348d67951c5d9e409c84ca095f0e5d3332c1fd/session/session.go#L1735" target="_blank" rel="noreferrer">func (s *session) ExecuteStmt(...)</a> ‰∏≠Ë∞ÉÁî® <a href="https://github.com/pingcap/tidb/blob/27348d67951c5d9e409c84ca095f0e5d3332c1fd/executor/compiler.go#L51-L109" target="_blank" rel="noreferrer">func (c *Compiler) Compile(...)</a> ËøõË°åÁúüÊ≠£ÁöÑÁºñËØëÂ§ÑÁêÜ„ÄÇ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>2. ÂÖ∂Ê¨°</strong>ÔºåÂú® Compile ÂÜÖÈÉ®Ë∞ÉÁî® <a href="https://github.com/pingcap/tidb/blob/27348d67951c5d9e409c84ca095f0e5d3332c1fd/planner/core/preprocess.go#L114-L130" target="_blank" rel="noreferrer">func Preprocess(...)</a>ÔºåËøõË°å Preprocess ÂÆåÊàêÂâçÁΩÆÊ£ÄÊü•ÔºåÂ¶ÇÔºöËØ≠‰πâÊ£ÄÊü•„ÄÇÂÖ∑‰ΩìÂÆûÁé∞ÊµÅÁ®ã‰∏∫ÔºåÈÄöËøá AST ÁöÑ <a href="https://github.com/pingcap/tidb/blob/27348d67951c5d9e409c84ca095f0e5d3332c1fd/parser/ast/ast.go#L40" target="_blank" rel="noreferrer">Accept ÊñπÊ≥ï</a>, ÊûÑÈÄ†‰∏Ä‰∏™ Vistor ÂÆûÁé∞ÂØπ AST ÁöÑÈÅçÂéÜ„ÄÇ ÊØè‰∏™ Visitor Êé•Âè£ÂåÖÂê´ Enter„ÄÅLeave ÊñπÊ≥ïÔºå<a href="https://github.com/pingcap/tidb/blob/27348d67951c5d9e409c84ca095f0e5d3332c1fd/planner/core/preprocess.go#L192" target="_blank" rel="noreferrer">Âπ∂Âú® Enter Êàñ Leave Êó∂</a>Ôºå‰æùÊçÆ SQL Á±ªÂûãËøõË°åÂà§Êñ≠„ÄÇÊú¨‰æã point get ‰ºöË∑≥Âà∞ <a href="https://github.com/pingcap/tidb/blob/27348d67951c5d9e409c84ca095f0e5d3332c1fd/parser/ast/dml.go#L1391-L1503" target="_blank" rel="noreferrer">func (n *SelectStmt) Accept(v Visitor)</a> ‰∏≠Ôºå‰∏çÊñ≠ÂàÜÊîØÂ§ÑÁêÜÂÆåÊàêÈÅçÂéÜ„ÄÇËØ¶ÊÉÖÂèÇËÄÉ <a href="https://www.bilibili.com/video/BV1m4411g7Yy?from=search&amp;seid=10358982920062599002&amp;spm_id_from=333.337.0.0" target="_blank" rel="noreferrer">TiDB Ê∫êÁ†ÅÈòÖËØª‰πã Compiler --&gt; ËøõÂ∫¶ 10min Â∑¶Âè≥</a>„ÄÇ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>3. ÊúÄÂêé</strong>ÔºåËøõÂÖ• Optimizer Â§ÑÁêÜÔºåÊú¨‰æã‰∏≠Âõ†‰∏∫ÊòØÁÇπÊü•‰ºöË∂äËøáÂ§ßÈáè‰ºòÂåñÂô®Â§ÑÁêÜËøáÁ®ãÔºåÁõ¥Êé•ËøõÂÖ• <a href="https://github.com/pingcap/tidb/blob/27348d67951c5d9e409c84ca095f0e5d3332c1fd/planner/optimize.go#L131" target="_blank" rel="noreferrer">func TryFastPlan(...)</a> ËøõË°åÁÆÄÂçïÁöÑ ‚ÄúÊùÉÈôêÊ£ÄÊü•‚Äù Âèä ‚ÄúÊï∞ÊçÆÂ∫ìÂêçÊ£ÄÊü•‚Äù„ÄÇ</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">//</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> TryFastPlan tries </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">to</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> the PointGetPlan </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> the query.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">func TryFastPlan(ctx </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">sessionctx</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, node </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">ast</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">Node</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) (p Plan) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    ......</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> case</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">ast</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">SelectStmt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> fp :</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> tryPointGetPlan(ctx, x, isForUpdateReadSelectLock(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">x</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">LockInfo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)); fp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> nil {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">   if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> checkFastPlanPrivilege(ctx, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">fp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">dbName</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">fp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">TblInfo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">Name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">L</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">SelectPriv</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> nil {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> nil</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">   if</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> tidbutil</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">IsMemDB</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">fp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">dbName</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> nil</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">   if</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> fp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">IsTableDual</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    return</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   p </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> fp</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">   return</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> nil</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
</div><h4 id="_3-1-4-sql-executor-deal" tabindex="-1">3.1.4 SQL Executor Deal <a class="header-anchor" href="#_3-1-4-sql-executor-deal" aria-label="Permalink to &quot;3.1.4 SQL Executor Deal&quot;"></a></h4>
<blockquote>
<p><strong>Model Tips:</strong>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQL Executor ÈÄöËøáÊé•Êî∂ÁªèËøá Optimizer ÁöÑ PlanÔºåÂπ∂ÊûÑÈÄ†„ÄÅÊâßË°åÁÅ´Â±±Ê®°ÂûãËé∑ÂèñÊâßË°åÁªìÊûúÔºåÁÅ´Â±±Ê®°ÂûãËØ¶ËßÅ <a href="https://zhuanlan.zhihu.com/p/219516250" target="_blank" rel="noreferrer">Áü•‰πé -- SQL ‰ºòÂåñ‰πãÁÅ´Â±±Ê®°Âûã</a>„ÄÇ</p>
</blockquote>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>1. È¶ñÂÖà</strong>ÔºåÂú® <a href="https://github.com/pingcap/tidb/blob/ad9430039f54bb9af78d44831c176bc5eafcbba0/session/session.go#L1757" target="_blank" rel="noreferrer">func (s *session) ExecuteStmt(...)</a> ‰∏≠Ë∞ÉÁî®  <a href="https://github.com/pingcap/tidb/blob/ad9430039f54bb9af78d44831c176bc5eafcbba0/session/session.go#L1880" target="_blank" rel="noreferrer">func (a *ExecStmt) Exec(...)</a>ÔºåË∞ÉÁî® <a href="https://github.com/pingcap/tidb/blob/ad9430039f54bb9af78d44831c176bc5eafcbba0/executor/adapter.go#L407" target="_blank" rel="noreferrer">Open()</a> ÊñπÊ≥ï‰ªéËÄåÂÆåÊàê Executor ÂèòÂºÇÁâàÁÅ´Â±±Ê®°ÂûãÁöÑÊûÑÈÄ†ÔºåÊúÄÂêéËøîÂõû‰∏Ä‰∏™ RecordSet„ÄÇ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>2. ÂÖ∂Ê¨°</strong>ÔºåExecuteStmt ËøîÂõûÁöÑ RecordSet ÂåÖÂê´‰∫Ü Executor ÈúÄË¶ÅÁöÑÊâÄÊúâ‰ø°ÊÅØÔºåÊ≠§Êó∂ÂèØ‰ª•Êää RecordSet ÂΩìÊàêËøîÂõûÁöÑÁªìÊûúÈõÜÔºå‰ΩÜËØ•ÊâßË°åÊµÅ‰ªéÊú™Ëß¶ÂèëËøá Next() ÊñπÊ≥ïÔºåÂç≥ÔºöÊ≤°ÊúâÁúüÊ≠£ÁöÑËé∑ÂèñÊï∞ÊçÆ„ÄÇ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>3. ÊúÄÂêé</strong>ÔºåÂÆûÈôÖ‰∏ä NextÔºàÔºâ Ëß¶ÂèëÁî±  ÁöÑ writeResultset Ëß¶Âèë,ËØ¶ÁªÜÊµÅÁ®ãÂ¶Ç‰∏ãÔºö<strong>func (cc *clientConn) handleStmt(...) --&gt; func (cc *clientConn) writeResultset(...) --&gt; func (cc *clientConn) writeChunks(...) --&gt; func (trs *tidbResultSet) Next(...) --&gt; func (a *recordSet) Next(...) --&gt; func Next(...) --&gt; func (e *PointGetExecutor) Next(...) --&gt; func (e *PointGetExecutor) Next(...) --&gt; func (e *PointGetExecutor) getAndLock(...) --&gt; func (e *PointGetExecutor) get(...)</strong> Â±ÇÂ±ÇË∞ÉÁî®ÔºåÁõ¥Ëá≥ Executor ÂÆåÊàêÊâÄÊúâÊï∞ÊçÆÁöÑËé∑Âèñ„ÄÇ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>4. Âè¶Â§ñ</strong>ÔºåÂÄºÂæó‰∏ÄÊèêÁöÑÊòØÂú® func (a *ExecStmt) Exec(...) --&gt; Build Executor Êó∂ÔºåÂõ†‰∏∫ÁÇπÊü•‰ΩøÁî®‚Äú‰∏ªÈîÆ‚ÄùÊàñ‚ÄúÂîØ‰∏ÄÁ¥¢Âºï‚ÄùÊ†áÂÆö‰∏ÄË°åÔºå<strong>‰∏çÂ≠òÂú®ÈáçÂ§çÊï∞ÊçÆËØª</strong>ÔºåÊâÄ‰ª•Âú® <code>autoCommit</code> ÊÉÖÂÜµ‰∏ãÁõ¥Êé•Âèñ <code>MaxUint64</code> ‰Ωú‰∏∫‰∫ãÂä°ÁöÑ StartTSÔºàËØ•‰∫ãÂä°Âè™Êúâ‰∏Ä‰∏™ÁÇπÊü•ÔºâÔºåÂç≥ÔºöÊó†Á©∑Â§ß +‚àû„ÄÇÂêåÊó∂ÔºåËøò‰ºöËµã‰∫à <code>PriorityHigh</code> ‰ºòÂÖàÁ∫ßËøõË°åÂ§ÑÁêÜÔºåËØ¶ÊÉÖËßÅ <a href="https://docs.pingcap.com/zh/tidb/v5.2/tidb-configuration-file/#force-priority" target="_blank" rel="noreferrer">force-priority</a>„ÄÇ</p>
<div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">func</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">a </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ExecStmt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">buildExecutor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">() (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Executor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">        ......</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">   // Do not sync transaction for Execute statement, because the real optimization work is done in</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">   // "ExecuteExec.Build".</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   useMaxTS, err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> plannercore.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">IsPointGetWithPKOrUniqueKeyByAutoCommit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(ctx, a.Plan)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">   if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> useMaxTS {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ctx.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">InitTxnWithStartTS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(math.MaxUint64); err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> nil</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">     return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> nil</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, err</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">   if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> stmtPri </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> stmtCtx.Priority; stmtPri </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> mysql.NoPriority {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    switch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    case</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> useMaxTS:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">     stmtCtx.Priority </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> kv.PriorityHigh</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    case</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> a.LowerPriority:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">     stmtCtx.Priority </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> kv.PriorityLow</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> b </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> newExecutorBuilder</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(ctx, a.InfoSchema, a.Ti, a.SnapshotTS, a.IsStaleness, a.ReplicaReadScope)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> e </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> b.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">build</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(a.Plan)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> e, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">nil</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
</div><h4 id="_3-1-5-tikv-pd-client-deal" tabindex="-1">3.1.5 TiKV &amp; PD Client Deal <a class="header-anchor" href="#_3-1-5-tikv-pd-client-deal" aria-label="Permalink to &quot;3.1.5 TiKV &amp; PD Client Deal&quot;"></a></h4>
<blockquote>
<p><strong>Model Tips:</strong>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TiKV Client Ë¢´Â∞ÅË£ÖÂú® TiDB ‰æßÔºå‰∏ªË¶ÅÊâøÊãÖ‰ªé TiKV Ëé∑Âèñ KV Êï∞ÊçÆÁöÑ‰ΩúÁî®„ÄÇ</p>
</blockquote>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>1. È¶ñÂÖà</strong>ÔºåÈÄöËøáÊâßË°åÊµÅËøΩÊ∫Ø func (s *tikvSnapshot) Get(...) --&gt; func (i *TemporaryTableSnapshotInterceptor) OnGet(...)  --&gt; func (s *tikvSnapshot) Get(...) ‰ºöÁõ¥Êé•Ë∞ÉÁî®Â∞ÅË£Ö‰∫Ü tikv client ÁöÑ tikvSnapshot ÁªìÊûÑ‰ΩìÁöÑ <a href="https://github.com/pingcap/tidb/blob/cd56aba07e9c9c2a87df5f28fe9d81a3e3dd50a8/store/driver/txn/snapshot.go#L58" target="_blank" rel="noreferrer">Get(...)</a> ÊñπÊ≥ïÔºå‰ªé TiKV Ëé∑Âèñ KV Êï∞ÊçÆ„ÄÇ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>2. ÂÖ∂Ê¨°</strong>ÔºåDEBUG Âà∞ TiKV Client ÂÜÖÈÉ®ÁªÜËäÇ‰ºöÂèëÁé∞ TiKV Client ÈÅµÁÖßÊú¨Âú∞ÁºìÂ≠òÊòØÂê¶Â≠òÂú®Êï∞ÊçÆÔºåÂ¶ÇÊûú‰∏çÂ≠òÂú®ÊûÑÈÄ†ËØ∑Ê±ÇÂ§¥ÔºåÂπ∂Âú® for{} Âæ™ÁéØ‰∏≠Ë∞ÉÁî® GetRegionCache() Êü•ËØ¢ PD Client ÁöÑ Region Cache Ëé∑ÂèñÊâÄË¶ÅÊü•ËØ¢ Region Âú® TiKV ‰∏≠ÁöÑ‰ΩçÁΩÆÔºåÂêë TiKV ÂèëÈÄÅËØ∑Ê±ÇËé∑ÂèñÊï∞ÊçÆ„ÄÇ‰πãÊâÄ‰ª•‰ΩøÁî® for Âæ™ÁéØÔºåÊòØÂõ†‰∏∫ Region Cache ‰ø°ÊÅØ‰ªé PD Ëé∑ÂèñÔºåÊâÄ‰ª•Âπ∂‰∏ç‰∏ÄÂÆöÊòØÊúÄÊñ∞ÁöÑ„ÄÅÊúÄÂáÜÁ°ÆÁöÑ Region Location ‰ø°ÊÅØÔºåÂåÖÂê´‰∏Ä‰∫õÈîôËØØÈáçÊãæÊìç‰Ωú,Â¶ÇÔºöEpochNotMatch Á≠âÁ≠âÔºåËØ¶ÊÉÖËßÅ: <a href="https://docs.google.com/document/d/1BHkeN8W2iWSdgWLK3U16QGwq9K7DA6Le7zxVhLPaQgc/edit" target="_blank" rel="noreferrer">Region Cache ÁºìÂ≠òÂíåÊ∏ÖÁêÜÈÄªËæëËß£Èáä</a> Êàñ <a href="https://pingcap.com/zh/blog/tidb-source-code-reading-18" target="_blank" rel="noreferrer">TiDB Ê∫êÁ†ÅÈòÖËØªÁ≥ªÂàóÊñáÁ´†ÔºàÂçÅÂÖ´Ôºâtikv-clientÔºà‰∏äÔºâ</a>„ÄÇ</p>
<div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">func</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">s </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">KVSnapshot</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">ctx</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">bo</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> *</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">retry</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Backoffer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">k</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> []</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">byte</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) ([]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">byte</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"> // Check the cached values first.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> s.mu.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">RLock</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> s.mu.cached </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> nil</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> value, ok </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> s.mu.cached[</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(k)]; ok {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   atomic.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">AddInt64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">&#x26;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">s.mu.hitCnt, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   s.mu.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">RUnlock</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">   return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> value, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">nil</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> s.mu.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">RUnlock</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> ......</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> s.mu.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">RLock</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> req </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> tikvrpc.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">NewReplicaReadRequest</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(tikvrpc.CmdGet,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  &#x26;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">kvrpcpb</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">GetRequest</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   Key:     k,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   Version: s.version,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  }, s.mu.replicaRead, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">&#x26;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">s.replicaReadSeed, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">kvrpcpb</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   Priority:         s.priority.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ToPB</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   NotFillCache:     s.notFillCache,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   TaskId:           s.mu.taskID,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   ResourceGroupTag: s.resourceGroupTag,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> s.mu.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">RUnlock</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  loc, err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> s.store.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">GetRegionCache</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">LocateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(bo, k)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  resp, _, _, err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> cli.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SendReqCtx</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(bo, req, loc.Region, client.ReadTimeoutShort, tikvrpc.TiKV, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">""</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, ops</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  regionErr, err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> resp.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">GetRegionError</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  val </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> cmdGetResp.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">GetValue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> val, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">nil</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
</div><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>3. ÊúÄÂêé</strong>ÔºåÂú® <a href="https://github.com/pingcap/tidb/blob/ad9430039f54bb9af78d44831c176bc5eafcbba0/executor/point_get.go#L215" target="_blank" rel="noreferrer">func (e *PointGetExecutor) Next(...)</a> Â§ÑÁêÜ‰∏≠‰ºöÈÄöËøá <code>isCommonHandleRead</code> ÊòØÊôÆÈÄöÊü•ËØ¢ËøòÊòØÁÇπÊü•ÔºåÁÇπÊü• executor ‰ºöÁõ¥Êé• get ËØ• key ÁöÑ value„ÄÇÁî±‰∫é TiDB KV ‰∏ªË¶Å‰ΩúÁî®ÊòØÂØπ TiKV Êï∞ÊçÆËé∑ÂèñÂ§ÑÁêÜÁöÑÂ∞ÅË£ÖÔºå‰æø‰∏çÂçïÁã¨ÊèêÂèñÊ®°ÂùóËµòËø∞„ÄÇ</p>
<div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// Next implements the Executor interface.</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">func</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">e </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">PointGetExecutor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Next</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">ctx</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">req</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> *</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">chunk</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Chunk</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> e.idxInfo </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> nil</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  if</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> isCommonHandleRead</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(e.tblInfo, e.idxInfo) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   handleBytes, err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> EncodeUniqueIndexValuesForKey</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(e.ctx, e.tblInfo, e.idxInfo, e.idxVals)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   e.handle, err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> kv.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">NewCommonHandle</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(handleBytes)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   e.idxKey, err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> EncodeUniqueIndexKey</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(e.ctx, e.tblInfo, e.idxInfo, e.idxVals, tblID)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   e.handleVal, err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> e.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(ctx, e.idxKey)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    ......</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> nil</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
</div><h3 id="_3-2-tikv" tabindex="-1">3.2 TiKV <a class="header-anchor" href="#_3-2-tikv" aria-label="Permalink to &quot;3.2 TiKV&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‰∏ãËø∞ <strong>3.2</strong> ÈÉ®ÂàÜÂùá‰∏∫ÁÇπÊü•Âú® TiKV ÁªÑ‰ª∂‰∏≠Ê∂âÂèäÂ§ÑÁêÜÊµÅÁ®ã‰ªãÁªç„ÄÇ</p>
<figure><img src="./../../../../../images/tidb/07TiDB-CodeReading/02tikv-arch.jpg" alt="02tikv-arch" tabindex="0"><figcaption>02tikv-arch</figcaption></figure>
<h4 id="_3-2-1-kv-grpc-service-deal" tabindex="-1">3.2.1 KV Grpc &amp; Service Deal <a class="header-anchor" href="#_3-2-1-kv-grpc-service-deal" aria-label="Permalink to &quot;3.2.1 KV Grpc &amp; Service Deal&quot;"></a></h4>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>1. È¶ñÂÖà</strong>ÔºåTiKV ËøõÁ®ãÂêØÂä®ÂêéÔºåÊâÄÊúâÁöÑ Grpc ËØ∑Ê±ÇÂ§ÑÁêÜÈÉΩÁî± Service Â±ÇÊé•ÁÆ°„ÄÇ‰Ωç‰∫é <code>src/server/service/kv.rs</code> Êñá‰ª∂‰∏≠Ôºå‰æãÂ¶ÇÊú¨Ê¨°ÁöÑÁÇπÊü•ËØ∑Ê±Ç‰ºöÁî± <a href="https://github.com/tikv/tikv/blob/005efd56d3405b72a26bf623b5895cf3d9da0a6f/src/server/service/kv.rs#L196" target="_blank" rel="noreferrer"><code>handle_request!(kv_get, future_get, GetRequest, GetResponse);</code></a> ËøôÊ†∑‰∏Ä‰∏™Â£∞ÊòéÂÆèÂ§ÑÁêÜÔºåË∞ÉÁî® future_get ÂºÇÊ≠•Â§ÑÁêÜ„ÄÇ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>2. ÂÖ∂Ê¨°</strong>Ôºå‰ªé Grpc ÁöÑËØ∑Ê±Ç‰∏≠Ëß£ÊûêÂá∫ key Á≠âÁõ∏ÂÖ≥‰ø°ÊÅØÔºå‰Ωú‰∏∫ÂèÇÊï∞‰º†ÈÄíË∞ÉÁî®Â≠òÂÇ®ÂºïÊìéÊñπÊ≥ï <a href="https://github.com/tikv/tikv/blob/005efd56d3405b72a26bf623b5895cf3d9da0a6f/src/server/service/kv.rs#L1302-L1305" target="_blank" rel="noreferrer">storage.get(...)</a> ËøõË°åÂÆûÈôÖÁöÑË∞ÉÁî®Â§ÑÁêÜ,ÂåÖÂê´ÊûÑÈÄ† snapshot„ÄÅËé∑Âèñ  value Á≠â„ÄÇ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>5. ÊúÄÂêé</strong>ÔºåÂú® v(value) ÂºÇÊ≠•ÁªìÊûúËé∑ÂèñÂêéÔºåÊûÑÈÄ† Grpc ËøîÂõûÁªôËØ∑Ê±ÇÁ´Ø„ÄÇ</p>
<div class="language-rust vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">fn</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> future_get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&#x3C;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">E</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Engine</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">L</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> LockManager</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">>(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    storage</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> &#x26;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Storage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&#x3C;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">E</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">L</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">>,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    mut</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> req</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> GetRequest</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> impl</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Future</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&#x3C;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Output</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> ServerResult</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&#x3C;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">GetResponse</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">>> {</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> v </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> storage</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        req</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">take_context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(),</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">        Key</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">from_raw</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(req</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">get_key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">()),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        req</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">get_version</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">()</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">into</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    );</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    async</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> move</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">        let</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> mut</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> resp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> GetResponse</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">default</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">            match</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> v {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                Ok</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">((val, stats)) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">                    match</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> val {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        Some</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(val) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> resp</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">set_value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(val),</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        None</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> resp</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">set_not_found</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                }</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                Err</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(e) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> resp</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">set_error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">extract_key_error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">&#x26;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">e)),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">            }</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">        Ok</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(resp)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
</div><h4 id="_3-2-2-kv-storage-readpool-deal" tabindex="-1">3.2.2 KV Storage ReadPool Deal <a class="header-anchor" href="#_3-2-2-kv-storage-readpool-deal" aria-label="Permalink to &quot;3.2.2 KV Storage ReadPool Deal&quot;"></a></h4>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>1. È¶ñÂÖà</strong>ÔºåËØ•ÂáΩÊï∞ÁöÑ‰ΩúÁî®ÊòØ‰ªé snapshot ‰∏≠ÔºåÊêúÂØªÊª°Ë∂≥ ‚ÄúÊï∞ÊçÆË°åÊèê‰∫§Êó∂Èó¥Êà≥ &lt; Êú¨Ê¨°Êï∞ÊçÆË°åÂèëËµ∑ËØ∑Ê±ÇÊó∂Èó¥Êà≥‚Äù Ë¶ÅÊ±ÇÁöÑÔºåÊó†ÈîÅÁöÑÔºå‰∏î MVCC Â§öÁâàÊú¨Êï∞ÊçÆ‰∏≠Êó∂Èó¥Êà≥ÊúÄÊñ∞ÁöÑËØ∑Ê±ÇË°åÊï∞ÊçÆ „ÄÇ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>2. ÂÖ∂Ê¨°</strong>ÔºåËßÇÂØüÂáΩÊï∞ÈÄªËæëÔºåÂÖà‰ºöÂØπËØ∑Ê±ÇÁöÑ‰ºòÂÖàÁ∫ßËøõË°åÂà§Êñ≠ÔºåÁÑ∂Âêé‰ªé read_pool Á∫øÁ®ãÊ±†‰∏≠ spawn ‰∏Ä‰∏™ handleÔºåÂπ∂‰∏∫ËØ• handle ÊåáÂÆöËß£ÊûêÂá∫Êù•ÁöÑ ‚Äú‰ºòÂÖàÁ∫ß‚Äù Âú®Â≠òÂÇ®Â±ÇÊâßË°åËØ∑Ê±ÇÔºåÂÖ≥‰∫é SQL ‰ºòÂÖàÁ∫ßËØ¶ËßÅ --&gt; <a href="https://docs.pingcap.com/zh/tidb/stable/tidb-configuration-file#force-priority" target="_blank" rel="noreferrer">force-priority ËØ¥Êòé</a>„ÄÇ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>3. ÂÜçÊ¨°</strong>Ôºåprepare_snap_ctx(...) ‰ºöËøõË°åÂÜÖÂ≠òÈîÅÂÜ≤Á™ÅÊ£ÄÊü•ÔºåÂπ∂Âü∫‰∫é key„ÄÅstart_ts Á≠â‰ø°ÊÅØÊûÑÈÄ† snapshot context„ÄÇ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>4. ÁÑ∂Âêé</strong>ÔºåÈÄöËøá‰º†ÂÖ• snap_ctx ,Âú® <a href="https://github.com/tikv/tikv/blob/005efd56d3405b72a26bf623b5895cf3d9da0a6f/src/storage/mod.rs#L566" target="_blank" rel="noreferrer"><code>let snapshot = Self::with_tls_engine(|engine| Self::snapshot(engine, snap_ctx)).await?;</code></a> Ê≠•ÊûÑÈÄ†Âá∫Â≠òÂÇ®ÂºïÊìéÁöÑ snapshot„ÄÇ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>5. ÊúÄÂêé</strong>ÔºåÂπ∂Âú® <a href="https://github.com/tikv/tikv/blob/005efd56d3405b72a26bf623b5895cf3d9da0a6f/src/storage/mod.rs#L581-L588" target="_blank" rel="noreferrer"><code>let result = snap_store.get(&amp;key, &amp;mut statistics)});</code></a> ‰∏≠Ëé∑Âèñ result ÁªìÊûú„ÄÇ</p>
<div class="language-rust vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">pub</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> fn</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">        &#x26;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">        mut</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ctx</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        key</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        start_ts</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> TimeStamp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    ) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> impl</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Future</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&#x3C;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Output</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&#x3C;(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Option</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&#x3C;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">>, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">KvGetStatistics</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)>> {</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">        let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> priority </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ctx</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">get_priority</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">        let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> res </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> self</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">read_pool</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">spawn_handle</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">            async</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> move</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">                let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> snap_ctx </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> prepare_snap_ctx</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">                    &#x26;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">ctx,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    iter</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">once</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">&#x26;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">key),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                    start_ts,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">                    &#x26;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">bypass_locks,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">                    &#x26;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">concurrency_manager,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">                    CMD</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                )</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">?</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">                let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> snapshot </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> Self</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">with_tls_engine</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">engine</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> Self</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">snapshot</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(engine, snap_ctx))</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">.await?</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">                    let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> snap_store </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> SnapshotStore</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">new</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                        snapshot,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                        start_ts,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                        ctx</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">get_isolation_level</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(),</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">                        !</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">ctx</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">get_not_fill_cache</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                        bypass_locks,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                        access_locks,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">                        false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                    );</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">                    let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> result </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> snap_store</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">&#x26;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">key, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">&#x26;mut</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> statistics)});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    Ok</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">((</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                        result</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">?</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        KvGetStatistics</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                            stats</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> statistics,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                            perf_stats</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> delta,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                            latency_stats,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                        },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                    ))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">            }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">            .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">in_resource_metering_tag</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(resource_tag),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">            priority,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            thread_rng</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">()</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">next_u64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        );</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    }</span></span></code></pre>
</div><h4 id="_3-2-3-kv-rocksdb-snapshot-deal" tabindex="-1">3.2.3 KV RocksDB Snapshot Deal <a class="header-anchor" href="#_3-2-3-kv-rocksdb-snapshot-deal" aria-label="Permalink to &quot;3.2.3 KV RocksDB Snapshot Deal&quot;"></a></h4>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>1. È¶ñÂÖà</strong>Ôºå<strong>‰ªé 3.2.2 Á¨¨ 4 Ê≠•ÊûÑÈÄ† snapshot ÈÉ®ÂàÜÊ∑±ÂÖ•</strong>Ôºå‰ªîÁªÜ DEBUG ‰ºöÂèëÁé∞ÊûÑÈÄ† snapshot ‰πãÂâç <a href="https://github.com/tikv/tikv/blob/005efd56d3405b72a26bf623b5895cf3d9da0a6f/src/server/raftkv.rs#L420" target="_blank" rel="noreferrer">fn async_snapshot(...)</a> ‰ºöÂèëËµ∑ ReadIndex ÔºåÂà§Êñ≠Ê≠§Êó∂ leader ÊòØÂê¶ÁúüÁöÑÊòØ leader „ÄÇÊó©Êúü Read Index ÊòØÈÄöËøáÂèëÈÄÅ‰∏ÄÊ¨°ÂøÉË∑≥ÁöÑÊñπÂºèÂÆûÁé∞ÁöÑÔºå<a href="https://pingcap.com/zh/blog/lease-read" target="_blank" rel="noreferrer">ÂÖ≥‰∫é read index ËØ¶ÊÉÖÂèÇËÄÉ --&gt; TiKV ÂäüËÉΩ‰ªãÁªç - Lease Read</a>„ÄÇÈöèÂêé TiKV ÂºïÂÖ• Lease Read ‰ºòÂåñÔºå<a href="https://pingcap.com/zh/blog/tikv-source-code-reading-19" target="_blank" rel="noreferrer">ÂÖ∑‰ΩìÊ¶ÇÂøµÂèäÁî±Êù•ÂèÇËÄÉ --&gt; read index Âíå local read ÊÉÖÊôØÂàÜÊûê</a>ÔºåÂÖ≥‰∫éÊú¨‰æãÁÇπÊü• Lease Read ÈÉ®ÂàÜÈÄªËæëÂú® <a href="https://github.com/tikv/tikv/blob/005efd56d3405b72a26bf623b5895cf3d9da0a6f/components/raftstore/src/store/worker/read.rs#L606-L689" target="_blank" rel="noreferrer">pub fn propose_raft_command</a> ÂáΩÊï∞‰∏ã„ÄÇ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>2. ÂÖ∂Ê¨°</strong>Ôºå<strong>‰ªé 3.2.2 Á¨¨ 5 Ê≠•ÊûÑÈÄ† snap_store.get(...) ÈÉ®ÂàÜÊ∑±ÂÖ•</strong>ÔºåÂØπ‰∫éÁÇπÊü•‰ºöÊûÑÈÄ†‰∏Ä‰∏™ point_getter ÔºåÂÜç get ÂØπÂ∫î value,Â§ßÊ¶ÇÈÄªËæëÊòØÈÄöËøá‰∫ãÂä°ÁöÑÈöîÁ¶ªÁ∫ßÂà´ÂàÜÊîØÂ§ÑÁêÜÔºàÁé∞Èò∂ÊÆµÊâÄÊúâËØ∑Ê±ÇÂùáÊòØ SI ÈöîÁ¶ªÁïåÂà´Ôºâ„ÄÇÂú® SI ÂàÜÊîØ‰∏≠ÔºåÈíàÂØπËØ• User Key Êâ´‰∏ÄÈÅç lock CF ,ËØ¶ÊÉÖÂèÇËßÅ‰ª£Á†Å --&gt; <a href="https://github.com/tikv/tikv/blob/005efd56d3405b72a26bf623b5895cf3d9da0a6f/src/storage/mvcc/reader/point_getter.rs#L202-L210" target="_blank" rel="noreferrer"><code>impl&lt;S: Snapshot&gt; PointGetter&lt;S&gt;</code></a>Ôºõ Âõ†‰∏∫Ëá™Âä®Êèê‰∫§ÁöÑÁÇπÊü•‰ΩøÁî® max_tsÔºåÊâÄ‰ª•Ëøô‰∏ÄÊ≠•‰ºöËøîÂõûÁ©∫ÔºåÊÑèÂë≥ÁùÄÊü•ËØ¢ÊúÄÊñ∞ÁöÑÂ∑≤Êèê‰∫§ÁöÑ Default CF Êï∞ÊçÆÂç≥ÂèØ„ÄÇ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>3. ÊúÄÂêé</strong>ÔºåÊéíÈô§ÈîÅ‰ø°ÊÅØÂêéÔºåËøõÂÖ• load_data(user_key) ‰ºöËµ∑‰∏Ä‰∏™ loop ÔºåÊûÑÈÄ†‰∏Ä‰∏™ÂåÖÂê´ cursor ÁöÑWriteRef ‰∏çÊñ≠ÁöÑÊâ´ Write CF„ÄÇÂõ†‰∏∫‰∫ãÂä°Êèê‰∫§ÂêéÔºå‰ºöÂú® Write CF ‰∏≠ÂÜô‰∏Ä‰∏™ key ‰∏∫ {user_key}{commit_ts}Ôºåvalue ‰∏∫ {type}{start_ts} ÁöÑËÆ∞ÂΩïÔºåÊâÄ‰ª•Êâ´ PUT Á±ªÂûãÁöÑ Write CF ÊÑèÂë≥ÁùÄÂèØ‰ª•Âà§Êñ≠Âá∫ÔºöÊü•ËØ¢ÁöÑÊï∞ÊçÆÊòØÂê¶Â≠òÂú® Write CF ‰∏≠ÔºåÂõ†‰∏∫ <a href="https://pingcap.com/zh/blog/tikv-source-code-reading-13" target="_blank" rel="noreferrer">MVCC Êï∞ÊçÆËØªÂèñ</a> ÊåáÂá∫Â∞è‰∫é 64 Â≠óËäÇÁöÑÊï∞ÊçÆ‰ºöÁõ¥Êé•ÂÜÖÂµåÂú® Lock Info Êàñ Write InfoÔºåÂê¶ÂàôË∞ÉÁî® load_data_from_default_cf(...) ‰ªé Default CF ‰∏≠Ëé∑ÂèñÊü•ËØ¢ÁöÑÁªìÊûúÂÄº„ÄÇ</p>
<div class="language-rust vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">fn</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> load_data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">&#x26;mut</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, user_key</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> &#x26;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-></span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&#x3C;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Option</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&#x3C;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">>> {</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">        loop</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">            let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> write </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> WriteRef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">parse</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">self</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">write_cursor</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">&#x26;mut</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> self</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">statistics</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">write))</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">?</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">            match</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> write</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">write_type {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                WriteType</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Put</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">                    match</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> write</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">short_value {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        Some</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(value) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">                            // Value is carried in `write`.</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">                            self</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">statistics</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">processed_size </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_key</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">();</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                            println!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"-short-->{}&#x3C;---"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">String</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">from_utf8_lossy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(value));</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">                            return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Ok</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Some</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">to_vec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">()));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                        }</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        None</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">                            let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> start_ts </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> write</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">start_ts;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">                            let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> value </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> self</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">load_data_from_default_cf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(start_ts, user_key)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">?</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                            println!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"-default-->{:?}&#x3C;---"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">String</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">from_utf8_lossy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">&#x26;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">value));</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">                            self</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">statistics</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">processed_size </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_key</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">                            return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Ok</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Some</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(value));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">            }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">            if</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> !</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">self</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">write_cursor</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">next</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">&#x26;mut</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> self</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">statistics</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">write) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">                return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Ok</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">None</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">            }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    }</span></span></code></pre>
</div><h3 id="_3-3-ÊÄªÁªì" tabindex="-1">3.3 ÊÄªÁªì <a class="header-anchor" href="#_3-3-ÊÄªÁªì" aria-label="Permalink to &quot;3.3 ÊÄªÁªì&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÁÆÄÂçïÊù•ËØ¥Ôºå‰∏ªË¶ÅÊòØÁÇπÊü•Áõ¥Êé•ÂèØÂü∫‰∫éÂîØ‰∏Ä Key ÂÆö‰ΩçÊâÄÈúÄ valueÔºåÊü•ËØ¢Êï∞ÊçÆËæÉÂ∞ëÔºåÂèà‰∏çÁî®Ëµ∞‰∫åÁ∫ßÁ¥¢ÂºïÂõûË°®ÂÆö‰ΩçÊï∞ÊçÆ„ÄÇÂÖ∂Ê¨° PointGet Ë∑≥Ëøá‰∫ÜÂ§ßÈáè‰ºòÂåñÂô®ÁöÑËßÑÂàô‰ºòÂåñÔºåÁõ¥Êé•Ëµ∞‰∫Ü FastPlan ËäÇÁúÅ‰∫Ü‰ºòÂåñÂô®ÈÉ®ÂàÜÁöÑÊó∂Èó¥„ÄÇÊúÄÂêéÔºå‰ΩøÂæóÁÇπÊü•Êàê‰∏∫‰∏Ä‰∏™ÊïàÁéáËæÉÈ´òÁöÑÊâßË°åËÆ°Âàí„ÄÇ</p>
<h2 id="Âõõ„ÄÅÂ≠¶‰π†ÊÄªÁªì" tabindex="-1">Âõõ„ÄÅÂ≠¶‰π†ÊÄªÁªì <a class="header-anchor" href="#Âõõ„ÄÅÂ≠¶‰π†ÊÄªÁªì" aria-label="Permalink to &quot;Âõõ„ÄÅÂ≠¶‰π†ÊÄªÁªì&quot;"></a></h2>
<h3 id="_4-1-ÁúãÊ∫êÁ†ÅÊù°‰ª∂" tabindex="-1">4.1 ÁúãÊ∫êÁ†ÅÊù°‰ª∂ <a class="header-anchor" href="#_4-1-ÁúãÊ∫êÁ†ÅÊù°‰ª∂" aria-label="Permalink to &quot;4.1 ÁúãÊ∫êÁ†ÅÊù°‰ª∂&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>È¶ñÂÖà</strong>ÔºåÈúÄË¶ÅÊ∏ÖÊ•öÁúãÊ∫êÁ†ÅÁöÑÁõÆÁöÑÔºåÊú¨‰∫∫‰Ωú‰∏∫‰∏Ä‰∏™ DBA Âá∫‰∫éÊÉ≥‰∫ÜËß£Êï∞ÊçÆÂ∫ì‰∫ßÂìÅÁöÑËßíÂ∫¶Âá∫ÂèëÔºåËßâÂæóÊª°Ë∂≥Â¶Ç‰∏ãÂá†ÁÇπÂü∫Êú¨Â∞±ÂèØ‰ª•ÂºÄÂßãÁúãÊ∫êÁ†Å‰∫Ü„ÄÇ1„ÄÅ2 ÁÇπÊòØÂü∫Á°ÄÔºå3 ÁÇπÊòØ‰øùÊåÅÁúã‰ª£Á†ÅÁöÑÂä®ÂäõÊ∫êÊ≥â„ÄÅÈ´òÊïàÊñπÊ≥ï„ÄÇ</p>
<ol>
<li>‰∫ÜËß£Âü∫Êú¨ÁºñÁ®ãËØ≠Ë®ÄËØ≠Ê≥ï„ÄÅËØ≠Ë®ÄÁâπÊÄß„ÄÅÂë®ËæπÁªÑ‰ª∂ÔºåÂ¶ÇÔºörust future„ÄÅrust ÊâÄÊúâÊùÉ„ÄÅgo gpm„ÄÅgo mod„ÄÅcargo„ÄÅMakefile ...... Á≠âÁ≠âÔºõ</li>
<li>ÊéåÊè°Êï∞ÊçÆÂ∫ìÁªÑ‰ª∂ÂäüËÉΩ„ÄÅÊµÅÁ®ã„ÄÅÊ¶ÇÂøµÔºåÂ¶ÇÔºöËß£Êûê„ÄÅÁºñËØë„ÄÅÊâßË°å„ÄÅÁÅ´Â±±Ê®°Âûã„ÄÅÂêëÈáèÊ®°Âûã„ÄÅÂ≠òÂÇ®Ê®°Âûã ...... Á≠âÁ≠âÔºõ</li>
<li>‰øùÊåÅÊåÅÁª≠Êé¢Á¥¢ÁöÑÁÉ≠ÊÉÖÔºåÂ§ö‰∏éÁ§æÂå∫ÂèäÁõ∏ÂÖ≥Áà±Â•ΩËÄÖ‰∫§ÊµÅÔºåÁªàÊúâ‰∏ÄÂ§©‰∏çÊáÇÂæóÊ®°Âùó‰ºöË¢´ÁúãÊáÇ„ÄÇ</li>
</ol>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>ÊúÄÂêé</strong>ÔºåÂÖ∂ÂÆûÂÖâÁúã‰ª£Á†ÅÂæàÂ§öÈÄªËæëÊÄùÊÉ≥ÊòØÁúã‰∏çÂá∫Êù•ÁöÑÔºåÈúÄÁªìÂêàÂÆòÁΩëÁöÑÊñáÁ´†„ÄÅ‰ΩúËÄÖÊâÄËÆ≤Ëø∞Ê¶ÇÂøµ„ÄÅË°å‰∏öÁªèÈ™åÊâçËÉΩÁúãÂá∫Êù•ÔºåÂê¶Âàô‰ª£Á†Å‰πãÈó¥Ë∑≥Êù•Ë∑≥ÂéªÂæàÂÆπÊòìËø∑Â§±ÊñπÂêë„ÄÇ</p>
<h3 id="_4-2-Áúã‰ª£Á†Å‰ª∑ÂÄº" tabindex="-1">4.2 Áúã‰ª£Á†Å‰ª∑ÂÄº <a class="header-anchor" href="#_4-2-Áúã‰ª£Á†Å‰ª∑ÂÄº" aria-label="Permalink to &quot;4.2 Áúã‰ª£Á†Å‰ª∑ÂÄº&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>È¶ñÂÖà</strong>Ôºå‰∏™‰∫∫ËßâÂæóÁúã‰ª£Á†ÅÁöÑË°å‰∏∫ÂØπ‰∏çÂêåËßíËâ≤Â∏¶Êù•ÁöÑ‰ª∑ÂÄºÊòØ‰∏çÂêåÁöÑÔºåÊØîÂ¶ÇÔºö</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1. ‰Ωú‰∏∫Êï∞ÊçÆÂ∫ìÂÜÖÊ†∏ÂºÄÂèëËßíËâ≤ÔºåÁúãÊï∞ÊçÆÂ∫ì‰ª£Á†ÅÊòØÂü∫Êú¨ÊäÄËÉΩÔºåÊó•Â∏∏Â∑•‰Ωú‰∏≠‰∫ÜËß£‰∏çÂêå‰∫ßÂìÅÁâπÊÄß ...
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2.‰Ωú‰∏∫ DBA ËßíËâ≤ÔºåÂèØ‰ª•ÁúãÂà∞Êõ¥Â§öÈÄªËæëÊ¶ÇÂøµ‰∏ãÁöÑÁªÜËäÇ,Â∞§ÂÖ∂ÊòØÂú®‰∫ßÂìÅËæÉ‰∏çÊàêÁÜüÔºàÊñáÊ°£Â•ΩÂ∞ë„ÄÅBUG ËæÉÂ§ö„ÄÅÊúÄ‰Ω≥ÂÆûË∑µËæÉÂ∞ëÔºâÁöÑÊÉÖÂÜµ‰∏ãÔºåÂú®ÈÅáÂà∞ÈóÆÈ¢òÊó∂ÔºåËøõ‰∏ÄÊ≠•Ê∑±ÂÖ•ÁªÜËäÇÂèëÁé∞Ëß£ÂÜ≥ÈóÆÈ¢òÁöÑÊñ∞ÊÄùË∑Ø ...
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3. ‰Ωú‰∏∫Â∫îÁî®ÂºÄÂèëËßíËâ≤ÔºåÂèØ‰ª•ÂèëÁé∞‰ª£Á†ÅÂÆûÁé∞ÊâãÊÆµ‰∏äÁöÑ‚ÄúÈªëÁßëÊäÄ‚ÄùÔºåÊõ¥Â•Ω‰æùÊçÆ‰∏çÂêåÊï∞ÊçÆÂ∫ìÁâπÊÄß„ÄÅÁî®Â•Ω‰∏çÂêåÊï∞ÊçÆÂ∫ì‰∫ßÂìÅ ...</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>ÂÖ∂Ê¨°</strong>ÔºåË∞àÂà∞‰ª∑ÂÄºÔºå‰∏™‰∫∫ËßâÂæó‰∏çÂèØÂøΩÁï•ÁöÑÊòØ <strong>‚ÄúÊäïÂÖ•‰∫ßÂá∫ÊØî‚Äù</strong>„ÄÇÂ¢ûÂä†Ëøô‰∏ÄË°°ÈáèÂõ†Á¥†ÂêéÔºå‰∏çÁ¶ÅÂ¶Ç‰∏ãÁñëÈóÆ‰ªéËÑë‰∏≠‰∫ßÁîüÔºö</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1. ËØ•Ë°å‰∏∫Â¶ÇÊûúÂè™ÊòØËßâÂæóÂæàÁâõÔºåËøô‰ª∂‰∫ãÊòØÂê¶ÁúüÁöÑÂÄºÂæóÂÅöÔºüÂ¶ÇÊûúÂÅö‰∫ÜÔºåÂèØËÉΩÂè™ÊòØ‰∏∫‰∫ÜÊª°Ë∂≥ÂÜÖÂøÉÂØπ‰∫éÊüê‰ª∂‰∫ãÁöÑÂ•ΩÂ•áÔºåËØ¥ÊòéÊòØÊ†πÊú¨Ê≤°ÊúâË°°ÈáèËØ•Ë°å‰∏∫ÁöÑ‰ª∑ÂÄº,Â±û‰∫éÂÜ≤Âä®Ë°å‰∏∫ÁöÑÁªìÊûú„ÄÇÂΩìÁÑ∂ÁªìÊûúÂèØËÉΩÊòØÂ•ΩÁöÑÔºå‰πüÂèØËÉΩÊòØÂùèÁöÑ„ÄÇ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2. ËØ•Ë°å‰∏∫ÂØπ DBA ËßíËâ≤Êù•ËÆ≤ÔºåÂ∏¶Êù•ÁöÑÊî∂ÁõäÂà∞Â∫ïÊúâÂ§öÂ§ßÔºü‰ª£Á†ÅÁúãÁöÑÂ§öÂèØËÉΩÂØπÈÄªËæëÊ¶ÇÂøµ„ÄÅ‰∫ßÂìÅÁâπÊÄßËÆ§Áü•ÁöÑÊõ¥ÂáÜÁ°Æ„ÄÅÁâ¢Âõ∫ÔºåÂèØÊòØËøôÁßçËÄÅÁâ¢Âõ∫‰∏éÈòÖËØªÊïÖÈöúÊ°à‰æãÁõ∏ÊØîÔºåÂú®ÂêåÁ≠âÊó∂Èó¥ÊäïÂÖ•‰∏ãËé∑ÂæóÁöÑÊî∂Áõä ‚ÄúË∞ÅËÉúË∞ÅË¥ü‚Äù ÊÅêÊÄïÊòØ‰∏™ÈóÆÂè∑‚ùì„ÄÇÂÜçËÄÖÔºåÁúüÂá∫Áé∞‰∫Ü‰∫ßÂìÅÈóÆÈ¢òÔºåÊ≤°Êúâ‰∫ßÂìÅ‰ΩúËÄÖÁöÑÊîØÊåÅ‰∏éÁ°ÆËÆ§ÊàëÁúüÁöÑÊï¢Êîπ‰ª£Á†Å„ÄÅÊàñËÄÖ‰∏ãÂÆöËÆ∫ÂêóÔºü
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3. Ë°å‰∏ö Êàñ ‰ºÅ‰∏öÂØπ‰∫é DBA ËßíËâ≤ÁöÑÈòÖËØª‰ª£Á†ÅÊäÄËÉΩÊòØÊÄéÊ†∑ÂÆö‰ΩçÁöÑÔºüÊ∂âÂèä‰ª£Á†ÅÈóÆÈ¢òÂ§ÑÁêÜÁöÑÂ∑•‰ΩúÂ§ßÂèØ‰ª•Áî±‰∏ì‰∏öÁöÑ‰∫∫Ë¥üË¥£Ôºå‰∏ì‰∏öÁöÑ‰∫∫ÂÅö‰∏ì‰∏öÁöÑ‰∫ãÊïàÁéáÂèØËÉΩÊõ¥È´òÊïà‰∫õ„ÄÇÂ¶ÇÊûúÂÅáËÆæËØ•ÂâçÊèêÊòØÊ≠£Á°ÆÁöÑÔºåÈÇ£‰πà DBA ÈòÖËØª‰ª£Á†ÅÊó†ÁñëÊòØ‰∏ÄÁßç‰ΩéÊïàÁöÑË°å‰∏∫„ÄÇ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4. Â¶ÇÊûú‰∏∫‰∫ÜÊûÑÂª∫Ëá™Â∑±ÂÜô‰ª£Á†ÅÁöÑËÉΩÂäõÔºå‰∏∫‰ªÄ‰πà‰∏çÂéªÂÅöÁ†îÂèëÔºüÂìàÂìàÂìàÂìàÂìà ......</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>ÊúÄÂêé</strong>Ôºå‰∏äËø∞ÁßçÁßçÈóÆÈ¢òÁé∞Âú®ÊàëÂè™ËÉΩÊèêÂá∫ÔºåËÄå‰∏çËÉΩÂõûÁ≠îÔºå‰πüÊ≤°ÊúâËµÑÊ†ºÂõûÁ≠îÔºåÊú¨‰∫∫‰πüÂú®‰∏çÊñ≠Êé¢Á¥¢„ÄÅÂ≠¶‰π†„ÄÅÊäâÊã©‰∏≠ ... Ôºå‰πüÂèØËÉΩËøô‰ª∂‰∫ãÊÉÖÊ≤°Êúâ‰∏Ä‰∏™ÁªùÂØπÁöÑÁ≠îÊ°à„ÄÇ</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÊÄªÁªì‰∏ãÊù•ÔºåÊú¨ÁâáÊñáÁ´†Âú® TiDB ‰∫ßÂìÅÂ±ÇÈù¢ÊèèËø∞‰∫ÜÊï∞ÊçÆÂ∫ìÈÄªËæëÊ¶ÇÂøµ‰∏ãÔºåÁÇπÊü•Ë°å‰∏∫Âíå‰ª£Á†ÅÂÆûÁé∞ÁöÑÂÖ≥ËÅîÂÖ≥Á≥ªÔºåÂèØ‰ª•Ëøõ‰∏ÄÊ≠•ÊèêÈ´ò‰ΩúËÄÖÂØπ‰∫ßÂìÅÁöÑËÆ§Áü•„ÄÇÂú®Áúã‰ª£Á†ÅÂ≠¶‰π†Ë°å‰∏∫Â±ÇÈù¢ÔºåÁÆÄËø∞‰∫Ü‰∏™‰∫∫ÂØπËØ•Ë°å‰∏∫ÊâÄÂ∏¶Êù•‰ª∑ÂÄºÂ§öÂ∞ëÁöÑË°°Èáè„ÄÇ‰πüËÆ∏ÔºåËøôÊòØÊú¨ÊñáÂï∞ÂîÜË°®Ëææ‰∏ãÊâÄËÉΩÂ∏¶Êù•ÁöÑ 2 ÁÇπ <strong>‚Äú‰ªÖÊúâÁöÑ‚Äù</strong> ‰ª∑ÂÄº„ÄÇ</p>
<h2 id="‰∫î„ÄÅÂºïÁî®" tabindex="-1">‰∫î„ÄÅÂºïÁî® <a class="header-anchor" href="#‰∫î„ÄÅÂºïÁî®" aria-label="Permalink to &quot;‰∫î„ÄÅÂºïÁî®&quot;"></a></h2>
<p><a href="https://pingcap.com/zh/blog/tidb-source-code-reading-2" target="_blank" rel="noreferrer">TiDB Blog -- TiDB Ê∫êÁ†ÅÈòÖËØªÁ≥ªÂàóÊñáÁ´†Ôºà‰∫åÔºâÂàùËØÜ TiDB Ê∫êÁ†Å</a><br>
<a href="https://pingcap.com/zh/blog/tidb-source-code-reading-13" target="_blank" rel="noreferrer">TiDB Blog -- TiDB Ê∫êÁ†ÅÈòÖËØªÁ≥ªÂàóÊñáÁ´†ÔºàÂçÅ‰∏âÔºâÁ¥¢ÂºïËåÉÂõ¥ËÆ°ÁÆóÁÆÄ‰ªã</a><br>
<a href="https://pingcap.com/zh/blog/tidb-source-code-reading-3" target="_blank" rel="noreferrer">TiDB Blog -- TiDB Ê∫êÁ†ÅÈòÖËØªÁ≥ªÂàóÊñáÁ´†Ôºà‰∏âÔºâSQL ÁöÑ‰∏ÄÁîü</a><br>
<a href="https://pingcap.com/zh/blog/tikv-source-code-reading-19" target="_blank" rel="noreferrer">TiDB Blog -- TiKV Ê∫êÁ†ÅËß£ÊûêÁ≥ªÂàóÊñáÁ´†ÔºàÂçÅ‰πùÔºâread index Âíå local read ÊÉÖÊôØÂàÜÊûê</a><br>
<a href="https://pingcap.com/zh/blog/lease-read" target="_blank" rel="noreferrer">TiDB Blog -- TiKV ÂäüËÉΩ‰ªãÁªç - Lease Read</a><br>
<a href="https://pingcap.com/zh/blog/tikv-source-code-reading-13" target="_blank" rel="noreferrer">TiDB Blog -- TiKV Ê∫êÁ†ÅËß£ÊûêÁ≥ªÂàóÊñáÁ´†ÔºàÂçÅ‰∏âÔºâMVCC Êï∞ÊçÆËØªÂèñ</a><br>
<a href="https://pingcap.com/zh/blog/tidb-source-code-reading-18" target="_blank" rel="noreferrer">TiDB Blog -- TiDB Ê∫êÁ†ÅÈòÖËØªÁ≥ªÂàóÊñáÁ´†ÔºàÂçÅÂÖ´Ôºâtikv-clientÔºà‰∏äÔºâ</a><br>
<a href="http://blog.minifish.org/posts/tidb1/" target="_blank" rel="noreferrer">Jack Yu Blog -- Â¶Ç‰ΩïÈòÖËØª TiDB ÁöÑÊ∫ê‰ª£Á†ÅÔºà‰∏ÄÔºâ</a><br>
<a href="https://asktug.com/t/topic/183125" target="_blank" rel="noreferrer">Jan Su Blog -- TiDB run and debug on M1</a><br>
<a href="https://dev.mysql.com/doc/internals/en/overview.html" target="_blank" rel="noreferrer">MySQL Doc -- MySQL Client/Server Protocol</a><br>
<a href="https://www.cnblogs.com/davygeek/p/5647175.html" target="_blank" rel="noreferrer">MySQL Doc -- MySQLÂçèËÆÆÂàÜÊûê</a><br>
<a href="https://www.bilibili.com/video/BV1m4411g7Yy?from=search&amp;seid=5392094730229995526&amp;spm_id_from=333.337.0.0" target="_blank" rel="noreferrer">Talkgo movie -- TiDB Ê∫êÁ†ÅÈòÖËØª‰πã Compiler„ÄêÊúâÂΩ©ËõãÂì¶„Äë„Äê Go Â§úËØª „Äë</a><br>
<a href="https://asktug.com/t/topic/513044/2" target="_blank" rel="noreferrer">AskTUG Req -- tidb sql ÊâßË°å</a><br>
<a href="https://zhuanlan.zhihu.com/p/35195328" target="_blank" rel="noreferrer">Zhihu Blog -- RocksDB‰∫ãÂä°ÂÆûÁé∞TransactionDBÂàÜÊûê</a><br>
<a href="https://zhuanlan.zhihu.com/p/219516250" target="_blank" rel="noreferrer">Zhihu Blog -- SQL ‰ºòÂåñ‰πãÁÅ´Â±±Ê®°Âûã</a></p>
]]></content:encoded>
            <enclosure url="https://askaric.com/images/tidb/07TiDB-CodeReading/01tidb-arch.jpg" length="0" type="image/jpg"/>
        </item>
        <item>
            <title><![CDATA[Â¶ÇÊûúËé∑Âèñ TiDB ÈõÜÁæ§ÂàùÂßãÂåñÊó∂Èó¥]]></title>
            <link>https://askaric.com/zh/work/tidb/07TiDB-Ê∫êÁ†ÅÈòÖËØª/7-1TiDB/03TIDB how to get init time.html</link>
            <guid>https://askaric.com/zh/work/tidb/07TiDB-Ê∫êÁ†ÅÈòÖËØª/7-1TiDB/03TIDB how to get init time.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[‰∏Ä„ÄÅÂâçË®Ä
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Âæà‰πÖÊ≤°ÂÜôÊñáÁ´†‰∫ÜÔºå‰ªäÂ§©Âú®Âêå‰∫ãÁöÑÊèêÁ§∫ÁöÑÊÉÖÂÜµ‰∏ãÔºåÂ§ÑÁêÜ‰∫Ü‰∏Ä‰∏™ TiDB Ëé∑ÂèñÈõÜÁæ§ÂàõÂª∫Êó∂Èó¥ÁöÑÈóÆÈ¢òÔºåËßâÂæóÊúâ]]></description>
            <content:encoded><![CDATA[<h1 id="Â¶ÇÊûúËé∑Âèñ-tidb-ÈõÜÁæ§ÂàùÂßãÂåñÊó∂Èó¥" tabindex="-1">Â¶ÇÊûúËé∑Âèñ TiDB ÈõÜÁæ§ÂàùÂßãÂåñÊó∂Èó¥ <a class="header-anchor" href="#Â¶ÇÊûúËé∑Âèñ-tidb-ÈõÜÁæ§ÂàùÂßãÂåñÊó∂Èó¥" aria-label="Permalink to &quot;Â¶ÇÊûúËé∑Âèñ TiDB ÈõÜÁæ§ÂàùÂßãÂåñÊó∂Èó¥&quot;"></a></h1>
<h2 id="‰∏Ä„ÄÅÂâçË®Ä" tabindex="-1">‰∏Ä„ÄÅÂâçË®Ä <a class="header-anchor" href="#‰∏Ä„ÄÅÂâçË®Ä" aria-label="Permalink to &quot;‰∏Ä„ÄÅÂâçË®Ä&quot;"></a></h2>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Âæà‰πÖÊ≤°ÂÜôÊñáÁ´†‰∫ÜÔºå‰ªäÂ§©Âú®Âêå‰∫ãÁöÑÊèêÁ§∫ÁöÑÊÉÖÂÜµ‰∏ãÔºåÂ§ÑÁêÜ‰∫Ü‰∏Ä‰∏™ TiDB Ëé∑ÂèñÈõÜÁæ§ÂàõÂª∫Êó∂Èó¥ÁöÑÈóÆÈ¢òÔºåËßâÂæóÊúâÂøÖË¶ÅËÆ∞ÂΩï‰∏Ä‰∏ãÈò≤Ê≠¢ÈÅóÂøòÔºå‰πüÂàÜ‰∫´ÁªôÂ§ßÂÆ∂„ÄÇ</p>
<h2 id="‰∫å„ÄÅÊé¢Á¥¢" tabindex="-1">‰∫å„ÄÅÊé¢Á¥¢ <a class="header-anchor" href="#‰∫å„ÄÅÊé¢Á¥¢" aria-label="Permalink to &quot;‰∫å„ÄÅÊé¢Á¥¢&quot;"></a></h2>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;È¶ñÂÖàÔºåÁøªÈÅç TiDB ÂÆòÊñπÊñáÊ°£‰πüÊ≤°ÊúâÊâæÂà∞ËÉΩÂ§üÊü•ËØ¢ TiDB ÈõÜÁæ§ÂàùÂßãÂåñÊó∂Èó¥ÁöÑÊñπÊ≥ï„ÄÇÊâÄÊúâÁõëÊéß‰ø°ÊÅØÔºàDashboard„ÄÅGrafanaÔºâÈÉΩÂè™ËÉΩ‰ªÖÊü•ËØ¢ÂêÑÁªÑ‰ª∂ÁöÑ Startup TimeÔºåÊü•ËØ¢Ë°®ÁöÑ Create Time ‰πü‰∏çÂáÜÁ°Æ„ÄÇ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÂÖ∂Ê¨°Ôºå‰πãÂâçÁü•ÈÅìÂú®ÈõÜÁæ§ÂàùÂßãÂåñÁöÑÊó∂ÂÄô PD ‰ºöÂàùÂßãÂåñ‰∏Ä‰∏™ ClusterID Âπ∂ÊåÅ‰πÖÂåñ„ÄÇÂç≥ÁÑ∂ÔºåTiDB ÂÆòÊñπÊ≤°ÊúâÊèê‰æõÊü•ËØ¢Êé•Âè£ÔºåÈÇ£ËÉΩÂ§üÂàÜÂà´ÈõÜÁæ§ÁöÑ‰πüËÆ∏Âè™ÊúâËøô‰∏Ä‰∏™‰ø°ÊÅØ‰∫Ü„ÄÇÊúÄÂºÄÂßãÔºå‰∏ÄÁõ¥Âú®Â∞ùËØï‰ΩøÁî® pd-ctl ÁöÑ <code>tiup ctl:v5.2.3 pd tso 1571036791</code> Áõ¥Êé•ËΩ¨ËØë TSO Ôºå‰ΩÜÂßãÁªàÊ≤°ÊúâÊàêÂäü„ÄÇ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÊúÄÂêéÂú®‰∏Ä‰ΩçÂêå‰∫ãÁöÑÊèêÈÜí‰∏ãÔºåÁøª‰∫Ü‰∏ã PD Âú®ÂàùÂßãÂåñ Cluster_ID Êó∂ÁöÑÊ∫êÁ†Å,ÊâçÊàêÂäüËß£ÂÜ≥ÈóÆÈ¢ò„ÄÇËØ¶ÊÉÖËßÅ <strong>‰∏â„ÄÅËß£ÂÜ≥</strong> ÈÉ®ÂàÜ„ÄÇ</p>
<h2 id="‰∏â„ÄÅËß£ÂÜ≥" tabindex="-1">‰∏â„ÄÅËß£ÂÜ≥ <a class="header-anchor" href="#‰∏â„ÄÅËß£ÂÜ≥" aria-label="Permalink to &quot;‰∏â„ÄÅËß£ÂÜ≥&quot;"></a></h2>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Áúã‰∫Ü‰∏ã PD ‰ª£Á†ÅÔºåÂú®Ëøô‰∏™ <a href="https://github.com/tikv/pd/blob/88409b75418f0de46b62b7121627c23359b571b3/server/util.go#L86-L93" target="_blank" rel="noreferrer">initOrGetClusterID</a> ÂáΩÊï∞‰∏≠ÔºåCluster ID ÊòØÂèñÂΩìÂâçÊó∂Èó¥ÁöÑ Unix Êó∂Èó¥Êà≥Â∑¶Áßª 32 ‰ΩçÔºåÂÜçÂä†‰∏Ä‰∏™ÈöèÊú∫Êï∞Ëé∑Âæó„ÄÇÂõ†Ê≠§Áõ¥Êé•ËΩ¨ËØëÊòØÊó†Ê≥ïËé∑ÂæóÊ≠£Á°ÆÊó∂Èó¥ÁöÑ„ÄÇ</p>
<figure><img src="./../../../../../images/tidb/07TiDB-CodeReading/03code_cluster_id.jpeg" alt="03code_cluster_id" tabindex="0"><figcaption>03code_cluster_id</figcaption></figure>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÂÅö‰∫Ü‰∏Ä‰∫õÂ∞èÊîπÂä®ÔºåÈÄÜÁùÄ‰ª£Á†ÅÊÄùË∑ØÂèñÂá∫ÁöÑÊó∂Èó¥Âü∫Êú¨Á¨¶ÂêàË¶ÅÊ±ÇÔºåËÉΩÁ°Æ‰øùÂπ¥ÊúàÊó•Á∫ßÂà´ÁöÑÂáÜÁ°ÆÊÄß„ÄÇÂ§ßÂÆ∂‰πüÂèØ‰ª•Áõ¥Êé•ÁÇπÂáª <a href="http://www.dooccn.com/go/#id/7cdec42e1b4f7825c26d8a5343555b5a" target="_blank" rel="noreferrer">‰ª£Á†ÅÈìæÊé•</a> Áõ¥Êé•‰øÆÊîπÂÖ∂‰∏≠ Cluster ID ÂÄºËé∑ÂèñÁªìÊûú„ÄÇ</p>
<figure><img src="./../../../../../images/tidb/07TiDB-CodeReading/04code_cluster_id_translate.png" alt="04code_cluster_id_translate" tabindex="0"><figcaption>04code_cluster_id_translate</figcaption></figure>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÂÖ∂ÂÆûÔºå‰πãÂêéÂ∞ùËØïËøáÂè≥Áßª 32 ‰ΩçÂÜçÁî® pd-ctl tso ËΩ¨ËØëËøòÊòØ‰∏çÊàêÂäüÁöÑ„ÄÇ‰º∞ËÆ°ÊòØÂõ†‰∏∫ TiDB ÁöÑ TSO Áî± ‚ÄúÁâ©ÁêÜÊó∂Èó¥+ÈÄªËæëÊó∂Èó¥‚Äù ÁªÑÊàêÔºåËÄå Cluster ID ÁöÑËÆ°ÁÆóÁî± ‚ÄúÁâ©ÁêÜÊó∂Èó¥+ÈöèÊú∫Êï∞‚Äù ÁªÑÊàêÂêßÔºåÊú¨Ë∫´Â∞±‰∏çÊòØ‰∏Ä‰∏™‰∏úË•øÂêß„ÄÇ</p>
<h2 id="Âõõ„ÄÅ‰ª£Á†ÅÈÄªËæë" tabindex="-1">Âõõ„ÄÅ‰ª£Á†ÅÈÄªËæë <a class="header-anchor" href="#Âõõ„ÄÅ‰ª£Á†ÅÈÄªËæë" aria-label="Permalink to &quot;Âõõ„ÄÅ‰ª£Á†ÅÈÄªËæë&quot;"></a></h2>
<div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">package</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> main</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">fmt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  "</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">time</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">func</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> main</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">() {</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"> //Get from pd.log (cat {{/path/to}}/pd.log|grep "init cluster id")</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"> //  [2019/10/14 10:35:38.880 +00:00] [INFO] [server.go:212] ["init cluster id"] [cluster-id=6747551640615446306]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> history_ts </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> uint64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">6747551640615446306</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> sub_history_ts </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> history_ts </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">>></span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 32</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ret </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> time.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Unix</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">int64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(sub_history_ts),</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> fmt.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Println</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(ret)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> fmt.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Println</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"And the direct >>32 cluster-id is : "</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, sub_history_ts ,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">",you can try it by pd-ctl,but not correct!!!"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"> //Although there is random number, but the year/month/day is still accurate </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"> // --> 2019/10/14 vs 2019-10-14</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
</div><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Â∏åÊúõÂØπÂ§ßÂÆ∂ÊúâÂ∏ÆÂä©ÔºÅÂêåÊó∂ÔºåÊàë‰πüÊääÊîπÊñáÁ´†ÂàÜ‰∫´Âú® <a href="https://asktug.com/t/topic/542865" target="_blank" rel="noreferrer">AskTUG-TiDB Â¶Ç‰ΩïËé∑ÂèñÈõÜÁæ§ÂàõÂª∫Êó∂Èó¥</a> Ê¨¢Ëøé‰∫§ÊµÅ„ÄÇ</p>
]]></content:encoded>
            <enclosure url="https://askaric.com/images/tidb/07TiDB-CodeReading/03code_cluster_id.jpeg" length="0" type="image/jpeg"/>
        </item>
        <item>
            <title><![CDATA[Macbook M1 ‰ΩìÈ™å Operator ÈÉ®ÁΩ≤ TiDB Cluster]]></title>
            <link>https://askaric.com/zh/work/tidb/08TiDB-Cloud-K8S/8-1TiDB-Â∫îÁî®ÂÆûË∑µ/01TiDB-Operator ÈÉ®ÁΩ≤ TiDB.html</link>
            <guid>https://askaric.com/zh/work/tidb/08TiDB-Cloud-K8S/8-1TiDB-Â∫îÁî®ÂÆûË∑µ/01TiDB-Operator ÈÉ®ÁΩ≤ TiDB.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[# Macbook M1 ‰ΩìÈ™å Operator ÈÉ®ÁΩ≤ TiDB Cluster

> **ËØ•ÊñáÊ°£Â∑≤ÁªèÂèëÂ∏ÉÔºåÂç≥‰ªé ‚Äú[ËÆ∫Âùõ-ÊäÄÊúØÈöèÁ¨î]‚Äù ‰∏≠ÁßªÂá∫ÔºåÂéüÊñáÊ°£Âèò‰∏∫ÂêéÊúüÁª¥Êä§ÔºåÂèØÂú® [ÂéüÊñáÊ°£](http://forum.dbnest.net/t/topic/21) ‰∏≠ÊèêÂá∫ÊÇ®ÂØπÊñáÊ°£ÁöÑÂª∫ËÆÆ„ÄÇ**

## ‰∏Ä„ÄÅÂÜÖÂÆπÂâçÂØº

1. ‰∏™‰∫∫ËßâÂæó TiDB Operator ÁöÑÊïÖÈöúËá™ÊÑàÔºåÂä†ÊåÅ TiDB Êú¨Ë∫´ÊòØÂÖ∑Êúâ cloud native Â±ûÊÄßÁöÑÊï∞ÊçÆÂ∫ì‰∫ßÂìÅÔºåÂèØ‰ª•ËØ¥ÊòØÁªùÈÖçÔºå‰πüÊòØÂÆûÁé∞ÁúüÊ≠£ ‚Äú‰∫ë‚Äù Ê¶ÇÂøµÁöÑÂèØË°å‰πãË∑ØÔºåÂê¶Âàô TiDB ‰ªÖËÉΩÂÆûÁé∞‰∏ÄÂÆöÁ®ãÂ∫¶ÁöÑËá™ÊÑàÔºåÂπ∂‰∏çÂÆåÁæé„ÄÇÂõ†Ê≠§ÔºåÂÜ≥ÂÆöÂú®Á¨îËÆ∞Êú¨‰∏äÊê≠Âª∫‰∏ÄÂ•ó tidb cluster on k8s ÂÆûÈ™åÁéØÂ¢É„ÄÇ

2. Áî±‰∫éÊú¨‰∫∫‰ΩøÁî®ÁöÑÊòØ macbook pro m1 proÔºåm1 Êú¨Ë∫´ÊòØ arm ËäØÁâáÔºåÁªèÂÆûÈ™åÊµãËØïÂèëÁé∞ÔºåÂú®ÈÉ®ÁΩ≤‰∏ä TiDB ÊòØÊîØÊåÅÁöÑÔºåÂç≥‰Ωø‰∏ç‰ΩøÁî® [arm64 ÈïúÂÉè ÂÆâË£ÖÊåáÂºï](https://docs.pingcap.com/zh/tidb-in-kubernetes/dev/deploy-cluster-on-arm64)„ÄÇ

3. Âú®Ê≠§‰πãÂâçÔºåÈúÄË¶ÅÂú®Á¨îËÆ∞Êú¨‰∏äÂÆâË£Ö Docker Desktop Âèä kubernetesÔºåÂùáÊòØÁïåÈù¢Êìç‰Ωú‰∏çÂ±ïÂºÄËÆ≤Ëß£ÔºåËØ¶ÊÉÖÂèØÂèÇËÄÉ [ÊñáÁ´† : ÂÆâË£Ödocker‰∏ék8sÔºàmacbook M1) - Áü•‰πé](https://zhuanlan.zhihu.com/p/381569200)„ÄÇ

## ‰∫å„ÄÅÂ≠òÂÇ®ÂáÜÂ§á

1. Â¶ÇÊûú‰∏ç‰ΩøÁî®Ëá™Âª∫ pvÔºåÂèØ‰ª•ÂøΩÁï•‰ª•‰∏ãÂàõÂª∫Ê≠•È™§ÔºåÂõ†‰∏∫ tidb-cluster ÂØπÂ∫îÁöÑ pvc ‰ºö‰ΩøÁî® hostPath ÊñπÂºèÂàõÂª∫ pv„ÄÇ
2. Â¶ÇÊûúÊÉ≥Ë¶ÅËá™Âª∫ pvÔºåÈô§ apply ‰ª•‰∏ã pv Â§ñÔºåËøòË¶ÅÊõ¥Êîπ storage

  ```yaml
  jan@Jan-M1-Pro tidb-config % cat tidb-pvs.yaml
  apiVersion: v1
  kind: PersistentVolume
  metadata:
    name: local-ssd
  spec:
    capacity:
      storage: 5Gi
    accessModes:
      - ReadWriteOnce
    persistentVolumeReclaimPolicy: Retain
    storageClassName: local-storage
    local:
      path: /Users/jan/Database/k8s/data_tidb/ssd
    nodeAffinity:
      required:
        nodeSelectorTerms:
        - matchExpressions:
          - key: kubernetes.io/hostname
            operator: In
            values:
            - localhost
  ]]></description>
            <content:encoded><![CDATA[<h1 id="macbook-m1-‰ΩìÈ™å-operator-ÈÉ®ÁΩ≤-tidb-cluster" tabindex="-1">Macbook M1 ‰ΩìÈ™å Operator ÈÉ®ÁΩ≤ TiDB Cluster <a class="header-anchor" href="#macbook-m1-‰ΩìÈ™å-operator-ÈÉ®ÁΩ≤-tidb-cluster" aria-label="Permalink to &quot;Macbook M1 ‰ΩìÈ™å Operator ÈÉ®ÁΩ≤ TiDB Cluster&quot;"></a></h1>
<blockquote>
<p><strong>ËØ•ÊñáÊ°£Â∑≤ÁªèÂèëÂ∏ÉÔºåÂç≥‰ªé ‚Äú[ËÆ∫Âùõ-ÊäÄÊúØÈöèÁ¨î]‚Äù ‰∏≠ÁßªÂá∫ÔºåÂéüÊñáÊ°£Âèò‰∏∫ÂêéÊúüÁª¥Êä§ÔºåÂèØÂú® <a href="http://forum.dbnest.net/t/topic/21" target="_blank" rel="noreferrer">ÂéüÊñáÊ°£</a> ‰∏≠ÊèêÂá∫ÊÇ®ÂØπÊñáÊ°£ÁöÑÂª∫ËÆÆ„ÄÇ</strong></p>
</blockquote>
<h2 id="‰∏Ä„ÄÅÂÜÖÂÆπÂâçÂØº" tabindex="-1">‰∏Ä„ÄÅÂÜÖÂÆπÂâçÂØº <a class="header-anchor" href="#‰∏Ä„ÄÅÂÜÖÂÆπÂâçÂØº" aria-label="Permalink to &quot;‰∏Ä„ÄÅÂÜÖÂÆπÂâçÂØº&quot;"></a></h2>
<ol>
<li>
<p>‰∏™‰∫∫ËßâÂæó TiDB Operator ÁöÑÊïÖÈöúËá™ÊÑàÔºåÂä†ÊåÅ TiDB Êú¨Ë∫´ÊòØÂÖ∑Êúâ cloud native Â±ûÊÄßÁöÑÊï∞ÊçÆÂ∫ì‰∫ßÂìÅÔºåÂèØ‰ª•ËØ¥ÊòØÁªùÈÖçÔºå‰πüÊòØÂÆûÁé∞ÁúüÊ≠£ ‚Äú‰∫ë‚Äù Ê¶ÇÂøµÁöÑÂèØË°å‰πãË∑ØÔºåÂê¶Âàô TiDB ‰ªÖËÉΩÂÆûÁé∞‰∏ÄÂÆöÁ®ãÂ∫¶ÁöÑËá™ÊÑàÔºåÂπ∂‰∏çÂÆåÁæé„ÄÇÂõ†Ê≠§ÔºåÂÜ≥ÂÆöÂú®Á¨îËÆ∞Êú¨‰∏äÊê≠Âª∫‰∏ÄÂ•ó tidb cluster on k8s ÂÆûÈ™åÁéØÂ¢É„ÄÇ</p>
</li>
<li>
<p>Áî±‰∫éÊú¨‰∫∫‰ΩøÁî®ÁöÑÊòØ macbook pro m1 proÔºåm1 Êú¨Ë∫´ÊòØ arm ËäØÁâáÔºåÁªèÂÆûÈ™åÊµãËØïÂèëÁé∞ÔºåÂú®ÈÉ®ÁΩ≤‰∏ä TiDB ÊòØÊîØÊåÅÁöÑÔºåÂç≥‰Ωø‰∏ç‰ΩøÁî® <a href="https://docs.pingcap.com/zh/tidb-in-kubernetes/dev/deploy-cluster-on-arm64" target="_blank" rel="noreferrer">arm64 ÈïúÂÉè ÂÆâË£ÖÊåáÂºï</a>„ÄÇ</p>
</li>
<li>
<p>Âú®Ê≠§‰πãÂâçÔºåÈúÄË¶ÅÂú®Á¨îËÆ∞Êú¨‰∏äÂÆâË£Ö Docker Desktop Âèä kubernetesÔºåÂùáÊòØÁïåÈù¢Êìç‰Ωú‰∏çÂ±ïÂºÄËÆ≤Ëß£ÔºåËØ¶ÊÉÖÂèØÂèÇËÄÉ <a href="https://zhuanlan.zhihu.com/p/381569200" target="_blank" rel="noreferrer">ÊñáÁ´† : ÂÆâË£Ödocker‰∏ék8sÔºàmacbook M1) - Áü•‰πé</a>„ÄÇ</p>
</li>
</ol>
<h2 id="‰∫å„ÄÅÂ≠òÂÇ®ÂáÜÂ§á" tabindex="-1">‰∫å„ÄÅÂ≠òÂÇ®ÂáÜÂ§á <a class="header-anchor" href="#‰∫å„ÄÅÂ≠òÂÇ®ÂáÜÂ§á" aria-label="Permalink to &quot;‰∫å„ÄÅÂ≠òÂÇ®ÂáÜÂ§á&quot;"></a></h2>
<ol>
<li>Â¶ÇÊûú‰∏ç‰ΩøÁî®Ëá™Âª∫ pvÔºåÂèØ‰ª•ÂøΩÁï•‰ª•‰∏ãÂàõÂª∫Ê≠•È™§ÔºåÂõ†‰∏∫ tidb-cluster ÂØπÂ∫îÁöÑ pvc ‰ºö‰ΩøÁî® hostPath ÊñπÂºèÂàõÂª∫ pv„ÄÇ</li>
<li>Â¶ÇÊûúÊÉ≥Ë¶ÅËá™Âª∫ pvÔºåÈô§ apply ‰ª•‰∏ã pv Â§ñÔºåËøòË¶ÅÊõ¥Êîπ storage</li>
</ol>
<div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">jan@Jan-M1-Pro tidb-config % cat tidb-pvs.yaml</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">apiVersion</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">v1</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">kind</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">PersistentVolume</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">metadata</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">  name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">local-ssd</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">spec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">  capacity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">    storage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">5Gi</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">  accessModes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">ReadWriteOnce</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">  persistentVolumeReclaimPolicy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">Retain</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">  storageClassName</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">local-storage</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">  local</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">    path</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">/Users/jan/Database/k8s/data_tidb/ssd</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">  nodeAffinity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">    required</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">      nodeSelectorTerms</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">matchExpressions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">kubernetes.io/hostname</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">          operator</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">In</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">          values</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">          - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">localhost</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">---</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">apiVersion</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">v1</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">kind</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">PersistentVolume</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">metadata</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">  name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">local-sharedssd</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">spec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">  capacity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">    storage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">5Gi</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">  accessModes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">ReadWriteOnce</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">  persistentVolumeReclaimPolicy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">Retain</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">  storageClassName</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">local-storage</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">  local</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">    path</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">/Users/jan/Database/k8s/data_tidb/sharedssd</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">  nodeAffinity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">    required</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">      nodeSelectorTerms</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">matchExpressions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">kubernetes.io/hostname</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">          operator</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">In</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">          values</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">          - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">localhost</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">---</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">apiVersion</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">v1</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">kind</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">PersistentVolume</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">metadata</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">  name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">local-backup</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">spec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">  capacity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">    storage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">5Gi</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">  accessModes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">ReadWriteOnce</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">  persistentVolumeReclaimPolicy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">Retain</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">  storageClassName</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">local-storage</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">  local</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">    path</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">/Users/jan/Database/k8s/data_tidb/backup</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">  nodeAffinity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">    required</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">      nodeSelectorTerms</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">matchExpressions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">kubernetes.io/hostname</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">          operator</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">In</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">          values</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">          - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">localhost</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">---</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">apiVersion</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">v1</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">kind</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">PersistentVolume</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">metadata</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">  name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">local-monitoring</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">spec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">  capacity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">    storage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">5Gi</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">  accessModes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">ReadWriteOnce</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">  persistentVolumeReclaimPolicy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">Retain</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">  storageClassName</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">local-storage</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">  local</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">    path</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">/Users/jan/Database/k8s/data_tidb/monitoring</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">  nodeAffinity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">    required</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">      nodeSelectorTerms</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">matchExpressions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">kubernetes.io/hostname</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">          operator</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">In</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">          values</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">          - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">localhost</span></span></code></pre>
</div><h2 id="‰∏â„ÄÅÈÉ®ÁΩ≤ÊåáÂºï" tabindex="-1">‰∏â„ÄÅÈÉ®ÁΩ≤ÊåáÂºï <a class="header-anchor" href="#‰∏â„ÄÅÈÉ®ÁΩ≤ÊåáÂºï" aria-label="Permalink to &quot;‰∏â„ÄÅÈÉ®ÁΩ≤ÊåáÂºï&quot;"></a></h2>
<ol>
<li>
<p>TiDB Operator Ê≠•È™§ÈùûÂ∏∏ËØ¶Â∞ΩÔºåÂú® ‚ÄúÂø´ÈÄü‰∏äÊâã‚Äù Á´†ËäÇÂ§ßËá¥Â≠òÂú®Â¶Ç‰∏ãÂá†Ê≠•Ôºö<strong>ÈÉ®ÁΩ≤ TiDB Operator„ÄÅ ÈÉ®ÁΩ≤ TiDB ÈõÜÁæ§ÂíåÁõëÊéß„ÄÅ ËøûÊé• TiDB ÈõÜÁæ§</strong> Ôºå‰æøÂèØÂú® macbook m1 ‰∏äÊãâËµ∑‰∏Ä‰∏™ tidb cluster on k8s„ÄÇ</p>
</li>
<li>
<p>Ê≥®ÊÑèÔºö‰∏ç‰ΩøÁî® arm64 ÈïúÂÉè‰πüÊòØÂèØ‰ª•ÁöÑÔºåÂú®Êú¨‰∫∫ÁîµËÑë‰∏äÂèØ‰ª•Ê≠£Â∏∏ËøêË°å„ÄÇ</p>
</li>
<li>
<p>Áî±‰∫éÁΩëÁªú‰∏çÊòØÁâπÂà´Â•ΩÔºåÊâÄ‰ª•Êàë‰ºöÂÖàËÆ≤ÂØπÂ∫îÁöÑ yaml ÈÄöËøá wget ‰∏ãËΩΩÂà∞Êú¨Âú∞ÂÜçËøõË°å applyÔºåÊ≠•È™§Â¶Ç‰∏ãÔºö</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> create</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> crd.yaml</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">helm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> repo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> add</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> pingcap</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> https://charts.pingcap.org/</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> create</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> namespace</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-admin</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">helm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --namespace</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-admin</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-operator</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> pingcap/tidb-operator</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --version</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> v1.4.0</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> pods</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --namespace</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-admin</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -l</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> app.kubernetes.io/instance=tidb-operator</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> create</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> namespace</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">kubectl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> apply</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster.yaml</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">kubectl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> apply</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-dashboard.yaml</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">kubectl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> apply</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-monitor.yaml</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> pod</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                   READY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   STATUS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    RESTARTS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   AGE</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">basic-discovery-5db6c75657-h4c2p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">          27h</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">basic-monitor-0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                        4/4</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">          23h</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">basic-pd-0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                             1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">          27h</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">basic-tidb-0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                           2/2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">          27h</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">basic-tikv-0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                           1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">          27h</span></span></code></pre>
</div></li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Macbook M1 ‰ΩìÈ™å Operator ÈÉ®ÁΩ≤ DM]]></title>
            <link>https://askaric.com/zh/work/tidb/08TiDB-Cloud-K8S/8-1TiDB-Â∫îÁî®ÂÆûË∑µ/02TiDB-Operator ÈÉ®ÁΩ≤ DM.html</link>
            <guid>https://askaric.com/zh/work/tidb/08TiDB-Cloud-K8S/8-1TiDB-Â∫îÁî®ÂÆûË∑µ/02TiDB-Operator ÈÉ®ÁΩ≤ DM.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[# Macbook M1 ‰ΩìÈ™å Operator ÈÉ®ÁΩ≤ DM

> **ËØ•ÊñáÊ°£Â∑≤ÁªèÂèëÂ∏ÉÔºåÂç≥‰ªé ‚Äú[ËÆ∫Âùõ-ÊäÄÊúØÈöèÁ¨î]‚Äù ‰∏≠ÁßªÂá∫ÔºåÂéüÊñáÊ°£Âèò‰∏∫ÂêéÊúüÁª¥Êä§ÔºåÂèØÂú® [ÂéüÊñáÊ°£](http://forum.dbnest.net/t/topic/18) ‰∏≠ÊèêÂá∫ÊÇ®ÂØπÊñáÊ°£ÁöÑÂª∫ËÆÆ„ÄÇ**

## ‰∏Ä„ÄÅÂÆâË£ÖÂπ∂ÈÖçÁΩÆ MySQL

1. ÂØªÊâæ mysql ÈÖçÁΩÆÔºåÊàëÈÄâÊã© `/opt/homebrew/etc/my.cnf`ÔºåÂ∞Ü binlog ÈÖçÁΩÆ‰ø°ÊÅØÂ°´ÂÖ•„ÄÇ
  
    ```shell
    jan@Jan-M1-Pro tidb-config % brew install mysql

    jan@Jan-M1-Pro tidb-config % mysql --help --verbose | grep my.cnf
                          order of preference, my.cnf, $MYSQL_TCP_PORT,
    /etc/my.cnf /etc/mysql/my.cnf /opt/homebrew/etc/my.cnf ~/.my.cnf 

    jan@Jan-M1-Pro tidb-config % vim /opt/homebrew/etc/my.cnf  

    [mysqld]
    ......
    log_bin = mysql-bin #ÂºÄÂêØbinlog
    binlog_format = ROW #ÈÄâÊã©rowÊ®°Âºè
    server_id = 1

    jan@Jan-M1-Pro tidb-config % sudo chown _mysql:_mysql /Users/jan/Database/k8s/data_tidb/mysql-binlog
    
    jan@Jan-M1-Pro tidb-config % brew services restart mysql
    
    jan@Jan-M1-Pro tidb-config % brew services list |grep mysql
    mysql         started         jan  ~/Library/LaunchAgents/homebrew.mxcl.mysql.plist
    ```

2. ÂºÄÂêØ binlog Âπ∂ÈÖçÁΩÆÂçïÁã¨Ë∑ØÂæÑ

    ```sql
    mysql> show variables like '%log_bin%';
    +]]></description>
            <content:encoded><![CDATA[<h1 id="macbook-m1-‰ΩìÈ™å-operator-ÈÉ®ÁΩ≤-dm" tabindex="-1">Macbook M1 ‰ΩìÈ™å Operator ÈÉ®ÁΩ≤ DM <a class="header-anchor" href="#macbook-m1-‰ΩìÈ™å-operator-ÈÉ®ÁΩ≤-dm" aria-label="Permalink to &quot;Macbook M1 ‰ΩìÈ™å Operator ÈÉ®ÁΩ≤ DM&quot;"></a></h1>
<blockquote>
<p><strong>ËØ•ÊñáÊ°£Â∑≤ÁªèÂèëÂ∏ÉÔºåÂç≥‰ªé ‚Äú[ËÆ∫Âùõ-ÊäÄÊúØÈöèÁ¨î]‚Äù ‰∏≠ÁßªÂá∫ÔºåÂéüÊñáÊ°£Âèò‰∏∫ÂêéÊúüÁª¥Êä§ÔºåÂèØÂú® <a href="http://forum.dbnest.net/t/topic/18" target="_blank" rel="noreferrer">ÂéüÊñáÊ°£</a> ‰∏≠ÊèêÂá∫ÊÇ®ÂØπÊñáÊ°£ÁöÑÂª∫ËÆÆ„ÄÇ</strong></p>
</blockquote>
<h2 id="‰∏Ä„ÄÅÂÆâË£ÖÂπ∂ÈÖçÁΩÆ-mysql" tabindex="-1">‰∏Ä„ÄÅÂÆâË£ÖÂπ∂ÈÖçÁΩÆ MySQL <a class="header-anchor" href="#‰∏Ä„ÄÅÂÆâË£ÖÂπ∂ÈÖçÁΩÆ-mysql" aria-label="Permalink to &quot;‰∏Ä„ÄÅÂÆâË£ÖÂπ∂ÈÖçÁΩÆ MySQL&quot;"></a></h2>
<ol>
<li>
<p>ÂØªÊâæ mysql ÈÖçÁΩÆÔºåÊàëÈÄâÊã© <code>/opt/homebrew/etc/my.cnf</code>ÔºåÂ∞Ü binlog ÈÖçÁΩÆ‰ø°ÊÅØÂ°´ÂÖ•„ÄÇ</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> brew</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysql</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysql</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --help</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --verbose</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> my.cnf</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                      order</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> preference,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> my.cnf,</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> $MYSQL_TCP_PORT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">/etc/my.cnf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /etc/mysql/my.cnf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /opt/homebrew/etc/my.cnf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ~/.my.cnf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> vim</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /opt/homebrew/etc/my.cnf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[mysqld]</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">log_bin</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysql-bin</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"> #ÂºÄÂêØbinlog</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">binlog_format</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ROW</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"> #ÈÄâÊã©rowÊ®°Âºè</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">server_id</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> chown</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> _mysql:_mysql</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /Users/jan/Database/k8s/data_tidb/mysql-binlog</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> brew</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> services</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> restart</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysql</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> brew</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> services</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> list</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysql</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">mysql</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">         started</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">         jan</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  ~/Library/LaunchAgents/homebrew.mxcl.mysql.plist</span></span></code></pre>
</div></li>
<li>
<p>ÂºÄÂêØ binlog Âπ∂ÈÖçÁΩÆÂçïÁã¨Ë∑ØÂæÑ</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">mysql</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> show variables </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">like</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> '%log_bin%'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">---------------------------------+------------------------------------------------------+</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| Variable_name                   | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">Value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                                |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">---------------------------------+------------------------------------------------------+</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| log_bin                         | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">ON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                                   |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| log_bin_basename                | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">opt</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">homebrew</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">var</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">mysql</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">mysql</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">bin                    |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| log_bin_index                   | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">Users</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">jan</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/Database/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">k8s</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">data_tidb</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">mysql</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">binlog</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">index</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| log_bin_trust_function_creators | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">OFF</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                                  |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| log_bin_use_v1_row_events       | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">OFF</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                                  |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| sql_log_bin                     | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">ON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                                   |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">---------------------------------+------------------------------------------------------+</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">mysql</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> show </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">master</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> status</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">------------------+----------+--------------+------------------+-------------------+</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">File</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">             | Position | Binlog_Do_DB | Binlog_Ignore_DB | Executed_Gtid_Set |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">------------------+----------+--------------+------------------+-------------------+</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| mysql</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">bin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">000008</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |      </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">157</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |              |                  |                   |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">------------------+----------+--------------+------------------+-------------------+</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> row</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> in</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">01</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> sec)</span></span></code></pre>
</div></li>
</ol>
<h2 id="‰∫å„ÄÅÈÄöËøá-tidb-operator-ÈÖçÁΩÆ-dm" tabindex="-1">‰∫å„ÄÅÈÄöËøá TiDB Operator ÈÖçÁΩÆ DM <a class="header-anchor" href="#‰∫å„ÄÅÈÄöËøá-tidb-operator-ÈÖçÁΩÆ-dm" aria-label="Permalink to &quot;‰∫å„ÄÅÈÄöËøá TiDB Operator ÈÖçÁΩÆ DM&quot;"></a></h2>
<ol>
<li>
<p><a href="https://docs.pingcap.com/zh/tidb-in-kubernetes/stable/deploy-tidb-dm#%E5%9C%A8-kubernetes-%E4%B8%8A%E9%83%A8%E7%BD%B2-dm" target="_blank" rel="noreferrer">TiDB on kubernetes ÂÆòÊñπÊñáÊ°£</a>ÂÜôÁöÑÂæàËØ¶ÁªÜÔºåÊåâÁÖßÊ≠•È™§ÈÉ®ÁΩ≤‰∏ç‰ºöÊúâÂ§™Â§ßÁöÑÈóÆÈ¢ò„ÄÇ</p>
<blockquote>
<p>ÈÄÇÈÖçËá™Â∑±ÈÉ®ÁΩ≤ÁéØÂ¢ÉÁöÑÂèòÈáè‰øÆÊîπ</p>
</blockquote>
<table tabindex="0">
<thead>
<tr>
<th>ÂèòÈáèÂêç</th>
<th>ÂèòÈáèÂÄº</th>
<th>Â§áÊ≥®</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>jan-dm</td>
<td>DM ÈõÜÁæ§ÂêçÁß∞</td>
</tr>
<tr>
<td>namespace</td>
<td>tidb-cluster</td>
<td>ÂëΩÂêçÁ©∫Èó¥Ôºå‰∏é TiDB Cluster Âú®‰∏Ä‰∏™Á©∫Èó¥‰∏ã</td>
</tr>
<tr>
<td>storageSize</td>
<td>10Gi</td>
<td>Â≠òÂÇ®Â§ßÂ∞è</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>ÈÉ®ÁΩ≤ DM Master</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> less</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-dm-master.yaml</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">apiVersion:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> pingcap.com/v1alpha1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">kind:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> DMCluster</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">metadata:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">name:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> jan-dm</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">namespace:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">spec:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">version:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> v6.5.0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">configUpdateStrategy:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> RollingUpdate</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">pvReclaimPolicy:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Retain</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">discovery:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> {}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">master:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">baseImage:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> pingcap/dm</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">maxFailoverCount:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">imagePullPolicy:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> IfNotPresent</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">service:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">type</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> NodePort</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># ÈúÄË¶ÅÂ∞Ü DM-master service Êö¥Èú≤Âú®‰∏Ä‰∏™Âõ∫ÂÆöÁöÑ NodePort Êó∂ÈÖçÁΩÆ</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># masterNodePort: 30020</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">replicas:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">storageSize:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "10Gi"</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">requests:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">cpu:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">config:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">rpc-timeout</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "40s"</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> apply</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-dm-master.yaml</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span></span></code></pre>
</div></li>
<li>
<p>ÈÉ®ÁΩ≤ DM Worker</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> less</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-dm-worker.yaml</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">apiVersion:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> pingcap.com/v1alpha1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">kind:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> DMCluster</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">metadata:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">name:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> jan-dm</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">namespace:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">spec:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">version:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> v6.5.0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">configUpdateStrategy:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> RollingUpdate</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">pvReclaimPolicy:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Retain</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">discovery:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> {}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">worker:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">baseImage:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> pingcap/dm</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">maxFailoverCount:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">replicas:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">storageSize:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "20Gi"</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">requests:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">cpu:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">config:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">keepalive-ttl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 15</span></span></code></pre>
</div></li>
<li>
<p>ÂÆòÊñπÊñáÊ°£Ê≤°Êúâ‰ªãÁªçÊï¥Âêà DM ÁõëÊéßÁöÑÊñπÊ≥ïÔºå‰ªé <a href="https://github.com/pingcap/tidb-operator/pull/3528" target="_blank" rel="noreferrer">tidb-operator github repo</a> ‰∏äÊâæÂà∞‰∫ÜÁõ∏ÂÖ≥ÊèèËø∞Ôºå‰∏ãËø∞‰ª£Á†ÅÂùóÊòØÂÆûÈôÖÊìç‰ΩúÊ≠•È™§„ÄÇ</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> vim</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-monitor.yaml</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Âú®‰πãÂâçÈÉ®ÁΩ≤ TiDB Cluster ÁöÑ Monitor ÁöÑÈÉ®ÁΩ≤Êñá‰ª∂Ôºàtidb-monitor.yamlÔºâ‰∏≠ËøΩÂä†‰∏ãËø∞ÂÜÖÂÆπ </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">spec:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">dm:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    clusters:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> name:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> basicdm</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    initializer:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    baseImage:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> pingcap/dm-monitor-initializer</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    version:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> v2.0.0</span></span></code></pre>
</div></li>
<li>
<p>Ê£ÄÊü• DM pod Áä∂ÊÄÅÂíåÁõëÊéß</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> pod</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan-dm-dm-discovery-5c84866d6c-cwcx6</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">          14d</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan-dm-dm-master-0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                     1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">          14d</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan-dm-dm-worker-0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                     1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">          14d</span></span></code></pre>
</div></li>
</ol>
<h2 id="‰∏â„ÄÅÈÖçÁΩÆ‰ªªÂä°" tabindex="-1">‰∏â„ÄÅÈÖçÁΩÆ‰ªªÂä° <a class="header-anchor" href="#‰∏â„ÄÅÈÖçÁΩÆ‰ªªÂä°" aria-label="Permalink to &quot;‰∏â„ÄÅÈÖçÁΩÆ‰ªªÂä°&quot;"></a></h2>
<ol>
<li>
<p>ÈÉ®ÁΩ≤ DM Master Âíå Worker ÂêéÔºåÈúÄË¶ÅËøõÂÖ• Master pod ÂÜÖÈÉ®‰ΩøÁî® ctl ÂàõÂª∫ÂêåÊ≠•‰ªªÂä°„ÄÇ</p>
</li>
<li>
<p>Ê≥®ÊÑèÔºöËøôÈáå host ‰ΩøÁî® <code>host.docker.internal</code> ÊòØÂõ†‰∏∫ÈúÄË¶ÅÂú® k8s ÂÜÖÈÉ®ËÆøÈóÆ MacBook Êú¨Âú∞ÈÄöËøá brew ÈÉ®ÁΩ≤ÁöÑ MySQLÔºåÁõ∏ÂΩì‰∫éÈÖçÁΩÆ‰∫Ü <code>127.0.0.1</code>„ÄÇ</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> exec</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -it</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> jan-dm-dm-master-0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> sh</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">/</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"> # ls |grep dmctl</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">dmctl</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">/mkdir</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> conf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> &#x26; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> conf</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">/conf</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"> # vim source1.yaml</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">source-id:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "mysql-replica-01"</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">enable-gtid:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> false</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">from:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">host:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "host.docker.internal"</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">user:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "root"</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">password:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ""</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">port:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 3306</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">/conf</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"> # ../dmctl --master-addr jan-dm-dm-master-0:8261 operate-source create  source1.yaml</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    "msg"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    "sources"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "msg"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "source"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "mysql-replica-01",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "worker"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "jan-dm-dm-worker-0"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
</div></li>
</ol>
<h2 id="Âõõ„ÄÅÂáÜÂ§á-dm-loader-pv" tabindex="-1">Âõõ„ÄÅÂáÜÂ§á DM loader PV <a class="header-anchor" href="#Âõõ„ÄÅÂáÜÂ§á-dm-loader-pv" aria-label="Permalink to &quot;Âõõ„ÄÅÂáÜÂ§á DM loader PV&quot;"></a></h2>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ÔΩû</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> vim</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-dm-loader-pv.yaml</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">apiVersion:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> v1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">kind:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> PersistentVolume</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">metadata:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    name:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm-loader-dir</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">spec:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    capacity:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    storage:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 5Gi</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    accessModes:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ReadWriteOnce</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    persistentVolumeReclaimPolicy:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Retain</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    storageClassName:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> local-storage</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    local:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    path:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /Users/jan/Database/k8s/data_tidb/loader-mysql-dir</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    nodeAffinity:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    required:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">        nodeSelectorTerms:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">        -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> matchExpressions:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">        -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> key:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> kubernetes.io/hostname</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            operator:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> In</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            values:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> localhost</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> apply</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-dm-loader-pv.yaml</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> pv</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm-loader-dir</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">dm-loader-dir</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                              5Gi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">        RWO</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">            Retain</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">           Available</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                               local-storage</span></span></code></pre>
</div><h2 id="‰∫î„ÄÅmysql-ÈÄ†Êï∞ÊçÆ" tabindex="-1">‰∫î„ÄÅMySQL ÈÄ†Êï∞ÊçÆ <a class="header-anchor" href="#‰∫î„ÄÅmysql-ÈÄ†Êï∞ÊçÆ" aria-label="Permalink to &quot;‰∫î„ÄÅMySQL ÈÄ†Êï∞ÊçÆ&quot;"></a></h2>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> brew</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> instal</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> sysbench</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> sysbench</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> oltp_read_write</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --mysql-host=127.0.0.1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    --mysql-port=3306</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --mysql-db=test</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    --mysql-user=root</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --mysql-password=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    --table_size=5000</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --tables=10</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  --events=10000</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    --report-interval=10</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> prepare</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Creating</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> table</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'sbtest1'...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Inserting</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 5000</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> records</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> into</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'sbtest1'</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Creating</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> secondary</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> index</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> on</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'sbtest1'...</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">...</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Creating</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> table</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'sbtest10'...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Inserting</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 5000</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> records</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> into</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'sbtest10'</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Creating</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> secondary</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> index</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> on</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'sbtest10'...</span></span></code></pre>
</div><h2 id="ÂÖ≠„ÄÅÂØºÂÖ•-dm-Êï∞ÊçÆ" tabindex="-1">ÂÖ≠„ÄÅÂØºÂÖ• DM Êï∞ÊçÆ <a class="header-anchor" href="#ÂÖ≠„ÄÅÂØºÂÖ•-dm-Êï∞ÊçÆ" aria-label="Permalink to &quot;ÂÖ≠„ÄÅÂØºÂÖ• DM Êï∞ÊçÆ&quot;"></a></h2>
<p>‰ªé <code>sbtest1-sbtest10</code> Ë°®ÁªìÊûÑÂçïÁã¨Âú® TiDB ‰∏≠ÊâãÂä®ÂàõÂª∫ÔºåÂê¶Âàô‰ºöÂá∫Áé∞ COLLATE=utf8mb4_0900_ai_ci ‰∏çÂÖºÂÆπÈóÆÈ¢ò„ÄÇ</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sbtest1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">` (</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sbtest2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">` (</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">......</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">/*!40101 SET NAMES binary*/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sbtest10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">` (</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  `id`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> int</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> NOT NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> AUTO_INCREMENT,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  `k`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> int</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> NOT NULL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> DEFAULT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> '0'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  `c`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> char</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">120</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">NOT NULL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> DEFAULT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ''</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  `pad`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> char</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">60</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">NOT NULL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> DEFAULT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ''</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  PRIMARY KEY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`id`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">),</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  KEY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `k_6`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`k`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) ENGINE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">InnoDB AUTO_INCREMENT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">5001</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> DEFAULT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> CHARSET</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">utf8mb4;</span></span></code></pre>
</div><h2 id="‰∏É„ÄÅÂêØÂä®ÂêåÊ≠•" tabindex="-1">‰∏É„ÄÅÂêØÂä®ÂêåÊ≠• <a class="header-anchor" href="#‰∏É„ÄÅÂêØÂä®ÂêåÊ≠•" aria-label="Permalink to &quot;‰∏É„ÄÅÂêØÂä®ÂêåÊ≠•&quot;"></a></h2>
<ol>
<li>
<p>Â¶ÇÊûúÊ≤°ÊúâÊâãÂä®Âª∫Ë°®ÔºåÂØºËá¥ utf8mb4_0900_ai_ci ‰∏çÂÖºÂÆπÈóÆÈ¢òÔºåÈúÄË¶Å‰ΩøÁî® <code>--remove-meta</code> ÈáçÂêØÂêåÊ≠•‰ªªÂä°ÔºåÂê¶ÂàôÂèØ‰∏çÂ∏¶ËØ•ÂèÇÊï∞„ÄÇ</p>
</li>
<li>
<p>ÈùûÈ¢ÑÊúüÂêåÊ≠•Áä∂ÊÄÅ</p>
<div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">/conf</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"> # ../dmctl --master-addr jan-dm-dm-master-0:8261 start-task ./task.yaml --remove-meta</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    "result"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    "msg"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">""</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    "sources"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">            "result"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">            "msg"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">""</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">            "source"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"mysql-replica-01"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">            "worker"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"jan-dm-dm-worker-0"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    ],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    "checkResult"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"fail to check synchronization configuration with type: no errors but some warnings</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">        detail: {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                "results"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                        {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                "id"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                "name"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"mysql_version"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                "desc"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"check whether mysql version is satisfied"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                "state"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"warn"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                "errors"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                        {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                                "severity"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"warn"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                                "short_error"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"version suggested earlier than 8.0.0 but got 8.0.32"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                ],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                "instruction"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"It is recommended that you select a database version that meets the requirements before performing data migration. Otherwise data inconsistency or task exceptions might occur."</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                "extra"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"address of db instance - host.docker.internal:3306"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                        },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                        {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                "id"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">9</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                "name"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"table structure compatibility check"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                "desc"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"check compatibility of table structure"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                "state"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"warn"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                "errors"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                        {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                                "severity"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"warn"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                                "short_error"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"table `test`.`sbtest9` collation is not same, upstream: (sbtest9 utf8mb4_0900_ai_ci), downstream: (sbtest9 utf8mb4_bin)"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                        },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                        {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                                "severity"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"warn"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                                "short_error"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"table `test`.`sbtest5` collation is not same, upstream: (sbtest5 utf8mb4_0900_ai_ci), downstream: (sbtest5 utf8mb4_bin)"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                        },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                        {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                                "severity"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"warn"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                                "short_error"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"table `test`.`sbtest7` collation is not same, upstream: (sbtest7 utf8mb4_0900_ai_ci), downstream: (sbtest7 utf8mb4_bin)"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                        },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                        {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                                "severity"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"warn"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                                "short_error"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"table `test`.`sbtest3` collation is not same, upstream: (sbtest3 utf8mb4_0900_ai_ci), downstream: (sbtest3 utf8mb4_bin)"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                        },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                        {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                                "severity"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"warn"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                                "short_error"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"table `test`.`sbtest8` collation is not same, upstream: (sbtest8 utf8mb4_0900_ai_ci), downstream: (sbtest8 utf8mb4_bin)"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                        },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                        {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                                "severity"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"warn"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                                "short_error"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"table `test`.`sbtest10` collation is not same, upstream: (sbtest10 utf8mb4_0900_ai_ci), downstream: (sbtest10 utf8mb4_bin)"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                        },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                        {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                                "severity"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"warn"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                                "short_error"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"table `test`.`sbtest2` collation is not same, upstream: (sbtest2 utf8mb4_0900_ai_ci), downstream: (sbtest2 utf8mb4_bin)"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                        },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                        {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                                "severity"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"warn"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                                "short_error"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"table `test`.`sbtest6` collation is not same, upstream: (sbtest6 utf8mb4_0900_ai_ci), downstream: (sbtest6 utf8mb4_bin)"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                        },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                        {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                                "severity"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"warn"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                                "short_error"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"table `test`.`sbtest1` collation is not same, upstream: (sbtest1 utf8mb4_0900_ai_ci), downstream: (sbtest1 utf8mb4_bin)"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                                ],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                "instruction"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"Ensure that you use the same collations for both upstream and downstream databases. Otherwise the query results from the two databases might be inconsistent.; "</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                ],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                "summary"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                        "passed"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                        "total"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                        "successful"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                        "failed"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                        "warning"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        }</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">}</span></span></code></pre>
</div></li>
<li>
<p>È¢ÑÊúüÂêåÊ≠•Áä∂ÊÄÅ</p>
<div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">/conf</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"> # ../dmctl --master-addr jan-dm-dm-master-0:8261 query-status local-mysql-test</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    "result"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    "msg"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">""</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    "sources"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">            "result"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">            "msg"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">""</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">            "sourceStatus"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                "source"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"mysql-replica-01"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                "worker"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"jan-dm-dm-worker-0"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                "result"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                "relayStatus"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">null</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">            },</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">            "subTaskStatus"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                    "name"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"local-mysql-test"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                    "stage"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"Running"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                    "unit"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"Sync"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                    "result"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                    "unresolvedDDLLockID"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">""</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                    "sync"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                        "totalEvents"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"0"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                        "totalTps"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"0"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                        "recentTps"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"0"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                        "masterBinlog"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"(mysql-bin.000009, 9552368)"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                        "masterBinlogGtid"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">""</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                        "syncerBinlog"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"(mysql-bin.000009, 9552368)"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                        "syncerBinlogGtid"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">""</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                        "blockingDDLs"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                        ],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                        "unresolvedGroups"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                        ],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                        "synced"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                        "binlogType"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"remote"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                        "secondsBehindMaster"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"0"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                        "blockDDLOwner"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">""</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                        "conflictMsg"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">""</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                        "totalRows"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"0"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                        "totalRps"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"0"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                        "recentRps"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"0"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                    },</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                    "validation"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">null</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">            ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
</div></li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Macbook M1 ‰ΩìÈ™å Operator ÈÉ®ÁΩ≤ Lightning]]></title>
            <link>https://askaric.com/zh/work/tidb/08TiDB-Cloud-K8S/8-1TiDB-Â∫îÁî®ÂÆûË∑µ/03TiDB-Operator ÈÉ®ÁΩ≤ Lightning.html</link>
            <guid>https://askaric.com/zh/work/tidb/08TiDB-Cloud-K8S/8-1TiDB-Â∫îÁî®ÂÆûË∑µ/03TiDB-Operator ÈÉ®ÁΩ≤ Lightning.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[# Macbook M1 ‰ΩìÈ™å Operator ÈÉ®ÁΩ≤ Lightning

> **ËØ•ÊñáÊ°£Â∑≤ÁªèÂèëÂ∏ÉÔºåÂç≥‰ªé ‚Äú[ËÆ∫Âùõ-ÊäÄÊúØÈöèÁ¨î]‚Äù ‰∏≠ÁßªÂá∫ÔºåÂéüÊñáÊ°£Âèò‰∏∫ÂêéÊúüÁª¥Êä§ÔºåÂèØÂú® [ÂéüÊñáÊ°£](http://forum.dbnest.net/t/topic/34) ‰∏≠ÊèêÂá∫ÊÇ®ÂØπÊñáÊ°£ÁöÑÂª∫ËÆÆ„ÄÇ**

## ‰∏Ä„ÄÅÂâçË®Ä

1. ‰∏ÄÂÆöË¶ÅÂ≠¶‰π† K8S Lightning ÁöÑÂéüÂõ†ÊòØÔºåÂçïÁ∫ØÈù†Êò†Â∞ÑÁ´ØÂè£Âú®Â§ßÊâπÈáèÂØºÊï∞Êó∂ÂæàÈöæÊª°Ë∂≥È¢ÑÊúüÔºåÂÖ∑‰Ωì tidb backend Âíå local backend Ê®°ÂºèÂØºÂÖ•ÈÄüÂ∫¶Â∑ÆË∑ùÂæàÂ§ßÔºå[ÂÆòÁΩëÂèÇËÄÉÊï∞ÊçÆ](https://docs.pingcap.com/tidb/v4.0/tidb-lightning-backends)ËßÅ‰∏ãË°®„ÄÇ

    ![03-lightning-speed-in-mode](../../../../../images/tidb/08TiDB-Cloud-K8S/8-1TiDB-Deployment/03-lightning-speed-in-mode.jpeg)

2. Lighting ÊØîËæÉÁâπÊÆäÔºåÂÆÉÂè™ÊòØ‰∏Ä‰∏™ÂèØÊâßË°åÊñá‰ª∂ÔºåÂú®Êé¢Á¥¢Âú®ÊâæÂà∞‰∫Ü 2 ‰∏≠‰ΩøÁî® Lightning ÁöÑÊñπÂºèÔºåÂç≥Ôºö**[k8s ÈõÜÁæ§Â§ñÈÉ®Ë∞ÉÁî® tidb-lightning binary](#‰∏âÁâ©ÁêÜÊú∫Ë∞ÉÁî®-lightning)** Âíå **[TiDB ÂÆòÁΩëÊé®ËçêÁöÑ‰ΩøÁî® helm ÂàõÂª∫ÂØºÂÖ•‰ªªÂä°](#‰∫åoperator-‰∏äÈÉ®ÁΩ≤-lightning)**„ÄÇ

## ‰∫å„ÄÅOperator ‰∏äÈÉ®ÁΩ≤ Lightning

1. [TiDB ÂÆòÁΩëÁöÑÂØºÂÖ•ÈõÜÁæ§Êï∞ÊçÆ](https://docs.pingcap.com/zh/tidb-in-kubernetes/stable/restore-data-using-tidb-lightning)‰ªãÁªçÁöÑÊØîËæÉÂÆåÂñÑÔºå‰ª•‰∏ãÊòØÂÖ∑‰ΩìÁöÑÊìç‰ΩúÊ≠•È™§„ÄÇ
2. ÂáÜÂ§á PV Âπ∂ÈÉ®ÁΩ≤ lightning

    ```shell
    jan@Jan-M1-Pro tidb-config % vim tidb-lightning-values.yaml
    ......
    # For `local` backend, an extra PV is needed for local KV sorting.
    sortedKV:
      storageClassName: local-storage
      storage: 5Gi
    ......


    jan@Jan-M1-Pro tidb-config % helm search repo -l tidb-operator

    jan@Jan-M1-Pro tidb-config % helm inspect values pingcap/tidb-lightning --version=v1.4.0 > tidb-lightning-values.yaml
                                              local-storage            12d

    jan@Jan-M1-Pro tidb-config % kubectl get nodes --show-labels
    NAME             STATUS   ROLES           AGE   VERSION   LABELS
    docker-desktop   Ready    control-plane   13d   v1.25.4   beta.kubernetes.io/arch=arm64,beta.kubernetes.io/os=linux,kubernetes.io/arch=arm64,kubernetes.io/hostname=docker-desktop,kubernetes.io/os=linux,node-role.kubernetes.io/control-plane=,node.kubernetes.io/exclude-from-external-load-balancers=

    # ÊåáÂÆöÊü•Âà∞ÁöÑ Node Name(Âç≥Ôºödocker-desktop)
    jan@Jan-M1-Pro tidb-config % vim tidb-lightning-pv.yaml
    apiVersion: v1
    kind: PersistentVolume
    metadata:
      name: local-sharedssd
    spec:
      capacity:
        storage: 5Gi
      accessModes:
        - ReadWriteOnce
      persistentVolumeReclaimPolicy: Retain
      storageClassName: local-storage
      local:
        path: /Users/jan/Database/k8s/data_tidb/sharedssd
      nodeAffinity:
        required:
          nodeSelectorTerms:
          - matchExpressions:
            - key: kubernetes.io/hostname
              operator: In
              values:
              - docker-desktop

    jan@Jan-M1-Pro tidb-config % kubectl apply -f tidb-lightning-pv.yaml

    jan@Jan-M1-Pro tidb-config % kubectl get pv |grep -B 10 Available
    NAME                                       CAPACITY   ACCESS MODES   RECLAIM POLICY   STATUS      CLAIM                                       STORAGECLASS    REASON   AGE local-sharedssd                            5Gi        RWO            Retain           Available    

    jan@Jan-M1-Pro tidb-config % helm install jan-lightning pingcap/tidb-lightning --namespace=tidb-cluster --set failFast=true -f tidb-lightning-values.yaml --version=v1.4.0

    NAME: jan-lightning
    LAST DEPLOYED: Wed Mar 29 17:18:45 2023
    NAMESPACE: tidb-cluster
    STATUS: deployed
    REVISION: 1
    TEST SUITE: None
    NOTES:
    1. Check tidb-lightning status
      kubectl get job -n tidb-cluster -l app.kubernetes.io/name=jan-lightning-tidb-lightning
      kubectl get po -n tidb-cluster -l app.kubernetes.io/name=jan-lightning-tidb-lightning
    2. Check tidb-lightning logs
      kubectl logs -n tidb-cluster -l app.kubernetes.io/name=jan-lightning-tidb-lightning
    3. View tidb-lightning status page
      kubectl port-forward -n tidb-cluster svc/jan-lightning-tidb-lightning 8289:8289
      View http://localhost:8289 in web browser

    jan@Jan-M1-Pro tidb-config % kubectl logs -n tidb-cluster -l app.kubernetes.io/name=jan-lightning-tidb-lightning --tail=-1 |grep "successfully"
    tidb lightning exit successfully
    ```

3. Á≠âÂæÖÂØºÂÖ•ÂÆåÊàê

    ```shell
    jan@Jan-M1-Pro tidb-config % kubectl get pod -n tidb-cluster |grep lightning
    jan-lightning-tidb-lightning-7ssfc     0/1     Completed   0          22h
    ```

## ‰∏â„ÄÅÁâ©ÁêÜÊú∫Ë∞ÉÁî® Lightning

1. Âõ†‰∏∫ Lightning ÈúÄË¶Å‰∏é tikv, tidb, pd ÁöÑËøêË°åÁ´ØÂè£ÂèäÁä∂ÊÄÅÁ´ØÂè£ÔºåÊâÄ‰ª•ÂùáÈúÄË¶ÅÊö¥Èú≤ÁªôÊú¨Âú∞Áâ©ÁêÜÊú∫„ÄÇ

    ```shell
    jan@Jan-M1-Pro ~ % kubectl port-forward svc/basic-tidb 6000:4000 -n tidb-cluster
    Forwarding from 127.0.0.1:6000 -> 4000
    Forwarding from [::1]:6000 -> 4000
    Handling connection for 6000
    
    jan@Jan-M1-Pro ~ % kubectl port-forward svc/basic-tidb 10080:10080 -n tidb-cluster
    Forwarding from 127.0.0.1:10080 -> 10080
    Forwarding from [::1]:10080 -> 10080
    
    jan@Jan-M1-Pro ~ % kubectl port-forward svc/basic-pd 2379:2379 -n tidb-cluster
    Forwarding from 127.0.0.1:2379 -> 2379
    Forwarding from [::1]:2379 -> 2379
    
    
    jan@Jan-M1-Pro ~ % kubectl port-forward svc/basic-tikv-peer 20160:20160 -n tidb-cluster
    Forwarding from 127.0.0.1:20160 -> 20160
    Forwarding from [::1]:20160 -> 20160
    Handling connection for 20160
    ```

2. Âç≥‰ΩøÊö¥Èú≤Á´ØÂè£ËøòÊòØ‰ºöÊä•ÈîôÔºå‰ªéÊä•Èîô‰ø°ÊÅØÂèØ‰ª•ÁúãÂá∫ ```\"transport: Error while dialing dial tcp: lookup basic-pd-0.basic-pd-peer.tidb-cluster.svc: no such host\"``` ÊåáÂêë tidb cluster ÂèçÂõû‰∫Ü k8s ÂÜÖÈÉ®Ë∑ØÁî±‰ø°ÊÅØÁªô lightning„ÄÇ

      ```shell
      jan@Jan-M1-Pro tidb-config % tiup tidb-lightning -c ./lightning-config.yaml --log-file ./lightning.log
      tiup is checking updates for component tidb-lightning ...
      Starting component `tidb-lightning`: /Users/jan/.tiup/components/tidb-lightning/v6.6.0/tidb-lightning -c ./lightning-config.yaml --log-file ./lightning.log
      Verbose debug logs will be written to ./lightning.log
      
      {"level":"warn","ts":"2023-03-30T02:20:19.463+0800","logger":"etcd-client","caller":"v3@v3.5.2/retry_interceptor.go:62","msg":"retrying of unary invoker failed","target":"etcd-endpoints://0x14000d78000/127.0.0.1:2379","attempt":0,"error":"rpc error: code = DeadlineExceeded desc = latest balancer error: last connection error: connection error: desc = \"transport: Error while dialing dial tcp: lookup basic-pd-0.basic-pd-peer.tidb-cluster.svc: no such host\""}
      {"level":"info","ts":"2023-03-30T02:20:19.464+0800","logger":"etcd-client","caller":"v3@v3.5.2/client.go:207","msg":"Auto sync endpoints failed.","error":"context deadline exceeded"}
      tidb lightning encountered error: [Lightning:KV:ErrCreateKVClient]create kv client error: [PD:client:ErrClientCreateTSOStream]create TSO stream failed, retry timeout
      ```

3. ÁªïËøáÂäûÊ≥ïÊòØÂú® host ‰∏≠Ê∑ªÂä†ÊâÄÊúâ svc ÁöÑÂüüÂêçÊò†Â∞Ñ

    ```shell
    jan@Jan-M1-Pro ~ % cat /etc/hosts
    ......
    127.0.0.1 basic-pd-0.basic-pd-peer.tidb-cluster.svc
    127.0.0.1 basic-tikv-0.basic-tikv-peer.tidb-cluster.svc
    ```

4. ÂØºÂÖ•È™åËØÅ

      ```sql
      mysql> show tables;
      Empty set (0.01 sec)
      
      // ÊåáÂÆö lightning ÂØºÂÖ•‰ªªÂä°ÔºåÂπ∂Á≠âÂæÖÂÆåÊàê
      
      mysql> show tables;
      +]]></description>
            <content:encoded><![CDATA[<h1 id="macbook-m1-‰ΩìÈ™å-operator-ÈÉ®ÁΩ≤-lightning" tabindex="-1">Macbook M1 ‰ΩìÈ™å Operator ÈÉ®ÁΩ≤ Lightning <a class="header-anchor" href="#macbook-m1-‰ΩìÈ™å-operator-ÈÉ®ÁΩ≤-lightning" aria-label="Permalink to &quot;Macbook M1 ‰ΩìÈ™å Operator ÈÉ®ÁΩ≤ Lightning&quot;"></a></h1>
<blockquote>
<p><strong>ËØ•ÊñáÊ°£Â∑≤ÁªèÂèëÂ∏ÉÔºåÂç≥‰ªé ‚Äú[ËÆ∫Âùõ-ÊäÄÊúØÈöèÁ¨î]‚Äù ‰∏≠ÁßªÂá∫ÔºåÂéüÊñáÊ°£Âèò‰∏∫ÂêéÊúüÁª¥Êä§ÔºåÂèØÂú® <a href="http://forum.dbnest.net/t/topic/34" target="_blank" rel="noreferrer">ÂéüÊñáÊ°£</a> ‰∏≠ÊèêÂá∫ÊÇ®ÂØπÊñáÊ°£ÁöÑÂª∫ËÆÆ„ÄÇ</strong></p>
</blockquote>
<h2 id="‰∏Ä„ÄÅÂâçË®Ä" tabindex="-1">‰∏Ä„ÄÅÂâçË®Ä <a class="header-anchor" href="#‰∏Ä„ÄÅÂâçË®Ä" aria-label="Permalink to &quot;‰∏Ä„ÄÅÂâçË®Ä&quot;"></a></h2>
<ol>
<li>
<p>‰∏ÄÂÆöË¶ÅÂ≠¶‰π† K8S Lightning ÁöÑÂéüÂõ†ÊòØÔºåÂçïÁ∫ØÈù†Êò†Â∞ÑÁ´ØÂè£Âú®Â§ßÊâπÈáèÂØºÊï∞Êó∂ÂæàÈöæÊª°Ë∂≥È¢ÑÊúüÔºåÂÖ∑‰Ωì tidb backend Âíå local backend Ê®°ÂºèÂØºÂÖ•ÈÄüÂ∫¶Â∑ÆË∑ùÂæàÂ§ßÔºå<a href="https://docs.pingcap.com/tidb/v4.0/tidb-lightning-backends" target="_blank" rel="noreferrer">ÂÆòÁΩëÂèÇËÄÉÊï∞ÊçÆ</a>ËßÅ‰∏ãË°®„ÄÇ</p>
<figure><img src="./../../../../../images/tidb/08TiDB-Cloud-K8S/8-1TiDB-Deployment/03-lightning-speed-in-mode.jpeg" alt="03-lightning-speed-in-mode" tabindex="0"><figcaption>03-lightning-speed-in-mode</figcaption></figure>
</li>
<li>
<p>Lighting ÊØîËæÉÁâπÊÆäÔºåÂÆÉÂè™ÊòØ‰∏Ä‰∏™ÂèØÊâßË°åÊñá‰ª∂ÔºåÂú®Êé¢Á¥¢Âú®ÊâæÂà∞‰∫Ü 2 ‰∏≠‰ΩøÁî® Lightning ÁöÑÊñπÂºèÔºåÂç≥Ôºö<strong><a href="#‰∏âÁâ©ÁêÜÊú∫Ë∞ÉÁî®-lightning">k8s ÈõÜÁæ§Â§ñÈÉ®Ë∞ÉÁî® tidb-lightning binary</a></strong> Âíå <strong><a href="#‰∫åoperator-‰∏äÈÉ®ÁΩ≤-lightning">TiDB ÂÆòÁΩëÊé®ËçêÁöÑ‰ΩøÁî® helm ÂàõÂª∫ÂØºÂÖ•‰ªªÂä°</a></strong>„ÄÇ</p>
</li>
</ol>
<h2 id="‰∫å„ÄÅoperator-‰∏äÈÉ®ÁΩ≤-lightning" tabindex="-1">‰∫å„ÄÅOperator ‰∏äÈÉ®ÁΩ≤ Lightning <a class="header-anchor" href="#‰∫å„ÄÅoperator-‰∏äÈÉ®ÁΩ≤-lightning" aria-label="Permalink to &quot;‰∫å„ÄÅOperator ‰∏äÈÉ®ÁΩ≤ Lightning&quot;"></a></h2>
<ol>
<li>
<p><a href="https://docs.pingcap.com/zh/tidb-in-kubernetes/stable/restore-data-using-tidb-lightning" target="_blank" rel="noreferrer">TiDB ÂÆòÁΩëÁöÑÂØºÂÖ•ÈõÜÁæ§Êï∞ÊçÆ</a>‰ªãÁªçÁöÑÊØîËæÉÂÆåÂñÑÔºå‰ª•‰∏ãÊòØÂÖ∑‰ΩìÁöÑÊìç‰ΩúÊ≠•È™§„ÄÇ</p>
</li>
<li>
<p>ÂáÜÂ§á PV Âπ∂ÈÉ®ÁΩ≤ lightning</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> vim</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-lightning-values.yaml</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># For `local` backend, an extra PV is needed for local KV sorting.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sortedKV:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  storageClassName:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> local-storage</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  storage:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 5Gi</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> helm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> search</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> repo</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -l</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-operator</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> helm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> inspect</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> values</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> pingcap/tidb-lightning</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --version=v1.4.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> ></span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-lightning-values.yaml</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                                          local-storage</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">            12d</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> nodes</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --show-labels</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">             STATUS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   ROLES</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">           AGE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   VERSION</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   LABELS</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">docker-desktop</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   Ready</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    control-plane</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   13d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   v1.25.4</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   beta.kubernetes.io/arch=arm64,beta.kubernetes.io/os=linux,kubernetes.io/arch=arm64,kubernetes.io/hostname=docker-desktop,kubernetes.io/os=linux,node-role.kubernetes.io/control-plane=,node.kubernetes.io/exclude-from-external-load-balancers=</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># ÊåáÂÆöÊü•Âà∞ÁöÑ Node Name(Âç≥Ôºödocker-desktop)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> vim</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-lightning-pv.yaml</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">apiVersion:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> v1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">kind:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> PersistentVolume</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">metadata:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  name:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> local-sharedssd</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">spec:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  capacity:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    storage:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 5Gi</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  accessModes:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ReadWriteOnce</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  persistentVolumeReclaimPolicy:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Retain</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  storageClassName:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> local-storage</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  local:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    path:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /Users/jan/Database/k8s/data_tidb/sharedssd</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  nodeAffinity:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    required:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">      nodeSelectorTerms:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">      -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> matchExpressions:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">        -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> key:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> kubernetes.io/hostname</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">          operator:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> In</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">          values:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">          -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> docker-desktop</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> apply</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-lightning-pv.yaml</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> pv</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">grep</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -B</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 10</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Available</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                       CAPACITY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   ACCESS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> MODES</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   RECLAIM</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> POLICY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   STATUS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      CLAIM</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                       STORAGECLASS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    REASON</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   AGE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> local-sharedssd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                            5Gi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">        RWO</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">            Retain</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">           Available</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> helm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> jan-lightning</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> pingcap/tidb-lightning</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --namespace=tidb-cluster</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> failFast=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">true</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-lightning-values.yaml</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --version=v1.4.0</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">NAME:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> jan-lightning</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">LAST</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> DEPLOYED:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Wed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Mar</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 29</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 17:18:45</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 2023</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">NAMESPACE:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">STATUS:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> deployed</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">REVISION:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">TEST</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> SUITE:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">NOTES:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">1.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Check</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-lightning</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> status</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> job</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -l</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> app.kubernetes.io/name=jan-lightning-tidb-lightning</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> po</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -l</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> app.kubernetes.io/name=jan-lightning-tidb-lightning</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">2.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Check</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-lightning</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> logs</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> logs</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -l</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> app.kubernetes.io/name=jan-lightning-tidb-lightning</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">3.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> View</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-lightning</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> status</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> page</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> port-forward</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> svc/jan-lightning-tidb-lightning</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 8289:8289</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  View</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> http://localhost:8289</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> web</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> browser</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> logs</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -l</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> app.kubernetes.io/name=jan-lightning-tidb-lightning</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --tail=-1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "successfully"</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tidb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> lightning</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> exit</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> successfully</span></span></code></pre>
</div></li>
<li>
<p>Á≠âÂæÖÂØºÂÖ•ÂÆåÊàê</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> pod</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> lightning</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan-lightning-tidb-lightning-7ssfc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     0/1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     Completed</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">          22h</span></span></code></pre>
</div></li>
</ol>
<h2 id="‰∏â„ÄÅÁâ©ÁêÜÊú∫Ë∞ÉÁî®-lightning" tabindex="-1">‰∏â„ÄÅÁâ©ÁêÜÊú∫Ë∞ÉÁî® Lightning <a class="header-anchor" href="#‰∏â„ÄÅÁâ©ÁêÜÊú∫Ë∞ÉÁî®-lightning" aria-label="Permalink to &quot;‰∏â„ÄÅÁâ©ÁêÜÊú∫Ë∞ÉÁî® Lightning&quot;"></a></h2>
<ol>
<li>
<p>Âõ†‰∏∫ Lightning ÈúÄË¶Å‰∏é tikv, tidb, pd ÁöÑËøêË°åÁ´ØÂè£ÂèäÁä∂ÊÄÅÁ´ØÂè£ÔºåÊâÄ‰ª•ÂùáÈúÄË¶ÅÊö¥Èú≤ÁªôÊú¨Âú∞Áâ©ÁêÜÊú∫„ÄÇ</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ~</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> port-forward</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> svc/basic-tidb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 6000:4000</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Forwarding</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 127.0.0.1:6000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 4000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Forwarding</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [::1]:6000 -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> 4000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Handling</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> connection</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> for</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 6000</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ~</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> port-forward</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> svc/basic-tidb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 10080:10080</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Forwarding</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 127.0.0.1:10080</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 10080</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Forwarding</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [::1]:10080 -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> 10080</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ~</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> port-forward</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> svc/basic-pd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 2379:2379</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Forwarding</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 127.0.0.1:2379</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 2379</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Forwarding</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [::1]:2379 -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> 2379</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ~</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> port-forward</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> svc/basic-tikv-peer</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 20160:20160</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Forwarding</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 127.0.0.1:20160</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 20160</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Forwarding</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [::1]:20160 -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> 20160</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Handling</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> connection</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> for</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 20160</span></span></code></pre>
</div></li>
<li>
<p>Âç≥‰ΩøÊö¥Èú≤Á´ØÂè£ËøòÊòØ‰ºöÊä•ÈîôÔºå‰ªéÊä•Èîô‰ø°ÊÅØÂèØ‰ª•ÁúãÂá∫ <code>\&quot;transport: Error while dialing dial tcp: lookup basic-pd-0.basic-pd-peer.tidb-cluster.svc: no such host\&quot;</code> ÊåáÂêë tidb cluster ÂèçÂõû‰∫Ü k8s ÂÜÖÈÉ®Ë∑ØÁî±‰ø°ÊÅØÁªô lightning„ÄÇ</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tiup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-lightning</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ./lightning-config.yaml</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --log-file</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ./lightning.log</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tiup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> checking</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> updates</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> component</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-lightning</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> component</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tidb-lightning</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /Users/jan/.tiup/components/tidb-lightning/v6.6.0/tidb-lightning</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ./lightning-config.yaml</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --log-file</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ./lightning.log</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Verbose</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> debug</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> logs</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> will</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> be</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> written</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ./lightning.log</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"level"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"warn"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"ts"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"2023-03-30T02:20:19.463+0800"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"logger"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"etcd-client"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"caller"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"v3@v3.5.2/retry_interceptor.go:62"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"msg"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"retrying of unary invoker failed"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"target"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"etcd-endpoints://0x14000d78000/127.0.0.1:2379"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"attempt"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">:0,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"error"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"rpc error: code = DeadlineExceeded desc = latest balancer error: last connection error: connection error: desc = </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">transport: Error while dialing dial tcp: lookup basic-pd-0.basic-pd-peer.tidb-cluster.svc: no such host</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"level"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"info"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"ts"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"2023-03-30T02:20:19.464+0800"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"logger"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"etcd-client"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"caller"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"v3@v3.5.2/client.go:207"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"msg"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"Auto sync endpoints failed."</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"error"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"context deadline exceeded"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tidb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> lightning</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> encountered</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> error:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [Lightning:KV:ErrCreateKVClient]create kv client error: [PD:client:ErrClientCreateTSOStream]create TSO stream failed, retry timeout</span></span></code></pre>
</div></li>
<li>
<p>ÁªïËøáÂäûÊ≥ïÊòØÂú® host ‰∏≠Ê∑ªÂä†ÊâÄÊúâ svc ÁöÑÂüüÂêçÊò†Â∞Ñ</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ~</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /etc/hosts</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">127.0.0.1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> basic-pd-0.basic-pd-peer.tidb-cluster.svc</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">127.0.0.1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> basic-tikv-0.basic-tikv-peer.tidb-cluster.svc</span></span></code></pre>
</div></li>
<li>
<p>ÂØºÂÖ•È™åËØÅ</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">mysql</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> show tables;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">Empty</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">01</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> sec)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">//</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ÊåáÂÆö lightning ÂØºÂÖ•‰ªªÂä°ÔºåÂπ∂Á≠âÂæÖÂÆåÊàê</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">mysql</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> show tables;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">----------------+</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| Tables_in_test |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">----------------+</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| sbtest1        |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| sbtest10       |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| sbtest2        |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| sbtest3        |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| sbtest4        |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| sbtest5        |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| sbtest6        |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| sbtest7        |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| sbtest8        |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| sbtest9        |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">----------------+</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">10</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> rows</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> in</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">01</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> sec)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">mysql</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> select</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> sbtest10 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">limit</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">----+------+-------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------+</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| id | k    | c                                                                                                                       | pad                                                         |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">----+------+-------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------+</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">|  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2506</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">77825755741</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">57613716249</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">41363434969</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">61943511716</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">24253397196</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">16456423243</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">71719660127</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">90287149046</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">57007239064</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">51092775305</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">22380089381</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">03483981033</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">98305230683</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">44627144526</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">67135627326</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">----+------+-------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------+</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> row</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> in</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">01</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> sec)</span></span></code></pre>
</div></li>
</ol>
]]></content:encoded>
            <enclosure url="https://askaric.com/images/tidb/08TiDB-Cloud-K8S/8-1TiDB-Deployment/03-lightning-speed-in-mode.jpeg" length="0" type="image/jpeg"/>
        </item>
        <item>
            <title><![CDATA[Macbook M1 ‰ΩìÈ™å Operator ÈÉ®ÁΩ≤ TiCDC]]></title>
            <link>https://askaric.com/zh/work/tidb/08TiDB-Cloud-K8S/8-1TiDB-Â∫îÁî®ÂÆûË∑µ/04TiDB-Operator ÈÉ®ÁΩ≤ TICDC.html</link>
            <guid>https://askaric.com/zh/work/tidb/08TiDB-Cloud-K8S/8-1TiDB-Â∫îÁî®ÂÆûË∑µ/04TiDB-Operator ÈÉ®ÁΩ≤ TICDC.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[# Macbook M1 ‰ΩìÈ™å Operator ÈÉ®ÁΩ≤ TiCDC

> **ËØ•ÊñáÊ°£Â∑≤ÁªèÂèëÂ∏ÉÔºåÂç≥‰ªé ‚Äú[ËÆ∫Âùõ-ÊäÄÊúØÈöèÁ¨î]‚Äù ‰∏≠ÁßªÂá∫ÔºåÂéüÊñáÊ°£Âèò‰∏∫ÂêéÊúüÁª¥Êä§ÔºåÂèØÂú® [ÂéüÊñáÊ°£](http://forum.dbnest.net/t/topic/26) ‰∏≠ÊèêÂá∫ÊÇ®ÂØπÊñáÊ°£ÁöÑÂª∫ËÆÆ„ÄÇ**

## ‰∏Ä„ÄÅÊâ©ÂÆπ TiCDC POD

1. TiCDC ÈááÁî®Áõ¥Êé•Âú®Â∑≤ÈÉ®ÁΩ≤ÁöÑ k8s ‰∏äÁöÑ TiDB Cluster ‰∏≠Êâ©ÂÆπ POD ÁöÑÊñπÂºèÈÉ®ÁΩ≤ÔºåÂ¶Ç‰∏çÁÜüÊÇâÈÉ®ÁΩ≤ TiDB ËØ∑ÂèÇËÄÉ [**"Macbook M1 ‰ΩìÈ™å Operator ÈÉ®ÁΩ≤ TiDB Cluster"**](http://www.dbnest.net/zh/tidb/08TiDB-Cloud-K8S/8-1TiDB-%E5%BA%94%E7%94%A8%E5%AE%9E%E8%B7%B5/01TiDB-Operator%20%E9%83%A8%E7%BD%B2%20TiDB.html)„ÄÇ
2. ËØ•Ê≠•È™§ÂèÇËÄÉ [TiDB ÂÆòÁΩë-Âú® Kubernetes ‰∏äÈÉ®ÁΩ≤ TiCDC](https://docs.pingcap.com/zh/tidb-in-kubernetes/stable/deploy-ticdc#%E5%9C%A8-kubernetes-%E4%B8%8A%E9%83%A8%E7%BD%B2-ticdc)Ôºå‰∏ãËø∞‰∏∫Êìç‰ΩúÊ≠•È™§„ÄÇ

## ‰∫å„ÄÅÈÉ®ÁΩ≤‰∏ãÊ∏∏ MySQL

Êú¨Ê¨°ÈÄâÊã© MySQL ‰Ωú‰∏∫‰∏ãÊ∏∏ÔºåÁõ¥Êé•Âú® k8s ‰∏äÈÉ®ÁΩ≤‰∏Ä‰∏™ MySQLÔºåÊ≠•È™§Â¶Ç‰∏ãÔºö

```shell
jan@Jan-M1-Pro tidb-config % vim mysql.yaml
apiVersion: v1
kind: PersistentVolumeClaim
apiVersion: v1
metadata:
  name: ticdc-to-mysql-pvc
  namespace: tidb-cluster
spec:
  accessModes:
    - ReadWriteMany
  resources:
    requests:
      storage: 5Gi
]]></description>
            <content:encoded><![CDATA[<h1 id="macbook-m1-‰ΩìÈ™å-operator-ÈÉ®ÁΩ≤-ticdc" tabindex="-1">Macbook M1 ‰ΩìÈ™å Operator ÈÉ®ÁΩ≤ TiCDC <a class="header-anchor" href="#macbook-m1-‰ΩìÈ™å-operator-ÈÉ®ÁΩ≤-ticdc" aria-label="Permalink to &quot;Macbook M1 ‰ΩìÈ™å Operator ÈÉ®ÁΩ≤ TiCDC&quot;"></a></h1>
<blockquote>
<p><strong>ËØ•ÊñáÊ°£Â∑≤ÁªèÂèëÂ∏ÉÔºåÂç≥‰ªé ‚Äú[ËÆ∫Âùõ-ÊäÄÊúØÈöèÁ¨î]‚Äù ‰∏≠ÁßªÂá∫ÔºåÂéüÊñáÊ°£Âèò‰∏∫ÂêéÊúüÁª¥Êä§ÔºåÂèØÂú® <a href="http://forum.dbnest.net/t/topic/26" target="_blank" rel="noreferrer">ÂéüÊñáÊ°£</a> ‰∏≠ÊèêÂá∫ÊÇ®ÂØπÊñáÊ°£ÁöÑÂª∫ËÆÆ„ÄÇ</strong></p>
</blockquote>
<h2 id="‰∏Ä„ÄÅÊâ©ÂÆπ-ticdc-pod" tabindex="-1">‰∏Ä„ÄÅÊâ©ÂÆπ TiCDC POD <a class="header-anchor" href="#‰∏Ä„ÄÅÊâ©ÂÆπ-ticdc-pod" aria-label="Permalink to &quot;‰∏Ä„ÄÅÊâ©ÂÆπ TiCDC POD&quot;"></a></h2>
<ol>
<li>TiCDC ÈááÁî®Áõ¥Êé•Âú®Â∑≤ÈÉ®ÁΩ≤ÁöÑ k8s ‰∏äÁöÑ TiDB Cluster ‰∏≠Êâ©ÂÆπ POD ÁöÑÊñπÂºèÈÉ®ÁΩ≤ÔºåÂ¶Ç‰∏çÁÜüÊÇâÈÉ®ÁΩ≤ TiDB ËØ∑ÂèÇËÄÉ <a href="http://www.dbnest.net/zh/tidb/08TiDB-Cloud-K8S/8-1TiDB-%E5%BA%94%E7%94%A8%E5%AE%9E%E8%B7%B5/01TiDB-Operator%20%E9%83%A8%E7%BD%B2%20TiDB.html" target="_blank" rel="noreferrer"><strong>&quot;Macbook M1 ‰ΩìÈ™å Operator ÈÉ®ÁΩ≤ TiDB Cluster&quot;</strong></a>„ÄÇ</li>
<li>ËØ•Ê≠•È™§ÂèÇËÄÉ <a href="https://docs.pingcap.com/zh/tidb-in-kubernetes/stable/deploy-ticdc#%E5%9C%A8-kubernetes-%E4%B8%8A%E9%83%A8%E7%BD%B2-ticdc" target="_blank" rel="noreferrer">TiDB ÂÆòÁΩë-Âú® Kubernetes ‰∏äÈÉ®ÁΩ≤ TiCDC</a>Ôºå‰∏ãËø∞‰∏∫Êìç‰ΩúÊ≠•È™§„ÄÇ</li>
</ol>
<h2 id="‰∫å„ÄÅÈÉ®ÁΩ≤‰∏ãÊ∏∏-mysql" tabindex="-1">‰∫å„ÄÅÈÉ®ÁΩ≤‰∏ãÊ∏∏ MySQL <a class="header-anchor" href="#‰∫å„ÄÅÈÉ®ÁΩ≤‰∏ãÊ∏∏-mysql" aria-label="Permalink to &quot;‰∫å„ÄÅÈÉ®ÁΩ≤‰∏ãÊ∏∏ MySQL&quot;"></a></h2>
<p>Êú¨Ê¨°ÈÄâÊã© MySQL ‰Ωú‰∏∫‰∏ãÊ∏∏ÔºåÁõ¥Êé•Âú® k8s ‰∏äÈÉ®ÁΩ≤‰∏Ä‰∏™ MySQLÔºåÊ≠•È™§Â¶Ç‰∏ãÔºö</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> vim</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysql.yaml</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">apiVersion:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> v1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">kind:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> PersistentVolumeClaim</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">apiVersion:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> v1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">metadata:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  name:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ticdc-to-mysql-pvc</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  namespace:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">spec:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  accessModes:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ReadWriteMany</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  resources:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    requests:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">      storage:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 5Gi</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">---</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">apiVersion:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> v1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">kind:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Service</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">metadata:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  name:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ticdc-to-mysql-svc</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  namespace:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">spec:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  ports:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> name:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysql</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    port:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 3306</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    targetPort:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 3306</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  selector:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    app:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysql</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  clusterIP:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> None</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">---</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">apiVersion:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> apps/v1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">kind:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Deployment</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">metadata:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  name:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ticdc-to-mysql-deploy</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  namespace:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">spec:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  replicas:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  selector:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    matchLabels:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">      app:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysql</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  template:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    metadata:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">      labels:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">        app:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysql</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    spec:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">      containers:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">        -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> name:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysql</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">          image:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysql:8.0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">          imagePullPolicy:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> IfNotPresent</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">          env:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">          -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> name:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> MYSQL_ROOT_PASSWORD</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            value:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "123123"</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">          ports:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> containerPort:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 3306</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">          volumeMounts:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> name:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysql-pvc</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">              mountPath:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /var/lib/mysql</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">      volumes:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">        -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> name:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysql-pvc</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">          persistentVolumeClaim:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            claimName:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ticdc-to-mysql-pvc</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> apply</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysql.yaml</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> pod</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -A</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ticdc</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tidb-cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   ticdc-to-mysql-deploy-85d5d498bc-wwcvb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                  28s</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> pv</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ticdc</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">pvc-00bdbc50-2be7-4525-8626-dc64ff8c1ef6</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   5Gi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">        RWX</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">            Delete</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">           Bound</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    tidb-cluster/ticdc-to-mysql-pvc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                       hostpath</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                 38s</span></span></code></pre>
</div><h2 id="‰∏â„ÄÅÊâ©ÂÆπ-ticdc-pod" tabindex="-1">‰∏â„ÄÅÊâ©ÂÆπ TiCDC POD <a class="header-anchor" href="#‰∏â„ÄÅÊâ©ÂÆπ-ticdc-pod" aria-label="Permalink to &quot;‰∏â„ÄÅÊâ©ÂÆπ TiCDC POD&quot;"></a></h2>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    READY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   PD</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                  STORAGE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   READY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   DESIRE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   TIKV</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                  STORAGE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   READY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   DESIRE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   TIDB</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                  READY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   DESIRE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   AGE</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">basic</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   True</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    pingcap/pd:v6.5.0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   1Gi</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">       1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">       1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">        pingcap/tikv:v6.5.0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   1Gi</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">       1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">       1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">        pingcap/tidb:v6.5.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">       1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">        14d</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> edit</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">spec:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  ticdc:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    baseImage:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> pingcap/ticdc</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    replicas:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 2</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> pod</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -A</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ticdc</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tidb-cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   basic-ticdc-0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                            1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                19s</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tidb-cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   basic-ticdc-1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                            1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                18s</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tidb-cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   ticdc-to-mysql-deploy-85d5d498bc-wwcvb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                7m5s</span></span></code></pre>
</div><h2 id="Âõõ„ÄÅÂàõÂª∫‰ªªÂä°" tabindex="-1">Âõõ„ÄÅÂàõÂª∫‰ªªÂä° <a class="header-anchor" href="#Âõõ„ÄÅÂàõÂª∫‰ªªÂä°" aria-label="Permalink to &quot;Âõõ„ÄÅÂàõÂª∫‰ªªÂä°&quot;"></a></h2>
<ol>
<li>
<p>ËøõÂÖ•ÈÉ®ÁΩ≤ÁöÑ ticdc pod ÂÜÖÈÉ®,ÂêåÊ≠•‰πãÂâç DM ÂØºÂÖ•ÁöÑ <a href="http://www.dbnest.net/zh/tidb/08TiDB-Cloud-K8S/8-1TiDB-%E5%BA%94%E7%94%A8%E5%AE%9E%E8%B7%B5/02TiDB-Operator%20%E9%83%A8%E7%BD%B2%20DM.html" target="_blank" rel="noreferrer">test.sbtest1 ~ test.sbtest10</a>.</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> exec</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -it</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> basic-ticdc-0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> sh</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">/</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"> # ps -ef|grep cdc</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> root</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      3h36</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /cdc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> server</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --addr=0.0.0.0:8301</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --advertise-addr=basic-ticdc-0.basic-ticdc-peer.tidb-cluster.svc:8301</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --gc-ttl=86400</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --log-file=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --log-level=info</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --pd=http://basic-pd:2379</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  91</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> root</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      0:00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> cdc</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">/</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"> # mkdir config &#x26; cd config</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">/</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"> # vim changefeed-test.toml</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[filter]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">rules</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'test.*'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">/</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"> # /cdc cli changefeed create --server=http://basic-ticdc-0.basic-ticdc-peer.tidb-cluster.svc:8301 --sink-uri="mysql://root:123123@ticdc-to-mysql-svc:3307/" --changefeed-id="jan</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">-task</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Create changefeed successfully!</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ID: jan-task</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Info: {"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">upstream_id</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":7211019554206462790,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">namespace</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">default</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">id</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan-task</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sink_uri</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">mysql://root:xxxxx@ticdc-to-mysql-svc:3307/</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">create_time</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">2023-03-23T05:00:06.050107131Z</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">start_ts</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":440283327592660995,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">engine</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">unified</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">config</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":{"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">case_sensitive</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":true,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">enable_old_value</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":true,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">force_replicate</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":false,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ignore_ineligible_table</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":false,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">check_gc_safe_point</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":true,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">enable_sync_point</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":false,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">bdr_mode</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":false,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sync_point_interval</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":600000000000,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sync_point_retention</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":86400000000000,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">filter</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":{"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">rules</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":["</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">*.*</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"],"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">event_filters</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":null},"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">mounter</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":{"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">worker_num</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":16},"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sink</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":{"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">protocol</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">schema_registry</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">csv</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":{"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">delimiter</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">quote</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">\</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">""</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"null"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\\</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">N"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"include_commit_ts"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">:false},</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"column_selectors"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">:null,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"transaction_atomicity"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"none"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"encoder_concurrency"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">:16,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"terminator"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"\r\n"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"date_separator"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"none"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"enable_partition_separator"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">:false},</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"consistent"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">level</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">none</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">max_log_size</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":64,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">flush_interval</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":2000,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">storage</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":""}},"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">state</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">normal</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">creator_version</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">v6.5.0</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"}</span></span></code></pre>
</div></li>
<li>
<p>Ê£ÄÊü• TiCDC ÁõëÊéßÂèä‰∏ãÊ∏∏ÊòØÂê¶ÊúâÊ≠£Â∏∏ÂêåÊ≠•Êï∞ÊçÆÂç≥ÂèØ„ÄÇ</p>
</li>
</ol>
<h2 id="‰∫î„ÄÅÈîÄÊØÅ-ticdc" tabindex="-1">‰∫î„ÄÅÈîÄÊØÅ TiCDC <a class="header-anchor" href="#‰∫î„ÄÅÈîÄÊØÅ-ticdc" aria-label="Permalink to &quot;‰∫î„ÄÅÈîÄÊØÅ TiCDC&quot;"></a></h2>
<ol>
<li>
<p>Âà†Èô§ÂêåÊ≠•‰ªªÂä°</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> exec</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -it</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> basic-ticdc-0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> sh</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">/</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"> # /cdc cli changefeed remove --server=http://basic-ticdc-0.basic-ticdc-peer.tidb-cluster.svc:8301 --changefeed-id="jan-task"</span></span></code></pre>
</div></li>
<li>
<p>Âà†Èô§ TiCDC pod</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> edit</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  ......</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  ticdc:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    baseImage:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> pingcap/ticdc</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    replicas:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 0</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  ......</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> pod</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -A</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ticdc</span></span></code></pre>
</div></li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Dumpling Âø´ÈÄü‰ΩøÁî®]]></title>
            <link>https://askaric.com/zh/work/tidb/TiDB-EcosystematicTools/5-3Dumpling/01Dumpling Âø´ÈÄü‰ΩøÁî®.html</link>
            <guid>https://askaric.com/zh/work/tidb/TiDB-EcosystematicTools/5-3Dumpling/01Dumpling Âø´ÈÄü‰ΩøÁî®.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[# Dumpling Âø´ÈÄü‰ΩøÁî®

## ‰∏ãËΩΩÂÆâË£ÖÂåÖ

‰∏ãËΩΩÈìæÊé•<https://download.pingcap.org/tidb-toolkit-{version}-linux-amd64.tar.gz‰∏≠ÁöÑ> **{version}** ‰∏∫ Dumpling ÁöÑÁâàÊú¨Âè∑„ÄÇ  
Êú¨‰æãÔºå‰ª•v4.0.2 ÁâàÊú¨‰∏∫ËåÉ‰æã‰∏ãËΩΩÈìæÊé•Â¶Ç‰∏ã„ÄÇ

```shell
[tidb@tidb01-41 soft]$ wget https://download.pingcap.org/tidb-toolkit-v4.0.2-linux-amd64.tar.gz

--2021-01-04 08:34:25--  https://download.pingcap.org/tidb-toolkit-v4.0.2-linux-amd64.tar.gz
Resolving download.pingcap.org (download.pingcap.org)... 111.7.105.238, 111.63.182.240, 120.201.132.238, ...
Connecting to download.pingcap.org (download.pingcap.org)|111.7.105.238|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 142758194 (136M) [application/x-compressed]
Saving to: ‚Äòtidb-toolkit-v4.0.2-linux-amd64.tar.gz‚Äô

100%[========================================================================================================================================================================>] 142,758,194 4.52MB/s   in 26s    

2021-01-04 08:34:52 (5.21 MB/s) - ‚Äòtidb-toolkit-v4.0.2-linux-amd64.tar.gz‚Äô saved [142758194/142758194]


[tidb@tidb01-41 soft]$ ll
total 139420
drwxrwxr-x 18 tidb tidb      4096 Dec 27 03:29 tidb-ansible
-rw-rw-r--  1 tidb tidb 142758194 Jul  1  2020 tidb-toolkit-v4.0.2-linux-amd64.tar.gz
```

## Ëß£ÂéãÂπ∂ÈÖçÁΩÆÁéØÂ¢ÉÂèòÈáè

```shell
[tidb@tidb01-41 soft]$ ll
total 139420
drwxrwxr-x 18 tidb tidb      4096 Dec 27 03:29 tidb-ansible
-rw-rw-r--  1 tidb tidb 142758194 Jul  1  2020 tidb-toolkit-v4.0.2-linux-amd64.tar.gz

# Ëß£Âéã‰∏ãËΩΩÂ•ΩÁöÑÂéãÁº©ÂåÖ
[tidb@tidb01-41 soft]$ tar -xivf tidb-toolkit-v4.0.2-linux-amd64.tar.gz 
tidb-toolkit-v4.0.2-linux-amd64/
tidb-toolkit-v4.0.2-linux-amd64/bin/
tidb-toolkit-v4.0.2-linux-amd64/bin/pd-tso-bench
tidb-toolkit-v4.0.2-linux-amd64/bin/tikv-importer
tidb-toolkit-v4.0.2-linux-amd64/bin/tidb-lightning-ctl
tidb-toolkit-v4.0.2-linux-amd64/bin/br
tidb-toolkit-v4.0.2-linux-amd64/bin/sync_diff_inspector
tidb-toolkit-v4.0.2-linux-amd64/bin/mydumper
tidb-toolkit-v4.0.2-linux-amd64/bin/dumpling
tidb-toolkit-v4.0.2-linux-amd64/bin/tidb-lightning


# ‰øÆÊîπÁî®Êà∑ÁéØÂ¢ÉÂèòÈáèÈÖçÁΩÆÊñá‰ª∂
# Âú®ÁªìÂ∞æËøΩÂä†Â¶Ç‰∏ã‰∏§Ë°åÂÜÖÂÆπ
[tidb@tidb01-41 soft]$ vi ~/.bash_profile 

[tidb@tidb01-41 soft]$ tail -2 ~/.bash_profile
PATH=/home/tidb/soft/tidb-toolkit-v4.0.2-linux-amd64/bin:$PATH
export PATH

# ‰ΩøÁéØÂ¢ÉÂèòÈáèÊõ¥ÊîπÁîüÊïà
[tidb@tidb01-41 soft]$ source ~/.bash_profile
[tidb@tidb01-41 soft]$ dumpling --help
```

## tiup ‰ΩøÁî® dumpling

```shell
[tidb@tiup-tidb41 ~]$ tiup install dumpling

[tidb@tiup-tidb41 ~]$ tiup list --installed
Available components:
Name      Owner    Description
]]></description>
            <content:encoded><![CDATA[<h1 id="dumpling-Âø´ÈÄü‰ΩøÁî®" tabindex="-1">Dumpling Âø´ÈÄü‰ΩøÁî® <a class="header-anchor" href="#dumpling-Âø´ÈÄü‰ΩøÁî®" aria-label="Permalink to &quot;Dumpling Âø´ÈÄü‰ΩøÁî®&quot;"></a></h1>
<h2 id="‰∏ãËΩΩÂÆâË£ÖÂåÖ" tabindex="-1">‰∏ãËΩΩÂÆâË£ÖÂåÖ <a class="header-anchor" href="#‰∏ãËΩΩÂÆâË£ÖÂåÖ" aria-label="Permalink to &quot;‰∏ãËΩΩÂÆâË£ÖÂåÖ&quot;"></a></h2>
<p>‰∏ãËΩΩÈìæÊé•<a href="https://download.pingcap.org/tidb-toolkit-%7Bversion%7D-linux-amd64.tar.gz%E4%B8%AD%E7%9A%84" target="_blank" rel="noreferrer">https://download.pingcap.org/tidb-toolkit-{version}-linux-amd64.tar.gz‰∏≠ÁöÑ</a> <strong>{version}</strong> ‰∏∫ Dumpling ÁöÑÁâàÊú¨Âè∑„ÄÇ<br>
Êú¨‰æãÔºå‰ª•v4.0.2 ÁâàÊú¨‰∏∫ËåÉ‰æã‰∏ãËΩΩÈìæÊé•Â¶Ç‰∏ã„ÄÇ</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tidb01-41 soft]$ wget https://download.pingcap.org/tidb-toolkit-v4.0.2-linux-amd64.tar.gz</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">--2021-01-04</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 08:34:25--</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  https://download.pingcap.org/tidb-toolkit-v4.0.2-linux-amd64.tar.gz</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Resolving</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> download.pingcap.org</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (download.pingcap.org)... 111.7.105.238, 111.63.182.240, 120.201.132.238, ...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Connecting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> download.pingcap.org</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (download.pingcap.org)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">111.7.105.238</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">:443...</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> connected.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">HTTP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> request</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> sent,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> awaiting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> response...</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 200</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> OK</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Length:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 142758194</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (136M) [application/x-compressed]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Saving</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> to:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ‚Äòtidb-toolkit-v4.0.2-linux-amd64.tar.gz‚Äô</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">100%[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">========================================================================================================================================================================</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">></span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">]</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 142,758,194</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 4.52MB/s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 26s</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">2021-01-04</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 08:34:52</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (5.21 </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">MB/s</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) - ‚Äòtidb-toolkit-v4.0.2-linux-amd64.tar.gz‚Äô saved [142758194/142758194]</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tidb01-41 soft]$ ll</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">total</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 139420</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">drwxrwxr-x</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 18</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">      4096</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Dec</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 27</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 03:29</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-ansible</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">-rw-rw-r--</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 142758194</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Jul</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  2020</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-toolkit-v4.0.2-linux-amd64.tar.gz</span></span></code></pre>
</div><h2 id="Ëß£ÂéãÂπ∂ÈÖçÁΩÆÁéØÂ¢ÉÂèòÈáè" tabindex="-1">Ëß£ÂéãÂπ∂ÈÖçÁΩÆÁéØÂ¢ÉÂèòÈáè <a class="header-anchor" href="#Ëß£ÂéãÂπ∂ÈÖçÁΩÆÁéØÂ¢ÉÂèòÈáè" aria-label="Permalink to &quot;Ëß£ÂéãÂπ∂ÈÖçÁΩÆÁéØÂ¢ÉÂèòÈáè&quot;"></a></h2>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tidb01-41 soft]$ ll</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">total</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 139420</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">drwxrwxr-x</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 18</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">      4096</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Dec</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 27</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 03:29</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-ansible</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">-rw-rw-r--</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 142758194</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Jul</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  2020</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-toolkit-v4.0.2-linux-amd64.tar.gz</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Ëß£Âéã‰∏ãËΩΩÂ•ΩÁöÑÂéãÁº©ÂåÖ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tidb01-41 soft]$ tar -xivf tidb-toolkit-v4.0.2-linux-amd64.tar.gz </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tidb-toolkit-v4.0.2-linux-amd64/</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tidb-toolkit-v4.0.2-linux-amd64/bin/</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tidb-toolkit-v4.0.2-linux-amd64/bin/pd-tso-bench</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tidb-toolkit-v4.0.2-linux-amd64/bin/tikv-importer</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tidb-toolkit-v4.0.2-linux-amd64/bin/tidb-lightning-ctl</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tidb-toolkit-v4.0.2-linux-amd64/bin/br</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tidb-toolkit-v4.0.2-linux-amd64/bin/sync_diff_inspector</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tidb-toolkit-v4.0.2-linux-amd64/bin/mydumper</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tidb-toolkit-v4.0.2-linux-amd64/bin/dumpling</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tidb-toolkit-v4.0.2-linux-amd64/bin/tidb-lightning</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># ‰øÆÊîπÁî®Êà∑ÁéØÂ¢ÉÂèòÈáèÈÖçÁΩÆÊñá‰ª∂</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Âú®ÁªìÂ∞æËøΩÂä†Â¶Ç‰∏ã‰∏§Ë°åÂÜÖÂÆπ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tidb01-41 soft]$ vi </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">/.bash_profile </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tidb01-41 soft]$ tail -2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">/.bash_profile</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">PATH</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">/home/tidb/soft/tidb-toolkit-v4.0.2-linux-amd64/bin:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">$PATH</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> PATH</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># ‰ΩøÁéØÂ¢ÉÂèòÈáèÊõ¥ÊîπÁîüÊïà</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tidb01-41 soft]$ source </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">/.bash_profile</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tidb01-41 soft]$ dumpling --help</span></span></code></pre>
</div><h2 id="tiup-‰ΩøÁî®-dumpling" tabindex="-1">tiup ‰ΩøÁî® dumpling <a class="header-anchor" href="#tiup-‰ΩøÁî®-dumpling" aria-label="Permalink to &quot;tiup ‰ΩøÁî® dumpling&quot;"></a></h2>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ tiup install dumpling</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ tiup list --installed</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Available</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> components:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      Owner</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    Description</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">      -----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    -----------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">dumpling</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  pingcap</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Dumpling</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> CLI</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tool</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> that</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> helps</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> you</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dump</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> MySQL/TiDB</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> data</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span></code></pre>
</div><h2 id="mysql-ÊµãËØï-dumping" tabindex="-1">MySQL ÊµãËØï Dumping <a class="header-anchor" href="#mysql-ÊµãËØï-dumping" aria-label="Permalink to &quot;MySQL ÊµãËØï Dumping&quot;"></a></h2>
<ol>
<li>
<p>Â∞ÜdumplingÂ∑•ÂÖ∑Áõ∏ÂÖ≥Êú∫Âô®‰∏ä‰º†ÂÖ•ÊµãËØïMySQLÁöÑÊúçÂä°Âô® /usr/local/bin Ë∑ØÂæÑ‰∏ã,ÂÖ®Â±ÄÂèØÁî®Áä∂ÊÄÅÔºõ</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tidb01-41 bin]$ scp dumpling root@192.168.1.44:/usr/local/bin/</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">root@192.168.1.44</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">'s password: </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">dumpling                                                             100%   21MB  33.6MB/s   00:00</span></span></code></pre>
</div></li>
<li>
<p>ÂÆûÈ™åÁéØÂ¢ÉÂáÜÂ§áÔºõ</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># ÂàõÂª∫ÊµãËØïÊï∞ÊçÆÂ∫ì</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">create</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> database</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> jan_db</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">use</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> jan_db</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">create</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> table</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> jan_test</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (id </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">int,name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)) DEFAULT CHARACTER SET utf8;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">insert</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> into</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> jan_test</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> values</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (1,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'jan_1'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">),(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">2,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">'jan_2'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">),(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">3,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">'jan_3'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">),(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">4,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">'jan_4'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">);</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># ÂàõÂª∫ÊµãËØïÁî®Êà∑Âπ∂ÊéàÊùÉ</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">create</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> user</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'jan'@'tidb04-44'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> identified</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> by</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> '123123'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">grant</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> reload,replication</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> client</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> on</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> *</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">*</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'jan'@'tidb04-44'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">grant</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> lock</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tables</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> on</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> jan_db.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">*</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'jan'@'tidb04-44'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">grant</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> select</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> on</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> jan_db.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">*</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'jan'@'tidb04-44'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">flush</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> privileges</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># grant select on mysql.tidb to 'jan'@'%';</span></span></code></pre>
</div></li>
<li>
<p>MySQL Á´Ø‰ΩøÁî® Dumpling ÂØºÂá∫ÔºåÂπ∂Êõ¥ÊîπË°®ÂêçÂ∞ÜÊï∞ÊçÆÂØºÂõûÊï∞ÊçÆÂ∫ìÔºõ</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># ÊàêÂäü‰ΩøÁî®dumplingÂØºÂá∫MySQLÊï∞ÊçÆ</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[root@tidb04-44 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]# dumpling -h192.168.1.44 -ujan -p123123 -P 3306 -T </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"jan_db.jan_test"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> -o /root/dumpdir </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Release</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> version:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> v4.0.2</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> commit</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> hash:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ff92fcf2fa8fc77127df21820280f6b2088b8309</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> branch:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      heads/v4.0.2</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Build</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> timestamp:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 2020-07-01</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 09:42:00Z</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Go</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> version:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      go</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> version</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> go1.13</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> linux/amd64</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[2021/01/05 09:12:23.633 -05:00] [INFO] [config.go:139] [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"detect server type"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">] [type</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">MySQL]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[2021/01/05 09:12:23.633 -05:00] [INFO] [config.go:157] [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"detect server version"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">] [version</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">5.6.50]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[2021/01/05 09:12:23.634 -05:00] [INFO] [sql.go:419] [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"session variable is not supported by db"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">] [variable</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">tidb_mem_quota_query] [value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">34359738368]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[2021/01/05 09:12:23.643 -05:00] [INFO] [main.go:195] [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"dump data successfully, dumpling will exit now"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># ÂàóÂá∫ÂØºÂá∫Êï∞ÊçÆÁõÆÂΩï‰∏ã</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[root@tidb04-44 dumpdir]# ll</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">total</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 16</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">-rwxr-xr-x.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> root</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> root</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 111</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Jan</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  5</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 09:12</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> jan_db.jan_test.0.sql</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">       #  ÂØºÂá∫ÁöÑÈÄªËæëÊï∞ÊçÆsqlÊñá‰ª∂</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">-rwxr-xr-x.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> root</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> root</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 129</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Jan</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  5</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 09:12</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> jan_db.jan_test-schema.sql</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">  #  ÂØºÂá∫ÁöÑË°®schemaÈÄªËæëËØ≠Âè•Êñá‰ª∂</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">-rwxr-xr-x.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> root</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> root</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  67</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Jan</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  5</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 09:12</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> jan_db-schema-create.sql</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    #  ÂØºÂá∫ÁöÑÊï∞ÊçÆÂ∫ìschemaÈÄªËæëËØ≠Âè•Êñá‰ª∂</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">-rwxr-xr-x.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> root</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> root</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  95</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Jan</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  5</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 09:12</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> metadata</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">                    #  ÂØºÂá∫ÁöÑÂÖÉÊï∞ÊçÆËÆ∞ÂΩïÊñá‰ª∂</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># rootÁî®Êà∑‰∏ãÊõ¥ÊîπË°®ÂêçÂ∞ÜÊï∞ÊçÆÂØºÂõûÊï∞ÊçÆÂ∫ì</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[root@tidb04-44 dumpdir]# mysql -uroot -p123123 </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">use</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> jan_db</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">rename</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> table</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> jan_test</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> jan_test_bak</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">source</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> jan_db.jan_test-schema.sql</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">source</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> jan_db.jan_test.0.sql</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">show</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tables</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+------------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Tables_in_jan_db</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+------------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> jan_test</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">         |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> jan_test_bak</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">     |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+------------------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> rows</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">select</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> jan_test</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+----------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> count(*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+----------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">        4</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+----------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> row</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">select</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> jan_test_bak</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+----------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> count(*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+----------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">        4</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+----------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> row</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span></code></pre>
</div></li>
</ol>
<h2 id="tidb-ÊµãËØï-dumpling-ÂØºÂá∫-sql" tabindex="-1">TiDB ÊµãËØï Dumpling ÂØºÂá∫ SQL <a class="header-anchor" href="#tidb-ÊµãËØï-dumpling-ÂØºÂá∫-sql" aria-label="Permalink to &quot;TiDB ÊµãËØï Dumpling ÂØºÂá∫ SQL&quot;"></a></h2>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># ÊâßË°ådumplingÂØºÂá∫ÂëΩ‰ª§</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tidb01-41 soft]$ dumpling </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> root</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  -P</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 4000</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  -h</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 192.168.1.41</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /home/tidb/dumpdir/sqlexp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  --sql</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'select * from `jan`.`sbtest1` where id &#x3C; 100'</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Release</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> version:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> v4.0.2</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> commit</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> hash:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ff92fcf2fa8fc77127df21820280f6b2088b8309</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> branch:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      heads/v4.0.2</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Build</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> timestamp:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 2020-07-01</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 09:42:00Z</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Go</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> version:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      go</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> version</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> go1.13</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> linux/amd64</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[2021/01/04 09:11:00.450 -05:00] [INFO] [config.go:139] [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"detect server type"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">] [type</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">TiDB]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[2021/01/04 09:11:00.451 -05:00] [INFO] [config.go:157] [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"detect server version"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">] [version</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">3.0.1]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[2021/01/04 09:11:00.451 -05:00] [WARN] [dump.go:95] [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"If the amount of data to dump is large, criteria: (data more than 60GB or dumped time more than 10 minutes)\nyou'd better adjust the tikv_gc_life_time to avoid export failure due to TiDB GC during the dump process.\nBefore dumping: run sql `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">update</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysql.tidb set VARIABLE_VALUE = '720h' where VARIABLE_NAME = 'tikv_gc_life_time';` in tidb.\nAfter dumping: run sql `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">update</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysql.tidb set VARIABLE_VALUE = '10m' where VARIABLE_NAME = 'tikv_gc_life_time';` in tidb.\n"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[2021/01/04 09:11:00.580 -05:00] [INFO] [main.go:195] [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"dump data successfully, dumpling will exit now"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># ËøõÂÖ• SQL Êñá‰ª∂ÂØºÂá∫ÁõÆÂΩïÔºåÊü•ÁúãÂØºÂá∫ÁöÑÊñá‰ª∂</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tidb01-41 soft]$ cd ../dumpdir/sqlexp</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tidb01-41 dumpdir]$ pwd</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">/home/tidb/dumpdir</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tidb01-41 sqlexp]$ ll</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">total</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 24</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">-rwxr-xr-x</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   140</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Jan</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  4</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 09:26</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> metadata</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">-rwxr-xr-x</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 19368</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Jan</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  4</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 09:26</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> result.0.sql</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Êü•ÁúãdumplingÂØºÂá∫ÁöÑÂÖÉÊï∞ÊçÆ‰ø°ÊÅØ</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tidb01-41 sqlexp]$ cat metadata </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Started</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dump</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> at:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 2021-01-04</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 09:26:42</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SHOW</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> MASTER</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> STATUS:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  Log:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-binlog</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">        #  binlogÊó•ÂøóÂêçÁß∞</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  Pos:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 421991652309860365</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"> #  master binary log ÁöÑ‰ΩçÁΩÆ</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Finished</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dump</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> at:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 2021-01-04</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 09:26:42</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">   #  ÂØºÂá∫ÁöÑËµ∑ÂßãÊó∂Èó¥</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Êü•Áúãresult.0.csvÊñá‰ª∂ÁöÑÂâç5Ë°å</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tidb01-41 sqlexp]$ head -5 result.0.sql</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">/*!40101</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> SET</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> NAMES</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> binary</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">*</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">INSERT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> INTO</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ``</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">id</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">k</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">pad</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">VALUES</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">1,2494,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">'31451373586-15688153734-79729593694-96509299839-83724898275-86711833539-78981337422-35049690573-51724173961-87474696253'</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">'98996621624-36689827414-04092488557-09587706818-65008859162'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">2,2489,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">'21472970079-70972780322-70018558993-71769650003-09270326047-32417012031-10768856803-14235120402-93989080412-18690312264'</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">'04776826683-45880822084-77922711547-29057964468-76514263618'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">3,2495,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">'49376827441-24903985029-56844662308-79012577859-40518387141-60588419212-24399130405-42612257832-29494881732-71506024440'</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">'26843035807-96849339132-53943793991-69741192222-48634174017'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tidb01-41 sqlexp]$ vi result.0.sql </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tidb01-41 sqlexp]$ cat ./result.0.sql </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">wc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -l</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">101</span></span></code></pre>
</div><p>ÂèØ‰ª•ÁúãÂà∞ÂØºÂá∫ÁöÑresultÊñá‰ª∂‰∏≠‰∏∫101Ë°åÔºåËØÅÊòé--sqlÂèÇÊï∞‰πüÈÄÇÁî®‰∫ésqlÊñá‰ª∂ÁöÑÂØºÂá∫„ÄÇ</p>
<h2 id="tidb-ÊµãËØï-dumpling-ÂØºÂá∫-csv" tabindex="-1">TiDB ÊµãËØï Dumpling ÂØºÂá∫ CSV <a class="header-anchor" href="#tidb-ÊµãËØï-dumpling-ÂØºÂá∫-csv" aria-label="Permalink to &quot;TiDB ÊµãËØï Dumpling ÂØºÂá∫ CSV&quot;"></a></h2>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># ÊâßË°ådumplingÂØºÂá∫ÂëΩ‰ª§</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tidb01-41 soft]$ dumpling </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> root</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  -P</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 4000</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  -h</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 192.168.1.41</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /home/tidb/dumpdir</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  --filetype</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> csv</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  --sql</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'select * from `jan`.`sbtest1` where id &#x3C; 100'</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Release</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> version:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> v4.0.2</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> commit</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> hash:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ff92fcf2fa8fc77127df21820280f6b2088b8309</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> branch:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      heads/v4.0.2</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Build</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> timestamp:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 2020-07-01</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 09:42:00Z</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Go</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> version:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      go</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> version</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> go1.13</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> linux/amd64</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[2021/01/04 09:11:00.450 -05:00] [INFO] [config.go:139] [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"detect server type"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">] [type</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">TiDB]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[2021/01/04 09:11:00.451 -05:00] [INFO] [config.go:157] [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"detect server version"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">] [version</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">3.0.1]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[2021/01/04 09:11:00.451 -05:00] [WARN] [dump.go:95] [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"If the amount of data to dump is large, criteria: (data more than 60GB or dumped time more than 10 minutes)\nyou'd better adjust the tikv_gc_life_time to avoid export failure due to TiDB GC during the dump process.\nBefore dumping: run sql `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">update</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysql.tidb set VARIABLE_VALUE = '720h' where VARIABLE_NAME = 'tikv_gc_life_time';` in tidb.\nAfter dumping: run sql `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">update</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysql.tidb set VARIABLE_VALUE = '10m' where VARIABLE_NAME = 'tikv_gc_life_time';` in tidb.\n"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[2021/01/04 09:11:00.580 -05:00] [INFO] [main.go:195] [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"dump data successfully, dumpling will exit now"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># ËøõÂÖ• SQL Êñá‰ª∂ÂØºÂá∫ÁõÆÂΩïÔºåÊü•ÁúãÂØºÂá∫ÁöÑÊñá‰ª∂</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tidb01-41 soft]$ cd ../dumpdir/</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tidb01-41 dumpdir]$ pwd</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">/home/tidb/dumpdir</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tidb01-41 dumpdir]$ ll</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">total</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 24</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">-rwxr-xr-x</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   140</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Jan</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  4</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 09:11</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> metadata</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">-rwxr-xr-x</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 19018</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Jan</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  4</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 09:11</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> result.0.csv</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Êü•ÁúãdumplingÂØºÂá∫ÁöÑÂÖÉÊï∞ÊçÆ‰ø°ÊÅØ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tidb01-41 dumpdir]$ cat metadata </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Started</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dump</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> at:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 2021-01-04</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 09:11:00</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SHOW</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> MASTER</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> STATUS:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  Log:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-binlog</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">        #  binlogÊó•ÂøóÂêçÁß∞</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  Pos:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 421991405435486213</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"> #  master binary log ÁöÑ‰ΩçÁΩÆ</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Finished</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dump</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> at:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 2021-01-04</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 09:11:00</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">   # ÂØºÂá∫ÁöÑËµ∑ÂßãÊó∂Èó¥</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Êü•Áúãresult.0.csvÊñá‰ª∂ÁöÑÂâç5Ë°å</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tidb01-41 dumpdir]$ head -5 result.0.csv </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"id"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"k"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"c"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"pad"</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">1,2494,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"31451373586-15688153734-79729593694-96509299839-83724898275-86711833539-78981337422-35049690573-51724173961-87474696253"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"98996621624-36689827414-04092488557-09587706818-65008859162"</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">2,2489,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"21472970079-70972780322-70018558993-71769650003-09270326047-32417012031-10768856803-14235120402-93989080412-18690312264"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"04776826683-45880822084-77922711547-29057964468-76514263618"</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">3,2495,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"49376827441-24903985029-56844662308-79012577859-40518387141-60588419212-24399130405-42612257832-29494881732-71506024440"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"26843035807-96849339132-53943793991-69741192222-48634174017"</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">4,2594,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"85762858421-36258200885-10758669419-44272723583-12529521893-95630803635-53907705724-07005352902-43001596772-53048338959"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"37979424284-37912826784-31868864947-42903702727-96097885121"</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Â¶ÇÊûúÂØºÂá∫ÁöÑÊï∞ÊçÆÈùûÂ∏∏Â§ßÔºåÂ¶ÇÔºöÊï∞ÊçÆÈáèË∂ÖËøá60GBÊàñÂØºÂá∫Êó∂Â∏∏Ë∂ÖËøá10ÂàÜÈíüÔºõ</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Êé®ËçêË∞ÉÊï¥tikv_gc_life_time‰ª•ÈÅøÂÖçÁî±‰∫éTiDB GCÂØºËá¥ÁöÑÂ§±Ë¥•Ôºõ</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">update</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysql.tidb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> VARIABLE_VALUE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> '720h'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> where</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> VARIABLE_NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'tikv_gc_life_time'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;           </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># ÂØºÂá∫ÂâçË∞ÉÊï¥</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">update</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysql.tidb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> VARIABLE_VALUE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> '10m'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> where</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> VARIABLE_NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'tikv_gc_life_time'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;            </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># ÂØºÂá∫ÂêéË∞ÉÊï¥</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">MySQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [(none)]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> * from mysql.tidb where variable_name like </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'tikv_gc_life_time'</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\G</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">            # Êü•ËØ¢Ë∞ÉÊ∂®ÁªìÊûú</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">***************************</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> 1. row </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">***************************</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> VARIABLE_NAME:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tikv_gc_life_time</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">VARIABLE_VALUE:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 720h</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">       COMMENT:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> All</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> versions</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> within</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> life</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> time</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> will</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> not</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> be</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> collected</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> by</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> GC,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> at</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> least</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 10m,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Go</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> format.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> row</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (0.01 </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span></code></pre>
</div><h2 id="ÂèÇËÄÉÊñáÁ´†" tabindex="-1">ÂèÇËÄÉÊñáÁ´† <a class="header-anchor" href="#ÂèÇËÄÉÊñáÁ´†" aria-label="Permalink to &quot;ÂèÇËÄÉÊñáÁ´†&quot;"></a></h2>
<ol>
<li><a href="https://docs.pingcap.com/zh/tidb/stable/dumpling-overview" target="_blank" rel="noreferrer">TiDBÂÆòÁΩë-Dumpling ‰ΩøÁî®ÊñáÊ°£</a></li>
<li><a href="https://docs.pingcap.com/zh/tidb/stable/download-ecosystem-tools#dumpling" target="_blank" rel="noreferrer">TiDBÂÆòÁΩë-Â∑•ÂÖ∑‰∏ãËΩΩ</a></li>
<li><a href="https://www.bilibili.com/video/BV1kK4y1Z7tE?from=search&amp;seid=8438422389068483544" target="_blank" rel="noreferrer">BÁ´ô-yi888longÂØπdumplingÁöÑËÆ≤Ëß£Ôºöhttps://www.bilibili.com/video/BV1kK4y1Z7tE?from=search&amp;seid=8438422389068483544</a></li>
<li><a href="https://www.bilibili.com/video/BV1D5411L7z5" target="_blank" rel="noreferrer">BÁ´ô-„ÄêHigh Performance TiDB„ÄëLesson 12 ÁîüÊÄÅÂ∑•ÂÖ∑‰ºòÂåñ</a></li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Dumpling Êû∂ÊûÑÂéüÁêÜ]]></title>
            <link>https://askaric.com/zh/work/tidb/TiDB-EcosystematicTools/5-3Dumpling/02Dumpling Êû∂ÊûÑÂéüÁêÜ.html</link>
            <guid>https://askaric.com/zh/work/tidb/TiDB-EcosystematicTools/5-3Dumpling/02Dumpling Êû∂ÊûÑÂéüÁêÜ.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[# Dumpling Êû∂ÊûÑÂéüÁêÜ

## Âü∫Êú¨‰ø°ÊÅØ

1. ‰ªìÂ∫ìÔºöÊúÄÂàùÔºåDumpling ÊòØ‰∏Ä‰∏™ÂçïÁã¨ÁöÑÈ°πÁõÆÔºå‰ΩÜÁé∞Âú®Â∑≤ÂêàÂπ∂Âà∞ [TiDB Repo](https://github.com/pingcap/tidb/tree/master/dumpling) ‰∏≠„ÄÇ

2. ÂàÜÊûêÔºöÊàëÂøÖÈ°ªËØ¥ÔºåDumpling ÊòØÂ¶ÇÊ≠§ÁÆÄÂçïÔºå‰ΩÜÂú®Â§ßÂ§öÊï∞ÊÉÖÂÜµ‰∏ãÔºåTiDB ÈõÜÁæ§ÈÄöÂ∏∏‰ºöÂá∫Áé∞ÈóÆÈ¢ò„ÄÇÂ∞ΩÁÆ°ÊâÄÊúâÂ∑•ÂÖ∑ÈÉΩÊúâËøôÁßçÈóÆÈ¢òÔºå‰ΩÜÂú®ÊàëÁúãÊù•ÔºåDumpling Êõ¥Â§ö„ÄÇ

3. Â∑•‰ΩúÂéüÁêÜÔºöÁÆÄËÄåË®Ä‰πãÔºåDumpling Âπ∂Ë°åËøûÊé• TiDB ÈõÜÁæ§Ôºå‰ΩøÁî® SQL Âπ∂ÂèëÂú∞Ëé∑ÂèñÁªìÊûúÔºåÂπ∂ÊúÄÁªàÂ∞ÜÁªìÊûúÂÜôÂÖ• Linux Êñá‰ª∂„ÄÇ

## Â¶Ç‰ΩïÂàùÂßãÂåñ

1. [Startup steps](https://github.com/pingcap/tidb/blob/eb35c773b512e4e00c42caf7f04ea7397d00c127/dumpling/export/dump.go#L124-L137) ÊòØ‰ª•‰∏ã‰∏ÄÁ≥ªÂàóÊ≠•È™§ÁöÑÈõÜÂêàÔºö

    ```go
    err = runSteps(d,
    initLogger,
    createExternalStore,
    startHTTPService,
    openSQLDB,
    detectServerInfo,
    resolveAutoConsistency,

    validateResolveAutoConsistency,
    tidbSetPDClientForGC,
    tidbGetSnapshot,
    tidbStartGCSavepointUpdateService,

    setSessionParam)
    ```

2. ÊàëÂ∞ÜÂè™ÂÖ≥Ê≥®‰∏ªË¶ÅÊ≠•È™§ÂíåÁªÑ‰ª∂ÔºåÂç≥ (createExternalStore, startHTTPServer, openSQLDB, resolveAutoConsistency, validateResolveAutoConsistency, tidbSetPDClientForGC, tidbStartGCSavepointUpdateService)ÔºåËÄåÂÖ∂‰ªñÈÉ®ÂàÜÂè™ÊòØÂçèË∞ÉÂô®ÈÉ®ÂàÜ„ÄÇÂØπ‰∫é `createExternalStore`ÔºåÁî±‰∫é dumpling Â∑≤ÁªèÊèê‰æõ‰∫Ü Local„ÄÅHdfs„ÄÅS3„ÄÅAzureÔºåÂõ†Ê≠§ÂÆÉ‰ª¨ÂÖ∑ÊúâÂÆåÂÖ®‰∏çÂêåÁöÑÈÖçÁΩÆÈ°πÔºå‰∏ªË¶ÅÊÄùÊÉ≥ÊòØËé∑ÂèñË∂≥Â§üÁöÑ‰ø°ÊÅØ‰ª•ËøõË°å ËØª/ÂÜô  Âà∞‰∏çÂêåÁöÑ [LocalStorage](https://github.com/pingcap/tidb/blob/eb35c773b512e4e00c42caf7f04ea7397d00c127/br/pkg/storage/local.go#L161)„ÄÇ **ÊàëÂè™ÂÖ≥Ê≥® `Local`ÔºåÂÆÉ‰πüÊòØÂÖ∂‰ªñ externalStorage ËÉåÂêéÂÆûÁé∞ÈÄªËæëÁöÑÂü∫Á°Ä„ÄÇ**  Âè™ÊòØ‰∏Ä‰∏™Â∞ÅË£Ö‰∫ÜÂØºÂá∫Ë∑ØÂæÑÁöÑÁªìÊûÑ‰Ωì„ÄÇ

3. ÂØπ‰∫é [`startHTTPServer`](https://github.com/pingcap/tidb/blob/eb35c773b512e4e00c42caf7f04ea7397d00c127/dumpling/export/http_handler.go#L21)ÔºåÂú®‰∏Ä‰∏™ÂçïÁã¨ÁöÑ goroutine ‰∏≠ÔºåÂÆÉÁî®‰∫éÊûÑÂª∫‰∏éÂ∫¶ÈáèÁõ∏ÂÖ≥ÁöÑÂÜÖÂÆπÂíåÂÜÖÈÉ®Ë∞ÉËØïÔºåËøôÂú® Dumpling ‰∫åËøõÂà∂Êñá‰ª∂Âá∫Áé∞ÈóÆÈ¢òÊó∂ËøõË°åË∞ÉÊü•ÈùûÂ∏∏ÊúâÁî®„ÄÇÂØπ‰∫é [`openSQLDB`]ÔºåÂÆÉÂè™ÊòØÂàùÂßãÂåñ‰∫Ü‰∏Ä‰∏™ËøûÊé•Âà∞Êó®Âú®ÂØºÂá∫Êï∞ÊçÆÁöÑÊï∞ÊçÆÂ∫ì„ÄÇ

4. ÂØπ‰∫é [validateResolveAutoConsistency](https://github.com/pingcap/tidb/blob/eb35c773b512e4e00c42caf7f04ea7397d00c127/dumpling/export/dump.go#L1429)ÔºåÊ£ÄÊü•ÊòØÂê¶Â≠òÂú®‰∏ÄÁßçÊÉÖÂÜµÔºåÂç≥Âú® --consistency ‰∏çÊòØÂø´ÁÖßÊó∂Êó†Ê≥ïÊåáÂÆö --snapshot„ÄÇ

5. ÂØπ‰∫é [tidbSetPDClientForGC](https://github.com/pingcap/tidb/blob/eb35c773b512e4e00c42caf7f04ea7397d00c127/dumpling/export/dump.go#L1438)ÔºåÂ¶ÇÊûú‰∏ãÊ∏∏ÊòØ TiDBÔºåÂàôÂøÖÈ°ªËÆæÁΩÆ GCÔºå‰ΩÜÂú®Ê≠§Ê≠•È™§‰∏≠ÔºåÂè™ÈúÄÂàùÂßãÂåñÂπ∂ÂáÜÂ§áË∂≥Â§üÁöÑ‰ø°ÊÅØÔºå‰ª•‰Ωø pd-client Âú® Dumpling ‰∏≠‰∏é PD ÈÄö‰ø°„ÄÇ

6. ÂØπ‰∫é [tidbGetSnapshot](https://github.com/pingcap/tidb/blob/eb35c773b512e4e00c42caf7f04ea7397d00c127/dumpling/export/dump.go#L1466)ÔºåÂè™ÈúÄ‰ΩøÁî® `show master status` Ëé∑Âèñ PositionÔºåÂ¶Ç‰∏ãÊâÄÁ§∫ÔºåÂÆûÈôÖ‰∏ä‰∏é tidb ‰∏≠ÁöÑ `select tidb_current_tso()` Áõ∏ÂêåÔºõ

    ```sql
    mysql> begin;
    Query OK, 0 rows affected (0.00 sec)

    mysql> Show Master Status;
    +]]></description>
            <content:encoded><![CDATA[<h1 id="dumpling-Êû∂ÊûÑÂéüÁêÜ" tabindex="-1">Dumpling Êû∂ÊûÑÂéüÁêÜ <a class="header-anchor" href="#dumpling-Êû∂ÊûÑÂéüÁêÜ" aria-label="Permalink to &quot;Dumpling Êû∂ÊûÑÂéüÁêÜ&quot;"></a></h1>
<h2 id="Âü∫Êú¨‰ø°ÊÅØ" tabindex="-1">Âü∫Êú¨‰ø°ÊÅØ <a class="header-anchor" href="#Âü∫Êú¨‰ø°ÊÅØ" aria-label="Permalink to &quot;Âü∫Êú¨‰ø°ÊÅØ&quot;"></a></h2>
<ol>
<li>
<p>‰ªìÂ∫ìÔºöÊúÄÂàùÔºåDumpling ÊòØ‰∏Ä‰∏™ÂçïÁã¨ÁöÑÈ°πÁõÆÔºå‰ΩÜÁé∞Âú®Â∑≤ÂêàÂπ∂Âà∞ <a href="https://github.com/pingcap/tidb/tree/master/dumpling" target="_blank" rel="noreferrer">TiDB Repo</a> ‰∏≠„ÄÇ</p>
</li>
<li>
<p>ÂàÜÊûêÔºöÊàëÂøÖÈ°ªËØ¥ÔºåDumpling ÊòØÂ¶ÇÊ≠§ÁÆÄÂçïÔºå‰ΩÜÂú®Â§ßÂ§öÊï∞ÊÉÖÂÜµ‰∏ãÔºåTiDB ÈõÜÁæ§ÈÄöÂ∏∏‰ºöÂá∫Áé∞ÈóÆÈ¢ò„ÄÇÂ∞ΩÁÆ°ÊâÄÊúâÂ∑•ÂÖ∑ÈÉΩÊúâËøôÁßçÈóÆÈ¢òÔºå‰ΩÜÂú®ÊàëÁúãÊù•ÔºåDumpling Êõ¥Â§ö„ÄÇ</p>
</li>
<li>
<p>Â∑•‰ΩúÂéüÁêÜÔºöÁÆÄËÄåË®Ä‰πãÔºåDumpling Âπ∂Ë°åËøûÊé• TiDB ÈõÜÁæ§Ôºå‰ΩøÁî® SQL Âπ∂ÂèëÂú∞Ëé∑ÂèñÁªìÊûúÔºåÂπ∂ÊúÄÁªàÂ∞ÜÁªìÊûúÂÜôÂÖ• Linux Êñá‰ª∂„ÄÇ</p>
</li>
</ol>
<h2 id="Â¶Ç‰ΩïÂàùÂßãÂåñ" tabindex="-1">Â¶Ç‰ΩïÂàùÂßãÂåñ <a class="header-anchor" href="#Â¶Ç‰ΩïÂàùÂßãÂåñ" aria-label="Permalink to &quot;Â¶Ç‰ΩïÂàùÂßãÂåñ&quot;"></a></h2>
<ol>
<li>
<p><a href="https://github.com/pingcap/tidb/blob/eb35c773b512e4e00c42caf7f04ea7397d00c127/dumpling/export/dump.go#L124-L137" target="_blank" rel="noreferrer">Startup steps</a> ÊòØ‰ª•‰∏ã‰∏ÄÁ≥ªÂàóÊ≠•È™§ÁöÑÈõÜÂêàÔºö</p>
<div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> runSteps</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(d,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">initLogger,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">createExternalStore,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">startHTTPService,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">openSQLDB,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">detectServerInfo,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">resolveAutoConsistency,</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">validateResolveAutoConsistency,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">tidbSetPDClientForGC,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">tidbGetSnapshot,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">tidbStartGCSavepointUpdateService,</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">setSessionParam)</span></span></code></pre>
</div></li>
<li>
<p>ÊàëÂ∞ÜÂè™ÂÖ≥Ê≥®‰∏ªË¶ÅÊ≠•È™§ÂíåÁªÑ‰ª∂ÔºåÂç≥ (createExternalStore, startHTTPServer, openSQLDB, resolveAutoConsistency, validateResolveAutoConsistency, tidbSetPDClientForGC, tidbStartGCSavepointUpdateService)ÔºåËÄåÂÖ∂‰ªñÈÉ®ÂàÜÂè™ÊòØÂçèË∞ÉÂô®ÈÉ®ÂàÜ„ÄÇÂØπ‰∫é <code>createExternalStore</code>ÔºåÁî±‰∫é dumpling Â∑≤ÁªèÊèê‰æõ‰∫Ü Local„ÄÅHdfs„ÄÅS3„ÄÅAzureÔºåÂõ†Ê≠§ÂÆÉ‰ª¨ÂÖ∑ÊúâÂÆåÂÖ®‰∏çÂêåÁöÑÈÖçÁΩÆÈ°πÔºå‰∏ªË¶ÅÊÄùÊÉ≥ÊòØËé∑ÂèñË∂≥Â§üÁöÑ‰ø°ÊÅØ‰ª•ËøõË°å ËØª/ÂÜô  Âà∞‰∏çÂêåÁöÑ <a href="https://github.com/pingcap/tidb/blob/eb35c773b512e4e00c42caf7f04ea7397d00c127/br/pkg/storage/local.go#L161" target="_blank" rel="noreferrer">LocalStorage</a>„ÄÇ <strong>ÊàëÂè™ÂÖ≥Ê≥® <code>Local</code>ÔºåÂÆÉ‰πüÊòØÂÖ∂‰ªñ externalStorage ËÉåÂêéÂÆûÁé∞ÈÄªËæëÁöÑÂü∫Á°Ä„ÄÇ</strong>  Âè™ÊòØ‰∏Ä‰∏™Â∞ÅË£Ö‰∫ÜÂØºÂá∫Ë∑ØÂæÑÁöÑÁªìÊûÑ‰Ωì„ÄÇ</p>
</li>
<li>
<p>ÂØπ‰∫é <a href="https://github.com/pingcap/tidb/blob/eb35c773b512e4e00c42caf7f04ea7397d00c127/dumpling/export/http_handler.go#L21" target="_blank" rel="noreferrer"><code>startHTTPServer</code></a>ÔºåÂú®‰∏Ä‰∏™ÂçïÁã¨ÁöÑ goroutine ‰∏≠ÔºåÂÆÉÁî®‰∫éÊûÑÂª∫‰∏éÂ∫¶ÈáèÁõ∏ÂÖ≥ÁöÑÂÜÖÂÆπÂíåÂÜÖÈÉ®Ë∞ÉËØïÔºåËøôÂú® Dumpling ‰∫åËøõÂà∂Êñá‰ª∂Âá∫Áé∞ÈóÆÈ¢òÊó∂ËøõË°åË∞ÉÊü•ÈùûÂ∏∏ÊúâÁî®„ÄÇÂØπ‰∫é [<code>openSQLDB</code>]ÔºåÂÆÉÂè™ÊòØÂàùÂßãÂåñ‰∫Ü‰∏Ä‰∏™ËøûÊé•Âà∞Êó®Âú®ÂØºÂá∫Êï∞ÊçÆÁöÑÊï∞ÊçÆÂ∫ì„ÄÇ</p>
</li>
<li>
<p>ÂØπ‰∫é <a href="https://github.com/pingcap/tidb/blob/eb35c773b512e4e00c42caf7f04ea7397d00c127/dumpling/export/dump.go#L1429" target="_blank" rel="noreferrer">validateResolveAutoConsistency</a>ÔºåÊ£ÄÊü•ÊòØÂê¶Â≠òÂú®‰∏ÄÁßçÊÉÖÂÜµÔºåÂç≥Âú® --consistency ‰∏çÊòØÂø´ÁÖßÊó∂Êó†Ê≥ïÊåáÂÆö --snapshot„ÄÇ</p>
</li>
<li>
<p>ÂØπ‰∫é <a href="https://github.com/pingcap/tidb/blob/eb35c773b512e4e00c42caf7f04ea7397d00c127/dumpling/export/dump.go#L1438" target="_blank" rel="noreferrer">tidbSetPDClientForGC</a>ÔºåÂ¶ÇÊûú‰∏ãÊ∏∏ÊòØ TiDBÔºåÂàôÂøÖÈ°ªËÆæÁΩÆ GCÔºå‰ΩÜÂú®Ê≠§Ê≠•È™§‰∏≠ÔºåÂè™ÈúÄÂàùÂßãÂåñÂπ∂ÂáÜÂ§áË∂≥Â§üÁöÑ‰ø°ÊÅØÔºå‰ª•‰Ωø pd-client Âú® Dumpling ‰∏≠‰∏é PD ÈÄö‰ø°„ÄÇ</p>
</li>
<li>
<p>ÂØπ‰∫é <a href="https://github.com/pingcap/tidb/blob/eb35c773b512e4e00c42caf7f04ea7397d00c127/dumpling/export/dump.go#L1466" target="_blank" rel="noreferrer">tidbGetSnapshot</a>ÔºåÂè™ÈúÄ‰ΩøÁî® <code>show master status</code> Ëé∑Âèñ PositionÔºåÂ¶Ç‰∏ãÊâÄÁ§∫ÔºåÂÆûÈôÖ‰∏ä‰∏é tidb ‰∏≠ÁöÑ <code>select tidb_current_tso()</code> Áõ∏ÂêåÔºõ</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">mysql</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> begin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">Query OK, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> rows</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> affected (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> sec)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">mysql</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Show </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">Master</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> Status</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">-------------+--------------------+--------------+------------------+-------------------+</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">File</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        | Position           | Binlog_Do_DB | Binlog_Ignore_DB | Executed_Gtid_Set |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">-------------+--------------------+--------------+------------------+-------------------+</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| tidb</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">binlog | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">441037036439732234</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |              |                  |                   |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">-------------+--------------------+--------------+------------------+-------------------+</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> row</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> in</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">01</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> sec)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">mysql</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> tidb_current_tso();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">--------------------+</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| tidb_current_tso() |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">--------------------+</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">441037036439732234</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">--------------------+</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> row</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> in</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">01</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> sec)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">mysql</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> commit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">Query OK, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> rows</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> affected (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">01</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> sec)</span></span></code></pre>
</div></li>
<li>
<p>ÂØπ‰∫é <a href="https://github.com/pingcap/tidb/blob/eb35c773b512e4e00c42caf7f04ea7397d00c127/dumpling/export/dump.go#L1497" target="_blank" rel="noreferrer">tidbStartGCSavepointUpdateService</a> ÔºåÂÆÉ‰ΩøÁî®‰ªé <code>tidbGetSnapshot</code> Ëé∑ÂæóÁöÑÂø´ÁÖßÊù•ËÆæÁΩÆ <a href="https://github.com/pingcap/dumpling/issues/95" target="_blank" rel="noreferrer">TiKV GC safepoint</a>ÔºåÂπ∂ËÆæÁΩÆ‰∫Ü‰∏Ä‰∏™ ttl„ÄÇÂõ†Ê≠§ÔºåÈÄöËøáËøôÁßçÊñπÂºèÔºåÊõ¥È´òÁâàÊú¨ÁöÑ Dumpling ÂèØ‰ª•Èò≤Ê≠¢ TiKV GC Ê≠£Âú®‰ΩøÁî®ÁöÑË¶ÅÂØºÂá∫ÁöÑÊï∞ÊçÆ„ÄÇ</p>
</li>
<li>
<p>ÂØπ‰∫é <a href="https://github.com/pingcap/tidb/blob/eb35c773b512e4e00c42caf7f04ea7397d00c127/dumpling/export/dump.go#L1559" target="_blank" rel="noreferrer">setSessionParam</a>ÔºåÁî±‰∫éÊîØÊåÅ‰ª•  <code>dumpling --params</code>  ÊñπÂºè‰ΩøÁî®ÁöÑÈ¢ùÂ§ñ‰ºöËØùÂèòÈáè„ÄÇ‰∏çÂæó‰∏çËØ¥ÔºåËøôÁßçÊñπÂºè‰∏é TiDB ‰∫§‰∫íÈùûÂ∏∏ÈáçË¶ÅÔºåÂõ†‰∏∫ÊàëÂú®È°µÈù¢È°∂ÈÉ®ÊèêÂà∞Âú®ÂØºÂá∫Êï∞ÊçÆÊó∂Ôºå <strong><code>TiDB ÈõÜÁæ§ÈÄöÂ∏∏‰ºöÂá∫Áé∞ÈóÆÈ¢ò</code></strong>„ÄÇ</p>
</li>
</ol>
<h2 id="Â¶Ç‰ΩïÂ∑•‰Ωú" tabindex="-1">Â¶Ç‰ΩïÂ∑•‰Ωú <a class="header-anchor" href="#Â¶Ç‰ΩïÂ∑•‰Ωú" aria-label="Permalink to &quot;Â¶Ç‰ΩïÂ∑•‰Ωú&quot;"></a></h2>
<ol>
<li>
<p>Âú®ÂàùÂßãÂåñÊ≠•È™§‰πãÂêéÔºå<a href="https://github.com/pingcap/tidb/blob/eb35c773b512e4e00c42caf7f04ea7397d00c127/dumpling/export/dump.go#L143" target="_blank" rel="noreferrer">Dump()</a> ÊòØ‰ªéÊï∞ÊçÆÂ∫ì‰∏≠ÂØºÂá∫Ë°®ÁöÑ‰∏ªË¶ÅÈÄªËæë„ÄÇ</p>
</li>
<li>
<p>Âú® Dump() ‰∏≠ÔºåÊúâ‰∏Ä‰∏™ÈÄªËæëÈÄâÊã©ÈÄöËøá SQL ËøòÊòØÈÄöËøáÊï∞ÊçÆÂ∫ìÂØºÂá∫ÔºåËøôÂèñÂÜ≥‰∫éÊÇ®ÊòØÂê¶ÈÖçÁΩÆ‰∫Ü <code>--sql</code> ÂèÇÊï∞„ÄÇ</p>
</li>
<li>
<p><a href="https://github.com/pingcap/tidb/blob/eb35c773b512e4e00c42caf7f04ea7397d00c127/dumpling/export/dump.go#L267" target="_blank" rel="noreferrer">func startWrite</a> Â∞ÜÂàõÂª∫‰∏é <code>Threads</code> Êï∞ÈáèÁõ∏ÂêåÁöÑ groutines„ÄÇÂàõÂª∫ÁöÑ groutines Áî®‰∫éÂπ∂Ë°åÂ§ÑÁêÜ‰ªªÂä°„ÄÇ‰ªé <a href="https://github.com/pingcap/tidb/blob/eb35c773b512e4e00c42caf7f04ea7397d00c127/dumpling/export/writer.go#L102" target="_blank" rel="noreferrer">func Write.handleTask</a> ÁöÑÈÄªËæëÊù•ÁúãÔºåÊúâ‰∏ÄÁ≥ªÂàóÂáΩÊï∞ÔºåÂ¶Ç <code>WriteDatabaseMeta</code>„ÄÅ<code>WriteTableMeta</code>„ÄÅ<code>WriteTableData</code> Á≠â„ÄÇËøô‰∫õÂáΩÊï∞‰∏ªË¶ÅÊòØÊâßË°å SQL Êü•ËØ¢Âπ∂Â∞ÜÁªìÊûúÂÜôÂÖ•‰∏çÂêåÁöÑ externalStorage Êñá‰ª∂„ÄÇ</p>
</li>
</ol>
<h2 id="sql-ÂØºÂá∫" tabindex="-1">SQL ÂØºÂá∫ <a class="header-anchor" href="#sql-ÂØºÂá∫" aria-label="Permalink to &quot;SQL ÂØºÂá∫&quot;"></a></h2>
<ol>
<li>
<p>Âú® <a href="https://github.com/pingcap/tidb/blob/eb35c773b512e4e00c42caf7f04ea7397d00c127/dumpling/export/dump.go#L1261" target="_blank" rel="noreferrer">detectEstimateRows</a> ÂáΩÊï∞‰∏≠Ôºå‰ΩøÁî® <code>fmt.Sprintf(&quot;EXPLAIN %s&quot;, &quot;select * from table_a a left join table_b b on a.id = b.id where ...&quot;)</code> Êù•Ëé∑Âèñ estimateRowsÔºå‰ΩÜÊòØÂÆÉÂè™ÊòØÁî®Êù•ËÆ∞ÂΩï dumpling_dump_estimate_total_rows ÊåáÊ†áÁöÑÂÄº„ÄÇÂà∞ÁõÆÂâç‰∏∫Ê≠¢ÔºåËøòÊ≤°Êúâ‰ªª‰ΩïÂÖ≥‰∫é Dumpling ÁöÑÂºÄÊ∫êÊúçÂä°„ÄÇÊàëÁåúÂú®Êú™Êù•‰ºöÊúâ‰∏Ä‰∏™ <a href="https://github.com/pingcap/tidb/issues/34948" target="_blank" rel="noreferrer">Dataflow Engine</a> ‰Ωú‰∏∫ÂêéÁ´ØÊúçÂä°ËøêË°å Dumpling„ÄÇ</p>
</li>
<li>
<p>Ê≠£Â¶ÇÊàë‰∏äÈù¢ÊèêÂà∞ÁöÑÔºåWriter ÁªÑ‰ª∂Â∞ÜÊâßË°åÊü•ËØ¢Âπ∂Â∞ÜÁªìÊûú‰øùÂ≠ò‰∏∫Êñá‰ª∂„ÄÇÂÄºÂæóÊ≥®ÊÑèÁöÑÊòØÔºå‰ΩøÁî® Dumpling ÁöÑ <code>--sql</code> ÁöÑÈÄªËæëÊòØÈÄöËøá <code>totalChunks</code> Á°¨ÁºñÁ†Å‰∏∫ <code>1</code> Êù•ÊâßË°åÊü•ËØ¢ÁöÑÂîØ‰∏ÄÊñπÂºèÔºå‰πüÂ∞±ÊòØËØ¥‰∏çÂ≠òÂú®Âπ∂Âèë„ÄÇ</p>
</li>
</ol>
<h2 id="schema-ÂØºÂá∫" tabindex="-1">Schema ÂØºÂá∫ <a class="header-anchor" href="#schema-ÂØºÂá∫" aria-label="Permalink to &quot;Schema ÂØºÂá∫&quot;"></a></h2>
<ol>
<li>
<p>È¶ñÂÖàÔºåÊúâ<a href="https://github.com/pingcap/tidb/blob/eb35c773b512e4e00c42caf7f04ea7397d00c127/dumpling/export/dump.go#L420-L484" target="_blank" rel="noreferrer">ÂæàÂ§öÂæ™ÁéØ</a>Êù•ÂáÜÂ§áÊØè‰∏™Ë°®Ê®°ÂºèÂíåË°®Êï∞ÊçÆ‰Ωú‰∏∫‰ªªÂä°Âπ∂Â∞ÜÂÆÉ‰ª¨ÂèëÈÄÅÂà∞ Write Á≠âÂæÖÂ§ÑÁêÜ„ÄÇ</p>
</li>
<li>
<p>Âú® <a href="https://github.com/pingcap/tidb/blob/eb35c773b512e4e00c42caf7f04ea7397d00c127/dumpling/export/dump.go#L624-L627" target="_blank" rel="noreferrer">func dumpTableData</a> ÂÜÖÈÉ®Êúâ‰∏Ä‰∏™‰∏ªË¶ÅÁöÑÈÄªËæëÊù•Ë∞ÉÊï¥ÊòØÂê¶‰ΩøÁî®Âπ∂Âèë„ÄÇÂ¶ÇÊûúÊÇ®ÈÖçÁΩÆ‰∫Ü <code>--rows</code>ÔºåÂàô‰ºö‰ΩøÁî®Âπ∂Âèë„ÄÇÂ¶ÇÊûúÊ≤°ÊúâÔºåÂàôÊï¥‰∏™Ë°®Â∞Ü‰ΩøÁî®‰∏Ä‰∏™Êü•ËØ¢ÂØºÂá∫ÁªìÊûúÔºå‰æãÂ¶Ç <code>select column_aÔºåcolumn_bÔºåcolumn_c ... from database_a.table_a order by XXX</code>„ÄÇ‰ΩÜÊòØÔºåÂπ∂ÂèëÊñπÂºèÈ¶ñÂÖàÊòØ <a href="https://github.com/pingcap/tidb/blob/eb35c773b512e4e00c42caf7f04ea7397d00c127/dumpling/export/dump.go#L731" target="_blank" rel="noreferrer">the func concurrentDumpTable</a> Â∞ùËØïÂ∞ÜË°®ÊãÜÂàÜ‰∏∫Â§ö‰∏™Âùó‰ª•ËøõË°åÂØºÂá∫„ÄÇ</p>
</li>
<li>
<p>ÂçïË°®ÂØºÂá∫ÈÄöËøá‰ª•‰∏ãÊ≠•È™§Âπ∂ÂèëÊâßË°åÔºö<br>
a. È¶ñÂÖàÔºå<a href="https://github.com/pingcap/tidb/blob/eb35c773b512e4e00c42caf7f04ea7397d00c127/dumpling/export/sql.go#L439" target="_blank" rel="noreferrer">func orderByClause</a> ÂÜ≥ÂÆö‰ΩøÁî® <code>_tidb_rowid</code> Êàñ <code>Primary key</code> ËøõË°åÊéíÂ∫è„ÄÇ<br>
b. ÂÖ∂Ê¨°Ôºå[func pickupPossibleField] ÂÜ≥ÂÆö‰ΩøÁî® <code>_tidb_rowid</code> Êàñ <code>Numeric PK</code> Êàñ <code>UK Index</code> Êàñ <code>no proper index</code>ÔºåÊåâÊàëÁºñÂÜôÁöÑÈ°∫Â∫è‰ºòÂÖà„ÄÇ<br>
c. Á¨¨‰∏âÔºå<a href="https://github.com/pingcap/tidb/blob/eb35c773b512e4e00c42caf7f04ea7397d00c127/dumpling/export/sql.go#L1175" target="_blank" rel="noreferrer">func estimateCount</a> ‰ΩøÁî® <code>EXPLAIN SELECT * FROM DATABASE_XXX.TABLE_XXX</code> Ëé∑Âèñ‰º∞ËÆ°ÁöÑ RowNumber„ÄÇ<br>
d. Â¶ÇÊûú estimateCount &lt; <code>--rows</code>ÔºåÂàôÁõ¥Êé•‰ΩøÁî®‰∏Ä‰∏™Âçï‰∏ÄÁöÑ sql ÂØºÂá∫Ë°®„ÄÇ<br>
e. Â¶ÇÊûú pickupPossibleField ÂèØ‰ª•ËæìÂá∫ÂêàÈÄÇÁöÑÂ≠óÊÆµÔºàÂçïÊï∞ÊàñÂ§çÊï∞ÔºâÔºåÂàô‰ΩøÁî® <code>SELECT MIN(field_xxx),MAX(field_xxx) FROM database_a.table_a</code> Ëé∑ÂèñÊúÄÂ§ßÂÄºÂíåÊúÄÂ∞èÂÄº„ÄÇÂ¶ÇÊûúÊúâ‰ªª‰ΩïÈîôËØØÊàñÊó†Ê≥ïËé∑ÂèñÊúÄÂ§ßÂÄºÊàñÊúÄÂ∞èÂÄºÔºåÂàôÁõ¥Êé•‰ΩøÁî®‰∏Ä‰∏™ sql ÂØºÂá∫Ë°®„ÄÇ<br>
f. ÁÑ∂ÂêéÔºå‰ΩøÁî® <code>estimatedChunks := count / conf.Rows</code> Â∞ÜÂÖ∂ÊãÜÂàÜ‰∏∫‰∏Ä‰∫õÂùóÔºåÂπ∂Â∞ÜÂÆÉ‰ª¨Âπ∂Ë°åÊâßË°å‰∏∫‰ªªÂä°„ÄÇ</p>
</li>
</ol>
<h2 id="ÊúÄÂêéÊÄªÁªì" tabindex="-1">ÊúÄÂêéÊÄªÁªì <a class="header-anchor" href="#ÊúÄÂêéÊÄªÁªì" aria-label="Permalink to &quot;ÊúÄÂêéÊÄªÁªì&quot;"></a></h2>
<p>Âú®Âø´ÈÄüÊü•ÁúãÊ∫ê‰ª£Á†ÅÂêéÔºåÊàë‰ª¨‰∫ÜËß£Âà∞‰ª•‰∏ãÂÜÖÂÆπÔºö</p>
<ol>
<li><code>--row</code> ÊòØÊéßÂà∂Ë°®Ê†ºÊòØÂê¶ÂèØ‰ª•Ë¢´ÂàÜÊàê‰∏çÂêåÁöÑÂùóÂπ∂Âπ∂Ë°åÊâßË°åÁöÑÂºÄÂÖ≥„ÄÇ</li>
<li><code>--thread</code> ÊòØÊéßÂà∂‰∏çÂêåË°®Ê†º‰πãÈó¥Âπ∂ÂèëÁöÑÂºÄÂÖ≥„ÄÇ</li>
<li>Â∞ΩÁÆ°Êàë‰ª¨Â∑≤ÁªèÈÖçÁΩÆ‰∫Ü <code>--rows</code>Ôºå‰ΩÜÊúâ‰∫õÊÉÖÂÜµ‰∏ãÔºåÂõ†‰∏∫Êó†Ê≥ïÂ∞ÜÂàÜÂâ≤ chunk ÂØºËá¥Ë°®ÂÜÖÈÉ®ÁöÑÊï∞ÊçÆÂØºÂá∫Êó†Ê≥ï‰ª•Âπ∂ÂèëÁöÑÊñπÂºèÊâßË°å„ÄÇ</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[DM Architecture Overview]]></title>
            <link>https://askaric.com/zh/work/tidb/TiDB-EcosystematicTools/5-4DM/01TiDB-DM Êû∂ÊûÑÊÄªËßà.html</link>
            <guid>https://askaric.com/zh/work/tidb/TiDB-EcosystematicTools/5-4DM/01TiDB-DM Êû∂ÊûÑÊÄªËßà.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[‰ªÄ‰πàÊòØ DM
1. Â¶ÇÊûú‰Ω†Á¨¨‰∏ÄÊ¨°ÁúãÂà∞ÊàëÁöÑÊñáÊ°£ÔºåÊàëÊÉ≥‰Ω†Â∑≤ÁªèÁÜüÊÇâDM‰∫Ü„ÄÇÊ≤°ÊúâËøô‰∫õÔºåÊàëÊÉ≥Â§ßÂÆ∂ÂèØ‰ª•ÁúãÁúãDMÂÆòÁΩë„ÄÇ
2. Ê≠£Â¶ÇÊàë‰ª¨ÂèØ‰ª•ÁúãÂà∞‰∏ãÈù¢ÁöÑÊû∂ÊûÑÔºåÁÆÄËÄåË®Ä‰πãÔºåÂÆÉÁî®Êù•‰∏çÊñ≠Âú∞Â∞ÜÊï∞ÊçÆ‰ªé MySQL ÂçïÂÆû‰æãÊàñÂàÜÁâá M]]></description>
            <content:encoded><![CDATA[<h1 id="dm-architecture-overview" tabindex="-1">DM Architecture Overview <a class="header-anchor" href="#dm-architecture-overview" aria-label="Permalink to &quot;DM Architecture Overview&quot;"></a></h1>
<h2 id="‰ªÄ‰πàÊòØ-dm" tabindex="-1">‰ªÄ‰πàÊòØ DM <a class="header-anchor" href="#‰ªÄ‰πàÊòØ-dm" aria-label="Permalink to &quot;‰ªÄ‰πàÊòØ DM&quot;"></a></h2>
<ol>
<li>
<p>Â¶ÇÊûú‰Ω†Á¨¨‰∏ÄÊ¨°ÁúãÂà∞ÊàëÁöÑÊñáÊ°£ÔºåÊàëÊÉ≥‰Ω†Â∑≤ÁªèÁÜüÊÇâDM‰∫Ü„ÄÇÊ≤°ÊúâËøô‰∫õÔºåÊàëÊÉ≥Â§ßÂÆ∂ÂèØ‰ª•ÁúãÁúã<a href="https://docs.pingcap.com/zh/tidb/stable/dm-arch" target="_blank" rel="noreferrer">DMÂÆòÁΩë</a>„ÄÇ</p>
</li>
<li>
<p>Ê≠£Â¶ÇÊàë‰ª¨ÂèØ‰ª•ÁúãÂà∞‰∏ãÈù¢ÁöÑÊû∂ÊûÑÔºåÁÆÄËÄåË®Ä‰πãÔºåÂÆÉÁî®Êù•‰∏çÊñ≠Âú∞Â∞ÜÊï∞ÊçÆ‰ªé MySQL ÂçïÂÆû‰æãÊàñÂàÜÁâá MySQL ÈõÜÁæ§ËøÅÁßªÂà∞TiDBÈõÜÁæ§„ÄÇDM-worker ‰∏é MySQL ÂÆû‰æãÁöÑÊï∞ÈáèÊòØ1ÊØî1ÁöÑÂÖ≥Á≥ªÔºåDM ÂÆûÈôÖ‰∏äÊâÄÂÅöÁöÑÊòØËØªÂèñ MySQL binlogÔºåÂπ∂Âú®TiDBÈõÜÁæ§ÁöÑÂ§çÂà∂ËøáÁ®ã‰∏≠Â∞ÜÂÆÉ‰ª¨ÂÖ®ÈÉ®ËΩ¨Êç¢‰∏∫ DML (ÊèíÂÖ•„ÄÅÊõ¥Êñ∞„ÄÅÂà†Èô§Á±ªÂûã) Âíå DDL ËØ≠Âè•„ÄÇ</p>
<figure><img src="https://download.pingcap.com/images/docs-cn/dm/dm-architecture-2.0.png" alt="architecture" tabindex="0"><figcaption>architecture</figcaption></figure>
</li>
</ol>
<h2 id="ÊñáÁ´†ÁõÆÁöÑ" tabindex="-1">ÊñáÁ´†ÁõÆÁöÑ <a class="header-anchor" href="#ÊñáÁ´†ÁõÆÁöÑ" aria-label="Permalink to &quot;ÊñáÁ´†ÁõÆÁöÑ&quot;"></a></h2>
<ol>
<li>
<p>Âú®‚ÄúMaster‚ÄùÔºå‚ÄúWorker‚ÄùÔºå‚ÄúSyncer‚ÄùÂíå‚ÄúSourceWorker‚ÄùÁöÑÂü∫Á°Ä‰∏äÔºåÊàëÊÉ≥ÁÆÄÂçï‰ªãÁªç‰∏Ä‰∏ãDM„ÄÇÊâÄ‰ª•ÔºåÂú®ËØªÂÆåÂÆÉ‰ª¨‰πãÂêéÔºå‰Ω†ÂèØ‰ª•Áü•ÈÅìDMÊòØÂ¶Ç‰ΩïÂ∑•‰ΩúÁöÑÔºåÊØè‰∏™ÂÖ≥ÈîÆÁªÑ‰ª∂ÁöÑÂê´‰πâÂíåËÅåË¥£„ÄÇ</p>
</li>
<li>
<p>ÂØπ‰∫é‚ÄúMetrics‚Äù‰∏ÄÈ°µÔºåÂΩìÁîü‰∫ßÁéØÂ¢É‰∏≠Âá∫Áé∞‰∏•ÈáçÈîôËØØÊàñÂá∫ÈîôÊó∂ÔºåÂÆÉ‰ºº‰πéÊõ¥ÊúâÁî®„ÄÇËøôÂåÖÊã¨ÊØè‰∏Ä‰∏™ÊåáÊ†áÁöÑ‰ªãÁªçÔºåÂÆÉ‰ª¨ÊòØÂ¶Ç‰ΩïËÆ°ÁÆóÁöÑÔºå‰ª•Âèä‰ΩïÊó∂Ëß¶ÂèëÂÆÉ‰ª¨ËøõË°åËÆ°ÁÆó„ÄÇ</p>
</li>
</ol>
<h2 id="ÊñáÁ´†ÁªìÊûÑ" tabindex="-1">ÊñáÁ´†ÁªìÊûÑ <a class="header-anchor" href="#ÊñáÁ´†ÁªìÊûÑ" aria-label="Permalink to &quot;ÊñáÁ´†ÁªìÊûÑ&quot;"></a></h2>
<ol>
<li>
<p>ÂØπ‰∫éDMÂ∑•ÂÖ∑Ôºå‰Ωú‰∏∫‰∏Ä‰∏™ÊîØÊåÅËÄÖÁöÑËßíËâ≤ÔºåÈ¶ñÂÖàÊàëÈùûÂ∏∏ËµûÂêåÂΩì‰Ω†ËØïÂõæ‰øÆÂ§çÊàñË∞ÉÊü•‰∏Ä‰∫õÈóÆÈ¢òÊó∂Ôºå‰Ω†Â∫îËØ•Â≠¶‰π†Â∑•ÂÖ∑ÁöÑÊû∂ÊûÑ„ÄÇËøô‰∏ÄÂàáÈÉΩÊòØÂõ†‰∏∫‰∫ßÂìÅÁéØÂ¢ÉÂØπÂÆ¢Êà∑ÁöÑÂ∫îÁî®ÈùûÂ∏∏ÈáçË¶Å„ÄÇÂÖ≥‰∫éÂ∑•ÂÖ∑Â¶Ç‰ΩïËøêË°åÁöÑ‰∏ªË¶ÅÊÄùÊÉ≥ÊàñÁü•ËØÜÂú®ÊïÖÈöúÊéíÈô§‰∏≠ÊòØÈùûÂ∏∏ÈáçË¶ÅÁöÑ„ÄÇËøôÊ†∑Ôºå‰Ω†Â∞±ÂèØ‰ª•Â∞ΩÂø´‰øÆÂ§çÂÆÉÔºåÊØîÊ≠£Â∏∏ÊÉÖÂÜµ‰∏ãÊõ¥Â§ßÊõ¥Âø´„ÄÇ</p>
</li>
<li>
<p>ËÄå‰∏îÔºåÊàëËøòÂ∞ùËØïÂ∞ÜDMÂ¶Ç‰ΩïËøêË°åÁöÑ‰∏Ä‰∫õ‰∏ªË¶ÅÊ≠•È™§ÂàÜÊï£Âà∞‰∏ÄÂº†ÂõæÁâá‰∏≠ÔºåËøôÂú®Â≠¶‰π†Êó•Â∏∏ÁîüÊ¥ªÊó∂ÂæàÊúâÁî®ÔºåÊàñËÄÖÂú®ËøõË°åÊïÖÈöúÊéíÈô§Êó∂Áõ¥Êé•Âú®Ê∫ê‰ª£Á†ÅÁõÆÂΩï‰∏≠ÊêúÁ¥¢ÂáΩÊï∞Âêç„ÄÇÂú®Áõ∏ÂÖ≥ÁöÑÈ°µÈù¢‰∏≠ÔºåÊàëÂ∞ÜËß£ÈáäÊàëÂú®ÂõæÁâá‰∏≠ÈõïÂàªÁöÑÊØè‰∏™ÁªÑ‰ª∂ÁöÑÊõ¥Â§öÁªÜËäÇ <a href="./03TiDB-DM Master.html"><code>DM master</code></a>, <a href="./04TiDB-DM Worker.html"><code>DM Worker</code></a> and <a href="./05TiDB-DM syncer.html"><code>DM Syncer</code></a>„ÄÇ</p>
<figure><img src="./../../../../../images/tidb/05TiDB-EcosystematicTools/5-4DM/01-ALL_DM_Components.jpeg" alt="ALL_DM_Components" tabindex="0"><figcaption>ALL_DM_Components</figcaption></figure>
</li>
<li>
<p>Âú®Ëøô‰∏ÄÁ≥ªÂàóDMÈ°µÈù¢ÁöÑÊú´Â∞æÔºåÊàëÂÜô‰∫ÜÊåáÊ†áÁöÑÂê´‰πâ‰ª•ÂèäÂÆÉ‰ª¨ËÆ°ÁÆóÊØè‰∏™ÊåáÊ†áÁöÑÊñπÊ≥ï„ÄÇËøôÂØπ‰Ω†ÁöÑË∞ÉÊü•ÂæàÊúâÂ∏ÆÂä©„ÄÇ</p>
</li>
</ol>
<h2 id="keys-inside-etcd" tabindex="-1">Keys inside Etcd <a class="header-anchor" href="#keys-inside-etcd" aria-label="Permalink to &quot;Keys inside Etcd&quot;"></a></h2>
<p><a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/common/common.go#L26" target="_blank" rel="noreferrer">‰ª£Á†Å‰ΩçÁΩÆ</a>ÔºåÊàëËÆ§‰∏∫ÂΩì‰Ω†ÊÉ≥Ê∑±ÂÖ•Ëé∑Âèñ‰ø°ÊÅØÊó∂ÔºåÂÆÉ‰ºöÂæàÊúâÁî®Ôºå‰Ω†‰∏çËÉΩËΩªÊòìÂú∞‰ΩøÁî®OpenAPIÊàñdm-ctl„ÄÇÂ∞±ÂÉè <code>ClusterIDKey = &quot;/dm-cluster/id&quot;</code> and <code>StageSubTaskKeyAdapter KeyAdapter = keyHexEncoderDecoder(&quot;/dm-master/stage/subtask/&quot;)</code> ...</p>
]]></content:encoded>
            <enclosure url="https://download.pingcap.com/images/docs-cn/dm/dm-architecture-2.0.png" length="0" type="image/png"/>
        </item>
        <item>
            <title><![CDATA[TiDB-DM Âø´ÈÄü‰ΩøÁî®]]></title>
            <link>https://askaric.com/zh/work/tidb/TiDB-EcosystematicTools/5-4DM/02TiDB-DM Âø´ÈÄü‰ΩøÁî®.html</link>
            <guid>https://askaric.com/zh/work/tidb/TiDB-EcosystematicTools/5-4DM/02TiDB-DM Âø´ÈÄü‰ΩøÁî®.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[# TiDB-DM Âø´ÈÄü‰ΩøÁî®

ËøôÊòØÂÖ≥‰∫é DM ÈÉ®ÁΩ≤ÁöÑÂø´ÈÄüÂÖ•Èó®ÔºåÂ¶ÇÊûú‰Ω†Êõ¥ÁÜüÊÇâ dockerÔºå‰Ω†‰πüÂèØ‰ª•Âú® docker ‰∏äÂÅö„ÄÇÊàëÂ∑≤Áªè‰∏∫Ê≠§ÂáÜÂ§á‰∫ÜÂè¶‰∏Ä‰∏™ÂÜÖÂÆπÔºå[ËØ¶ÊÉÖÂèÇËÄÉËøôÁØáÊñáÁ´†](../../08TiDB-Cloud-K8S/8-1TiDB-%E5%BA%94%E7%94%A8%E5%AE%9E%E8%B7%B5/02TiDB-Operator%20%E9%83%A8%E7%BD%B2%20DM.md)

## ÂÆâË£ÖMySQL5.7

```shell
# ‰∏ãËΩΩ
wget https://dev.mysql.com/get/mysql57-community-release-el7-11.noarch.rpm


#ÂÆâË£ÖmysqlÊ∫ê
 yum localinstall mysql57-community-release-el7-11.noarch.rpm


# Ê£ÄÊü•ÊòØÂê¶ÊàêÂäü
yum repolist enabled | grep "mysql.*-community.*"
yum install mysql-server
systemctl start mysqld
systemctl status mysqld
systemctl enable mysqld

# ÈáçËΩΩÊâÄÊúâ‰øÆÊîπËøáÁöÑÈÖçÁΩÆÊñá‰ª∂
systemctl daemon-reload
grep 'temporary password' /var/log/mysqld.log
mysql -uroot -p

# ‰øÆÊîπÂØÜÁ†ÅÔºå‰∏ÄÂºÄÂßãËæìÂÖ•ÂØÜÁ†ÅÂ∞ΩÈáèÂ§çÊùÇÁÇπÔºåÂ≠óÁ¨¶„ÄÅÂ§ßÂ∞èÂÜôÂ≠óÊØç„ÄÅÊï∞Â≠óÈÉΩË¶ÅÊúâ

ALTER USER 'root'@'localhost' IDENTIFIED BY 'MyNewPass4!'

# Áé∞Âú®ÂèØ‰ª•ÂõûÂà∞Á¨¨3Ê≠•ÔºåËÆæÁΩÆ‰∏Ä‰∏™ÁÆÄÂçïÁöÑÂØÜÁ†Å‰∫Ü„ÄÇ
SHOW VARIABLES LIKE 'validate_password%';
set global validate_password_policy=LOW; 
set global validate_password_length=6; 

# Ëøô‰∏™ÂØÜÁ†ÅÂèØ‰ª•ÂíåÂÆ¢Êà∑Á´ØÂØÜÁ†Å‰∏ç‰∏ÄËá¥Ôºå‰ΩÜÊúÄÂ•Ω‰∏ÄËá¥„ÄÇ
ALTER USER 'root'@'localhost' IDENTIFIED BY '123123';
grant all privileges on *.* to root@'%' identified by '123123' with grant option;


firewall-cmd --state
firewall-cmd --zone=public --add-port=3306/tcp --permanent
## zone -- ‰ΩúÁî®Âüü
## add-port=80/tcp -- Ê∑ªÂä†Á´ØÂè£ÔºåÊ†ºÂºè‰∏∫ÔºöÁ´ØÂè£/ÈÄöËÆØÂçèËÆÆ
## permanent -- Ê∞∏‰πÖÁîüÊïàÔºåÊ≤°ÊúâÊ≠§ÂèÇÊï∞ÈáçÂêØÂêéÂ§±Êïà
## ÂºÄÂêØ3306Á´ØÂè£ÂêéÔºåworkbenchÊàñnaivcat Â∞±ËÉΩËøûÊé•Âà∞MySQLÊï∞ÊçÆÂ∫ì‰∫Ü
firewall-cmd --reload
```

## ÈÉ®ÁΩ≤DM

```shell
[tidb@tiup-tidb41 dumpling_dir]$ tiup install dm

[tidb@tiup-tidb41 dumpling_dir]$ tiup list --installed
Available components:
Name      Owner    Description
]]></description>
            <content:encoded><![CDATA[<h1 id="tidb-dm-Âø´ÈÄü‰ΩøÁî®" tabindex="-1">TiDB-DM Âø´ÈÄü‰ΩøÁî® <a class="header-anchor" href="#tidb-dm-Âø´ÈÄü‰ΩøÁî®" aria-label="Permalink to &quot;TiDB-DM Âø´ÈÄü‰ΩøÁî®&quot;"></a></h1>
<p>ËøôÊòØÂÖ≥‰∫é DM ÈÉ®ÁΩ≤ÁöÑÂø´ÈÄüÂÖ•Èó®ÔºåÂ¶ÇÊûú‰Ω†Êõ¥ÁÜüÊÇâ dockerÔºå‰Ω†‰πüÂèØ‰ª•Âú® docker ‰∏äÂÅö„ÄÇÊàëÂ∑≤Áªè‰∏∫Ê≠§ÂáÜÂ§á‰∫ÜÂè¶‰∏Ä‰∏™ÂÜÖÂÆπÔºå<a href="./../../08TiDB-Cloud-K8S/8-1TiDB-Â∫îÁî®ÂÆûË∑µ/02TiDB-Operator ÈÉ®ÁΩ≤ DM.html">ËØ¶ÊÉÖÂèÇËÄÉËøôÁØáÊñáÁ´†</a></p>
<h2 id="ÂÆâË£Ömysql5-7" tabindex="-1">ÂÆâË£ÖMySQL5.7 <a class="header-anchor" href="#ÂÆâË£Ömysql5-7" aria-label="Permalink to &quot;ÂÆâË£ÖMySQL5.7&quot;"></a></h2>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># ‰∏ãËΩΩ</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">wget</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> https://dev.mysql.com/get/mysql57-community-release-el7-11.noarch.rpm</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">#ÂÆâË£ÖmysqlÊ∫ê</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> localinstall</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysql57-community-release-el7-11.noarch.rpm</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Ê£ÄÊü•ÊòØÂê¶ÊàêÂäü</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> repolist</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> enabled</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "mysql.*-community.*"</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysql-server</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysqld</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> status</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysqld</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> enable</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysqld</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># ÈáçËΩΩÊâÄÊúâ‰øÆÊîπËøáÁöÑÈÖçÁΩÆÊñá‰ª∂</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> daemon-reload</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'temporary password'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /var/log/mysqld.log</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">mysql</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -uroot</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -p</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># ‰øÆÊîπÂØÜÁ†ÅÔºå‰∏ÄÂºÄÂßãËæìÂÖ•ÂØÜÁ†ÅÂ∞ΩÈáèÂ§çÊùÇÁÇπÔºåÂ≠óÁ¨¶„ÄÅÂ§ßÂ∞èÂÜôÂ≠óÊØç„ÄÅÊï∞Â≠óÈÉΩË¶ÅÊúâ</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ALTER</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> USER</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'root'@'localhost'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> IDENTIFIED</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> BY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'MyNewPass4!'</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Áé∞Âú®ÂèØ‰ª•ÂõûÂà∞Á¨¨3Ê≠•ÔºåËÆæÁΩÆ‰∏Ä‰∏™ÁÆÄÂçïÁöÑÂØÜÁ†Å‰∫Ü„ÄÇ</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SHOW</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> VARIABLES</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> LIKE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'validate_password%'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> global</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> validate_password_policy=LOW</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">; </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> global</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> validate_password_length=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">; </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Ëøô‰∏™ÂØÜÁ†ÅÂèØ‰ª•ÂíåÂÆ¢Êà∑Á´ØÂØÜÁ†Å‰∏ç‰∏ÄËá¥Ôºå‰ΩÜÊúÄÂ•Ω‰∏ÄËá¥„ÄÇ</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ALTER</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> USER</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'root'@'localhost'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> IDENTIFIED</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> BY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> '123123'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">grant</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> all</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> privileges</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> on</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> *</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">*</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> root@'%'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> identified</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> by</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> '123123'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> with</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> grant</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> option</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">firewall-cmd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --state</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">firewall-cmd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --zone=public</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --add-port=3306/tcp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --permanent</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">## zone -- ‰ΩúÁî®Âüü</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">## add-port=80/tcp -- Ê∑ªÂä†Á´ØÂè£ÔºåÊ†ºÂºè‰∏∫ÔºöÁ´ØÂè£/ÈÄöËÆØÂçèËÆÆ</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">## permanent -- Ê∞∏‰πÖÁîüÊïàÔºåÊ≤°ÊúâÊ≠§ÂèÇÊï∞ÈáçÂêØÂêéÂ§±Êïà</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">## ÂºÄÂêØ3306Á´ØÂè£ÂêéÔºåworkbenchÊàñnaivcat Â∞±ËÉΩËøûÊé•Âà∞MySQLÊï∞ÊçÆÂ∫ì‰∫Ü</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">firewall-cmd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --reload</span></span></code></pre>
</div><h2 id="ÈÉ®ÁΩ≤dm" tabindex="-1">ÈÉ®ÁΩ≤DM <a class="header-anchor" href="#ÈÉ®ÁΩ≤dm" aria-label="Permalink to &quot;ÈÉ®ÁΩ≤DM&quot;"></a></h2>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 dumpling_dir]$ tiup install dm</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 dumpling_dir]$ tiup list --installed</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Available</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> components:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      Owner</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    Description</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">      -----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    -----------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">dm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">        pingcap</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Data</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Migration</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Platform</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> manager</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">dm-master</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  pingcap</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  dm-master</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> component</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Data</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Migration</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Platform</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">dm-worker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  pingcap</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  dm-worker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> component</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Data</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Migration</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Platform</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ mkdir dm</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ cd dm/</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 dm]$ ll</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">total</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 dm]$ vi topology.yaml </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 dm]$ tiup dm deploy dm-test v2.0.1 /home/tidb/dm/topology.yaml --user root -p</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> component</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">dm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /home/tidb/.tiup/components/dm/v1.3.1/tiup-dm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> deploy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm-test</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> v2.0.1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /home/tidb/dm/topology.yaml</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --user</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> root</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -p</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Please</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> confirm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> your</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> topology:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> type:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    dm</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> name:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    dm-test</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> version:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> v2.0.1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Type</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       Host</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">            Ports</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      OS/Arch</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       Directories</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">       ----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">            -----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">      -------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">       -----------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">dm-master</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  192.168.169.41</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  8261/8291</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  /data/tidb-deploy/dm/dm-master-8261,/data/tidb-data/dm/dm-master-8261</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">dm-master</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  192.168.169.42</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  8261/8291</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  /data/tidb-deploy/dm/dm-master-8261,/data/tidb-data/dm/dm-master-8261</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">dm-master</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  192.168.169.43</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  8261/8291</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  /data/tidb-deploy/dm/dm-master-8261,/data/tidb-data/dm/dm-master-8261</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">dm-worker</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  192.168.169.41</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  8262</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  /data/tidb-deploy/dm/dm-worker-8262,/data/tidb-data/dm/dm-worker-8262</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">dm-worker</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  192.168.169.42</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  8262</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  /data/tidb-deploy/dm/dm-worker-8262,/data/tidb-data/dm/dm-worker-8262</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">dm-worker</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  192.168.169.43</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  8262</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  /data/tidb-deploy/dm/dm-worker-8262,/data/tidb-data/dm/dm-worker-8262</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Attention:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    1.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> If</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> topology</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> not</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> what</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> you</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> expected,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> check</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> your</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> yaml</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> file.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    2.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Please</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> confirm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> there</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> no</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> port/directory</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> conflicts</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> same</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> host.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Do</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> you</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> want</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> continue?</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [y/N]:  y</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Input</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> SSH</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> password:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Generate</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> SSH</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> keys</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ...</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Done</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Download</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> TiDB</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> components</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Download</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm-master:v2.0.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (linux/amd64) ... Done</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Download</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm-worker:v2.0.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (linux/amd64) ... Done</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Initialize</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> target</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> host</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> environments</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Prepare</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 192.168.169.41:22</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ...</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Done</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Prepare</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 192.168.169.42:22</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ...</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Done</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Prepare</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 192.168.169.43:22</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ...</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Done</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Copy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> files</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Copy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm-master</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 192.168.169.41</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ...</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Done</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Copy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm-master</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 192.168.169.42</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ...</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Done</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Copy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm-master</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 192.168.169.43</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ...</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Done</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Copy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm-worker</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 192.168.169.41</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ...</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Done</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Copy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm-worker</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 192.168.169.42</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ...</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Done</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Copy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm-worker</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 192.168.169.43</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ...</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Done</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">dm-test</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> deployed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> successfully,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> you</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> can</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> it</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> with</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> command:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tiup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm start dm-test`</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 dm]</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tiup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> list</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> component</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">dm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /home/tidb/.tiup/components/dm/v1.3.1/tiup-dm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> list</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     User</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Version</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Path</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                          PrivateKey</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">     ----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  -------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  ----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">                                          ----------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">dm-test</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  tidb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  v2.0.1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   /home/tidb/.tiup/storage/dm/clusters/dm-test</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  /home/tidb/.tiup/storage/dm/clusters/dm-test/ssh/id_rsa</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 dm]$ tiup dm display dm-test</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> component</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">dm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /home/tidb/.tiup/components/dm/v1.3.1/tiup-dm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> display</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm-test</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> type:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       dm</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> name:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       dm-test</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> version:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    v2.0.1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SSH</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> type:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">           builtin</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ID</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                   Role</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       Host</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">            Ports</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      OS/Arch</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       Status</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Data</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Dir</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                           Deploy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Dir</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">--</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">                   ----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">       ----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">            -----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">      -------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">       ------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  --------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">                           ----------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">192.168.169.41:8261</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  dm-master</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  192.168.169.41</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  8261/8291</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Down</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    /data/tidb-data/dm/dm-master-8261</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  /data/tidb-deploy/dm/dm-master-8261</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">192.168.169.42:8261</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  dm-master</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  192.168.169.42</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  8261/8291</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Down</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    /data/tidb-data/dm/dm-master-8261</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  /data/tidb-deploy/dm/dm-master-8261</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">192.168.169.43:8261</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  dm-master</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  192.168.169.43</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  8261/8291</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Down</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    /data/tidb-data/dm/dm-master-8261</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  /data/tidb-deploy/dm/dm-master-8261</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">192.168.169.41:8262</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  dm-worker</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  192.168.169.41</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  8262</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  N/A</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     /data/tidb-data/dm/dm-worker-8262</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  /data/tidb-deploy/dm/dm-worker-8262</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">192.168.169.42:8262</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  dm-worker</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  192.168.169.42</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  8262</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  N/A</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     /data/tidb-data/dm/dm-worker-8262</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  /data/tidb-deploy/dm/dm-worker-8262</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">192.168.169.43:8262</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  dm-worker</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  192.168.169.43</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  8262</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  N/A</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     /data/tidb-data/dm/dm-worker-8262</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  /data/tidb-deploy/dm/dm-worker-8262</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Total</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> nodes:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 6</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 dm]$ tiup dm start dm-test</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> component</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">dm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /home/tidb/.tiup/components/dm/v1.3.1/tiup-dm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm-test</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm-test...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [ </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">Serial</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ]</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> SSHKeySet:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> privateKey=/home/tidb/.tiup/storage/dm/clusters/dm-test/ssh/id_rsa,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> publicKey=/home/tidb/.tiup/storage/dm/clusters/dm-test/ssh/id_rsa.pub</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [Parallel] - UserSSH: user</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">tidb,</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> host</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">192.168.169.43</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [Parallel] - UserSSH: user</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">tidb,</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> host</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">192.168.169.41</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [Parallel] - UserSSH: user</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">tidb,</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> host</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">192.168.169.42</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [Parallel] - UserSSH: user</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">tidb,</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> host</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">192.168.169.41</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [Parallel] - UserSSH: user</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">tidb,</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> host</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">192.168.169.43</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [Parallel] - UserSSH: user</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">tidb,</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> host</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">192.168.169.42</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [ </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">Serial</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ]</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> StartCluster</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> component</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm-master</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> instance</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm-master</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 192.168.169.41:8261</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> instance</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm-master</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 192.168.169.43:8261</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> instance</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm-master</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 192.168.169.42:8261</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm-master</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 192.168.169.42:8261</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> success</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm-master</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 192.168.169.43:8261</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> success</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm-master</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 192.168.169.41:8261</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> success</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> component</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm-worker</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> instance</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm-worker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 192.168.169.43:8262</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> instance</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm-worker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 192.168.169.41:8262</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> instance</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm-worker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 192.168.169.42:8262</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm-worker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 192.168.169.42:8262</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> success</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm-worker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 192.168.169.41:8262</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> success</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm-worker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 192.168.169.43:8262</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> success</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Started</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">dm-test</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> successfully</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 dm]$ tiup dm display dm-test</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> component</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">dm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /home/tidb/.tiup/components/dm/v1.3.1/tiup-dm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> display</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> dm-test</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> type:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       dm</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> name:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       dm-test</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> version:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    v2.0.1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SSH</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> type:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">           builtin</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ID</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                   Role</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       Host</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">            Ports</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      OS/Arch</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       Status</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     Data</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Dir</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                           Deploy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Dir</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">--</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">                   ----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">       ----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">            -----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">      -------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">       ------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">     --------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">                           ----------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">192.168.169.41:8261</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  dm-master</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  192.168.169.41</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  8261/8291</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Healthy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    /data/tidb-data/dm/dm-master-8261</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  /data/tidb-deploy/dm/dm-master-8261</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">192.168.169.42:8261</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  dm-master</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  192.168.169.42</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  8261/8291</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Healthy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">L</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  /data/tidb-data/dm/dm-master-8261</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  /data/tidb-deploy/dm/dm-master-8261</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">192.168.169.43:8261</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  dm-master</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  192.168.169.43</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  8261/8291</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Healthy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    /data/tidb-data/dm/dm-master-8261</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  /data/tidb-deploy/dm/dm-master-8261</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">192.168.169.41:8262</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  dm-worker</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  192.168.169.41</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  8262</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Free</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       /data/tidb-data/dm/dm-worker-8262</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  /data/tidb-deploy/dm/dm-worker-8262</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">192.168.169.42:8262</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  dm-worker</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  192.168.169.42</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  8262</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Free</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       /data/tidb-data/dm/dm-worker-8262</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  /data/tidb-deploy/dm/dm-worker-8262</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">192.168.169.43:8262</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  dm-worker</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  192.168.169.43</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  8262</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Free</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       /data/tidb-data/dm/dm-worker-8262</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  /data/tidb-deploy/dm/dm-worker-8262</span></span></code></pre>
</div><h2 id="‰∏äÊ∏∏Êï∞ÊçÆÂáÜÂ§á" tabindex="-1">‰∏äÊ∏∏Êï∞ÊçÆÂáÜÂ§á <a class="header-anchor" href="#‰∏äÊ∏∏Êï∞ÊçÆÂáÜÂ§á" aria-label="Permalink to &quot;‰∏äÊ∏∏Êï∞ÊçÆÂáÜÂ§á&quot;"></a></h2>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> database</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> user</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> database</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> database</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> table</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> information</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">int</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> primary key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> table</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">int</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> primary key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">use</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> table</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> messages</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">int</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> primary key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">));</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"># </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">192</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">168</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">169</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">44</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> store;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> table</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store_bj</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">int</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> primary key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> table</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store_tj</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">int</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> primary key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">insert into</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> store</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">store_bj</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> values</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'store_bj_01'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">),(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'store_bj_02'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">insert into</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> store</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">store_tj</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> values</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'store_tj_01'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">),(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'store_tj_02'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"># </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">192</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">168</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">169</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">45</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> store;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> table</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store_sh</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">int</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> primary key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> table</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store_sz</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">int</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> primary key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">insert into</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> store</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">store_sh</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> values</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'store_sh_01'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">),(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'store_sh_02'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">insert into</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> store</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">store_sz</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> values</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'store_suzhou_01'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">),(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'store_suzhou_02'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"># </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">192</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">168</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">169</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">46</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> store;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> table</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store_gz</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">int</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> primary key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> table</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store_sz</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">int</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> primary key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">insert into</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> store</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">store_gz</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> values</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'store_gz_01'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">),(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'store_gz_02'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">insert into</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> store</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">store_sz</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> values</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'store_shenzhen_01'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">),(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'store_shenzhen_02'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">);</span></span></code></pre>
</div><h2 id="‰∏ãÊ∏∏schemaÂáÜÂ§á" tabindex="-1">‰∏ãÊ∏∏schemaÂáÜÂ§á <a class="header-anchor" href="#‰∏ãÊ∏∏schemaÂáÜÂ§á" aria-label="Permalink to &quot;‰∏ãÊ∏∏schemaÂáÜÂ§á&quot;"></a></h2>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> database</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> user_north</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> database</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> user_east</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> database</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> user_south</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_north;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> table</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> information</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">int</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> primary key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> table</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">int</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> primary key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_east;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> table</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> information</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">int</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> primary key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> table</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">int</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> primary key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> user_south;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> table</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> information</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">int</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> primary key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> table</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">int</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> primary key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">));</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> database</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> store;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> table</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store_bj</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">int</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> primary key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">));</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> table</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store_tj</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">int</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> primary key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">));</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> table</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store_sh</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">int</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> primary key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">));</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> table</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store_gz</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">int</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> primary key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">));</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> table</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store_suzhou</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   (id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">int</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> primary key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">));</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> table</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store_shenzhen</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">int</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> primary key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">));</span></span></code></pre>
</div><h2 id="ÂàõÂª∫sourceÂØπÂ∫îÁöÑworker" tabindex="-1">ÂàõÂª∫sourceÂØπÂ∫îÁöÑworker <a class="header-anchor" href="#ÂàõÂª∫sourceÂØπÂ∫îÁöÑworker" aria-label="Permalink to &quot;ÂàõÂª∫sourceÂØπÂ∫îÁöÑworker&quot;"></a></h2>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 conf]$ tiup dmctl --master-addr</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">192.168.169.41:8261</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> operate-source</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> create</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> source1.yaml</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> component</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">dmctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /home/tidb/.tiup/components/dmctl/v2.0.1/dmctl/dmctl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --master-addr=192.168.169.41:8261</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> operate-source</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> create</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> source1.yaml</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    "msg"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    "sources"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "msg"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "source"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "mysql-replica-01",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "worker"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "dm-192.168.169.41-8262"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 conf]$ tiup dmctl --master-addr</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">192.168.169.41:8261</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> operate-source</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> create</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> source2.yaml</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> component</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">dmctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /home/tidb/.tiup/components/dmctl/v2.0.1/dmctl/dmctl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --master-addr=192.168.169.41:8261</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> operate-source</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> create</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> source2.yaml</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    "msg"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    "sources"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "msg"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "source"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "mysql-replica-02",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "worker"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "dm-192.168.169.42-8262"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 conf]$ tiup dmctl --master-addr</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">192.168.169.41:8261</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> operate-source</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> create</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> source3.yaml</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> component</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">dmctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /home/tidb/.tiup/components/dmctl/v2.0.1/dmctl/dmctl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --master-addr=192.168.169.41:8261</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> operate-source</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> create</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> source3.yaml</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    "msg"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    "sources"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "msg"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "source"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "mysql-replica-03",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "worker"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "dm-192.168.169.43-8262"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
</div><h2 id="dmctlÂ∑•ÂÖ∑È™åËØÅmember" tabindex="-1">dmctlÂ∑•ÂÖ∑È™åËØÅmember <a class="header-anchor" href="#dmctlÂ∑•ÂÖ∑È™åËØÅmember" aria-label="Permalink to &quot;dmctlÂ∑•ÂÖ∑È™åËØÅmember&quot;"></a></h2>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 conf]$ tiup dmctl --master-addr</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">192.168.169.41:8261</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> list-member</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> component</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">dmctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /home/tidb/.tiup/components/dmctl/v2.0.1/dmctl/dmctl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --master-addr=192.168.169.41:8261</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> list-member</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    "msg"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    "members"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "leader"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "msg"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "name"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "dm-192.168.169.41-8261",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "addr"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "192.168.169.41:8261"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">            }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "master"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "msg"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "masters"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                    {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "name"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "dm-192.168.169.41-8261",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "memberID"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "11955134185808625835",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "alive"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "peerURLs"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                            "http://192.168.169.41:8291"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                        ],</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "clientURLs"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                            "http://192.168.169.41:8261"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                        ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                    },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                    {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "name"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "dm-192.168.169.42-8261",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "memberID"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "16647128463965627029",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "alive"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "peerURLs"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                            "http://192.168.169.42:8291"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                        ],</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "clientURLs"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                            "http://192.168.169.42:8261"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                        ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                    },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                    {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "name"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "dm-192.168.169.43-8261",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "memberID"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "7578209210746128387",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "alive"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "peerURLs"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                            "http://192.168.169.43:8291"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                        ],</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "clientURLs"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                            "http://192.168.169.43:8261"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                        ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">            }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "worker"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "msg"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "workers"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                    {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "name"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "dm-192.168.169.41-8262",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "addr"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "192.168.169.41:8262",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "stage"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "bound",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "source"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "mysql-replica-01"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                    },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                    {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "name"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "dm-192.168.169.42-8262",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "addr"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "192.168.169.42:8262",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "stage"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "bound",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "source"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "mysql-replica-02"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                    },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                    {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "name"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "dm-192.168.169.43-8262",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "addr"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "192.168.169.43:8262",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "stage"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "bound",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "source"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "mysql-replica-03"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">            }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
</div><h2 id="dmctlÂêØÂä®Âπ∂È™åËØÅtask" tabindex="-1">dmctlÂêØÂä®Âπ∂È™åËØÅtask <a class="header-anchor" href="#dmctlÂêØÂä®Âπ∂È™åËØÅtask" aria-label="Permalink to &quot;dmctlÂêØÂä®Âπ∂È™åËØÅtask&quot;"></a></h2>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 dm]$ tiup dmctl -master-addr 192.168.169.42:8261 start-task task.yml</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># dmctlÊü•Áúã‰ªªÂä°Áä∂ÊÄÅ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 dm]$ tiup dmctl --master-addr 192.168.169.42:8261 query-status one-tidb-slave</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> component</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">dmctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /home/tidb/.tiup/components/dmctl/v2.0.1/dmctl/dmctl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --master-addr</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 192.168.169.42:8261</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> query-status</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> one-tidb-slave</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    "msg"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    "sources"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "msg"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "sourceStatus"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "source"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "mysql-replica-01",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "worker"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "dm-192.168.169.41-8262",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> null,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "relayStatus"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> null</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">            },</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "subTaskStatus"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "name"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "one-tidb-slave",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "stage"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "Running",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "unit"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "Sync",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> null,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "unresolvedDDLLockID"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "sync"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "totalEvents"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "0",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "totalTps"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "0",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "recentTps"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "0",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "masterBinlog"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "(mysql-bin.000001, 6633)",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "masterBinlogGtid"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "581426c4-563a-11eb-8eea-000c2972c98a:1-35",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "syncerBinlog"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "(mysql-bin.000001, 6633)",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "syncerBinlogGtid"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "581426c4-563a-11eb-8eea-000c2972c98a:1-35",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "blockingDDLs"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                        ],</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "unresolvedGroups"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                        ],</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "synced"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "binlogType"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "remote"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">            ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "msg"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "sourceStatus"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "source"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "mysql-replica-02",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "worker"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "dm-192.168.169.42-8262",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> null,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "relayStatus"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> null</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">            },</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "subTaskStatus"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "name"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "one-tidb-slave",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "stage"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "Running",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "unit"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "Sync",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> null,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "unresolvedDDLLockID"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "sync"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "totalEvents"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "0",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "totalTps"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "0",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "recentTps"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "0",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "masterBinlog"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "(mysql-bin.000001, 7957)",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "masterBinlogGtid"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "8b923309-5644-11eb-a36c-000c29d3567e:1-41",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "syncerBinlog"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "(mysql-bin.000001, 7957)",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "syncerBinlogGtid"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "8b923309-5644-11eb-a36c-000c29d3567e:1-41",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "blockingDDLs"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                        ],</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "unresolvedGroups"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                        ],</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "synced"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "binlogType"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "remote"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">            ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "msg"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "sourceStatus"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "source"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "mysql-replica-03",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "worker"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "dm-192.168.169.43-8262",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> null,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "relayStatus"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> null</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">            },</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "subTaskStatus"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "name"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "one-tidb-slave",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "stage"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "Running",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "unit"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "Sync",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> null,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "unresolvedDDLLockID"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "sync"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "totalEvents"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "0",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "totalTps"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "0",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "recentTps"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "0",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "masterBinlog"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "(mysql-bin.000001, 9273)",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "masterBinlogGtid"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "9d33b95a-5644-11eb-a720-000c290d4084:1-47",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "syncerBinlog"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "(mysql-bin.000001, 9273)",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "syncerBinlogGtid"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "9d33b95a-5644-11eb-a720-000c290d4084:1-47",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "blockingDDLs"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                        ],</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "unresolvedGroups"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                        ],</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "synced"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "binlogType"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "remote"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">            ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
</div><h2 id="dmctlÊÅ¢Â§çtask" tabindex="-1">dmctlÊÅ¢Â§çtask <a class="header-anchor" href="#dmctlÊÅ¢Â§çtask" aria-label="Permalink to &quot;dmctlÊÅ¢Â§çtask&quot;"></a></h2>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 dm]$ tiup dmctl --master-addr 192.168.169.42:8261 resume-task one-tidb-slave</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> component</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">dmctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /home/tidb/.tiup/components/dmctl/v2.0.1/dmctl/dmctl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --master-addr</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 192.168.169.42:8261</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> resume-task</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> one-tidb-slave</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    "op"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "Resume",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    "msg"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    "sources"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "msg"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "source"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "mysql-replica-01",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "worker"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "dm-192.168.169.41-8262"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "msg"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "source"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "mysql-replica-02",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "worker"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "dm-192.168.169.42-8262"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "msg"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "source"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "mysql-replica-03",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "worker"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "dm-192.168.169.43-8262"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 dm]$ tiup dmctl --master-addr 192.168.169.42:8261 query-status one-tidb-slave</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> component</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">dmctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /home/tidb/.tiup/components/dmctl/v2.0.1/dmctl/dmctl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --master-addr</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 192.168.169.42:8261</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> query-status</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> one-tidb-slave</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    "msg"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    "sources"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "msg"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "sourceStatus"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "source"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "mysql-replica-01",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "worker"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "dm-192.168.169.41-8262",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> null,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "relayStatus"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> null</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">            },</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "subTaskStatus"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "name"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "one-tidb-slave",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "stage"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "Running",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "unit"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "Sync",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> null,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "unresolvedDDLLockID"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "sync"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "totalEvents"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "0",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "totalTps"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "0",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "recentTps"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "0",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "masterBinlog"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "(mysql-bin.000001, 6633)",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "masterBinlogGtid"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "581426c4-563a-11eb-8eea-000c2972c98a:1-35",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "syncerBinlog"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "(mysql-bin.000001, 6633)",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "syncerBinlogGtid"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "581426c4-563a-11eb-8eea-000c2972c98a:1-35",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "blockingDDLs"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                        ],</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "unresolvedGroups"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                        ],</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "synced"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "binlogType"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "remote"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">            ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "msg"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "sourceStatus"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "source"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "mysql-replica-02",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "worker"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "dm-192.168.169.42-8262",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> null,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "relayStatus"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> null</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">            },</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "subTaskStatus"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "name"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "one-tidb-slave",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "stage"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "Running",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "unit"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "Sync",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> null,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "unresolvedDDLLockID"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "sync"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "totalEvents"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "0",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "totalTps"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "0",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "recentTps"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "0",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "masterBinlog"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "(mysql-bin.000001, 7957)",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "masterBinlogGtid"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "8b923309-5644-11eb-a36c-000c29d3567e:1-41",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "syncerBinlog"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "(mysql-bin.000001, 7957)",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "syncerBinlogGtid"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "8b923309-5644-11eb-a36c-000c29d3567e:1-41",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "blockingDDLs"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                        ],</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "unresolvedGroups"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                        ],</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "synced"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "binlogType"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "remote"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">            ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "msg"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "sourceStatus"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "source"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "mysql-replica-03",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "worker"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "dm-192.168.169.43-8262",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> null,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                "relayStatus"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> null</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">            },</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">            "subTaskStatus"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "name"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "one-tidb-slave",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "stage"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "Running",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "unit"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "Sync",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "result"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> null,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "unresolvedDDLLockID"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                    "sync"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "totalEvents"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "0",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "totalTps"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "0",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "recentTps"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "0",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "masterBinlog"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "(mysql-bin.000001, 9273)",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "masterBinlogGtid"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "9d33b95a-5644-11eb-a720-000c290d4084:1-47",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "syncerBinlog"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "(mysql-bin.000001, 9273)",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "syncerBinlogGtid"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "9d33b95a-5644-11eb-a720-000c290d4084:1-47",</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "blockingDDLs"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                        ],</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "unresolvedGroups"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                        ],</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "synced"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">                        "binlogType"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "remote"</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">            ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
</div><h2 id="tidbÈ™åËØÅÂêåÊ≠•" tabindex="-1">TiDBÈ™åËØÅÂêåÊ≠• <a class="header-anchor" href="#tidbÈ™åËØÅÂêåÊ≠•" aria-label="Permalink to &quot;TiDBÈ™åËØÅÂêåÊ≠•&quot;"></a></h2>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 dm]$ mysql -uroot -P4000 -h192.168.169.41</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Welcome</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> MariaDB</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> monitor.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Commands</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> end</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> with</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">or</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \g</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Your</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> MySQL</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> connection</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> id</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> is</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 429</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Server</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> version:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 5.7.25-TiDB-v4.0.9</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> TiDB</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Server</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (Apache </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">License</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 2.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) Community Edition, MySQL 5.7 compatible</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Copyright</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Type</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'help;'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> or</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> '\h'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> help.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Type</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> '\c'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> clear</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> current</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> input</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> statement.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">MySQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [(none)]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> show databases;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+--------------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Database</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">           |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+--------------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> INFORMATION_SCHEMA</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> METRICS_SCHEMA</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">     |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> PERFORMANCE_SCHEMA</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> dm_meta</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">            |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> dump_test</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">          |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> dumptest1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">          |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> dumptest2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">          |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> jan</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">                |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> mysql</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">              |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">              |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> user_east</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">          |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> user_north</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">         |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> user_south</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">         |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+--------------------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">13</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> rows</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">MySQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [(none)]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> use store</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Reading</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> table</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> information</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> completion</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> table</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> and</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> column</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> names</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">You</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> can</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> turn</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> off</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> this</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> feature</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> quicker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> startup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> with</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -A</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Database</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> changed</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">MySQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [store]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> show tales;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ERROR</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1064</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (42000): You have an error in your SQL syntax; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">check</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> manual</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> that</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> corresponds</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> your</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> TiDB</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> version</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> right</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> syntax</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> use</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> line</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> column</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 10</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> near</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "tales"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">MySQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [store]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> show tables;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+-----------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Tables_in_store</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+-----------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store_bj</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">        |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store_gz</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">        |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store_sh</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">        |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store_shenzhen</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store_suzhou</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store_tj</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">        |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+-----------------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">6</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> rows</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">MySQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [store]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> * from store_bj;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+------+-------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">        |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+------+-------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store_bj_01</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store_bj_02</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+------+-------------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> rows</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (0.01 </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">MySQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [store]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> * from store_gz;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+------+-------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">        |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+------+-------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store_gz_01</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store_gz_02</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+------+-------------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> rows</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (0.25 </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">MySQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [store]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> * from store_shenzhen;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+------+-------------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">              |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+------+-------------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store_shenzhen_01</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store_shenzhen_02</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+------+-------------------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> rows</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (0.01 </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">MySQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [store]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> * from store_suzhou;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+------+-----------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">            |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+------+-----------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store_suzhou_01</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store_suzhou_02</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+------+-----------------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> rows</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span></code></pre>
</div><h2 id="mysqlÂà∞tidbÂ¢ûÈáèÂêåÊ≠•È™åËØÅ" tabindex="-1">MySQLÂà∞TiDBÂ¢ûÈáèÂêåÊ≠•È™åËØÅ <a class="header-anchor" href="#mysqlÂà∞tidbÂ¢ûÈáèÂêåÊ≠•È™åËØÅ" aria-label="Permalink to &quot;MySQLÂà∞TiDBÂ¢ûÈáèÂêåÊ≠•È™åËØÅ&quot;"></a></h2>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># MySQL‰∏äÊ∏∏Ê≥≥Â¢ûÈáèÊèíÂÖ•</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">insert</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> into</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> store_bj</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> values</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (3,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'incremental_bj_03'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Query</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> OK,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> row</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> affected</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">select</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> *</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> store_bj</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+----+-------------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">              |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+----+-------------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store_bj_01</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">       |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store_bj_02</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">       |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  3</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> incremental_bj_03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+----+-------------------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">3</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> rows</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># ‰∏ãÊ∏∏È™åËØÅ</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">MySQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [store]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> * from store_bj;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+------+-------------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">              |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+------+-------------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store_bj_01</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">       |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> store_bj_02</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">       |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    3</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> incremental_bj_03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+------+-------------------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">3</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> rows</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (0.01 </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span></code></pre>
</div><h2 id="ÂèÇËÄÉÊñáÁ´†" tabindex="-1">ÂèÇËÄÉÊñáÁ´† <a class="header-anchor" href="#ÂèÇËÄÉÊñáÁ´†" aria-label="Permalink to &quot;ÂèÇËÄÉÊñáÁ´†&quot;"></a></h2>
<p><a href="https://www.bookstack.cn/read/tidb-data-migration-1.0-zh/zh-get-started.md" target="_blank" rel="noreferrer">TiDB Data Migration (DM) Áî®Êà∑ÊñáÊ°£ v1.0://www.bookstack.cn/read/tidb-data-migration-1.0-zh/zh-get-started.md</a></p>
<p><a href="https://docs.pingcap.com/zh/tidb-data-migration/stable/usage-scenario-simple-migration" target="_blank" rel="noreferrer">Data Migration ÁÆÄÂçï‰ΩøÁî®Âú∫ÊôØ:https://docs.pingcap.com/zh/tidb-data-migration/stable/usage-scenario-simple-migration</a></p>
<p><a href="https://docs.pingcap.com/zh/tidb-data-migration/stable/migrate-data-using-dm#%E7%AC%AC-4-%E6%AD%A5%E9%85%8D%E7%BD%AE%E4%BB%BB%E5%8A%A1" target="_blank" rel="noreferrer">‰ΩøÁî® DM ËøÅÁßªÊï∞ÊçÆ:https://docs.pingcap.com/zh/tidb-data-migration/stable/migrate-data-using-dm#%E7%AC%AC-4-%E6%AD%A5%E9%85%8D%E7%BD%AE%E4%BB%BB%E5%8A%A1</a></p>
<p><a href="https://docs.pingcap.com/zh/tidb-data-migration/stable/quick-start-with-dm" target="_blank" rel="noreferrer">TiDB Data Migration Âø´ÈÄü‰∏äÊâãÊåáÂçó:https://docs.pingcap.com/zh/tidb-data-migration/stable/quick-start-with-dm</a></p>
<p><a href="https://docs.pingcap.com/zh/tidb-data-migration/stable/quick-start-create-task" target="_blank" rel="noreferrer">ÂàõÂª∫Êï∞ÊçÆËøÅÁßª‰ªªÂä°:https://docs.pingcap.com/zh/tidb-data-migration/stable/quick-start-create-task</a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[TiDB DM Master]]></title>
            <link>https://askaric.com/zh/work/tidb/TiDB-EcosystematicTools/5-4DM/03TiDB-DM Master.html</link>
            <guid>https://askaric.com/zh/work/tidb/TiDB-EcosystematicTools/5-4DM/03TiDB-DM Master.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[What's DM Master
 Etcd
DM MasterÈ´òÂèØÁî®ÊÄßÂ¶Ç‰ΩïÂ∑•‰Ωú : Â§ßÂ§öÊï∞ÊÉÖÂÜµ‰∏ãÔºåËøôÊòØÁî±‰∫éectdÁöÑÂèØÁî®ÁâπÊÄßÔºåÂÆÉÂ∞ÜÊâÄÊúâÊåÅ‰πÖÂåñÊï∞ÊçÆÂ≠òÂÇ®Âú®DMÈõÜÁæ§‰∏≠„ÄÇÂêåÊó∂ÔºåÂà∞ the ElectionÔºå]]></description>
            <content:encoded><![CDATA[<h1 id="tidb-dm-master" tabindex="-1">TiDB DM Master <a class="header-anchor" href="#tidb-dm-master" aria-label="Permalink to &quot;TiDB DM Master&quot;"></a></h1>
<h2 id="what-s-dm-master" tabindex="-1">What's DM Master <a class="header-anchor" href="#what-s-dm-master" aria-label="Permalink to &quot;What's DM Master&quot;"></a></h2>
<figure><img src="./../../../../../images/tidb/05TiDB-EcosystematicTools/5-4DM/02-DM_Master_Components.jpeg" alt="DM_Master_Components" tabindex="0"><figcaption>DM_Master_Components</figcaption></figure>
<h2 id="etcd" tabindex="-1">Etcd <a class="header-anchor" href="#etcd" aria-label="Permalink to &quot;Etcd&quot;"></a></h2>
<p><strong>DM MasterÈ´òÂèØÁî®ÊÄßÂ¶Ç‰ΩïÂ∑•‰Ωú</strong> : Â§ßÂ§öÊï∞ÊÉÖÂÜµ‰∏ãÔºåËøôÊòØÁî±‰∫éectdÁöÑÂèØÁî®ÁâπÊÄßÔºåÂÆÉÂ∞ÜÊâÄÊúâÊåÅ‰πÖÂåñÊï∞ÊçÆÂ≠òÂÇ®Âú®DMÈõÜÁæ§‰∏≠„ÄÇÂêåÊó∂ÔºåÂà∞ <a href="#election">the Election</a>ÔºåÂè™Êúâ DM Master ÁöÑÈ¢ÜÂØºÊâçËÉΩÂêØÂä®ÁªÑ‰ª∂Âíå etcd Â∑•‰ΩúÔºåÂπ∂‰∏îÈ¢ÜÂØºËøòÂÆöÊúüÊ£ÄÊü•DMÊòØÂê¶Êúâ‰∏•ÈáçÁöÑÈóÆÈ¢òÔºåÂú®Ê≠£Á°ÆÁöÑÊó∂Èó¥Á´ãÂç≥ÊâßË°åÊÅ¢Â§çÊìç‰Ωú„ÄÇ</p>
<h2 id="openapihandles" tabindex="-1">OpenapiHandles <a class="header-anchor" href="#openapihandles" aria-label="Permalink to &quot;OpenapiHandles&quot;"></a></h2>
<p>DM Êèê‰æõ <a href="https://docs.pingcap.com/tidb/stable/dm-open-api" target="_blank" rel="noreferrer">OpenAPI</a> Êù•Êìç‰Ωú/ÂàõÂª∫‰ªªÂä°„ÄÅBinlog Ê∫êÁ≠â,Â∞±ÂÉèÂú® dm-ctl ÂëΩ‰ª§‰∏≠‰ΩøÁî®ÂÆÉ‰∏ÄÊ†∑,‰∏ªË¶ÅÁî± OpenapiHandler Â∞ÅË£ÖÂú® DM Master ‰∏≠ÂÆûÁé∞„ÄÇÂΩìDM Master leader ÂêØÂä®Êó∂Â∑•‰Ωú„ÄÇÂêåÊó∂ÔºåÂ¶ÇÊûú DM Worker peer Êî∂Âà∞ OpenAPI ËØ∑Ê±ÇÔºåÂ∞ÜËØ∑Ê±ÇÈáçÂÆöÂêëÁªôleader Â§ÑÁêÜ„ÄÇ</p>
<h2 id="agentpool" tabindex="-1">AgentPool <a class="header-anchor" href="#agentpool" aria-label="Permalink to &quot;AgentPool&quot;"></a></h2>
<ol>
<li>
<p>Ê≠§ÁªÑ‰ª∂ÊòØÂú® <a href="https://github.com/pingcap/dm/pull/157" target="_blank" rel="noreferrer">Ê≠§PR</a> ‰∏≠Ê∑ªÂä†ÁöÑÔºå‰∏ªË¶ÅÊòØÊúüÂæÖÂú® dm-master ‰∏≠Ê∑ªÂä†ÈÄüÁéáÈôêÂà∂Âíå rpc ÂÆ¢Êà∑Á´ØÁÆ°ÁêÜ„ÄÇËôΩÁÑ∂ÔºåÂÆÉÊòØÊï¥‰∏™DM MasterÁªÑ‰ª∂‰∏≠ÁöÑÂÖ≥ÈîÆÁªÑ‰ª∂Ôºå‰ΩÜÊàë‰πãÊâÄ‰ª•ÂÜ≥ÂÆö‰ªãÁªçÂÆÉÔºåÊòØÂõ†‰∏∫ÂÆÉÂá∫Áé∞Âú® <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/master/server.go#L127" target="_blank" rel="noreferrer">Server</a> ÁªìÊûÑ‰Ωì‰∏≠„ÄÇ</p>
</li>
<li>
<p>ÂÆÉÁöÑ‰∏ªË¶ÅÂÆûÁé∞ÊñπÂºèÊòØÂ∞ÅË£Ö <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/master/agent_pool.go#L60" target="_blank" rel="noreferrer">golang rate.Limit</a> ÂåÖ„ÄÇ</p>
</li>
</ol>
<h2 id="election" tabindex="-1">Election <a class="header-anchor" href="#election" aria-label="Permalink to &quot;Election&quot;"></a></h2>
<ol>
<li><strong>È¶ñÂÖà</strong>ÔºåÂÆÉÊòØ‰∏Ä‰∏™ÊûÑÂª∫Âú® etcd Âü∫Á°Ä‰∏äÂÆûÁé∞ leader ÈÄâ‰∏æÂäüËÉΩÁöÑÈ´òÂèØÁî®Â∞ÅË£Ö„ÄÇ</li>
<li><strong>ÂÖ∂Ê¨°</strong>ÔºåÂáΩÊï∞<a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/pkg/election/election.go#L200" target="_blank" rel="noreferrer">compaignLoop</a>ÊòØÁêÜËß£ÈÄªËæëÊ¶ÇÂøµÂ¶Ç‰ΩïÊåÅÁª≠ËøêË°åÁöÑÂÖ≥ÈîÆ„ÄÇÂÆÉ‰ºöÂÆöÊúüÈáçÈÄâ DM leader ÔºåÂπ∂‰∏îÁî± <strong>leader Â∞ÜÂêØÂä®</strong>‰∏Ä‰∫õÁªÑ‰ª∂ÔºåÂåÖÊã¨ <code>Scheduler</code>Ôºå<code>Pessimist</code> Âíå <code>Optimist</code>ÔºåDM Master follower ‰∏çË¥üË¥£Ëøô‰∫õÔºåÂè™ÊúâÂú®Êàê‰∏∫ leader Êó∂ÊâçË¥üË¥£„ÄÇ</li>
<li><strong>ÁÑ∂Âêé</strong>ÔºåÂÆÉËøòÂ∞Ü task ÂàÜÊàê subtaskÔºåËøô‰∫õ subtask Âú®‰∏Ä‰∏™ËøÅÁßª‰ªªÂä°‰∏≠Âè™‰ª£Ë°®‰∏Ä‰∏™ source(Êàñ worker)(<strong>ÈÄªËæëÂØπÂ∫îÂÖ≥Á≥ª: 1 ‰∏™ worker VS 1 ‰∏™ source VS 1 ‰∏™ subtask</strong>)„ÄÇ</li>
</ol>
<h2 id="scheduler" tabindex="-1">Scheduler <a class="header-anchor" href="#scheduler" aria-label="Permalink to &quot;Scheduler&quot;"></a></h2>
<ol>
<li><strong>È¶ñÂÖà</strong>ÔºåË∞ÉÂ∫¶Âô®ÊòØMasterÁöÑ‰∏ÄÈÉ®ÂàÜÔºåÂÆÉË¥üË¥£DM workerÁöÑ‰ªªÂä°ÔºåÂ¶Ç‚ÄúÊ≥®ÂÜå/ÂèñÊ∂àÊ≥®ÂÜå‚ÄùÔºå‚ÄúËßÇÂØüÂú®Á∫ø/Á¶ªÁ∫ø‚ÄùÔºå‚ÄúËßÇÂØüÊ∑ªÂä†/Âà†Èô§Ê∫êÈÖçÁΩÆ‚ÄùÔºå‚ÄúËÆ°Âàí‰∏äÊ∏∏Ê∫ê‚ÄùÔºå‚ÄúËÆ°ÂàíÊï∞ÊçÆËøÅÁßªÂ≠ê‰ªªÂä°‚ÄùÁ≠âÁ≠âÔºåÊõ¥Â§öËØ¶ÁªÜ‰ø°ÊÅØËØ∑ÂèÇÈòÖ<a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/master/scheduler/scheduler.go#L44" target="_blank" rel="noreferrer">ËøôÈáå</a>„ÄÇ</li>
<li><strong>Á¨¨‰∫å</strong>ÔºåË∞ÉÂ∫¶Âô®ÂÆûÈôÖ‰∏äÂÅöÁöÑÊòØÔºå‰∏ÄÊñπÈù¢Ôºå‰∏Ä‰∫õÂêéÂè∞gorountinesÂú®ÂêØÂä®‰∏ªÂÆû‰æãÂêéÊåÅÁª≠ËøêË°åÔºåÂ¶Ç<a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/master/scheduler/scheduler.go#L2081" target="_blank" rel="noreferrer"><code>observeWorkerEvent</code></a>Â∞ÜÊî∂Âà∞DM WorkerËß¶ÂèëÁöÑkeepaliveÁä∂ÊÄÅÔºåÂè¶‰∏ÄÊñπÈù¢ÔºåÂΩìdmctlÊàñopenAPIÂèëÈÄÅ‰∏Ä‰∫õÊìç‰ΩúÊó∂ÔºåÂÖ∂‰ªñÂ∞ÜË¢´Ëß¶ÂèëÔºåÂ¶Ç:<a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/master/scheduler/scheduler.go#L441" target="_blank" rel="noreferrer"><code>RemoveSourceCfg</code></a>„ÄÇÂ§ßÂ§öÊï∞ÊÉÖÂÜµ‰∏ãÔºåÂáΩÊï∞ÈÉΩÂµåÂÖ•Âà∞GRPCÂÆö‰πâ‰∏≠„ÄÇ</li>
<li><strong>Á¨¨‰∏â</strong>ÔºåÂÆÉËøò‰ªé‰∏Ä‰∏™Â§çÂà∂‰ªªÂä°ÁîüÊàêÂ≠ê‰ªªÂä°ÔºåÂπ∂Â∞ÜÂÆÉ‰ª¨ÊåÅ‰πÖÂåñÂú®etcd‰∏ä„ÄÇ</li>
</ol>
<h2 id="pessimist" tabindex="-1">Pessimist <a class="header-anchor" href="#pessimist" aria-label="Permalink to &quot;Pessimist&quot;"></a></h2>
<ol>
<li>
<p>È¶ñÂÖàÔºåÊàë‰ª¨ÂèØ‰ª•ÁúãÂà∞ÊÇ≤ËßÇ‰∏ª‰πâËÄÖ‰ªé‰∏äÂõæ‰∏≠ÊèêÂá∫‰∫Ü‚ÄúDM Master‚ÄùÂíå‚Äúsyncer‚ÄùÁöÑ‰∏§‰∏™ÈÉ®ÂàÜ„ÄÇËøô‰∏ÄÈÉ®ÂàÜÂ∞ÜÈáçÁÇπ‰ªãÁªçDM MasterÂú®ÂÜÖÈÉ®ÂÅö‰ªÄ‰πà„ÄÇ‰ªé <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/master/shardddl/pessimist.go#L464" target="_blank" rel="noreferrer">the function handleInfoPut of DM Master</a> ‰∏≠ÔºåÊàë‰ª¨ÂèØ‰ª•Á°Æ‰øùÂΩìDM Master‰ªéetcd‰∏≠Êé•Êî∂Âà∞Ë∂≥Â§üÂ§öÁöÑ‰ø°ÊÅØÊó∂ÔºåËøô‰∏™‰ø°ÊÅØË¢´DM MasterÂ§ÑÁêÜ„ÄÇÂÆûÈôÖ‰∏äÔºådm-ctl‰πüÂèØ‰ª•ÁîüÊàêÊìç‰ΩúÔºåÂ∞±ÂÉèDDLÈîÅÁöÑ‰∏Ä‰∫õ‰∏•ÈáçÈîôËØØ‰∏ÄÊ†∑ÔºåÂΩì‰Ω†‰ΩøÁî®<a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/master/shardddl/pessimist.go#L343" target="_blank" rel="noreferrer"><code>waitOwnerToBeDone</code></a> ÁöÑÈÄªËæëÂú®ÈáåÈù¢‰ΩøÁî®' unlock-ddl-lock 'Êó∂„ÄÇ‰ªé‰ª£Á†Å‰∏≠ÔºåÂΩì <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/ddl.go#L641" target="_blank" rel="noreferrer">shardOp.Exec</a> ÊòØÂàÜÁâáDDLÈîÅÁöÑÊâÄÊúâËÄÖÂπ∂‰∏îÁî±DM‰∏ªÈ¢ÜÂØºËÄÖÁöÑ <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/master/shardddl/pessimist.go#L605" target="_blank" rel="noreferrer">putOpForOwner</a> ÁºñÂÜôÊó∂ÔºåÂÆÉÂ∞Ü‰∏∫Áúü„ÄÇÊàëÁöÑÊÑèÊÄùÊòØÔºåËøôÊòØÂÆûÁé∞ÁöÑÈÄªËæëÔºåÂÆûÈôÖ‰∏äÊòØÊâÄÊúâËÄÖÊâßË°å‰∏ãÊ∏∏ÁöÑÂîØ‰∏Ä‰∏Ä‰∏™DDL„ÄÇÂú®workerÁöÑ‚ÄúSyncer‚Äù‰∏≠ÔºåDM-workerÊâÄÂÅöÁöÑÂè™ÊòØÂú®' the handledl function 'Êé•Êî∂Âà∞‰ªª‰ΩïDDL MySQL binlog‰∫ã‰ª∂Êó∂ÔºåÂ∞Ü‰ø°ÊÅØÊîæÂÖ•DM-MasterÁöÑetcd‰∏≠ÔºåÂêåÊó∂ÔºåÂ¶ÇÊûúÂÆÉÊòØÊâÄÊúâËÄÖÊàñÁ¨¨‰∏Ä‰∏™Êª°Ë∂≥DDLÁöÑworkerÔºåÂÆÉ‰πüË¥üË¥£ÊâßË°å„ÄÇ</p>
</li>
<li>
<p>Á¨¨‰∫åÔºåPTALÂú®<a href="https://docs.pingcap.com/zh/tidb-data-migration/v5.3/feature-shard-merge-pessimistic#%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86" target="_blank" rel="noreferrer">ÂàÜÁâá-ÂêàÂπ∂-ÊÇ≤ËßÇ</a>ÁöÑÊ¶ÇÂøµÈÄªËæëÔºå<a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/pkg/shardddl/pessimism/doc.go" target="_blank" rel="noreferrer">ÂÆûÁé∞ÁªÜËäÇ</a>„ÄÇÁÆÄËÄåË®Ä‰πãÔºåÂÆÉÂÆûÈôÖ‰∏äÊâÄÂÅöÁöÑÊòØÂ∞ÜDMÈõÜÁæ§‰∏≠ÁöÑÊØè‰∏™DML‰øùÂ≠òÂú®Â∞öÊú™ÂêåÊ≠•ÁöÑÁâπÂÆöDDLÊó∂Èó¥Êà≥‰πãÂâçÔºåÁõ¥Âà∞DDLÁªìÊùü„ÄÇÁÆÄËÄåË®Ä‰πãÔºåÂ¶ÇÊûúÂú®‰∏Ä‰∏™ÂàÜÁâáÁªÑ‰∏≠Â≠òÂú®DDLÂ§çÂà∂(Â§ö‰∏™MySQLÂàÜÁâáË°®Âà∞‰∏Ä‰∏™TiDBË°®‰∏≠)ÔºåÁ¨¨‰∏Ä‰∏™Êª°Ë∂≥DDLÊü•ËØ¢ÁöÑworkerÂ∞ÜÈÄöÁü•DM-MasterÁîüÊàê‰∏Ä‰∏™ÈîÅÔºåÁÑ∂ÂêéÈòªÂ°ûÁõ∏ÂÖ≥ÁöÑDDLÂíåDMLÊü•ËØ¢„ÄÇÂú®ÊâÄÊúâÊ∫êÁöÑDDLÈÉΩÊä•ÂëäÁªôDM-Master‰πãÂâçÔºåÂ∑≤ÁªèË¢´ÈÄâ‰∏∫ÊâÄÊúâËÄÖÁöÑÈÇ£‰∏™workerÂºÄÂßãÊâßË°åDDL„ÄÇÂ¶ÇÊûúÊàêÂäüÊâßË°å‰∫ÜDDLÔºåÂÆÉÂ∞ÜÈáçÊîæË¢´ÈòªÂ°ûÁöÑDDLÂíåDMLÊü•ËØ¢ÔºåÂπ∂ÂÉèÂæÄÂ∏∏‰∏ÄÊ†∑ÈáçÊîæÂ§çÂà∂„ÄÇ</p>
<figure><img src="https://download.pingcap.com/images/tidb-data-migration/shard-ddl-flow.png" alt="pessimism" tabindex="0"><figcaption>pessimism</figcaption></figure>
</li>
<li>
<p><code>LockKeeper</code> Â∞ÅË£Ö‰∫Ü <code>Lock</code>ÔºåÁî®‰∫éÊñπ‰æøÂú∞‰øùÂ≠òÂíåÂ§ÑÁêÜDDLÈîÅÔºåÂπ∂‰∏îÂú®Â§çÂà∂‰ªªÂä°‰∏≠ÔºåÈîÅ‰∏éDDLÂú®ÁâπÂÆöÊó∂Èó¥ÊòØ1ÂØπ1ÁöÑÂÖ≥Á≥ª„ÄÇ‰∏§‰∫∫‰πüÈÉΩ‰∏çÈúÄË¶ÅÂΩìÊÄªÁªü„ÄÇÂõ†‰∏∫ÂÆÉÂèØ‰ª•‰ªéDM-Worker‰øùÂ≠òÂú®DM-Master etcd‰∏≠ÁöÑÁ¢éÁâáDDL‰ø°ÊÅØÈáçÊñ∞ÊûÑÂª∫„ÄÇÂπ∂‰∏îÔºåËøô‰∏™strcutÊúâ‰∏Ä‰∏™Âêç‰∏∫TrySyncÁöÑÈîÆÂáΩÊï∞ÔºåÂÆÉÈÄöËøáÂ¢ûÂä†Ââ©‰ΩôÁöÑ <strong>Êï∞ÈáèÊù•ÂêåÊ≠•ÈîÅ</strong>ÔºåÂ¶ÇÊûúÂÆÉ‰ªéMySQL Binlog Êé•Êî∂Âà∞ DDL‰∫ã‰ª∂ÔºåÂàôËØ•Êï∞ÈáèÁ≠â‰∫éÊ∫ê(Áõ∏ÂÖ≥worker) ÁöÑÊï∞Èáè„ÄÇ</p>
<div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Lock</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">mu </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sync</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">RWMutex</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">ID     </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">   // lock's ID</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">Task   </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">   // lock's corresponding task name</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">Owner  </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">   // Owner's source ID (not DM-worker's name)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">DDLs   []</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"> // DDL statements</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">remain </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">int</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">      // remain count of sources needed to receive DDL info</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// whether the DDL info received from the source.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// if all of them have been ready, then we call the lock `synced`.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">ready </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">bool</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// whether the operations have done (exec/skip the shard DDL).</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// if all of them have done, then we call the lock `resolved`.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">done </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">bool</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> LockKeeper</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">mu    </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sync</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">RWMutex</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">locks </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Lock</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"> // lockID -> Lock</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
</div></li>
<li>
<p><code>Info</code> Ë°®Á§∫shard DDL‰ø°ÊÅØÔºå<code>Operation</code> Ë°®Á§∫shard DDLÂùêÊ†áÊìç‰ΩúÔºåÊâÄÊúâ‰ø°ÊÅØÈÉΩÂ∫îËØ•ÊåÅ‰πÖÂåñÂú®etcd‰∏≠„ÄÇ‚Äú‰ø°ÊÅØ‚ÄùÂíå‚ÄúÊìç‰Ωú‚Äù‰πãÈó¥ÁöÑÂè¶‰∏Ä‰∏™ÂÖ≥ÈîÆÂå∫Âà´ÊòØÔºåÊàë‰ª¨ÂøÖÈ°ªÁü•ÈÅìDM WorkerÂè™ÊòØÂ∞ÜÈîÅÊàñDDL‰ø°ÊÅØÂèëÈÄÅÁªôDM MasterÔºåÂπ∂‰ªéetcd‰∏≠ËßÇÁúãÊìç‰Ωú„ÄÇÂõ†Ê≠§ÔºåDM MasterÂ∞Ü‰ΩøÁî®<a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/master/shardddl/pessimist.go#L601" target="_blank" rel="noreferrer"><code>func putOpForOwner</code></a>Â∞ÜÊìç‰ΩúÊîæÂÖ•etcd‰ª•ÊâßË°åDDL„ÄÇ</p>
<div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Info</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    Task   </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   `json:"task"`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">   // data migration task name</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    Source </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   `json:"source"`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"> // upstream source ID</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    Schema </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   `json:"schema"`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"> // schema name of the DDL</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    Table  </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   `json:"table"`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">  // table name of the DDL</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    DDLs   []</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `json:"ddls"`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">   // DDL statements</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Operation</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    ID     </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   `json:"id"`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">     // the corresponding DDL lock ID</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    Task   </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   `json:"task"`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">   // data migration task name</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    Source </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   `json:"source"`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"> // upstream source ID</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    DDLs   []</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `json:"ddls"`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">   // DDL statements</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    Exec   </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">bool</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     `json:"exec"`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">   // execute or skip the DDL statements</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    Done   </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">bool</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     `json:"done"`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">   // whether the `Exec` operation has done</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    // only used to report to the caller of the watcher, do not marsh it.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    // if it's true, it means the Operation has been deleted in etcd.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    IsDeleted </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">bool</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `json:"-"`</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
</div></li>
<li>
<p>ÊúÄÂêéÔºåÊàëÊÉ≥ËØ¥ËøôÈáåÊúâÂæàÂ§ö‰∏éÊåÅ‰πÖÂåñÊï∞ÊçÆÁõ∏ÂÖ≥ÁöÑÂÖ≥ÈîÆÂáΩÊï∞ÊØîÂ¶Ç <code>handleInfoPut</code>, <code>handleOperationPut</code> Á≠âÁ≠â„ÄÇ‰ªñ‰ª¨ÈÉΩÊòØ‰∏é DM Master ÁöÑ etcd ‰∫§‰∫í„ÄÇ‰ΩÜÊòØÂú®ÊàëÁöÑ DM Ê¶ÇËßàÂõæ‰∏≠ÔºåÊ≤°ÊúâË¢´Ê∏ÖÊô∞Âú∞ÂàªÁîªÂá∫Êù•„ÄÇ</p>
</li>
<li>
<p>Â¶ÇÊûú‰Ω†ÊÉ≥‰∫ÜËß£Êõ¥Â§öÁªÜËäÇÔºåÊàëÂª∫ËÆÆ‰Ω†ÈòÖËØªËøô‰∏™<a href="https://tidb.net/blog/ebc3d5e6" target="_blank" rel="noreferrer">content</a>ÔºåÂÆÉÊèèËø∞‰∫ÜÊõ¥Â§öÂÖ≥‰∫éÈîÅÂ¶Ç‰ΩïËß£ÊûêÁöÑ‰ø°ÊÅØÔºå‰ª•Âèä dml Â¶Ç‰ΩïÈáçÊñ∞ÂêåÊ≠•(Êàë‰∏äÈù¢ÊèêÂà∞ÁöÑÊ¶ÇÂøµÂ∫îËØ•ÊòØÈòªÂ°ûÔºåÂÆûÈôÖ‰∏äÊàëÂøΩÁï•‰∫ÜËøôÈÉ®ÂàÜ)Âú®<a href="https://tidb.net/blog/80c41c9d" target="_blank" rel="noreferrer">ËøôÈáå</a>„ÄÇËøô‰∫õÂÜÖÂÆπÊ≤°ÊúâËã±ÊñáÁâàÊú¨ÔºåËØ∑‰ΩøÁî®ÂÖ∂‰ªñÁøªËØëÂ∑•ÂÖ∑Êù•Ëß£ÂÜ≥„ÄÇ</p>
</li>
</ol>
<h2 id="optimist" tabindex="-1">Optimist <a class="header-anchor" href="#optimist" aria-label="Permalink to &quot;Optimist&quot;"></a></h2>
<ol>
<li>
<p>ËøòÊúâ‰∏Ä‰∏™ÈáçË¶ÅÁöÑ<a href="https://docs.pingcap.com/zh/tidb-data-migration/v5.3/feature-shard-merge-optimistic#%E5%8E%9F%E7%90%86" target="_blank" rel="noreferrer">Ê¶ÇÂøµÈÄªËæë</a>‰Ω†ÂøÖÈ°ªÈ¶ñÂÖàÁü•ÈÅì„ÄÇÊàëËøòÂ∞ÜÂØπËØ•Ê®°ÂºèËøõË°åÊÄªÁªìÔºå‰∏éÊÇ≤ËßÇÊ®°ÂºèÁõ∏ÊØîÔºåDDL‰∏ç‰ºöÈòªÂ°ûDMLÂ§çÂà∂„ÄÇ</p>
</li>
<li>
<p>LockKeeperÂíåLockÁî®‰∫éÊñπ‰æøÂú∞‰øùÂ≠òÂíåÂ§ÑÁêÜDDLÈîÅ„ÄÇÊ¶ÇÂøµÈÄªËæëÂäüËÉΩÁõ∏ÂΩì‰∫éÈîÅÂÆöÊÇ≤ËßÇ‰∏ª‰πâ„ÄÇËøô‰∏™È´òÂ∫¶Á≠â‰∫éÊÇ≤ËßÇ‰∏ª‰πâËÄÖÁöÑ‰∏ÄÈÉ®ÂàÜ„ÄÇ</p>
</li>
<li>
<p>ËøòÊúâ‰∏Ä‰∏™ <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/pkg/shardddl/optimism/doc.go#L16" target="_blank" rel="noreferrer">Doc</a>Âè™ÊòØÁÆÄÂçïÂú∞ËØ¥‰∏çÂêå‰∫éÊÇ≤ËßÇ‰∏ª‰πâËÄÖ„ÄÇÂÆûÈôÖ‰∏äÔºåÊàëËÆ§‰∏∫‰Ω†ÂèØ‰ª•ÈòÖËØªËøô‰∏™È°µÈù¢ÔºåÂÆÉÁ≠â‰∫é‰∏Ä‰∏™ÊàñÊõ¥Â§öÁöÑ‰ø°ÊÅØÔºå‰Ω†ÂèØ‰ª•ÂæóÂà∞<a href="https://docs.pingcap.com/tidb-data-migration/v5.3/feature-shard-merge-optimistic#restrictions" target="_blank" rel="noreferrer">ËøôÈáå</a>„ÄÇËÆ©Êàë‰ª¨ÂºÄÂßãÁúãÁúãDM MasterÂú®‰πêËßÇÊ®°Âºè‰∏ãÂØπDDLÂ§çÂà∂ÂàÜÁâáÂÅö‰∫Ü‰ªÄ‰πà„ÄÇ</p>
<figure><img src="https://download.pingcap.com/images/tidb-data-migration/optimistic-ddl-flow.png" alt="optimistic" tabindex="0"><figcaption>optimistic</figcaption></figure>
</li>
<li>
<p>Êàë‰ª¨ÂèØ‰ª•ÁÆÄÂçïÂú∞ÂæóÂà∞Ôºå‰ø°ÊÅØÂíåÊìç‰Ωú‰∏çÂêå‰∫éÊÇ≤ËßÇ‰∏ª‰πâËÄÖÁöÑÁªìÊûÑ„ÄÇ‰πêËßÇ‰∏ª‰πâËÄÖÊìç‰ΩúÁöÑ‰ø°ÊÅØÂåÖÂê´‰∫ÜÊØîÊÇ≤ËßÇ‰∏ª‰πâËÄÖÊõ¥Â§öÁöÑ‰∏úË•øÔºåÊØîÂ¶Ç <code>TableInfoBefore</code>Ôºå <code>tableinfoafter</code>Ôºå<code>DownTable</code> Á≠âÁ≠âÔºåÂÆÉ‰ª¨Ë¢´Áî®Êù•ËÆ°ÁÆóDDLÂ∫îËØ•Â¶Ç‰ΩïËΩ¨Êç¢„ÄÇ</p>
<div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Info</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">Task       </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   `json:"task"`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">        // data migration task name</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">Source     </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   `json:"source"`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">      // upstream source ID</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">UpSchema   </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   `json:"up-schema"`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">   // upstream/source schema name, different sources can have the same schema name</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">UpTable    </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   `json:"up-table"`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    // upstream/source table name, different sources can have the same table name</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">DownSchema </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   `json:"down-schema"`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"> // downstream/target schema name</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">DownTable  </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   `json:"down-table"`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">  // downstream/target table name</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">DDLs       []</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `json:"ddls"`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">        // DDL statements</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">TableInfoBefore </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">TableInfo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   `json:"table-info-before"`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"> // the tracked table schema before applying the DDLs</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">TableInfosAfter []</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">TableInfo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `json:"table-info-after"`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">  // the tracked table schema after applying the DDLs</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// only used to report to the caller of the watcher, do not marsh it.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// if it's true, it means the Info has been deleted in etcd.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">IsDeleted </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">bool</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `json:"-"`</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// only set it when get/watch from etcd</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">Version </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">int64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `json:"-"`</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// only set it when get from etcd</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// use for sort infos in recoverlock</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">Revision </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">int64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `json:"-"`</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// use to resolve conflict</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">IgnoreConflict </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">bool</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `json:"ignore-conflict"`</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Operation</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">ID            </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">        `json:"id"`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">               // the corresponding DDL lock ID</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">Task          </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">        `json:"task"`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">             // data migration task name</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">Source        </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">        `json:"source"`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">           // upstream source ID</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">UpSchema      </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">        `json:"up-schema"`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">        // upstream/source schema name, different sources can have the same schema name</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">UpTable       </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">        `json:"up-table"`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">         // upstream/source table name, different sources can have the same table name</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">DDLs          []</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      `json:"ddls"`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">             // DDL statements need to apply to the downstream.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">ConflictStage </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ConflictStage</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `json:"conflict-stage"`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">   // current conflict stage.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">ConflictMsg   </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">        `json:"conflict-message"`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"> // current conflict message</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">Done          </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">bool</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">          `json:"done"`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">             // whether the operation has done</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">Cols          []</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      `json:"cols"`</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">             // drop columns' name</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// only set it when get from etcd</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// use for sort infos in recovering locks</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">Revision </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">int64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `json:"-"`</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
</div></li>
<li>
<p><strong>DM MasterÂ¶Ç‰ΩïËΩ¨Êç¢DDL‰ø°ÊÅØÊàñÊ®°Âºè‰ø°ÊÅØ</strong> Âè™ÊòØËØïÂõæÊ£ÄÊµãÊòØÂê¶Êúâ‰ªª‰ΩïDDLÂÜ≤Á™ÅÔºåÂπ∂ÂÖÅËÆ∏ÊØè‰∏™DMLÂêåÊ≠•Âà∞‰∏ãÊ∏∏Â∞ΩÂø´„ÄÇÂ¶ÇÊûúÊúâÈîôËØØÊàñÂÜ≤Á™ÅÔºåÂÆÉÂ∞ÜË¢´Êä•Âëä„ÄÇ</p>
</li>
</ol>
]]></content:encoded>
            <enclosure url="https://askaric.com/images/tidb/05TiDB-EcosystematicTools/5-4DM/02-DM_Master_Components.jpeg" length="0" type="image/jpeg"/>
        </item>
        <item>
            <title><![CDATA[DM Worker]]></title>
            <link>https://askaric.com/zh/work/tidb/TiDB-EcosystematicTools/5-4DM/04TiDB-DM Worker.html</link>
            <guid>https://askaric.com/zh/work/tidb/TiDB-EcosystematicTools/5-4DM/04TiDB-DM Worker.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[What's DM Worker
DM Worker‰ªé func start ÂºÄÂßãÔºåÂêØÂä®‰∏ÄÁ≥ªÂàóÁªÑ‰ª∂ÔºåÂåÖÊã¨ `startKeepAlive`Ôºå `RelayHandler`Ôºå `SubTasks`Ôºå `]]></description>
            <content:encoded><![CDATA[<h1 id="dm-worker" tabindex="-1">DM Worker <a class="header-anchor" href="#dm-worker" aria-label="Permalink to &quot;DM Worker&quot;"></a></h1>
<h2 id="what-s-dm-worker" tabindex="-1">What's DM Worker <a class="header-anchor" href="#what-s-dm-worker" aria-label="Permalink to &quot;What's DM Worker&quot;"></a></h2>
<p>DM Worker‰ªé <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/worker/server.go#L106-L108" target="_blank" rel="noreferrer">func start</a> ÂºÄÂßãÔºåÂêØÂä®‰∏ÄÁ≥ªÂàóÁªÑ‰ª∂ÔºåÂåÖÊã¨ <code>startKeepAlive</code>Ôºå <code>RelayHandler</code>Ôºå <code>SubTasks</code>Ôºå <code>Syncer</code>„ÄÇÂÖ≥‰∫é Relay ÈÖçÁΩÆÔºåÊúâ‰∏Ä‰∏™<a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/worker/server.go#L160-L164" target="_blank" rel="noreferrer">ÈÄªËæë</a>Êù•Âà§ÂÆöÊòØÂê¶‰ΩøÁî®ËøúÁ®ãMySQL BinlogÊàñÊú¨Âú∞ Relay Êó•Âøó„ÄÇ</p>
<figure><img src="./../../../../../images/tidb/05TiDB-EcosystematicTools/5-4DM/03-DM_Worker_Components.jpeg" alt="DM_Worker_Components" tabindex="0"><figcaption>DM_Worker_Components</figcaption></figure>
<h2 id="keepalive" tabindex="-1">KeepAlive <a class="header-anchor" href="#keepalive" aria-label="Permalink to &quot;KeepAlive&quot;"></a></h2>
<ol>
<li>
<p><strong>ÂäüËÉΩÊòØ‰ªÄ‰πà?</strong> DM Worker ‰∏é Master ‰øùÊåÅÂøÉË∑≥„ÄÇÂ¶ÇÊûú Worker Â§±Âéª‰∫Ü‰∏é Master ÁöÑËøûÊé•ÔºåÂÆÉÂ∞ÜÂÅúÊ≠¢ÊâÄÊúâ‰ªªÂä°Âπ∂Â∞ùËØïÂÜçÊ¨°ËøûÊé•‰∏ªÊúçÂä°Âô®„ÄÇ</p>
</li>
<li>
<p><strong>ÂÆÉÊòØÂ¶Ç‰ΩïÂ∑•‰ΩúÁöÑ„ÄÇ</strong> <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/worker/join.go#L103" target="_blank" rel="noreferrer">defaultKeepAliveTTL</a>ÊòØ1ÂàÜÈíüÔºåÂÆÉÂÆöÊúü‰ΩøÁî®<a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/pkg/ha/keepalive.go#L116" target="_blank" rel="noreferrer">etcd cli.Grant</a>Â∞Ükv‰∏éTTLÊîæÂú®etcd„ÄÇÈÄöËøáËøôÁßçÊñπÂºèÔºåDM MasterÂèØ‰ª•Â∞ÜÂ≠ê‰ªªÂä°ËΩ¨Êç¢Âà∞Âè¶‰∏Ä‰∏™Ê¥ªË∑ÉÁöÑDM Worker‰∏≠ÔºåÂ¶ÇÊûúËøô‰∏™WorkerÂ∑≤ÁªèÁªëÂÆö‰∫Ü‰∏Ä‰∏™ÁâπÂÆöÁöÑMySQL BinlogÔºåÈÇ£‰πàËøô‰∏™WorkerÂ∞±‰ºöÂá∫Áé∞‰∏•ÈáçÁöÑÈóÆÈ¢ò„ÄÇ</p>
</li>
</ol>
<h2 id="relay" tabindex="-1">Relay <a class="header-anchor" href="#relay" aria-label="Permalink to &quot;Relay&quot;"></a></h2>
<ol>
<li>
<p><strong>Â¶Ç‰ΩïÊ£ÄÊµãÂÆÉÊòØÂê¶Â∑≤ÈÖçÁΩÆ„ÄÇ</strong> ÂΩìÈÖçÁΩÆ‰∏çËÉΩ‰ªé DM Master Ëé∑ÂèñÔºåËøôÊÑèÂë≥ÁùÄ‰ªªÂä°Â∑≤ÁªèÂà†Èô§ÊàñÂ∞öÊú™ÈÖçÁΩÆÔºåÂêØÂä®<a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/worker/server.go#L183-L185" target="_blank" rel="noreferrer">ÈÄªËæë</a>ËøõÂÖ•<a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/worker/server.go#L686-L688" target="_blank" rel="noreferrer">func enableHandleSubtasks</a>Êù•ËØÅÊòéÊòØÂê¶‰ΩøÁî® Relay Êó•Âøó„ÄÇ</p>
</li>
<li>
<p><strong>Â¶Ç‰ΩïÂ∑•‰ΩúÔºåÂ¶ÇÊûúÂÆÉÊòØÈÖçÁΩÆ„ÄÇ</strong> Êõ¥Â§ö Relay ÂÆûÁé∞‰ø°ÊÅØÂú®<a href="https://cn.pingcap.com/blog/dm-source-code-reading-6" target="_blank" rel="noreferrer">ËøôÁØáÊñáÁ´†- DMÊ∫êÁ†ÅÈòÖËØªÁ≥ªÂàóÊñáÁ´†(ÂÖ≠)‰∏≠ÁªßÊó•ÂøóÁöÑÂÆûÁé∞</a>(È°∫‰æøËØ¥‰∏ÄÂè•:‰Ω†ÈúÄË¶ÅËã±ÊñáÁâàÊú¨ÂèØËÉΩÈúÄË¶ÅËá™Ë°åÁøªËØë)„ÄÇÁÆÄÂçïÂú∞ËØ¥ÔºåRelay log ÊòØ‰∏Ä‰∏™ÈÅøÂÖçËøúÁ®ã MySQL Binlog Á™ÅÁÑ∂Ê∂àÂ§±ÁöÑÊ°•Ê¢ÅÂäüËÉΩÔºåÂÆÉÊòØÈÄöËøáÈ¶ñÂÖàËØªÂèñÊØè‰∏™ÊúâÁî®ÁöÑBinlogÔºåÊØîÂ¶ÇÊèíÂÖ•/Êõ¥Êñ∞‚Ä¶‰ΩøÁî®<a href="https://github.com/pingcap/dm/blob/f6f0566424/relay/reader/reader.go#L128" target="_blank" rel="noreferrer">GetEvent</a>ÔºåÁÑ∂ÂêéÂÜôÂÖ•‰∏≠ÁªßÊó•ÂøóÁõÆÂΩïÊù•ÂÆûÁé∞ÔºåÂ¶Ç‰∏ãÊâÄÁ§∫„ÄÇDM Worker Âú®ÂêØÁî® Relay Êó∂ÔºåË∞ÉÁî®<a href="https://github.com/pingcap/dm/blob/f6f0566424/pkg/streamer/reader.go#L244" target="_blank" rel="noreferrer">func parseFile</a>Ëß£Êûê‰∏≠ÁªßÊó•ÂøóÂà∞ÂêåÊ≠•Âô®„ÄÇ<br>
<strong>a. server-uuid.index</strong> : ‰∏Ä‰∏™Â∑≤ÁªèÁªÑÁªá‰∫Übinglog‰∫ã‰ª∂ÁöÑÁ¥¢ÂºïÔºå‰ª•Êèê‰æõ‰∏Ä‰∏™ÁªìÊûÑÊù•Á¥¢ÂºïËØªÂèñÁöÑ‰ΩçÁΩÆ„ÄÇ<br>
<strong>b. 842965eb-091c-11e9-9e45-9a3bff03fa39</strong> : Áî± <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/relay/meta.go#L279" target="_blank" rel="noreferrer">func utils.AddSuffixForUUID</a>‰ª• <code>fmt.Sprintf(&quot;%s%s%06d&quot;, uuid, uuidIndexSeparator, id)</code> Ê†ºÂºèÁîüÊàêÁöÑÁõÆÂΩï„ÄÇ<br>
<strong>c. relay.meta</strong> : ËÆ∞ÂΩïÂΩìÂâçËøáÁ®ãÊàñËøõÂ∫¶„ÄÇ<br>
<strong>d. mysql-bin.00000X</strong> : XÁöÑÊúÄÂ§ßÂÄºÊòØÊ≠£Âú®ÂÜôÂÖ•ÁöÑÊúÄÊñ∞Êñá‰ª∂„ÄÇ</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">&#x3C;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">deploy_dir</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">/relay_log/</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">--</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 7e427cc0-091c-11e9-9e45-72b7c59d52d7.000001</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">--</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysql-bin.000001</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">--</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysql-bin.000002</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">--</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysql-bin.000003</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">--</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysql-bin.000004</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">--</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> relay.meta</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">--</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 842965eb-091c-11e9-9e45-9a3bff03fa39.000002</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">--</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> mysql-bin.000001</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">--</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> relay.meta</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">--</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  server-uuid.index</span></span></code></pre>
</div></li>
</ol>
<h2 id="subtasks" tabindex="-1">SubTasks <a class="header-anchor" href="#subtasks" aria-label="Permalink to &quot;SubTasks&quot;"></a></h2>
<ol>
<li>
<p><strong>SubTasks ÊòØ‰ªÄ‰πàÊÑèÊÄù</strong> SubTaskË°®Á§∫Êï∞ÊçÆËøÅÁßªÁöÑÂ≠ê‰ªªÂä°„ÄÇ‰πüÂ∞±ÊòØËØ¥ÔºåÂ≠ê‰ªªÂä°Êï∞Á≠â‰∫éMySQL BinlogÊï∞„ÄÇÈÉΩÊòØÂõ†‰∏∫‰ªñ‰ª¨ÁöÑÂÖ≥Á≥ªÊòØ1ÊØî1„ÄÇÊàë‰ª¨ÂèØ‰ª•Âú®‰∏ãÈù¢ÁúãÂà∞<a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/worker/subtask.go#L77" target="_blank" rel="noreferrer">ÂÆÉÁöÑ struct</a>„ÄÇÊàë‰ª¨ÈÉΩÁü•ÈÅìÔºå‰∏Ä‰∏™Â∑•‰∫∫Âà∞Áé∞Âú®‰∏∫Ê≠¢Âè™Êúâ‰∏Ä‰∏™binlog„ÄÇ‰∏Ä‰∏™ÂÄºÂæóÊ≥®ÊÑèÁöÑÁâπÊÄßÊòØPingCAPËØïÂõæËß£ËÄ¶ 1-1 ÁöÑÂÖ≥Á≥ªÔºåÊÇ®ÂèØ‰ª•ÈÄöËøáË∑üË∏™ <a href="https://github.com/pingcap/tiflow/issues/4687" target="_blank" rel="noreferrer">Issue</a> Êù•ÊµÅÂä®ËøõÂ∫¶„ÄÇ</p>
<div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> SubTask</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">cfg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">SubTaskConfig</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">......</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">workerName </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">string</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">validator </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">syncer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">DataValidator</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
</div></li>
<li>
<p><strong>ÂÆÉÊòØÂ¶Ç‰ΩïÂàõÂª∫ÁöÑ„ÄÇ</strong> ‰ªé‰ªªÂä°ÁîüÊàêÂ≠ê‰ªªÂä°ÁöÑ‰∏ªË¶ÅÂú∞ÊñπÊòØÂú®<a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/master/openapi_controller.go#L386" target="_blank" rel="noreferrer">OpenAPITaskToSubTaskConfigs</a>Âíå<a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/master/server.go#L510" target="_blank" rel="noreferrer">StartTask</a>„ÄÇÂÄºÂæóÊ≥®ÊÑèÁöÑÊòØÔºå‰∏ç‰ªÖÂè™Êúâ‰∏§‰∏™ÔºåËøòÊúâ<a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/master/server.go#L725" target="_blank" rel="noreferrer">UpdateTask</a>„ÄÇ‰ΩÜÊàë‰ª¨Âè™ÊòØÂÖ≥Ê≥®ÂÆÉÁöÑÊù•Ê∫ê„ÄÇÊâÄ‰ª•ÔºåÂ¶ÇÊûú‰Ω†ÊÑüÂÖ¥Ë∂£Ôºå‰Ω†ÂèØ‰ª•Ëá™Â∑±Êé¢Á¥¢„ÄÇ</p>
</li>
</ol>
<h2 id="sourceworker" tabindex="-1">SourceWorker <a class="header-anchor" href="#sourceworker" aria-label="Permalink to &quot;SourceWorker&quot;"></a></h2>
<ol>
<li>
<p><strong>ÂÆÉË¥üË¥£‰ªÄ‰πà?</strong> SourceWorkerÁÆ°ÁêÜ‰∏Ä‰∏™Ê∫ê(‰∏äÊ∏∏)Ôºå‰∏ªË¶Å‰∏éÂ≠ê‰ªªÂä°Âíå‰∏≠ÁªßÁõ∏ÂÖ≥„ÄÇÂÆÉÊúâÂæàÂ§öÂáΩÊï∞ÔºåÂ¶Ç‚ÄúupdateSourceStatus‚ÄùÔºå‚ÄúfetchSubTasksAndAdjust‚ÄùÔºå‚ÄúoperateRelay‚ÄùÂíå‚ÄúPurgeRelay‚Äù‚Ä¶ÔºåÊàë‰ª¨ÂèØ‰ª•ÁúãÂà∞ÂäüËÉΩÊòØ‰ªÄ‰πà„ÄÇ</p>
</li>
<li>
<p><strong>ÂÆÉÊòØÂ¶Ç‰ΩïÂ∑•‰ΩúÁöÑ„ÄÇ</strong> Âè™ÂÖ≥Ê≥®SourceWorkerÂäüËÉΩÁöÑ‰∏ªË¶ÅÈÉ®ÂàÜ(StartSubTask)„ÄÇÂ¶ÇÂâçÊâÄËø∞ÔºåÂΩì‰∏Ä‰∏™DM WorkerÂêØÂä®Êó∂ÔºåÂÆÉÈÄöËøáËØ∑Ê±ÇetcdÊù•Ëé∑ÂæóÂ≠ê‰ªªÂä°ÈÖçÁΩÆÂíåÁªëÂÆöÂÖ≥Á≥ª„ÄÇÂõ†Ê≠§ÔºåÈÅµÂæ™ <code>EnableHandleSubtasks‚Äî‚Äî&gt; w.s tstartsubtask‚Äî‚Äî&gt;st. Run‚Äî‚Äî&gt;initUnits‚Äî‚Äî&gt;createUnits</code>ÔºåÂ∞ÜÊ∏ÖÊ•öÂú∞ÊòæÁ§∫‰∏Ä‰∏™Â∑•‰ΩúÈÄªËæë„ÄÇÂπ∂‰∏îÔºåÂú® <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/worker/subtask.go#L52" target="_blank" rel="noreferrer">func createRealUnits</a> ‰∏≠ÔºåÊúâ‰∏Ä‰∫õÊ≠•È™§Êù•Ë∞ÉÊï¥ <code>modelall</code> Êàñ <code>ModeIncrement</code> „ÄÇÂ¶ÇÊûúÊúâÂÖ¥Ë∂£ÔºåËØ∑Ëá™Â≠¶„ÄÇ</p>
</li>
</ol>
<h2 id="syncer" tabindex="-1">Syncer <a class="header-anchor" href="#syncer" aria-label="Permalink to &quot;Syncer&quot;"></a></h2>
<p>Êàë‰∏çÂæó‰∏çËØ¥ <code>Syncer</code> ÊòØ DM Worker ÊúÄÈáçË¶ÅÁöÑÁªÑ‰ª∂ÔºåÁîöËá≥ÊòØDM„ÄÇÊâÄ‰ª•ÔºåÂÆÉË¢´ÂàÜÊàê‰∏Ä‰∏™ÂçïÁã¨ÁöÑÂÜÖÂÆπÊù•Ëß£ÈáäÂÆÉÊòØÂ¶Ç‰ΩïÂ∑•‰ΩúÁöÑ„ÄÇÂú® <a href="./05TiDB-DM syncer.html">ËøôÈáå</a>„ÄÇ</p>
]]></content:encoded>
            <enclosure url="https://askaric.com/images/tidb/05TiDB-EcosystematicTools/5-4DM/03-DM_Worker_Components.jpeg" length="0" type="image/jpeg"/>
        </item>
        <item>
            <title><![CDATA[DM syncer]]></title>
            <link>https://askaric.com/zh/work/tidb/TiDB-EcosystematicTools/5-4DM/05TiDB-DM syncer.html</link>
            <guid>https://askaric.com/zh/work/tidb/TiDB-EcosystematicTools/5-4DM/05TiDB-DM syncer.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[What's syncer
1. Syncer ÂèØ‰ª•ÂêåÊ≠•‰Ω†ÁöÑ MySQL Êï∞ÊçÆÂà∞Âè¶‰∏Ä‰∏™ MySQL Êï∞ÊçÆÂ∫ìÔºåËøôÊòØ Package Â±ÇÈù¢ÁöÑÂÆö‰πâÔºåÂõ†‰∏∫ Syncer ÁúüÊ≠£ÂÆûÁé∞‰∫ÜËØªÂèñ MySQL Binlo]]></description>
            <content:encoded><![CDATA[<h1 id="dm-syncer" tabindex="-1">DM syncer <a class="header-anchor" href="#dm-syncer" aria-label="Permalink to &quot;DM syncer&quot;"></a></h1>
<h2 id="what-s-syncer" tabindex="-1">What's syncer <a class="header-anchor" href="#what-s-syncer" aria-label="Permalink to &quot;What's syncer&quot;"></a></h2>
<ol>
<li>
<p>Syncer ÂèØ‰ª•ÂêåÊ≠•‰Ω†ÁöÑ MySQL Êï∞ÊçÆÂà∞Âè¶‰∏Ä‰∏™ MySQL Êï∞ÊçÆÂ∫ìÔºåËøôÊòØ Package Â±ÇÈù¢ÁöÑÂÆö‰πâÔºåÂõ†‰∏∫ Syncer ÁúüÊ≠£ÂÆûÁé∞‰∫ÜËØªÂèñ MySQL Binlog Âπ∂ËΩ¨Âåñ‰∏∫ DML/DDL ËØ≠Âè•ÂêåÊ≠•Âà∞‰∏ãÊ∏∏ÁöÑÂÖ≥ÈîÆÈÄªËæëÔºå DM Master Âíå Worker Êõ¥ÂÉèÊòØÂ§ñÂ±ÇÈ´òÂèØÁî®ÊÄßÁöÑÂ∞ÅË£ÖÔºåÂÅèÈ¢áÁöÑËØ¥„ÄÇ</p>
<figure><img src="./../../../../../images/tidb/05TiDB-EcosystematicTools/5-4DM/03-DM_Worker_Components.jpeg" alt="DM_Worker_Components" tabindex="0"><figcaption>DM_Worker_Components</figcaption></figure>
</li>
</ol>
<h2 id="pessimist" tabindex="-1">Pessimist <a class="header-anchor" href="#pessimist" aria-label="Permalink to &quot;Pessimist&quot;"></a></h2>
<ol>
<li>
<p>ÊàëÂ∑≤ÁªèË∞àËÆ∫‰∫Ü‰∏Ä‰∫õÂ∑•‰∫∫Âú®ÊÇ≤ËßÇÁöÑDDLÊú∫Âà∂‰∏≠ÊâÄÂÅöÁöÑ‰∫ãÊÉÖÔºåPTALÂú®<a href="./03TiDB-DM Master.html">ÊÇ≤ËßÇ‰∏ª‰πâËÄÖÂÜÖÂÆπ</a>È¶ñÂÖàÂú®DM Master‰∏≠„ÄÇ</p>
</li>
<li>
<p>‰ªé DM worker ÁöÑ <code>DM Syncer Main Steps</code> ÈÉ®ÂàÜÔºåÊàë‰ª¨ÂèØ‰ª•ÁúãÂà∞ DM worker ‰∏≠ÁöÑ Syncer Âè™ÊòØÊää‰ªñÁöÑ DDL Info ‰∏ä‰º†Áªô DM Masrter, Â¶ÇÊûúÂÆÉÊòØ DDL ÈîÅÁöÑ Owner ÁöÑËØùÔºåÁõëËßÜÁî± DM Master ÁîüÊàêÁöÑ Operation ÊîæÂú® <code>DDL‰Ωú‰∏öÈòüÂàó</code> ‰∏≠„ÄÇ</p>
</li>
</ol>
<h2 id="optimist" tabindex="-1">Optimist <a class="header-anchor" href="#optimist" aria-label="Permalink to &quot;Optimist&quot;"></a></h2>
<ol>
<li>
<p>‰πüËØ∑ÁúãÁúãÊàëÂÜôÁöÑ<a href="./../5-4DM/03TiDB-DM Master.html">ËøôÈáå</a>ÔºåÊâÄÊúâËøô‰∫õÈÉΩÊòØÂõ†‰∏∫Â¶ÇÊûúÊ≤°ÊúâÈ¢ÑËØªÔºå‰Ω†ÂèØËÉΩ‰ºöÊÑüÂà∞Âõ∞ÊÉë„ÄÇÂ§ßÈÉ®ÂàÜÈÉΩÊòØÁõ∏ÂÖ≥ÁöÑ„ÄÇ</p>
</li>
<li>
<p>Êú¨È°µÈ°∂ÈÉ®ÁöÑÂõæÁâáÔºåÂîØ‰∏Ä‰∏çÂêåÁöÑÂ§ÑÁêÜÊ≠•È™§Âè™ÊòØ <code>GetOperation</code> ‰πãÂêéÁöÑ <code>switch op.ConflictStage</code>„ÄÇ‰ªñ‰ª¨Âú®etcd ‰∏äÁªôÂá∫‰∫ÜÊÇ≤ËßÇ‰∏ª‰πâËÄÖÂíå‰πêËßÇ‰∏ª‰πâËÄÖÂÆåÂÖ®‰∏çÂêåÁöÑ‰ø°ÊÅØÔºåÂú®‰πêËßÇ‰∏ª‰πâ‰∏≠Êää‰ø°ÊÅØ‰∫§Áªô DM Master ÂêéÔºåDM Worker Ëé∑ÂæóÂπ∂Âà§Êñ≠ÊòØÂê¶Â≠òÂú®ÂÜ≤Á™ÅÔºåÂπ∂‰ª•‰∏çÂêåÁöÑÊñπÂºèÂ§ÑÁêÜ‰∏ã‰∏ÄÊ≠•„ÄÇÂú®<a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/ddl.go#L883" target="_blank" rel="noreferrer">ËøôÈáå</a>Ë∞ÉÊï¥ÂÜ≤Á™ÅÂêéÔºåDM Worker ÂÆûÈôÖÂæóÂà∞ÁöÑÊòØ DM Master ËøîÂõûÁöÑÁªìÊûú„ÄÇ</p>
</li>
</ol>
<h2 id="streamcontroller" tabindex="-1">streamController <a class="header-anchor" href="#streamcontroller" aria-label="Permalink to &quot;streamController&quot;"></a></h2>
<ol>
<li>
<p>streamController ÂåÖÊã¨‰∏Ä‰∫õÂ≠óÊÆµÔºåÂ¶Ç <code>retryStrategy</code>Ôºå  <code>syncCfg</code>Ôºå  <code>fromDB</code> Á≠âÔºåÂú®<a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/binlogstream/streamer_controller.go#L131" target="_blank" rel="noreferrer">ÂÆÉÁöÑ struct</a> ÂèØ‰ª•ÁúãÂà∞Êõ¥Â§öÔºå‰∏ªË¶ÅÁî®‰∫éÂéªÊéßÂà∂ËØªÂèñ binlogÔºåÂåÖÊã¨Â∞Üstreamer ÈáçÁΩÆ binlog ‰ΩçÁΩÆÊàñ GTIDÔºåËØªÂèñ‰∏ã‰∏Ä‰∏™ binlog ‰∫ã‰ª∂Ôºå‰ªéÊú¨Âú∞ streamer ‰º†ËæìÂà∞ËøúÁ®ã streamerÔºàremote or relayÔºâ„ÄÇ</p>
</li>
<li>
<p>‰ªé<a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/binlogstream/streamer_controller.go#L54-L83" target="_blank" rel="noreferrer"><code>GenerateStreamFrom</code></a>Âíå<a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/binlogstream/streamer_controller.go#L337" target="_blank" rel="noreferrer"><code>func GetEvent</code></a>ÁöÑÁïåÈù¢ÂèØ‰ª•ÁúãÂà∞ÔºåÂÆÉËøûÁª≠Â∞ÅË£Ö‰∫ÜMySQL BinlogÂà∞‰∏ã‰∏Ä‰∏™‰∫ã‰ª∂ÁöÑÁä∂ÊÄÅ‰ø°ÊÅØ„ÄÇ</p>
</li>
</ol>
<h2 id="runningloop" tabindex="-1">RunningLoop <a class="header-anchor" href="#runningloop" aria-label="Permalink to &quot;RunningLoop&quot;"></a></h2>
<ol>
<li>
<p>ÂÆûÈôÖ‰∏äÔºå<code>RunnLoop</code> ÊòØÊàëÂàõÈÄ†ÁöÑ‰∏Ä‰∏™ÂêçÁß∞ÔºåÂÆÉÂ∫îËØ•ÊòØ <code>func (s *Syncer) Run</code>„ÄÇÊàëÊõ¥ÊîπÂêçÁß∞ÁöÑÂéüÂõ†ÊòØ‰ΩøÂÖ∂Êõ¥ÊúâÊÑè‰πâÔºåÂõ†‰∏∫ÂÖ≥ÈîÆÈÄªËæëÂèÇËÄÉ‰∫Ü‰∏Ä‰∏™ 694Ë°åÁöÑÂáΩÊï∞‰∏≠ <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/syncer.go#L1968-L1969" target="_blank" rel="noreferrer">this for-loop</a>ÔºåËæÉ‰∏∫ÈöæÁêÜËß£„ÄÇ</p>
</li>
<li>
<p>Â¶ÇÂõæÊâÄÁ§∫ÔºåstreamController Â∞ÜÈÄöËøá <code>handleRotateEvent</code>Ôºå <code>HandleQueryEvent</code> Á≠âËøûÁª≠ÂèëÈÄÅ MySQL Binlog ÂíåËøêË°åÂ§ÑÁêÜÊØè‰∏™ Binglog Event„ÄÇ</p>
</li>
<li>
<p>Âú® <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/syncer.go#L2535" target="_blank" rel="noreferrer">func handleRowsEvent</a>‰∏≠ÔºåMySQLÂÆö‰πâ‰∫ÜÂ§™Â§öÁöÑ‰∫ã‰ª∂ÔºåDMÂè™ÈúÄË¶ÅËΩ¨Êç¢ÂÖ∂‰∏≠ÁöÑ‰∏ÄÈÉ®ÂàÜÔºåÂ¶Ç <code>UPDATE_ROWS_EVENT</code>Ôºå <code>DELETE_ROWS_EVENT</code>Ôºå<code>WRITE_ROWS_EVENT</code> Á≠â„ÄÇSyncer ÂèØ‰ª•ÈÄöËøá<a href="https://github.com/go-mysql-org/go-mysql" target="_blank" rel="noreferrer">Package mysql-go</a>Âíå‰∏Ä‰∫õ Event ‰ø°ÊÅØÂÅöÂà∞Ëøô‰∏ÄÁÇπÔºå‰Ω†ÂèØ‰ª•Âú®<a href="https://dev.mysql.com/doc/dev/mysql-server/latest/page_protocol_replication_binlog_event.html" target="_blank" rel="noreferrer">page_protocol_replication_binlog_event</a> Êü•ÁúãÂà∞Êõ¥Â§öÂÆö‰πâËß£Êûê„ÄÇ</p>
</li>
</ol>
<h2 id="syncdml" tabindex="-1">syncDML <a class="header-anchor" href="#syncdml" aria-label="Permalink to &quot;syncDML&quot;"></a></h2>
<ol>
<li>
<p>Ëøô‰∏™<a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/syncer.go#L1534" target="_blank" rel="noreferrer">func syncDML</a> ÊâÄÂÅöÁöÑÂè™ÊòØ‰ªé dmlJobCh ËøûÁª≠Ëé∑Âèñ dmlJobÔºåÂπ∂Â∞ÜÂÖ∂ËæìÂá∫Âà∞ÂéãÁº©Âô®ÊàñÂõ†ÊûúÂÖ≥Á≥ª„ÄÇÂÆÉÂèñÂÜ≥‰∫é‰Ω†ÊòØÂê¶Â∞Ü <code>compact</code> ÈÖçÁΩÆ‰∏∫trueÔºåËøôÊòØ‰∏Ä‰∏™Âä†ÈÄüÂ§çÂà∂ÈÄüÂ∫¶ÁöÑË∞É‰ºò„ÄÇ<a href="https://docs.pingcap.com/zh/tidb/stable/dm-dml-replication-logic#compactor" target="_blank" rel="noreferrer">compact</a> ÊòØ‰∏Ä‰∏™Êñ∞ÂäüËÉΩÔºåÁî®‰∫éÂ∞Ü‰∏Ä‰∫õ DML ÂéãÁº©‰∏∫‰∏Ä‰∏™ DMLÔºåÂ¶Ç: <code>INSERT + UPDATE =&gt; INSERT</code>Ôºå <code>INSERT + DELETE =&gt; DELETE</code>Á≠â„ÄÇÊàë‰ª¨ÈÉΩÁü•ÈÅìÔºåÂÉè <code>insert into XXX values()Ôºå()‚Ä¶;</code> ËøôÊ†∑ÁöÑÊü•ËØ¢ÊØî <code>insert into XXX values();insert into XXX values();‚Ä¶</code> Âø´ÂæàÂ§ö„ÄÇ</p>
</li>
<li>
<p>ÂêåÊó∂Ôºå<code>Causality</code> ‰πü‰∏çÂÆπÂøΩËßÜÔºåÂõ†‰∏∫ËØ•ÂäüËÉΩÁî®‰∫éÊ£ÄÊµã DML ÂÜ≤Á™ÅÔºåËÄå‰∏ç‰ªÖ‰ªÖÊòØÊúâÂ∫èÂú∞Â§çÂà∂ DML„ÄÇÊõ¥Â§öÂÖ≥‰∫éÂõ†ÊûúÂÖ≥Á≥ªÂπ∂Ë°åÁÆóÊ≥ïÁöÑ‰ø°ÊÅØÔºåÂú®<a href="https://cn.pingcap.com/blog/tidb-binlog-source-code-reading-8#%E5%B9%B6%E8%A1%8C%E6%89%A7%E8%A1%8CDML" target="_blank" rel="noreferrer">Ëøô‰∏™ÂçöÂÆ¢</a>ÔºåÁÆÄËÄåË®Ä‰πãÔºåÊØè‰∏™‰∫ã‰ª∂Â∞ÜË¢´ PK Êàñ UK ÂàÜÊ¥æÂà∞‰∏çÂêåÁöÑ  <code>Âõ†ÊûúÂÖ≥Á≥ªÊ†ë</code>  ÁöÑÁªÑ‰∏≠ÔºåÂ¶ÇÊûúÂêé‰∏Ä‰∏™‰∫ã‰ª∂ÁöÑÂÖ≥ÈîÆÂ≠ó‰∏éÂâç‰∏Ä‰∏™ÊúâÂÜ≤Á™Å„ÄÇ‰æãÂ¶ÇÂÜ≤Á™ÅÂèØËÉΩÊòØ <code>Event-1: INSERT INTO table_name (pk, uk) VALUES(1,2);</code> Âíå <code>Event-4: DELETE FROM table_name WHERE pk = 1;</code> ÂøÖÈ°ªÊåâÊó∂Èó¥È°∫Â∫èÊâßË°åÔºåÂèç‰πã‰∫¶ÁÑ∂ÔºåÂ∞Ü‰ºöÊúâÂÜ≤Á™Å„ÄÇËøôÊ†∑ DM Â∞±ÂèØ‰ª•Âú®‰∏çÂêåÁöÑ  <code>Âõ†ÊûúÊ†ë</code>  ÁªÑ‰πãÈó¥ÂêåÊ≠•Âπ∂Ë°åÁöÑÊâßË°å DML„ÄÇÂõ†Ê≠§ÔºåÂ¶ÇÊûúÂõ†ÊûúÂÖ≥Á≥ªÊ£ÄÊµãÂà∞‰ªª‰ΩïÂÜ≤Á™ÅÔºåÂøÖÈ°ªÈ¶ñÂÖàÂ∞ÜÁªÑ‰∏≠Â∑≤ÁªèÂ≠òÂú®ÁöÑÊü•ËØ¢ÂêåÊ≠•Âà∞‰∏ãÊ∏∏(TiDBÈõÜÁæ§)„ÄÇ</p>
</li>
</ol>
<h2 id="syncddl" tabindex="-1">syncDDL <a class="header-anchor" href="#syncddl" aria-label="Permalink to &quot;syncDDL&quot;"></a></h2>
<ol>
<li>
<p>ÊÅïÊàëÁõ¥Ë®ÄÔºåËøôÂè™ÊòØ‰∏Ä‰∏™ dispath ÁªÑ‰ª∂ÂáΩÊï∞ÔºåÂÆÉÁöÑÁõÆÊ†áÊòØ DDL shard ÈÄªËæëÂíåËÆ∞ÂΩïÊåáÊ†á„ÄÇÂ¶ÇÊûúÈÖçÁΩÆ‰∏∫ <code>shard pessimism</code>Ôºå</p>
</li>
<li>
<p>Âú® <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/syncer.go#L1356" target="_blank" rel="noreferrer">func syncDDL</a>‰∏≠„ÄÇÂÆÉÂ∞ÜÊ£ÄÊü• <a href="https://docs.pingcap.com/tidb/stable/dm-shard-merge#configure-parameters" target="_blank" rel="noreferrer">shardMode</a> ÁöÑÈÖçÁΩÆÊ®°ÂºèÔºå‰ª•ÊâßË°åÂÆåÂÖ®‰∏çÂêåÁöÑË°å‰∏∫„ÄÇ ÂØπ‰∫éÊÇ≤ËßÇÊ®°ÂºèÔºåËØ∑Êü•Áúã<a href="#pessimist">ÂêåÊ≠•Âô®‰∏≠ÁöÑÊÇ≤ËßÇËÄÖÁªÑ‰ª∂</a>Âíå<a href="./03TiDB-DM Master.html">DM Masrer Pessmist ÁªÑ‰ª∂</a>„ÄÇËÄåÂØπ‰∫é‰πêËßÇ‰∏ª‰πâËÄÖÔºåËØ∑Áúã<a href="./03TiDB-DM Master.html">DM Masrer Optimist ÁªÑ‰ª∂</a>Âíå<a href="#optimist">syncer‰∏≠ÁöÑ‰πêËßÇ‰∏ª‰πâËÄÖÊàêÂàÜ</a>„ÄÇÊàëËÆ§‰∏∫ËøôÊòØÊï¥‰∏™ DM ‰∏≠ÊúÄÂ§çÊùÇÂíåÊúÄÈáçË¶ÅÁöÑÈÄªËæë„ÄÇ</p>
</li>
</ol>
<h2 id="ddlworker" tabindex="-1">DDLWorker <a class="header-anchor" href="#ddlworker" aria-label="Permalink to &quot;DDLWorker&quot;"></a></h2>
<ol>
<li>
<p>DDLWorker Âè™ÊòØ‰∏Ä‰∏™ÁªÑ‰ª∂Êù•ÂÅöÂÖ≥‰∫é DDL ÁöÑÂ∑•‰ΩúÔºå‰πüÊúâ‰∏Ä‰∫õÂÖ≥ÈîÆÂäüËÉΩÔºåÂ¶Ç <code>HandleQueryEvent</code>Ôºå <code>skipQueryEvent</code>Ôºå <code>processOneDDL</code> Âíå <code>handleDDL</code> ÁöÑÊ≠£Â∏∏ DDLÔºå‰πêËßÇ DDL ÂíåÊÇ≤ËßÇ DDL„ÄÇ</p>
</li>
<li>
<p>ËÄå <code>HandleQueryEvent</code> ËøûÊé•‰∫ÜÊàë‰∏äÈù¢ÊèêÂà∞ÁöÑÂáΩÊï∞„ÄÇÂÆÉÂ∞ÜËÆ∞ÂΩïÊåáÊ†áÔºåÂπ∂Ë¥üË¥£Â∞Ü‰∏Ä‰∏™ SQL ‰∏≠ÂéãÁº©ÁöÑÂ§ö‰∏™ DDL Á±ªÂûãÊãÜÂàÜ‰∏∫‰∏Ä‰∫õÂçï‰∏™ DDL„ÄÇÂõ†‰∏∫ÔºåÁõ¥Âà∞Áé∞Âú®ÔºåTiDBËøò‰∏çÊîØÊåÅ<a href="https://docs.pingcap.com/tidb/stable/dm-faq#if-a-statement-executed-upstream-contains-multiple-ddl-operations-does-dm-support-such-migration" target="_blank" rel="noreferrer">ÂêåÊó∂ÊâßË°åÂ§ö‰∏™ DDL</a>„ÄÇ</p>
</li>
</ol>
<h2 id="dmlworker" tabindex="-1">DMLWorker <a class="header-anchor" href="#dmlworker" aria-label="Permalink to &quot;DMLWorker&quot;"></a></h2>
<ol>
<li>
<p>Ê≠§Â§ñÔºå‰∏ªË¶ÅÂáΩÊï∞ÊòØ <code>dmlWorkerWrap</code> Ôºå <code>sendJobToAllDmlQueue</code> Ôºå <code>executeJobs</code> Ôºå <code>gensql</code> „ÄÇDMÊúâ‰∏Ä‰∏™Âêç‰∏∫<a href="https://docs.pingcap.com/zh/tidb/stable/dm-tune-configuration#worker-count" target="_blank" rel="noreferrer">worker-count</a>ÁöÑÈÖçÁΩÆÂèÇÊï∞ÔºåÂèØ‰ª•Âä†ÈÄüDMLÂ§çÂà∂ÈÄüÂ∫¶„ÄÇÂú® `dmlWorkerWrap '‰∏≠ÔºåËØ•Ê≠•È™§ÂàõÂª∫‰∫Üworker-countÁöÑÊï∞Èáè‰Ωú‰∏∫Âπ∂ÂèëÊù•ÂêåÊ≠•dml„ÄÇDMLË¢´ <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/dml_worker.go#L101" target="_blank" rel="noreferrer">func run</a> ‰∏≠ÁöÑ<a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/dml_worker.go#L138" target="_blank" rel="noreferrer">Hash ÊØè‰∏™DML Key</a>ÂàÜÂâ≤„ÄÇËøôÊ†∑ÔºåÊØè‰∏™ÈòüÂàó‰ª• <a href="https://docs.pingcap.com/tidb/stable/dm-tune-configuration#batch" target="_blank" rel="noreferrer">DM batch</a>ÂèÇÊï∞ÁöÑÊâπÂ§ÑÁêÜÊñπÂºèÊâßË°å„ÄÇÁÆÄËÄåË®Ä‰πãÔºåDMLWorkerÂ∞Ü‰Ωú‰∏öËΩ¨Êç¢‰∏∫SQLÂπ∂Â∞ÜÂÖ∂Âà∑Êñ∞Âà∞‰∏ãÊ∏∏„ÄÇ</p>
</li>
<li>
<p>‰Ω†ÂèØ‰ª•Âú®<a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/dml_worker.go#L33" target="_blank" rel="noreferrer">ËøôÈáå</a>ÊâæÂà∞Êõ¥Â§öÁªÜËäÇ„ÄÇ</p>
</li>
</ol>
<h2 id="checkpointworker" tabindex="-1">checkpointWorker <a class="header-anchor" href="#checkpointworker" aria-label="Permalink to &quot;checkpointWorker&quot;"></a></h2>
<ol>
<li>
<p>CheckPoint Ë°®Á§∫ Syncer ÁöÑÊ£ÄÊü•ÁÇπÁä∂ÊÄÅÔºåÂåÖÊã¨ÂÖ®Â±Ä binlog ÁöÑÊ£ÄÊü•ÁÇπÂíåÊØè‰∏™Ë°®ÁöÑÊ£ÄÊü•ÁÇπÔºåÂΩì‰øùÂ≠òÊ£ÄÊü•ÁÇπÊó∂ÔºåÊàë‰ª¨ÂøÖÈ°ªÂú®ÂÜÖÂ≠ò‰∏≠‰øùÂ≠òÔºåÂπ∂Â∞ÜÂÖ∂Ê∞∏‰πÖÂú∞‰øùÂ≠òÂà∞ DB(ÊàñÊñá‰ª∂)„ÄÇÂØπ‰∫éÂàÜÁâáÂêàÂπ∂ÔºåÂú®ÂÜÖÂ≠ò‰∏≠‰øùÂ≠òÊ£ÄÊü•ÁÇπÔºå‰ª•ÊîØÊåÅÈáçÊñ∞ÂêåÊ≠•ÁâπÊÆästreamer Êó∂ÁöÑË∑≥ËøáÔºå‰ΩÜÂú®‰∏Ä‰∏™ÂàÜÁâáÁªÑÁöÑÊâÄÊúâ ddl Ë¢´ÂêåÊ≠•ÂíåÊâßË°å‰πãÂâçÔºå‰∏çÂ∫îËØ•Ê∞∏‰πÖ‰øùÂ≠òÊ£ÄÊü•ÁÇπ„ÄÇÂõ†‰∏∫ÔºåÂΩìÈáçÊñ∞ÂêØÂä®‰ª•ÁªßÁª≠ÂêåÊ≠•Êó∂ÔºåÊâÄÊúâÂàÜÁâá ddl ÂøÖÈ°ªÂÜçÊ¨°Â∞ùËØïÂêåÊ≠•„ÄÇËøôÈáåÊúâ‰∏Ä‰∏™ÂÖ≥ÈîÆÁöÑ<a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/checkpoint.go#L227" target="_blank" rel="noreferrer">Êé•Âè£</a>Ôºå‰Ω†ÂèØ‰ª•Áü•ÈÅìÂÆÉÊòØÂ¶Ç‰ΩïÂ∑•‰ΩúÁöÑ„ÄÇ</p>
</li>
<li>
<p>Âú® Syncer ‰∏≠Ôºå<a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/syncer.go#L1187" target="_blank" rel="noreferrer">flushcheckpoint</a>Âíå<a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/syncer.go#L1223" target="_blank" rel="noreferrer">flushCheckPointsAsync</a>Ë∞ÉÁî® <code>checkpointFlushWorker.Add(task)</code> Â∞ÜÊ£ÄÊü•ÁÇπ‰ªªÂä°Êé®ÂÖ•checkpointWorker„ÄÇËøòÊúâ‰∏Ä‰∏™Âæ™ÁéØ <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/checkpoint_flush_worker.go#L91" target="_blank" rel="noreferrer">func Run</a>Êù•ÂàÜÊ¥æÂà∞ÂêåÊ≠•/ÂºÇÊ≠•ÈÄªËæë‰∏≠ÔºåÂπ∂‰ΩøÁî® FlushPointsExcept Ê∞∏‰πÖÂú∞Â∞ÜÂÖ®Â±Ä checkpint Âà∑Êñ∞Âà∞‰∏ãÊ∏∏Ê£ÄÊü•ÁÇπË°®‰∏≠„ÄÇÂà∞ÁõÆÂâç‰∏∫Ê≠¢ÔºåÂºÇÊ≠•Âà∑Êñ∞Ê£ÄÊü•ÁÇπËøòÊ≤°ÊúâÂèëÂ∏ÉÔºåÊõ¥Â§ö‰ø°ÊÅØËØ∑ËÆøÈóÆ<a href="https://github.com/pingcap/tiflow/blob/master/dm/docs/RFCS/20211012_async_checkpoint_flush.md" target="_blank" rel="noreferrer">RFC</a>„ÄÇ</p>
</li>
<li>
<p>ÈúÄË¶ÅÂà∑Êñ∞Ê£ÄÊü•ÁÇπÁöÑÂú∫ÊôØÊúâÂõõÁßç„ÄÇÂÖ∂‰∏≠‰∏ÄÂçäÂåÖÂê´Âú® <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/syncer.go#L1048" target="_blank" rel="noreferrer">func handleJob</a> ‰∏≠ÔºåÂè¶‰∏ÄÂçäÂåÖÂê´Âú® <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/syncer.go#L1654" target="_blank" rel="noreferrer">func Syncer.Run</a> ‰∏≠„ÄÇ<br>
a. <strong>DDLÊâßË°å</strong>: ÂΩì DM ‰∏≠ÊØè‰∏™ DDL ÈÉΩÂá∫Áé∞Êó∂ÔºåÂ∞ÜÂú®<a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/syncer.go#L1101-L1142" target="_blank" rel="noreferrer">func handleJob</a>Â§ÑËß¶ÂèëÂà∑Êñ∞Êìç‰Ωú„ÄÇ<br>
b. <strong>ÊöÇÂÅú/ÂÅúÊ≠¢ÂêåÊ≠•(Áî± <code>s.flushJobs</code> È©±Âä®)</strong>: Âú®ÈÄÄÂá∫ÂâçÂà∑Êñ∞ÊâÄÊúâ‰Ωú‰∏öÔºåÂú® <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/syncer.go#L1870" target="_blank" rel="noreferrer">func s.flushJobs()</a>‰∏≠ÔºåÊØèÂΩìÈÅáÂà∞ËØ•Âú∫ÊôØÔºåÊñ∞ÁöÑ flushJob Â∞±‰ºöÁîüÊàê„ÄÇÊàñËÄÖ‰ΩøÁî®<a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/syncer.go#L2174-L2203" target="_blank" rel="noreferrer">skip-errorÊñπÊ≥ï</a> Ëß£ÂÜ≥ÈîôËØØÊàñ‰∏≠Êñ≠ÁöÑ DM ÂêåÊ≠•Êó∂Ôºå‰πü‰ºöÂà∑Êñ∞„ÄÇ<br>
c. <strong>IsFreshTaskËøîÂõûtrue</strong>: Â¶ÇÊûústreamControllerÊàêÂäüÂêØÂä®ÊàñModeÈÖçÁΩÆ‰∏∫ <code>ALL</code>ÔºåÂàô‰ªéËΩ¨ÂÇ®ÂÖÉÊñá‰ª∂Âä†ËΩΩÁöÑÊ£ÄÊü•ÁÇπÂ∞ÜË¢´Âà∑Êñ∞„ÄÇ<br>
d. <strong>ÂøÉË∑≥‰∫ã‰ª∂Êî∂Âà∞</strong>: Âú® <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/syncer.go#L1030" target="_blank" rel="noreferrer">func flushifexpired</a>ÔºåÂΩìÊØè‰∏™‰∫ã‰ª∂‰ªéMySQL BinlogË¢´ÂàÜÊ¥æÂà∞DML‰Ωú‰∏öÈòüÂàóÔºå<a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/syncer.go#L2614" target="_blank" rel="noreferrer">ËøôÈáå</a>„ÄÇ</p>
</li>
<li>
<p>ÁÆÄËÄåË®Ä‰πãÔºåÊ£ÄÊü•ÁÇπÊòØ‰øùËØÅÊï∞ÊçÆÂ§çÂà∂ËøáÁ®ã‰∏≠ÊúÄÁªà‰∏ÄËá¥ÊÄßÁöÑÈáçË¶Å‰∏ÄÈ°π„ÄÇÊàëÁöÑÊÑèÊÄùÊòØÔºåÂ¶ÇÊûúÂá∫Áé∞‰ªª‰ΩïÈîôËØØÔºåDM ÂèØ‰ª•Âú®‰ªéÈîôËØØ‰∏≠ÊÅ¢Â§çÂêéÁªßÁª≠Â§çÂà∂„ÄÇ</p>
</li>
</ol>
]]></content:encoded>
            <enclosure url="https://askaric.com/images/tidb/05TiDB-EcosystematicTools/5-4DM/03-DM_Worker_Components.jpeg" length="0" type="image/jpeg"/>
        </item>
        <item>
            <title><![CDATA[Metrics]]></title>
            <link>https://askaric.com/zh/work/tidb/TiDB-EcosystematicTools/5-4DM/06TiDB-DM Metrics.html</link>
            <guid>https://askaric.com/zh/work/tidb/TiDB-EcosystematicTools/5-4DM/06TiDB-DM Metrics.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[# Metrics

## Overview

## operate error

## HA

1. **ÊØèÂàÜÈíüdm-masterÂêØÂä®È¢ÜÂØºÁªÑ‰ª∂ÁöÑÊï∞Èáè**  
    **a. Âê´‰πâ** : ÊØèÂàÜÈíüdm-masterÂ∞ùËØïÂêØÂä®leaderÁªÑ‰ª∂ÁöÑ‰∏™Êï∞
    **b. ËÆ°ÁÆó** :

## task

## load dump files

## binlog replication

1. **remaining time to sync**  
    **a. Meaning** :  
    **b. Colculation** : it's calculated by expr below:  

    ```yaml
                        remainingSize =
    remainingSeconds = ]]></description>
            <content:encoded><![CDATA[<h1 id="metrics" tabindex="-1">Metrics <a class="header-anchor" href="#metrics" aria-label="Permalink to &quot;Metrics&quot;"></a></h1>
<h2 id="overview" tabindex="-1">Overview <a class="header-anchor" href="#overview" aria-label="Permalink to &quot;Overview&quot;"></a></h2>
<h2 id="operate-error" tabindex="-1">operate error <a class="header-anchor" href="#operate-error" aria-label="Permalink to &quot;operate error&quot;"></a></h2>
<h2 id="ha" tabindex="-1">HA <a class="header-anchor" href="#ha" aria-label="Permalink to &quot;HA&quot;"></a></h2>
<ol>
<li><strong>ÊØèÂàÜÈíüdm-masterÂêØÂä®È¢ÜÂØºÁªÑ‰ª∂ÁöÑÊï∞Èáè</strong><br>
<strong>a. Âê´‰πâ</strong> : ÊØèÂàÜÈíüdm-masterÂ∞ùËØïÂêØÂä®leaderÁªÑ‰ª∂ÁöÑ‰∏™Êï∞
<strong>b. ËÆ°ÁÆó</strong> :</li>
</ol>
<h2 id="task" tabindex="-1">task <a class="header-anchor" href="#task" aria-label="Permalink to &quot;task&quot;"></a></h2>
<h2 id="load-dump-files" tabindex="-1">load dump files <a class="header-anchor" href="#load-dump-files" aria-label="Permalink to &quot;load dump files&quot;"></a></h2>
<h2 id="binlog-replication" tabindex="-1">binlog replication <a class="header-anchor" href="#binlog-replication" aria-label="Permalink to &quot;binlog replication&quot;"></a></h2>
<ol>
<li>
<p><strong>remaining time to sync</strong><br>
<strong>a. Meaning</strong> :<br>
<strong>b. Colculation</strong> : it's calculated by expr below:</p>
<div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                    remainingSize =</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">remainingSeconds = ---------------------------------------------------------------</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                    bytesPerSec  =  (totalBinlogSize - lastBinlogSize) / seconds</span></span></code></pre>
</div></li>
<li>
<p><strong>replicate lag</strong><br>
<strong>a. Meaning</strong> : The latency time it takes to replicate the binlog from master to Syncer (in seconds)<br>
<strong>b. Colculation</strong> : In this <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/syncer.go#L890" target="_blank" rel="noreferrer">func updateReplicationLagMetric</a>, the metric is updated by ticking per 100ms. the <code>lag</code> is calculated in an expression of <code>time.Now().Unix() - s.tsOffset.Load() - headerTS</code>. which <code>tsOffset</code> represents time range between upstream and syncer, DM's timestamp - MySQL's timestamp, and <code>headerTS</code> is minior timestamp,which is binlog <code>EventHeader Timestamp</code> parsed by <a href="https://github.com/go-mysql-org/go-mysql/tree/master/replication" target="_blank" rel="noreferrer">go-mysql-org/go-mysql/replication</a>, of every DM worker MySQL.</p>
</li>
<li>
<p><strong>process exits with error</strong><br>
<strong>a. Meaning</strong> : The binlog replication unit process encounters an error within the DM-worker and exits<br>
<strong>b. Colculation</strong> : 1</p>
</li>
<li>
<p><strong>binlog file gap between master and syncer</strong><br>
<strong>a. Meaning</strong> : The number of binlog files in binlog replication unit that are behind the master.<br>
<strong>b. Colculation</strong> : <strong>For <code>master</code></strong>,</p>
</li>
<li>
<p><strong>binlog file gap between relay and syncer</strong></p>
</li>
<li>
<p><strong>binlog event QPS</strong></p>
</li>
<li>
<p><strong>skipped binlog event QPS</strong></p>
</li>
<li>
<p><strong>read binlog event duration</strong></p>
</li>
<li>
<p><strong>transform binlog event duration</strong><br>
<strong>a. Meaning</strong> : The time it takes binlog replication unit to parse and transform the binlog into SQL statements (in seconds)<br>
<strong>b. Colculation</strong> : At <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/syncer.go#L1504" target="_blank" rel="noreferrer">func successFunc</a>, every job will have calculated the duration in DDLWorker and DMLWorker executing <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/dml_worker.go#L200" target="_blank" rel="noreferrer">func executeBatchJobs</a>, since raw binlog had tranformed into Syncer dealing loop function. And It has 90%, 95% and 99% quantile curve.</p>
</li>
<li>
<p><strong>dispatch binlog event duration</strong></p>
</li>
<li>
<p><strong>transaction execution latency</strong></p>
</li>
<li>
<p><strong>binlog event size</strong><br>
<strong>a. Meaning</strong> : The size of a single binlog event that the binlog replication unit reads from relay log or upstream master.<br>
<strong>b. Colculation</strong> : At <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/syncer.go#L2159" target="_blank" rel="noreferrer">here</a>, Syncer'll record every binlog event_size in event header from <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/binlogstream/streamer_controller.go#L131" target="_blank" rel="noreferrer">binlogstream</a>. So, in grafana, DM uses a type of histogram to draw a quantile curve, including 90%, 95%, 99%.</p>
</li>
<li>
<p><strong>DML queue remain length</strong><br>
<strong>a. Meaning</strong> : The remain length of DML job queues, which have <code>causality_input</code>, <code>compactor_input</code>, <code>dml_worker_input</code>, <code>q_number</code>,number is calculated in <code>queueID%defaultBucketCount</code>.<br>
<strong>b. Colculation</strong> : <strong>For <code>causality_input</code></strong> : Causality provides a simple mechanism to improve the concurrency of SQLs execution under the premise of ensuring correctness, which groups sqls that maybe contain causal relationships, and syncer executes them linearly, <a href="https://github.com/pingcap/tiflow/blob/211e6e7d5fa0944d1f5e0ad585cb8549d5604395/dm/docs/RFCS/20211012_async_checkpoint_flush.md#causality-optimization" target="_blank" rel="noreferrer">more details</a>. So, it records the number of causality component is keeping about rows.  <strong>For <code>dml_worker_input</code></strong> : which means how many jobs were sent to DMWorker. <strong>For <code>compactor_input</code></strong> : it'll equal to the function of causality_input if you config <a href="https://docs.pingcap.com/zh/tidb/v6.6/dm-dml-replication-logic#compactor" target="_blank" rel="noreferrer">this feature</a>. <strong>For <code>q_number</code></strong> : all DMLs at <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/dml_worker.go#L100" target="_blank" rel="noreferrer">here</a> will be distributed into different queues(default 8) and when they are executed in <a href="https://github.com/pingcap/tiflow/blob/c65e2b72198de10319008b31dcf13d51509ccfde/dm/syncer/dml_worker.go#L159" target="_blank" rel="noreferrer">DMLWorker's executeJobs</a>, it'll be recorded by the queue name.</p>
</li>
</ol>
<h2 id="relay-log" tabindex="-1">relay log <a class="header-anchor" href="#relay-log" aria-label="Permalink to &quot;relay log&quot;"></a></h2>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[TiDB-Binlog ‰∏é Reparo ÂéüÁêÜÁÆÄ‰ªã‰∏éÈÉ®ÁΩ≤‰ΩøÁî®]]></title>
            <link>https://askaric.com/zh/work/tidb/TiDB-EcosystematicTools/5-6Binlog/01BinlogÂèäReparoÂéüÁêÜ‰∏é‰ΩøÁî®.html</link>
            <guid>https://askaric.com/zh/work/tidb/TiDB-EcosystematicTools/5-6Binlog/01BinlogÂèäReparoÂéüÁêÜ‰∏é‰ΩøÁî®.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[# TiDB-Binlog ‰∏é Reparo ÂéüÁêÜÁÆÄ‰ªã‰∏éÈÉ®ÁΩ≤‰ΩøÁî®


> - [BinlogÂéüÁêÜÁÆÄ‰ªã](#BinlogÂéüÁêÜÁÆÄ‰ªã)
> - [‰∏ãËΩΩÈÉ®ÁΩ≤](#‰∏ãËΩΩÈÉ®ÁΩ≤)
> - [ÈÖçÁΩÆpump‰∏édrainer](#ÈÖçÁΩÆpump‰∏édrainer)
> - [BinlogÂêØÂä®‰∏éÈ™åËØÅ](#BinlogÂêØÂä®‰∏éÈ™åËØÅ)   
> - [checkpoint‰∏ÄËá¥ÊÄßÊ£ÄÊü•](#checkpoint‰∏ÄËá¥ÊÄßÊ£ÄÊü•)   
> - [Binlog-RelaylogÂêØÂä®‰∏éÈ™åËØÅ](#Binlog-RelaylogÂêØÂä®‰∏éÈ™åËØÅ)  
> - [BRÈÖçÂêàTiDB-BinlogÂÆûÁé∞Â¢ûÈáèÂ§á‰ªΩ](#BRÈÖçÂêàTiDB-BinlogÂÆûÁé∞Â¢ûÈáèÂ§á‰ªΩ)  
>    - [ÂºÇÂ∏∏ÊÉÖÂÜµ‰∏ã‰øÆÊîπPump/DrainerÁä∂ÊÄÅ](#ÂºÇÂ∏∏ÊÉÖÂÜµ‰∏ã‰øÆÊîπPump/DrainerÁä∂ÊÄÅ)   
> - [binlogctlÂ∑•ÂÖ∑ÁöÑ‰∏ãËΩΩ‰∏é‰ΩøÁî®](#binlogctlÂ∑•ÂÖ∑ÁöÑ‰∏ãËΩΩ‰∏é‰ΩøÁî®)   
>    - [Â∑•ÂÖ∑ÁöÑ‰∏ãËΩΩÈÉ®ÁΩ≤](#Â∑•ÂÖ∑ÁöÑ‰∏ãËΩΩÈÉ®ÁΩ≤)   
>    - [Â∑•ÂÖ∑ÁöÑ‰ΩøÁî®](#Â∑•ÂÖ∑ÁöÑ‰ΩøÁî®)   
> - [BRÈÖçÂêàTiDB-BinlogÂÆûÁé∞Â¢ûÈáèÂ§á‰ªΩ](#BRÈÖçÂêàTiDB-BinlogÂÆûÁé∞Â¢ûÈáèÂ§á‰ªΩ)   
>    - [ÁéØÂ¢É‰∏éÊï∞ÊçÆÂáÜÂ§á](#ÁéØÂ¢É‰∏éÊï∞ÊçÆÂáÜÂ§á)   
>    - [BRÂÖ®ÈáèÂ§á‰ªΩ](#BRÂÖ®ÈáèÂ§á‰ªΩ)   
>    - [Á†¥ÂùèÊÄßÂà†Â∫ì](#Á†¥ÂùèÊÄßÂà†Â∫ì)   
>    - [BRÂÖ®ÈáèÊÅ¢Â§ç](#BRÂÖ®ÈáèÊÅ¢Â§ç)  
>    - [ReparoÂü∫‰∫éÊó∂Èó¥ÁÇπÂ¢ûÈáèÊÅ¢Â§ç](#ReparoÂü∫‰∫éÊó∂Èó¥ÁÇπÂ¢ûÈáèÊÅ¢Â§ç)  
>    - [È™åËØÅÂü∫‰∫éÊó∂Èó¥ÁÇπÊÅ¢Â§çÊ≠£Á°ÆÊÄß](#È™åËØÅÂü∫‰∫éÊó∂Èó¥ÁÇπÊÅ¢Â§çÊ≠£Á°ÆÊÄß)   
> - [ÂèÇËÄÉÊñáÁ´†](#ÂèÇËÄÉÊñáÁ´†)   






## BinlogÂéüÁêÜÁÆÄ‰ªã

![TiDB Binlog Êï¥‰ΩìÊû∂ÊûÑ](https://download.pingcap.com/images/docs-cn/tidb-binlog-cluster-architecture.png)

 - TiDB Binlog ÊîØÊåÅ‰ª•‰∏ãÂäüËÉΩÂú∫ÊôØ   
    - Êï∞ÊçÆÂêåÊ≠•ÔºöÂêåÊ≠• TiDB ÈõÜÁæ§Êï∞ÊçÆÂà∞ÂÖ∂‰ªñÊï∞ÊçÆÂ∫ì   
    - ÂÆûÊó∂Â§á‰ªΩÂíåÊÅ¢Â§çÔºöÂ§á‰ªΩ TiDB ÈõÜÁæ§Êï∞ÊçÆÔºåÂêåÊó∂ÂèØ‰ª•Áî®‰∫é TiDB ÈõÜÁæ§ÊïÖÈöúÊó∂ÊÅ¢Â§ç   

 - Pump: Áî®‰∫éÂÆûÊó∂ËÆ∞ÂΩï TiDB ‰∫ßÁîüÁöÑ BinlogÔºåÂπ∂Â∞Ü Binlog ÊåâÁÖß‰∫ãÂä°ÁöÑÊèê‰∫§Êó∂Èó¥ËøõË°åÊéíÂ∫èÔºåÂÜçÊèê‰æõÁªô Drainer ËøõË°åÊ∂àË¥π     
 - Drainer: ‰ªéÂêÑ‰∏™ Pump ‰∏≠Êî∂ÈõÜ Binlog ËøõË°åÂΩíÂπ∂ÔºåÂÜçÂ∞Ü Binlog ËΩ¨ÂåñÊàê SQL ÊàñËÄÖÊåáÂÆöÊ†ºÂºèÁöÑÊï∞ÊçÆÔºåÊúÄÁªàÂêåÊ≠•Âà∞‰∏ãÊ∏∏   

## ‰∏ãËΩΩÈÉ®ÁΩ≤
 - pump‰∏édrainer
```
[tidb@tiup-tidb41 binlogctl]$ tiup install ÁªÑ‰ª∂ÂêçÁß∞

[tidb@tiup-tidb41 binlogctl]$ tiup list --installed
Available components:
Name            Owner    Description
]]></description>
            <content:encoded><![CDATA[<h1 id="tidb-binlog-‰∏é-reparo-ÂéüÁêÜÁÆÄ‰ªã‰∏éÈÉ®ÁΩ≤‰ΩøÁî®" tabindex="-1">TiDB-Binlog ‰∏é Reparo ÂéüÁêÜÁÆÄ‰ªã‰∏éÈÉ®ÁΩ≤‰ΩøÁî® <a class="header-anchor" href="#tidb-binlog-‰∏é-reparo-ÂéüÁêÜÁÆÄ‰ªã‰∏éÈÉ®ÁΩ≤‰ΩøÁî®" aria-label="Permalink to &quot;TiDB-Binlog ‰∏é Reparo ÂéüÁêÜÁÆÄ‰ªã‰∏éÈÉ®ÁΩ≤‰ΩøÁî®&quot;"></a></h1>
<blockquote>
<ul>
<li><a href="#BinlogÂéüÁêÜÁÆÄ‰ªã">BinlogÂéüÁêÜÁÆÄ‰ªã</a></li>
<li><a href="#‰∏ãËΩΩÈÉ®ÁΩ≤">‰∏ãËΩΩÈÉ®ÁΩ≤</a></li>
<li><a href="#ÈÖçÁΩÆpump‰∏édrainer">ÈÖçÁΩÆpump‰∏édrainer</a></li>
<li><a href="#BinlogÂêØÂä®‰∏éÈ™åËØÅ">BinlogÂêØÂä®‰∏éÈ™åËØÅ</a></li>
<li><a href="#checkpoint‰∏ÄËá¥ÊÄßÊ£ÄÊü•">checkpoint‰∏ÄËá¥ÊÄßÊ£ÄÊü•</a></li>
<li><a href="#Binlog-RelaylogÂêØÂä®‰∏éÈ™åËØÅ">Binlog-RelaylogÂêØÂä®‰∏éÈ™åËØÅ</a></li>
<li><a href="#BRÈÖçÂêàTiDB-BinlogÂÆûÁé∞Â¢ûÈáèÂ§á‰ªΩ">BRÈÖçÂêàTiDB-BinlogÂÆûÁé∞Â¢ûÈáèÂ§á‰ªΩ</a>
<ul>
<li><a href="#ÂºÇÂ∏∏ÊÉÖÂÜµ‰∏ã‰øÆÊîπPump/DrainerÁä∂ÊÄÅ">ÂºÇÂ∏∏ÊÉÖÂÜµ‰∏ã‰øÆÊîπPump/DrainerÁä∂ÊÄÅ</a></li>
</ul>
</li>
<li><a href="#binlogctlÂ∑•ÂÖ∑ÁöÑ‰∏ãËΩΩ‰∏é‰ΩøÁî®">binlogctlÂ∑•ÂÖ∑ÁöÑ‰∏ãËΩΩ‰∏é‰ΩøÁî®</a>
<ul>
<li><a href="#Â∑•ÂÖ∑ÁöÑ‰∏ãËΩΩÈÉ®ÁΩ≤">Â∑•ÂÖ∑ÁöÑ‰∏ãËΩΩÈÉ®ÁΩ≤</a></li>
<li><a href="#Â∑•ÂÖ∑ÁöÑ‰ΩøÁî®">Â∑•ÂÖ∑ÁöÑ‰ΩøÁî®</a></li>
</ul>
</li>
<li><a href="#BRÈÖçÂêàTiDB-BinlogÂÆûÁé∞Â¢ûÈáèÂ§á‰ªΩ">BRÈÖçÂêàTiDB-BinlogÂÆûÁé∞Â¢ûÈáèÂ§á‰ªΩ</a>
<ul>
<li><a href="#ÁéØÂ¢É‰∏éÊï∞ÊçÆÂáÜÂ§á">ÁéØÂ¢É‰∏éÊï∞ÊçÆÂáÜÂ§á</a></li>
<li><a href="#BRÂÖ®ÈáèÂ§á‰ªΩ">BRÂÖ®ÈáèÂ§á‰ªΩ</a></li>
<li><a href="#Á†¥ÂùèÊÄßÂà†Â∫ì">Á†¥ÂùèÊÄßÂà†Â∫ì</a></li>
<li><a href="#BRÂÖ®ÈáèÊÅ¢Â§ç">BRÂÖ®ÈáèÊÅ¢Â§ç</a></li>
<li><a href="#ReparoÂü∫‰∫éÊó∂Èó¥ÁÇπÂ¢ûÈáèÊÅ¢Â§ç">ReparoÂü∫‰∫éÊó∂Èó¥ÁÇπÂ¢ûÈáèÊÅ¢Â§ç</a></li>
<li><a href="#È™åËØÅÂü∫‰∫éÊó∂Èó¥ÁÇπÊÅ¢Â§çÊ≠£Á°ÆÊÄß">È™åËØÅÂü∫‰∫éÊó∂Èó¥ÁÇπÊÅ¢Â§çÊ≠£Á°ÆÊÄß</a></li>
</ul>
</li>
<li><a href="#ÂèÇËÄÉÊñáÁ´†">ÂèÇËÄÉÊñáÁ´†</a></li>
</ul>
</blockquote>
<h2 id="binlogÂéüÁêÜÁÆÄ‰ªã" tabindex="-1">BinlogÂéüÁêÜÁÆÄ‰ªã <a class="header-anchor" href="#binlogÂéüÁêÜÁÆÄ‰ªã" aria-label="Permalink to &quot;BinlogÂéüÁêÜÁÆÄ‰ªã&quot;"></a></h2>
<figure><img src="https://download.pingcap.com/images/docs-cn/tidb-binlog-cluster-architecture.png" alt="TiDB Binlog Êï¥‰ΩìÊû∂ÊûÑ" tabindex="0"><figcaption>TiDB Binlog Êï¥‰ΩìÊû∂ÊûÑ</figcaption></figure>
<ul>
<li>
<p>TiDB Binlog ÊîØÊåÅ‰ª•‰∏ãÂäüËÉΩÂú∫ÊôØ</p>
<ul>
<li>Êï∞ÊçÆÂêåÊ≠•ÔºöÂêåÊ≠• TiDB ÈõÜÁæ§Êï∞ÊçÆÂà∞ÂÖ∂‰ªñÊï∞ÊçÆÂ∫ì</li>
<li>ÂÆûÊó∂Â§á‰ªΩÂíåÊÅ¢Â§çÔºöÂ§á‰ªΩ TiDB ÈõÜÁæ§Êï∞ÊçÆÔºåÂêåÊó∂ÂèØ‰ª•Áî®‰∫é TiDB ÈõÜÁæ§ÊïÖÈöúÊó∂ÊÅ¢Â§ç</li>
</ul>
</li>
<li>
<p>Pump: Áî®‰∫éÂÆûÊó∂ËÆ∞ÂΩï TiDB ‰∫ßÁîüÁöÑ BinlogÔºåÂπ∂Â∞Ü Binlog ÊåâÁÖß‰∫ãÂä°ÁöÑÊèê‰∫§Êó∂Èó¥ËøõË°åÊéíÂ∫èÔºåÂÜçÊèê‰æõÁªô Drainer ËøõË°åÊ∂àË¥π</p>
</li>
<li>
<p>Drainer: ‰ªéÂêÑ‰∏™ Pump ‰∏≠Êî∂ÈõÜ Binlog ËøõË°åÂΩíÂπ∂ÔºåÂÜçÂ∞Ü Binlog ËΩ¨ÂåñÊàê SQL ÊàñËÄÖÊåáÂÆöÊ†ºÂºèÁöÑÊï∞ÊçÆÔºåÊúÄÁªàÂêåÊ≠•Âà∞‰∏ãÊ∏∏</p>
</li>
</ul>
<h2 id="‰∏ãËΩΩÈÉ®ÁΩ≤" tabindex="-1">‰∏ãËΩΩÈÉ®ÁΩ≤ <a class="header-anchor" href="#‰∏ãËΩΩÈÉ®ÁΩ≤" aria-label="Permalink to &quot;‰∏ãËΩΩÈÉ®ÁΩ≤&quot;"></a></h2>
<ul>
<li>pump‰∏édrainer</li>
</ul>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tiup-tidb41 binlogctl]$ tiup install ÁªÑ‰ª∂ÂêçÁß∞</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[tidb@tiup-tidb41 binlogctl]$ tiup list --installed</span></span>
<span class="line"><span>Available components:</span></span>
<span class="line"><span>Name            Owner    Description</span></span>
<span class="line"><span>----            -----    -----------</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>drainer         pingcap  The drainer componet of TiDB binlog service</span></span>
<span class="line"><span>pump            pingcap  The pump componet of TiDB binlog service</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>......</span></span></code></pre>
</div><ul>
<li>reparo
<a href="https://download.pingcap.org/tidb-binlog-cluster-latest-linux-amd64.tar.gz" target="_blank" rel="noreferrer"><strong>‰∏ãËΩΩÈìæÊé•</strong></a></li>
</ul>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span> wget https://download.pingcap.org/tidb-binlog-cluster-latest-linux-amd64.tar.gz</span></span></code></pre>
</div><h2 id="ÈÖçÁΩÆpump‰∏édrainer" tabindex="-1">ÈÖçÁΩÆpump‰∏édrainer <a class="header-anchor" href="#ÈÖçÁΩÆpump‰∏édrainer" aria-label="Permalink to &quot;ÈÖçÁΩÆpump‰∏édrainer&quot;"></a></h2>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">vim</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> binglog-scale-out.yaml</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">pump_servers:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> host:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 192.168.169.41</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    ssh_port:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 22</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    port:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 8250</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    deploy_dir:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "/data/tidb-deploy/pump-8250"</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    data_dir:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "/data/tidb-data/pump-8250"</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    log_dir:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "/data/tidb-deploy/pump-8250/log"</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    numa_node:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "0"</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    # The following configs are used to overwrite the `server_configs.drainer` values.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    config:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">      gc:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 7</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> host:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 192.168.169.42</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    ssh_port:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 22</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    port:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 8250</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    deploy_dir:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "/data/tidb-deploy/pump-8250"</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    data_dir:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "/data/tidb-data/pump-8250"</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    log_dir:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "/data/tidb-deploy/pump-8250/log"</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    numa_node:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "0"</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> host:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 192.168.169.43</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    ssh_port:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 22</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    port:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 8250</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    deploy_dir:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "/data/tidb-deploy/pump-8250"</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    data_dir:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "/data/tidb-data/pump-8250"</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    log_dir:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "/data/tidb-deploy/pump-8250/log"</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    numa_node:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "0"</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">drainer_servers:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> host:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 192.168.169.44</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    port:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 8249</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    data_dir:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "/data/tidb-data/drainer-8249"</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    # If drainer doesn't have a checkpoint, use initial commitTS as the initial checkpoint.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    # Will get a latest timestamp from pd if commit_ts is set to -1 (the default value).</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    commit_ts:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    deploy_dir:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "/data/tidb-deploy/drainer-8249"</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    log_dir:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "/data/tidb-deploy/drainer-8249/log"</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    numa_node:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "0"</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">#     # The following configs are used to overwrite the `server_configs.drainer` values.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    config:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">      syncer.db-type:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "mysql"</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">      syncer.to.host:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "192.168.169.45"</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">      syncer.to.user:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "root"</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">      syncer.to.password:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "123123"</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">      syncer.to.port:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 3306</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 pump]$ tiup cluster scale-out tidb-test binglog-scale-out.yaml --wait-timeout 10000000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> component</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /home/tidb/.tiup/components/cluster/v1.3.1/tiup-cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> scale-out</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-test</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> binglog-scale-out.yaml</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --wait-timeout</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 10000000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Please</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> confirm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> your</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> topology:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> type:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    tidb</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [ </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">Serial</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ]</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> UpdateTopology:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> cluster=tidb-test</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Scaled</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tidb-test</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> out</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> successfully</span></span></code></pre>
</div><h2 id="binlogÂêØÂä®‰∏éÈ™åËØÅ" tabindex="-1">BinlogÂêØÂä®‰∏éÈ™åËØÅ <a class="header-anchor" href="#binlogÂêØÂä®‰∏éÈ™åËØÅ" aria-label="Permalink to &quot;BinlogÂêØÂä®‰∏éÈ™åËØÅ&quot;"></a></h2>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">MySQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [(none)]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> show variables like </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"log_bin"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+---------------+-------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Variable_name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+---------------+-------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> log_bin</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">       |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> 0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">     |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+---------------+-------+</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">MySQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [(none)]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> show pump status;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+---------------------+---------------------+--------+--------------------+---------------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> NodeID</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">              |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Address</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">             |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> State</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Max_Commit_Ts</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Update_Time</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">         |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+---------------------+---------------------+--------+--------------------+---------------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> 192.168.169.41:8250</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> 192.168.169.41:8250</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> online</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> 422310029132038145</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> 2021-01-18</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 10:48:33</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> 192.168.169.42:8250</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> 192.168.169.42:8250</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> online</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> 422310029105561601</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> 2021-01-18</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 10:48:33</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> 192.168.169.43:8250</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> 192.168.169.43:8250</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> online</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> 422310028725452801</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> 2021-01-18</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 10:48:33</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+---------------------+---------------------+--------+--------------------+---------------------+</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">MySQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [(none)]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> show drainer status;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+---------------------+---------------------+--------+--------------------+---------------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> NodeID</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">              |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Address</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">             |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> State</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Max_Commit_Ts</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Update_Time</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">         |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+---------------------+---------------------+--------+--------------------+---------------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> 192.168.169.44:8249</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> 192.168.169.44:8249</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> online</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> 422310030704640001</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> 2021-01-18</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 10:48:44</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+---------------------+---------------------+--------+--------------------+---------------------+</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ tiup cluster edit-config tidb-test</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">server_configs:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  tidb:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    binlog.enable:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    binlog.ignore-error:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> true</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ tiup cluster reload tidb-test -R tidb</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> component</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /home/tidb/.tiup/components/cluster/v1.3.1/tiup-cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> reload</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-test</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -R</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Reloaded</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tidb-test</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> successfully</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">MySQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [(none)]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> show variables like </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"log_bin"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+---------------+-------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Variable_name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+---------------+-------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> log_bin</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">       |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">     |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+---------------+-------+</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">MySQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [(none)]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> show pump status;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+---------------------+---------------------+--------+--------------------+---------------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> NodeID</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">              |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Address</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">             |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> State</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Max_Commit_Ts</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Update_Time</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">         |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+---------------------+---------------------+--------+--------------------+---------------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> 192.168.169.41:8250</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> 192.168.169.41:8250</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> online</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> 422310865001250817</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> 2021-01-18</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 11:41:42</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> 192.168.169.42:8250</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> 192.168.169.42:8250</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> online</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> 422310864476962817</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> 2021-01-18</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 11:41:42</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> 192.168.169.43:8250</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> 192.168.169.43:8250</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> online</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> 422310864752214017</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> 2021-01-18</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 11:41:42</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+---------------------+---------------------+--------+--------------------+---------------------+</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">MySQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [(none)]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> show drainer status;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+---------------------+---------------------+--------+--------------------+---------------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> NodeID</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">              |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Address</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">             |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> State</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Max_Commit_Ts</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Update_Time</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">         |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+---------------------+---------------------+--------+--------------------+---------------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> 192.168.169.44:8249</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> 192.168.169.44:8249</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> online</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> 422310865787682817</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> 2021-01-18</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 11:41:48</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+---------------------+---------------------+--------+--------------------+---------------------+</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># ‰∏äÊ∏∏ TiDB Á´ØÊ£ÄÊü•</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">MySQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [(none)]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> create database test 234;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">MySQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [(none)]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> show databases;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+--------------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Database</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">           |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+--------------------+</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> test234</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">            |</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+--------------------+</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">MySQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [test234]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> insert into t values(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">1,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">'t_1'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">MySQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [test234]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> * from t;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+----+------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+----+------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> t_1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+----+------+</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># ‰∏ãÊ∏∏ MySQL Á´ØÊ£ÄÊü•</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">show</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> databases</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+--------------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Database</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">           |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+--------------------+</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> test234</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">            |</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+--------------------+</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">select</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> *</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> test234.t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+----+------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+----+------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> t_1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">+----+------+</span></span></code></pre>
</div><h2 id="checkpoint‰∏ÄËá¥ÊÄßÊ£ÄÊü•" tabindex="-1">checkpoint‰∏ÄËá¥ÊÄßÊ£ÄÊü• <a class="header-anchor" href="#checkpoint‰∏ÄËá¥ÊÄßÊ£ÄÊü•" aria-label="Permalink to &quot;checkpoint‰∏ÄËá¥ÊÄßÊ£ÄÊü•&quot;"></a></h2>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>mysql> select  * from tidb_binlog.checkpoint;</span></span>
<span class="line"><span>+---------------------+----------------------------------------------------------------+</span></span>
<span class="line"><span>| clusterID           | checkPoint                                                     |</span></span>
<span class="line"><span>+---------------------+----------------------------------------------------------------+</span></span>
<span class="line"><span>| 6915787285265719754 | {"consistent":false,"commitTS":422311266750300163,"ts-map":{}} |</span></span>
<span class="line"><span>+---------------------+----------------------------------------------------------------+</span></span></code></pre>
</div><ul>
<li>tidb_binlog.checkpoint ÁöÑÂ≠òÂÇ®‰ΩçÁΩÆ</li>
<li>tidb-binlog ÁöÑ pumpÔºådrianer ÂêÑ‰∏™ÁªÑ‰ª∂Áä∂ÊÄÅÂùá‰∏∫ÂêØÂä®Áä∂ÊÄÅÊâç‰ºöÊúâ tidb_binlog.checkpoint</li>
<li>mysql/tidb ÈÇ£‰πà tidb_binlog.checkpoint Ë°®‰øùÂ≠òÂú®Ë¢´ÂêåÊ≠•ÁöÑÁõÆÊ†á‰∏ãÊ∏∏ mysql/tidb ‰∏≠</li>
<li>Â¶ÇÊûúÊòØ file ÈÇ£‰πàËØ•‰ø°ÊÅØ‰øùÂ≠òÂú®Êú¨Âú∞Êñá‰ª∂Á≥ªÁªü‰∏≠</li>
</ul>
<h2 id="binlog-relaylogÂêØÂä®‰∏éÈ™åËØÅ" tabindex="-1">Binlog-RelaylogÂêØÂä®‰∏éÈ™åËØÅ <a class="header-anchor" href="#binlog-relaylogÂêØÂä®‰∏éÈ™åËØÅ" aria-label="Permalink to &quot;Binlog-RelaylogÂêØÂä®‰∏éÈ™åËØÅ&quot;"></a></h2>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ tiup cluster edit-config tidb-test</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> component</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /home/tidb/.tiup/components/cluster/v1.3.1/tiup-cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> edit-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-test</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ tiup cluster edit-config tidb-test</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">drainer_servers:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    syncer.relay.log-dir:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /data/tidb-data/drainer-8249/relay_log</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    syncer.relay.max-file-size:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 10485760</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Please</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> check</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> change</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> highlight</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> above,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> do</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> you</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> want</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> apply</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> change?</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [y/N]: y</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Applying</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> changes...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Applied</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> successfully,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> please</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> use</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tiup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> cluster reload tidb-test [-N </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">&#x3C;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">nodes</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">] [-R </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">&#x3C;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">roles</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">]`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> reload</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> config.</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Drainer Á´ØÈ™åËØÅ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 bin]$ tiup cluster reload tidb-test -R drainer</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> component</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /home/tidb/.tiup/components/cluster/v1.3.1/tiup-cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> reload</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-test</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -R</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Reloaded</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tidb-test</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> successfully</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[root@tiup-tidb44 relay_log]# pwd</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">/data/tidb-data/drainer-8249/relay_log</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[root@tiup-tidb44 relay_log]# ll</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">total</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">-rw-------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Jan</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 18</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 12:57</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> binlog-0000000000000000-20210118125724</span></span></code></pre>
</div><h4 id="ÂºÇÂ∏∏ÊÉÖÂÜµ‰∏ã‰øÆÊîπpump-drainerÁä∂ÊÄÅ" tabindex="-1">ÂºÇÂ∏∏ÊÉÖÂÜµ‰∏ã‰øÆÊîπPump/DrainerÁä∂ÊÄÅ <a class="header-anchor" href="#ÂºÇÂ∏∏ÊÉÖÂÜµ‰∏ã‰øÆÊîπpump-drainerÁä∂ÊÄÅ" aria-label="Permalink to &quot;ÂºÇÂ∏∏ÊÉÖÂÜµ‰∏ã‰øÆÊîπPump/DrainerÁä∂ÊÄÅ&quot;"></a></h4>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>MySQL [test234]> change pump to node_state ='paused' for node_id '192.168.169.41:8250';</span></span>
<span class="line"><span></span></span>
<span class="line"><span>MySQL [test234]> change pump to node_state ='online' for node_id '192.168.169.41:8250';</span></span></code></pre>
</div><ul>
<li>Pump/Drainer ‰∏≠Áä∂ÊÄÅÁöÑÂÆö‰πâÔºö
<ul>
<li>onlineÔºöÊ≠£Â∏∏ËøêË°å‰∏≠</li>
<li>pausingÔºöÊöÇÂÅú‰∏≠</li>
<li>pausedÔºöÂ∑≤ÊöÇÂÅú</li>
<li>closingÔºö‰∏ãÁ∫ø‰∏≠</li>
<li>offlineÔºöÂ∑≤‰∏ãÁ∫ø</li>
</ul>
</li>
<li>Ê≥®ÊÑèÔºöÂè™ÊúâÂú®ÂºÇÂ∏∏Áä∂ÊÄÅ‰∏ãÔºåËØ•ÂëΩ‰ª§ÊâçÊúâ‰ΩúÁî®ÔºåÂõ†‰∏∫ÂΩì Pump/Drainer Â≠òÂú®ÂºÇÂ∏∏Êó∂ÔºåÁä∂ÊÄÅ‰ø°ÊÅØÂ≠òÂú®‰∫é PD ‰∏≠ÔºåËØ•ÂëΩ‰ª§Áî®‰∫é‰øÆÊîπ PD ‰∏≠‰ø°ÊÅØ„ÄÇ</li>
</ul>
<h2 id="binlogctlÂ∑•ÂÖ∑ÁöÑ‰∏ãËΩΩ‰∏é‰ΩøÁî®" tabindex="-1">binlogctlÂ∑•ÂÖ∑ÁöÑ‰∏ãËΩΩ‰∏é‰ΩøÁî® <a class="header-anchor" href="#binlogctlÂ∑•ÂÖ∑ÁöÑ‰∏ãËΩΩ‰∏é‰ΩøÁî®" aria-label="Permalink to &quot;binlogctlÂ∑•ÂÖ∑ÁöÑ‰∏ãËΩΩ‰∏é‰ΩøÁî®&quot;"></a></h2>
<h4 id="Â∑•ÂÖ∑ÁöÑ‰∏ãËΩΩÈÉ®ÁΩ≤" tabindex="-1">Â∑•ÂÖ∑ÁöÑ‰∏ãËΩΩÈÉ®ÁΩ≤ <a class="header-anchor" href="#Â∑•ÂÖ∑ÁöÑ‰∏ãËΩΩÈÉ®ÁΩ≤" aria-label="Permalink to &quot;Â∑•ÂÖ∑ÁöÑ‰∏ãËΩΩÈÉ®ÁΩ≤&quot;"></a></h4>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>wget https://download.pingcap.org/tidb-{version}-linux-amd64.tar.gz </span></span>
<span class="line"><span></span></span>
<span class="line"><span>wget https://download.pingcap.org/tidb-{version}-linux-amd64.sha256</span></span>
<span class="line"><span></span></span>
<span class="line"><span>sha256sum -c tidb-{version}-linux-amd64.sha256</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[tidb@tiup-tidb41 binlogctl]$ sha256sum -c tidb-v4.0.9-linux-amd64.sha256</span></span>
<span class="line"><span>tidb-v4.0.9-linux-amd64.tar.gz: OK</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[tidb@tiup-tidb41 binlogctl]$ tar -xvf tidb-v4.0.9-linux-amd64.tar.gz</span></span></code></pre>
</div><h4 id="Â∑•ÂÖ∑ÁöÑ‰ΩøÁî®" tabindex="-1">Â∑•ÂÖ∑ÁöÑ‰ΩøÁî® <a class="header-anchor" href="#Â∑•ÂÖ∑ÁöÑ‰ΩøÁî®" aria-label="Permalink to &quot;Â∑•ÂÖ∑ÁöÑ‰ΩøÁî®&quot;"></a></h4>
<ul>
<li>Êü•ËØ¢ÊâÄÊúâÁöÑ Pump/Drainer ÁöÑÁä∂ÊÄÅ</li>
</ul>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 bin]$ ./binlogctl -pd-urls</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">http://192.168.169.41:2379</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> -cmd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> pumps</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[2021/01/18 12:40:40.644 -05:00] [INFO] [nodes.go:53] [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"query node"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">] [type</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">pump] [node</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"{NodeID: 192.168.169.43:8250, Addr: 192.168.169.43:8250, State: online, MaxCommitTS: 422311792296591361, UpdateTime: 2021-01-18 12:40:38 -0500 EST}"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[2021/01/18 12:40:40.644 -05:00] [INFO] [nodes.go:53] [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"query node"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">] [type</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">pump] [node</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"{NodeID: 192.168.169.41:8250, Addr: 192.168.169.41:8250, State: online, MaxCommitTS: 422311791614754817, UpdateTime: 2021-01-18 12:40:38 -0500 EST}"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[2021/01/18 12:40:40.645 -05:00] [INFO] [nodes.go:53] [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"query node"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">] [type</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">pump] [node</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"{NodeID: 192.168.169.42:8250, Addr: 192.168.169.42:8250, State: online, MaxCommitTS: 422311791929851907, UpdateTime: 2021-01-18 12:40:38 -0500 EST}"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 bin]$ ./binlogctl -pd-urls</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">http://192.168.169.41:2379</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> -cmd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> drainers</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[2021/01/18 12:41:07.968 -05:00] [INFO] [nodes.go:53] [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"query node"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">] [type</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">drainer] [node</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"{NodeID: 192.168.169.44:8249, Addr: 192.168.169.44:8249, State: online, MaxCommitTS: 422311798693167108, UpdateTime: 2021-01-18 12:41:06 -0500 EST}"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]</span></span></code></pre>
</div><ul>
<li>ÊöÇÂÅú/‰∏ãÁ∫ø Pump/Drainer</li>
</ul>
<table tabindex="0">
<thead>
<tr>
<th>ÂëΩ‰ª§</th>
<th>Ê∂µ‰πâ</th>
<th>ËåÉ‰æã</th>
</tr>
</thead>
<tbody>
<tr>
<td>pause-pump</td>
<td>ÊöÇÂÅú</td>
<td>Pump	 bin/binlogctl -pd-urls=<a href="http://127.0.0.1:2379" target="_blank" rel="noreferrer">http://127.0.0.1:2379</a> -cmd pause-pump -node-id ip-127-0-0-1:8250</td>
</tr>
<tr>
<td>pause-drainer</td>
<td>ÊöÇÂÅú</td>
<td>Drainer	 bin/binlogctl -pd-urls=<a href="http://127.0.0.1:2379" target="_blank" rel="noreferrer">http://127.0.0.1:2379</a> -cmd pause-drainer -node-id ip-127-0-0-1:8249</td>
</tr>
<tr>
<td>offline-pump</td>
<td>‰∏ãÁ∫ø</td>
<td>Pump  bin/binlogctl -pd-urls=<a href="http://127.0.0.1:2379" target="_blank" rel="noreferrer">http://127.0.0.1:2379</a> -cmd offline-pump -node-id ip-127-0-0-1:8250</td>
</tr>
<tr>
<td>offline-drainer</td>
<td>‰∏ãÁ∫ø</td>
<td>Drainer  bin/binlogctl -pd-urls=<a href="http://127.0.0.1:2379" target="_blank" rel="noreferrer">http://127.0.0.1:2379</a> -cmd offline-drainer -node-id ip-127-0-0-1:8249</td>
</tr>
</tbody>
</table>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tiup-tidb41 bin]$ binlogctl -pd-urls=http://127.0.0.1:2379 -cmd pause-pump -node-id 192.168.169.41:8250</span></span>
<span class="line"><span>[2021/01/18 12:44:33.347 -05:00] [INFO] [nodes.go:123] ["Apply action on node success"] [action=pause] [NodeID=192.168.169.41:8250]</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[tidb@tiup-tidb41 bin]$ ./binlogctl -pd-urls=http://192.168.169.41:2379 -cmd pumps </span></span>
<span class="line"><span>[2021/01/18 12:44:39.997 -05:00] [INFO] [nodes.go:53] ["query node"] [type=pump] [node="{NodeID: 192.168.169.41:8250, Addr: 192.168.169.41:8250, State: paused, MaxCommitTS: 422311853021986817, UpdateTime: 2021-01-18 12:44:32 -0500 EST}"]</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span>......</span></span>
<span class="line"><span></span></span>
<span class="line"><span>MySQL [test234]> show pump status;</span></span>
<span class="line"><span>+---------------------+---------------------+--------+--------------------+---------------------+</span></span>
<span class="line"><span>| NodeID              | Address             | State  | Max_Commit_Ts      | Update_Time         |</span></span>
<span class="line"><span>+---------------------+---------------------+--------+--------------------+---------------------+</span></span>
<span class="line"><span>| 192.168.169.41:8250 | 192.168.169.41:8250 | paused | 422311853021986817 | 2021-01-18 12:44:32 |</span></span>
<span class="line"><span>| 192.168.169.42:8250 | 192.168.169.42:8250 | online | 422311857281826817 | 2021-01-18 12:44:48 |</span></span>
<span class="line"><span>| 192.168.169.43:8250 | 192.168.169.43:8250 | online | 422311856862658561 | 2021-01-18 12:44:48 |</span></span>
<span class="line"><span>+---------------------+---------------------+--------+--------------------+---------------------+</span></span></code></pre>
</div><p>ÂÖ∂‰ªñÂëΩ‰ª§ÂêåÁêÜ;</p>
<ul>
<li>ÂºÇÂ∏∏ÊÉÖÂÜµ‰∏ã‰øÆÊîπ Pump/Drainer ÁöÑÁä∂ÊÄÅ</li>
</ul>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 bin]$ ./binlogctl -pd-urls</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">http://192.168.169.41:2379</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> -cmd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> update-pump</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -node-id</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 192.168.169.41:8250</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -state</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> online</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@tiup-tidb41 bin]$ ./binlogctl -pd-urls</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">http://192.168.169.41:2379</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> -cmd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> pumps</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[2021/01/18 12:48:42.249 -05:00] [INFO] [nodes.go:53] [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"query node"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">] [type</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">pump] [node</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"{NodeID: 192.168.169.41:8250, Addr: 192.168.169.41:8250, State: online, MaxCommitTS: 422311853021986817, UpdateTime: 2021-01-18 12:44:32 -0500 EST}"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]</span></span></code></pre>
</div><h2 id="brÈÖçÂêàtidb-binlogÂÆûÁé∞Â¢ûÈáèÂ§á‰ªΩ" tabindex="-1">BRÈÖçÂêàTiDB-BinlogÂÆûÁé∞Â¢ûÈáèÂ§á‰ªΩ <a class="header-anchor" href="#brÈÖçÂêàtidb-binlogÂÆûÁé∞Â¢ûÈáèÂ§á‰ªΩ" aria-label="Permalink to &quot;BRÈÖçÂêàTiDB-BinlogÂÆûÁé∞Â¢ûÈáèÂ§á‰ªΩ&quot;"></a></h2>
<h4 id="ÁéØÂ¢É‰∏éÊï∞ÊçÆÂáÜÂ§á" tabindex="-1">ÁéØÂ¢É‰∏éÊï∞ÊçÆÂáÜÂ§á <a class="header-anchor" href="#ÁéØÂ¢É‰∏éÊï∞ÊçÆÂáÜÂ§á" aria-label="Permalink to &quot;ÁéØÂ¢É‰∏éÊï∞ÊçÆÂáÜÂ§á&quot;"></a></h4>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tiup-tidb41 reparo]$ cp ~/binlogctl/tidb-v4.0.9-linux-amd64/bin/reparo ./</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[tidb@tiup-tidb41 reparo]$ ll</span></span>
<span class="line"><span>total 51180</span></span>
<span class="line"><span>-rwxr-xr-x 1 tidb tidb 52407079 Jan 18 13:06 reparo</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>MySQL [(none)]> create database full_backup_point_recover_1;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>MySQL [(none)]> create database full_backup_point_recover_2;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>MySQL [(none)]> use full_backup_point_recover_1;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>MySQL [full_backup_point_recover_1]> create table jan_test_1(id int auto_increment primary key, name varchar(20));</span></span>
<span class="line"><span></span></span>
<span class="line"><span>MySQL [full_backup_point_recover_1]> use full_backup_point_recover_2;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>MySQL [full_backup_point_recover_2]> create table jan_test_2(id int auto_increment primary key, name varchar(20));</span></span>
<span class="line"><span></span></span>
<span class="line"><span>MySQL [full_backup_point_recover_2]> insert into full_backup_point_recover_1.jan_test_1(name) values ('jan_test_1'),('jan_test_2'),('jan_test_3');</span></span>
<span class="line"><span></span></span>
<span class="line"><span>MySQL [full_backup_point_recover_2]> insert into full_backup_point_recover_2.jan_test_2(name) values ('jan_test_1');</span></span>
<span class="line"><span></span></span>
<span class="line"><span>MySQL [full_backup_point_recover_2]> select * from full_backup_point_recover_1.jan_test_1;</span></span>
<span class="line"><span>+----+------------+</span></span>
<span class="line"><span>| id | name       |</span></span>
<span class="line"><span>+----+------------+</span></span>
<span class="line"><span>|  1 | jan_test_1 |</span></span>
<span class="line"><span>|  2 | jan_test_2 |</span></span>
<span class="line"><span>|  3 | jan_test_3 |</span></span>
<span class="line"><span>+----+------------+</span></span>
<span class="line"><span></span></span>
<span class="line"><span>MySQL [full_backup_point_recover_2]> select * from full_backup_point_recover_2.jan_test_2;</span></span>
<span class="line"><span>+----+------------+</span></span>
<span class="line"><span>| id | name       |</span></span>
<span class="line"><span>+----+------------+</span></span>
<span class="line"><span>|  1 | jan_test_1 |</span></span>
<span class="line"><span>+----+------------+</span></span>
<span class="line"><span></span></span>
<span class="line"><span>MySQL [full_backup_point_recover_2]> select now();</span></span>
<span class="line"><span>+---------------------+</span></span>
<span class="line"><span>| now()               |</span></span>
<span class="line"><span>+---------------------+</span></span>
<span class="line"><span>| 2021-01-18 13:32:26 |</span></span>
<span class="line"><span>+---------------------+</span></span></code></pre>
</div><h4 id="brÂÖ®ÈáèÂ§á‰ªΩ" tabindex="-1">BRÂÖ®ÈáèÂ§á‰ªΩ <a class="header-anchor" href="#brÂÖ®ÈáèÂ§á‰ªΩ" aria-label="Permalink to &quot;BRÂÖ®ÈáèÂ§á‰ªΩ&quot;"></a></h4>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tiup-tidb41 ~]$ tiup br backup full --pd 192.168.169.42:2379 --storage "local:///home/tidb/reparo/full_backup" --ratelimit 120 --log-file /home/tidb/reparo/full_backup/log/full_backup_20200119.log</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Starting component `br`: /home/tidb/.tiup/components/br/v4.0.9/br backup full --pd 192.168.169.42:2379 --storage local:///home/tidb/reparo/full_backup --ratelimit 120 --log-file /home/tidb/reparo/full_backup/log/full_backup_20200119.log</span></span>
<span class="line"><span>Detail BR log in /home/tidb/reparo/full_backup/log/full_backup_20200119.log </span></span>
<span class="line"><span>Full backup &#x3C;---------------------------------------------------------------------------------------------------------------------------------------> 100.00%</span></span>
<span class="line"><span>Checksum &#x3C;------------------------------------------------------------------------------------------------------------------------------------------> 100.00%</span></span>
<span class="line"><span>[2021/01/18 13:39:52.129 -05:00] [INFO] [collector.go:60] ["Full backup Success summary: total backup ranges: 28, total success: 28, total failed: 0, total take(Full backup time): 11.599128783s, total take(real time): 15.218534235s, total kv: 841399, total size(MB): 173.31, avg speed(MB/s): 14.94"] ["backup fast checksum"=40.578617ms] ["backup checksum"=563.344738ms] ["backup total regions"=28] [BackupTS=422312719696527362] [Size=83443904]</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>MySQL [(none)]> select now();</span></span>
<span class="line"><span>+---------------------+</span></span>
<span class="line"><span>| now()               |</span></span>
<span class="line"><span>+---------------------+</span></span>
<span class="line"><span>| 2021-01-18 13:40:20 |</span></span>
<span class="line"><span>+---------------------+</span></span></code></pre>
</div><h3 id="Á†¥ÂùèÊÄßÂà†Â∫ì" tabindex="-1">Á†¥ÂùèÊÄßÂà†Â∫ì <a class="header-anchor" href="#Á†¥ÂùèÊÄßÂà†Â∫ì" aria-label="Permalink to &quot;Á†¥ÂùèÊÄßÂà†Â∫ì&quot;"></a></h3>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span></span></span>
<span class="line"><span>MySQL [full_backup_point_recover_2]> delete from full_backup_point_recover_1.jan_test_1 where id = 1;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>MySQL [(none)]> select now();</span></span>
<span class="line"><span>+---------------------+</span></span>
<span class="line"><span>| now()               |</span></span>
<span class="line"><span>+---------------------+</span></span>
<span class="line"><span>| 2021-01-18 13:40:42 |</span></span>
<span class="line"><span>+---------------------+</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>MySQL [(none)]> select * from full_backup_point_recover_1.jan_test_1;</span></span>
<span class="line"><span>+----+------------+</span></span>
<span class="line"><span>| id | name       |</span></span>
<span class="line"><span>+----+------------+</span></span>
<span class="line"><span>|  2 | jan_test_2 |</span></span>
<span class="line"><span>|  3 | jan_test_3 |</span></span>
<span class="line"><span>+----+------------+</span></span>
<span class="line"><span></span></span>
<span class="line"><span>MySQL [(none)]> drop database full_backup_point_recover_1;</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>MySQL [(none)]> drop database full_backup_point_recover_2;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>MySQL [(none)]> select now();</span></span>
<span class="line"><span>+---------------------+</span></span>
<span class="line"><span>| now()               |</span></span>
<span class="line"><span>+---------------------+</span></span>
<span class="line"><span>| 2021-01-18 13:50:21 |</span></span>
<span class="line"><span>+---------------------+</span></span></code></pre>
</div><h4 id="brÂÖ®ÈáèÊÅ¢Â§ç" tabindex="-1">BRÂÖ®ÈáèÊÅ¢Â§ç <a class="header-anchor" href="#brÂÖ®ÈáèÊÅ¢Â§ç" aria-label="Permalink to &quot;BRÂÖ®ÈáèÊÅ¢Â§ç&quot;"></a></h4>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>[tidb@tiup-tidb41 full_backup]$ tiup br restore full  --storage "local:///home/tidb/reparo/full_backup" --ratelimit 128 --log-file /home/tidb/reparo/full_backup/log/full_restore_20200119.log</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Starting component `br`: /home/tidb/.tiup/components/br/v4.0.9/br restore full --storage local:///home/tidb/reparo/full_backup --ratelimit 128 --log-file /home/tidb/reparo/full_backup/log/full_restore_20200119.log</span></span>
<span class="line"><span>Detail BR log in /home/tidb/reparo/full_backup/log/full_restore_20200119.log </span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>Full restore &#x3C;-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------> 100.00%</span></span>
<span class="line"><span>[2021/01/18 14:36:46.599 -05:00] [INFO] [collector.go:60] ["Full restore Success summary: total restore files: 23, total success: 23, total failed: 0, total take(Full restore time): 40m38.372489542s, total take(real time): 42m7.069324518s, total kv: 841399, total size(MB): 173.31, avg speed(MB/s): 0.07"] ["restore checksum"=40m33.969324142s] ["split region"=2.778469128s] ["restore ranges"=21] [Size=83443904]</span></span>
<span class="line"><span></span></span>
<span class="line"><span>MySQL [full_backup_point_recover_1]> select * from full_backup_point_recover_1.jan_test_1;</span></span>
<span class="line"><span>+----+------------+</span></span>
<span class="line"><span>| id | name       |</span></span>
<span class="line"><span>+----+------------+</span></span>
<span class="line"><span>|  1 | jan_test_1 |</span></span>
<span class="line"><span>|  2 | jan_test_2 |</span></span>
<span class="line"><span>|  3 | jan_test_3 |</span></span>
<span class="line"><span>+----+------------+</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>MySQL [full_backup_point_recover_1]> select * from full_backup_point_recover_2.jan_test_2;</span></span>
<span class="line"><span>+----+------------+</span></span>
<span class="line"><span>| id | name       |</span></span>
<span class="line"><span>+----+------------+</span></span>
<span class="line"><span>|  1 | jan_test_1 |</span></span>
<span class="line"><span>+----+------------+</span></span></code></pre>
</div><h4 id="reparoÂü∫‰∫éÊó∂Èó¥ÁÇπÂ¢ûÈáèÊÅ¢Â§ç" tabindex="-1">ReparoÂü∫‰∫éÊó∂Èó¥ÁÇπÂ¢ûÈáèÊÅ¢Â§ç <a class="header-anchor" href="#reparoÂü∫‰∫éÊó∂Èó¥ÁÇπÂ¢ûÈáèÊÅ¢Â§ç" aria-label="Permalink to &quot;ReparoÂü∫‰∫éÊó∂Èó¥ÁÇπÂ¢ûÈáèÊÅ¢Â§ç&quot;"></a></h4>
<p>Â¢ûÈáèÈÉ®ÂàÜ‰ªé 2021-01-18 13:32:26 ÂºÄÂßãÊÅ¢Â§çÔºåÊÅ¢Â§çËá≥ 2021-01-18 13:40:42 Êó∂Èó¥ÁÇπ;</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">vim</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> reparo.toml</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Drainer ËæìÂá∫ÁöÑ protobuf Ê†ºÂºè binlog Êñá‰ª∂ÁöÑÂ≠òÂÇ®Ë∑ØÂæÑ„ÄÇ</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">data-dir</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "/data/tidb-data/drainer-8249/relay_log"</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Êó•ÂøóËæìÂá∫‰ø°ÊÅØÁ≠âÁ∫ßËÆæÁΩÆÔºödebug, info, warn, error, fatal (ÈªòËÆ§ÂÄºÔºöinfo)„ÄÇ</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">log-level</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "info"</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># ‰ΩøÁî® start-datetime Âíå stop-datetime Êù•ÈÄâÊã©ÊÅ¢Â§çÊåáÂÆöÊó∂Èó¥ËåÉÂõ¥ÂÜÖÁöÑ binlogÔºåÊ†ºÂºè‰∏∫ ‚Äú2006-01-02 15:04:05‚Äù„ÄÇ</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">start-datetime</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "2021-01-18 13:32:26"</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">stop-datetime</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "2021-01-18 13:40:42"</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># ‰∏ãÊ∏∏ÊúçÂä°Á±ªÂûã„ÄÇ ÂèñÂÄº‰∏∫ print, mysqlÔºàÈªòËÆ§ÂÄºÔºöprintÔºâ„ÄÇÂΩìÂÄº‰∏∫ print Êó∂ÔºåÂè™ÂÅöËß£ÊûêÊâìÂç∞Âà∞Ê†áÂáÜËæìÂá∫Ôºå‰∏çÊâßË°å SQLÔºõ  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Â¶ÇÊûú‰∏∫ mysqlÔºåÂàôÈúÄË¶ÅÂú® [dest-db] ‰∏≠ÈÖçÁΩÆ host„ÄÅport„ÄÅuser„ÄÅpassword Á≠â‰ø°ÊÅØ„ÄÇ</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">dest-type</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "mysql"</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># ËæìÂá∫Âà∞‰∏ãÊ∏∏Êï∞ÊçÆÂ∫ì‰∏Ä‰∏™‰∫ãÂä°ÁöÑ SQL ËØ≠Âè•Êï∞ÈáèÔºàÈªòËÆ§ 20Ôºâ„ÄÇ</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">txn-batch</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 20</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># ÂêåÊ≠•‰∏ãÊ∏∏ÁöÑÂπ∂ÂèëÊï∞ÔºåËØ•ÂÄºËÆæÁΩÆË∂äÈ´òÂêåÊ≠•ÁöÑÂêûÂêêÊÄßËÉΩË∂äÂ•ΩÔºàÈªòËÆ§ 16Ôºâ„ÄÇ</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">worker-count</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 16</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># ÂÆâÂÖ®Ê®°ÂºèÈÖçÁΩÆ„ÄÇÂèñÂÄº‰∏∫ true Êàñ falseÔºàÈªòËÆ§ÂÄºÔºöfalseÔºâ„ÄÇÂΩìÂÄº‰∏∫ true Êó∂ÔºåReparo ‰ºöÂ∞Ü update ËØ≠Âè•ÊãÜÂàÜ‰∏∫ delete + replace ËØ≠Âè•„ÄÇ</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">safe-mode</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> false</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># replicate-do-db Âíå replicate-do-table Áî®‰∫éÊåáÂÆöÊÅ¢Â§çÁöÑÂ∫ìÂíåË°®Ôºåreplicate-do-db ÁöÑ‰ºòÂÖàÁ∫ßÈ´ò‰∫é replicate-do-table„ÄÇÊîØÊåÅ‰ΩøÁî®Ê≠£ÂàôË°®ËææÂºèÊù•ÈÖçÁΩÆÔºåÈúÄË¶Å‰ª• '~' ÂºÄÂßãÂ£∞Êòé‰ΩøÁî®Ê≠£ÂàôË°®ËææÂºè„ÄÇ</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Ê≥®Ôºöreplicate-do-db Âíå replicate-do-table ‰ΩøÁî®ÊñπÂºè‰∏é Drainer ÁöÑ‰ΩøÁî®ÊñπÂºè‰∏ÄËá¥„ÄÇ</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># replicate-do-db = ["~^b.*","s1"]</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># [[replicate-do-table]]</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># db-name ="test"</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># tbl-name = "log"</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># [[replicate-do-table]]</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># db-name ="test"</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># tbl-name = "~^a.*"</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Â¶ÇÊûú dest-type ËÆæÁΩÆ‰∏∫ mysql, ÈúÄË¶ÅÈÖçÁΩÆ dest-db</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[dest-db]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">host</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "192.168.169.41"</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">port</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 4000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">user</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "root"</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">password</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ""</span></span></code></pre>
</div><h4 id="È™åËØÅÂü∫‰∫éÊó∂Èó¥ÁÇπÊÅ¢Â§çÊ≠£Á°ÆÊÄß" tabindex="-1">È™åËØÅÂü∫‰∫éÊó∂Èó¥ÁÇπÊÅ¢Â§çÊ≠£Á°ÆÊÄß <a class="header-anchor" href="#È™åËØÅÂü∫‰∫éÊó∂Èó¥ÁÇπÊÅ¢Â§çÊ≠£Á°ÆÊÄß" aria-label="Permalink to &quot;È™åËØÅÂü∫‰∫éÊó∂Èó¥ÁÇπÊÅ¢Â§çÊ≠£Á°ÆÊÄß&quot;"></a></h4>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>select * from full_backup_point_recover_1.jan_test_1;</span></span>
<span class="line"><span>select * from full_backup_point_recover_2.jan_test_2;</span></span></code></pre>
</div><h2 id="ÂèÇËÄÉÊñáÁ´†" tabindex="-1">ÂèÇËÄÉÊñáÁ´† <a class="header-anchor" href="#ÂèÇËÄÉÊñáÁ´†" aria-label="Permalink to &quot;ÂèÇËÄÉÊñáÁ´†&quot;"></a></h2>
<p><a href="https://docs.pingcap.com/zh/tidb/stable/deploy-tidb-binlog#tidb-binlog-%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2" target="_blank" rel="noreferrer">PingCap-Binlog ÈõÜÁæ§ÈÉ®ÁΩ≤:https://docs.pingcap.com/zh/tidb/stable/deploy-tidb-binlog#tidb-binlog-%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2</a></p>
<p><a href="https://asktug.com/t/topic/33884" target="_blank" rel="noreferrer">TiIP Êâ©Â±ïÊñπÂºèÈõÜÊàê Pump„ÄÅDrainer : https://asktug.com/t/topic/33884</a></p>
<p><a href="https://asktug.com/t/topic/37569" target="_blank" rel="noreferrer">AskTUG-ÈÉ®ÁΩ≤DrainerÂá∫Áé∞ÂºÇÂ∏∏ÈîôËØØ:https://asktug.com/t/topic/37569</a></p>
<p><a href="https://asktug.com/t/topic/33675" target="_blank" rel="noreferrer">AskTUG-tidb_binlog.checkpointË°®‰∏çÂ≠òÂú®:https://asktug.com/t/topic/33675</a></p>
]]></content:encoded>
            <enclosure url="https://download.pingcap.com/images/docs-cn/tidb-binlog-cluster-architecture.png" length="0" type="image/png"/>
        </item>
        <item>
            <title><![CDATA[CDC ÁªÑ‰ª∂Ëß£Êûê]]></title>
            <link>https://askaric.com/zh/work/tidb/TiDB-EcosystematicTools/TiCDC/03CDCÁªÑ‰ª∂Ëß£Êûê.html</link>
            <guid>https://askaric.com/zh/work/tidb/TiDB-EcosystematicTools/TiCDC/03CDCÁªÑ‰ª∂Ëß£Êûê.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[1. ÂæÖË°•ÂÖÖÔºåÊï¨ËØ∑ÊúüÂæÖ...]]></description>
            <content:encoded><![CDATA[<h1 id="cdc-ÁªÑ‰ª∂Ëß£Êûê" tabindex="-1">CDC ÁªÑ‰ª∂Ëß£Êûê <a class="header-anchor" href="#cdc-ÁªÑ‰ª∂Ëß£Êûê" aria-label="Permalink to &quot;CDC ÁªÑ‰ª∂Ëß£Êûê&quot;"></a></h1>
<ol>
<li>ÂæÖË°•ÂÖÖÔºåÊï¨ËØ∑ÊúüÂæÖ...</li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[ÁõëÊéßÂéüÁêÜËß£Êûê]]></title>
            <link>https://askaric.com/zh/work/tidb/TiDB-EcosystematicTools/TiCDC/04ÁõëÊéßÂéüÁêÜËß£Êûê.html</link>
            <guid>https://askaric.com/zh/work/tidb/TiDB-EcosystematicTools/TiCDC/04ÁõëÊéßÂéüÁêÜËß£Êûê.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[# ÁõëÊéßÂéüÁêÜËß£Êûê

## ÊñáÁ´†ÊÑè‰πâ

## ÈòÖËØªÂâçË®Ä

1. Â¶Ç [TiDB ÂÆòÁΩëÊâÄËø∞ÂÖ∂ÁõëÊéß‰ΩøÁî® Prometheus Â≠òÂÇ®](https://docs.pingcap.com/zh/tidb/stable/tidb-monitoring-framework#prometheus-%E5%9C%A8-tidb-%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8) ÔºåÈªòËÆ§ scrape_interval ‰∏∫ 15sÔºå‰ª•‰∏ãÁöÑÂèòÊõ¥ÂùáÊåá TiCDC ÂÜÖÂ≠ò‰∏≠ÁöÑÁõëÊéßÊåáÊ†áÂèòÊõ¥ÈÄªËæëÔºå**Âç≥Ôºö‰∏çËÄÉËôëÂÜÖÂ≠òÊåÅ‰πÖÂåñÈÉ®ÂàÜÈÄªËæëÔºåÈõÜ‰∏≠ÂàÜÊûêÊåáÊ†áÊÑè‰πâ„ÄÇ**
2. ‰∏ãÊñáÊâÄÊåá **‚Äúprometheus client ÂäüËÉΩ‚Äù**ÔºåË°®Á§∫„ÄÇÂ¶ÇÔºö‰ºöÊ≥®ÂÜå ËøõÁ®ãÊî∂ÈõÜÂô®„ÄÅGo Êî∂ÈõÜÂô®Á≠âÔºåÂàÜÂà´Áî®‰∫éÊî∂ÈõÜÂü∫Êú¨ÁöÑ Linux ËøõÁ®ã‰ø°ÊÅØÔºåÊØîÂ¶Ç CPU„ÄÅÂÜÖÂ≠ò„ÄÅÊñá‰ª∂ÊèèËø∞Á¨¶‰ΩøÁî®ÊÉÖÂÜµÔºå‰ª•ÂèäÂêØÂä®Êó∂Èó¥Á≠âÔºåÂèäÊî∂ÈõÜÊúâÂÖ≥ Go ËøêË°åÊó∂ÁöÑ‰ø°ÊÅØÔºåÊØîÂ¶Ç GC„ÄÅgouroutine Âíå OS Á∫øÁ®ãÁöÑÊï∞ÈáèÁ≠â‰ø°ÊÅØ„ÄÇ**‰∏∫ÈÅøÂÖçÊñáÁ´†ÂÜó‰ΩôÔºåÁªüÁß∞ ‚Äúprometheus client ÂäüËÉΩ‚Äù**ÔºåÂ¶ÇÈÅáÂà∞ËØ•Á±ªÊåáÊ†á‰∏çÂáÜÊÉÖÂÜµÔºåÂèØ‰ª•Âéª Prometheus Github Repo Êü•ÁúãÁõ∏ÂÖ≥ÊàñÂàõÂª∫ Issue ËÆ®ËÆ∫„ÄÇ
3. Prometheus ‰ª• Counter„ÄÅGauge„ÄÅHistogram Â∞ÅË£Ö‰∫é TiDB ÂêÑÁªÑ‰ª∂ÂÜÖÈÉ®ÔºàÂê´ TiCDCÔºâÔºåËØ¶ÊÉÖÈòÖËØª Prometheus Document Êàñ My BlogÔºåÂêÑ metrics ÂùáÂú®ËøõÁ®ãÂêØÂä®Êó∂‰æøË¢´ÂàùÂßãÂåñÂÆåÊØïÔºåÂõ†Ê≠§‰∏ãÊñáÂÖ≥Ê≥® Metrics ÁöÑ ÂèòÊõ¥„ÄÅÊ∂à‰∫°„ÄÅ‰ΩúÁî®„ÄÇ
4. ‰∏ãÊñá‰∏≠Â§öÊ¨°ÊèêÂèä Tick Êú∫Âà∂ÔºåÈÄªËæëÂ§ßËá¥Â¶Ç‰∏ãÔºåÊú¨Ë¥®ÊòØ‰∏Ä‰∏™Âõ∫ÂÆöÈ¢ëÁéáÁöÑÂßãÁªàÂä®‰ΩúÔºåÂÖ∂Âä®‰Ωú‰∏≠ÂåÖÂê´Êõ¥Êñ∞ Metrics Êìç‰Ωú„ÄÇ

    ```yaml
    Owner.Tick --> changefeed.Tick --> schedulerV2.Tick --> ScheduleDispatcher.Tick
                                                |]]></description>
            <content:encoded><![CDATA[<h1 id="ÁõëÊéßÂéüÁêÜËß£Êûê" tabindex="-1">ÁõëÊéßÂéüÁêÜËß£Êûê <a class="header-anchor" href="#ÁõëÊéßÂéüÁêÜËß£Êûê" aria-label="Permalink to &quot;ÁõëÊéßÂéüÁêÜËß£Êûê&quot;"></a></h1>
<h2 id="ÊñáÁ´†ÊÑè‰πâ" tabindex="-1">ÊñáÁ´†ÊÑè‰πâ <a class="header-anchor" href="#ÊñáÁ´†ÊÑè‰πâ" aria-label="Permalink to &quot;ÊñáÁ´†ÊÑè‰πâ&quot;"></a></h2>
<h2 id="ÈòÖËØªÂâçË®Ä" tabindex="-1">ÈòÖËØªÂâçË®Ä <a class="header-anchor" href="#ÈòÖËØªÂâçË®Ä" aria-label="Permalink to &quot;ÈòÖËØªÂâçË®Ä&quot;"></a></h2>
<ol>
<li>
<p>Â¶Ç <a href="https://docs.pingcap.com/zh/tidb/stable/tidb-monitoring-framework#prometheus-%E5%9C%A8-tidb-%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8" target="_blank" rel="noreferrer">TiDB ÂÆòÁΩëÊâÄËø∞ÂÖ∂ÁõëÊéß‰ΩøÁî® Prometheus Â≠òÂÇ®</a> ÔºåÈªòËÆ§ scrape_interval ‰∏∫ 15sÔºå‰ª•‰∏ãÁöÑÂèòÊõ¥ÂùáÊåá TiCDC ÂÜÖÂ≠ò‰∏≠ÁöÑÁõëÊéßÊåáÊ†áÂèòÊõ¥ÈÄªËæëÔºå<strong>Âç≥Ôºö‰∏çËÄÉËôëÂÜÖÂ≠òÊåÅ‰πÖÂåñÈÉ®ÂàÜÈÄªËæëÔºåÈõÜ‰∏≠ÂàÜÊûêÊåáÊ†áÊÑè‰πâ„ÄÇ</strong></p>
</li>
<li>
<p>‰∏ãÊñáÊâÄÊåá <strong>‚Äúprometheus client ÂäüËÉΩ‚Äù</strong>ÔºåË°®Á§∫„ÄÇÂ¶ÇÔºö‰ºöÊ≥®ÂÜå ËøõÁ®ãÊî∂ÈõÜÂô®„ÄÅGo Êî∂ÈõÜÂô®Á≠âÔºåÂàÜÂà´Áî®‰∫éÊî∂ÈõÜÂü∫Êú¨ÁöÑ Linux ËøõÁ®ã‰ø°ÊÅØÔºåÊØîÂ¶Ç CPU„ÄÅÂÜÖÂ≠ò„ÄÅÊñá‰ª∂ÊèèËø∞Á¨¶‰ΩøÁî®ÊÉÖÂÜµÔºå‰ª•ÂèäÂêØÂä®Êó∂Èó¥Á≠âÔºåÂèäÊî∂ÈõÜÊúâÂÖ≥ Go ËøêË°åÊó∂ÁöÑ‰ø°ÊÅØÔºåÊØîÂ¶Ç GC„ÄÅgouroutine Âíå OS Á∫øÁ®ãÁöÑÊï∞ÈáèÁ≠â‰ø°ÊÅØ„ÄÇ<strong>‰∏∫ÈÅøÂÖçÊñáÁ´†ÂÜó‰ΩôÔºåÁªüÁß∞ ‚Äúprometheus client ÂäüËÉΩ‚Äù</strong>ÔºåÂ¶ÇÈÅáÂà∞ËØ•Á±ªÊåáÊ†á‰∏çÂáÜÊÉÖÂÜµÔºåÂèØ‰ª•Âéª Prometheus Github Repo Êü•ÁúãÁõ∏ÂÖ≥ÊàñÂàõÂª∫ Issue ËÆ®ËÆ∫„ÄÇ</p>
</li>
<li>
<p>Prometheus ‰ª• Counter„ÄÅGauge„ÄÅHistogram Â∞ÅË£Ö‰∫é TiDB ÂêÑÁªÑ‰ª∂ÂÜÖÈÉ®ÔºàÂê´ TiCDCÔºâÔºåËØ¶ÊÉÖÈòÖËØª Prometheus Document Êàñ My BlogÔºåÂêÑ metrics ÂùáÂú®ËøõÁ®ãÂêØÂä®Êó∂‰æøË¢´ÂàùÂßãÂåñÂÆåÊØïÔºåÂõ†Ê≠§‰∏ãÊñáÂÖ≥Ê≥® Metrics ÁöÑ ÂèòÊõ¥„ÄÅÊ∂à‰∫°„ÄÅ‰ΩúÁî®„ÄÇ</p>
</li>
<li>
<p>‰∏ãÊñá‰∏≠Â§öÊ¨°ÊèêÂèä Tick Êú∫Âà∂ÔºåÈÄªËæëÂ§ßËá¥Â¶Ç‰∏ãÔºåÊú¨Ë¥®ÊòØ‰∏Ä‰∏™Âõ∫ÂÆöÈ¢ëÁéáÁöÑÂßãÁªàÂä®‰ΩúÔºåÂÖ∂Âä®‰Ωú‰∏≠ÂåÖÂê´Êõ¥Êñ∞ Metrics Êìç‰Ωú„ÄÇ</p>
<div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">Owner.Tick --> changefeed.Tick --> schedulerV2.Tick --> ScheduleDispatcher.Tick</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">                                            |-</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">---------->feedStateManager.Tick</span></span></code></pre>
</div></li>
</ol>
<h2 id="server-Èù¢Êùø" tabindex="-1">Server Èù¢Êùø <a class="header-anchor" href="#server-Èù¢Êùø" aria-label="Permalink to &quot;Server Èù¢Êùø&quot;"></a></h2>
<p>ËØ•Èù¢Êùø‰∏ãÂ§ßÈÉ®ÂàÜÊåáÊ†á‰∏éËøõÁ®ãÁä∂ÊÄÅÂèäÊìç‰ΩúÁ≥ªÁªüËµÑÊ∫êÊ∂àËÄóÁõ∏ÂÖ≥„ÄÇ</p>
<ol>
<li>
<p>Uptime</p>
<p>ÂèòÊõ¥ÔºöËäÇÁÇπËøõÁ®ãÊ≠£Â∏∏ÈÄöÂ∏∏ÊÉÖÂÜµ‰∏ãÔºàstart_time ÂÄº‰∏çÂèòÔºâÔºåÈù¢ÊùøÂÄº‰∏çÊñ≠Ëá™Â¢ûÔºåÂèëÁîüÈáçÂêØÊó∂ËØ•ÂÄº‰ºöË¢´ÈáçÁΩÆ‰∏∫Èõ∂Âπ∂ÂºÄÂêØÊñ∞‰∏ÄËΩÆÁöÑÁ¥ØÁßØËá™Â¢ûÔºõ
Ê∂à‰∫°ÔºöËøõÁ®ãÈáçÂêØ start_time ÊîπÂèòÔºõ
‰ΩúÁî®ÔºöTiKV ËäÇÁÇπÂíå TiCDC ËäÇÁÇπÂ∑≤ÁªèËøêË°åÁöÑÊó∂Èó¥ÔºåÂåÖÊã¨ Capture ËäÇÁÇπÔºåPD ËäÇÁÇπÂèä TiKV ËäÇÁÇπËá™‰∏ä‰∏ÄÊ¨°ËøõÁ®ãÂêØÂä®ÂºÄÂßãÂà∞Áé∞Âú®‰∏∫Ê≠¢ÁöÑËøêË°åÊó∂Èó¥„ÄÇÁî®‰∫éÈóÆÈ¢òËØäÊñ≠Êó∂ÔºåÂàÜÊûêÁªÑÂª∫ËøõÁ®ãÈáçÂêØ‰∏éÂΩìÂâçÈóÆÈ¢òÁöÑÁõ∏ÂÖ≥ÊÄß„ÄÇ
ÂéüÁêÜÔºöÊï∞ÊçÆÊù•Ëá™/proc/statÔºåÂΩìÂâçÊó∂Èó¥Âáèstart_time Èô§ USER_HZÂæóÁßí‰∏∫Âçï‰ΩçÁöÑÂÄº„ÄÇ</p>
</li>
<li>
<p>Goroutine count</p>
<p>ÂèòÊõ¥ÔºöËøõÁ®ãËøêË°åÊó∂Ôºågo profile ÈááÁî®ÁªüËÆ°ËÆ∞ÂΩïÔºõ<br>
Ê∂à‰∫°ÔºöËøõÁ®ãÁªìÊùüÊó∂ prometheus client ‰∏≠ÁöÑ go Êî∂ÈõÜÂô®ÈÄÄÂá∫Ôºå‰∏çÂú®ËÆ∞ÂΩïÂØπÂ∫îÊåáÊ†á‰ø°ÊÅØÔºõ<br>
‰ΩúÁî®ÔºöTiCDC ËäÇÁÇπ Goroutine ÁöÑ‰∏™Êï∞ÔºåÁî®‰∫éÈóÆÈ¢òËØäÊñ≠Êó∂ÔºåÂàÜÊûêÁªÑÂª∫ËøõÁ®ãÈáçÂêØ‰∏éÂΩìÂâçÈóÆÈ¢òÁöÑÁõ∏ÂÖ≥ÊÄß„ÄÇ<br>
ÂéüÁêÜÔºöÔºà‰∏ãÈù¢Êúâ‰∏™ÈöêËóèÊåáÊ†áÔºågo_threads ‰∏é go_goroutines ÂäüËÉΩÁ±ª‰ººÔºåcdc process Âú® linux ÂàõÂª∫ÁöÑÁ∫øÁ®ãÊï∞Ôºå‰∏ªË¶ÅÁî®‰∫éÊÄßËÉΩË∞É‰ºòÔºåÂ¶ÇÔºögoroutine ËøáÂ§öÁ≠âÈóÆÈ¢ò„ÄÇÔºâ</p>
</li>
<li>
<p>Open FD count</p>
<p>‰∫ßÁîüÔºöÈááÁî® Prometheus Guage Á±ªÂûãÁªüËÆ°ÔºåÊâìÂºÄÁöÑÊñá‰ª∂ÊèèËø∞Á¨¶Êï∞ÈáèÔºõ<br>
ÂèòÊõ¥Ôºö‰ª•ÈªòËÆ§ 15s ‰∏∫Èó¥ÈöîÊõ¥Êñ∞ÊåáÊ†áÂÄºÔºõ<br>
Ê∂à‰∫°ÔºöËøõÁ®ãÁªìÊùüÊó∂ÊåáÊ†áÂÄºÂΩíÈõ∂Ôºõ<br>
‰ΩúÁî®ÔºöTiCDC ËäÇÁÇπÊâìÂºÄÁöÑÊñá‰ª∂Âè•ÊüÑ‰∏™Êï∞ÔºåÁî®‰∫éÈóÆÈ¢òËØäÊñ≠Êó∂ÔºåÂàÜÊûêÊìç‰ΩúÁ≥ªÁªüÂ±ÇÈù¢Êñá‰ª∂Âè•ÊüÑÊâìÂºÄÊï∞Èáè‰∏éÂΩìÂâçÈóÆÈ¢òÁöÑÁõ∏ÂÖ≥ÊÄßÔºõ<br>
ÂéüÁêÜÔºöËØ•‰ø°ÊÅØÊ∫êËá™ /proc/PID/fd„ÄÇ</p>
</li>
<li>
<p>Ownership</p>
<p>‰∫ßÁîüÔºöÈááÁî® Prometheus Guage Á±ªÂûãÁªüËÆ°ÔºåËøõÁ®ãËøêË°åÊó∂ÊåáÊ†áÂÄºÂàùÂßãÂåñÂÆåÊØïÔºõ<br>
ÂèòÊõ¥Ôºö‰ª• owner-flush-interval  ‰∏∫Âë®ÊúüÔºåÂú®ËøõÁ®ã Tick Êó∂‰∫éÂÜÖÂ≠ò‰∏≠Êõ¥Êñ∞Ôºõ<br>
Ê∂à‰∫°ÔºöËøõÁ®ãÁªìÊùüÊó∂ÊåáÊ†áÂÄºÂΩíÈõ∂Ôºõ<br>
‰ΩúÁî®ÔºöTiCDC ÈõÜÁæ§‰∏≠ËäÇÁÇπÁöÑÂΩìÂâçÁä∂ÊÄÅÔºåÊåáÊ†áÂÄºÂåÖÂê´ InstanceÔºàIP:portÔºâ Âèä Role(Processor Êàñ Owner)„ÄÇÁî®‰∫éÈóÆÈ¢òËØäÊñ≠Êó∂ÔºåÂàÜÊûêÂΩìÂâçÈóÆÈ¢ò‰∏é Owner Áõ∏ÂÖ≥ÊÄßÔºåÂ¶ÇÔºöÊòØÂê¶ÂêåÊó∂Â≠òÂú® 2 ‰∏™ Owner Á≠â„ÄÇ<br>
ÂéüÁêÜÔºö‰æùÊçÆ CDC ÁöÑ Tick Êú∫Âà∂ÔºåÂú®ÊØèÊ¨° Tick Êó∂ Owner ÁöÑ updateMetrics ‰ºö‰ª• ownershipCounter.Add(float64(now.Sub(o.lastTickTime)) / float64(time.Second)) ËÆ°ÁÆóÂä†ÂíåÁªüËÆ°„ÄÇ‰ª• owner-flush-interval Âú® Process ÂêØÂä®Êó∂ÊûÑÈÄ†‰∏Ä‰∏™ goroutine ÔºåÂë®ÊúüÊÄßÁöÑÂÆåÊàê Tick Êìç‰ΩúÔºåTick ËØ¶ÁªÜËøêË°åÊú∫Âà∂ÂèÇËÄÉ --&gt; What is tick in cdc</p>
</li>
<li>
<p>Ownership history</p>
<p>‰∫ßÁîüÔºöÂêå Ownership Èù¢ÊùøÔºõ
ÂèòÊõ¥ÔºöÂêå Ownership Èù¢ÊùøÔºõ
Ê∂à‰∫°ÔºöÂêå Ownership Èù¢ÊùøÔºõ
‰ΩúÁî®ÔºöÂèòÊç¢ËÆ°ÁÆóÊñπÂºèÔºåÁî®‰∫éÂàÜÊûê Owner ÁöÑÊºîËøõÂéÜÂè≤ÔºåÊúâÂà©‰∫éÈóÆÈ¢òÊ†πÂõ†‰∏éËØ•ÊåáÊ†áÁõ∏ÂÖ≥ÊÄßÂàÜÊûê„ÄÇ</p>
</li>
<li>
<p>CPU usage
ÂèòÊõ¥ÔºöÈááÁî® Prometheus Guage Á±ªÂûãÁªüËÆ°Ôºå‰ªéÊìç‰ΩúÁ≥ªÁªüÂ±ÇËé∑ÂèñÂΩìÂâçËøõÁ®ãÁöÑ CPU UsageÔºõ
Ê∂à‰∫°ÔºöËøõÁ®ãÁªìÊùüÊó∂ÊåáÊ†áÂÄºÂΩíÈõ∂Ôºõ
‰ΩúÁî®ÔºöTiCDC ËäÇÁÇπ‰ΩøÁî®ÁöÑ CPU„ÄÇinstance-MaxProcs Ë°®Á§∫ Capture ËøõÁ®ãÂèØÂêåÊó∂‰ΩøÁî®Êìç‰ΩúÁ≥ªÁªü CPU Ê†∏Êï∞ÔºàÁõÆÂâç hard code Âú®‰ª£Á†Å‰∏≠ÔºåÂèØ 100% Âç†Áî®Êìç‰ΩúÁ≥ªÁªü CPU Ê†∏Êï∞ÔºâÔºåinstance Ë°®Á§∫ÂΩìÂâçËøõÁ®ãÂ∑≤Ê∂àËÄóÁöÑ CPU Ê†∏ÂøÉ‰ΩøÁî®Áéá„ÄÇÁî®‰∫éÈóÆÈ¢òËØäÊñ≠Êó∂ÔºåÂàÜÊûêÊìç‰ΩúÁ≥ªÁªüÂ±ÇÈù¢ËøõÁ®ã‰ΩøÁî®ÊÉÖÂÜµ‰∏éÂΩìÂâçÈóÆÈ¢òÁöÑÁõ∏ÂÖ≥ÊÄßÔºõ
ÂéüÁêÜÔºöËØ•‰ø°ÊÅØÊ∫êËá™ /proc/PID/status „ÄÇ</p>
</li>
<li>
<p>Memory usage
ÂèòÊõ¥ÔºöÈááÁî® Prometheus Guage Á±ªÂûãÁªüËÆ°Ôºå‰ªéÊìç‰ΩúÁ≥ªÁªüÂ±ÇÈù¢Ëé∑ÂèñËøõÁ®ãÂÜÖÂ≠òÊ∂àËÄóÔºõ
Ê∂à‰∫°ÔºöËøõÁ®ãÁªìÊùüÊó∂ÊåáÊ†áÂÄºÂΩíÈõ∂Ôºõ
‰ΩúÁî®ÔºöTiCDC ËäÇÁÇπ‰ΩøÁî®ÁöÑÂÜÖÂ≠ò„ÄÇprocess-instance Ë°®Á§∫ËøõÁ®ãÂÆûÈôÖ‰ΩøÁî®ÁöÑÂÜÖÂ≠òÔºàÂç≥ÔºöÂ∏∏È©ªÂÜÖÂ≠òÈõÜ Resident Set SizeÔºâÔºå‰∏çÂåÖÊã¨ÂàÜÈÖç‰ΩÜÊú™‰ΩøÁî®ÁöÑÂÜÖÂ≠òÔºå‰πü‰∏çÂåÖÊã¨Êç¢Âá∫ÁöÑÂÜÖÂ≠òÈ°µÈù¢Ôºå‰ΩÜÂåÖÂê´ÂÖ±‰∫´ÂÜÖÂ≠ò„ÄÇheap-instance Ë°®Á§∫ Capture ËøõÁ®ãÂ∑≤ÂàÜÈÖç‰∏î‰ªçÂú®‰ΩøÁî®ÁöÑ heap Â≠óËäÇÊï∞ÔºåÂåÖÊã¨ÊâÄÊúâÂèØËææÂ†ÜÂØπË±°Âíå‰∏çÂèØËææÁöÑÂØπË±°(GCÂ∞öÊú™ÈáäÊîæÁöÑÔºâÂç†Áî®ÁöÑÂÜÖÂ≠ò„ÄÇÁî®‰∫éÈóÆÈ¢òËØäÊñ≠Êó∂ÔºåÂàÜÊûêÊìç‰ΩúÁ≥ªÁªüÂ±ÇÈù¢ËøõÁ®ãÂÜÖÂ≠òÊ∂àËÄó‰∏éÂΩìÂâçÈóÆÈ¢òÁöÑÁõ∏ÂÖ≥ÊÄßÔºõ
ÂéüÁêÜÔºöËØ•Á±ª‰ø°ÊÅØÊù•Ëá™ Go Êî∂ÈõÜÂô® ÔºåÈùûÊìç‰ΩúÁ≥ªÁªü„ÄÇ</p>
</li>
<li>
<p>PD leader history
ÂèòÊõ¥ÔºöÈááÁî® Prometheus Guage Á±ªÂûãÁªüËÆ°ÔºåÊ∫êËá™ PD ÁªÑ‰ª∂ÔºåPD ËøõÁ®ãÂàáÊç¢ Leader Êó∂ÂèëÁîüÂèòÊõ¥Ôºõ
Ê∂à‰∫°ÔºöÂΩì PD leader Âèò‰∏∫ follower Êó∂ÔºåÊåáÊ†áÂÄºÂΩíÈõ∂„ÄÇPD ËøõÁ®ãÁªìÊùüÊó∂ÔºåÊåáÊ†áÂÄº‰∏∫Á©∫Ôºõ
‰ΩúÁî®ÔºöË°®Á§∫ PD Leader ÊºîËøõÂéÜÂè≤ÔºåÂõ†‰∏∫ PD Cluster  ‰∏∫ TiCDC Cluster Êèê‰æõ‰∏ÄÂÆöÊåÅ‰πÖÂåñÂäüËÉΩÔºå‰∫åËÄÖÊòØÂº∫ÁªëÂÆöÂÖ≥Á≥ªÔºåÊâÄ‰ª•ËØ•Èù¢ÊùøÊúâÂà©‰∫éÂàÜÊûêÂΩìÂâçÈóÆÈ¢ò‰∏é PD Leader ÂèòÂåñÁöÑÁõ∏ÂÖ≥ÊÄß„ÄÇ</p>
</li>
</ol>
<h2 id="changefeed-Èù¢Êùø" tabindex="-1">Changefeed Èù¢Êùø <a class="header-anchor" href="#changefeed-Èù¢Êùø" aria-label="Permalink to &quot;Changefeed Èù¢Êùø&quot;"></a></h2>
<p>Changefeed table count
‰∫ßÁîüÔºöÈááÁî® Prometheus Guage Á±ªÂûãÁªüËÆ°ÔºåÂú® Processor ÂàõÂª∫Êó∂ËØ•ÊåáÊ†áÂàùÂßãÂåñÔºõ
ÂèòÊõ¥ÔºöÂú® TablePipeline ÂçèÁ®ãÂàõÂª∫ÊàêÂäüÂêéÔºåÊåáÊ†áÂÄºÂ¢ûÂä†ÔºåÂú® TablePipeline ÂçèÁ®ãÈÄÄÂá∫ÂêéÔºåÊåáÊ†áÂÄºÂáèÂ∞ëÔºõ
Ê∂à‰∫°ÔºöÂú® Processor ÁîüÂëΩÂë®ÊúüÁªìÊùüÊó∂ÔºåÂà†Èô§ÊåáÊ†áÔºõ
‰ΩúÁî®Ôºö‰∏Ä‰∏™ÂêåÊ≠•‰ªªÂä°‰∏≠ÂàÜÈÖçÂà∞ÂêÑ‰∏™ TiCDC ËäÇÁÇπÂêåÊ≠•ÁöÑÊï∞ÊçÆË°®‰∏™Êï∞ÔºåÂΩìÂâç TiCDC Cluster ÂêÑ Capture ÂàÜÈÖçÁöÑÂêåÊ≠•Ë°®Êï∞ÈáèÊòØÂê¶ÂùáË°°„ÄÇ
Table count maintained by owner
‰∫ßÁîüÔºöÈááÁî® Prometheus Guage Á±ªÂûãÁªüËÆ°ÔºåÂú® Capture ËøêË°åÊó∂ËØ•ÊåáÊ†áÂàùÂßãÂåñÔºõ
ÂèòÊõ¥Ôºö‰ª• owner-flush-interval ‰∏∫Âë®Êúü Tick Êó∂ÔºåÂæ™ÁéØÊü•ÊâæÊØè‰∏™ Changefeeds ÊâÄÁî®ÁöÑ CaptureÔºåÂπ∂Ê±áÊÄªÁªüËÆ°ÂΩìÂâç Owner ÊâÄÁÆ°ÁêÜÁöÑË°®Êï∞ÈáèÔºõ
Ê∂à‰∫°ÔºöËøõÁ®ãÁªìÊùüÊó∂ÊåáÊ†áÂÄºÂΩíÈõ∂Ôºõ
‰ΩúÁî®ÔºöTiCDC Owner Áª¥Êä§ÁöÑÂ§çÂà∂Ë°®ÁöÑÊï∞Èáè„ÄÇcapture-total Ë°®Á§∫ÂØπÂ∫î Capture ‰∏äÁª¥Êä§ÁöÑË°®Êï∞ÈáèÔºåcapture-wip Ë°®Á§∫Ë°®Ê≠£Â§Ñ‰∫éËøÅÁßªË∞ÉÂ∫¶Áä∂ÊÄÅÁöÑÊï∞Èáè„ÄÇÁî®‰∫éÈóÆÈ¢òËØäÊñ≠Êó∂ÔºåÂàÜÊûê Owner Ë°®Ë∞ÉÂ∫¶‰∏éÂΩìÂâçÈóÆÈ¢òÁöÑÁõ∏ÂÖ≥ÊÄß„ÄÇ
Min resolved table ID
‰∫ßÁîüÔºöÈááÁî® Prometheus Guage Á±ªÂûãÁªüËÆ°ÔºåÂú® Capture ËøêË°åÊó∂ËØ•ÊåáÊ†áÂàùÂßãÂåñÔºõ
ÂèòÊõ¥Ôºö‰ª• processor-flush-interval ‰∏∫Âë®Êúü Tick Êó∂ÔºåÈÅçÂéÜÂΩìÂâç Processor ÊâÄË¥üË¥£ÁöÑË°®ÊâæÂá∫ÊúÄÂ∞è TableID ËÆ∞ÂΩïÔºõ
Ê∂à‰∫°ÔºöÂú® Processor Â£∞ÊòéÂë®ÊúüÁªìÊùüÊó∂‰∏çÂÜçËÆ∞ÂΩïÔºõ
‰ΩúÁî®ÔºöÊØè‰∏™ Changefeed ÊâÄÂú®ÁöÑ Capture ÁöÑÊúÄÂ∞è ResolvedTs ÁöÑË°®ÁöÑ TableIDÔºå‰ª• instance-changefeed-table-id Ê†ºÂºèÂàíÂàÜÊåáÊ†á„ÄÇÁî®‰∫éÈóÆÈ¢òËØäÊñ≠Êó∂ÔºåÂ∞ÜÊï¥‰ΩìÂª∂Êó∂Âú® ResolvedTs Â±ÇÈù¢ÁªÜÂàÜÂà∞Ë°®Á∫ß„ÄÇ
Min checkpoint table ID
‰∫ßÁîüÔºöÂêå Min resolved table ID ÊåáÊ†áÔºõ
ÂèòÊõ¥ÔºöÂêå Min resolved table ID ÊåáÊ†áÔºõ
Ê∂à‰∫°ÔºöÂêå Min resolved table ID ÊåáÊ†áÔºõ
‰ΩúÁî®ÔºöÊØè‰∏™ Changefeed ÊâÄÂú®ÁöÑ Capture ÁöÑÊúÄÂ∞è CheckpointTs ÁöÑË°®ÁöÑ TableIDÔºå‰ª• instance-changefeed-table-id Ê†ºÂºèÂàíÂàÜÊåáÊ†á„ÄÇÁî®‰∫éÈóÆÈ¢òËØäÊñ≠Êó∂ÔºåÂ∞ÜÊï¥‰ΩìÂª∂Êó∂Âú® CheckpointTs Â±ÇÈù¢ÁªÜÂàÜÂà∞Ë°®Á∫ß„ÄÇ
Changefeed checkpoint
‰∫ßÁîüÔºöapproximate current time (s) Ê∫êËá™ PD ÔºåÂèñÂΩìÂâç PD Áî≥ËØ∑ÁöÑÊúÄÂ§ß TSO Ë°®Á§∫ÈõÜÁæ§ÂΩìÂâçÊó∂Èó¥„ÄÇchangefeed„ÄÅinstance-changefeed„ÄÅchangefeed-barrierTs ÂùáÈááÁî® Prometheus Guage Á±ªÂûãÁªüËÆ°ÔºåÂú® Capture ËøêË°åÊó∂ËØ•ÊåáÊ†áÂàùÂßãÂåñÔºõ
ÂèòÊõ¥Ôºö</p>
<ol>
<li>changefeed Âú® Changefeed ÂàùÂßãÂåñÊó∂ÔºåËÆ∞ÂΩï‰∏ãÂØπÂ∫îÁöÑ ChangefeedIDÔºåÈöèÁùÄ Owner Tick ‰ºöËß¶Âèë Changefeed Tick ÔºåÂπ∂Âú® Changefeed Tick ‰∏≠Â∞ÜÂΩìÂâç Changefeed CheckpointTs Êõ¥Êñ∞„ÄÇ</li>
<li>instance-changefeed Âú® Processor ÂàùÂßãÂåñÊó∂ÔºåËÆ∞ÂΩï‰∏ãÂØπÂ∫î changefeedID Âèä advertiseAddrÔºåÂπ∂Âú® Processor Tick ‰∏≠Â∞ÜÂΩìÂâç Processor Ë¥üË¥£ÁöÑÂ§çÂà∂Ë°®ÁöÑÊúÄÂ∞è CheckpointTs ‰Ωú‰∏∫ minCheckpointTs„ÄÇ</li>
<li>changefeed-barrierTs Âú® Changefeed ÂàùÂßãÂåñÊó∂ÔºåËÆ∞ÂΩï‰∏ãÂØπÂ∫îÁöÑ ChangefeedIDÔºåÂú®ÊØèÊ¨°ÂèñÂ∞èÁöÑ BarrierTs ‰Ωú‰∏∫ÂΩìÂâç BarrierTs„ÄÇ
Ê∂à‰∫°Ôºö
changefeed„ÄÅchangefeed-barrierTs Âú® Changefeed ÈáäÊîæËµÑÊ∫êÊó∂ÔºåÂà†Èô§ÂØπÂ∫î ChangefeedIDÔºõ
instance-changefeed Âú® Processor ÈÄÄÂá∫Êó∂ÔºåÂà†Èô§ÂØπÂ∫î ChangefeedIDÔºõ
‰ΩúÁî®ÔºöÂàÜÂà´‰ªé changefeed „ÄÅÊØè‰∏™ Capture ‰∏äÁöÑ changefeed Áúã changefeed ÁöÑ minCheckpointTsÔºåË°®Á§∫ changefeed ÂêåÊ≠•Âà∞‰∏ãÊ∏∏ÁöÑÊúÄÂ∞èÊó∂Èó¥„ÄÇchangefeed-barrierTs Ë°®Á§∫ÂΩìÂâçÂêåÊ≠•ÁöÑ DDL Âèä syncPoint ÊúÄÂ∞èÊó∂Èó¥„ÄÇ
ÂéüÁêÜÔºöBarrierTs Ë¢´Â∞ÅË£ÖÂú® Changefeed struct ÂÜÖÈÉ®Ôºå‰∏ªË¶ÅÊúâ 3 Á±ªddlJobBarrier„ÄÅsyncPointBarrier„ÄÅfinishBarrierÔºåÊàëÁêÜËß£ ‰∏ªË¶ÅÊòØ‰∏∫‰∫ÜÂÆûÁé∞ exactly once Âä†ÁöÑÂ±ûÊÄßÔºåÂÖ∑‰ΩìÂÆûÁé∞Â∞±ÊòØÂÆûÈ™åÁâπÊÄß TiCDC syncpoint--&gt; <a href="https://pingcap.feishu.cn/wiki/wikcndyqbDagcVc99chsfkH5Rjf" target="_blank" rel="noreferrer">https://pingcap.feishu.cn/wiki/wikcndyqbDagcVc99chsfkH5Rjf</a></li>
</ol>
<p>Changefeed resolved ts
‰∫ßÁîüÔºöchangefeed„ÄÅinstance-changefeed ÈááÁî® Prometheus Guage Á±ªÂûãÁªüËÆ°ÔºåÂú® Capture ËøêË°åÊó∂ËØ•ÊåáÊ†áÂàùÂßãÂåñÔºõ
ÂèòÊõ¥Ôºö</p>
<ol>
<li>changefeed Âêå Changefeed checkpoint ÊåáÊ†áÔºõ</li>
<li>instance-changefeed Âêå Min resolved table ID ÊåáÊ†áÔºõ
Ê∂à‰∫°Ôºö</li>
<li>changefeed Âêå Changefeed checkpoint ÊåáÊ†áÔºõ</li>
<li>instance-changefeed Âêå Min resolved table ID ÊåáÊ†áÔºõ
‰ΩúÁî®ÔºöÂàÜÂà´‰ªé changefeed „ÄÅÊØè‰∏™ Capture ‰∏äÁöÑ changefeed Áúã changefeed ÁöÑ minResolvedTs„ÄÇ</li>
</ol>
<p>Changefeed checkpoint lag
‰∫ßÁîüÔºöchangefeed„ÄÅinstance-changefeed ÈááÁî® Prometheus Guage Á±ªÂûãÁªüËÆ°ÔºåÂú® Capture ËøêË°åÊó∂ËØ•ÊåáÊ†áÂàùÂßãÂåñÔºõ
ÂèòÊõ¥Ôºö</p>
<ol>
<li>changefeed Âêå Changefeed checkpoint ÊåáÊ†áÔºåÂîØ‰∏ÄÁöÑ‰∏çÂêåÊòØËÆ°ÁÆóÊñπÂºèÔºåOwner ‰ºö‰æøÂà©ÊâÄÊúâ Capture Âèñ minCheckpointTsÔºåÂèñ pd ÂΩìÂâç tso Áâ©ÁêÜ‰ΩçÂáè checkpointTsÔºõ</li>
<li>instance-changefeed Âêå Min resolved table ID ÊåáÊ†áÔºåÂîØ‰∏ÄÁöÑ‰∏çÂêåÊòØËÆ°ÁÆóÊñπÂºèÔºåÈÅçÂéÜË¥üË¥£ÁöÑÊâÄÊúâÂ§çÂà∂Ë°®ÂèñÂá∫ minCheckpointTsÔºåÂÜçÂèñ pd ÂΩìÂâç tso Áâ©ÁêÜ‰ΩçÂáè checkpointTs ÂæóÂá∫Âª∂ËøüÊó∂Èó¥Ôºõ
Ê∂à‰∫°Ôºö</li>
<li>changefeed Âêå Changefeed checkpoint ÊåáÊ†áÔºõ</li>
<li>instance-changefeed Âêå Min resolved table ID ÊåáÊ†áÔºõ
‰ΩúÁî®ÔºöÂàÜÂà´‰ªé changefeed „ÄÅÊØè‰∏™ Capture ‰∏äÁöÑ changefeed Áúã changefeed ÁöÑ minCheckpointTs„ÄÇ</li>
</ol>
<p>Changefeed resolved ts lag
‰∫ßÁîüÔºöchangefeed„ÄÅinstance-changefeed ÈááÁî® Prometheus Guage Á±ªÂûãÁªüËÆ°ÔºåÂú® Capture ËøêË°åÊó∂ËØ•ÊåáÊ†áÂàùÂßãÂåñÔºõ
ÂèòÊõ¥Ôºö</p>
<ol>
<li>changefeed Âêå Changefeed checkpoint ÊåáÊ†áÔºåÂîØ‰∏ÄÁöÑ‰∏çÂêåÊòØËÆ°ÁÆóÊñπÂºèÔºåOwner ‰ºö‰æøÂà©ÊâÄÊúâ Capture Âèñ minResolvedTsÔºåÂèñ pd ÂΩìÂâç tso Áâ©ÁêÜ‰ΩçÂáè checkpointTsÔºõ</li>
<li>instance-changefeed Âêå Min resolved table ID ÊåáÊ†áÔºåÂîØ‰∏ÄÁöÑ‰∏çÂêåÊòØËÆ°ÁÆóÊñπÂºèÔºåÈÅçÂéÜË¥üË¥£ÁöÑÊâÄÊúâÂ§çÂà∂Ë°®ÂèñÂá∫ minResolvedTsÔºåÂÜçÂèñ pd ÂΩìÂâç tso Áâ©ÁêÜ‰ΩçÂáè checkpointTs ÂæóÂá∫Âª∂ËøüÊó∂Èó¥Ôºõ
Ê∂à‰∫°Ôºö</li>
<li>changefeed Âêå Changefeed checkpoint ÊåáÊ†áÔºõ</li>
<li>instance-changefeed Âêå Min resolved table ID ÊåáÊ†áÔºõ
‰ΩúÁî®ÔºöÂàÜÂà´‰ªé changefeed „ÄÅÊØè‰∏™ Capture ‰∏äÁöÑ changefeed Áúã changefeed ÁöÑ minResolvedTs„ÄÇ</li>
</ol>
<p>Changefeed checkpoint derivative
Â§çÁî®ÁöÑ Changefeed checkpoint ÊåáÊ†áÔºåÊâÄ‰ª•‰∫ßÁîü„ÄÅÂèòÊõ¥„ÄÅÊ∂à‰∫°‰∏é Changefeed checkpoint Áõ∏ÂêåÔºå‰ΩÜÊîπÂèò‰∫Ü prometheus Ë°®ËææÂºèÔºå‰ΩøÁî® derive ÂáΩÊï∞Âèñ 1 ÂàÜÈíüÂÜÖÊó∂Â∫èÊï∞ÊçÆÁöÑÁÆÄÂçïÁöÑÁ∫øÊÄßÂõûÂΩíÂØºÊï∞Ôºõ
‰ΩúÁî®ÔºöÈ¢ÑÊµã Changefeed checkpoint ÁöÑÂèòÂåñË∂ãÂäø„ÄÇ
The status of changefeeds
‰∫ßÁîüÔºöÂêå Min resolved table ID ÊåáÊ†áÔºõ
ÂèòÊõ¥ÔºöÂú®ÊØèÊ¨° Owner Tick Êó∂ÔºåÂæ™ÁéØ‰æøÂà© changefeed Áä∂ÊÄÅÔºå0 Ë°®Á§∫ StateNormal„ÄÅ1 Ë°®Á§∫ StateError„ÄÅ2 Ë°®Á§∫ StateFailed„ÄÅ3 Ë°®Á§∫ StateStopped„ÄÅ4 Ë°®Á§∫ StateFinished„ÄÅ5 Ë°®Á§∫ StateRemoved„ÄÇ
Ê∂à‰∫°ÔºöÂú® resign owenr „ÄÅCapture ÈÄÄÂá∫Êàñ Capture ÈÉ®ÁΩ≤Êó∂‰ºöÈáçÁΩÆÔºõ
‰ΩúÁî®ÔºöÂà§Êñ≠ÊØè‰∏™ Changefeed ÁöÑÁä∂ÊÄÅ„ÄÇ</p>
<p>Changefeed checkpoint catch-up ETA
‰∫ßÁîüÔºöÂ§çÁî®ÁöÑ Changefeed checkpoint lag ÁöÑ changefeed Âèä Changefeed checkpoint derivative ÁöÑ changefeed ÊåáÊ†áÈ°π„ÄÇËÆ°ÁÆóÊñπÂºè‰∏∫ÔºåÂèñ checkpoint Âª∂ËøüÊúÄÂ§ßÂÄºÈô§ Changefeed checkpoint ÂèòÂåñÂ¢ûÈáèÔºõ
‰ΩúÁî®ÔºöËØÑ‰º∞ËøΩÂπ≥ÂêåÊ≠•Âª∂Êó∂ÁöÑÊó∂Èó¥„ÄÇ</p>
<p>Schema Storage GC progress
‰∫ßÁîüÔºöapproximate current time (s) Ê∫êËá™ PD ÔºåÂèñÂΩìÂâç PD Áî≥ËØ∑ÁöÑÊúÄÂ§ß TSO Ë°®Á§∫ÈõÜÁæ§ÂΩìÂâçÊó∂Èó¥„ÄÇchangefeed ÈááÁî® Prometheus Guage Á±ªÂûãÁªüËÆ°ÔºåÂú® Capture ËøêË°åÊó∂ËØ•ÊåáÊ†áÂàùÂßãÂåñÔºõ
ÂèòÊõ¥ÔºöÊØèÊ¨° Processor Tick Êó∂ÔºåÂèñ processor ÂØπÂ∫î changefeed ÁöÑ CheckpointTs - 1 ‰Ωú‰∏∫ÁõÆÊ†áÊó∂Èó¥„ÄÇprocessor Âª∫Á´ãÊó∂‰∫ßÁîü„ÄÇ
Ê∂à‰∫°Ôºöprocessor ÈÄÄÂá∫Êó∂Ê∂à‰∫°„ÄÇ
‰ΩúÁî®ÔºöÂú® Processor Âª∫Á´ãÊó∂‰ºöÂàõÂª∫‰∏Ä‰∏™ btree ÂÜÖÂ≠òÁª¥Êä§ Schema ÁöÑÂ§öÁâàÊú¨‰ø°ÊÅØÔºå‰ºöÂú® Tick Êó∂ÂÆöÊúü GCÔºåËØ•Èù¢Êùø‰∏ªË¶ÅÂèçÊò† GC ËøõÂ∫¶Ôºõ
Processor Memory Consumption Per Capture
‰∫ßÁîüÔºö
ÂèòÊõ¥ÔºöTablepipline ‰ºöËøΩË∏™ÊØè‰∏™ Table ÁöÑÂÜÖÂ≠òÊ∂àËÄóÔºåÂú®ÊØèÊ¨° Processor Tick Êó∂Ê±áÊÄªË¥üË¥£ÁöÑÂ§çÂà∂Ë°®ÂÜÖÂ≠òÊ∂àËÄóÔºåÂÜçÁî®ÊÄªÂÜÖÂ≠òÊ∂àËÄóÈô§Ë°®Êï∞ÈáèÔºåÂæóÂá∫ÊØè‰∏™Ë°®Ê∂àËÄóÂÜÖÂ≠òÂùáÂÄº„ÄÇ
‰ΩúÁî®ÔºöÂà§Êñ≠ÂΩìÂâçÂêåÊ≠•Ë°®ÁöÑÂπ≥ÂùáÂÜÖÂ≠òÊ∂àËÄóÊÉÖÂÜµ„ÄÇ
Processor Memory Consumption Per Changefeed
‰∫ßÁîüÔºö
ÂèòÊõ¥ÔºöÂ§çÁî® Processor Memory Consumption Per Capture ÊåáÊ†áÂÄºÔºå‰ΩÜËÆ°ÁÆóÊñπÂºèÊòØÁî®ÊÄªÂÜÖÂ≠òÊ∂àËÄóÈô§ Changefeed Êï∞ÈáèÔºåÂæóÂá∫ÊØè‰∏™ Changefeed Ê∂àËÄóÂÜÖÂ≠òÂùáÂÄº„ÄÇ
‰ΩúÁî®ÔºöÂà§Êñ≠ÂΩìÂâç Changefeed ÁöÑÂπ≥ÂùáÂÜÖÂ≠òÊ∂àËÄóÊÉÖÂÜµ„ÄÇ
PD etcd requests/s
‰∫ßÁîüÔºö
ÂèòÊõ¥ÔºöÊâÄÊúâÁöÑ Capture ‰∏é Etcd ‰∫§‰∫íÈÉΩ‰ºöÈÄöËøá EtcdWorkerÔºåÂú® Etcd ÂÜÖÈÉ®‰ºöËÆ∞ÂΩïÊâÄÊúâÊìç‰ΩúÊ¨°Êï∞ÔºåÊìç‰ΩúÁ±ªÂûãÂåÖÂê´ EtcdPut„ÄÅEtcdGet„ÄÅEtcdDel„ÄÅEtcdTxn„ÄÅEtcdGrant„ÄÅEtcdRevoke„ÄÇ
‰ΩúÁî®ÔºöËøΩË∏™ÊØè‰∏™ Captreure ‰∏é Etcd ‰∫§‰∫íÊÉÖÂÜµ„ÄÇ
Exit error count/m
‰∫ßÁîüÔºö
ÂèòÊõ¥ÔºöÂú®ÊØèÊ¨° Processor Tick ÁöÑÊó∂ÂÄôÔºåÂ¶ÇÊûúÈÅáËßÅ Processor ‰∏çÂèØÂøΩÁï•ÁöÑÈîôËØØÊó∂ Processor ‰æø‰ºöÈÄÄÂá∫Âπ∂Â∞ÜÂØπÂ∫îÂÄºÂä†‰∏Ä„ÄÇ
‰ΩúÁî®ÔºöËøΩË∏™ÊØè‰∏™ Changefeed Âú® Captreure ‰∏äÁöÑ Processor ÁöÑËøêË°åÊÉÖÂÜµ„ÄÇ</p>
<h2 id="mysql-sink-Èù¢Êùø" tabindex="-1">MySQL Sink Èù¢Êùø <a class="header-anchor" href="#mysql-sink-Èù¢Êùø" aria-label="Permalink to &quot;MySQL Sink Èù¢Êùø&quot;"></a></h2>
<p>MySQL sink write duration
‰∫ßÁîüÔºöHistogram Á±ªÂûã
ÂèòÊõ¥ÔºöMySQL Sink Worker Âêë‰∏ãÊ∏∏‰ª• Batch ÊâßË°åÊàêÂäüÁöÑËÄóÊó∂ÔºàÂåÖÂê´ÈáçËØïÁöÑÊó∂Èó¥ÔºâÔºåÊØèÊ¨° sink Âùá‰ºöÂèòÊõ¥ËØ•ÂÄº„ÄÇ
‰ΩúÁî®ÔºöTiCDC ÂºÇÊ≠•Âà∑ÂÜôÊï∞ÊçÆÂÖ•‰∏ãÊ∏∏ÁöÑËÄóÊó∂Áõ¥ÊñπÂõæ„ÄÇËøΩË∏™ MySQL sink ÁöÑËÄóÊó∂ÊÉÖÂÜµÔºàlike sql durationÔºå‰ΩÜ‰∏çÊòØ‰ª•Âçï‰∏™ SQL ‰∏∫Âçï‰ΩçÔºåËÄåÊòØ‰ª•‰∏Ä‰∏™ TxnBatch ‰∏∫Âçï‰ΩçÔºâ„ÄÇ
MySQL sink write duration percentile
Â§çÁî® Flush sink duration ÊåáÊ†áÔºå‰ª•ÂàÜ‰ΩçÂõæÂ±ïÁ§∫„ÄÇ
‰ΩúÁî®ÔºöÊØèÁßíÈíü‰∏≠ 95%„ÄÅ99% Âíå 99.9% ÁöÑÊÉÖÂÜµ‰∏ãÔºåTiCDC ÂºÇÊ≠•Âà∑ÂÜôÊï∞ÊçÆÂÖ•‰∏ãÊ∏∏ÊâÄËä±Ë¥πÁöÑÊó∂Èó¥„ÄÇ
MySQL sink write rows count/s
‰∫ßÁîüÔºö
ÂèòÊõ¥ÔºöÊØèÊ¨° Batch Âêë‰∏ãÊ∏∏ÊâßË°å DML Êó∂ÔºåBatch ‰∏≠ÁöÑË°åÊï∞Ôºõ
‰ΩúÁî®ÔºöÊØèÁßíÈíü‰∏≠ 95%„ÄÅ99% Âíå 99.9% ÁöÑÊÉÖÂÜµ‰∏ãÔºåTiCDC Â∞Ü‰∏Ä‰∏™‰∫ãÂä°ÁöÑ DML ÂàÜ Batch ÂÜôÂà∞‰∏ãÊ∏∏ÊâÄËä±Ë¥πÁöÑÊó∂Èó¥ÔºåÂÖ∂‰∏≠ÊØè‰∏™ Batch ÁöÑË°åÊï∞ËÆ°Êï∞„ÄÇ
MySQL sink write batch size percentile
Â§çÁî® MySQL sink write rows count/s ÊåáÊ†áÔºå‰ª•ÂàÜ‰ΩçÂõæÂ±ïÁ§∫„ÄÇ
‰ΩúÁî®ÔºöÊØèÁßíÈíü‰∏≠ 95%„ÄÅ99% Âíå 99.9% ÁöÑÊÉÖÂÜµ‰∏ãÔºåBatch ÁöÑÊÉÖÂÜµ„ÄÇ
MySQL sink conflict detect duration
‰∫ßÁîüÔºö
ÂèòÊõ¥Ôºö
‰ΩúÁî®ÔºöTiCDC ‰ºöÂ∞Ü‰∏äÊ∏∏‰∫ãÂä°ÊãÜÂàÜÔºåÂπ∂ÂàÜÂèëÁªô‰∏çÂêå worker ÊâßË°å‰ºöÈÄ†Êàê‰∫ãÂä°Èó¥ÁöÑÂÜ≤Á™ÅÔºåÂõ†Ê≠§‰ºöÂú®ÂàÜÂèë‰∫ãÂä°Êó∂ÊèêÂâçÊé¢ÊµãÂ≠òÂú®ÂÜ≤Á™Å„ÄÇÂ¶ÇÊûúÂàÜÂèëÁöÑ‰∫ãÂä°‰∏éÊú¨‰∏Ä‰∏™ worker Â≠òÂú®ÂÜ≤Á™ÅÔºåÂàôÂ∞ÜËØ•‰∫ãÂä°ÂèëÈÄÅÁªô‰∫ßÁîüÂÜ≤Á™ÅÁöÑ worker ÈòüÂàó„ÄÇÂ¶ÇÊûú‰∏éÂ§ö‰∏™ worker Â≠òÂú®ÂÜ≤Á™ÅÔºåÂàôÈúÄË¶ÅÁ≠âÂæÖÂÜ≤Á™ÅÁöÑ‰∫ãÂä°ÊâßË°åÂÆåÂÜçÊâßË°åÊú¨‰∫ãÂä°„ÄÇËØ•ÊåáÊ†áËÆ∞ÂΩïËØ•ËøáÁ®ãÂèëÁîüÁöÑÊó∂Èó¥ÔºåËØÑ‰º∞ÂΩìÂâç TiCDC ÂÜÖÈÉ®ÊòØÂê¶Â≠òÂú®Â§ßÈáè‰∫ãÂä°ÂÜ≤Á™ÅÔºå‰ª•ÁÉ≠ÂäõÂõæÂ±ïÁ§∫„ÄÇ
MySQL sink conflict detect duration percentile
Â§çÁî® MySQL sink conflict detect duration ÊåáÊ†á
‰ΩúÁî®ÔºöÊØèÁßíÈíü‰∏≠ 95%„ÄÅ99% Âíå 99.9% ÁöÑÊÉÖÂÜµ‰∏ãÔºåMySQL ÂÜôÂÖ•ÂÜ≤Á™ÅÊ£ÄÊµãËÄóÊó∂„ÄÇ
MySQL sink ddl execution duration percentile
‰∫ßÁîüÔºö
ÂèòÊõ¥ÔºöËÆ∞ÂΩïÊâßË°å DDL ËÄóÊó∂Ôºõ
‰ΩúÁî®ÔºöTiCDC ËäÇÁÇπ‰∏≠ÂÜô MySQL Á∫øÁ®ãÁöÑË¥üËΩΩÊÉÖÂÜµ„ÄÇ
MySQL sink worker load
‰∫ßÁîüÔºö
ÂèòÊõ¥ÔºöÂú® NewMySQLSink Êó∂ËÆ∞ÂΩïÊØè‰∏™ worker ÂèäÂØπÂ∫î changefeed„ÄÇ
‰ΩúÁî®Ôºösinkworker ÊØèÊâßË°åÊàêÂäü‰∏Ä‰∏™ DML txn ÔºåÈÉΩ‰ºöÂ∞ÜÂÖ∂ËÆ∞ÂΩïÂú® metricBucketSize ‰∏≠„ÄÇÂπ∂ÊåâÁÖß 0-2 row/s„ÄÅ2-10 row/s„ÄÅ10-100 row/s„ÄÅ&gt;100 row/s  ÁöÑÊ°£‰ΩçÂàíÂàÜÂΩìÂâç Sink Worker Ë¥üËΩΩÔºåÂå∫ÂàÜÊâÄÊúâ worker ÂΩìÂâçÁöÑË¥üËΩΩÊÉÖÂÜµ„ÄÇ
large data event size (MySQL)
‰∫ßÁîüÔºö
ÂèòÊõ¥ÔºöÂú® NewMySQLSink Êó∂ËÆ∞ÂΩïÊØè‰∏™ worker ÂèäÂØπÂ∫î changefeed„ÄÇ
‰ΩúÁî®ÔºöÊØèÁßíÈíü‰∏≠ 95%„ÄÅ99% Âíå 99.9% ÁöÑÊÉÖÂÜµ‰∏ãÔºåÂ§ß RowChangedEvent ÁöÑÁªüËÆ°ÊÉÖÂÜµ„ÄÇ
ÂéüÁêÜÔºöÊØèÊ¨°ÊâßË°å DML ‰πãÂâç Capture ‰ºöÊé¢Êµã protobuf Ê∂àÊÅØÂ§ßÂ∞èÔºåÂΩìË∂ÖËøá 128K Êó∂Â∞ÜÂÖ∂ËÆ∞ÂΩï‰ΩçÂ§ß‰∫ãÂä°„ÄÇ</p>
<h2 id="dataflow-Èù¢Êùø" tabindex="-1">Dataflow Èù¢Êùø <a class="header-anchor" href="#dataflow-Èù¢Êùø" aria-label="Permalink to &quot;Dataflow Èù¢Êùø&quot;"></a></h2>
<p>Puller output events/s
‰∫ßÁîüÔºöCounter
ÂèòÊõ¥Ôºö
‰ΩúÁî®Ôºö‰ª• changefeed, instance, type ÂàÜÁªÑÊòæÁ§∫ÔºåTiCDC ËäÇÁÇπ‰∏≠ Puller Ê®°ÂùóÊØèÁßíÊî∂Âà∞Êù•Ëá™ KV client Ê®°ÂùóÁöÑÊï∞ÊçÆÂèòÊõ¥‰∏™Êï∞„ÄÇËøΩË∏™ tikv Âà∞ Capture ÁöÑ event Êé®ÈÄÅÊÉÖÂÜµ„ÄÇ
ÂéüÁêÜÔºöTablepipline ‰ºöÁî≥ËØ∑ TableActor ÂàõÂª∫ÂØπÂ∫îÁöÑ pullerÔºåËÆ∞ÂΩï kv Âèä resolved 2 ÁßçÁ±ªÂûãÁöÑ RegionFeedEvent ÔºåÊØèÊé•Âà∞ 1 ÁªôÂØπÂ∫î‰∫ã‰ª∂‰æøËÆ∞ÂΩï„ÄÇ</p>
<p>Puller output events
Â§çÁî® Puller output events/s Èù¢Êùø</p>
<p>Sorter output events/s
‰∫ßÁîüÔºöCounter
ÂèòÊõ¥Ôºö
‰ΩúÁî®Ôºö‰ª• changefeed, instance, type ÂàÜÁªÑÊòæÁ§∫ÔºåTiCDC ËäÇÁÇπ‰∏≠ÁºìÂ≠òÂú® Sorter Ê®°Âùó‰∏≠ÁöÑÊï∞ÊçÆÂèòÊõ¥‰∏™Êï∞ÔºåÂè™Ë¶Å Actor Êé•Âà∞‰∫ÜËØªÂèñÊ∂àÊÅØ‰æø‰ºö‰ªé LevelDB ‰∏≠ËØªÂèñÂá∫ÂØπÂ∫îÁöÑ EventÔºåÂπ∂Â∞ÜÂÖ∂ËÆ∞ÂΩïÂà∞Â∫îËØ•Âà†Èô§Êï∞ÊçÆÁöÑ Buffer ‰∏≠„ÄÇ
ÂéüÁêÜÔºöTablepipline ‰ºöÁî≥ËØ∑ TableActor ÂàõÂª∫ÂØπÂ∫îÁöÑ sorterÔºåËÆ∞ÂΩï kv Âèä resolved 2 ÁßçÁ±ªÂûãÁöÑ RegionFeedEvent ÔºåÂπ∂Âú® Actor  Sorter Reader ÁöÑ Poll ÊñπÊ≥ï‰∏≠ÂèòÊõ¥ÁõëÊéß„ÄÇ</p>
<p>Puller output events
Â§çÁî® Sorter output events/s</p>
<p>Mounter output events/s
‰∫ßÁîüÔºöGuage
ÂèòÊõ¥Ôºö
‰ΩúÁî®Ôºö
ÂéüÁêÜÔºöÊØè‰∏™ TableActor ÂêØÂä®ÂêéÔºå‰ºöÂêØÂä®ÂØπÂ∫îÁöÑ TableSorterÔºåÊØè‰∏™ Sorter ‰∏≠‰ºöËÆ∞ÂΩï PUT Âíå DELETE Á±ªÂûãÔºàÊ≤°Êúâ Resolved Á±ªÂûãÔºâÁöÑ Event Ëß£Á†Å‰∫ã‰ª∂ÔºåÂú®ÊØè‰∏™ sorterNode ÂêØÂä®Âêé
Mounter output events
Â§çÁî® Mounter output events/s Èù¢Êùø</p>
<p>Table sink output events/s
‰∫ßÁîüÔºöGuage
ÂèòÊõ¥Ôºö
‰ΩúÁî®Ôºö
ÂéüÁêÜÔºöTable Actor ÊØèÊ¨° Poll ÁöÑÊó∂ÂÄôÔºå‰ª• sinkFlushInterval = 500 * time.Millisecond ‰∏∫Âë®ÊúüÂ∞ÜÁªìÊûÑ‰Ωì‰∏≠ËÆ∞ÂΩïÁöÑÂ≠óÊÆµÊõ¥Êñ∞Âà∞ÁõëÊéß‰∏≠ÔºåÂÖ∂Êï∞ÊçÆÁöÑ‰∫ßÁîüÊ∫êËá™ÊØèÊ¨°Âêë‰∏ãÊ∏∏ flush Êó∂ÔºåÂ∞ÜÂÖ∂Âä†ÂêàÂà∞ÁªìÊûÑ‰ΩìÁªüËÆ°Â≠óÊÆµ‰∏≠„ÄÇ
Table sink output events</p>
<p>Sink received events/s
‰ª• flushMetricsInterval = 5 * time.Second ‰∏∫Âë®ÊúüÔºåËÆ≤
Sink received events
Â§çÁî® Sink received events/s Èù¢Êùø</p>
<p>Sink flush rows/s
ÂêåÊ†∑ÊòØÁªìÊûÑ‰ΩìÂ≠óÊÆµ</p>
<p>Sink flush rows</p>
<h2 id="db-Èù¢Êùø" tabindex="-1">DB Èù¢Êùø <a class="header-anchor" href="#db-Èù¢Êùø" aria-label="Permalink to &quot;DB Èù¢Êùø&quot;"></a></h2>
<p>On disk data size
ÂèòÊõ¥Ôºö‰ª• backgroundJobIntervalÔºà15sÔºâ‰∏∫Âë®ÊúüÔºåÂèòÊõ¥ÊåáÊ†áÂÄº„ÄÇ
Ê∂à‰∫°ÔºöCaptureÔºànewBackEndPoolÔºâ ÈÄÄÂá∫Êó∂ÔºåËØ•ÊåáÊ†á‰∏çÂÜçËÆ∞ÂΩïÊñ∞ÂÄº„ÄÇ
‰ΩúÁî®Ôºö‰ª• instance ÂàÜÁ±ªÂ±ïÁ§∫Á£ÅÁõòÂç†Áî®Á©∫Èó¥ÔºåÊúÄÊñ∞Áâà TiCDC ‰ΩøÁî® PebbelDBÔºàLevelDBÔºâ‰Ωú‰∏∫Êï∞ÊçÆÊåÅ‰πÖÂåñÂÆπÂô®Ôºå‰ΩúÁî®‰∏∫Ê£ÄÊµãËØ•ÂÆπÂô®ÂÜÖÊï∞ÊçÆÂ§ßÂ∞è„ÄÇ
ÂéüÁêÜÔºönewBackEndPool ‰∏≠‰ª• 0 ‰∏∫ id Ë¢´ÂàùÂßãÂåñ‰∏∫ metricSorterOnDiskDataSizeGauge ÔºåÊòØ‰∏Ä‰∏™ÂçïÁã¨ÁöÑ goroutine„ÄÇ‰Ωé‰∫é MaxMemoryConsumptionÔºà16GBÔºâ‰∏î‰Ωé‰∫é MaxMemoryPercentageÔºà30%ÔºâÊÉÖÂÜµ‰∏ãÂè™‰ΩøÁî® MemoryBackEndÔºåÂ∞±‰∏ç‰ºöÁî®Âà∞Á£ÅÁõòÁ©∫Èó¥„ÄÇ
In-memory data size
ÂèòÊõ¥Ôºö‰∏é On disk data size Áõ∏Âêå
Ê∂à‰∫°Ôºö‰∏é On disk data size Áõ∏Âêå
‰ΩúÁî®Ôºö‰ª• instance ÂàÜÁ±ªÂ±ïÁ§∫ÁõëÊéßÂÜÖÂ≠òÂç†Áî®ÊÉÖÂÜµ„ÄÇcache-hit-instance Âàô‰ª• instance ÂàÜÁ±ªÂ±ïÁ§∫ PebbleDB ‰∏≠ LRU BlockCache ÁöÑ hit ÊÉÖÂÜµ„ÄÇ
ÂéüÁêÜÔºömemoryBackEnd ÂÜÖÈÉ®Â∞ÅË£Ö‰∫Ü‰∏Ä‰∏™ model.PolymorphicEvent Á±ªÂûãÁöÑÂàáÁâáÔºåÁî®‰∫éÊéíÂ∫èÊï∞ÊçÆ„ÄÇticdc_db_block_cache_access_totalÔºàcache-hit-instanceÔºâ Ê∫êËá™‰∫é PebbleDB ÂÜÖÈÉ®ÔºåÁî®‰∫éÊ£ÄÊµãÁºìÂ≠òÂëΩ‰∏≠ÊÉÖÂÜµ„ÄÇ
Level files
ÂèòÊõ¥Ôºö‰∏é On disk data size Áõ∏Âêå
Ê∂à‰∫°Ôºö‰∏é On disk data size Áõ∏Âêå
‰ΩúÁî®Ôºö‰ª• instance-level ÂàÜÁ±ªÔºåË°®Á§∫ PebbleDB ÊØèÂ±ÇÁöÑÊñá‰ª∂‰∏™Êï∞Ôºå‰ªé Pebble ÁöÑ MetricsÔºàÔºâ Êé•Âè£ÂÆöÊúüÂèñÊï∞ÊçÆÊõ¥Êñ∞ÁõëÊéßÔºõ
ÂéüÁêÜÔºöÈªòËÆ§ÂºÄ 7 Â±ÇÔºåÈÉΩÊòØÁ°¨ÁºñÁ†ÅÁõÆÂâçÊó†Ê≥ïÊõ¥ÊîπÔºåÁ¨¨‰∏ÄÂ±Ç 8 MB Ôºå2~3 Â±ÇÈªòËÆ§‰∏∫Ââç‰∏ÄÂ±Ç 2 ÂÄçÂ§ßÂ∞èÔºåÂÖ∂‰ΩôÂ±ÇÈªòËÆ§ 2 MB„ÄÇ
Write duration
ÂèòÊõ¥ÔºöÊØèÊ¨°Âêë PebbleDB ÂèëÂÜôËØ∑Ê±ÇÊó∂ÔºåËÆ∞ÂΩïËØ∑Ê±ÇÊâßË°åÊó∂Èó¥„ÄÇ
Ê∂à‰∫°ÔºöÂØπÂ∫î Actor ÈÄÄÂá∫Êó∂ÂØπÂ∫îÊåáÊ†á‰∏çÂÜçËÆ∞ÂΩï„ÄÇ
‰ΩúÁî®Ôºö‰ΩøÁî®ÁÉ≠ÂäõÂõæÂ±ïÁ§∫ TiCDC Âú® PebbleDB ÂèëÂÜôËØ∑Ê±ÇÁöÑÊâßË°åÊó∂Èó¥ÔºåÁî®‰∫éÂà§Êñ≠Âú®ÂÜô‰∏äÊòØÂê¶Â≠òÂú®Áì∂È¢à„ÄÇ
ÂéüÁêÜÔºöÂú®Âêë PebbleDB ÂèëËµ∑ WriteÔºàforce writeÔºâ„ÄÅDeleteÔºànon-force writeÔºâ Êó∂ÔºåËÆ∞ÂΩïÊØèÊ¨°ËØ∑Ê±Ç‰ªéÂºÄÂßãÂà∞ÂÆåÊàêÁöÑÊó∂Èó¥„ÄÇNewDBActor ÂàõÂª∫Êó∂ÂØπÂ∫î ActorID ÊåáÊ†áË¢´ËÆ∞ÂΩïÔºåÂÖ≥Èó≠ÂØπÂ∫î DBActor Êó∂ÂØπÂ∫î ActorID ‰∏çÂÜçËÆ∞ÂΩïÔºåÊØèÊ¨°Ë∞ÉÁî® maybeWrite ËÆ∞ÂΩïÂèòÊõ¥„ÄÇ
Write speed
ÂèòÊõ¥ÔºöÂêå Write durationÔºõ
Ê∂à‰∫°ÔºöÂêå Write durationÔºõ
‰ΩúÁî®Ôºöinstance-sorter ‰ª• instance ‰∏∫ÂàÜÁ±ªÔºåÊòæÁ§∫ÂÜôÂÖ• Sorter Actor Êï∞ÊçÆÁöÑÂ§ßÂ∞èÔºõ
instance-amplification ‰ª• instance ‰∏∫ÂàÜÁ±ªÔºåÁî® histogram ÁöÑ total/sum ,Âç≥ÔºöÊØèÂàÜÈíüÂπ≥ÂùáÂÜôÂÖ• PebbelDB Â≠óËäÇÊï∞ Èô§ ÊØèÂàÜÈíüÂπ≥ÂùáÂÜôÂÖ•Ê¨°Êï∞ÔºåÊòæÁ§∫ÊØèÊ¨°Âπ≥ÂùáÂÜôÂÖ•Â≠óËäÇÊï∞ÔºåË°®Á§∫ Event Âú®ËêΩÁõòÊéíÂ∫èÊó∂ÊîæÂ§ßÊÉÖÂÜµÔºõ
instance-disk ‰ª• instance ÂàÜÁ±ªÔºåÊòæÁ§∫ÂÜôÂà∞ PebbleDB ‰∏≠ÁöÑÊï∞ÊçÆÂ§ßÂ∞èÔºõ
ÂéüÁêÜÔºö‰∏é Write duration ÂéüÁêÜÁõ∏ÂêåÔºåÂè™‰∏çËøáËÆ∞ÂΩïÁöÑÊï∞ÊçÆÂèòÊàê‰∫ÜËØ∑Ê±Ç‰∏≠Êï∞ÊçÆÁöÑÂ§ßÂ∞èÔºå‰∏äËø∞ 3 È°πÈÉΩÊòØ ticdc_sorter_db_write_bytes_total ÁöÑ‰∏çÂêåÁªÑÂêàÂèòÂåñÊâÄÂæó„ÄÇ
CPU Usage
ÂèòÊõ¥ÔºöÊØèÊ¨° Actor Á≥ªÁªüÊâßË°å Poll ËØ∑Ê±ÇÊó∂ËÆ∞ÂΩïÁ∫øÁ®ãËÄóÊó∂ÔºåÂèòÊõ¥ËØ•ËÆ∞ÂΩï„ÄÇ
Ê∂à‰∫°ÔºöCapture ÈÄÄÂá∫Êó∂Ôºõ
‰ΩúÁî®Ôºöinstance-name ‰ª• instance Âíå system name ‰∏∫ÂàÜÁ±ªÔºåÁªüËÆ°ÊòæÁ§∫ÊØè‰∏™ worker ÁöÑ CPU Á∫øÁ®ãÁöÑ‰ΩøÁî®ÁéáÔºõ
ÂéüÁêÜÔºöÈªòËÆ§ maxWorkerNum ‰∏∫ 64ÔºåÂ¶ÇÊûúÈÖçÁΩÆÁöÑ numberWorker &lt;= 0 ÂàôÁΩÆ‰∏∫ 1ÔºåÂ¶ÇÊûúÂ§ß‰∫é nunberWorker &gt; maxWorkerNumÔºåÂàôÁΩÆ‰∏∫ maxWorkerNum„ÄÇÂèØÈÖçÁΩÆ NumWorkerPoolGoroutine ‰øÆÊîπÔºå‰ΩÜË¢´ÊïÖÊÑèÈöêËóèÔºåÂç≥ÔºöÂÆòÁΩëÊú™ÁªôÂá∫ TiUP ÈÖçÁΩÆÊñπÊ≥ï„ÄÇÊØèÊ¨° Actor ÊâßË°å Poll ÁöÑÊó∂ÂÄôËÆ∞ÂΩïËøôÊ¨° Actor ÊâßË°å Poll ÁöÑÊó∂Èó¥„ÄÇ
Write bytes
Â§çÁî®ÁöÑ Write speed ÊåáÊ†áÔºå‰ª•ÁÉ≠ÂäõÂõæÁöÑÊñπÂºèÊï¥‰ΩìÊòæÁ§∫ÂÜôÂà∞ PebbleDB ÁöÑÂ§ßÂ∞è„ÄÇ
Write OPS
Â§çÁî®ÁöÑ Write speed ÊåáÊ†áÔºå‰ª•Êó∂Â∫èÂõæÁöÑÊñπÂºèÊï¥‰ΩìÊòæÁ§∫ÊØèÁßíÂÜôÂà∞ PebbleDB ÁöÑÊ¨°Êï∞„ÄÇ
Write delay
ÂèòÊõ¥Ôºö‰ª• 15s ‰∏∫Âë®ÊúüÊõ¥Êñ∞ Sorter Actor ÂèëÁîü WriteStall ÂØºËá¥ÂÜôÂª∂ËøüÁöÑÊó∂Èó¥ÂèäÊ¨°Êï∞„ÄÇ
Ê∂à‰∫°ÔºöPebbleDB ‰∏çÂèëÁîü WriteStall Êó∂‰∏çËÆ∞ÂΩï„ÄÇ
‰ΩúÁî®ÔºöPebbleDB ÂèëÁîü WriteStall Êó∂ËÆ∞ÂΩï„ÄÇ
instance-duration ‰ª• instance ÂàÜÁ±ªÔºåÊòæÁ§∫ TiCDC ÂèëÁîüÂÜôÂª∂ËøüÁöÑÊó∂Èó¥ÔºåÂç≥ÔºöËß¶Âèë PebbleDB WriteStall ÁöÑÂª∂ËøüÊó∂Èó¥„ÄÇ
instance-count ‰ª• instance ÂàÜÁ±ªÔºåÊòæÁ§∫ TICDC ÂèëÁîüÂπ≥ÂùáÊØèÁßíÂÜôÂª∂ËøüÁöÑÂèëÁîüÊ¨°Êï∞„ÄÇ
ÂéüÁêÜÔºöÈÄöËøá‰ª• backgroundJobInterval  Âë®ÊúüÊÄßË∞ÉÁî® p.metricWriteStall.duration.Load() Êü•ËØ¢ PebbleDB ÂèëÁîü WriteStall ÁöÑÊó∂Èó¥ÔºåËÆ∞ÂΩï‰∏∫ÂÜôÂª∂ËøüÁöÑÊó∂Èó¥„ÄÇ
Read duration - First
ÂèòÊõ¥ÔºöÂàõÂª∫ Sorter Êó∂ÔºåÂàùÂßãÂåñ first Ê†áÁ≠æÔºåActor ÊØèÊ¨°Â∞ùËØï‰ª• 0 ‰∏∫ TS Ëé∑ÂèñËø≠‰ª£Âô®Êó∂ÂèëÁîüÂèòÊõ¥ÔºåÂπ∂ËÆ∞ÂΩïÊ∂àËÄóÁöÑÊó∂Èó¥„ÄÇ
Ê∂à‰∫°ÔºöÂΩì Actor ‰∏çÂÜçËé∑ÂèñËø≠‰ª£Âô®ÔºåÊàñ Capture ÈÄÄÂá∫Êó∂‰∏çÂÜçËÆ∞ÂΩïÁ¨¨‰∏ÄÊ¨° Seek ÁöÑÊó∂Èó¥„ÄÇ
‰ΩúÁî®Ôºö‰ª• instance-sorter ‰∏∫ÂàÜÁ±ªÔºåÁî®ÁÉ≠ÂäõÂõæÂΩ¢ÂºèÂ±ïÁ§∫ÊØè‰∏™ instance Âπ≥ÂùáÊØèÂàÜÈíüËé∑ÂèñËø≠‰ª£Âô®ÁöÑËÄóÊó∂„ÄÇ
ÂéüÁêÜÔºöË°®Á§∫ Actor Ëé∑Âèñ‰ª• 0 ‰∏∫ TS Seek Êï¥‰∏™ PebbleDB ÊñπÂºèËé∑ÂèñËø≠‰ª£Âô®ÔºåÂõ†‰∏∫ TS ‰∏∫ 0ÔºåÊâÄ‰ª•‰ºöËø≠‰ª£ÊâÄÊúâÊï∞ÊçÆËæÉ‰∏∫ËÄóÊó∂ÔºåËÆ∞ÂΩïÁ¨¨‰∏ÄÊ¨°Ëø≠‰ª£Ê∂àËÄóÊó∂Èó¥„ÄÇ
Read duration - Next
ÂèòÊõ¥ÔºöÊØèÊ¨°Ëø≠‰ª£ÊéíÂ∫è key Êó∂ÔºåËÆ∞ÂΩïËø≠‰ª£ÊØè‰∏™ Key Êó∂Ê∂àËÄóÁöÑÊó∂Èó¥Ôºõ
Ê∂à‰∫°ÔºöÊ≤°ÊúâËø≠‰ª£ key Êó∂‰∏çÂú®ËÆ∞ÂΩïÔºåÊàñ Sorter ActorÔºàCaptureÔºâ ÈÄÄÂá∫‰∏çÂú®ËÆ∞ÂΩï„ÄÇ
‰ΩúÁî®Ôºö‰ª•ÁÉ≠ÂäõÂõæÂΩ¢ÂºèÔºåË°®Á§∫ÊØèÊ¨°Ëø≠‰ª£ PebbleDB ÁöÑ key ÁöÑËÄóÊó∂Ôºå‰ª•‰æøÊé¢Êü• Pebble Sorter ÊòØÂê¶Â≠òÂú®ÊÄßËÉΩÈóÆÈ¢ò„ÄÇ<br>
Read duration - Release
ÂèòÊõ¥ÔºöÂΩì Actor ÂÖ≥Èó≠Êàñ Pebble Ëø≠‰ª£Âô®‰∏çÂèØÁî®ÔºàÊ≤°ÊúâÁõ∏Âêå key ÂèØËø≠‰ª£‰∫ÜÔºâÊàñË∂ÖËøá iterMaxAliveDurationÔºà10000msÔºâÁöÑÊó∂ÂÄôÔºåÈáäÊîæËø≠‰ª£Âô®ÔºåÂπ∂ËÆ∞ÂΩïÂÖ∂ËÄóË¥πÁöÑÊó∂Èó¥Ôºõ
Ê∂à‰∫°ÔºöÊ≤°ÊúâÂèØËø≠‰ª£ÁöÑ key Êó∂Ôºå Actor Ëø≠‰ª£Âô®‰æø‰∏çËÆ∞ÂΩïÔºåÊàñ Capture ÈÄÄÂá∫Êó∂‰∏çÂÜçËÆ∞ÂΩïÔºõ
‰ΩúÁî®ÔºöÁî®ÁÉ≠ÂäõÂõæÂΩ¢ÂºèÔºåË°®Á§∫ÊØèÊ¨°ÈáäÊîæËø≠‰ª£Âô®ËÄóÊó∂ÊÉÖÂÜµÔºõ
Read OPS - First
Â§çÁî® Read duration ÊåáÊ†áÔºåË°®Á§∫ÊØèÁßíÂÆåÊàêÂ§öÂ∞ëÊ¨°Ëé∑Âèñ Actor Pebble Ëø≠‰ª£Âô®Êìç‰Ωú„ÄÇ
Read OPS - Next
Â§çÁî® Read duration ÊåáÊ†áÔºåË°®Á§∫ÊØèÁßíÂÆåÊàêÂ§öÂ∞ëÊ¨°Ëé∑Âèñ Actor Ëø≠‰ª£ key Êìç‰Ωú„ÄÇ
Read OPS - Release
Â§çÁî® Read duration ÊåáÊ†áÔºåË°®Á§∫ÊØèÁßíÂÆåÊàêÂ§öÂ∞ëÊ¨°Ëé∑Âèñ Actor ÈáäÊîæËø≠‰ª£Âô®Êìç‰Ωú„ÄÇ
Compact duration
ÂèòÊõ¥ÔºöÊØèÊ¨°Ëß¶Âèë Poll ÂØπ PebbleDB ËøõË°å CompactionÔºåËÆ∞ÂΩï‰∏ã‰ªéËß¶ÂèëÂà∞ÂÆåÊàêÁöÑËÄóÊó∂Ôºõ
Ê∂à‰∫°ÔºöÊú™Êª°Ë∂≥Ëß¶Âèë Compaction Êù°‰ª∂Êó∂‰∏çËÆ∞ÂΩïÔºõ
‰ΩúÁî®Ôºö‰ª•ÁÉ≠ÂäõÂõæÁöÑÊñπÂºèÔºåË°®Á§∫ Sorter Âú® Compaction Êìç‰Ωú‰∏äÁöÑÊï¥‰ΩìËÄóÊó∂Ôºå‰ª•‰æøÂàÜÊûê Sorter ÊòØÂê¶Â≠òÂú®ÊÄßËÉΩÈóÆÈ¢ò„ÄÇ
ÂéüÁêÜÔºöCapture ÂêØÂä®Êó∂‰º¥Èöè Actore system ÂêØÂä®Ôºå Comapction ‰∏™Êï∞‰∏éÈªòËÆ§ÂêØÂä®ÁöÑ PebbleDB instance Êï∞ÈáèÁõ∏ÂêåÔºåÂç≥Ôºö 8‰∏™„ÄÇ</p>
<h2 id="events-Èù¢Êùø" tabindex="-1">Events Èù¢Êùø <a class="header-anchor" href="#events-Èù¢Êùø" aria-label="Permalink to &quot;Events Èù¢Êùø&quot;"></a></h2>
<p>Eventfeed count
ÂèòÊõ¥Ôºö
Ê∂à‰∫°Ôºö
‰ΩúÁî®Ôºö
ÂéüÁêÜÔºö
ÂØπ‰∫é ticdc_kvclient_event_feed_count ÂΩì changefeed ÂàõÂª∫Êó∂‰ºöÂú® puller ‰∏ãÂàùÂßãÂåñ‰∏Ä‰∏™  changefeedSesionÔºåÂàõÂª∫ÊàêÂäüÂàôËÆ°Êï∞‰ºöÂ¢ûÈïøÔºåsession goroutine Êé®Âá∫‰ºöÈôç‰ΩéÔºõ
ÂØπ‰∫é grpc_client_started_total Âπ∂Ê≤°ÊúâÂú®‰ª£Á†Å‰∏≠ÊâæÂà∞ÂØπÂ∫îÂÜÖÂÆπÔºå‰º∞ËÆ°ÊòØÂ§Ñ‰∫é‰ªÄ‰πàËÄÉËôëÂêéÊù•Âà†Èô§‰∫ÜËøô‰∏™ÊåáÊ†á„ÄÇ</p>
<p>Event size percentile
ÂèòÊõ¥Ôºö
received Ë°®Á§∫ regionWorker ÊØèÂ§ÑÁêÜ‰∏Ä‰∏™ EventÔºàÂåÖÂê´Event_Entries_„ÄÅEvent_Admin_„ÄÅEvent_Error„ÄÅEvent_ResolvedTsÔºâÔºå‰æøËÆ∞ÂΩï‰∏ãËøô‰∏™ Event ÁöÑ Grpc Â§ßÂ∞èÔºõ
dropped Ë°®Á§∫Âú®Â§ÑÁêÜ Event Êó∂ÔºåÂ¶ÇÊûúÊòØ Event_Entries_ Á±ªÂûãÊï∞ÊçÆÔºåÂàôËÆ∞ÂΩï‰∏ã Grpc Â§ßÂ∞èÔºõ
Ê∂à‰∫°ÔºöregionWorker ÈÄÄÂá∫Êó∂‰∏çÂÜçËÆ∞ÂΩïÊï∞ÊçÆÔºõ
‰ΩúÁî®ÔºöÔºà999 Á∫øÔºå99 Á∫øÔºâÂà§Êñ≠ RregionWorker Âú®Êé•Âèó TiKV ËøîÂõûÁöÑÊï∞ÊçÆÂ§ÑÁêÜ‰∏äÊòØÂê¶Â≠òÂú®Áì∂È¢àÔºåÊòØÂê¶Â≠òÂú®Â§ß EventÔºõ
ÂéüÁêÜÔºöregionWorker ‰ª• changefeedID„ÄÅeventFeedSessionÔºàÂÖ∂ÂÆûÂ∞±ÊòØ table range ÁöÑ region ‰∫§‰∫í‰ºöËØùÔºâ„ÄÅstoreAddr Ê†áÂÆöÂîØ‰∏ÄÁöÑ region WorkerÔºå‰πüÂ∞±ÊòØËØ¥ 1 ‰∏™ region worker ÂØπÂ∫îË°®Áª¥Êä§ÁùÄ N ‰∏™Êï∞ÈáèÁöÑ table regionÔºåÂΩìË∂ÖËøá regionWorkerInputChanSizeÔºà128Ôºâ * 0.7 ‰æøÂ§ÑÁêÜÂØπÂ∫îÊé•Êî∂Âà∞ÁöÑ event„ÄÇWorkerConcurrent Êú¨Ë∫´ÊòØ‰∏™ÊúçÁî®Á∫øÁ®ãÊ±†ÔºåÈªòËÆ§ 8 ‰∏™ÔºåÂç≥ÊØè‰∏™ tableRange ÁöÑÂ§ÑÁêÜ‰ºöËµ∑ 8 ‰∏™ region Worker ÂéªÂ§ÑÁêÜÊé•Êî∂Âà∞ÁöÑ event„ÄÇ
Eventfeed error/m
ÂèòÊõ¥Ôºö
{{type}}
NotLeader
EpochNotMatch
RegionNotFound
DuplicateRequest
Unknown
RPCCtxUnavailable
SendRequestToStore
ConnectToStore</p>
<p>transfer-leader„ÄÅmove-regionÊòØ‰ªé PD Ëé∑ÂèñÁöÑ schedule operator ÂàõÂª∫ÊÉÖÂÜµÔºåÁî®Êà∑ÂàÜÊûê error ÂèëÁîüÂéüÂõ†Ôºõ
Ê∂à‰∫°ÔºöPuller Êàñ Capture ÈÄÄÂá∫Êó∂
‰ΩúÁî®ÔºöÂàÜÊûêÂΩìÂâçÊé•Êî∂ tikv ÊòØÂê¶Â≠òÂú®ÈóÆÈ¢òÔºåÊàñÂ§ßÈáè transfer-leader ÂØºËá¥ÊÄßËÉΩÂú∞‰∏ãÔºõ
ÂéüÁêÜÔºöÈíàÂØπ ticdc_kvclient_event_feed_error_count ÔºåÊØè‰∏™ eventFeedSession ‰ºöÁªüËÆ°‰∏é tikv ÈìæÊé•ËøáÁ®ã‰∏≠ÂèëÁîüÁöÑÈîôËØØÔºåÂ¶ÇÂÖ∂ÂêçÊâÄÁ§∫ÔºåÂâç 5 È°πÊòØ‰∏é Event Áõ∏ÂÖ≥ TiKV ËøîÂõûÁöÑ„ÄÇ</p>
<p>KV client receive events/s
ÂèòÊõ¥ÔºöregionWorker Â§ÑÁêÜ event Êó∂ÔºåÊõ¥Êñ∞ÂØπÂ∫îÊåáÊ†áÔºõ
Ê∂à‰∫°ÔºöPuller Êàñ Capture ÈÄÄÂá∫Êó∂
‰ΩúÁî®ÔºöÂØπ Event_INITIALIZED„ÄÅEvent_COMMITTED„ÄÅEvent_COMMIT„ÄÅEvent_PREWRITE„ÄÅEvent_ROLLBACK„ÄÅnative-resolved„ÄÅcommit„ÄÅcommitted ÂàÜÁ±ªÁªüËÆ°ÔºåÂàÜÊûêÊé•ÂèóÂà∞ event ÁöÑÂêûÂêêÊÉÖÂÜµÔºåÂèäÁøªËØë grpc event ‰∏∫ region event Êó∂ÊòØÂê¶Â≠òÂú®ÊÄßËÉΩÈóÆÈ¢ò„ÄÇ
ÂéüÁêÜÔºöÔºåÂ∏¶ Event_ ÂâçÁºÄÁöÑË°®Á§∫‰ªé GRPC Êé•Âà∞ÁöÑÊï∞ÊçÆÔºånative-resolved Ë°®Á§∫ regionWorker Â§ÑÁêÜ resolvedTs ÁöÑÊ¨°Êï∞Ôºåcommit„ÄÅcommitted ‰∏éÂ∏¶ÂâçÁºÄÁöÑÁõ∏ÂØπÂ∫îÔºåÂ¶ÇÔºöEvent_COMMITTED Á±ª event ‰ºöÁªèËøá regionWorker ‰ºöÂ∞ÜÂÖ∂ grpc event ËΩ¨Êç¢Â∞ÅË£ÖÊàêÂÜÖÈÉ® reventÔºàregion EventÔºâ„ÄÇ
Puller output events/s
ÂèòÊõ¥ÔºöÂè™Ë¶Å puller Âú®ÊåÅÁª≠‰∏çÊñ≠ÁöÑ pull Êï∞ÊçÆ‰æøËÆ∞ÂΩï‰∏ãÊØè‰∏™ event Â§ÑÁêÜÔºõ
Ê∂à‰∫°Ôºöpuller ÈÄÄÂá∫Ôºõ
‰ΩúÁî®ÔºöËÆ∞ÂΩï puller ÂêûÂêêÊÉÖÂÜµÔºõ
ÂéüÁêÜÔºöÂú® puller ‰∏≠ÊØèÂ§ÑÁêÜ‰∏Ä‰∏™ event ‰æøËÆ∞ÂΩï‰∏ãÂØπÂ∫îÁä∂ÊÄÅÔºåËÆ∞ÂΩïÁöÑ event ÂàÜ‰∏∫ kvÔºåresolved 2 ‰∏≠ÔºåÂàÜÂà´Ê∫êËá™ tikv„ÄÇ
Sink buffer size
Ë≤å‰ººÂ∑≤Ë¢´Â∫üÂºÉÔºåÊó†Ê≥ïÊâæÂà∞ÂØπÂ∫îÊåáÊ†á
Entry sorter sort duration
ÂèòÊõ¥Ôºö
Ê∂à‰∫°Ôºö
‰ΩúÁî®Ôºö
ÂéüÁêÜÔºöpuller ËæìÂá∫ÁöÑ event ‰ºöË¢´ sorter Âä†ËΩΩÂà∞ resolvedTsGroup ‰∏≠ÔºåÊØè‰∏™ table ÂØπÂ∫î‰∏Ä‰∏™ SorterActor„ÄÇÊØèÈöî 1s Â∞Ü resolvedTsGroup ‰∏é unsorted Êï∞ÊçÆÊ∑∑Âêà‰∏ÄËµ∑ÔºåÂÖ®ÈÉ®ÂçáÂ∫èÊéíÂ∫èÂêé„ÄÇ
Entry sorter sort duration percentile
Â§çÁî® Entry sorter sort duration ÁõëÊéßÊåáÊ†á</p>
<p>Entry sorter merge duration
ÂèòÊõ¥Ôºö
Ê∂à‰∫°Ôºö
‰ΩúÁî®ÔºöËÆ∞ÂΩïÊØèÊ¨° merge ÁöÑËÄóÊó∂Ôºõ
ÂéüÁêÜÔºöÔºåÂèñ resolvedTsGroup ÊúÄÂêé‰∏Ä‰∏™ ResolvedTs ‰Ωú‰∏∫ maxResolvedTsÔºåÁªèËøáÊéíÂ∫èÂêéÁöÑ resolvedTsGroup ‰ºöÂÜç‰ΩøÁî®ÂèåÊåáÈíàÊ≥ï‰∏é‰∏ä‰∏ÄÊ¨°ÊéíÂ∫èÁöÑÁªìÊûúÊÆãÁïôÁöÑÔºåÂ§ß‰∫é‰∏ä‰∏ÄÊ¨°ÊØîËæÉ maxResolvedTs ÁöÑÁªìÊûúÊØîËæÉÔºåÂ∞ÜÂ§ß‰∫éÊú¨Ê¨° maxResolvedTs ÁöÑ event ‰øùÁïô‰∏ãÊù•Áî®‰∫é‰∏ã‰∏ÄÊ¨°ÊØîËæÉÔºåÂ∞è‰∫éÊú¨Ê¨° maxResolvedTs ÁöÑËæìÂá∫Âà∞ Mounter ÂéªËß£Á†Å RawKV Êï∞ÊçÆ„ÄÇ
Entry sorter merge duration percentile
Â§çÁî® Entry sorter merge duration ÁõëÊéßÊåáÊ†á</p>
<p>Mounter unmarshal duration
ÂèòÊõ¥Ôºö
Ê∂à‰∫°Ôºö
‰ΩúÁî®ÔºöMounter ‰ª• Entry Ëß£Á†Å RawKV ‰∏∫Â∏¶Êúâ TableID ÁöÑ EventÔºåÂú®Ê≠§ËøáÁ®ã‰∏≠ËÆ∞ÂΩï‰∏ãËß£Á†ÅÊØèË°åÂèòÊõ¥Êï∞ÊçÆÁöÑËÄóÊó∂„ÄÇ
Mounter unmarshal duration percentile</p>
<p>KV client dispatch events/s
ÂèòÊõ¥Ôºö
Ê∂à‰∫°Ôºö
‰ΩúÁî®Ôºö
ÂéüÁêÜÔºöregionWorker ÁöÑÂàÜÂèëÈÄüÂ∫¶Ôºõ
ÂõæÂÉè 2 Â§çÁî®‰∫Ü KV client batch resolved sizeÔºõ</p>
<p>KV client batch resolved size
ÂèòÊõ¥Ôºö
Ê∂à‰∫°Ôºö
‰ΩúÁî®ÔºöËÆ∞ÂΩïÊØèÊ¨°‰ªé tikv Êé•Êî∂Âà∞ÁöÑÊØè‰∏™ ChangeDataEvent ‰∏≠ÁöÑ region ‰∏™Êï∞Ôºõ
ÂéüÁêÜÔºö
KV client scanning regions
ÂèòÊõ¥Ôºö
Ê∂à‰∫°Ôºö
‰ΩúÁî®ÔºöÊØèÊ¨°Âêë TiKV ÂØπÂ∫î Region ÂèëÈÄÅËØ∑Ê±ÇÈÉΩ‰ºöË¢´ËÆ∞ÂΩïÔºåÁî®‰∫éÂàÜÊûê Capture Êàñ Changefeed Âêë TiKV ËØ∑Ê±ÇÁöÑ RPCË¥üËΩΩÊÉÖÂÜµÔºõ
ÂéüÁêÜÔºö
KV client gRPC stream count
ÂèòÊõ¥Ôºö
Ê∂à‰∫°Ôºö
‰ΩúÁî®ÔºöÊØèÈöî 1ms ËÆ∞ÂΩï‰∏ã GRPC Á∫øÁ®ãÊ±†‰∏≠Ê¥ªË∑ÉËøûÊé•Êï∞ÊÉÖÂÜµ
ÂéüÁêÜÔºö
KV client cached regions
ÂèòÊõ¥Ôºö
Ê∂à‰∫°Ôºö
‰ΩúÁî®ÔºöÂ¢ûÈáèÊâ´Èò∂ÊÆµÔºå‰ºöÁî® regionRouterChanSizeÔºà16ÔºâÂéªÈôêÂà∂ÂèëÂæÄ tikv ÁöÑ region ËØ∑Ê±ÇÊï∞ÈáèÔºåË∂ÖËøáÈÉ®ÂàÜ‰ºöÂÖà Cache Âú®ÂÜÖÂ≠ò‰∏≠„ÄÇ
ÂéüÁêÜÔºö
Estimate remaining time for initialization
ÂèòÊõ¥Ôºö
Ê∂à‰∫°Ôºö
‰ΩúÁî®ÔºöÁî® cache ÁöÑ region Êï∞ÈáèÈô§ 1 ÂàÜÈíüÂÜÖÂèòÂåñÊÉÖÂÜµÔºå‰º∞ËÆ°Â§ö‰πÖÂ¢ûÈáèÊâ´ËøáÁ®ã‰∏≠ÊâÄÊúâ region ÈÉΩÂª∫Á´ãÁöÑ grpc stream ÊâÄÈúÄÁöÑÊó∂Èó¥„ÄÇ
ÂéüÁêÜÔºö</p>
<h2 id="unified-sorter-Èù¢Êùø" tabindex="-1">Unified Sorter Èù¢Êùø <a class="header-anchor" href="#unified-sorter-Èù¢Êùø" aria-label="Permalink to &quot;Unified Sorter Èù¢Êùø&quot;"></a></h2>
<p>Unified Sorter intake rate
ÂèòÊõ¥Ôºö
Ê∂à‰∫°Ôºö
‰ΩúÁî®Ôºö
ÂéüÁêÜÔºöÊØè‰∏™ sorter ‰ºöÂ∞ÜÊé•Êî∂Âà∞ÁöÑ event ËÆ°Êï∞ÔºåÂ¶ÇÊûúÊòØ resolvedEvent ÂàôËÆ∞ÂΩï‰∏∫ resolved ÔºåÂ¶ÇÊûúÊòØ kv ÂèòÂåñÂàôËÆ∞‰∏∫ kv„ÄÇ
Unified Sorter event output rate
ÂèòÊõ¥Ôºö
Ê∂à‰∫°Ôºö
‰ΩúÁî®Ôºö
ÂéüÁêÜÔºöÊØèÊ¨° Poll Êó∂Ôºå‰ºöËÆ∞ÂΩï‰∏ãÊú¨Ê¨° Actor Â§ÑÁêÜËøáÁ®ã‰∏≠ÔºåÂá∫Áé∞Âú® channel ‰∏≠ÁöÑÊï∞ÊçÆÂÖ®ÈÉ®ËÆ∞ÂΩï‰∏ãÊù•„ÄÇ
Unified Sorter on disk data size
ÂèòÊõ¥Ôºö
Ê∂à‰∫°Ôºö
‰ΩúÁî®Ôºö
ÂéüÁêÜÔºöÊØèÈöî backgroundJobInterval Ôºà15sÔºâÂÆöÊúüÊ£ÄÊü•‰∏ã PebbleDB ‰∏≠Á£ÅÁõòÂç†Áî®Â§ßÂ∞è„ÄÇ
Unified Sorter in-memory data size
ÂèòÊõ¥Ôºö
Ê∂à‰∫°Ôºö
‰ΩúÁî®Ôºö
ÂéüÁêÜÔºöÊØèÈöî backgroundJobInterval Ôºà15sÔºâÂÆöÊúüÊ£ÄÊü•‰∏ãËØÑ‰º∞ÁöÑÂÜÖÂ≠òÂç†Áî®ÊÉÖÂÜµ„ÄÇ
Unified Sorter flush sizes
ÂèòÊõ¥Ôºö
Ê∂à‰∫°Ôºö
‰ΩúÁî®Ôºö
ÂéüÁêÜÔºöÂú® Sorter ÂêØÂä®Êó∂Ôºå‰ºöÂàùÂßãÂåñ HeapSorter Âπ∂ÈÖçÁΩÆ flush Á≠ñÁï•ÔºåË∂ÖËøáChunkSizeLimit ÊàñÂ∞è‰∫é flushRateLimitPerSecondÔºå‰æø‰ºöÂ∞ÜÂÖ∂ÂÜÖÂ≠òÊï∞ÊçÆ flush Âà∞Á£ÅÁõò‰∏ä„ÄÇ
Unified Sorter merge size
ÂèòÊõ¥Ôºö
Ê∂à‰∫°Ôºö
‰ΩúÁî®Ôºö
ÂéüÁêÜÔºöSorter ÂêØÂä®Âêé‰ºöÂΩíÂπ∂Êìç‰ΩúÂçïÊâπÊ¨°‰∏≠Â§ÑÁêÜÁöÑ event Êï∞Èáè„ÄÇ(ÁõÆÂâç‰∏çÂ§™ÊáÇ‰∏∫‰ªÄ‰πàË¶ÅÂΩíÂπ∂ merge)</p>
<h2 id="etcd-Èù¢Êùø" tabindex="-1">Etcd Èù¢Êùø <a class="header-anchor" href="#etcd-Èù¢Êùø" aria-label="Permalink to &quot;Etcd Èù¢Êùø&quot;"></a></h2>
<p>Etcd MVCC DB total size
ÂèñËá™ PD Ë°®Á§∫ ETCD Âç†Áî®ÁöÑÁ©∫Èó¥Â§ßÂ∞èÔºåÁî®‰∫éÂàÜÊûêÊòØÂê¶Â≠òÂú®ÊÄßËÉΩÈóÆÈ¢ò„ÄÇ
Etcd health check duration
Capture ‰ºöÊØèÈöî 3s ‰ºö check ‰∏Ä‰∏ãÊâÄÊúâ PD ÁöÑÁä∂ÊÄÅÔºåÂÅöÁöÑÊìç‰ΩúÊòØ get ‰∏ã /pd/api/v1/health ÁöÑÊé•Âè£ÂÄºÔºåÊ≠§ËøáÁ®ã‰∏≠ËÄóË¥πÁöÑÊó∂Èó¥Ë¢´ËØ•ÊåáÊ†áËÆ∞ÂΩï‰∏ãÊù•„ÄÇ
EtcdWorker exec etcd txn duration
ETCD worker ÊØèÊ¨° Tick Êìç‰ΩúÁöÑËÄóÊó∂Ë¢´ËÆ∞ÂΩï‰∏ãÊù•ÔºåÂèØËÉΩÊòØ Owner/Processor ÁöÑ TickÔºåÂõ†‰∏∫‰∏ãÈù¢ÈÉΩËµ∞ etcdWorker„ÄÇ
EtcdWorker tick reactor duration
Â§çÁî® EtcdWorker exec etcd txn duration ÊåáÊ†áÔºåÂè™ÊòØÊç¢‰∫Ü‰∏ÄÁßçÂ±ïÁ§∫ÊñπÂºè„ÄÇ
EtcdWorker exec etcd txn duration
EtcdWorker ÊØèÂÅö‰∏ÄÊ¨° txn Â§ÑÁêÜÔºåÈÉΩ‰ºöËÆ∞ÂΩï‰∏ãÊâßË°åËÄóÊó∂„ÄÇ
EtcdWorker exec etcd txn duration percentile
Â§çÁî® EtcdWorker exec etcd txn duration ÊåáÊ†á„ÄÇ
EtcdWorker txn size
ËÆ∞ÂΩï‰∏ãÊØèÊ¨°ÊâßË°å txn Êìç‰ΩúÊó∂ÁöÑÊï∞ÊçÆÂ§ßÂ∞è„ÄÇ
EtcdWorker txn size percentile
Â§çÁî® EtcdWorker txn size Â§ßÂ∞è„ÄÇ
Etcd 99% WAL fsync duration
ÂèñËá™ PDÔºåË°®Á§∫WALÊó•ÂøóÊåÅ‰πÖÂåñÁöÑfsyncÁ≥ªÁªüË∞ÉÁî®Âª∂Êó∂Êó∂Èó¥ÔºåÁî®‰∫éÂàÜÊûê PD ‰∏≠ ETCD ÁöÑÊÄßËÉΩ„ÄÇ
Etcd 99% Handle transactions duration
ÂèñËá™ PDÔºåË°®Á§∫ PD ÊâßË°å txn ‰∏é ETCD ‰∫§‰∫íÊó∂ÁöÑÂª∂ËøüÊó∂Èó¥„ÄÇ</p>
<h2 id="kvclient-Èù¢Êùø" tabindex="-1">KvClient Èù¢Êùø <a class="header-anchor" href="#kvclient-Èù¢Êùø" aria-label="Permalink to &quot;KvClient Èù¢Êùø&quot;"></a></h2>
<p>ResolveLock count/m
<a href="https://github.com/tikv/client-go/blob/57c12f7c64f626a478374de3c405c5134ea3cd42/metrics/metrics.go#L183" target="_blank" rel="noreferrer">https://github.com/tikv/client-go/blob/57c12f7c64f626a478374de3c405c5134ea3cd42/metrics/metrics.go#L183</a> Ë°®Á§∫Ëß£ÈîÅÂä®‰ΩúÁöÑÊ¨°Êï∞„ÄÇ
RegionCache operation/s
<a href="https://github.com/tikv/client-go/blob/681fb6e537b5b114f07cbc9eb0d6564742a470aa/metrics/shortcuts.go#L195-L205" target="_blank" rel="noreferrer">https://github.com/tikv/client-go/blob/681fb6e537b5b114f07cbc9eb0d6564742a470aa/metrics/shortcuts.go#L195-L205</a> Ë°®Á§∫ regionCache ËØ∑Ê±ÇÁ±ªÂûãÂèäËØ∑Ê±ÇÁä∂ÊÄÅÁöÑÁªüËÆ°
Backoff percentiles
<a href="https://github.com/tikv/client-go/blob/681fb6e537b5b114f07cbc9eb0d6564742a470aa/metrics/shortcuts.go#L158-L169" target="_blank" rel="noreferrer">https://github.com/tikv/client-go/blob/681fb6e537b5b114f07cbc9eb0d6564742a470aa/metrics/shortcuts.go#L158-L169</a> Ë°®Á§∫ client ËØ∑Ê±ÇÂèëÁîü backoff ÁöÑ‰∏ªË¶ÅÁ±ªÂûãÁªüËÆ°</p>
<h2 id="tikv-Èù¢Êùø" tabindex="-1">TiKV Èù¢Êùø <a class="header-anchor" href="#tikv-Èù¢Êùø" aria-label="Permalink to &quot;TiKV Èù¢Êùø&quot;"></a></h2>
<p>CDC CPU
Ê∂âÂèä CDC Â∑•‰ΩúÁ∫øÁ®ãÁöÑÂç†Áî®ÊÉÖÂÜµÔºåÂú® tikv ‰∏≠ÈÄöËøá pid Êü• linux Êìç‰ΩúÁ≥ªÁªü‰ø°ÊÅØËé∑Âæó„ÄÇ
CDC network traffic
TiKV Áªô Capture Êé® Êï∞ÊçÆ‰πãÂâçÈÉΩ‰ºöËÆ∞ÂΩïÊé®ÈÄÅÁöÑ Event Êï∞ÊçÆÁöÑÂ§ßÂ∞èÔºå event„ÄÅresolved_ts ÂàÜÂà´ 2 Áßç‰∏çÂêå eventÔºåresolved_ts ÊòØ event ÁöÑÂçáÁ∫ßÁâàÊú¨Ôºå‰ª• batch ÂΩ¢ÂºèÊèêÈ´òÊÄßËÉΩ„ÄÇ
gRPC message count
Ê∫êËá™ tikv-detail ‰∏çÂÅöËß£Èáä
CDC memory
Ê∫êËá™ linux Êìç‰ΩúÁ≥ªÁªü‰∏≠Á∫øÁ®ãÂç†Áî®ÂÜÖÂ≠òÊÉÖÂÜµÔºå‰∏ªË¶Å‰ΩúÁî®ÊòØÁî®‰∫éËæ®Âà´ÔºåÂØπ TiKV Âú®ÂÜÖÂ≠òÊñπÈù¢ÁöÑÂΩ±Âìç„ÄÇ
ÁúÅÁï•ÂêémainÈù¢Êùø
ÈúÄË¶ÅÊó∂ÂÜçÁªÜÁúãÔºåÈÉΩÊòØ tikv component ‰∏≠ÁöÑÂÜÖÂÆπ</p>
<h2 id="peer-message-Èù¢Êùø" tabindex="-1">Peer Message Èù¢Êùø <a class="header-anchor" href="#peer-message-Èù¢Êùø" aria-label="Permalink to &quot;Peer Message Èù¢Êùø&quot;"></a></h2>
<p>p2p ÊòØ‰∏Ä‰∏™Â∞ÅË£Ö‰∫Ü GRPC ÁöÑÁÇπÂØπÁÇπ‰∫§‰∫íÊúçÂä°Ôºå‰∏ªË¶ÅÁî®‰∫é owner ‰∏é ÂÖ∂‰ªñ Capture ËäÇÁÇπÁöÑ‰∫§‰∫í„ÄÇ
Message Receive Rate
Capteure Êé•Êî∂ message ÁöÑÂêûÂêêÊÉÖÂÜµ„ÄÇ
Message Send Rate
Capteure ÂèëÈÄÅ message ÁöÑÂêûÂêêÊÉÖÂÜµÔºåÁªüËÆ°ÁöÑÊòØÊØèÊ¨°‰∫§‰∫í message ‰∏≠Âê´ÊúâÁöÑÊù°ÁõÆÊï∞Èáè„ÄÇ
Message Batch Size
‰∏é Message Send Rate ÁªüËÆ°ÁöÑÊï∞ÊçÆ‰∏ÄÊ†∑Ôºå‰ΩÜÊòØÂèØ‰ª•ÂàÜ‰ΩçÊï∞ÂΩ¢ÂºèÂ±ïÁ§∫„ÄÇ
Receive message batch bytes percentiles
‰∏é Message Send Rate ÁªüËÆ°ÁöÑ‰∏ÄÊ†∑Ôºå‰ΩÜÁªüËÆ°ÁöÑÊï∞ÊçÆÂèòÊàê‰∫Ü entry ÁöÑ‰∫åËøõÂà∂Â§ßÂ∞è„ÄÇ
Receive Message Bytes Percentile
‰∏é Message Send Rate ÁªüËÆ°‰ΩçÁΩÆ‰∏ÄÊ†∑Ôºå‰ΩÜÁªüËÆ°ÁöÑÊï∞ÊçÆ message ‰∏≠ÊØèÊù° entry ÁöÑ‰∫åËøõÂà∂Â§ßÂ∞èÔºåÊòØ Receive message batch bytes percentiles ÁöÑÁªÜÂåñ„ÄÇ
Stream Count Between Nodes
ÊØèÊé•Êî∂Âà∞‰∏ÄÊù° GRPC stream Ê∂àÊÅØÈÉΩ‰ºöËÆ∞ÂΩïÔºåÂ∞ÜÂèëÈÄÅËÄÖËÆ∞‰∏∫ from„ÄÇÁªüËÆ°ÁöÑÊòØÔºå‰∏çÂêå Capture ‰πãÈó¥ stream Êï∞ÈáèÔºå‰ªéËÄåÂà§Êñ≠ÊòØÂê¶Â≠òÂú®ÊÄßËÉΩÈóÆÈ¢ò„ÄÇ
Total Stream Count
‰∏é Stream Count Between Nodes ÊòØÂêå‰∏Ä‰∏™ÊåáÊ†áÔºå‰ΩÜÂ¢ûÂä†‰∫Ü expected ÔºåËÆ°ÁÆóÂÖ¨ÂºèÊòØ capture_num * 2 -1„ÄÇÂõ†‰∏∫ Owner ‰∏çÈúÄË¶ÅËá™Â∑±ÁªôËá™Â∑±ÂõûÊ∂àÊÅØÔºåÊâÄ‰ª•ÈúÄË¶ÅÂáè 1ÔºåÊØè‰∏™ Capture P2P ÂØπÂ∫î 2 ÂèëÈÄÅÁ´ØÊé•Êî∂Á´ØÔºåÊâÄ‰ª•Êúâ 2 ‰∏™„ÄÇ</p>
<h2 id="actor-Èù¢Êùø" tabindex="-1">Actor Èù¢Êùø <a class="header-anchor" href="#actor-Èù¢Êùø" aria-label="Permalink to &quot;Actor Èù¢Êùø&quot;"></a></h2>
<p>CPU usage
ÊØè‰∏™ Actor Âú® Build Êó∂Ôºå‰æùÊçÆÂäüËÉΩÂàùÂßãÂåñ‰∏çÂêå label ÁöÑÊåáÊ†áÔºå‰∏çÂêå label Ë°®Á§∫ Actor ÁöÑÂäüËÉΩ„ÄÇÁî®‰∫éÁªüËÆ°‰∏çÂêå Actor CPU Âç†Áî®ÊÉÖÂÜµ„ÄÇLable Êúâ sorter-db„ÄÅsorter-compactor„ÄÅsorter-writer„ÄÅsorter-reader„ÄÇ
Worker count
Actor worker ÁöÑÊï∞Èáè„ÄÇ
Slow poll duration
Poll Âç≥Ë∞ÉÁî® Actor ÂéªÊâßË°åÁöÑÊó∂Èó¥ÔºåËøô‰∏™Êó∂Èó¥ÂèØËÉΩÊòØË∞ÉÁî®ÂéªÊâßË°åÔºå‰πüÂèØËÉΩÊòØÊâßË°åÂÆåÊï¥‰∏™Ë∞ÉÁî®ÔºåÂèñÂÜ≥‰∫éË∞ÉÁî®‰ø°ÊÅØÂíåÁ±ªÂûãÔºåÊØè 5s ‰∏ÄÊõ¥Êñ∞„ÄÇ
Slow poll duration percentile
Â¶ÇÊûú Actor Poll Ë∞ÉÁî®Êó∂Èó¥Ë∂ÖËøá slowPollThreshold Ôºà100msÔºâÂàôËÆ∞ÂΩïÂ±ïÁ§∫„ÄÇ
Avg message batch size</p>
<p>Avg actor batch size</p>
<p>Actor poll/s</p>
<p>System poll/s</p>
<p>Runtime instance Èù¢Êùø
ËøôÈáåÈÉΩÊòØ‰∏Ä‰∫õ prometheus go Êî∂ÈõÜÂô®ÈááÈõÜÂá∫Êù•ÁöÑ‰ø°ÊÅØÔºå‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÁî®‰∏çÂà∞„ÄÇÂè™ÊúâÂØπÈúÄË¶ÅÂØπÁ≥ªÁªüËµÑÊ∫êÂç†Áî®ËøõË°åÊ∑±ÂÖ•ÂàÜÊûêÊó∂ÔºåÊâç‰ºöÁî®Âà∞„ÄÇ
Redo Èù¢Êùø
Âü∫Êú¨‰∏äËßÅÂêçÁü•ÊÑè
Kafka Sink Èù¢Êùø
Á±ª‰ºº‰∫é MySQL Sink Âì™‰∫õÈù¢ÊùøÁöÑÊÑèÊÄù„ÄÇ</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[‰ΩøÁî®ËÉåÊôØ]]></title>
            <link>https://askaric.com/zh/work/tidb/TiDB-EcosystematicTools/TiCDC/TiCDC Overview.html</link>
            <guid>https://askaric.com/zh/work/tidb/TiDB-EcosystematicTools/TiCDC/TiCDC Overview.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[# ‰ΩøÁî®ËÉåÊôØ

## ‰∏Ä„ÄÅÈ°πÁõÆËÉåÊôØ

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Â¶Ç [PingCAP ÂÆòÁΩë](https://docs.pingcap.com/zh/tidb/stable/ticdc-overview) ÊâÄËø∞ÔºåTiCDC ÁöÑ‰ΩøÁî®Âú∫ÊôØ‰∏ªË¶ÅÊúâ **‚ÄúÊï∞ÊçÆÂ∫ìÁÅæÂ§á‚Äù** Âèä **‚ÄúÊï∞ÊçÆÈõÜÊàê‚Äù**„ÄÇÁÜüÊÇâ TiDB Âë®ËæπÁîüÊÄÅÁöÑÁà±Â•ΩËÄÖ‰∏ÄÂÆöÁü•ÈÅì **‚ÄúTiDB Binlog‚Äù** Ëøô‰∏Ä‰∏é TiCDC ÂäüËÉΩÁõ∏‰ººÁöÑÂ∑•ÂÖ∑Ôºå**ÈÇ£‰πà‰∏∫‰ªÄ‰πàË¶ÅÈáçÂ§çÂ∑•‰ΩúÂë¢Ôºü**  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Á≠îÊ°àÊòØ ‚ÄúTiDB Binlog‚Äù Êó†Ê≥ïÂ≠òÂú®‰ª•‰∏ã(ÈùûÂÖ®ÈÉ®)ÁßçÁßçÈóÆÈ¢òÔºåÂØπ‰∫é ‚ÄúTiDB Binlog‚Äù Ëøò‰∏çÁÜüÊÇâÁöÑ‰ºô‰º¥ÂèÇËÄÉ [TiDB Binlog ÁÆÄ‰ªã](https://docs.pingcap.com/zh/tidb/stable/tidb-binlog-overview)Ôºö  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1. ‚ÄúTiDB Binlog‚Äù Êâ©Â±ïÊÄßÂ∑ÆÔºåÂ¶ÇÔºöDrainer Â≠òÂú® ‚ÄúÂçïÁÇπ‚Äù Âèä ‚ÄúÊÄßËÉΩ‚Äù ÈóÆÈ¢òÔºåÊãÜÂàÜ Drainer Êó†Ê≥ï‰øùËØÅ ‚ÄúÊï∞ÊçÆË°åÂèòÊõ¥ÊúâÂ∫èÊÄß‚ÄùÔºõ  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2. ‚ÄúTiDB Binlog‚Äù ÊÄßËÉΩ‰Ωé‰∏ãÔºåÂ¶ÇÔºö‚ÄúTiDB Binlog‚Äù ‰ªÖÊîØÊåÅÂçï kafka Âçï partition ÂÜôÂÖ•ÔºåÊó†Ê≥ïÊèêÈ´ò kafka ÂêûÂêêÈáèÔºõ  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3. ‚ÄúTiDB Binlog‚Äù ÈÄöÁî®ÂûãÂ∑ÆÔºåÂ¶ÇÔºöÂÜôÊàê binlog ÂÜôÊàêÊñá‰ª∂ÈúÄË¶Å‰ΩøÁî® Reparo Ëß£Êûê SQL ËØ≠Âè•Ôºå‰∏çÊîØÊåÅ Maxwell„ÄÅCanal Á≠âÈÄöÁî®ÂçèËÆÆÔºõ  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4. ‚ÄúTiDB Binlog‚Äù ÂêåÊ≠•ÁóõÁÇπÔºåÂ¶ÇÔºöbinlog ÂÜôÂà∞‰∏ãÊ∏∏Âèó GRPC max message ÈôêÂà∂Â§öÔºåÂ¶Ç [Pump ÁöÑ gRPC message Ë∂ÖËøáÈôêÂÄº](https://docs.pingcap.com/zh/tidb/stable/handle-tidb-binlog-errors#%E5%BD%93%E4%B8%8A%E6%B8%B8%E4%BA%8B%E5%8A%A1%E8%BE%83%E5%A4%A7%E6%97%B6pump-%E6%8A%A5%E9%94%99-rpc-error-code--resourceexhausted-desc--trying-to-send-message-larger-than-max-2191430008-vs-2147483647) Á≠âÁ≠âÔºõ  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5. ‚ÄúTiDB Binlog‚Äù ÂèØÁî®ÊÄßÂ∑ÆÔºåÂ¶ÇÔºöÂçïÁÇπÁöÑ Drainer ‰∏ÄÊó¶Âá∫Áé∞ÈóÆÈ¢òÂêåÊ≠•Â∞Ü‰∏≠Êñ≠Ôºå‰∏çÂ≠òÂú®‰∏ÄÂÆöÁ®ãÂ∫¶ÁöÑËá™ÊÑàÂäüËÉΩÔºõ  

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Áî±Ê≠§ TiCDC Â∫îËøêËÄåÁîüÔºåÈÄöËøáÁõ¥Êé•ÊçïËé∑ TiKV Change Log ÔºåÂ∞ÜË°®‰Ωú‰∏∫ÊãÜÂàÜÂçïÂÖÉË∞ÉÂ∫¶Ëá≥ÂêÑ Capture ‰∏≠ÔºåÂπ∂ÂèëÂêë‰∏ãÊ∏∏ÂêåÊ≠•Êï∞ÊçÆËß£ÂÜ≥Êâ©Â±ïÊÄßÈóÆÈ¢ò„ÄÇÂèØ kafka Â§ö partition ÂÜôÂÖ•ÔºåÂπ∂ÊîØÊåÅ Maxwell„ÄÅCanal Á≠âÂ§öÁßçÈÄöÁî®ÂçèËÆÆÔºåËß£ÂÜ≥ÂêåÊ≠•ÊÄßËÉΩ„ÄÅÁîüÊÄÅÈÄöÁî®ÊÄßÈóÆÈ¢ò„ÄÇÂΩìÂêåÊ≠•Ë∂ÖÊó∂„ÄÅ Capture ÂêåÊ≠•Ë°®Êï∞Èáè‰∏çÂùá„ÄÅCapture ÊåÇÊéâÁ≠âÊÉÖÂÜµÊó∂ÔºåTiCDC Â≠òÂú®Ë∞ÉÂ∫¶Êú∫Âà∂Âèä At Least Once ‰øùËØÅÊï∞ÊçÆÂÆåÊï¥ÊÄßÂâçÊèê‰∏ãÔºåË∞ÉÂ∫¶ÂÆûÁé∞Ëá™ÊÑàÂêà„ÄÇ  

![01BinlogAndTiCDC](../../../../../images/tidb/05TiDB-EcosystematicTools/5-1TiCDC/01BinlogAndTiCDC.png)

## ‰∫å„ÄÅÂ∑•ÂÖ∑‰ΩçÁΩÆ

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;È¶ñÂÖàÔºåÁÜüÁü• TiCDC ‰ΩøÁî®ÊñπÊ≥ïÔºåÂøÖÂÖàÊòéÁ°ÆÂÖ∂Âú® TiDB ÁîüÊÄÅÂ∑•ÂÖ∑ÊâÄÂ§ÑÁöÑ‰ΩçÁΩÆÂèä‰ΩúÁî®„ÄÇ  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; **1. ‰ΩúÁî®ËÄåË®Ä**ÔºöÊï∞ÊçÆÂ∫ìÂ¶ÇÊûúÊòØ‰∏™Âè™Ëøõ‰∏çÂá∫ÁöÑ **‚ÄúË≤îË≤Ö‚Äù**ÔºåÈÇ£‰πàÂøÖÂ∞ÜË¢´Â∏ÇÂú∫ÊâÄÊäõÂºÉÔºå‰πüÂ∞±ÊòØÊâÄË∞ìÁöÑ **‚ÄúÊï∞ÊçÆÂ≠§Â≤õ‚Äù**ÔºåTiCDC  ÂÖºÈ°æÂêåÊ≠•ÊÄßËÉΩ„ÄÅÊï∞ÊçÆÂÆåÊï¥ÊÄßÔºå‰∏ÄËá¥ÊÄß„ÄÅÁîüÊÄÅÈÄöÁî®ÊÄßÔºåÂÆûÁé∞‰∫ÜÊï∞ÊçÆ‰ªé **"ÊµÅÂÖ•-> TiDB ->ÊµÅÂá∫"** ÁöÑÈó≠ÁéØ„ÄÇÊ≠§Â§ñÔºåË∞àÊÄßËÉΩÂ¶ÇÊûúÊäõÂºÉ‰∫ÜÂú∫ÊôØÔºà‰∏çÊ∑±ÂÖ•ËÆ®ËÆ∫ÔºâÔºåÈÇ£Â∞±ÊòØÂú®ËÄçÊµÅÊ∞ìÔºåÊ≤°Êúâ‰ªª‰Ωï‰∏Ä‰∏™Ê¨æ‰∫ßÂìÅËÉΩÂÆåËÉúÊâÄÊúâÂú∫ÊôØÔºåTiDB ÂêåÊ†∑‰πüÊúâËá™Â∑±ÁöÑËàíÈÄÇÂå∫„ÄÅÁóõÁÇπÂå∫„ÄÇ**Êúâ‰∫Ü TiCDC ‰πãÂêéÔºåÁî®Êà∑ÂèØ‰ª•ËΩªÊùæÂÆûÁé∞Êï∞ÊçÆÁöÑÊµÅËΩ¨ÔºåÊää TiDB Áî®Âú®‰ΩøÁî®Âú∫ÊôØÁöÑËàíÈÄÇÂå∫„ÄÇ**  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; **2. ‰ΩçÁΩÆËÄåË®Ä**ÔºöTiCDC ‰ªã‰∫é TiDB ‰∏é‰∏ãÊ∏∏ÁõÆÁöÑÁ´Ø‰πãÈó¥Ôºå‰∏ãÊ∏∏ÂåÖÂê´ÂÖºÁî® MySQL ÈÄöËÆ∏ÂçèËÆÆÁöÑÊâÄÊúâ‰∫ßÂìÅ„ÄÅÂπ≥Âè∞ÔºàÂ¶ÇÔºöTiDB„ÄÅMySQL„ÄÅRDS„ÄÅ‰∏âÊñπ‰∫ëÂπ≥Âè∞Á≠âÔºâ„ÄÇÁî®Êà∑ËøòÂèØÂü∫‰∫éÈÄöÁî®Ê∂àÊÅØÈòüÂàóËæìÂá∫ÂçèËÆÆËá™ÂÆö‰πâÂºÄÂèëÔºåÁé∞ TiCDC ÊîØÊåÅÁöÑÂçèËÆÆÊúâÔºöOpen Protocol „ÄÅCanal-JSON „ÄÅ Canal „ÄÅAvro „ÄÅ Maxwell Á≠âÂçèËÆÆÔºåÊúâ‰∫õÂçèËÆÆ‰ªÖÈÉ®ÂàÜÊîØÊåÅÔºåËØ¶ÊÉÖÂèÇËÄÉ --> [TiCDC ÊîØÊåÅÁöÑÂçèËÆÆÊåáÂçó](https://github.com/pingcap/tiflow/blob/master/docs/design/2020-11-04-ticdc-protocol-list.md#protocols-%E5%88%86%E5%8D%8F%E8%AE%AE%E4%BB%8B%E7%BB%8D)  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ÂÖ∂Ê¨°ÔºåTiCDC Âá†‰πéÂõäÊã¨ÊâÄÊúâ‰∏ªÊµÅ ‚ÄúÊï∞ÊçÆÂêåÊ≠•‚Äù ÁöÑ‰ΩøÁî®Âú∫ÊôØÔºå‰∏ãÂõæ‰æøÊòØ ‚ÄúMySQL --> TiDB --> Others‚Äù ÁöÑÁªèÂÖ∏ÁªÑÂêàÊã≥„ÄÇËá≥‰∫éÂÖ∂‰ªñÂçèËÆÆÁöÑÊï∞ÊçÆÂ∫ìÔºàOracle„ÄÅPGÔºâÂ¶Ç‰ΩïÊµÅÂÖ• TiDBÔºåÁ≠âÂêå‰∫éÂ¶Ç‰ΩïÊµÅÂÖ• MySQLÔºåÂõ†‰∏∫ TiDB ÂÖºÂÆπ MySQL ÈÄöËÆØÂçèËÆÆÔºå‰∏ÄÂÆöÂ≠òÂú®ËæÉÊàêÁÜüÁöÑËß£ÂÜ≥ÊñπÊ°à„ÄÇ  

![02UpstreamAndDownstream](../../../../../images/tidb/05TiDB-EcosystematicTools/5-1TiCDC/02UpstreamAndDownstream.png)

## ‰∏â„ÄÅ‰ΩøÁî®ÊÉÖÂÜµ

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**Ê≥®ÊÑèÔºö‰∏ãËø∞ÂÖ¨Âè∏ÂùáÈÄöËøá AskTUG ÊêúÁ¥¢Áõ∏ÂÖ≥ÊñáÁ´†ÂæóÂà∞ÔºåÂç≥ÔºöÂàÜ‰∫´ÊñáÁ´†‰∏≠ÊúâÊèêÂèäËØ•ÂÖ¨Âè∏Ê≠£Âú®‰ΩøÁî® TICDC„ÄÇ‰∏ãËø∞ÂÖ¨Âè∏‰ªÖÊòØÈÄöËøáÊêúÁ¥¢ÊâãÊÆµÂèØÂæóÁü•ÁöÑÂÖ¨Âè∏ÔºåËøòÊúâËÆ∏Â§öÂïÜ‰∏öÂÆ¢Êà∑Ë¶ÅÊ±Ç‰∏çÂØπÂ§ñÈÄèÈú≤„ÄÅÊàñËøòÊú™Êù•ÂæóÂèäÈÄèÈú≤„ÄÇ**  

### **3.1 Â∞èÁ∫¢‰π¶**

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‰ªé `Âº†‰∫øÁöìËÄÅÂ∏à` Âú® [„ÄêPingCAP Infra Meetup„ÄëNo.131 TiCDC ÁöÑÁîüÊÄÅÂíåÁ§æÂå∫Âª∫ËÆæ](https://www.bilibili.com/video/BV1bD4y1o7qU?spm_id_from=333.337.search-card.all.click)  ‰∏≠ÂàÜ‰∫´ÂèØÁü•ÔºåÂ∞èÁ∫¢‰π¶Âü∫‰∫é TiCDC Âú®‰∏öÂä°‰∏≠ËøõË°åÂÜÖÂÆπÂÆ°Ê†∏„ÄÅÁ¨îËÆ∞Ê†áÁ≠æÊé®Ëçê„ÄÅÂ¢ûÈïøÂÆ°ËÆ°„ÄÇÂÆûÁé∞Â¶Ç‰∏ãÂõæÔºåÂü∫‰∫é "TiDB --> TiCDC --> Kafka --> Flink --> TiDB" ËøôÊ†∑‰∏ÄÊù°ÈìæË∑ØÂÆûÁé∞‰∏éÊû∂ÊûÑ‰∏≠ÂÖ∂‰ªñÊï∞ÊçÆÊ∫êÁöÑËÅöÂêàËÆ°ÁÆó„ÄÇ  

![03xiaohongshu_share](../../../../../images/tidb/05TiDB-EcosystematicTools/5-1TiCDC/03xiaohongshu_share.jpeg)

### **3.2 Êµ∑Â∞îÊô∫ÂÆ∂**

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‰ªé `ÂßöÁøîËÄÅÂ∏à` Âú® [„ÄêPingCAP Infra Meetup„ÄëNo.131 TiCDC ÁöÑÁîüÊÄÅÂíåÁ§æÂå∫Âª∫ËÆæ](https://www.bilibili.com/video/BV1bD4y1o7qU?spm_id_from=333.337.search-card.all.click)  ‰∏≠ÂàÜ‰∫´ÂèØÁü•ÔºåÊµ∑Â∞îÊô∫ÂÆ∂Âü∫‰∫é TICDC Âú®‰∏öÂä°‰∏≠ËøõË°åÊêúÁ¥¢„ÄÅÊé®Ëçê„ÄÇÂ∞ÜÁî®Êà∑Êï∞ÊçÆ„ÄÅÁîüÊ¥ªÂÆ∂‰ø°ÊÅØÊï∞ÊçÆÂü∫‰∫é "TiDB --> TiCDC --> Kafka --> ES" ËøôÊ†∑‰∏ÄÊù°ÈìæË∑ØÂÆûÁé∞ Kafka Êó•Ê∂àË¥πÈáèÂú® 300 ‰∏áÂ∑¶Âè≥ÁöÑËøëÂÆûÊó∂ÊêúÁ¥¢ÂäüËÉΩ„ÄÇ‰ªéÊèèËø∞‰∏≠ÂèØÁü•Êà™Ê≠¢ 2019-09-19 ÂàÜ‰∫´Êó∂Ôºå**TiCDC Âú®‰∏çÊ∂âÂèäË°®Êï∞Èáè„ÄÅLOB Â≠óÊÆµ„ÄÅÁΩëÁªúÂª∂Êó∂Á≠âÁªÜËäÇÊÉÖÂÜµ‰∏ãÔºåÂêåÊ≠•ËÉΩÂäõËæπÁïå‰∏∫ÔºöÊ≠£Â∏∏ÂêåÊ≠•Âú® ‚ÄúÊØ´Áßí‚Äù Á∫ßÔºåÊäñÂä®ÊÉÖÂÜµ‰∏ãÂú® ‚ÄúÁßíÁ∫ß‚ÄùÔºà10s ‰ª•ÂÜÖÔºâ„ÄÇ**  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ê≠§Â§ñÔºå‰ªé [Github -- Question and Bug Reports](https://github.com/pingcap/tiflow/projects/13) ‰∏≠ÂèØ‰ª•ÁúãÂá∫ TiCDC Â≠òÂú® `mqSink flushes data synchronously,casing low performance`„ÄÅ`Poor incremental scan performance where they are frequent insertions`„ÄÅ`improve performance of syncer` Á≠âÂ§ö‰∏™ÊèêÂçáÂêåÊ≠•ÊÄßËÉΩÁöÑ RoadMapÔºåÂØπ‰∫é TiCDC ÁöÑÂêåÊ≠•ÊÄßËÉΩÊòØ‰∏Ä‰∏™ÊåÅÁª≠‰ºòÂåñÁöÑËøáÁ®ã„ÄÇ  

![04haierzhijia_share](../../../../../images/tidb/05TiDB-EcosystematicTools/5-1TiCDC/04haierzhijia_share.jpeg)  

### **3.3 360**

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‰ªé `‰ª£ÊôìÁ£äËÄÅÂ∏à` Âú® [BLOG - TiCDC Â∫îÁî®Âú∫ÊôØËß£Êûê](https://tidb.net/blog/2fa9cf6a) ‰∏≠ÂàÜ‰∫´ÂèØÁü•Ôºå360 Âü∫‰∫é TiCDC ÂÆûÁé∞Âπ∂ÂèÇ‰∏éÁ´ãÈ°π **Â¢ûÈáèÊï∞ÊçÆÊäΩÂèñ„ÄÅÂêåÂüéÂèåÈõÜÁæ§ÁÉ≠Â§á„ÄÅÊµÅÂ§ÑÁêÜÊ±Ç** ÁöÑÈúÄÊ±Ç„ÄÇ  

## Âõõ„ÄÅ‰ΩøÁî®ÊñπÊ≥ï

### 4.1 ÈÉ®ÁΩ≤ TiCDC

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‰∏ãËø∞ÊµãËØïÁéØÂ¢ÉÊê≠Âª∫ TiCDC ÔºåÁõÆÁöÑÊµãËØï„ÄÅÂ≠¶‰π† TiCDC ÂêåÊ≠•ÂäüËÉΩ„ÄÇ`172.16.6.155:8300` Âèä `172.16.6.196:8300` ÁöÑ CDC ÁªÑ‰ª∂‰ºöÂú®Êâ©ÂÆπÂêéÂá∫Áé∞„ÄÇ  

```shell
[tidb@Linux-Hostname ~]$ tiup cluster display tidb-test

ID                  Role          Host          Ports        OS/Arch       Status  Data Dir                                     Deploy Dir
--                  ]]></description>
            <content:encoded><![CDATA[<h1 id="‰ΩøÁî®ËÉåÊôØ" tabindex="-1">‰ΩøÁî®ËÉåÊôØ <a class="header-anchor" href="#‰ΩøÁî®ËÉåÊôØ" aria-label="Permalink to &quot;‰ΩøÁî®ËÉåÊôØ&quot;"></a></h1>
<h2 id="‰∏Ä„ÄÅÈ°πÁõÆËÉåÊôØ" tabindex="-1">‰∏Ä„ÄÅÈ°πÁõÆËÉåÊôØ <a class="header-anchor" href="#‰∏Ä„ÄÅÈ°πÁõÆËÉåÊôØ" aria-label="Permalink to &quot;‰∏Ä„ÄÅÈ°πÁõÆËÉåÊôØ&quot;"></a></h2>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Â¶Ç <a href="https://docs.pingcap.com/zh/tidb/stable/ticdc-overview" target="_blank" rel="noreferrer">PingCAP ÂÆòÁΩë</a> ÊâÄËø∞ÔºåTiCDC ÁöÑ‰ΩøÁî®Âú∫ÊôØ‰∏ªË¶ÅÊúâ <strong>‚ÄúÊï∞ÊçÆÂ∫ìÁÅæÂ§á‚Äù</strong> Âèä <strong>‚ÄúÊï∞ÊçÆÈõÜÊàê‚Äù</strong>„ÄÇÁÜüÊÇâ TiDB Âë®ËæπÁîüÊÄÅÁöÑÁà±Â•ΩËÄÖ‰∏ÄÂÆöÁü•ÈÅì <strong>‚ÄúTiDB Binlog‚Äù</strong> Ëøô‰∏Ä‰∏é TiCDC ÂäüËÉΩÁõ∏‰ººÁöÑÂ∑•ÂÖ∑Ôºå<strong>ÈÇ£‰πà‰∏∫‰ªÄ‰πàË¶ÅÈáçÂ§çÂ∑•‰ΩúÂë¢Ôºü</strong><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Á≠îÊ°àÊòØ ‚ÄúTiDB Binlog‚Äù Êó†Ê≥ïÂ≠òÂú®‰ª•‰∏ã(ÈùûÂÖ®ÈÉ®)ÁßçÁßçÈóÆÈ¢òÔºåÂØπ‰∫é ‚ÄúTiDB Binlog‚Äù Ëøò‰∏çÁÜüÊÇâÁöÑ‰ºô‰º¥ÂèÇËÄÉ <a href="https://docs.pingcap.com/zh/tidb/stable/tidb-binlog-overview" target="_blank" rel="noreferrer">TiDB Binlog ÁÆÄ‰ªã</a>Ôºö<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1. ‚ÄúTiDB Binlog‚Äù Êâ©Â±ïÊÄßÂ∑ÆÔºåÂ¶ÇÔºöDrainer Â≠òÂú® ‚ÄúÂçïÁÇπ‚Äù Âèä ‚ÄúÊÄßËÉΩ‚Äù ÈóÆÈ¢òÔºåÊãÜÂàÜ Drainer Êó†Ê≥ï‰øùËØÅ ‚ÄúÊï∞ÊçÆË°åÂèòÊõ¥ÊúâÂ∫èÊÄß‚ÄùÔºõ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2. ‚ÄúTiDB Binlog‚Äù ÊÄßËÉΩ‰Ωé‰∏ãÔºåÂ¶ÇÔºö‚ÄúTiDB Binlog‚Äù ‰ªÖÊîØÊåÅÂçï kafka Âçï partition ÂÜôÂÖ•ÔºåÊó†Ê≥ïÊèêÈ´ò kafka ÂêûÂêêÈáèÔºõ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3. ‚ÄúTiDB Binlog‚Äù ÈÄöÁî®ÂûãÂ∑ÆÔºåÂ¶ÇÔºöÂÜôÊàê binlog ÂÜôÊàêÊñá‰ª∂ÈúÄË¶Å‰ΩøÁî® Reparo Ëß£Êûê SQL ËØ≠Âè•Ôºå‰∏çÊîØÊåÅ Maxwell„ÄÅCanal Á≠âÈÄöÁî®ÂçèËÆÆÔºõ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4. ‚ÄúTiDB Binlog‚Äù ÂêåÊ≠•ÁóõÁÇπÔºåÂ¶ÇÔºöbinlog ÂÜôÂà∞‰∏ãÊ∏∏Âèó GRPC max message ÈôêÂà∂Â§öÔºåÂ¶Ç <a href="https://docs.pingcap.com/zh/tidb/stable/handle-tidb-binlog-errors#%E5%BD%93%E4%B8%8A%E6%B8%B8%E4%BA%8B%E5%8A%A1%E8%BE%83%E5%A4%A7%E6%97%B6pump-%E6%8A%A5%E9%94%99-rpc-error-code--resourceexhausted-desc--trying-to-send-message-larger-than-max-2191430008-vs-2147483647" target="_blank" rel="noreferrer">Pump ÁöÑ gRPC message Ë∂ÖËøáÈôêÂÄº</a> Á≠âÁ≠âÔºõ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5. ‚ÄúTiDB Binlog‚Äù ÂèØÁî®ÊÄßÂ∑ÆÔºåÂ¶ÇÔºöÂçïÁÇπÁöÑ Drainer ‰∏ÄÊó¶Âá∫Áé∞ÈóÆÈ¢òÂêåÊ≠•Â∞Ü‰∏≠Êñ≠Ôºå‰∏çÂ≠òÂú®‰∏ÄÂÆöÁ®ãÂ∫¶ÁöÑËá™ÊÑàÂäüËÉΩÔºõ</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Áî±Ê≠§ TiCDC Â∫îËøêËÄåÁîüÔºåÈÄöËøáÁõ¥Êé•ÊçïËé∑ TiKV Change Log ÔºåÂ∞ÜË°®‰Ωú‰∏∫ÊãÜÂàÜÂçïÂÖÉË∞ÉÂ∫¶Ëá≥ÂêÑ Capture ‰∏≠ÔºåÂπ∂ÂèëÂêë‰∏ãÊ∏∏ÂêåÊ≠•Êï∞ÊçÆËß£ÂÜ≥Êâ©Â±ïÊÄßÈóÆÈ¢ò„ÄÇÂèØ kafka Â§ö partition ÂÜôÂÖ•ÔºåÂπ∂ÊîØÊåÅ Maxwell„ÄÅCanal Á≠âÂ§öÁßçÈÄöÁî®ÂçèËÆÆÔºåËß£ÂÜ≥ÂêåÊ≠•ÊÄßËÉΩ„ÄÅÁîüÊÄÅÈÄöÁî®ÊÄßÈóÆÈ¢ò„ÄÇÂΩìÂêåÊ≠•Ë∂ÖÊó∂„ÄÅ Capture ÂêåÊ≠•Ë°®Êï∞Èáè‰∏çÂùá„ÄÅCapture ÊåÇÊéâÁ≠âÊÉÖÂÜµÊó∂ÔºåTiCDC Â≠òÂú®Ë∞ÉÂ∫¶Êú∫Âà∂Âèä At Least Once ‰øùËØÅÊï∞ÊçÆÂÆåÊï¥ÊÄßÂâçÊèê‰∏ãÔºåË∞ÉÂ∫¶ÂÆûÁé∞Ëá™ÊÑàÂêà„ÄÇ</p>
<figure><img src="./../../../../../images/tidb/05TiDB-EcosystematicTools/5-1TiCDC/01BinlogAndTiCDC.png" alt="01BinlogAndTiCDC" tabindex="0"><figcaption>01BinlogAndTiCDC</figcaption></figure>
<h2 id="‰∫å„ÄÅÂ∑•ÂÖ∑‰ΩçÁΩÆ" tabindex="-1">‰∫å„ÄÅÂ∑•ÂÖ∑‰ΩçÁΩÆ <a class="header-anchor" href="#‰∫å„ÄÅÂ∑•ÂÖ∑‰ΩçÁΩÆ" aria-label="Permalink to &quot;‰∫å„ÄÅÂ∑•ÂÖ∑‰ΩçÁΩÆ&quot;"></a></h2>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;È¶ñÂÖàÔºåÁÜüÁü• TiCDC ‰ΩøÁî®ÊñπÊ≥ïÔºåÂøÖÂÖàÊòéÁ°ÆÂÖ∂Âú® TiDB ÁîüÊÄÅÂ∑•ÂÖ∑ÊâÄÂ§ÑÁöÑ‰ΩçÁΩÆÂèä‰ΩúÁî®„ÄÇ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>1. ‰ΩúÁî®ËÄåË®Ä</strong>ÔºöÊï∞ÊçÆÂ∫ìÂ¶ÇÊûúÊòØ‰∏™Âè™Ëøõ‰∏çÂá∫ÁöÑ <strong>‚ÄúË≤îË≤Ö‚Äù</strong>ÔºåÈÇ£‰πàÂøÖÂ∞ÜË¢´Â∏ÇÂú∫ÊâÄÊäõÂºÉÔºå‰πüÂ∞±ÊòØÊâÄË∞ìÁöÑ <strong>‚ÄúÊï∞ÊçÆÂ≠§Â≤õ‚Äù</strong>ÔºåTiCDC  ÂÖºÈ°æÂêåÊ≠•ÊÄßËÉΩ„ÄÅÊï∞ÊçÆÂÆåÊï¥ÊÄßÔºå‰∏ÄËá¥ÊÄß„ÄÅÁîüÊÄÅÈÄöÁî®ÊÄßÔºåÂÆûÁé∞‰∫ÜÊï∞ÊçÆ‰ªé <strong>&quot;ÊµÅÂÖ•-&gt; TiDB -&gt;ÊµÅÂá∫&quot;</strong> ÁöÑÈó≠ÁéØ„ÄÇÊ≠§Â§ñÔºåË∞àÊÄßËÉΩÂ¶ÇÊûúÊäõÂºÉ‰∫ÜÂú∫ÊôØÔºà‰∏çÊ∑±ÂÖ•ËÆ®ËÆ∫ÔºâÔºåÈÇ£Â∞±ÊòØÂú®ËÄçÊµÅÊ∞ìÔºåÊ≤°Êúâ‰ªª‰Ωï‰∏Ä‰∏™Ê¨æ‰∫ßÂìÅËÉΩÂÆåËÉúÊâÄÊúâÂú∫ÊôØÔºåTiDB ÂêåÊ†∑‰πüÊúâËá™Â∑±ÁöÑËàíÈÄÇÂå∫„ÄÅÁóõÁÇπÂå∫„ÄÇ<strong>Êúâ‰∫Ü TiCDC ‰πãÂêéÔºåÁî®Êà∑ÂèØ‰ª•ËΩªÊùæÂÆûÁé∞Êï∞ÊçÆÁöÑÊµÅËΩ¨ÔºåÊää TiDB Áî®Âú®‰ΩøÁî®Âú∫ÊôØÁöÑËàíÈÄÇÂå∫„ÄÇ</strong><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>2. ‰ΩçÁΩÆËÄåË®Ä</strong>ÔºöTiCDC ‰ªã‰∫é TiDB ‰∏é‰∏ãÊ∏∏ÁõÆÁöÑÁ´Ø‰πãÈó¥Ôºå‰∏ãÊ∏∏ÂåÖÂê´ÂÖºÁî® MySQL ÈÄöËÆ∏ÂçèËÆÆÁöÑÊâÄÊúâ‰∫ßÂìÅ„ÄÅÂπ≥Âè∞ÔºàÂ¶ÇÔºöTiDB„ÄÅMySQL„ÄÅRDS„ÄÅ‰∏âÊñπ‰∫ëÂπ≥Âè∞Á≠âÔºâ„ÄÇÁî®Êà∑ËøòÂèØÂü∫‰∫éÈÄöÁî®Ê∂àÊÅØÈòüÂàóËæìÂá∫ÂçèËÆÆËá™ÂÆö‰πâÂºÄÂèëÔºåÁé∞ TiCDC ÊîØÊåÅÁöÑÂçèËÆÆÊúâÔºöOpen Protocol „ÄÅCanal-JSON „ÄÅ Canal „ÄÅAvro „ÄÅ Maxwell Á≠âÂçèËÆÆÔºåÊúâ‰∫õÂçèËÆÆ‰ªÖÈÉ®ÂàÜÊîØÊåÅÔºåËØ¶ÊÉÖÂèÇËÄÉ --&gt; <a href="https://github.com/pingcap/tiflow/blob/master/docs/design/2020-11-04-ticdc-protocol-list.md#protocols-%E5%88%86%E5%8D%8F%E8%AE%AE%E4%BB%8B%E7%BB%8D" target="_blank" rel="noreferrer">TiCDC ÊîØÊåÅÁöÑÂçèËÆÆÊåáÂçó</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ÂÖ∂Ê¨°ÔºåTiCDC Âá†‰πéÂõäÊã¨ÊâÄÊúâ‰∏ªÊµÅ ‚ÄúÊï∞ÊçÆÂêåÊ≠•‚Äù ÁöÑ‰ΩøÁî®Âú∫ÊôØÔºå‰∏ãÂõæ‰æøÊòØ ‚ÄúMySQL --&gt; TiDB --&gt; Others‚Äù ÁöÑÁªèÂÖ∏ÁªÑÂêàÊã≥„ÄÇËá≥‰∫éÂÖ∂‰ªñÂçèËÆÆÁöÑÊï∞ÊçÆÂ∫ìÔºàOracle„ÄÅPGÔºâÂ¶Ç‰ΩïÊµÅÂÖ• TiDBÔºåÁ≠âÂêå‰∫éÂ¶Ç‰ΩïÊµÅÂÖ• MySQLÔºåÂõ†‰∏∫ TiDB ÂÖºÂÆπ MySQL ÈÄöËÆØÂçèËÆÆÔºå‰∏ÄÂÆöÂ≠òÂú®ËæÉÊàêÁÜüÁöÑËß£ÂÜ≥ÊñπÊ°à„ÄÇ</p>
<figure><img src="./../../../../../images/tidb/05TiDB-EcosystematicTools/5-1TiCDC/02UpstreamAndDownstream.png" alt="02UpstreamAndDownstream" tabindex="0"><figcaption>02UpstreamAndDownstream</figcaption></figure>
<h2 id="‰∏â„ÄÅ‰ΩøÁî®ÊÉÖÂÜµ" tabindex="-1">‰∏â„ÄÅ‰ΩøÁî®ÊÉÖÂÜµ <a class="header-anchor" href="#‰∏â„ÄÅ‰ΩøÁî®ÊÉÖÂÜµ" aria-label="Permalink to &quot;‰∏â„ÄÅ‰ΩøÁî®ÊÉÖÂÜµ&quot;"></a></h2>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>Ê≥®ÊÑèÔºö‰∏ãËø∞ÂÖ¨Âè∏ÂùáÈÄöËøá AskTUG ÊêúÁ¥¢Áõ∏ÂÖ≥ÊñáÁ´†ÂæóÂà∞ÔºåÂç≥ÔºöÂàÜ‰∫´ÊñáÁ´†‰∏≠ÊúâÊèêÂèäËØ•ÂÖ¨Âè∏Ê≠£Âú®‰ΩøÁî® TICDC„ÄÇ‰∏ãËø∞ÂÖ¨Âè∏‰ªÖÊòØÈÄöËøáÊêúÁ¥¢ÊâãÊÆµÂèØÂæóÁü•ÁöÑÂÖ¨Âè∏ÔºåËøòÊúâËÆ∏Â§öÂïÜ‰∏öÂÆ¢Êà∑Ë¶ÅÊ±Ç‰∏çÂØπÂ§ñÈÄèÈú≤„ÄÅÊàñËøòÊú™Êù•ÂæóÂèäÈÄèÈú≤„ÄÇ</strong></p>
<h3 id="_3-1-Â∞èÁ∫¢‰π¶" tabindex="-1"><strong>3.1 Â∞èÁ∫¢‰π¶</strong> <a class="header-anchor" href="#_3-1-Â∞èÁ∫¢‰π¶" aria-label="Permalink to &quot;**3.1 Â∞èÁ∫¢‰π¶**&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‰ªé <code>Âº†‰∫øÁöìËÄÅÂ∏à</code> Âú® <a href="https://www.bilibili.com/video/BV1bD4y1o7qU?spm_id_from=333.337.search-card.all.click" target="_blank" rel="noreferrer">„ÄêPingCAP Infra Meetup„ÄëNo.131 TiCDC ÁöÑÁîüÊÄÅÂíåÁ§æÂå∫Âª∫ËÆæ</a>  ‰∏≠ÂàÜ‰∫´ÂèØÁü•ÔºåÂ∞èÁ∫¢‰π¶Âü∫‰∫é TiCDC Âú®‰∏öÂä°‰∏≠ËøõË°åÂÜÖÂÆπÂÆ°Ê†∏„ÄÅÁ¨îËÆ∞Ê†áÁ≠æÊé®Ëçê„ÄÅÂ¢ûÈïøÂÆ°ËÆ°„ÄÇÂÆûÁé∞Â¶Ç‰∏ãÂõæÔºåÂü∫‰∫é &quot;TiDB --&gt; TiCDC --&gt; Kafka --&gt; Flink --&gt; TiDB&quot; ËøôÊ†∑‰∏ÄÊù°ÈìæË∑ØÂÆûÁé∞‰∏éÊû∂ÊûÑ‰∏≠ÂÖ∂‰ªñÊï∞ÊçÆÊ∫êÁöÑËÅöÂêàËÆ°ÁÆó„ÄÇ</p>
<figure><img src="./../../../../../images/tidb/05TiDB-EcosystematicTools/5-1TiCDC/03xiaohongshu_share.jpeg" alt="03xiaohongshu_share" tabindex="0"><figcaption>03xiaohongshu_share</figcaption></figure>
<h3 id="_3-2-Êµ∑Â∞îÊô∫ÂÆ∂" tabindex="-1"><strong>3.2 Êµ∑Â∞îÊô∫ÂÆ∂</strong> <a class="header-anchor" href="#_3-2-Êµ∑Â∞îÊô∫ÂÆ∂" aria-label="Permalink to &quot;**3.2 Êµ∑Â∞îÊô∫ÂÆ∂**&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‰ªé <code>ÂßöÁøîËÄÅÂ∏à</code> Âú® <a href="https://www.bilibili.com/video/BV1bD4y1o7qU?spm_id_from=333.337.search-card.all.click" target="_blank" rel="noreferrer">„ÄêPingCAP Infra Meetup„ÄëNo.131 TiCDC ÁöÑÁîüÊÄÅÂíåÁ§æÂå∫Âª∫ËÆæ</a>  ‰∏≠ÂàÜ‰∫´ÂèØÁü•ÔºåÊµ∑Â∞îÊô∫ÂÆ∂Âü∫‰∫é TICDC Âú®‰∏öÂä°‰∏≠ËøõË°åÊêúÁ¥¢„ÄÅÊé®Ëçê„ÄÇÂ∞ÜÁî®Êà∑Êï∞ÊçÆ„ÄÅÁîüÊ¥ªÂÆ∂‰ø°ÊÅØÊï∞ÊçÆÂü∫‰∫é &quot;TiDB --&gt; TiCDC --&gt; Kafka --&gt; ES&quot; ËøôÊ†∑‰∏ÄÊù°ÈìæË∑ØÂÆûÁé∞ Kafka Êó•Ê∂àË¥πÈáèÂú® 300 ‰∏áÂ∑¶Âè≥ÁöÑËøëÂÆûÊó∂ÊêúÁ¥¢ÂäüËÉΩ„ÄÇ‰ªéÊèèËø∞‰∏≠ÂèØÁü•Êà™Ê≠¢ 2019-09-19 ÂàÜ‰∫´Êó∂Ôºå<strong>TiCDC Âú®‰∏çÊ∂âÂèäË°®Êï∞Èáè„ÄÅLOB Â≠óÊÆµ„ÄÅÁΩëÁªúÂª∂Êó∂Á≠âÁªÜËäÇÊÉÖÂÜµ‰∏ãÔºåÂêåÊ≠•ËÉΩÂäõËæπÁïå‰∏∫ÔºöÊ≠£Â∏∏ÂêåÊ≠•Âú® ‚ÄúÊØ´Áßí‚Äù Á∫ßÔºåÊäñÂä®ÊÉÖÂÜµ‰∏ãÂú® ‚ÄúÁßíÁ∫ß‚ÄùÔºà10s ‰ª•ÂÜÖÔºâ„ÄÇ</strong><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ê≠§Â§ñÔºå‰ªé <a href="https://github.com/pingcap/tiflow/projects/13" target="_blank" rel="noreferrer">Github -- Question and Bug Reports</a> ‰∏≠ÂèØ‰ª•ÁúãÂá∫ TiCDC Â≠òÂú® <code>mqSink flushes data synchronously,casing low performance</code>„ÄÅ<code>Poor incremental scan performance where they are frequent insertions</code>„ÄÅ<code>improve performance of syncer</code> Á≠âÂ§ö‰∏™ÊèêÂçáÂêåÊ≠•ÊÄßËÉΩÁöÑ RoadMapÔºåÂØπ‰∫é TiCDC ÁöÑÂêåÊ≠•ÊÄßËÉΩÊòØ‰∏Ä‰∏™ÊåÅÁª≠‰ºòÂåñÁöÑËøáÁ®ã„ÄÇ</p>
<figure><img src="./../../../../../images/tidb/05TiDB-EcosystematicTools/5-1TiCDC/04haierzhijia_share.jpeg" alt="04haierzhijia_share" tabindex="0"><figcaption>04haierzhijia_share</figcaption></figure>
<h3 id="_3-3-360" tabindex="-1"><strong>3.3 360</strong> <a class="header-anchor" href="#_3-3-360" aria-label="Permalink to &quot;**3.3 360**&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‰ªé <code>‰ª£ÊôìÁ£äËÄÅÂ∏à</code> Âú® <a href="https://tidb.net/blog/2fa9cf6a" target="_blank" rel="noreferrer">BLOG - TiCDC Â∫îÁî®Âú∫ÊôØËß£Êûê</a> ‰∏≠ÂàÜ‰∫´ÂèØÁü•Ôºå360 Âü∫‰∫é TiCDC ÂÆûÁé∞Âπ∂ÂèÇ‰∏éÁ´ãÈ°π <strong>Â¢ûÈáèÊï∞ÊçÆÊäΩÂèñ„ÄÅÂêåÂüéÂèåÈõÜÁæ§ÁÉ≠Â§á„ÄÅÊµÅÂ§ÑÁêÜÊ±Ç</strong> ÁöÑÈúÄÊ±Ç„ÄÇ</p>
<h2 id="Âõõ„ÄÅ‰ΩøÁî®ÊñπÊ≥ï" tabindex="-1">Âõõ„ÄÅ‰ΩøÁî®ÊñπÊ≥ï <a class="header-anchor" href="#Âõõ„ÄÅ‰ΩøÁî®ÊñπÊ≥ï" aria-label="Permalink to &quot;Âõõ„ÄÅ‰ΩøÁî®ÊñπÊ≥ï&quot;"></a></h2>
<h3 id="_4-1-ÈÉ®ÁΩ≤-ticdc" tabindex="-1">4.1 ÈÉ®ÁΩ≤ TiCDC <a class="header-anchor" href="#_4-1-ÈÉ®ÁΩ≤-ticdc" aria-label="Permalink to &quot;4.1 ÈÉ®ÁΩ≤ TiCDC&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‰∏ãËø∞ÊµãËØïÁéØÂ¢ÉÊê≠Âª∫ TiCDC ÔºåÁõÆÁöÑÊµãËØï„ÄÅÂ≠¶‰π† TiCDC ÂêåÊ≠•ÂäüËÉΩ„ÄÇ<code>172.16.6.155:8300</code> Âèä <code>172.16.6.196:8300</code> ÁöÑ CDC ÁªÑ‰ª∂‰ºöÂú®Êâ©ÂÆπÂêéÂá∫Áé∞„ÄÇ</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@Linux-Hostname </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ tiup cluster display tidb-test</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ID</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                  Role</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">          Host</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">          Ports</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">        OS/Arch</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       Status</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Data</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Dir</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                     Deploy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Dir</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">--</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">                  ----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">          ----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">          -----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">        -------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">       ------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  --------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">                                     ----------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">172.16.6.155:9093</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   alertmanager</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  172.16.6.155</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  9093/9094</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Up</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      /home/data/tidb-home/data/alertmanager-9093</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  /home/data/tidb-deploy/alertmanager-9093</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">172.16.6.155:8300</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   cdc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">           172.16.6.155</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  8300</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">         linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Up</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      /data/deploy/install/data/cdc-8300</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">           /home/data/tidb-deploy/cdc-8300</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">172.16.6.196:8300</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   cdc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">           172.16.6.196</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  8300</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">         linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Up</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      /data/deploy/install/data/cdc-8300</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">           /home/data/tidb-deploy/cdc-8300</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">172.16.6.155:3000</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   grafana</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">       172.16.6.155</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  3000</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">         linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Up</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                            /home/data/tidb-deploy/grafana-3000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">172.16.6.155:2379</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   pd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">            172.16.6.155</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  2379/2380</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Up</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">UI</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   /home/data/tidb-home/data/pd-2379</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">            /home/data/tidb-deploy/pd-2379</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">172.16.6.194:2379</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   pd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">            172.16.6.194</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  2379/2380</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Up</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      /home/data/tidb-home/data/pd-2379</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">            /home/data/tidb-deploy/pd-2379</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">172.16.6.196:2379</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   pd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">            172.16.6.196</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  2379/2380</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Up</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">L</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    /home/data/tidb-home/data/pd-2379</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">            /home/data/tidb-deploy/pd-2379</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">172.16.6.155:9090</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   prometheus</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    172.16.6.155</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  9090/12020</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Up</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      /home/data/tidb-home/data/prometheus-9090</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    /home/data/tidb-deploy/prometheus-9090</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">172.16.6.155:4000</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   tidb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">          172.16.6.155</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  4000/10080</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Up</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                            /home/data/tidb-deploy/tidb-4000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">172.16.6.196:4000</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   tidb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">          172.16.6.196</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  4000/10080</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Up</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                            /home/data/tidb-deploy/tidb-4000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">172.16.6.155:20160</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  tikv</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">          172.16.6.155</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  20160/20180</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Up</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      /home/data/tidb-home/data/tikv-20160</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">         /home/data/tidb-deploy/tikv-20160</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">172.16.6.194:20160</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  tikv</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">          172.16.6.194</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  20160/20180</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Up</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      /home/data/tidb-home/data/tikv-20160</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">         /home/data/tidb-deploy/tikv-20160</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">172.16.6.196:20160</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  tikv</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">          172.16.6.196</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  20160/20180</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  linux/x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  Up</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      /home/data/tidb-home/data/tikv-20160</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">         /home/data/tidb-deploy/tikv-20160</span></span></code></pre>
</div><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>TiCDC Âú® 4.0.6 ÁâàÊú¨ GAÔºåÂª∫ËÆÆ‰ΩøÁî® 4.0.6 Âèä‰ª•ÂêéÁöÑÁâàÊú¨</strong>ÔºåËØ¶ÊÉÖÂèÇËÄÉ --&gt; <a href="https://docs.pingcap.com/zh/tidb/stable/scale-tidb-using-tiup#%E6%89%A9%E5%AE%B9-ticdc-%E8%8A%82%E7%82%B9" target="_blank" rel="noreferrer">TiCDC ÂÆòÊñπÊñáÊ°£</a>ÔºåÊâ©ÂÆπÊ≠•È™§Â¶Ç‰∏ã„ÄÇ</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@Linux-Hostname </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ cat scale-out-cdc.yaml </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">cdc_servers:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> host:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 172.16.6.155</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    gc-ttl:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 86400</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    data_dir:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /data/deploy/install/data/cdc-8300</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> host:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 172.16.6.196</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    gc-ttl:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 86400</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    data_dir:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /data/deploy/install/data/cdc-8300</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@Linux-Hostname </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ tiup cluster scale-out tidb-test scale-out-cdc.yaml</span></span></code></pre>
</div><h3 id="_4-2-ÂêåÊ≠•Ëá≥-kafka" tabindex="-1">4.2 ÂêåÊ≠•Ëá≥ Kafka <a class="header-anchor" href="#_4-2-ÂêåÊ≠•Ëá≥-kafka" aria-label="Permalink to &quot;4.2 ÂêåÊ≠•Ëá≥ Kafka&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Áî±‰∫éÊú¨‰∫∫‰πãÂâçÊ≤°Êé•Ëß¶Ëøá kafka ,Êú¨ÁùÄÁÜüÊÇâ TiCDC ‰πüË¶Å‰∫ÜËß£ÂÖ∂Âë®ËæπÂ∑•ÂÖ∑ÁöÑÁõÆÁöÑÔºå‰ªé <a href="https://kafka.apache.org/intro" target="_blank" rel="noreferrer">kafka ÂÆòÁΩë</a> ËøõË°å‰∫ÜÁÆÄÂçïÂÖ•Èó®ÔºåÂ¶ÇÊúâ‰ªª‰ΩïÊ≠£Á°ÆÊÄßÈóÆÈ¢òÂèØÂèäÊó∂ËØÑËÆ∫Âå∫‰∫§ÊµÅ„ÄÇ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>ÁÆÄÂçï‰∫ÜËß£ÂêéÔºå‰∏™‰∫∫ËßâÂæó kafka Á±ª‰ºº GoLang ‰∏≠ÁöÑ ChannelÔºåÂå∫Âà´Âú®‰∫éÊèê‰æõ‰∫ÜÈ´òÊÄßËÉΩÁöÑ„ÄÅÂàÜÂ∏ÉÂºèÁöÑ„ÄÅÈ´òÂèØÁî®ÁöÑ„ÄÅÂºπÊÄßÁöÑ„ÄÅÂÆπÈîôÁöÑ„ÄÅÂÆâÂÖ®ÁöÑ ‚Äú‰∫ã‰ª∂ÊµÅÂπ≥Âè∞‚Äù ÊúçÂä°„ÄÇ</strong> kafka ÂÆòÁΩë‰ªãÁªçÂÖ∂‰∫ã‰ª∂ÊµÅÂºèÂ§ÑÁêÜÊú∫Âà∂Â¶Ç‰∏ãÂõæÊâÄÁ§∫ÔºåTopic ‰Ωú‰∏∫ÂàÜÂèëÊ∂àË¥πÁöÑÈÄªËæëÂçïÂÖÉÔºåPartition ‰Ωú‰∏∫ÊúÄÂ∞èÂ≠òÂÇ®ÂçïÂÖÉÔºå‰ª• Hash Key ÊàñÂÖ∂‰ªñÁ≠ñÁï•Â∞Ü Event ÂàíÂàÜÂà∞Â§ö‰∏™ Partition ‰∏≠ÔºåÊèê‰æõÈ´òÂêûÂêêÊÄßËÉΩ„ÄÇ</p>
<figure><img src="./../../../../../images/tidb/05TiDB-EcosystematicTools/5-1TiCDC/06streams-and-tables-.png" alt="06TiCDC_DataFlow_Model" tabindex="0"><figcaption>06TiCDC_DataFlow_Model</figcaption></figure>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‰∏ãÈù¢ÁÆÄÂçïËØïÁî®‰∏ã kafkaÔºåÊìç‰ΩúÊ≠•È™§Â¶Ç‰∏ãÔºåÁõÆÁöÑ‰∏∫‰ªé kafka ‰∏≠Ëß£ÊûêÂá∫ TiCDC ÂàÜÂèëÁªô kafka ÁöÑÊ∂àÊÅØÔºå‰∏çÊ∑±ÂÖ•Á†îÁ©∂ kafka ‰ΩìÁ≥ªÂèäË∞É‰ºò„ÄÇ</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># ÂÆâË£Ö Java ËøêË°åÁéØÂ¢É</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@kafka1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ yum install java-1.8.0-openjdk.x86_64</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@kafka1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ java -version</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">openjdk</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> version</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "1.8.0_322"</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># ‰æùÊçÆ kafka quickstart Âú® 172.16.6.155„ÄÅ172.16.6.196 ‰∏§‰∏™ server Êû∂Ëµ∑ kafka</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@kafka1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$  wget https://dlcdn.apache.org/kafka/3.1.0/kafka_2.13-3.1g/kafka/3.1.0/kafka_2.13-3.1.0.tgz --no-check-certificate</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@kafka1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$  tar -xzf kafka_2.13-3.1.0.tgz</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@kafka1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$  cd kafka_2.13-3.1.0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@kafka1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$  bin/zookeeper-server-start.sh config/zookeeper.properties</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@kafka1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$  bin/kafka-server-start.sh config/server.properties</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># ÂàõÂª∫ partition ‰∏∫ 2„ÄÅtopic-name ‰∏∫ tidb-test ÁöÑ topic</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@kafka1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$  bin/kafka-topics.sh --create --topic tidb-test </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    --bootstrap-server</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  172.16.6.155:9092,172.16.6.196:9092</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    --partitions</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Created</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> topic</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> quickstart-events.</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Êü•Áúã topic-name ‰∏∫ tidb-test ÁöÑ topic ÁöÑÈÖçÁΩÆÊÉÖÂÜµÔºåÂèØ‰ª•ÁúãÂà∞ partition ‰∏∫ 2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@kafka1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ bin/kafka-topics.sh --describe --topic tidb-test </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    --bootstrap-server</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 172.16.6.155:9092,172.16.6.196:9092</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Topic:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-test</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> TopicId:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> OjM6FFrBQtqyEB4sVWmYCQ</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> PartitionCount:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ReplicationFactor:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Configs:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> segment.bytes=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1073741824</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Topic:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-test</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Partition:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Leader:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Replicas:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Isr:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Topic:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-test</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Partition:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Leader:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Replicas:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Isr:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 0</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># ÂàõÂª∫ TiCDC Âà∞ kafka ÁöÑ changefeed ÂêåÊ≠•,Âπ∂Â§çÁî®ÊâãÂä®ÂàõÂª∫ÁöÑ tidb-test topic</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@kafka1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ tiup cdc cli changefeed create --pd</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">http://172.16.6.155:2379</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    --sink-uri=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"kafka://172.16.6.155:9092/tidb-test?protocol=canal-json&#x26;kafka-version=2.4.0&#x26;partition-num=2&#x26;max-message-bytes=67108864&#x26;replication-factor=1"</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tiup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> checking</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> updates</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> component</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> cdc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> component</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">cdc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /home/tidb/.tiup/components/cdc/v6.0.0/cdc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /home/tidb/.tiup/components/cdc/v6.0.0/cdc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> cli</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> changefeed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> create</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --pd=http://172.16.6.155:2379</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --sink-uri=kafka://172.16.6.155:9092/tidb-test</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">?</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">protocol=canal-json</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&#x26;kafka-version</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">2.4.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&#x26;partition-num</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&#x26;max-message-bytes</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">67108864</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&#x26;replication-factor</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[2022/05/12 16:37:09.667 +08:00] [WARN] [kafka.go:416] [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"topic's `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">max.message.bytes</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">` less than the `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">max-message-bytes</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`,use topic's `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">max.message.bytes</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">` to initialize the Kafka producer"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">] [max.message.bytes</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">1048588] [max-message-bytes</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">67108864]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[2022/05/12 16:37:09.667 +08:00] [WARN] [kafka.go:425] [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"topic already exist, TiCDC will not create the topic"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">] [topic</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">tidb-test] [detail</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"{</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">NumPartitions</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">:2,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">ReplicationFactor</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">:1,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">ReplicaAssignment</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">:{</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">:[0],</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">:[0]},</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">ConfigEntries</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">:{</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">segment.bytes</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">1073741824</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">}}"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Create</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> changefeed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> successfully!</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># Âà©Áî® sysbench Âêë jan.sbtest1 ‰∏≠ÊèíÂÖ• 2 Ë°åÊï∞ÊçÆ   </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@kafka1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ sysbench oltp_read_write --mysql-host</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">127.0.0.1</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    --mysql-port=4000</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    --mysql-db=jan</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    --mysql-user=root</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    --mysql-password=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    --table_size=2</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    --tables=1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  prepare</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># ‰ªé kafka ‰∏≠Ëß£Êûê TiDB ÁöÑÊï∞ÊçÆÂèòÊõ¥Â¶Ç‰∏ã   </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@kafka1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ bin/kafka-console-consumer.sh --topic tidb-test </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">\</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    --from-beginning</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --bootstrap-server</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 172.16.6.155:9092,172.16.6.196:9092</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"id"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">:0,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"database"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"jan"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"table"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"sbtest1"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"pkNames"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"id"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">],</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"isDdl"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">:false,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"type"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"INSERT"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"es"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">:1652344970654,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"ts"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">:1652344977538,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"sql"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">""</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"sqlType"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">c</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":1,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">id</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":4,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">k</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":4,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">pad</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":1},"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">mysqlType</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":{"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">c</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">char</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">id</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">k</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">pad</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">char</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"},"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">data</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":[{"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">c</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">83868641912-28773972837-60736120486-75162659906-27563526494-20381887404-41576422241-93426793964-56405065102-33518432330</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">id</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">1</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">k</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">1</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">pad</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">67847967377-48000963322-62604785301-91415491898-96926520291</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"}],"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">old</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":null}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">{"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">id</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":0,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">database</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">table</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sbtest1</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">pkNames</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":["</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">id</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"],"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">isDdl</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":false,"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">INSERT</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">es</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":1652344970654,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ts</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":1652344977538,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sql</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sqlType</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":{"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">c</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":1,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">id</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":4,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">k</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":4,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">pad</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":1},"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">mysqlType</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":{"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">c</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">char</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">id</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">k</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">pad</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">char</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"},"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">data</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":[{"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">c</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">38014276128-25250245652-62722561801-27818678124-24890218270-18312424692-92565570600-36243745486-21199862476-38576014630</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">id</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">2</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">k</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">2</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">pad</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">23183251411-36241541236-31706421314-92007079971-60663066966</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"}],"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">old</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":null}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">{"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">id</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":0,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">database</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">table</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">pkNames</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":null,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">isDdl</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":true,"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">QUERY</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">es</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":1652344966953,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ts</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":1652344969305,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sql</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">CREATE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> DATABASE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sqlType</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":null,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">mysqlType</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":null,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">data</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":null,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">old</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":null}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">{"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">id</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":0,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">database</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">table</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sbtest1</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">pkNames</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":null,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">isDdl</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":true,"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">CREATE</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">","</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">es</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":1652344970604,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ts</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":1652344975305,"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sql</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">":"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">CREATE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> TABLE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sbtest1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">id</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> INT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> NOT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> NULL</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> AUTO_INCREMENT,`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">k</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> INT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> DEFAULT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> _UTF8MB4'0'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> NOT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> NULL,`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> CHAR(120</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">DEFAULT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> _UTF8MB4''</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> NOT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> NULL,`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">pad</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> CHAR(60</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) DEFAULT _UTF8MB4</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">''</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> NOT NULL,PRIMARY KEY(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">id</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)) ENGINE = innodb","sqlType":null,"mysqlType":null,"data":null,"old":null}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"id"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">:0,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"database"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"jan"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"table"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"sbtest1"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"pkNames"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">:null,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"isDdl"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">:true,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"type"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"CINDEX"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"es"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">:1652344973455,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"ts"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">:1652344978504,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"sql"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"CREATE INDEX </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">k_1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> ON </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">sbtest1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">k</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">)"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"sqlType"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">:null,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"mysqlType"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">:null,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"data"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">:null,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">"old"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">:null}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># ÂÆûÈ™åÁªìÊùüÊ∏ÖÁêÜ 172.16.6.155„ÄÅ172.16.6.196 ‰∏§‰∏™ server Êû∂Ëµ∑ kafka ÁéØÂ¢É</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"># È¶ñÂÖà ctrl + c ÂÖ≥Èó≠ÊâÄÊúâÁªàÁ´ØÂêØÂä®ÁöÑÂâçÂè∞ËøõÁ®ã</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@kafka1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ rm -rf /tmp/kafka-logs /tmp/zookeeper</span></span></code></pre>
</div><h3 id="_4-3-ÂêåÊ≠•Ëá≥-mysql" tabindex="-1">4.3 ÂêåÊ≠•Ëá≥ MySQL <a class="header-anchor" href="#_4-3-ÂêåÊ≠•Ëá≥-mysql" aria-label="Permalink to &quot;4.3 ÂêåÊ≠•Ëá≥ MySQL&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Âú® <code>172.16.6.155:3306</code> Êú¨Âú∞Ë£Ö‰∏™ MySQLÔºåÊåáÂÆöÁõ∏ÂÖ≥ÂèÇÊï∞Âêé‰æøÂèØÂàõÂª∫ËÆ¢ÈòÖ‰ªªÂä°Ôºåid ‰∏∫ simple-replication-taskÔºåÂú® Grafana ÁõëÊéßÈù¢Êùø‰∏≠ÂèØËßÇÂØüÂà∞ÂêåÊ≠•ËøõÂ∫¶„ÄÇMySQL ÂØπ‰∫é DBA ËÆ≤‰∏ÄÂÆöÊòØËæÉ‰∏∫ÁÜüÊÇâÁöÑÂ∑•ÂÖ∑ÔºåÂõ†Ê≠§È™åËØÅÂêåÊ≠•Á≠âÊ≠•È™§‰æø‰∏çËµòËø∞„ÄÇ</p>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[tidb@Linux-Hostname </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]$ tiup cdc cli changefeed create --pd</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">http://172.16.6.155:2379</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  --sink-uri=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"mysql://jan:123123@172.16.6.155:3306/?time-zone=&#x26;worker-count=16&#x26;max-txn-row=5000"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  --changefeed-id=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"simple-replication-task"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  --sort-engine=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"unified"</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">  --config=changefeed.toml</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">tiup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> checking</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> updates</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> component</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> cdc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> component</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">cdc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /home/tidb/.tiup/components/cdc/v6.0.0/cdc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> /home/tidb/.tiup/components/cdc/v6.0.0/cdc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> cli</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> changefeed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> create</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --pd=http://172.16.6.155:2379</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --sink-uri=mysql://jan:123123@172.16.6.155:3306/</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">?</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">time-zone=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&#x26;worker-count</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">16</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&#x26;max-txn-row</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">5000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> --changefeed-id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">simple-replication-task</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> --sort-engine</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">unified</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> --config</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">changefeed.toml</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[2022/04/12 16:58:40.954 +08:00] [WARN] [mysql_params.go:143] [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"max-txn-row too large"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">] [original</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">5000] [override</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">2048]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Create</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> changefeed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> successfully!</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">......</span></span></code></pre>
</div><h2 id="‰∫î„ÄÅÂºïÁî®ÊñáÁ´†" tabindex="-1">‰∫î„ÄÅÂºïÁî®ÊñáÁ´† <a class="header-anchor" href="#‰∫î„ÄÅÂºïÁî®ÊñáÁ´†" aria-label="Permalink to &quot;‰∫î„ÄÅÂºïÁî®ÊñáÁ´†&quot;"></a></h2>
<p><a href="https://www.bilibili.com/video/BV1HT4y1A7mh?spm_id_from=333.337.search-card.all.click" target="_blank" rel="noreferrer">1. „ÄêPingCAP Infra Meetup„ÄëNo.131 Why and how we build TiCDC</a><br>
<a href="https://www.bilibili.com/video/BV1bD4y1o7qU?spm_id_from=333.337.search-card.all.click" target="_blank" rel="noreferrer">2. „ÄêPingCAP Infra Meetup„ÄëNo.131 TiCDC ÁöÑÁîüÊÄÅÂíåÁ§æÂå∫Âª∫ËÆæ</a>
<a href="https://docs.pingcap.com/zh/tidb/stable/ticdc-overview" target="_blank" rel="noreferrer">3. ÂÆòÊñπÊñáÊ°£ -- TiCDC</a><br>
<a href="https://docs.pingcap.com/zh/tidb/stable/tidb-binlog-overview" target="_blank" rel="noreferrer">4. ÂÆòÊñπÊñáÊ°£ -- TiDB Binlog</a><br>
<a href="https://docs.pingcap.com/zh/tidb/stable/handle-tidb-binlog-errors#%E5%BD%93%E4%B8%8A%E6%B8%B8%E4%BA%8B%E5%8A%A1%E8%BE%83%E5%A4%A7%E6%97%B6pump-%E6%8A%A5%E9%94%99-rpc-error-code--resourceexhausted-desc--trying-to-send-message-larger-than-max-2191430008-vs-2147483647" target="_blank" rel="noreferrer">5. ÂÆòÊñπ FAQ -- Pump ÁöÑ gRPC message Ë∂ÖËøáÈôêÂÄº</a><br>
<a href="https://github.com/pingcap/tiflow/blob/master/docs/design/2020-11-04-ticdc-protocol-list.md#protocols-%E5%88%86%E5%8D%8F%E8%AE%AE%E4%BB%8B%E7%BB%8D" target="_blank" rel="noreferrer">6. Github Design Doc -- TiCDC ÊîØÊåÅÁöÑÊ∂àÊÅØÈòüÂàóËæìÂá∫ÂçèËÆÆÊåáÂçó</a><br>
<a href="https://github.com/pingcap/tiflow/projects/13" target="_blank" rel="noreferrer">7. Github Question and Bug Reports -- TiCDC ÊèêÂçáÊÄßËÉΩËßÑÂàíË∑ØÂæÑ</a><br>
<a href="https://tidb.net/blog/2fa9cf6a" target="_blank" rel="noreferrer">8. AskTUG Blog -- ‰ª£ÊôìÁ£ä TiCDC Â∫îÁî®Âú∫ÊôØËß£Êûê</a>
<a href="https://kafka.apache.org/intro" target="_blank" rel="noreferrer">9. ÂÆòÊñπÊñáÊ°£ -- Kafka</a></p>
<p>Ê≠§Â§ñÔºåAskTUG ‰Ωú‰∏∫ TiDB ÂÆòÊñπÊîØÊåÅÁîüÊÄÅÁ§æÂå∫ÔºåÂª∫ËÆÆÂ§ßÂÆ∂Êù•<a href="https://tidb.net/blog/70588c4c" target="_blank" rel="noreferrer">ËøôÈáå https://tidb.net/blog/70588c4c</a> ‰∏ÄËµ∑ËÆ®ËÆ∫„ÄÇ</p>
]]></content:encoded>
            <enclosure url="https://askaric.com/images/tidb/05TiDB-EcosystematicTools/5-1TiCDC/01BinlogAndTiCDC.png" length="0" type="image/png"/>
        </item>
        <item>
            <title><![CDATA[ÂâñÊûêÊû∂ÊûÑÊ®°Âûã]]></title>
            <link>https://askaric.com/zh/work/tidb/TiDB-EcosystematicTools/TiCDC/TiCDC Streaming.html</link>
            <guid>https://askaric.com/zh/work/tidb/TiDB-EcosystematicTools/TiCDC/TiCDC Streaming.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[‰∏Ä„ÄÅÂêåÊ≠•Ê®°Âûã

 1.1 ÊµÅÂºèÂ§ÑÁêÜ‰∏éÊâπÈáèÂ§ÑÁêÜ

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‚ÄúÊï∞ÊçÆÂêåÊ≠•‚Äù Êú¨Ë¥®‰∏äËÆ≤Â±û‰∫é ‚ÄúÊï∞ÊçÆÂ§ÑÁêÜ‚ÄùÔºåÂç≥Ôºö‰ªé]]></description>
            <content:encoded><![CDATA[<h1 id="ÂâñÊûêÊû∂ÊûÑÊ®°Âûã" tabindex="-1">ÂâñÊûêÊû∂ÊûÑÊ®°Âûã <a class="header-anchor" href="#ÂâñÊûêÊû∂ÊûÑÊ®°Âûã" aria-label="Permalink to &quot;ÂâñÊûêÊû∂ÊûÑÊ®°Âûã&quot;"></a></h1>
<h2 id="‰∏Ä„ÄÅÂêåÊ≠•Ê®°Âûã" tabindex="-1">‰∏Ä„ÄÅÂêåÊ≠•Ê®°Âûã <a class="header-anchor" href="#‰∏Ä„ÄÅÂêåÊ≠•Ê®°Âûã" aria-label="Permalink to &quot;‰∏Ä„ÄÅÂêåÊ≠•Ê®°Âûã&quot;"></a></h2>
<h3 id="_1-1-ÊµÅÂºèÂ§ÑÁêÜ‰∏éÊâπÈáèÂ§ÑÁêÜ" tabindex="-1">1.1 ÊµÅÂºèÂ§ÑÁêÜ‰∏éÊâπÈáèÂ§ÑÁêÜ <a class="header-anchor" href="#_1-1-ÊµÅÂºèÂ§ÑÁêÜ‰∏éÊâπÈáèÂ§ÑÁêÜ" aria-label="Permalink to &quot;1.1 ÊµÅÂºèÂ§ÑÁêÜ‰∏éÊâπÈáèÂ§ÑÁêÜ&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‚ÄúÊï∞ÊçÆÂêåÊ≠•‚Äù Êú¨Ë¥®‰∏äËÆ≤Â±û‰∫é ‚ÄúÊï∞ÊçÆÂ§ÑÁêÜ‚ÄùÔºåÂç≥Ôºö‰ªéÊï∞ÊçÆÁöÑ‰∏ÄÁ´ØÊµÅÂêëÂè¶‰∏ÄÁ´ØÁöÑÊï∞ÊçÆÂ§ÑÁêÜÔºå‚ÄúÁ´Ø‚Äù ‰ª•‰∫ßÂìÅ‰∏∫Âçï‰ΩçÔºåÂåÖÂê´ÂàÜÂ∏ÉÂºèÈõÜÁæ§„ÄÇÈÇ£‰πà ‚ÄúÊï∞ÊçÆÂ§ÑÁêÜ‚Äù ÁöÑ‰∏ªË¶ÅÁ±ªÂûãÂèàÂèØÂàÜ‰∏∫ ‚ÄúÊµÅÂºèÂ§ÑÁêÜ‚Äù ‰∏é ‚ÄúÊâπÈáèÂ§ÑÁêÜ‚ÄùÔºå‰∫åËÄÖÂÆö‰πâ„ÄÅÁâπÁÇπ„ÄÅËµ∑Ê∫êÂ¶Ç‰∏ãÔºåÂÄüÈâ¥Ëá™ <a href="https://flink.apache.org/flink-architecture.html" target="_blank" rel="noreferrer">Flink ÂÆòÁΩëËÆ°ÁÆóÂºïÊìéËØ¥Êòé</a>Ôºö<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1. ÂÆö‰πâËÄåË®ÄÔºö<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ÊâπÈáèÂ§ÑÁêÜÔºöÂØπÂõ∫ÂÆöËåÉÂõ¥ÁöÑÊï∞ÊçÆÈõÜÔºåÂü∫‰∫é MapReduce „ÄÅ Batch Á≠âÁÆóÊ≥ïÔºåÂ§ÑÁêÜÊï∞ÊçÆÂÆûÁé∞ÂäüËÉΩÈúÄÊ±ÇÔºõ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ÊµÅÂºèÂ§ÑÁêÜÔºöÂØπÊó†Âõ∫ÂÆöËåÉÂõ¥Êï∞ÊçÆÈõÜÔºåÂü∫‰∫é Event-Time ÁöÑÊï∞ÊçÆÁªìÊûÑÂ§ÑÁêÜÁÆóÊ≥ïÔºåÂ§ÑÁêÜÊï∞ÊçÆÂÆûÁé∞ÂäüËÉΩÈúÄÊ±ÇÔºõ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2. ÁâπÁÇπËÄåË®ÄÔºö<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ‚ÄúÊâπÈáèÂ§ÑÁêÜ‚Äù ÊïÖÂêçÊÄù‰πâ‰ª•ÊâπÈáèÂáèÂ∞ëË∞ÉÁî®ËøáÁ®ã‰∏≠ÁöÑÈùûÂøÖË¶ÅÊÄßËÉΩÊ∂àËÄóÔºåËææÂà∞ÊÄßËÉΩÊèêÂçáÁöÑÁõÆÁöÑÔºåÂ¶ÇÔºöMapReduce„ÄÇ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ‚ÄúÊµÅÂºèÂ§ÑÁêÜ‚Äù ÊòØÁõ∏ÂØπ‰∫éÊâπÈáèÂ§ÑÁêÜ‰∫ßÁîüÁöÑÔºåÂØπ‰∫éÂÉèÊó•ÂøóÊï∞ÊçÆ„ÄÅ‰∫§ÊòìÊï∞ÊçÆÁ±ªÂûãÁöÑÔºåÊ∫êÊ∫ê‰∏çÊñ≠‰∫ßÁîüÁöÑÊï∞ÊçÆÊµÅÔºåÂü∫‰∫éÊï∞ÊçÆËá™Ë∫´ÊúâÂ∫èÊÄßÁöÑÔºàÂèëÁîüÊó∂Èó¥ÔºâÊï∞ÊçÆÁªìÊûÑÔºå‰ºòÂåñÂá∫Êù•ÁöÑËÆ°ÁÆóÊñπÊ≥ï„ÄÇ‰∏æ‰∏™Á±ª MapReduce ÁöÑ‰æãÂ≠êÔºåÂú®ÊâπÈáèÂ§ÑÁêÜ‰∏≠Â¶ÇÊûúÊÉ≥ÁªüËÆ° Log1„ÄÅLog2 ‰∏≠ 3:00:00 ÔΩû 4:00:00 ÁöÑ A Áä∂ÊÄÅÁ±ªÂûãÊï∞ÊçÆÂèò‰∏∫ B Áä∂ÊÄÅÁ±ªÂûãÊï∞ÊçÆÁöÑÂèòÊõ¥ÂèëÁîüÁöÑÊ¨°Êï∞ÔºåÈÇ£‰πàÊâπÈáèÁöÑÂÅöÊ≥ïÊòØÂú®ÂºÄÂêØÂØπÂ∫îÊó∂Èó¥Á™óÂè£ÊîíÊâπÁªüËÆ°ÂÜçÊ±áÊÄªÂä†Âíå„ÄÇËøôÊó∂Â¶ÇÊûúÂõ†‰∏∫ÂºÇÊ≠•Á∫øÁ®ãÊàñÁΩëÁªú‰º†ËæìÂéüÂõ†ÂØºËá¥ Log1 ‰∏≠‰∏Ä‰∏™ËØ•Á±ªÂûãÂèòÊõ¥Âú®ÊâπÈáèÊó∂Èó¥Á™óÂè£Â§ñÔºà4:05:00ÔºâËêΩÁõòÔºåÈÇ£‰πàËøôÊ¨°ÊâπÈáèÂ∞ÜÊó†Ê≥ïËÆ°ÁÆóÂá∫Ëøô‰∏™‰∫ã‰ª∂ÔºåÂè™ËÉΩ‰∏ãÊ¨°ÊâπÈáèËÆ°ÁÆóËß£ÂÜ≥„ÄÇËØ•‰æãÂ≠ê‰ºöÂú® ‚ÄúÊï∞ÊçÆÂêåÊ≠•‚Äù Á±ªÂûãÊï∞ÊçÆÂ§ÑÁêÜ‰∏≠ÂºïÂèëÊ≠£Á°ÆÊÄßÈóÆÈ¢òÔºåÂõ†Ê≠§ÊµÅÂºèÂ§ÑÁêÜÂ∫îËøêËÄåÁîüÔºåÁâπÂà´ÈÄÇÂêàÂ§ÑÁêÜ <strong>ÊúâÁä∂ÊÄÅÁöÑÔºàÂ¶ÇÔºöÊó∂Èó¥Ôºâ</strong> Êó†ÁïåÊï∞ÊçÆÊµÅ„ÄÇ</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Áªº‰∏äÔºåËØ•ËäÇËØïÂõæËØ¥ÊòéÊï∞ÊçÆÂêåÊ≠•ÈÄÇÂêà <strong>ÊµÅÂºè‰∫ã‰ª∂Â§ÑÁêÜ</strong> Á±ªÂûãÔºåÂ≠¶‰π† TiCDC ‰ª£Á†ÅËøáÁ®ã‰∏≠ÂèëÁé∞Â∞±ÊòØÊµÅÂºè‰∫ã‰ª∂Â§ÑÁêÜ„ÄÇ</p>
<h3 id="_1-2-ÊµÅÂ§ÑÁêÜ-source-‰∏é-sink" tabindex="-1">1.2 ÊµÅÂ§ÑÁêÜ source ‰∏é sink <a class="header-anchor" href="#_1-2-ÊµÅÂ§ÑÁêÜ-source-‰∏é-sink" aria-label="Permalink to &quot;1.2 ÊµÅÂ§ÑÁêÜ source ‰∏é sink&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Âú® TiCDC Á≥ªÂàóÂàÜ‰∫´Á¨¨‰∏ÄÁØá <a href="https://tidb.net/blog/70588c4c" target="_blank" rel="noreferrer">TiCDCÁ≥ªÂàóÂàÜ‰∫´-01-ÁÆÄËø∞‰ΩøÁî®ËÉåÊôØ</a> ‰∏≠ÔºåÊèêÂà∞ TiCDC Êèê‰æõ At Least Once ÁöÑÂêåÊ≠•Ê®°ÂûãÔºåAt Least Once ÊèèËø∞ÁöÑÊòØÔºö<strong>‚ÄúÂú®ÂêåÊ≠•ÈìæË∑Ø‰∏≠‰ªªÊÑèÁªÑ‰ª∂ËäÇÁÇπÂèëÁîüÊïÖÈöúÊó∂ÔºåÊµÅÂºèÂ§ÑÁêÜÁ≥ªÁªüÁöÑÊäïÈÄíËØ≠‰πâ‚Äù</strong>„ÄÇÁõ∏ÂÖ≥ËØ≠‰πâÁöÑÂÖ®ÈõÜÂ¶Ç‰∏ãÔºö</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1. At Most OnceÔºàÊúÄÂ§ö‰∏ÄÊ¨°Ôºâ ÔºöÁÆóÂ≠ê‰∫ã‰ª∂‰ªÖË¢´Â§ÑÁêÜ‰∏ÄÊ¨°ÔºåÂç≥ÔºöÈªòËÆ§‰∏ãÊ∏∏ÁÆóÂ≠êÂùáÊàêÂäüÊé•Êî∂‰∏äÊ∏∏ÊäïÈÄíÁöÑÊ∂àÊÅØÔºåÂèëÁîüÊïÖÈöúÂàôÊï∞ÊçÆ‰∏¢Â§±Ôºõ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2. At Least OnceÔºàÊúÄÂ∞ë‰∏ÄÊ¨°ÔºâÔºöÁÆóÂ≠ê‰∫ã‰ª∂‰ºöË¢´Â§ÑÁêÜÂ§öÊ¨°ÔºåÂç≥Ôºö‰∏ãÊ∏∏ÁÆóÂ≠êÂõ†ÊïÖÈöúÊú™Êé•Êî∂Ê∂àÊÅØÔºå‰∏äÊ∏∏ÁÆóÂ≠êÂèëËßâÂêé‰ºöÈáçÂèëÊï∞ÊçÆÔºõ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3. Exactly OnceÔºàÊúâÊïà‰∏ÄÊ¨°Ôºâ ÔºöÁÆóÂ≠êÊó∂Èó¥ÊúâÊïàÂ§ÑÁêÜ‰∏ÄÊ¨°ÔºåÂç≥Ôºö‰∏ãÊ∏∏ÁÆóÂ≠êÂõ†ÊïÖÈöúÊú™Êé•Êî∂Ê∂àÊÅØÔºåÂØπ‰∏ãÊ∏∏ÁÆóÂ≠êÊù•ËÆ≤‰ºöÊé•Êî∂‰∏äÊ∏∏‰ªéÂèëÁöÑÊï∞ÊçÆÔºå‰ΩÜÂØπ‰∫é‰∏ãÊ∏∏ÁÆóÂ≠êÁöÑ‰∏ãÊ∏∏ÁÆóÂ≠êÔºà‰æãÔºöÂèØËÉΩÊòØÂ§ñÈÉ®Á≥ªÁªü MySQLÔºâÊù•ËÆ≤Âè™Ë¢´ÊúâÊïàÁöÑÊäïÈÄíÊ∂àÊÅØËøá‰∏ÄÊ¨°„ÄÇ</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Âú® <strong>ÊµÅÂºèÂ§ÑÁêÜÔºà‰∫ã‰ª∂Â§ÑÁêÜÔºâ</strong> ‰∏≠ÔºåÂ¶ÇÔºö Goolge Dataflow„ÄÅFlink ÂàÜÂà´ÈÄöËøá ‚ÄúÈáçÂ§çÊï∞ÊçÆÂà†Èô§‚Äù Âèä <a href="https://lamport.azurewebsites.net/pubs/chandy.pdf" target="_blank" rel="noreferrer">‚ÄúÂàÜÂ∏ÉÂºèÂø´ÁÖß‚Äù</a> ÁöÑÊñπÂºèÂÆûÁé∞ Exactly Once,Exactly Once Êã•ÊúâÊõ¥Â•ΩÁöÑÊÄßËÉΩ,‰ΩÜÂú®‰∏çÂêåÁöÑÁÆóÊ≥ï‰∏ã‰πüÈÉΩÊúâËá™Â∑±ÁöÑ‰ºòÁº∫ÁÇπ,ËØ¶ÊÉÖÂèØÈòÖËØª <a href="https://juejin.cn/post/6844903857558913038#heading-5" target="_blank" rel="noreferrer">Flink China Blog Ë∞àË∞àÊµÅËÆ°ÁÆó‰∏≠ÁöÑ„ÄéExactly Once„ÄèÁâπÊÄß</a>„ÄÇËØ¥Âõû TiCDC ‰∏∫‰ªÄ‰πàÂè™Êèê‰æõ At Least Once ‰∏çÂæóËÄåÁü•ÔºåÂèØËÉΩÊòØÁªºÂêàÈ¢ÑÊúü„ÄÅ‰∫§‰ªò„ÄÅÊéíÊúü„ÄÅ‰ºòÂåñÁ≠âÂ§öÁßçÂõ†Á¥†ËÄåÊöÇÊó∂‰∏∫Êèê‰æõ Exactly Once ÊïÖÈöúÊäïÈÄíËØ≠‰πâÔºåÁõ∏‰ø°Âú®Êú™Êù•Áªà‰ºöÊèê‰æõËØ•ÁâπÊÄß„ÄÇ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ‰∏ãÂõæÊâÄÁ§∫‰∏∫Á±ªÊØîÈÄöÁî®ÊµÅÂºèÂºïÊìéÔºàDataflow or FlinkÔºâÊäΩË±°Âá∫Êù•ÁöÑÂêåÊ≠•Ê®°ÂûãÔºåsource ‰∏∫ÂèëÈÄÅÁ´Ø„ÄÅsink ‰∏∫Êé•Êî∂Á´Ø„ÄÇÁõÆÂâçÔºåÂú® TiCDC ‰∏≠Êúâ 2 ÈÉ®ÂàÜÂèØ‰ª•ÂΩíÁ∫≥‰∏∫ËØ•ÊäΩË±°Á±ªÂûã„ÄÇ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>1. Âú® tikv cdc component ‰∏≠ÊêúÈõÜÁöÑ kv change log ÊäïÈÄíÁªô TiCDC Capture ÁöÑËøáÁ®ãÔºõ</strong><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>2. Âú® puller ‰∏≠ÊêúÈõÜÊï∞ÊçÆÊäïÈÄíÁªô‰∏ãÊ∏∏ MySQL„ÄÅMQ„ÄÅOthers Âπ≥Âè∞ÁöÑËøáÁ®ãÔºõ</strong></p>
<figure><img src="./../../../../../images/tidb/05TiDB-EcosystematicTools/5-1TiCDC/07TiCDC_DataFlow_Model.png" alt="07TiCDC_DataFlow_Model" tabindex="0"><figcaption>07TiCDC_DataFlow_Model</figcaption></figure>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ÊäΩË±°‰∏∫ Source„ÄÅSink Âêé‰æøÊòØÂèØ‰ª•Â•óÁî®Âà∞ &quot;ÊµÅÂºèÂ§ÑÁêÜÁ≥ªÁªüÁöÑÊäïÈÄíËØ≠‰πâ&quot; ‰∏≠ÔºåÂç≥ÔºöÂú®ËØ•ÈìæË∑Ø‰∏≠Â¶ÇÊûúÂá∫Áé∞ÊäïÈÄíÊ∂àÊÅØÂ§±Ë¥•ÔºåÂàôÊèê‰æõÂì™ÁßçÁ∫ßÂà´ÁöÑËØ≠‰πâÊîØÊåÅ„ÄÇÂâçÊñáÂ∑≤ÂèôËø∞ <strong>TiCDC Êèê‰æõ At Least Once ËØ≠‰πâ</strong> ÊîØÊåÅÔºåÂ∞±ÊòØ‰ºöÈáç‰º†ÔºåÈáç‰º†ÂêéÁöÑÈáçÂ§çÊï∞ÊçÆÈáçÂ§çÊäïÈÄíÔºå‰ΩÜÁî±‰∫é <strong>‚ÄúÂπÇÁ≠â‚Äù</strong>  ÂÆûÁé∞Êï∞ÊçÆÁöÑ‰∏ÄËá¥ÊÄß„ÄÇ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1. Â¶ÇÊûú tikv cdc component Âêë TiCDC Capture ÊäïÈÄíÊ∂àÊÅØÂ§±Ë¥•ÔºåÂàôÈáç‰º†Ôºõ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2. Â¶ÇÊûú TiCDC Capture Âêë Downstream Platform ÊäïÈÄíÊ∂àÊÅØÂ§±Ë¥•ÔºåÂàôÈáç‰º†Ôºõ</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TiCDC ‰∏≠ Source„ÄÅSink ÁöÑÊäΩË±°Ê®°ÂùóÂØπÂ∫î‰πüÈ™åËØÅ‰∫Ü TiCDC ÂÖ∑ÊúâÂÅö ‚ÄúExactly Once‚Äù ÁöÑ‰∏Ä‰∫õÁõ∏‰ººÂÆö‰πâÂü∫Á°ÄÔºåÂè™ÊòØËøòÊ≤°ÊúâÂÅö„ÄÇ</p>
<h2 id="‰∫å„ÄÅ‰∫ßÂìÅÊû∂ÊûÑ" tabindex="-1">‰∫å„ÄÅ‰∫ßÂìÅÊû∂ÊûÑ <a class="header-anchor" href="#‰∫å„ÄÅ‰∫ßÂìÅÊû∂ÊûÑ" aria-label="Permalink to &quot;‰∫å„ÄÅ‰∫ßÂìÅÊû∂ÊûÑ&quot;"></a></h2>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‰∏ãÂõæÊâÄÁ§∫‰∏∫ TiCDC Êï∞ÊçÆÊµÅËΩ¨Êû∂ÊûÑÂõæÔºåTiCDC ËøêË°åÊó∂ÊòØÁî±Êó†Áä∂ÊÄÅËäÇÁÇπ Capture ÁªÑÊàêÔºåÈÄöËøá PD ÂÜÖÈÉ®ÁöÑ etcd ÂÆûÁé∞È´òÂèØÁî®ÔºåÊîØÊåÅÂàõÂª∫Â§ö‰∏™ÂêåÊ≠•‰ªªÂä°ÔºåÂêëÂ§ö‰∏™‰∏çÂêåÁöÑ‰∏ãÊ∏∏ËøõË°åÊï∞ÊçÆÂêåÊ≠•„ÄÇ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ‰∫ÜËß£ TiCDC ÂâçÈúÄË¶ÅÊéåÊè°‰∏Ä‰∫õÊ¶ÇÂøµÂÆö‰πâÔºåÂ¶Ç‰∏ã Owner„ÄÅProcessor„ÄÅChangeFeed„ÄÅReslovedTs„ÄÅCheckpointTs Á≠âÁ≠âÔºåÈÉ®ÂàÜÊ¶ÇÂøµÊ∫êËá™ <a href="https://docs.pingcap.com/zh/tidb/stable/ticdc-glossary#%E5%8F%98%E6%9B%B4%E6%95%B0%E6%8D%AE" target="_blank" rel="noreferrer">TiDB ÂÆòÁΩëËß£Èáä</a>ÔºåÂÖ∂‰ΩôÊ¶ÇÂøµÊ∫êËá™Êú¨‰∫∫ÂØπÁõ∏ÂÖ≥ÊñáÊ°£ÁöÑÈòÖËØª‰∏éÊ∫êÁ†ÅÁ†îÁ©∂ÔºåÊ¨¢Ëøé‰∫§ÊµÅ„ÄÇ</p>
<figure><img src="./../../../../../images/tidb/05TiDB-EcosystematicTools/5-1TiCDC/08ticdc_architecture.png" alt="08ticdc_architecture" tabindex="0"><figcaption>08ticdc_architecture</figcaption></figure>
<h3 id="_2-1-owner" tabindex="-1">2.1 Owner <a class="header-anchor" href="#_2-1-owner" aria-label="Permalink to &quot;2.1 Owner&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÂÆö‰πâÔºö‰∏Ä‰∏™ÁâπÊÆäËßíËâ≤ÁöÑ Capture„ÄÇ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ‰ΩçÁΩÆÔºö‰Ωç‰∫é Capture ÂÜÖÈÉ®Ôºå‰∏î‰ºöÁ´ûÈÄâËá™Â∑±ÊòØÂê¶ÂèØ‰ª•Êàê‰∏∫ OwnerÔºåÂè™Êúâ‰∏Ä‰∏™ Capture ‰ºöÁ´ûÈÄâÊàêÂäüÊàê‰∏∫ Owner„ÄÇ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ‰ΩúÁî®ÔºöÁª¥Êä§ÂÖ®Â±ÄÊâÄÊúâ Capture ‰∏≠ÂêåÊ≠• Task ÁöÑÂêåÊ≠•Áä∂ÊÄÅ„ÄÇÂ¶ÇÔºöTable ËΩ¨Áßª Capture Ë∞ÉÂ∫¶„ÄÅÊâßË°å DDL„ÄÅÊõ¥Êñ∞ changefeed ÁöÑ Global CheckpointTs Âíå Global ResolvedTs„ÄÇ</p>
<h3 id="_2-2-processor" tabindex="-1">2.2 Processor <a class="header-anchor" href="#_2-2-processor" aria-label="Permalink to &quot;2.2 Processor&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÂÆö‰πâÔºöÊï∞ÊçÆË°®ÁöÑÂêåÊ≠•Â§ÑÁêÜÂçïÂÖÉ„ÄÇ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ‰ΩçÁΩÆÔºö‰Ωç‰∫é Capture ÂÜÖÈÉ®ÔºåÊØè‰∏™ Capture ÂèØ‰ª•ÂêØÂä®Â§ö‰∏™ ProcessorÔºåProcessor ÁöÑÂ§öÂ∞ë‰∏é ChangeFeed Áõ∏ÂÖ≥ÔºåÂç≥Ôºö‰∏Ä‰∏™Â§öË°®ÂêåÊ≠• ChangeFeed ÂàõÂª∫Êó∂Ë¢´Ë∞ÉÂ∫¶Ëá≥ÂêÑ CaptureÔºåOwner ‰ºöÂü∫‰∫é (Capture ,ChangeFeedÔºå Table Êï∞Èáè) ÂÖÉÁªÑÂú®‰∏çÂêå Capture ‰∏äÊûÑÂª∫ Processor„ÄÇ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ‰ΩúÁî®ÔºöË¥üË¥£ÂàÜÈÖçÁªôËá™Â∑±ÁöÑÂêåÊ≠•Ë°®ÁöÑÂèòÊõ¥Êï∞ÊçÆÁöÑÊãâÂèñ„ÄÅÊéíÂ∫è„ÄÅËøòÂéüÂíåÂàÜÂèë„ÄÇChangeFeed ÂàõÂª∫Êó∂‰ºöËß¶Âèë Processor ÁöÑÂàõÂª∫ÔºåËØªÂèñË¢´ÂàÜÈÖçË°®ÁöÑ KeyRange„ÄÅRegion ÂàÜÂ∏ÉÔºåÂª∫Á´ã EventFeed gRPC stream„ÄÇÂú®ÊåÅÁª≠Êé®ÊµÅËøáÁ®ã‰∏≠Ôºå‰ºöÁª¥Êä§Ëá™Â∑±ÁöÑ Processor ResovledTs„ÄÅProcessor CheckpointTsÔºåÂπ∂‰æùÊçÆ Global ResolvedTs Âêë‰∏ãÊ∏∏ÂêåÊ≠•Êï∞ÊçÆ„ÄÇ</p>
<h3 id="_2-3-puller" tabindex="-1">2.3 Puller <a class="header-anchor" href="#_2-3-puller" aria-label="Permalink to &quot;2.3 Puller&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÂÆö‰πâÔºö‰ªé tikv ÊãâÂèñ Change log ÁöÑÊ®°Âùó„ÄÇ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ‰ΩçÁΩÆÔºöDDL Puller ‰Ωç‰∫é Processor ÂÜÖÈÉ®ÔºåÊØè‰∏™ Processor ‰∏Ä‰∏™„ÄÇ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Ë°åÂèòÊõ¥ Puller ‰Ωç‰∫é TablePipline ÂÜÖÈÉ®ÔºåÊØè‰∏™ TablePiplineÔºàÂç≥ÔºöTableÔºâ ‰∏Ä‰∏™„ÄÇ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ‰ΩúÁî®ÔºöÊåÅÁª≠ÁöÑ‰ªé TiKV ÊãâÂèñ Change Log ÂÜôÂà∞ Buffer„ÄÅSorter ‰∏≠„ÄÇ</p>
<h3 id="_2-4-mounter" tabindex="-1">2.4 Mounter <a class="header-anchor" href="#_2-4-mounter" aria-label="Permalink to &quot;2.4 Mounter&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÂÆö‰πâÔºöËΩ¨ËØë KV Change Log ‰∏∫ TiCDC Change Event ÁöÑÊ®°Âùó„ÄÇ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ‰ΩçÁΩÆÔºö‰Ωç‰∫é Capture ÂÜÖÈÉ®ÔºåMounter ÂØπ‰∫é Capture ËÆ≤ÊòØÂÖ®Â±ÄÁ∫øÁ®ãÊ±†Ôºå‰ΩÜÂõ†ÊØè‰∏™ TablePipline ÈÉΩ‰ºöË∞ÉÁî®ÔºåÁÆó Tablepipline ÂÜÖÈÉ®„ÄÇ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ‰ΩúÁî®ÔºöËß£Á†Å RawKVEntry Êàê RowChangedEventÔºåÂç≥ÔºöËΩ¨ËØë RawKV Êàê SQL ÈúÄË¶ÅÁöÑÊï∞ÊçÆ„ÄÇ</p>
<h3 id="_2-5-sorter" tabindex="-1">2.5 Sorter <a class="header-anchor" href="#_2-5-sorter" aria-label="Permalink to &quot;2.5 Sorter&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÂÆö‰πâÔºöÂØπ‰π±Â∫èÁöÑ kv change log ËøõË°åÊéíÂ∫èÁöÑÊ®°Âùó„ÄÇ
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ‰ΩçÁΩÆÔºö‰Ωç‰∫é Tablepipline ÂÜÖÈÉ®ÔºåÂØπ‰∫é unifiedSorter Â∞ÅË£Ö‰∫Ü Level DBÔºåÂÖ∂‰ªñÂºïÊìéÊöÇ‰∏ç‰ªãÁªçÔºå<a href="https://github.com/pingcap/tiflow/blob/master/docs/design/2022-03-16-ticdc-db-sorter.md" target="_blank" rel="noreferrer">ËØ¶ÊÉÖÂèÇËÄÉËÆæËÆ°ÊñáÊ°£ ticdc-db-sorter</a>„ÄÇ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ‰ΩúÁî®ÔºöÊé•Êî∂Êú™ÊéíÂ∫èÁöÑÊï∞ÊçÆÂ≠òËá≥ÂÜÖÈÉ® LevelDBÔºåÂπ∂Âü∫‰∫é CheckpointTs ÊéíÂ∫è,Áî®‰∫éËøòÂéü‰∫ãÂä°„ÄÅË°åÊï∞ÊçÆÂèòÊõ¥„ÄÇ</p>
<h3 id="_2-6-sink" tabindex="-1">2.6 Sink <a class="header-anchor" href="#_2-6-sink" aria-label="Permalink to &quot;2.6 Sink&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÂÆö‰πâÔºöÂêë‰∏ãÊ∏∏Â§öÂçèËÆÆÂπ≥Âè∞ÂêåÊ≠•ÁöÑÊäΩË±°Ê®°Âùó„ÄÇ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ‰ΩçÁΩÆÔºö‰Ωç‰∫é Capture ÂÜÖÈÉ®„ÄÇ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ‰ΩúÁî®ÔºöËß¶ÂèëË°åÂèòÊõ¥‰∫ã‰ª∂Êàñ DDL ÂèòÊõ¥‰∫ã‰ª∂ÔºåÂêë‰∏ãÊ∏∏ÂêåÊ≠•ÂèòÊõ¥Êï∞ÊçÆ„ÄÇ</p>
<h3 id="_2-7-changefeed" tabindex="-1">2.7 ChangeFeed <a class="header-anchor" href="#_2-7-changefeed" aria-label="Permalink to &quot;2.7 ChangeFeed&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÂÆö‰πâÔºöTiCDC ‰∏≠ÂêåÊ≠•‰ªªÂä°ÁöÑÂçï‰ΩçÔºåÊØè‰∏™ ChangeFeed ‰ªªÂä°ÂåÖÂê´Â§öÂº†Ë°®ÁöÑÂêåÊ≠•„ÄÇ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ‰ΩçÁΩÆÔºö‰Ωç‰∫é PD ‰∏≠ÔºåChangeFeed ÂàõÂª∫Âêé‰ºöË¢´ Capture ‰∏≠ÂØπÂ∫îÊ®°ÂùóÂ§ÑÁêÜ„ÄÇ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ‰ΩúÁî®ÔºöÈù¢ÂêëÁî®Êà∑Êèê‰æõÊòìÁêÜËß£ÁöÑ ‚ÄúÂêåÊ≠•‰ªªÂä°‚Äù ËØ≠‰πâÂÆö‰πâ„ÄÇ</p>
<h2 id="‰∏â„ÄÅreslovedts-‰∏é-checkpointts" tabindex="-1">‰∏â„ÄÅReslovedTs ‰∏é CheckpointTs <a class="header-anchor" href="#‰∏â„ÄÅreslovedts-‰∏é-checkpointts" aria-label="Permalink to &quot;‰∏â„ÄÅReslovedTs ‰∏é CheckpointTs&quot;"></a></h2>
<h3 id="_3-1-reslovedts" tabindex="-1">3.1 ReslovedTs <a class="header-anchor" href="#_3-1-reslovedts" aria-label="Permalink to &quot;3.1 ReslovedTs&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÂÆö‰πâÔºöTiDB ËÉΩËØªÂèñÁöÑÊúÄÊñ∞‰∏ÄËá¥ÊÄßÊï∞ÊçÆÔºà ResolvedTs &lt; All Unapply CommitTs ÔºâÔºåË°®Á§∫ ResolvedTs ÂâçÁöÑ tikv committed log ÂùáË¢´ puller Êî∂Âà∞ÂèØËøòÂéü‰∏∫ÂÆåÊï¥‰∫ãÂä°„ÄÇ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ‰ΩçÁΩÆÔºö‰Ωç‰∫é TiKV CDC Component ‰∏≠ÔºåÂú®Êï∞ÊçÆ Apply Êó∂ËßÇÂØü LockCF ÂèòÂåñÔºåÂÆûÁé∞ÂØπ Region Êï∞ÊçÆÂèòÊõ¥ÁöÑÁõëÊéß„ÄÇ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ‰ΩúÁî®ÔºöÈôç‰Ωé TiCDC ËøòÂéü‰∫ãÂä°ÁöÑÂª∂ËøüÔºåÂç≥ÔºöResolvedTS ‚â§ Min Region StartTS &lt; all unapplied CommitTS„ÄÇReslovedTs ÂàùÂßãÂåñ„ÄÅÊäïÈÄí„ÄÅÊé®ËçêÂéüÁêÜÂ¶Ç‰∏ãÔºö<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1. <strong>ResolvedTs ‰∫ßÁîü</strong>ÔºöÂú®ÂàùÂßãÂåñÈò∂ÊÆµÔºå‰∏∫ÂàùÂßãÂåñÊó∂‰º†ÂÖ•ÁöÑ‰∫ã‰ª∂Êà≥„ÄÇÂ¢ûÈáèÊâ´ÂêéÔºå‰∏∫‰ªé RaftStore ÁõëÂê¨ÁöÑÊó•Âøó‰∏≠Ëé∑Âèñ„ÄÇ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2. <strong>ResolvedTs ÊäïÈÄí</strong>ÔºöTiKV CDC Component ‰ºöÂêëÂ§ñÈÉ®Êé®ÈÄÅÊ¥ªË∑É Region ÁöÑ Prewrite + Commit ÁöÑÊï∞ÊçÆÔºàÊê∫Â∏¶ TsÔºâÔºåÈÄöËøáÂøÉË∑≥Êé®Âä®ÈùûÊ¥ªË∑É Region ÁöÑÊé®ËøõÔºàÊê∫Â∏¶ TsÔºâ„ÄÇ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3. <strong>ResolvedTs Êé®Ëøõ</strong>ÔºöResolvedTs ÂèàÂàÜ‰∏∫ Table Á∫ß„ÄÅProcessor Á∫ß„ÄÅGlobal Á∫ß„ÄÇCapture ‰ªé kv client Ëé∑ÂèñÁöÑ resolved tsÔºåÊåâÁÖßË°®ÂØπÊâÄÊúâ region ÂèñÊúÄÂ∞èÁöÑÊé®Ëøõ„ÄÇÂç≥ÔºöË°®ÂÜÖÊéíÂ∫èÂêéËæìÂá∫ÁöÑ event ‰∏≠ÂåÖÂê´ resolved ts event Â≠òÂÇ®‰∏∫Ëøô‰∏™Ë°®ÁöÑ resolved ts„ÄÇprocessor Ê±áÊÄªËá™Â∑±Ë¥üË¥£ÁöÑÊâÄÊúâË°®ÁöÑ resolved ts Âíå ddl puller ÁöÑresolved tsÔºåÂèñÊúÄÂ∞èÂÄºÊõ¥Êñ∞‰∏∫ËØ•Ë°®ÁöÑ resolved tsÔºåowner ËØªÂèñÊâÄÊúâË°®ÁöÑ resolved tsÔºåÂèñÊúÄÂ∞èÂÄºÊõ¥Êñ∞ global resolved ts„ÄÇ</p>
<h3 id="_3-2-checkpointts" tabindex="-1">3.2 CheckpointTs <a class="header-anchor" href="#_3-2-checkpointts" aria-label="Permalink to &quot;3.2 CheckpointTs&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÂÆö‰πâÔºöË°®Á§∫ CheckpointTs ÂâçÁöÑÊï∞ÊçÆÂ∑≤ÂÖ®ÈÉ®ÂêåÊ≠•Âà∞‰∏ãÊ∏∏Ôºå ResolvedTs ÁöÑ‰∏ÄÁßç„ÄÇ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ‰ΩçÁΩÆÔºö‰Ωç‰∫é Tablepipline„ÄÅProcessor„ÄÅOwner ‰∏≠ÔºåÊåÅÁª≠Êé®ÊµÅÈò∂ÊÆµ‰∏çÊñ≠Êõ¥Êñ∞„ÄÇ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ‰ΩúÁî®Ôºö‰øùËØÅ‰∫ãÂä°ÂéüÂ≠êÊÄßÔºåÂ¶Ç‰∏Ä‰∫ãÂä°Ë∑®ÂüüÂ§ö regionÔºåÂèØËÉΩÂá∫Áé∞‰∫ãÂä°Êèê‰∫§Êó∂Âè™ÊúâÈÉ®ÂàÜ key ÊàêÂäüÊäïÈÄíËá≥ captureÔºåÂØºËá¥Êó†Ê≥ïÊãºÂá∫ÂÆåÊï¥‰∫ãÂä°Êìç‰Ωú‰∏¢Â§±ÂéüÂ≠êÊÄß„ÄÇÁî® checkpointTs Ë°®Á§∫ËØ•Êó∂Èó¥ÁÇπ‰ª•ÂâçÊâÄÊúâÂ∞è‰∫é checkpointTs ÁöÑ key ÂùáÂ∑≤ÂèëÂà∞ Capture„ÄÇ</p>
<h2 id="Âõõ„ÄÅÂêØÂä®ÊµÅÁ®ã" tabindex="-1">Âõõ„ÄÅÂêØÂä®ÊµÅÁ®ã <a class="header-anchor" href="#Âõõ„ÄÅÂêØÂä®ÊµÅÁ®ã" aria-label="Permalink to &quot;Âõõ„ÄÅÂêØÂä®ÊµÅÁ®ã&quot;"></a></h2>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÊÄª‰ΩìÊù•ËØ¥Ôºå‰∏Ä‰∏™ ChangeFeed ÁöÑÂàõÂª∫ÈúÄË¶ÅÁªèÂéÜ <strong>‚ÄúÂ¢ûÈáèÊâ´‚Äù + ‚ÄúÊåÅÁª≠Êé®ÊµÅ‚Äù</strong> ‰∏§‰∏™Èò∂ÊÆµÔºåËØ¶ÁªÜÊèèËø∞Â¶Ç‰∏ãÔºåÂèÇËÄÉ <a href="https://github.com/pingcap/tiflow/blob/master/docs/design/2020-03-04-ticdc-design-and-architecture-cn.md#tikv-%E5%85%B7%E4%BD%93%E8%A1%8C%E4%B8%BA" target="_blank" rel="noreferrer">ticdc-design</a>Ôºö</p>
<figure><img src="./../../../../../images/tidb/05TiDB-EcosystematicTools/5-1TiCDC/09incremental_scan_continues_push.jpeg" alt="09incremental_scan_continues_push" tabindex="0"><figcaption>09incremental_scan_continues_push</figcaption></figure>
<h3 id="_4-1-Â¢ûÈáèÊâ´" tabindex="-1">4.1 Â¢ûÈáèÊâ´ <a class="header-anchor" href="#_4-1-Â¢ûÈáèÊâ´" aria-label="Permalink to &quot;4.1 Â¢ûÈáèÊâ´&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ChangeFeed ÂàõÂª∫ËØ∑Ê±ÇÊó∂‰ºöÂ∏¶‰∏ä checkpoint_tsÔºåTiKV Êî∂Âà∞ËØ∑Ê±ÇÂêéÊûÑÈÄ†‰∏Ä‰∏™ rocksdb snapshot ÔºåÂèñÂá∫ Range ( checkpoint_ts, uint64::MAX ] Â§ß‰∫é checkpoint_ts ÊâÄÊúâËÆ∞ÂΩï„ÄÇ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Â¢ûÈáèÊâ´ÂèñÁöÑÊòØ TiKV RocksDB ‰∏≠ÁöÑÊï∞ÊçÆÔºå Â¶Ç‰∏ã‰æãÊâÄÁ§∫Â¢ûÈáèÊâ´ (TS1,TS5] ‰æøÊòØÔºåÊâ´ LockCF + DefaultCF Âπ∂ÊûÑÈÄ†ÂØπÂ∫îÁöÑ perwirte ËÆ∞ÂΩïÔºåÊâ´ DefaultCF Âèä WriteCF Â∞ÜÂ§ß‰∫é @TS1 ÁöÑÊó†ÈîÅËÆ∞ÂΩïÔºåÂêåÊó∂ÊûÑÂª∫ÊåÅÁª≠Êé®ÊµÅÈò∂ÊÆµ„ÄÇ</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">@TS1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">begin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;                                                 </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">@TS2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">update</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Table_Jan </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">set</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'Jan Su'</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;                           </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">@TS3                          </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">begin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;                      </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">@TS4 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">commit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;                                                </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">@TS5                          </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">update</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Table_Jan </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">set</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'Jan Su'</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span></code></pre>
</div><h3 id="_4-2-ÊåÅÁª≠Êé®ÊµÅ" tabindex="-1">4.2 ÊåÅÁª≠Êé®ÊµÅ <a class="header-anchor" href="#_4-2-ÊåÅÁª≠Êé®ÊµÅ" aria-label="Permalink to &quot;4.2 ÊåÅÁª≠Êé®ÊµÅ&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Â¢ûÈáèÊâ´ÂêéÔºåTiCDC ÈÄöËøá <strong>&quot;TiKV CDC Component --&gt; Capture --&gt; Downstream&quot;</strong> ÊåÅÁª≠Êé®ÊµÅÈò∂ÊÆµÔºåÂÆûÊó∂Áª¥Êä§ CheckpointTs„ÄÅResolvedTs„ÄÇÂú® TiKV CDC Component ÂÜÖÈÉ®‰ºöÁª¥Êä§‰∏Ä‰∏™ Region Map ÔºåÂÆûÊó∂ÁõëÂê¨ RaftStore ÁöÑÊó•ÂøóÂèòÊõ¥ÂÆûÁé∞Âêë Capture ÁöÑÊé®ÊµÅ„ÄÇÂú® Capture ÂÜÖÈÉ®‰ºöÂú®ÊéíÂ∫èÊî∂Âà∞ÁöÑÂàÜÊï£ÁöÑ TiKV Change Log ÔºåÂπ∂ËøòÂéü‰∫ãÂä°Âπ∂Âêë‰∏ãÊ∏∏ÂàÜÂèëÊ∂àË¥πÊï∞ÊçÆ„ÄÇ</p>
<h3 id="_4-3-ÁõëÂê¨Êó•Âøó" tabindex="-1">4.3 ÁõëÂê¨Êó•Âøó <a class="header-anchor" href="#_4-3-ÁõëÂê¨Êó•Âøó" aria-label="Permalink to &quot;4.3 ÁõëÂê¨Êó•Âøó&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Â¢ûÈáèÊâ´Âêé,TiKV CDC Component ‰ºöÂú® Coprocessor ‰∏≠Ê≥®ÂÜå‰∏Ä‰∏™ Observer ÁõëÂê¨ RaftStore ‰∫ßÁîüÁöÑ TiKV Change LogÔºåÊåÅÁª≠Êèê‰æõÂ¢ûÊâ´ÂêéÊåÅÁª≠Êé®ÊµÅÈúÄË¶ÅÁöÑÊï∞ÊçÆ„ÄÇ</p>
<h2 id="‰∫î„ÄÅÁä∂ÊÄÅÁª¥Êä§" tabindex="-1">‰∫î„ÄÅÁä∂ÊÄÅÁª¥Êä§ <a class="header-anchor" href="#‰∫î„ÄÅÁä∂ÊÄÅÁª¥Êä§" aria-label="Permalink to &quot;‰∫î„ÄÅÁä∂ÊÄÅÁª¥Êä§&quot;"></a></h2>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÂØπ‰∫é DML ÂèòÊõ¥ÔºåÊâÄÊúâ Processor ÂêåÊ≠•Ëá≥ Global ResolvedTs ÔºåÂÜôÂà∞‰∏ãÊ∏∏ÂêéÊõ¥Êñ∞ CheckpointTs„ÄÇÂØπ‰∫é DDL ÂèòÊõ¥ÔºåÊâÄÊúâ processor CheckpointTs ÂêåÊ≠•Ëá≥Á≠â‰∫é DDL commitTs ÂÜçÂêë‰∏ãÊ∏∏ÊâßË°å DDL„ÄÇGlobal ResolvedTs„ÄÅProcessor ResolvedTs ËÆ°ÁÆóÊñπÂºèÂ¶Ç‰∏ãÔºåÂπ∂‰∏îÁª¥Êä§‰∏ãÈù¢‰∏ÄÂº†ÂõæË°®Ôºö<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1. Global ResolvedTs Áî± owner ËÆ°ÁÆóÔºåÂèñÂÄº‰∏∫ÊâÄÊúâ Processor ÁöÑ ResolvedTs Âíå DDL puller ÁöÑ ResolvedTs ÁöÑÊúÄÂ∞èÂÄº;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2. Processor ResolvedTs Áî± Processor ËÆ°ÁÆóÔºåÂèñÂÄº‰∏∫ÊâÄÊúâ Tablepipline ÁöÑ ResolvedTs ÊúÄÂ∞èÂÄºÔºõ</p>
<figure><img src="./../../../../../images/tidb/05TiDB-EcosystematicTools/5-1TiCDC/10TiCDC_ResolvedTs_CheckpointTs.png" alt="10TiCDC_ResolvedTs_CheckpointTs" tabindex="0"><figcaption>10TiCDC_ResolvedTs_CheckpointTs</figcaption></figure>
<h2 id="ÂÖ≠„ÄÅÁä∂ÊÄÅÂÆπÈîô" tabindex="-1">ÂÖ≠„ÄÅÁä∂ÊÄÅÂÆπÈîô <a class="header-anchor" href="#ÂÖ≠„ÄÅÁä∂ÊÄÅÂÆπÈîô" aria-label="Permalink to &quot;ÂÖ≠„ÄÅÁä∂ÊÄÅÂÆπÈîô&quot;"></a></h2>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÊâÄË∞ìÁä∂ÊÄÅÂÆπÈîôÔºåÂç≥ÔºöÊï∞ÊçÆÊäïÈÄíÁ´ØÂèëÁîüÊïÖÈöúÊó∂ÔºåTiCDC Â¶Ç‰ΩïÊèê‰æõ ‚ÄúAt Least Once‚Äù ÁöÑÂÆπÈîô‰øùËØÅ„ÄÇ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>‰∏ãÈù¢‰∏æ 2 ‰∏™ÂèØËÉΩÂèëÁîüÁä∂ÊÄÅÂÆπÈîôÁöÑÂú∫ÊôØ</strong>ÔºåÂÖ∂ÂÆû Table ÁöÑ CheckpointTs„ÄÅResolvedTs ÂèØ‰ª•Á±ª‰ººÁöÑÁêÜËß£‰∏∫ ‚ÄúExactly Once‚Äù ‰∏≠ÁöÑ Snapshot Êú∫Âà∂Ôºå‰ΩÜÊòØÊèê‰æõÁöÑÊòØ ‚ÄúAt Least Once‚Äù ËØ≠‰πâ‰øùËØÅ„ÄÇ</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1. <strong>‰ª• tikv cdc component ‰∏∫Êï∞ÊçÆÊäïÈÄíÁ´Ø‰∏∫‰æãÔºö</strong> ÈÇ£‰πàÊé•Êî∂Á´Ø‰æøÊòØ TiCDC CaptureÔºåÂÅáËÆæ Tablepipline Ë¥üË¥£ÁöÑ table ÁöÑ change log Êï∞ÊçÆÔºàN+2ÔºâÂ∑≤ÁªèÂ≠òÂú®‰∫é Puller ‰∏≠Ôºå‰ΩÜÊ≠§Êó∂Áî±‰∫é Region Leader ÂèòÊõ¥ÂØºËá¥ GRPC Âíå TiKV ‰πãÈó¥Âª∫Á´ãÁöÑ DownStream ËøûÊé•ÈúÄË¶ÅÈáçÊñ∞Âª∫Á´ãÔºåÈÇ£‰πà‰ºöÂü∫‰∫é Table ResolvedTs ÔºàN+1ÔºâÈáçÊñ∞ÊãâÊï∞ÊçÆÔºå‰ΩÜÊòØËØ•Êï∞ÊçÆÂ∑≤ÁªèÂ≠òÂú® Puller ‰∏≠ÈÄ†Êàê‰∫ÜÊï∞ÊçÆÂÜó‰Ωô„ÄÇ‚ÄúAt Least Once‚Äù ËØ≠‰πâ‰øùËØÅÂêéÊãâÂèñÁöÑÊï∞ÊçÆ‰πü‰ºöËøòÂéüÊàêÂÜó‰ΩôÁöÑÊï∞ÊçÆÂèòÊõ¥ÔºåÂç≥ÂêåÊ≠•Âà∞‰∏ãÊ∏∏Êó∂ÂêéÈù¢ÁöÑÊï∞ÊçÆ‰ºöË¶ÜÁõñÂâçÈù¢ÁöÑÊï∞ÊçÆÔºåÊìç‰ΩúÂπÇÁ≠â„ÄÇ</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2. <strong>‰ª• TiCDC Capture ‰∏∫Êï∞ÊçÆÊäïÈÄíÁ´Ø‰∏∫‰æãÔºö</strong> ÈÇ£‰πàÊé•Êî∂Á´Ø‰æøÊòØ Downstream PlatformÔºåÂΩì Table ÊâÄÂú®ÁöÑ Capture ÊåÇÊéâÊó∂‰ºöË¢´ Owner Ê£ÄÊµãÂà∞Âπ∂Âú®ÂÖ∂‰ªñ Capture ‰∏äÂàõÂª∫Êñ∞ÁöÑ Processor„ÄÅTablepiplineÔºåÂπ∂Âü∫‰∫é PD ‰∏≠Â≠òÂÇ®ÁöÑ CheckpointTs ÈáçÊñ∞Âêë TiKV CDC Component ËØ∑Ê±ÇÊûÑÂª∫ GRPC Stream ËøûÊé•ÊãâÂèñ TiKV Change Log Êï∞ÊçÆÔºåÂÆûÁé∞ËäÇÁÇπÈ´òÂèØÁî®ÂÆπÈîôÂ§ÑÁêÜ„ÄÇ</p>
<figure><img src="./../../../../../images/tidb/05TiDB-EcosystematicTools/5-1TiCDC/11TiCDC_Dataflow_Model.jpeg" alt="11TiCDC_Dataflow_Model" tabindex="0"><figcaption>11TiCDC_Dataflow_Model</figcaption></figure>
<h2 id="‰∏É„ÄÅÂºïÁî®ÂèÇËÄÉ" tabindex="-1">‰∏É„ÄÅÂºïÁî®ÂèÇËÄÉ <a class="header-anchor" href="#‰∏É„ÄÅÂºïÁî®ÂèÇËÄÉ" aria-label="Permalink to &quot;‰∏É„ÄÅÂºïÁî®ÂèÇËÄÉ&quot;"></a></h2>
<p><a href="https://www.bilibili.com/video/BV1qb411H7mY?spm_id_from=333.337.search-card.all.click" target="_blank" rel="noreferrer">1. Apache Flink Ê¶ÇÂøµ‰ªãÁªçÔºöÊúâÁä∂ÊÄÅÊµÅÂºèÂ§ÑÁêÜÂºïÊìéÁöÑÂü∫Áü≥</a><br>
<a href="https://zhuanlan.zhihu.com/p/96045864" target="_blank" rel="noreferrer">2. Flink Exactly Once Áä∂ÊÄÅÂÆπÈîôËÆ∫ÊñáËß£Êûê Lamport ÁöÑ ‚ÄúDistributed Snapshots‚Äù</a><br>
<a href="https://lamport.azurewebsites.net/pubs/chandy.pdf" target="_blank" rel="noreferrer">3. Flink Exactly Once Áä∂ÊÄÅÂÆπÈîôÂéüÊñá Distributed Snapshots: Determining Global States of Distributed Systems</a><br>
<a href="https://flink.apache.org/flink-architecture.html" target="_blank" rel="noreferrer">4. Flink ÂÆòÁΩëËÆ°ÁÆóÂºïÊìéËØ¥Êòé</a><br>
<a href="https://tidb.net/blog/70588c4c" target="_blank" rel="noreferrer">5. TiCDCÁ≥ªÂàóÂàÜ‰∫´-01-ÁÆÄËø∞‰ΩøÁî®ËÉåÊôØ</a><br>
<a href="https://juejin.cn/post/6844903857558913038#heading-5" target="_blank" rel="noreferrer">6. Exactly Once ‰πã ‚ÄúÂàÜÂ∏ÉÂºèÂø´ÁÖß‚Äù ‰∏é ‚ÄúÈáçÂ§çÊï∞ÊçÆÂà†Èô§‚Äù ÂÆûÁé∞ÊñπÂºèÁöÑÊØîËæÉ</a><br>
<a href="https://github.com/pingcap/tiflow/blob/master/docs/design/2022-03-16-ticdc-db-sorter.md" target="_blank" rel="noreferrer">7. TiCDC ËÆæËÆ°ÊñáÊ°£‰πã ticdc-db-sorter</a><br>
<a href="https://github.com/pingcap/tiflow/blob/master/docs/design/2020-03-04-ticdc-design-and-architecture-cn.md#tikv-%E5%85%B7%E4%BD%93%E8%A1%8C%E4%B8%BA" target="_blank" rel="noreferrer">8. TiCDC ËÆæËÆ°ÊñáÊ°£‰πã ‚ÄúÂ¢ûÈáèÊâ´ + Êé®ÊµÅ‚Äù ‰ªãÁªç</a></p>
]]></content:encoded>
            <enclosure url="https://askaric.com/images/tidb/05TiDB-EcosystematicTools/5-1TiCDC/07TiCDC_DataFlow_Model.png" length="0" type="image/png"/>
        </item>
        <item>
            <title><![CDATA[‰∏Ä„ÄÅËÆ∫ÊñáÊëòË¶Å]]></title>
            <link>https://askaric.com/zh/work/tidb/TiDB-Principle/Paper Reading/03Spanner ÂàÜÂ∏ÉÂºè‰∫ãÂä°.html</link>
            <guid>https://askaric.com/zh/work/tidb/TiDB-Principle/Paper Reading/03Spanner ÂàÜÂ∏ÉÂºè‰∫ãÂä°.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[Author : Jan   
Time : 2021-10-19   
Type : DB Theory


 ‰∏Ä„ÄÅËÆ∫ÊñáÊëòË¶Å

&nbsp;&nbsp;&nbsp;&nbsp;&nbs]]></description>
            <content:encoded><![CDATA[<p>Author : Jan<br>
Time : 2021-10-19<br>
Type : DB Theory</p>
<h2 id="‰∏Ä„ÄÅËÆ∫ÊñáÊëòË¶Å" tabindex="-1">‰∏Ä„ÄÅËÆ∫ÊñáÊëòË¶Å <a class="header-anchor" href="#‰∏Ä„ÄÅËÆ∫ÊñáÊëòË¶Å" aria-label="Permalink to &quot;‰∏Ä„ÄÅËÆ∫ÊñáÊëòË¶Å&quot;"></a></h2>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Spanner ÊòØ Google ÂèØÊâ©Â±ïÁöÑ„ÄÅÂ§öÁâàÊú¨ÁöÑ„ÄÅ<strong>ÂÖ®ÁêÉÂàÜÂ∏ÉÂºèÁöÑ</strong>„ÄÅÂêåÊ≠•Â§çÂà∂ÁöÑÊï∞ÊçÆÂ∫ì„ÄÇÊúÄÈáçË¶ÅÁöÑÊòØ Spanner Ê®°Êãü‰∫ÜÊó†ÈîÅÂè™ËØª‰∫ãÁâ©„ÄÅÂàÜÂ∏ÉÂºèÂéüÂ≠êÊìç‰Ωú„ÄÇF1 ÊòØ Spanner ÁöÑÁ¨¨‰∏Ä‰∏™‰ΩøÁî®ËÄÖ„ÄÅ‰∏Ä‰∏™ Google ÂπøÂëäÁ≥ªÁªüÂêéÂè∞ÔºåÊï∞ÊçÆË∑® 3 Âà∞ 5 ‰∏™Êï∞ÊçÆ‰∏≠ÂøÉÔºåÂπ≥Êó∂ÈÄâÊã©‰ΩéÂª∂Êó∂ÁöÑÊï∞ÊçÆ‰∏≠ÂøÉ‰∫§‰∫íÔºå1 Âà∞ 2 ‰∏™Êï∞ÊçÆ‰∏≠ÂøÉÂêåÊó∂ÂèëÁîüÁÅæÈöæÊó∂ÂèØÊï∞ÊçÆËá™Âä®Âπ∏Â≠ò„ÄÇ<strong>Êú¨‰∫∫ÂÜôËøôÁØáÊñáÁ´†ÁöÑÁî®ÊÑèÊòØÂÆûÁé∞‰ªé‰∏Ä‰∏™ËæÉ‰∏∫ÂÆèËßÇÁöÑËßíÂ∫¶‰ªãÁªç Spanner Â¶Ç‰ΩïÂÆûÁé∞ ÂèØ‰º∏Áº©ÊÄßÔºåËá™Âä®ÂàÜÁâáÔºåÂÆπÈîôÔºå‰∏ÄËá¥Â§çÂà∂Á≠âÁâπÊÄß„ÄÇ</strong></p>
<h2 id="‰∫å„ÄÅËÆ∫ÊñáÁÆÄ‰ªã" tabindex="-1">‰∫å„ÄÅËÆ∫ÊñáÁÆÄ‰ªã <a class="header-anchor" href="#‰∫å„ÄÅËÆ∫ÊñáÁÆÄ‰ªã" aria-label="Permalink to &quot;‰∫å„ÄÅËÆ∫ÊñáÁÆÄ‰ªã&quot;"></a></h2>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Spanner ÊòØ‰∏Ä‰∏™ÂèØÊâ©Â±ïÁöÑ„ÄÅÂÖ®ÁêÉÂàÜÂ∏ÉÂºèÊï∞ÊçÆÂ∫ìÔºå‰∏ªË¶ÅÂÖ≥Ê≥®ÁÇπÊòØÁÆ°ÁêÜË∑®Êï∞ÊçÆ‰∏≠ÂøÉÁöÑÂ§çÂà∂Êï∞ÊçÆÔºåÁî® Paxos Áä∂ÊÄÅÊú∫ÂàÜÁâáÊï∞ÊçÆÔºåÂÆ¢Êà∑Á´ØÈìæÊé•Ëá™Âä®Âú® Replica Èó¥Â§±Ë¥•ÂùáË°°„ÄÇÂΩìÊï∞ÊçÆÈáè„ÄÅÊúçÂä°Âô®Êï∞ÊçÆÈáèÂèëÁîüÂèòÂåñÊó∂ÔºåËá™Âä®Â§∏Êú∫Âô®ÈáçÊñ∞ÂàÜÈÖçÊï∞ÊçÆ<strong>Âπ≥Ë°°Ë¥üËΩΩÂπ∂ÂìçÂ∫îÊïÖÈöú</strong>Ôºõ</p>
<ol>
<li>Èù¢ÂØπÂ∫îÁî®ÈùûÂÖ≥Á≥ªÊ®°ÂºèÁöÑÁöÑË¥üË¥£„ÄÅÂ§ñÂ±ÇÁ≥ªÁªüÊï∞ÊçÆÂêåÊ≠•Á≠âÂº∫‰∏ÄËá¥ÈóÆÈ¢òÔºåSpanner ÊºîÂèòÊàêÁ±ª BigTable ÁöÑÈîÆÂÄºÂ≠òÂÇ®ÁöÑÂ§öÁâàÊú¨Êï∞ÊçÆÂ∫ìÔºåÁî®ÂçäÂÖ≥Á≥ªÂûãË°®Â≠òÂÇ®‰∏¥Êó∂Êï∞ÊçÆÔºåÂ§öÁâàÊú¨Êï∞ÊçÆÊê∫Â∏¶Êó∂Èó¥Êà≥ÔºåÈÖçÂêàÂûÉÂúæÂõûÊî∂Êú∫Âà∂ÂõûÊî∂ÊóßÁâàÊú¨Êï∞ÊçÆÔºõ</li>
<li>Spanner Êèê‰æõÈÄöÁî®‰∫ãÂä°Ê®°ÂºèÔºåÂπ∂ÊîØÊåÅ SQL ÊèèËø∞ÂºèËØ≠Ë®ÄÂ§ÑÁêÜÔºõ</li>
</ol>
<p><strong>Spanner ÈáçË¶ÅÁâπÊÄßÔºö</strong></p>
<ol>
<li>Êï∞ÊçÆÁöÑÂ§çÂà∂ÈÖçÁΩÆÂèØ‰ª•Áî±Â∫îÁî®Á®ãÂ∫èÂä®ÊÄÅÊéßÂà∂ÔºåÂπ∂Âä®ÊÄÅ„ÄÅÈÄèÊòéÂú∞Âú®Êï∞ÊçÆ‰∏≠ÂøÉ‰πãÈó¥ÁßªÂä®Êï∞ÊçÆÔºå‰ª•Âπ≥Ë°°Êï∞ÊçÆ‰∏≠ÂøÉ‰πãÈó¥ÁöÑËµÑÊ∫êÔºõ<br>
1.1 ÈÄâÂèñËØªÊï∞ÊçÆÁõÆÁöÑÂú∞Ë∑ùÁ¶ª<strong>ÊéßÂà∂</strong>ËØªÂÜôÂª∂Êó∂Ôºõ<br>
1.2 ÈÄâÂèñÂêÑÁä∂ÊÄÅÊú∫Èó¥Ë∑ùÁ¶ª<strong>ÊéßÂà∂</strong>ÂÜôÊï∞ÊçÆÊó∂Âú®ÂàÜÁâáÊï∞ÊçÆÈó¥ÁöÑÂª∂Êó∂Ôºõ<br>
1.3 ÈÄâÂèñÂá†ÂâØÊú¨Êéß<strong>Âà∂ËØª</strong>ËØªÊÄßËÉΩ„ÄÅÊåÅ‰πÖÊÄß„ÄÅÂèØÁî®ÊÄßÔºõ</li>
<li>Â§ñÈÉ®ËØªÂÜô‰∏ÄËá¥ÊÄßÔºåÂü∫‰∫éÊó∂Èó¥Êà≥ÁöÑÂÖ®Â±ÄËØª‰∏ÄËá¥ÔºåÊ≠§ÁâπÊÄß‰Ωø‰∏ÄËá¥ÊÄßÂ§á‰ªΩ„ÄÅÂéüÂ≠êÊ®°Âºè‰øÆÊîπ„ÄÅMapReduce ÊâßË°åÊàê‰∏∫ÂèØËÉΩÔºõ<br>
2.1 Spanner ÊòØÁ¨¨‰∏Ä‰∏™ÂÆûÁé∞ÂÖ®ÁêÉËåÉÂõ¥Âü∫‰∫éÊó∂Èó¥Êà≥ MVCC Êú∫Âà∂ÁöÑ‰∫ãÂä°ÊéßÂà∂Á≥ªÁªüÔºõ<br>
2.2 Spanner ÈÄöËøá GPS ÂíåÂéüÂ≠êÊó∂ÈíüËÆæËÆ°ÂíåÂÆûÁé∞‰∫Ü TrueTime API ÔºåÁõ¥Êé•Êö¥Èú≤‰∏çÁ°ÆÂÆöÁöÑÊó∂ÈíüÔºåÂ¶ÇÊûúÊó∂ÈíüÂÅèÂ∑ÆËøáÂ§ßÔºåSpanner ‰ºöÈôçÈÄüÁ≠âÂæÖÁõ¥Ëá≥ËØØÂ∑ÆÂ∞è‰∫é 10msÔºõ</li>
</ol>
<h2 id="‰∏â„ÄÅÂü∫Êú¨ÊÄùÊÉ≥" tabindex="-1">‰∏â„ÄÅÂü∫Êú¨ÊÄùÊÉ≥ <a class="header-anchor" href="#‰∏â„ÄÅÂü∫Êú¨ÊÄùÊÉ≥" aria-label="Permalink to &quot;‰∏â„ÄÅÂü∫Êú¨ÊÄùÊÉ≥&quot;"></a></h2>
<h3 id="_3-1-spanner-ËÆæËÆ°ÂíåÂÆûÁé∞" tabindex="-1">3.1 Spanner ËÆæËÆ°ÂíåÂÆûÁé∞ <a class="header-anchor" href="#_3-1-spanner-ËÆæËÆ°ÂíåÂÆûÁé∞" aria-label="Permalink to &quot;3.1 Spanner ËÆæËÆ°ÂíåÂÆûÁé∞&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Spanner ÊäΩË±°‰∫ÜÊï∞ÊçÆË∑ØÂæÑÁî®‰∫éÁÆ°ÁêÜÂâØÊú¨Âíå‰ΩçÁΩÆÔºåÁß∞‰∏∫ ‚Äúdirectory‚ÄùÔºåÊòØÊúÄÂ∞èÊï∞ÊçÆÁßªÂä®ÂçïÂÖÉ„ÄÇ</p>
<p><strong>Â¶Ç‰∏ãÂü∫Êú¨Ê¶ÇÂøµÔºö</strong></p>
<ol>
<li>‰∏Ä‰∏™ Spanner ÈõÜÁæ§ÈÉ®ÁΩ≤Ë¢´Áß∞‰∏∫ ‚Äúuniverse‚ÄùÔºõ</li>
<li>‰∏Ä‰∏™ ‚Äúuniverse‚Äù ‰∏ãÊúâÂ§ö‰∏™ ‚ÄúZone‚ÄùÔºåÊØè‰∏™ ‚ÄúZone‚Äù ÊòØ‰∏Ä‰∏™ÁÆÄÂçïÁöÑ BigTable ÈõÜÁæ§Ôºå‚ÄúZone‚Äù ÊòØÂèØÁÆ°ÁêÜÁöÑÈÉ®ÁΩ≤ÂçïÂÖÉÔºõ‚ÄúZone‚Äù ‰πüÊòØÊï∞ÊçÆÂâØÊú¨ËÉΩÂ§çÂà∂ÁöÑ‰ΩçÁΩÆÈõÜÂêà„ÄÅÁâ©ÁêÜÈöîÁ¶ªÁöÑÈõÜÂêàÔºåÂèØ‰ª•Ë¢´Âä®ÊÄÅÁöÑÈöèÂä†ËΩΩ„ÄÅÂç∏ËΩΩ‰ªéËøêË°åÁöÑÁ≥ªÁªü‰∏≠Ôºå‰∏Ä‰∏™Êï∞ÊçÆ‰∏≠ÂøÉÂèØ‰ª•ÊúâÂ§ö‰∏™ ‚ÄúZone‚ÄùÔºõ</li>
<li>‰∏Ä‰∏™ ‚ÄúZone‚Äù ÁöÑ ‚ÄúZone Master‚Äù ÊåáÂÆöÂâØÊú¨Êï∞ÊçÆÂ§çÂà∂Âà∞ÁöÑ‰∏äÂçÉ‰∏™ ‚Äúspanservers‚ÄùÔºå‰ºöÊúâ ‚Äúper-zone location proxies‚Äù ÂàÜÈÖç ‚ÄúClient‚Äù ÊâÄËÉΩËé∑ÂèñÂà∞Êï∞ÊçÆÁöÑ ‚Äúspanservers‚ÄùÔºõ</li>
<li>‚Äúuniverse master‚Äù Âíå ‚Äúplacement driver‚Äù ÂäüËÉΩËøë‰ººÔºåÂâçËÄÖ‰∏ªË¶ÅÁî®‰∫éÊâìÂç∞ÊâÄÊúâ ‚ÄúZone‚Äù ‰ø°ÊÅØÔºåÂêéËÄÖ‰ª•ÂàÜÈíü‰∏∫Âçï‰ΩçÂ§ÑÁêÜ‰∏çÂêåÁä∂ÊÄÅÊú∫Èó¥„ÄÅ‚ÄúZone‚Äù Èó¥ÁöÑÊï∞ÊçÆÁßªÂä®Ôºõ</li>
</ol>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="./Theory-SpannerÂàÜÂ∏ÉÂºè‰∫ãÂä°/SpannerCluster.jpg" alt="SpannerCluster"></p>
<p><strong>‰∏ãÂõæÊòØÂü∫‰∫é Tablet ÂÆûÁé∞ÁöÑ SpannerÔºå‰ªé‰∏ãÂêë‰∏äÁúãÔºö</strong></p>
<ol>
<li>ÊØè‰∏™ Tablet Â≠òÂÇ® B-Tree Êï∞ÊçÆ„ÄÅColossus Â≠òÂÇ® WAL Êó•ÂøóÔºõ</li>
<li>Tablet ‰πã‰∏äÂÆûÁé∞ Paxos Áä∂ÊÄÅÊú∫ÔºåÊØè‰∏™Áä∂ÊÄÅÊú∫Â≠òÊîæËá™Â∑±ÁöÑÂÖÉÊï∞ÊçÆ„ÄÅÊó•ÂøóÊûÅÂÖ∂Áõ∏ÂÖ≥ tabletÔºõ</li>
<li>ÂΩìÂâç Spanner ÊØèÊ¨° Paxos ‰∫§‰∫íÂÜô‰∏§Ê¨°Êó•ÂøóÔºå‰∏ÄÊ¨°ÂÜô tablet Êó•ÂøóÔºå‰∏ÄÊ¨°ÂÜô paxos Êó•ÂøóÔºåSpanner ÈÄöËøáÁÆ°ÈÅìÂ¢ûÂ§ßÂêûÂêêËøõËÄåÂº•Ë°•ËøôÈ°πËÆæËÆ°ÂºïÂèëÁöÑÂª∂Êó∂ÈóÆÈ¢òÔºõ</li>
</ol>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="./Theory-SpannerÂàÜÂ∏ÉÂºè‰∫ãÂä°/BigTableBaisedSpanner.jpg" alt="BigTableBaisedSpanner"></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Paxos Áî®‰∫éÂÆûÁé∞‰∏ÄËá¥ÊÄßÂ§çÂà∂Ôºåreplica Êï∞ÊçÆÂ≠òÂÇ®Âú®Áõ∏ÂÖ≥ÁöÑ tablet ‰∏≠ÔºåÂÜôÂøÖÈ°ªÈÄöËøá Paxos Group LeaderÔºåËØªÂèØ‰ª•ÈÄöËøáÂ∑≤ÁªèÂèäÊó∂Êõ¥Êñ∞ÁöÑ replicate È´òÊïàËé∑Âèñ„ÄÇÊØè‰∏™ Spanner Server ÂÆûÁé∞‰∏Ä‰∏™ Lock Table ÈÄöËøá 2PC ÊñπÂºèÂÆûÁé∞Âπ∂ÂèëÊéßÂà∂„ÄÇ</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="./Theory-SpannerÂàÜÂ∏ÉÂºè‰∫ãÂä°/PaxosGroup.jpg" alt="PaxosGroup"></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Spanner ÂÆûÁé∞‰∫ÜÈïø‰∫ãÂä°ÔºåÁî®‰∫éËß£ÂÜ≥Âõ†ÂÜôÂÜ≤Á™ÅÂØºËá¥ÁöÑ‰πêËßÇÂπ∂ÂèëÊéßÂà∂ÊÄßËÉΩÂ∑Æ„ÄÅÂª∂ËøüÂ§ßÁöÑÈóÆÈ¢ò„ÄÇÂ¶Ç‰∏ãÂõæÔºåÂú®ÊØè‰∏™ Paxos Group ÊàêÂëòÂú®<strong>Áä∂ÊÄÅÊú∫ÂÜÖÈÉ®</strong>ÂùáÂÆûÁé∞‰∏Ä‰∏™‰∫ãÂä°ÁÆ°ÁêÜÂô®ÔºåTxn Group ‰∏≠‰ºöÈÄâÂá∫ LeaderÔºåÂÖ∂‰ªñÁß∞ SlaveÔºåLeader ‰ΩøÁî®‰∫ãÂä°ÁÆ°ÁêÜÂô®Â§ÑÁêÜÂÜ≤Á™ÅÔºõÁªÜËäÇÂ¶Ç‰∏ãÔºö<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>Ê≥®ÊÑèÔºö Txn Group Âíå Paxos Group ÁöÑÂÖ≥Á≥ªÊòØÔºåÂ§ö‰∏™ Paxos Group ÂØπ‰∏Ä‰∏™ Txn GroupÔºõ</strong></p>
<ol>
<li>Â¶ÇÊûú‰∏Ä‰∏™‰∫ãÂä°‰ªÖÂåÖÂê´‰∏Ä‰∏™ Paxos Group ÂèØÁõ¥Êé•ÁªïËøá‰∫ãÂä°ÁÆ°ÁêÜÂô®ÔºåÂõ†‰∏∫ Lock Table Âíå Paxos Êú¨Ë∫´Â∞±ÂèØ‰ª•ÂÆûÁé∞‰∫ãÂä°ÁÆ°ÁêÜÔºõ</li>
<li>Â¶ÇÊûú‰∏Ä‰∏™‰∫ãÁâ©ÂåÖÂê´Â§ö‰∏™ Paxos Group ÔºåTxn ‰∏≠‰ºöÂÖàÈÄâÂá∫Êú¨ Txn Leader ÔºåÂÖ∂‰ªñÁöÑ Paxos Group Leader Êàê‰∏∫ÂÄôÈÄâËÄÖÊåáÂêëÊú¨ TxnÔºõ</li>
</ol>
<h3 id="_3-2-spanner-dircetory-ÊäΩË±°" tabindex="-1">3.2 Spanner &quot;Dircetory&quot; ÊäΩË±° <a class="header-anchor" href="#_3-2-spanner-dircetory-ÊäΩË±°" aria-label="Permalink to &quot;3.2 Spanner &quot;Dircetory&quot; ÊäΩË±°&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Âú®ÈîÆÂÄºÂØπ‰πã‰∏ä Spanner ÂÆûÁé∞‰∫Ü &quot;Dircetory&quot; Ê°∂ÊäΩË±°ÔºåÊØè‰∏Ä‰∏™ &quot;Dircetory&quot; Â≠òÊîæÂÖ¨ÂÖ±ÂâçÁºÄÁöÑÊï∞ÊçÆÂèØ‰ª•Êõ¥Â•ΩÁöÑÊéßÂà∂Â±ÄÈÉ®Êï∞ÊçÆÔºåÂ¶ÇÔºöÊõ¥Âà©‰∫éËåÉÂõ¥Êâ´ÊèèÊï∞ÊçÆÔºåËøôÊòØÂü∫‰∫é hash ËßÑÂàôÂàÜÂå∫Êó†Ê≥ïÂÆûÁé∞ÁöÑ‰ºòÂäø„ÄÇSpanner ÂèØ‰ª•ÈÄöËøáÁßªÂä® &quot;Dircetory&quot; Êù•Èôç‰ΩéÊüê‰∏™ Paxos Group ÁöÑË¥üËΩΩÔºåÂ¶ÇÔºöÂ∞ÜÁªèÂ∏∏ËÆøÈóÆÁöÑÂ§ö‰∏™ &quot;Dircetory&quot; ÂêàÂπ∂‰∏∫‰∏Ä‰∏™ &quot;Dircetory&quot;„ÄÇ‰∏Ä‰∏™ 50MB ÁöÑ &quot;Dircetory&quot; ÂèØ‰ª•Âú®Âá†ÁßíÈíüÂÜÖÁßªÂä®„ÄÇ</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÁßªÂä® &quot;Dircetory&quot; ÊòØÁî®‰∫éÁßªÂä® Paxos Group ÁöÑÂêéÂè∞‰ªªÂä°ÔºåÈÄöËøáÊ∑ªÂä†„ÄÅÂà†Èô§ÂâØÊú¨ÊñπÂºèÂú®ÁªÑ‰πãÈó¥ÁßªÂä®ÁâáÊÆµ„ÄÇmovedir ‰ªéÊ≥®ÂÜåÂºÄÂßãÔºåÂêéÂè∞ÂêØÂä®Êï∞ÊçÆÁßªÂä®ÔºåÂΩìÂÆÉÁßªÂä®ÂÆåÊï∞ÊçÆÂêéÔºå‰ΩøÁî®‰∫ãÂä°Êù•ÂéüÂ≠êÊõ¥Êñ∞‰∏§‰∏™ Paxos Group ÂÖÉÊï∞ÊçÆ„ÄÇÈô§ÁßªÂä®Êï∞ÊçÆÂ§ñËøòÂèØÂàÜÂâ≤Êï∞ÊçÆÔºåÂ¶Ç &quot;Dircetory&quot; ÂèòÂæóÂ§™Â§ßÔºåSpanner‰ºöÂ∞ÜÂÖ∂ÂàÜÂâ≤ÊàêÂ§ö‰∏™ÁâáÊÆµ„ÄÇ</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÁÆ°ÁêÜÂëòÂèØÊéßÂà∂ÂâØÊú¨ÁöÑÊï∞Èáè„ÄÅÁ±ªÂûã„ÄÅÂú∞ÁêÜ‰ΩçÁΩÆÁöÑ‰∏çÂêåÁªÑÂêàÂÆûÁé∞ÈöîÁ¶ª‰∏éÂ§çÂà∂„ÄÇ‰æãÂ¶ÇÔºåÂ∫îÁî®Á®ãÂ∫èÂèØËÉΩÂ∞ÜÊâÄÈúÄË¶ÅÁöÑÊï∞ÊçÆÂ≠òÂÇ®Âú®‰∏Ä‰∏™ &quot;Dircetory&quot; ‰∏≠ÔºåÂä†‰πãÂú∞ÁêÜ‰ΩçÁΩÆÂÆûÁé∞ ‚ÄúÁî®Êà∑A‚Äù ÁöÑÊï∞ÊçÆÂú®Ê¨ßÊ¥≤Êúâ‰∏â‰∏™ÂâØÊú¨Ôºå‚ÄúÁî®Êà∑B‚Äù ÁöÑÊï∞ÊçÆÂú®ÂåóÁæéÊúâ‰∫î‰∏™ÂâØÊú¨„ÄÇ</p>
<h3 id="_3-4-truetime-api-ËÆæËÆ°ÂíåÂÆûÁé∞" tabindex="-1">3.4 TrueTime API ËÆæËÆ°ÂíåÂÆûÁé∞ <a class="header-anchor" href="#_3-4-truetime-api-ËÆæËÆ°ÂíåÂÆûÁé∞" aria-label="Permalink to &quot;3.4 TrueTime API ËÆæËÆ°ÂíåÂÆûÁé∞&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TrueTime Áî±ÊØè‰∏™Êï∞ÊçÆ‰∏≠ÂøÉÁöÑ‰∏ÄÁªÑ ‚ÄúÊó∂Èó¥‰∏ªÊú∫Âô®‚Äù ÂíåÊØè‰∏™Êú∫Âô®ÁöÑ ‚ÄúÊó∂Èó¥ÂÆàÊä§Á®ãÂ∫è‚Äù ÂÆûÁé∞Ôºå‰ΩøÁî®‰∏§ÁßçÂΩ¢ÂºèÁöÑÊó∂Èó¥ÂèÇËÄÉÔºåÁî®‰ª•ÊîæÁΩÆ‰∏çÂêåÁöÑÂ§±ÊïàÊ®°Âºè„ÄÇ</p>
<ol>
<li>GPS Â§±ÁÅµÁöÑÊñπÂºèÂèÇËÄÉÊ∫êÊºèÊ¥ûÂåÖÊã¨Â§©Á∫øÂíåÊé•Êî∂Âô®ÊïÖÈöú„ÄÅÊú¨Âú∞Êó†Á∫øÁîµÂπ≤Êâ∞ÂíåGPSÁ≥ªÁªü‰∏≠Êñ≠Á≠â„ÄÇ</li>
<li>ÂéüÂ≠êÈíüÂ§±ÁÅµÁöÑÊñπÂºèÂèÇËÄÉ GPS ‰ª•ÂèäÂéüÂ≠êÈíüÂΩºÊ≠§‰πãÈó¥‰∏çÁõ∏ÂÖ≥ÔºåÂèØËÉΩÁî±‰∫éÈ¢ëÁéáËØØÂ∑ÆÂá∫Áé∞ÊòéÊòæÊó∂Èó¥ÊºÇÁßª„ÄÇ</li>
</ol>
<h3 id="_3-3-spanner-Âπ∂ÂèëÊéßÂà∂" tabindex="-1">3.3 Spanner Âπ∂ÂèëÊéßÂà∂ <a class="header-anchor" href="#_3-3-spanner-Âπ∂ÂèëÊéßÂà∂" aria-label="Permalink to &quot;3.3 Spanner Âπ∂ÂèëÊéßÂà∂&quot;"></a></h3>
<h4 id="_3-3-1-ËØª‰∫ãÂä°" tabindex="-1">3.3.1 ËØª‰∫ãÂä° <a class="header-anchor" href="#_3-3-1-ËØª‰∫ãÂä°" aria-label="Permalink to &quot;3.3.1 ËØª‰∫ãÂä°&quot;"></a></h4>
<p>Spanner ÂàóÂá∫‰∫ÜÊîØÊåÅÁöÑÁ±ªÂûãÂíåÁº©Êú∫Âà∂Â¶Ç‰∏ãÔºö</p>
<table tabindex="0">
<thead>
<tr>
<th>Operation Type</th>
<th>Concurrency Control</th>
</tr>
</thead>
<tbody>
<tr>
<td>Read-Write Transcation</td>
<td>Pessimistic</td>
</tr>
<tr>
<td>Read-Only Transcation</td>
<td>lock-free</td>
</tr>
<tr>
<td>Snapshot Read,client-provided timestamp</td>
<td>lock-free</td>
</tr>
<tr>
<td>Snapshot Read,client-provided bound</td>
<td>lock-free</td>
</tr>
</tbody>
</table>
<ol>
<li>‚ÄúRead-Write Transcation‚Äù ÊòØ‰∏ÄÁßçÂÖ∑ÊúâÂø´ÁÖßÈöîÁ¶ªÁöÑÊÄßËÉΩÁöÑ‰∫ãÂä°,ÂøÖÈ°ªÈ¢ÑÂÖàÂ£∞Êòé‰∏∫Ê≤°Êúâ‰ªª‰ΩïÂÜôÊìç‰Ωú,Âπ∂Âú®Á≥ªÁªüÈÄâÊã©ÁöÑÊó∂Èó¥Êà≥‰∏äËØªÂèñÂè™ËØª‰∫ãÂä°ËÄå‰∏çÈîÅÂÆö„ÄÇÂè™ËØª‰∫ãÂä°‰∏≠ÁöÑËØªÊìç‰ΩúÂèØ‰ª•Âú®‰ªª‰ΩïË∂≥Â§üÊúÄÊñ∞ÁöÑ Replica ‰∏äËøõË°å„ÄÇ</li>
<li>‚ÄúSnapshot Read,client-provided timestamp‚Äù ÈÄöËøáÂÆ¢Êà∑Á´ØÂèØ‰ª•‰∏∫Âø´ÁÖßËØªÂèñÊåáÂÆöÊó∂Èó¥Êà≥ÔºåÂÆûÁé∞‰ªª‰ΩïË∂≥Â§üÊúÄÊñ∞ÁöÑ Replica ‰∏äÊâßË°åÊó†ÈîÅÂéÜÂè≤Êï∞ÊçÆËØªÂèñ„ÄÇÂØπ‰∫éÂè™ËØª‰∫ãÂä°ÂíåÂø´ÁÖßËØªÂèñÔºå‰∏ÄÊó¶Êó∂Èó¥Êà≥Ë¢´ÈÄâÂÆöÂ∞±ÂèØËßÜ‰∏∫Êèê‰∫§ÊàêÂäüÔºåÈô§ÈùûËØ•Êó∂Èó¥Êà≥ÁöÑÊï∞ÊçÆÂ∑≤ÁªèË¢´ÂûÉÂúæÊî∂ÈõÜ„ÄÇ</li>
<li>‚ÄúSnapshot Read,client-provided bound‚Äù Â∞±ÊòØ ‚ÄúSnapshot Read,client-provided timestamp‚Äù Âä†‰∏äÊèê‰æõÊâÄÈúÄÊó∂Èó¥Êà≥ËøáÊúüÁöÑ‰∏äÈôêÔºåÂπ∂ËÆ© Spanner ÈÄâÊã©Êó∂Èó¥Êà≥ÂÜÖÁöÑÊï∞ÊçÆÔºåËøõËÄåÈÅøÂÖçÂú®ÈáçËØïÂæ™ÁéØ‰∏≠ÁºìÂÜ≤ÁªìÊûú„ÄÇ</li>
</ol>
<h4 id="_3-3-1-ËØªÂÜô‰∫ãÂä°" tabindex="-1">3.3.1 ËØªÂÜô‰∫ãÂä° <a class="header-anchor" href="#_3-3-1-ËØªÂÜô‰∫ãÂä°" aria-label="Permalink to &quot;3.3.1 ËØªÂÜô‰∫ãÂä°&quot;"></a></h4>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TiDB ‰ΩúËÄÖ‰πã‰∏ÄÁöÑ <a href="https://pingcap.com/zh/blog/Spanner-cap-truetime-transaction" target="_blank" rel="noreferrer">TangLiu ÂØπËØ•ÈÉ®ÂàÜÁªôÂá∫‰∫ÜËß£ËØªÔºåÊú¨‰∫∫ËßâÂæóËæÉ‰∏∫Ê∏ÖÊô∞ÔºåÊïÖÂéüÊñáÂ∫îÁî®</a>Ôºõ<strong>ËôΩÁÑ∂ Spanner Âú®ÂÆûÁé∞ÂÜô‰∫ãÂä°‰∏äÂ§ÑÁêÜ‰æùÊçÆ‰ΩøÁî® Split Êï∞Èáè‰∏çÂêåÂàÜ‰∏∫ 1PC Âíå 2PCÔºå‰ΩÜÊú¨ÊñáÂè™Â±ïÁ§∫ 2PC ÁöÑ‰æãÂ≠êÔºåËØ¶ÊÉÖËØ∑ÈòÖËØªËøô‰Ωç‰ΩúËÄÖÊñáÁ´†</strong>„ÄÇ</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÂÅáËÆæ‰∏Ä‰∏™‰∫ãÂä°ÈúÄË¶ÅÂú® Split 1 ËØªÂèñÊï∞ÊçÆ Row 1ÔºåÂêåÊó∂Â∞ÜÊîπÂä® Row 2ÔºåRow 3 ÂàÜÂà´ÂÜôÂà∞ Split 2ÔºåSplit 3ÔºåÊµÅÁ®ãÂ¶Ç‰∏ãÔºö</p>
<ol>
<li>client ÂºÄÂßã‰∏Ä‰∏™ read-write ‰∫ãÂä°„ÄÇ</li>
<li>client ÈúÄË¶ÅËØªÂèñ Row 1ÔºåÂëäËØâ API Layer Áõ∏ÂÖ≥ËØ∑Ê±Ç„ÄÇ</li>
<li>API Layer ÂèëÁé∞ Row 1 Âú® Split 1„ÄÇ</li>
<li>API Layer Áªô Split 1 ÁöÑ Leader ÂèëÈÄÅ‰∏Ä‰∏™ read request„ÄÇ</li>
<li>Split1 ÁöÑ Leader Â∞ùËØïÂ∞Ü Row 1 Ëé∑Âèñ‰∏Ä‰∏™ read lock„ÄÇÂ¶ÇÊûúËøôË°åÊï∞ÊçÆ‰πãÂâçÊúâ write lockÔºåÂàô‰ºöÊåÅÁª≠Á≠âÂæÖ„ÄÇÂ¶ÇÊûú‰πãÂâçÂ∑≤ÁªèÊúâÂè¶‰∏Ä‰∏™‰∫ãÂä°‰∏ä‰∫Ü‰∏Ä‰∏™ read lockÔºåÂàô‰∏ç‰ºöÁ≠âÂæÖ„ÄÇËá≥‰∫é deadlockÔºåÈááÁî® wound-wait Â§ÑÁêÜÊñπÂºè„ÄÇ</li>
<li>Leader Ëé∑ÂèñÂà∞ Row 1 ÁöÑÊï∞ÊçÆÂπ∂‰∏îËøîÂõû„ÄÇ</li>
<li>Clients ÂºÄÂßãÂèëËµ∑‰∏Ä‰∏™ commit requestÔºåÂåÖÊã¨ Row 2ÔºåRow 3 ÁöÑÊîπÂä®„ÄÇÊâÄÊúâÁöÑË∑üËøô‰∏™‰∫ãÂä°ÂÖ≥ËÅîÁöÑ Split ÈÉΩÂèòÊàêÂèÇ‰∏éËÄÖ participants„ÄÇ</li>
<li>‰∏Ä‰∏™ participant Êàê‰∏∫ÂçèË∞ÉËÄÖ coordinatorÔºåË≠¨Â¶ÇËøô‰∏™ case ÈáåÈù¢ Row 2 Êàê‰∏∫ coordinator„ÄÇCoordinator ÁöÑ‰ΩúÁî®ÊòØÁ°Æ‰øù‰∫ãÂä°Âú®ÊâÄÊúâ participants ‰∏äÈù¢Ë¶Å‰∏çÊèê‰∫§ÊàêÂäüÔºåË¶Å‰∏çÂ§±Ë¥•„ÄÇËøô‰∫õÈÉΩÊòØÂú® participants Âíå coordinator ÂêÑËá™ÁöÑ Split Leader ‰∏äÈù¢ÂÆåÊàêÁöÑ„ÄÇ</li>
<li>Participants ÂºÄÂßãËé∑Âèñ lock<br>
9.1 Split 2 ÂØπ Row 2 Ëé∑Âèñ write lock„ÄÇ<br>
9.2 Split 3 ÂØπ Row 3 Ëé∑Âèñ write lock„ÄÇ<br>
9.3 Split 1 Á°ÆÂÆö‰ªçÁÑ∂ÊåÅÊúâ Row 1 ÁöÑ read lock„ÄÇ<br>
9.4 ÊØè‰∏™ participant ÁöÑ Split Leader Â∞Ü lock Â§çÂà∂Âà∞ÂÖ∂‰ªñ Split ÂâØÊú¨ÔºåËøôÊ†∑Â∞±ËÉΩ‰øùËØÅÂç≥‰ΩøËäÇÁÇπÊåÇ‰∫ÜÔºålock ‰πü‰ªçÁÑ∂ËÉΩË¢´ÊåÅÊúâ„ÄÇ</li>
<li>Â¶ÇÊûúÊâÄÊúâÁöÑ participants ÂëäËØâ coordinator lock Â∑≤ÁªèË¢´ÊåÅÊúâÔºåÈÇ£‰πàÂ∞±ÂèØ‰ª•Êèê‰∫§‰∫ãÂä°‰∫Ü„ÄÇcoordinator ‰ºö‰ΩøÁî®Ëøô‰∏™Êó∂ÂÄôÁöÑÊó∂Èó¥ÁÇπ‰Ωú‰∏∫ËøôÊ¨°‰∫ãÂä°ÁöÑÊèê‰∫§Êó∂Èó¥ÁÇπ„ÄÇ</li>
<li>Â¶ÇÊûúÊüê‰∏Ä‰∏™ participant ÂëäËØâ lock ‰∏çËÉΩË¢´Ëé∑ÂèñÔºå‰∫ãÂä°Â∞±Ë¢´ÂèñÊ∂à</li>
<li>Â¶ÇÊûúÊâÄÊúâ participants Âíå coordinator ÊàêÂäüÁöÑËé∑Âèñ‰∫Ü lockÔºåCoordinator ÂÜ≥ÂÆöÊèê‰∫§ËøôÊ¨°‰∫ãÂä°ÔºåÂπ∂‰ΩøÁî® TrueTime Ëé∑Âèñ‰∏Ä‰∏™ timestamp„ÄÇËøô‰∏™ commit ÂÜ≥ÂÆöÔºå‰ª•Âèä Split 2 Ëá™Â∑±ÁöÑ Row 2 ÁöÑÊï∞ÊçÆÔºåÈÉΩ‰ºöÂ§çÂà∂Âà∞ Split 2 ÁöÑÂ§ßÂ§öÊï∞ËäÇÁÇπ‰∏äÈù¢ÔºåÂ§çÂà∂ÊàêÂäü‰πãÂêéÔºåÂ∞±ÂèØ‰ª•ËÆ§‰∏∫Ëøô‰∏™‰∫ãÂä°Â∑≤ÁªèË¢´Êèê‰∫§„ÄÇ
Coordinator Â∞ÜÁªìÊûúÂëäËØâÂÖ∂‰ªñÁöÑ participantsÔºåÂêÑ‰∏™ participant ÁöÑ Leader Ëá™Â∑±Â∞ÜÊîπÂä®Â§çÂà∂Âà∞ÂÖ∂‰ªñÂâØÊú¨‰∏äÈù¢„ÄÇ</li>
<li>Â¶ÇÊûú‰∫ãÂä°Â∑≤ÁªèÊèê‰∫§Ôºåcoordinator ÂíåÊâÄÊúâÁöÑ participants Â∞± apply ÂÆûÈôÖÁöÑÊîπÂä®„ÄÇ
Coordinator Leader ËøîÂõûÁªô client ËØ¥‰∫ãÂä°Â∑≤ÁªèÊèê‰∫§ÊàêÂäüÔºåÂπ∂‰∏îËøîÂõû‰∫ãÂä°ÁöÑ timestamp„ÄÇÂΩìÁÑ∂‰∏∫‰∫Ü‰øùËØÅÊï∞ÊçÆÁöÑ‰∏ÄËá¥ÊÄßÔºåÈúÄË¶ÅÊúâ commit-wait</li>
</ol>
<h2 id="Âõõ„ÄÅÊÄßËÉΩËÆ∫ËØÅ" tabindex="-1">Âõõ„ÄÅÊÄßËÉΩËÆ∫ËØÅ <a class="header-anchor" href="#Âõõ„ÄÅÊÄßËÉΩËÆ∫ËØÅ" aria-label="Permalink to &quot;Âõõ„ÄÅÊÄßËÉΩËÆ∫ËØÅ&quot;"></a></h2>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>Âü∫ÂáÜÊµãËØïÁéØÂ¢É</strong>Âú®ÂàÜÊó∂Êú∫Âô®‰∏äËøõË°åÔºåÊØè‰∏™ spanserver ËøêË°åÂú® 4GB RAM Âíå 4Ê†∏ ÁöÑÊµãËØïÊú∫ÔºåÂÆ¢Êà∑Á´ØÁã¨Á´ãËøêË°åÊâøÂèóÂéãÂäõ„ÄÇÊØè‰∏™Âå∫ÂüüÂåÖÂê´‰∏Ä‰∏™ spanserver„ÄÇÂÆ¢Êà∑Á´ØÂíåÂå∫ÂüüË¢´ÊîæÁΩÆÂú®‰∏ÄÁªÑÁΩëÁªúË∑ùÁ¶ªÂ∞è‰∫é1msÁöÑÊï∞ÊçÆ‰∏≠ÂøÉ‰∏≠„ÄÇÊµãËØïÊï∞ÊçÆÂ∫ìÁî± 50 ‰∏™ Paxos Group Âíå 2500 ‰∏™ ‚ÄúDirectory‚Äù ÂàõÂª∫ÔºåÊìç‰ΩúÊòØ4KBÁöÑÁã¨Á´ãËØªÂÜôÔºåÊï∞ÊçÆÂÖÖÂàÜÈ¢ÑÁÉ≠ÊÉÖÂÜµ‰∏ã„ÄÇ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1. <strong>Âª∂Êó∂ÊÉÖÂÜµÔºö1 ÂâØÊú¨Êèê‰∫§Á≠âÂæÖÂ§ßÁ∫¶ÊòØ 5ms, Paxos Âª∂ËøüÂ§ßÁ∫¶ÊòØ 9ms</strong>„ÄÇÈöèÁùÄ Replica Êï∞ÈáèÁöÑÂ¢ûÂä†ÔºåÁî±‰∫é Paxos Group Êï∞ÊçÆÂêåÊ≠•Âπ∂Ë°åÊâßË°åÔºåÂõ†Ê≠§Âª∂ËøüÂü∫Êú¨‰øùÊåÅ‰∏çÂèò„ÄÇ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2. **ÂêûÂêêÈáèÊÉÖÂÜµÔºö**ÂÆ¢Êà∑Á´Ø‰ºöÂèëÂá∫Ë∂≥Â§üÂ§öÁöÑÊìç‰ΩúÂØºËá¥ÊúçÂä°Âô® cpu È•±ÂíåÔºåÂø´ÁÖßËØªÂèñÂèØÂú®‰ªª‰ΩïÊúÄÊñ∞ÁöÑ Replica ‰∏äÊâßË°åÔºåÂêûÂêêÈáèÂá†‰πéÈöè Replica ÁöÑÊï∞ÈáèÁ∫øÊÄßÂ¢ûÂä†„ÄÇ‰ΩÜÁõ∏ÂêåÁöÑÂÆûÈ™åÁéØÂ¢ÉÂÜôÂêûÂêêÈáèÈöèÁùÄ Replica Êï∞ÈáèÁöÑÂ¢ûÂä†ÔºåÊØèÊ¨°ÂÜôÊâÄÊâßË°åÁöÑÂ∑•‰ΩúÈáèÁöÑÁ∫øÊÄßÂ¢ûÂä†ÈáèÂ∑≤ÁªèË∂ÖËøá‰∫ÜÂÜôÂêûÂêêÈáèÂ∏¶Êù•ÁöÑÂ•ΩÂ§Ñ„ÄÇ</p>
<figure><img src="./Theory-SpannerÂàÜÂ∏ÉÂºè‰∫ãÂä°/performance01.jpg" alt="performance01" tabindex="0"><figcaption>performance01</figcaption></figure>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3. **Êâ©Â±ïÊÄßÊÉÖÂÜµÔºö**‰∏ãÂõæÂ±ïÁ§∫‰∫Ü‰∏§Èò∂ÊÆµÊèê‰∫§ÂèØ‰ª•Êâ©Â±ïÂà∞ÂêàÁêÜÊï∞ÈáèÁöÑÂèÇ‰∏éËÄÖÔºåÂÆûÈ™å‰∫ÜË∑®3‰∏™Âå∫ÂüüËøêË°åÁöÑÂÆûÈ™åÔºåÊØè‰∏™Âå∫ÂüüÊúâ25 ‰∏™ spanserver„ÄÇ‰ªé Âπ≥ÂùáÂÄº Âíå 99 ÁôæÂàÜ‰ΩçÊï∞Êù•ÁúãÔºåÊâ©Â±ïÂà∞ 50 ÂêçÈÉΩÂêàÁêÜÔºå‰ΩÜÂú® 100 ÂêçÂèÇ‰∏éËÄÖÊó∂Âª∂ËøüÂºÄÂßãÊòæËëó‰∏äÂçá„ÄÇ</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="./Theory-SpannerÂàÜÂ∏ÉÂºè‰∫ãÂä°/performance02.jpg" alt="performance02"></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4. **ÂèØÁî®ÊÄßÊµãËØïÔºö**ÊµãËØï ‚Äúuniverse‚Äù Áî± 5 ‰∏™ Zone ÁªÑÊàêÔºåÊØè‰∏™ ‚ÄúZone‚Äù ÂåÖÂê´ 25 ‰∏™spanserver„ÄÇÊµãËØïÊï∞ÊçÆËá™Âä®Ë¢´ÂàáÂàÜÊàê 1250 ‰∏™ Paxos GroupÔºå100 ‰∏™ÊµãËØïÂÆ¢Êà∑Á´Ø‰ª• 50KËØª/Áßí ÁöÑËÅöÂêàÈÄüÁéáÊåÅÁª≠ÂèëÂá∫ÈùûÂø´ÁÖßËØª„ÄÇÊâÄÊúâÁöÑ leader ÈÉΩÊòéÁ°ÆÂú∞ÊîæÂú® Zone 1„ÄÇÂú®ÊØèÊ¨°ÊµãËØïÁöÑ‰∫îÁßíÈíüÂÜÖÔºå‰∏Ä‰∏™ Zone ÂÜÖÁöÑÊâÄÊúâÊúçÂä°Âô®ÂÖ®ÈÉ®ÂÆïÊú∫Ê®°ÊãüÁÅæÈöæÔºåÂêåÊó∂Èùû leader ÊùÄÊ≠ª‰∫Ü Zone 2Ôºåhard-leader ÊùÄÊ≠ª Zone 1„ÄÇÂÆûÈ™åÁªìÊûú‰∏∫ÊùÄÊ≠ª Zone 2 ÂØπËØªÂêûÂêêÈáèÊ≤°ÊúâÂΩ±ÂìçÔºå‰ΩÜ hard-leader ÊùÄÊ≠ªZ1ÔºåÈúÄË¶ÅÈáçÊñ∞ÈÄâ‰∏æ leader ‰ºöÂΩ±ÂìçÂêûÂêêÈáèÂ§ßÁ∫¶Âú® 3-4%„ÄÇ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Âè¶‰∏ÄÊñπÈù¢ÔºåÁõ¥Êé•ÊùÄÊ≠ª Zone 1 ‰ºö‰Ωø TPS Âá†‰πéÈôçËá≥0„ÄÇPaxos lease Ë¢´ËÆæÁΩÆ‰∏∫10Áßí,ÂΩìÊùÄÊ≠ª Zone ÂêéÔºåÊØè‰∏™ÁßüÁ∫¶Âà∞ÊúüÂêéÁöÑ Paxos Group ‰ºöÈÄâÂá∫Êñ∞ÁöÑ leader„ÄÇÂú® kill Êó∂Èó¥‰πãÂêéÂ§ßÁ∫¶ 10 ÁßíÔºåÊâÄÊúâ Paxos Group ÂùáÊúâ‰∫Ü leaderÔºåÂêûÂêêÈáèÂ∑≤ÁªèÊÅ¢Â§ç„ÄÇÊõ¥Áü≠ÁöÑÁßüËµÅÊó∂Èó¥ÂèØÁº©Áü≠ÂØπÂèØÁî®ÊÄßÁöÑÂΩ±ÂìçÔºå‰ΩÜÂ∞ÜÊõ¥ËÄóÁΩëÁªúÊµÅÈáè„ÄÇ</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="./Theory-SpannerÂàÜÂ∏ÉÂºè‰∫ãÂä°/performance03.jpg" alt="performance03"></p>
<h2 id="‰∫î„ÄÅÊñáÁ´†ÁªìËÆ∫" tabindex="-1">‰∫î„ÄÅÊñáÁ´†ÁªìËÆ∫ <a class="header-anchor" href="#‰∫î„ÄÅÊñáÁ´†ÁªìËÆ∫" aria-label="Permalink to &quot;‰∫î„ÄÅÊñáÁ´†ÁªìËÆ∫&quot;"></a></h2>
<ol>
<li>Spanner ÁªìÂêàÂπ∂Êâ©Â±ï‰∫ÜÊï∞ÊçÆÂ∫ìÁ§æÂå∫„ÄÅÁ≥ªÁªüÁ§æÂå∫ÊÄùÊÉ≥ÔºåÊèê‰æõ‰∫ÜÂçäÂÖ≥Á≥ªÊé•Âè£Ôºå‰∫ãÂä°ÔºåÂü∫‰∫é sql ÁöÑÊü•ËØ¢ËØ≠Ë®ÄÔºåÂèØ‰º∏Áº©ÊÄßÔºåËá™Âä®ÂàÜÁâáÔºåÂÆπÈîôÔºå‰∏ÄËá¥Â§çÂà∂ÔºåÂ§ñÈÉ®‰∏ÄËá¥ÊÄßÔºåÂπøÂüüÂàÜÂ∏ÉÁ≠âÁâπÊÄß„ÄÇ</li>
<li>Spanner ÂÖ≥ÈîÆÂäüËÉΩÂÆûÁé∞‰∫Ü TrueTimeÔºåÂ∑≤ÁªèËØÅÊòéÔºåÂú®Êó∂Èó¥ API ‰∏≠ÂÖ∑‰ΩìÂåñÊó∂ÈíüÊûÑÂª∫ÂàÜÂ∏ÉÂºèÁ≥ªÁªüÊàê‰∏∫ÂèØËÉΩ„ÄÇ</li>
</ol>
<h2 id="ÂÖ≠„ÄÅÂºïÁî®ÊñáÁ´†" tabindex="-1">ÂÖ≠„ÄÅÂºïÁî®ÊñáÁ´† <a class="header-anchor" href="#ÂÖ≠„ÄÅÂºïÁî®ÊñáÁ´†" aria-label="Permalink to &quot;ÂÖ≠„ÄÅÂºïÁî®ÊñáÁ´†&quot;"></a></h2>
<p><a href="http://static.googleusercontent.com/media/research.google.com/zh-CN//archive/spanner-osdi2012.pdf" target="_blank" rel="noreferrer">Paper -- Spanner: Google‚Äôs Globally-Distributed Database</a><br>
<a href="https://pingcap.com/zh/blog/Spanner-cap-truetime-transaction" target="_blank" rel="noreferrer">TiDB Blog -- Spanner - CAP, TrueTime and Transaction by TangLiu</a></p>
]]></content:encoded>
            <enclosure url="https://askaric.com/Theory-Spanner%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1/SpannerCluster.jpg" length="0" type="image/jpg"/>
        </item>
        <item>
            <title><![CDATA[‰∏Ä„ÄÅËÆ∫ÊñáÊëòË¶Å]]></title>
            <link>https://askaric.com/zh/work/tidb/TiDB-Principle/Paper Reading/04LSMTree Â≠òÂÇ®Á¨îËÆ∞.html</link>
            <guid>https://askaric.com/zh/work/tidb/TiDB-Principle/Paper Reading/04LSMTree Â≠òÂÇ®Á¨îËÆ∞.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[1. ÈÄÇÁî®Âú∫ÊôØÔºö LSM-tree ÊòØ‰∏ÄÁßçÂü∫‰∫éÁ£ÅÁõòÁöÑ Data StructureÔºåÊó®Âú®‰∏∫‰∏ÄÊÆµÊó∂Èó¥ÂÜÖÊåÅÁª≠ÊèíÂÖ•„ÄÅÂà†Èô§ÁöÑÊñá‰ª∂Êèê‰æõ‰ΩéÊàêÊú¨Á¥¢ÂºïÔºå‰ªéËÄåËß£ÂÜ≥‰º†Áªü B-tree Âú®ÊåÅÁª≠ÂÜôÂá∫Âú∫ÊôØ‰∏ãÔºåÁª¥Êä§Ê¥ªÂøÉ‰∫ãÂä° I/]]></description>
            <content:encoded><![CDATA[<h2 id="‰∏Ä„ÄÅËÆ∫ÊñáÊëòË¶Å" tabindex="-1">‰∏Ä„ÄÅËÆ∫ÊñáÊëòË¶Å <a class="header-anchor" href="#‰∏Ä„ÄÅËÆ∫ÊñáÊëòË¶Å" aria-label="Permalink to &quot;‰∏Ä„ÄÅËÆ∫ÊñáÊëòË¶Å&quot;"></a></h2>
<ol>
<li><strong>ÈÄÇÁî®Âú∫ÊôØÔºö</strong> LSM-tree ÊòØ‰∏ÄÁßçÂü∫‰∫éÁ£ÅÁõòÁöÑ Data StructureÔºåÊó®Âú®‰∏∫‰∏ÄÊÆµÊó∂Èó¥ÂÜÖÊåÅÁª≠ÊèíÂÖ•„ÄÅÂà†Èô§ÁöÑÊñá‰ª∂Êèê‰æõ‰ΩéÊàêÊú¨Á¥¢ÂºïÔºå‰ªéËÄåËß£ÂÜ≥‰º†Áªü B-tree Âú®ÊåÅÁª≠ÂÜôÂá∫Âú∫ÊôØ‰∏ãÔºåÁª¥Êä§Ê¥ªÂøÉ‰∫ãÂä° I/O ÊàêÊú¨ÁøªÂÄçÁöÑÈóÆÈ¢ò„ÄÇÂú®ÊèíÂÖ•ÊØîÊ£ÄÁ¥¢Êõ¥Â∏∏ËßÅÁöÑÂú∫ÊôØ‰∏≠ÔºåLsm-tree Êõ¥‰∏∫ÊúâÁî®„ÄÇÂ¶ÇÔºåÂØπ‰∫éÂéÜÂè≤Ë°®ÂíåÊó•ÂøóÊñá‰ª∂„ÄÇ</li>
<li><strong>Áª¥Êä§ÊñπÂºèÔºö</strong> Lsm-tree ‰ΩøÁî®ÁÆóÊ≥ïÂª∂ËøüÂíåÊâπÈáèÁ¥¢ÂºïÊõ¥ÊîπÔºå‰ª•Á±ªÂΩíÂπ∂ÊéíÂ∫èÁöÑÊñπÂºèÂ∞Ü update ‰ø°ÊÅØÂÜÖÂ≠ò‰º†ÈÄíÂà∞Á£ÅÁõò„ÄÇ</li>
<li><strong>ÊÄßËÉΩÂØπÊØîÔºö</strong> ‰∏é‰º†ÁªüÁöÑbÊ†ëËÆøÈóÆÊñπÊ≥ïÁõ∏ÊØîÔºåËØ•ÁÆóÊ≥ïÂèØ‰ªéÂÜÖÂ≠òÊàñÁ£ÅÁõòËøûÁª≠ËØªÂèñËåÉÂõ¥Êï∞ÊçÆÔºåÂ§ßÂ§ßÂáèÂ∞ë‰∫ÜÁ£ÅÁõòËáÇÁöÑÁßªÂä®Ôºå‰ΩÜÁî±‰∫éÁÆóÊ≥ïÊú¨Ë∫´ËØªÊîæÂ§ßÔºåÁ¥¢ÂºïÊü•ËØ¢ÂèØËÉΩ‰ºö‰∏ßÂ§±‰∏ÄÂÆö I/O ÊïàÁéá„ÄÇ</li>
</ol>
<h2 id="‰∫å„ÄÅËÆ∫ÊñáÁÆÄ‰ªã" tabindex="-1">‰∫å„ÄÅËÆ∫ÊñáÁÆÄ‰ªã <a class="header-anchor" href="#‰∫å„ÄÅËÆ∫ÊñáÁÆÄ‰ªã" aria-label="Permalink to &quot;‰∫å„ÄÅËÆ∫ÊñáÁÆÄ‰ªã&quot;"></a></h2>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÂïÜ‰∏ö‰∏çÊñ≠Â∫îÁî®Êù°‰ª∂‰∏ãÔºå‰º†Áªü‰∫ãÂä°Êó•ÂøóÂÖ≥Ê≥®Â¥©Ê∫ÉÂõûÂ§çÔºå‰ΩÜÈÄöÂ∏∏Êèê‰æõÊó•ÂøóÊ£ÄÁ¥¢ÈúÄÊ±Ç‰∏çÊñ≠Â¢ûÂä†„ÄÇÈÄöËøáÊâ©ÂÖÖÁâ©ÁêÜÂÜÖÂ≠òÊñπÂºè‰∏çÊòØÈïø‰πÖ‰πãËÆ°ÔºåÂ¶ÇÊûúÂú®ÂéÜÂè≤ËÆ∞ÂΩïË°®‰∏äÊèê‰æõÁ¥¢ÂºïÊü•ËØ¢ÊîØÊåÅÂ∞ÜÊûÅÂÖ∑‰ª∑ÂÄº„ÄÇ<strong>LSM-Tree ÈÄöËøáÁÆóÊ≥ïÂÆûÁé∞‰∫ÜÁ¥¢Âºï node È°∫Â∫è‰∏é key È°∫Â∫è Êó†ÂÖ≥ÁöÑÔºåÈ´òÈ¢ëÊèíÂÖ•Êó∂ÁöÑÊü•ËØ¢ÊïàÁéá‰ºòÂåñ„ÄÇ</strong> Lsm-tree ËÆ∫ÊñáÁÆÄ‰ªãÈÉ®ÂàÜ‰ΩøÁî® <strong>‚Äú5 ÂàÜÈíüÂéüÂàô‚Äù„ÄÅ‚ÄúTPC-A benchmark ÂÆûÈ™å‚Äù</strong> ÂàÜÂà´ÂºïÂá∫ËÆ∫ÊñáÁöÑËÆ∫ËØÅÊ†áÂáÜ„ÄÅÂíåËÆ∫ËØÅÊñπÂºè„ÄÇ<strong>Êú¨‰∫∫Êí∞ÂÜôÊú¨ÊñáÁöÑÁõÆÁöÑ‰∏∫Â∏ÆÂä©ËØªËÄÖÊõ¥Â•ΩÁêÜËß£ Lsm-tree ÂéüÊñá</strong></p>
<ol>
<li><a href="https://www.hpl.hp.com/techreports/tandem/TR-86.1.pdf" target="_blank" rel="noreferrer">The 5 Minute Rule for Trading Memory for Disc Accesses and the 5 Byte Rule for Trading Memory for CPU Time</a> ËÆ∫ÊñáÂèëË°®‰∫é 1986 Âπ¥ÔºåÊñá‰∏≠ÁªôÂá∫‰∫Ü‰∏ÄÂ•óÂÖ¨ÂºèÊµãÁÆó‰ΩøÁî®Á£ÅÁõò‰ª£‰ª∑‰∏éÂÜÖÂ≠ò‰ª£‰ª∑ÊµãÁÆóÂÖ¨Âºè„ÄÇ</li>
<li>‚ÄúTPC-A benchmark ÂÆûÈ™å‚Äù ÊòØËëóÂêçÁöÑÂü∫ÂáÜÊµãËØïÂÆûÈ™åÔºåÂê´ÊúâÂ§ßÈáèÂéÜÂè≤ËÆ∞ÂΩïÊü•ËØ¢Âú∫ÊôØ„ÄÇ</li>
</ol>
<h2 id="‰∏â„ÄÅÂü∫Êú¨ÊÄùÊÉ≥" tabindex="-1">‰∏â„ÄÅÂü∫Êú¨ÊÄùÊÉ≥ <a class="header-anchor" href="#‰∏â„ÄÅÂü∫Êú¨ÊÄùÊÉ≥" aria-label="Permalink to &quot;‰∏â„ÄÅÂü∫Êú¨ÊÄùÊÉ≥&quot;"></a></h2>
<h3 id="_3-1-lsm-tree-‰∏§ÈáçË¶ÅÁªÑ‰ª∂" tabindex="-1">3.1 Lsm-tree ‰∏§ÈáçË¶ÅÁªÑ‰ª∂ <a class="header-anchor" href="#_3-1-lsm-tree-‰∏§ÈáçË¶ÅÁªÑ‰ª∂" aria-label="Permalink to &quot;3.1 Lsm-tree ‰∏§ÈáçË¶ÅÁªÑ‰ª∂&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Lsm-tree Áî± Disk tree Âíå Memory tree ‰∏§ÈÉ®ÂàÜÁªÑÊàêÔºåÂéÜÂè≤Êï∞ÊçÆÂ≠òÊîæÂú® Disk tree ‰∏≠„ÄÇÂΩìÊï∞ÊçÆËøõÂÖ• Lsm-tree ÁöÑÊó∂ÂÖàÂÜôÂ∫èÂàóÂåñÊó•Âøó‰ª•Áî®‰∫éÂ¥©Ê∫ÉÊÅ¢Â§çÔºåÈöèÂêéÊï∞ÊçÆËøõÂÖ•ÂÜÖÂ≠ò C0 Â±Ç„ÄÇÊØèÊ¨°Ê£ÄÁ¥¢Êï∞ÊçÆÈÉΩÈúÄÂÖàÊü• C0 Â±Ç„ÄÅÂÜçÊü• C1 Â±ÇÔºåËØªÊîæÂ§ßÂª∂Êó∂Âõ†Ê≠§‰∫ßÁîü„ÄÇ</p>
<figure><img src="./Theory-LSMTreeÂ≠òÂÇ®/two-components.jpg" alt="two-components" tabindex="0"><figcaption>two-components</figcaption></figure>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Êï∞ÊçÆÂú® C0 Â±ÇÊó∂Êó† IO Ê∂àËÄóÔºå‰ΩÜÂèóÁªèÊµéÂõ†Á¥†ÔºàÂÜÖÂ≠òÊØîÁ£ÅÁõòË¥µÔºâÈôêÂà∂ÔºåÂΩì C0 Â±ÇÊï∞ÊçÆËææÂà∞ÂÆπÈáèÈôêÂà∂‰ºöÊúâËøõÁ®ãÂ∞ÜÊï∞ÊçÆÂà∑Âà∞Á£ÅÁõò„ÄÇ‰∏é B-tree ÊØîËæÉÔºå Lsm-tree Âú®È°∫Â∫èÁ£ÅÁõòÊñπÂêëÊúâÊâÄ‰ºòÂåñÔºåÊ†πËäÇÁÇπ‰∏ãÂêÑÂ±ÇÂ≠êËäÇÁÇπÂùáÂ∑≤ËøûÁª≠Á£ÅÁõòÊï∞ÊçÆÈ°µÁöÑÂΩ¢ÂºèÂ≠òÂÇ®ÔºåÊèêÈ´òÁ£ÅÁõòËáÇ‰ΩøÁî®ÊïàÁéá„ÄÇÊØèÂ±ÇÊúâÂ§öËäÇÁÇπÂíåÊúâÂçïËäÇÁÇπÁöÑÂå∫Âà´ÁöÑÂéüÂõ†ÊòØÔºåÂ§öÂ≠êËäÇÁÇπÁî®‰∫éÊúâÂà©‰∫éÂ§ßËåÉÂõ¥Êï∞ÊçÆÊâ´ÊèèÔºåÂçïÂ≠êËäÇÁÇπÁî®‰∫éÊúÄÂ∞èÂåñÁºìÂ≠ò„ÄÇ</p>
<p><strong>ÂùóÂ§ßËá¥ÂàÜ‰∏§Á±ªÔºö</strong></p>
<ol>
<li><strong>emptying blockÔºö</strong> Ë¢´ÂêàÂπ∂ÂâçÔºå‰∏çÊñ≠ÂáèÂ∞ëÊï∞ÊçÆÁöÑÂùóÔºåÁß∞‰∏∫ÊéèÁ©∫ÂùóÔºõ</li>
<li><strong>filling blockÔºö</strong> ÂΩìÁ©∫ÂùóÂ§ßÂ∞èÂ¢ûÈïøÂà∞ÈòàÂÄºÔºåË¢´ÈáçÂÜôÂà∞ C1 Â±ÇÊñ∞ÂùóÔºå‰∏çÊñ≠Â¢ûÂä†Êï∞ÊçÆÁöÑÂùóÔºåÁß∞‰∏∫Â°´ÂÖÖÂùóÔºõ</li>
</ol>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÊªöÂä®ËêΩÁõòÂåÖÂê´‰∏ÄÁ≥ªÂàóÊ≠•È™§ÔºåÊØèÊ¨°‰ªé C1 Â±Ç<strong>Â§öÂùóÔºàÁ£ÅÁõòÈ°µÔºâËØª</strong>ËØªÂèñÂ§ö‰∏™Âè∂Â≠êÁªìÁÇπÂà∞ÂÜÖÂ≠òÔºåÂ∞Ü C0 Â±ÇÊï∞ÊçÆÂú®ÂÜÖÂ≠ò‰∏≠‰∏é C1 Â±ÇÊï∞ÊçÆÂêàÂπ∂Ôºå‰ªéËÄåÂáèÂ∞ë C0 Â±ÇÁ©∫Èó¥Âç†Áî®„ÄÇÂΩì ‚Äúfilling block‚Äù Ë¢´ÂÜôÊª°ÂêéÔºå‰ºöË¢´ÈáçÂÜôÂà∞Êñ∞ÁöÑÁ£ÅÁõòÁ©∫Èó≤Âå∫„ÄÇÊñ∞ÂêàÂπ∂ÁöÑËäÇÁÇπÂú®Áà∂ËäÇÁÇπÁöÑÂè≥‰æß„ÄÇÂΩìÊñ∞ËäÇÁÇπÂÆπÈáèÂ¢ûÈïøÂà∞ÈòàÂÄºÊó∂Ôºå‰ºöÁªßÁª≠Âêë‰∏ãÊªöÂä®‰∏äËø∞ÂêàÂπ∂ËøáÁ®ã„ÄÇ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Êóß block Êï∞ÊçÆË¢´ÂêàÂπ∂Âà∞Êñ∞ block Âêé‰∏ç‰ºöÁ´ãÂç≥Ë¢´ÈáçÂÜôÔºåËÄåÊòØ‰øùÁïôÁî®‰∫éÂ¥©Ê∫ÉÊÅ¢Â§ç„ÄÇÂêåÊó∂ÔºåË¢´Êõ¥Êñ∞Âè∂Â≠êÁªìÁÇπÁöÑÁà∂ËäÇÁÇπ‰πü‰ºöÁºìÂ≠òÂú®ÂÜÖÂ≠ò‰∏≠‰∏ÄÊÆµÊó∂Èó¥Ôºå‰ª•‰∏∫ÊúÄÂ∞èÂåñ I/O ÂèäÊõ¥Êñ∞Â≠êËäÇÁÇπ‰ΩçÁΩÆ‰ø°ÊÅØÔºåÁõ¥Ëá≥Êóß block Êó†ÊïàÊó∂Êâç‰ºöË¢´Âà†Èô§„ÄÇ</p>
<figure><img src="./Theory-LSMTreeÂ≠òÂÇ®/two-conments-tree.jpg" alt="two-conments-tree" tabindex="0"><figcaption>two-conments-tree</figcaption></figure>
<h4 id="_3-1-1-ÁªÑ‰ª∂Â¢ûÈïøÁªÜËäÇ" tabindex="-1">3.1.1 ÁªÑ‰ª∂Â¢ûÈïøÁªÜËäÇ <a class="header-anchor" href="#_3-1-1-ÁªÑ‰ª∂Â¢ûÈïøÁªÜËäÇ" aria-label="Permalink to &quot;3.1.1 ÁªÑ‰ª∂Â¢ûÈïøÁªÜËäÇ&quot;"></a></h4>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Lsm-tree Â¢ûÈïøÂàùÊúü‰ºöÂÖàÂ∞ÜËÆ∞ÂΩïÊèíÂÖ•ÂÜÖÂ≠ò‰∏≠ÁöÑ C0 ÁªÑ‰ª∂‰∏≠ÔºåÂõ†‰∏∫‰∏çÈúÄË¶ÅËÄÉËôëËêΩÁõòÂêéÔºåÊ£ÄÁ¥¢Êï∞ÊçÆÊçüÂ§± CPU ÊïàÁéáÔºåÊâÄ‰ª• C0 ËäÇÁÇπÁöÑÂÆπÈáèÂèØ‰ª•ÊòØ‰ªªÊÑèÁöÑ„ÄÇÂΩì C0 Êï∞ÊçÆÂÆπÈáèÂ¢ûÈïøÂà∞ÈòàÂÄºÊó∂Ôºå‰ª• batch ÊñπÂºèÈáçÊûÑÂà∞ C1 ÂêéÔºåÂà†Èô§Êéâ C0 ‰∏≠Êï∞ÊçÆ„ÄÇÈöè‰ªéÂ∑¶Âà∞Âè≥ÊîæÁΩÆÂú® C1 ÁöÑÈ°µÂùó‰∏çÊñ≠Â¢ûÂä†ÔºåÂΩì C1 ÁªÑ‰ª∂Êï∞ÊçÆÂ¢ûÈïøËææÂà∞ÈòàÂÄºÂêéÔºåË¢´ÂÜôÂÖ•Âà∞Á£ÅÁõò„ÄÇ<br>
<strong>C1 Â±ÇËäÇÁÇπ‰ø°ÊÅØÊõ¥Êñ∞Âà∞Á£ÅÁõòÁöÑÊÉÖÂÜµ</strong></p>
<ol>
<li>Êüê‰∏™ÂåÖÂê´Â§öÁ£ÅÁõòÈ°µÁöÑÂùóË¢´ÂÜôÊª°Ôºõ</li>
<li>Ë∑üËäÇÁÇπÂàÜË£ÇÂ¢ûÂä†‰∫Ü C1 Ê†ëÊ∑±Â∫¶Ôºõ</li>
<li>ÊâßË°å chekckpoint Êó∂Ôºõ</li>
</ol>
<h3 id="_3-2-lsm-tree-ÊÄßËÉΩ‰∏éÂ§öÁªÑ‰ª∂" tabindex="-1">3.2 Lsm-tree ÊÄßËÉΩ‰∏éÂ§öÁªÑ‰ª∂ <a class="header-anchor" href="#_3-2-lsm-tree-ÊÄßËÉΩ‰∏éÂ§öÁªÑ‰ª∂" aria-label="Permalink to &quot;3.2 Lsm-tree ÊÄßËÉΩ‰∏éÂ§öÁªÑ‰ª∂&quot;"></a></h3>
<h3 id="_3-3-lsm-tree-Âπ∂Âèë‰∏éÂ¥©Ê∫ÉÊÅ¢Â§ç" tabindex="-1">3.3 Lsm-tree Âπ∂Âèë‰∏éÂ¥©Ê∫ÉÊÅ¢Â§ç <a class="header-anchor" href="#_3-3-lsm-tree-Âπ∂Âèë‰∏éÂ¥©Ê∫ÉÊÅ¢Â§ç" aria-label="Permalink to &quot;3.3 Lsm-tree Âπ∂Âèë‰∏éÂ¥©Ê∫ÉÊÅ¢Â§ç&quot;"></a></h3>
<h3 id="_3-4-Á£ÅÁõòËÆøÈóÆÁÆóÊ≥ïÊØîËæÉ" tabindex="-1">3.4 Á£ÅÁõòËÆøÈóÆÁÆóÊ≥ïÊØîËæÉ <a class="header-anchor" href="#_3-4-Á£ÅÁõòËÆøÈóÆÁÆóÊ≥ïÊØîËæÉ" aria-label="Permalink to &quot;3.4 Á£ÅÁõòËÆøÈóÆÁÆóÊ≥ïÊØîËæÉ&quot;"></a></h3>
<h2 id="Âõõ„ÄÅÊñáÁ´†ÁªìËÆ∫" tabindex="-1">Âõõ„ÄÅÊñáÁ´†ÁªìËÆ∫ <a class="header-anchor" href="#Âõõ„ÄÅÊñáÁ´†ÁªìËÆ∫" aria-label="Permalink to &quot;Âõõ„ÄÅÊñáÁ´†ÁªìËÆ∫&quot;"></a></h2>
<h2 id="‰∫î„ÄÅÂºïÁî®ÊñáÁ´†" tabindex="-1">‰∫î„ÄÅÂºïÁî®ÊñáÁ´† <a class="header-anchor" href="#‰∫î„ÄÅÂºïÁî®ÊñáÁ´†" aria-label="Permalink to &quot;‰∫î„ÄÅÂºïÁî®ÊñáÁ´†&quot;"></a></h2>
<p><a href="https://www.hpl.hp.com/techreports/tandem/TR-86.1.pdf" target="_blank" rel="noreferrer">Paper -- The 5 Minute Rule for Trading Memory for Disc Accesses and the 5 Byte Rule for Trading Memory for CPU Time</a><br>
<a href="http://paperhub.s3.amazonaws.com/18e91eb4db2114a06ea614f0384f2784.pdf" target="_blank" rel="noreferrer">Paper -- The Log-Structured Merge-Tree (LSM-Tree)</a><br>
<a href="https://blog.csdn.net/historyasamirror/article/details/5638106" target="_blank" rel="noreferrer">CSDN Blog -- The 5 minute rule: ‰∏ÄÈÉ®paperÁöÑËøûÁª≠Ââß by historyasamirror</a></p>
]]></content:encoded>
            <enclosure url="https://askaric.com/Theory-LSMTree%E5%AD%98%E5%82%A8/two-components.jpg" length="0" type="image/jpg"/>
        </item>
        <item>
            <title><![CDATA[‰∫ãÂä°ÁöÑÈöîÁ¶ªÁ∫ßÂà´]]></title>
            <link>https://askaric.com/zh/work/tidb/TiDB-Principle/Paper Reading/05Êï∞ÊçÆÂ∫ìÁöÑÈöîÁ¶ªÁ∫ßÂà´.html</link>
            <guid>https://askaric.com/zh/work/tidb/TiDB-Principle/Paper Reading/05Êï∞ÊçÆÂ∫ìÁöÑÈöîÁ¶ªÁ∫ßÂà´.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[# ‰∫ãÂä°ÁöÑÈöîÁ¶ªÁ∫ßÂà´
Êó∂Èó¥Ôºö2021-01-14

## ÈöîÁ¶ªÁ∫ßÂà´ÁêÜËÆ∫ÁÆÄ‰ªã

|‰∫ãÂä°ÈöîÁ¶ªÁ∫ßÂà´	| ËÑèËØª	| ‰∏çÂèØÈáçÂ§çËØª	| ÂπªËØª | Â§áÊ≥® |
| ]]></description>
            <content:encoded><![CDATA[<h1 id="‰∫ãÂä°ÁöÑÈöîÁ¶ªÁ∫ßÂà´" tabindex="-1">‰∫ãÂä°ÁöÑÈöîÁ¶ªÁ∫ßÂà´ <a class="header-anchor" href="#‰∫ãÂä°ÁöÑÈöîÁ¶ªÁ∫ßÂà´" aria-label="Permalink to &quot;‰∫ãÂä°ÁöÑÈöîÁ¶ªÁ∫ßÂà´&quot;"></a></h1>
<p>Êó∂Èó¥Ôºö2021-01-14</p>
<h2 id="ÈöîÁ¶ªÁ∫ßÂà´ÁêÜËÆ∫ÁÆÄ‰ªã" tabindex="-1">ÈöîÁ¶ªÁ∫ßÂà´ÁêÜËÆ∫ÁÆÄ‰ªã <a class="header-anchor" href="#ÈöîÁ¶ªÁ∫ßÂà´ÁêÜËÆ∫ÁÆÄ‰ªã" aria-label="Permalink to &quot;ÈöîÁ¶ªÁ∫ßÂà´ÁêÜËÆ∫ÁÆÄ‰ªã&quot;"></a></h2>
<table tabindex="0">
<thead>
<tr>
<th>‰∫ãÂä°ÈöîÁ¶ªÁ∫ßÂà´</th>
<th>ËÑèËØª</th>
<th>‰∏çÂèØÈáçÂ§çËØª</th>
<th>ÂπªËØª</th>
<th>Â§áÊ≥®</th>
</tr>
</thead>
<tbody>
<tr>
<td>ËØªÊú™Êèê‰∫§Ôºàread-uncommittedÔºâ</td>
<td>ÊòØ</td>
<td>ÊòØ</td>
<td>ÊòØ</td>
<td>read-uncommitted Âç≥‰ºöÂá∫Áé∞ËÑèËØªÔºå‰πü‰ºöÂá∫Áé∞‰∏çÂèØÈáçÂ§çËØª„ÄÅÂπªËØª;</td>
</tr>
<tr>
<td>‰∏çÂèØÈáçÂ§çËØªÔºàread-committedÔºâ</td>
<td>Âê¶</td>
<td>ÊòØ</td>
<td>ÊòØ</td>
<td>read-committed ‰ºöÂá∫Áé∞ÂπªËØªÂíå‰∏çÂèØÈáçÂ§çËØª;</td>
</tr>
<tr>
<td>ÂèØÈáçÂ§çËØªÔºàrepeatable-readÔºâ</td>
<td>Âê¶</td>
<td>Âê¶</td>
<td>ÊòØ</td>
<td>repeatable-read ‰∏ç‰ºöÂá∫Áé∞‰∏çÂèØÈáçÂ§çËØªÔºå‰ºöÂá∫Áé∞ÂπªËØª;</td>
</tr>
<tr>
<td>‰∏≤Ë°åÂåñÔºàserializableÔºâ</td>
<td>Âê¶</td>
<td>Âê¶</td>
<td>Âê¶</td>
<td>serializable ‰ª•‰∏ä‰∏âËÄÖÂùá‰∏ç‰ºöÂá∫Áé∞;</td>
</tr>
</tbody>
</table>
<p>Read UncommittedÔºàËØªÂèñÊú™Êèê‰∫§ÂÜÖÂÆπÔºâ
Âú®ËØ•ÈöîÁ¶ªÁ∫ßÂà´ÔºåÊâÄÊúâ‰∫ãÂä°ÈÉΩÂèØ‰ª•ÁúãÂà∞ÂÖ∂‰ªñÊú™Êèê‰∫§‰∫ãÂä°ÁöÑÊâßË°åÁªìÊûú„ÄÇÊú¨ÈöîÁ¶ªÁ∫ßÂà´ÂæàÂ∞ëÁî®‰∫éÂÆûÈôÖÂ∫îÁî®ÔºåÂõ†‰∏∫ÂÆÉÁöÑÊÄßËÉΩ‰πü‰∏çÊØîÂÖ∂‰ªñÁ∫ßÂà´Â•ΩÂ§öÂ∞ë„ÄÇËØªÂèñÊú™Êèê‰∫§ÁöÑÊï∞ÊçÆÔºå‰πüË¢´Áß∞‰πã‰∏∫ËÑèËØªÔºàDirty ReadÔºâ„ÄÇ</p>
<p>Read CommittedÔºàËØªÂèñÊèê‰∫§ÂÜÖÂÆπÔºâ
ËøôÊòØÂ§ßÂ§öÊï∞Êï∞ÊçÆÂ∫ìÁ≥ªÁªüÁöÑÈªòËÆ§ÈöîÁ¶ªÁ∫ßÂà´Ôºà‰ΩÜ‰∏çÊòØMySQLÈªòËÆ§ÁöÑÔºâ„ÄÇÂÆÉÊª°Ë∂≥‰∫ÜÈöîÁ¶ªÁöÑÁÆÄÂçïÂÆö‰πâÔºö‰∏Ä‰∏™‰∫ãÂä°Âè™ËÉΩÁúãËßÅÂ∑≤ÁªèÊèê‰∫§‰∫ãÂä°ÊâÄÂÅöÁöÑÊîπÂèò„ÄÇËøôÁßçÈöîÁ¶ªÁ∫ßÂà´ ‰πüÊîØÊåÅÊâÄË∞ìÁöÑ‰∏çÂèØÈáçÂ§çËØªÔºàNonrepeatable ReadÔºâÔºåÂõ†‰∏∫Âêå‰∏Ä‰∫ãÂä°ÁöÑÂÖ∂‰ªñÂÆû‰æãÂú®ËØ•ÂÆû‰æãÂ§ÑÁêÜÂÖ∂Èó¥ÂèØËÉΩ‰ºöÊúâÊñ∞ÁöÑcommitÔºåÊâÄ‰ª•Âêå‰∏ÄselectÂèØËÉΩËøîÂõû‰∏çÂêåÁªìÊûú„ÄÇ</p>
<p>Repeatable ReadÔºàÂèØÈáçËØªÔºâ
ËøôÊòØMySQLÁöÑÈªòËÆ§‰∫ãÂä°ÈöîÁ¶ªÁ∫ßÂà´ÔºåÂÆÉÁ°Æ‰øùÂêå‰∏Ä‰∫ãÂä°ÁöÑÂ§ö‰∏™ÂÆû‰æãÂú®Âπ∂ÂèëËØªÂèñÊï∞ÊçÆÊó∂Ôºå‰ºöÁúãÂà∞ÂêåÊ†∑ÁöÑÊï∞ÊçÆË°å„ÄÇ‰∏çËøáÁêÜËÆ∫‰∏äÔºåËøô‰ºöÂØºËá¥Âè¶‰∏Ä‰∏™Ê£òÊâãÁöÑÈóÆÈ¢òÔºöÂπªËØª ÔºàPhantom ReadÔºâ„ÄÇÁÆÄÂçïÁöÑËØ¥ÔºåÂπªËØªÊåáÂΩìÁî®Êà∑ËØªÂèñÊüê‰∏ÄËåÉÂõ¥ÁöÑÊï∞ÊçÆË°åÊó∂ÔºåÂè¶‰∏Ä‰∏™‰∫ãÂä°ÂèàÂú®ËØ•ËåÉÂõ¥ÂÜÖÊèíÂÖ•‰∫ÜÊñ∞Ë°åÔºåÂΩìÁî®Êà∑ÂÜçËØªÂèñËØ•ËåÉÂõ¥ÁöÑÊï∞ÊçÆË°åÊó∂Ôºå‰ºöÂèëÁé∞ÊúâÊñ∞ÁöÑ‚ÄúÂπªÂΩ±‚Äù Ë°å„ÄÇInnoDBÂíåFalconÂ≠òÂÇ®ÂºïÊìéÈÄöËøáÂ§öÁâàÊú¨Âπ∂ÂèëÊéßÂà∂ÔºàMVCCÔºåMultiversion Concurrency ControlÔºâÊú∫Âà∂Ëß£ÂÜ≥‰∫ÜËØ•ÈóÆÈ¢ò„ÄÇ</p>
<p>SerializableÔºàÂ∫èÂàóÂåñÔºâ
ËøôÊòØÊúÄÈ´òÁöÑÈöîÁ¶ªÁ∫ßÂà´ÔºåÂÆÉÈÄöËøáÂº∫Âà∂‰∫ãÂä°ÊéíÂ∫èÔºå‰Ωø‰πã‰∏çÂèØËÉΩÁõ∏‰∫íÂÜ≤Á™ÅÔºå‰ªéËÄåËß£ÂÜ≥ÂπªËØªÈóÆÈ¢ò„ÄÇÁÆÄË®Ä‰πãÔºåÂÆÉÊòØÂú®ÊØè‰∏™ËØªÁöÑÊï∞ÊçÆË°å‰∏äÂä†‰∏äÂÖ±‰∫´ÈîÅ„ÄÇÂú®Ëøô‰∏™Á∫ßÂà´ÔºåÂèØËÉΩÂØºËá¥Â§ßÈáèÁöÑË∂ÖÊó∂Áé∞Ë±°ÂíåÈîÅÁ´û‰∫â„ÄÇ</p>
<p>Áî±MVCCÂÆûÁé∞ÁöÑÂèØÈáçÂ§çËØª</p>
<ul>
<li>
<p>Âø´ÁÖßËØªÔºö</p>
</li>
<li>
<p>ÂΩìÂâçËØªÔºö</p>
</li>
</ul>
<h2 id="postgresql‰∫ãÂä°ÈöîÁ¶ªÁ∫ßÂà´ÂÆûÈ™å" tabindex="-1">PostgreSQL‰∫ãÂä°ÈöîÁ¶ªÁ∫ßÂà´ÂÆûÈ™å <a class="header-anchor" href="#postgresql‰∫ãÂä°ÈöîÁ¶ªÁ∫ßÂà´ÂÆûÈ™å" aria-label="Permalink to &quot;PostgreSQL‰∫ãÂä°ÈöîÁ¶ªÁ∫ßÂà´ÂÆûÈ™å&quot;"></a></h2>
<p>Êú¨Ê¨°ÂÆûÈ™åÈááÁî®postgreSQL</p>
<ul>
<li>ÊûÑÈÄ†ÂÆûÈ™åÊï∞ÊçÆÈõÜ</li>
</ul>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# create table jan_isolation_test(id int primary key,name varchar(20),age int);</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# insert into jan_isolation_test values (1,'jan_1',21),(2,'jan_2',22);</span></span></code></pre>
</div><h4 id="read-uncommittedËØªÂ∑≤ÁªèÊèê‰∫§caseÂÆûÈ™å" tabindex="-1">READ-UNCOMMITTEDËØªÂ∑≤ÁªèÊèê‰∫§CASEÂÆûÈ™å <a class="header-anchor" href="#read-uncommittedËØªÂ∑≤ÁªèÊèê‰∫§caseÂÆûÈ™å" aria-label="Permalink to &quot;READ-UNCOMMITTEDËØªÂ∑≤ÁªèÊèê‰∫§CASEÂÆûÈ™å&quot;"></a></h4>
<h4 id="read-committedËØªÂ∑≤ÁªèÊèê‰∫§caseÂÆûÈ™å" tabindex="-1">READ-COMMITTEDËØªÂ∑≤ÁªèÊèê‰∫§CASEÂÆûÈ™å <a class="header-anchor" href="#read-committedËØªÂ∑≤ÁªèÊèê‰∫§caseÂÆûÈ™å" aria-label="Permalink to &quot;READ-COMMITTEDËØªÂ∑≤ÁªèÊèê‰∫§CASEÂÆûÈ™å&quot;"></a></h4>
<p>Êõ¥Êîπ‰∏§‰∏™sessionÁöÑÈöîÁ¶ªÁ∫ßÂà´</p>
<ul>
<li>ËØªÂ∑≤Êèê‰∫§Âá∫Áé∞ÂπªËØª<br>
session 1 Âú®Âêå‰∏Ä‰∏™‰∫ãÂä°ÊúüÈó¥ÁöÑ‰∏§Ê¨°Êü•ËØ¢ÔºåÂõ†‰∏∫ session 2 Âú®Âè¶‰∏Ä‰∏™Â∑≤Êèê‰∫§‰∫ãÂä°‰∏≠ËøõË°åÁöÑ insert Âíå delete Êìç‰ΩúÔºåËÄåÂâçÂêé‰∏âÊ¨°Êü•Âá∫‰∏çÂêåÁöÑÁªìÊûúÔºåÂõ†Ê≠§‰∫ßÁîüÂπªËØª„ÄÇ</li>
</ul>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# set default_transaction_isolation='READ COMMITTED';</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# show transaction_isolation;</span></span>
<span class="line"><span> transaction_isolation </span></span>
<span class="line"><span>-----------------------</span></span>
<span class="line"><span> read committed</span></span>
<span class="line"><span>(1 row)</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 2</span></span>
<span class="line"><span>postgres=# set default_transaction_isolation='READ COMMITTED';</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 2</span></span>
<span class="line"><span>postgres=# show transaction_isolation;</span></span>
<span class="line"><span> transaction_isolation </span></span>
<span class="line"><span>-----------------------</span></span>
<span class="line"><span> read committed</span></span>
<span class="line"><span>(1 row)</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# begin;</span></span>
<span class="line"><span>BEGIN</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# select * from jan_isolation_test;</span></span>
<span class="line"><span> id | name  | age </span></span>
<span class="line"><span>----+-------+-----</span></span>
<span class="line"><span>  1 | jan_1 |  22</span></span>
<span class="line"><span>  2 | jan_2 |  23</span></span>
<span class="line"><span>(2 rows)</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 2</span></span>
<span class="line"><span>postgres=#  begin;</span></span>
<span class="line"><span>BEGIN</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# select * from jan_isolation_test;</span></span>
<span class="line"><span> id | name  | age </span></span>
<span class="line"><span>----+-------+-----</span></span>
<span class="line"><span>  1 | jan_1 |  22</span></span>
<span class="line"><span>  2 | jan_2 |  23</span></span>
<span class="line"><span>(2 rows)</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# update jan_isolation_test set age=55;</span></span>
<span class="line"><span>UPDATE 2</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# select * from jan_isolation_test;</span></span>
<span class="line"><span> id | name  | age </span></span>
<span class="line"><span>----+-------+-----</span></span>
<span class="line"><span>  1 | jan_1 |  55</span></span>
<span class="line"><span>  2 | jan_2 |  55</span></span>
<span class="line"><span>(2 rows)</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 2</span></span>
<span class="line"><span>postgres=# select * from jan_isolation_test;</span></span>
<span class="line"><span> id | name  | age </span></span>
<span class="line"><span>----+-------+-----</span></span>
<span class="line"><span>  1 | jan_1 |  22</span></span>
<span class="line"><span>  2 | jan_2 |  23</span></span>
<span class="line"><span>(2 rows)</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 2</span></span>
<span class="line"><span>postgres=# insert into jan_isolation_test values(3,'jan_3',23);</span></span>
<span class="line"><span>INSERT 0 1</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 2</span></span>
<span class="line"><span>postgres=# select * from jan_isolation_test;</span></span>
<span class="line"><span> id | name  | age </span></span>
<span class="line"><span>----+-------+-----</span></span>
<span class="line"><span>  1 | jan_1 |  55</span></span>
<span class="line"><span>  2 | jan_2 |  55</span></span>
<span class="line"><span>  3 | jan_3 |  23</span></span>
<span class="line"><span>(3 rows)</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# select * from jan_isolation_test;</span></span>
<span class="line"><span> id | name  | age </span></span>
<span class="line"><span>----+-------+-----</span></span>
<span class="line"><span>  1 | jan_1 |  55</span></span>
<span class="line"><span>  2 | jan_2 |  55</span></span>
<span class="line"><span>(2 rows)</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 2</span></span>
<span class="line"><span>postgres=# commit;</span></span>
<span class="line"><span>COMMIT</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# select * from jan_isolation_test;</span></span>
<span class="line"><span> id | name  | age </span></span>
<span class="line"><span>----+-------+-----</span></span>
<span class="line"><span>  1 | jan_1 |  55</span></span>
<span class="line"><span>  2 | jan_2 |  55</span></span>
<span class="line"><span>  3 | jan_3 |  23</span></span>
<span class="line"><span>(3 rows)</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 2</span></span>
<span class="line"><span>postgres=# begin;</span></span>
<span class="line"><span>BEGIN</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 2</span></span>
<span class="line"><span>postgres=# delete from jan_isolation_test where id=3;</span></span>
<span class="line"><span>DELETE 1</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 2</span></span>
<span class="line"><span>postgres=# commit;</span></span>
<span class="line"><span>COMMIT</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# select * from jan_isolation_test;</span></span>
<span class="line"><span> id | name  | age </span></span>
<span class="line"><span>----+-------+-----</span></span>
<span class="line"><span>  1 | jan_1 |  55</span></span>
<span class="line"><span>  2 | jan_2 |  55</span></span>
<span class="line"><span>(2 rows)</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# rollback;</span></span>
<span class="line"><span>ROLLBACK</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# select * from jan_isolation_test;</span></span>
<span class="line"><span> id | name  | age </span></span>
<span class="line"><span>----+-------+-----</span></span>
<span class="line"><span>  1 | jan_1 |  21</span></span>
<span class="line"><span>  2 | jan_2 |  22</span></span>
<span class="line"><span>(2 rows)</span></span></code></pre>
</div><ul>
<li>ËØªÂ∑≤Êèê‰∫§Âá∫Áé∞‰∏çÂèØÈáçÂ§çËØª<br>
session 1 Âú®Âêå‰∏Ä‰∏™‰∫ãÂä°‰∏≠ÁöÑ‰∏§Ê¨°Êü•ËØ¢ÔºåÂõ†‰∏∫ session 2 Âú®Âè¶‰∏Ä‰∏™Êèê‰∫§‰∫ãÂä°ÁöÑ‰øÆÊîπÂæóÂà∞‰∫Ü‰∏çÂêåÁöÑÁªìÊûúÔºå‰∫ßÁîü‰∫Ü‰∏çÂèØÈáçÂ§çËØª„ÄÇ</li>
</ul>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# set default_transaction_isolation='READ COMMITTED';</span></span>
<span class="line"><span>SET</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# show transaction_isolation;</span></span>
<span class="line"><span> transaction_isolation </span></span>
<span class="line"><span>-----------------------</span></span>
<span class="line"><span> read committed</span></span>
<span class="line"><span>(1 row)</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 2</span></span>
<span class="line"><span>postgres=# set default_transaction_isolation='READ COMMITTED';</span></span>
<span class="line"><span>SET</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 2</span></span>
<span class="line"><span>postgres=# show transaction_isolation;</span></span>
<span class="line"><span> transaction_isolation </span></span>
<span class="line"><span>-----------------------</span></span>
<span class="line"><span> read committed</span></span>
<span class="line"><span>(1 row)</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# begin;</span></span>
<span class="line"><span>BEGIN</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# select * from jan_isolation_test;</span></span>
<span class="line"><span> id | name  | age </span></span>
<span class="line"><span>----+-------+-----</span></span>
<span class="line"><span>  1 | jan_1 |  21</span></span>
<span class="line"><span>  2 | jan_2 |  22</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 2</span></span>
<span class="line"><span>postgres=# begin;</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 2</span></span>
<span class="line"><span>postgres=# update jan_isolation_test set age=66;</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 2</span></span>
<span class="line"><span>commit;</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span># postgres=# select * from jan_isolation_test;</span></span>
<span class="line"><span> id | name  | age </span></span>
<span class="line"><span>----+-------+-----</span></span>
<span class="line"><span>  1 | jan_1 |  66</span></span>
<span class="line"><span>  2 | jan_2 |  66</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# commit;</span></span></code></pre>
</div><h4 id="repeatable-readÂèØÈáçÂ§çËØªcaseÂÆûÈ™å" tabindex="-1">REPEATABLE-READÂèØÈáçÂ§çËØªCASEÂÆûÈ™å <a class="header-anchor" href="#repeatable-readÂèØÈáçÂ§çËØªcaseÂÆûÈ™å" aria-label="Permalink to &quot;REPEATABLE-READÂèØÈáçÂ§çËØªCASEÂÆûÈ™å&quot;"></a></h4>
<p>ÊîπÂèò‰∏§‰∏™sessionÁöÑÈöîÁ¶ªÁ∫ßÂà´</p>
<ul>
<li>REPEATABLE‚ÄîREAD‰∏ç‰ºöÂá∫Áé∞ÂπªËØª</li>
</ul>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# set default_transaction_isolation='repeatable read';</span></span>
<span class="line"><span>SET</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=#  show transaction_isolation;</span></span>
<span class="line"><span> transaction_isolation </span></span>
<span class="line"><span>-----------------------</span></span>
<span class="line"><span> repeatable read</span></span>
<span class="line"><span>(1 row)</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 2</span></span>
<span class="line"><span>postgres=# set default_transaction_isolation='repeatable read';</span></span>
<span class="line"><span>SET</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 2</span></span>
<span class="line"><span>postgres=#  show transaction_isolation;</span></span>
<span class="line"><span> transaction_isolation </span></span>
<span class="line"><span>-----------------------</span></span>
<span class="line"><span> repeatable read</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# begin;</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# select * from jan_isolation_test;</span></span>
<span class="line"><span> id | name  | age </span></span>
<span class="line"><span>----+-------+-----</span></span>
<span class="line"><span>  1 | jan_1 |  21</span></span>
<span class="line"><span>  2 | jan_2 |  22</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 2</span></span>
<span class="line"><span>postgres=# begin;</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 2</span></span>
<span class="line"><span>postgres=# insert into jan_isolation_test values (3,'jan_3',23);</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 2</span></span>
<span class="line"><span>postgres=# commit;</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# select * from jan_isolation_test;</span></span>
<span class="line"><span> id | name  | age </span></span>
<span class="line"><span>----+-------+-----</span></span>
<span class="line"><span>  1 | jan_1 |  21</span></span>
<span class="line"><span>  2 | jan_2 |  22</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 2</span></span>
<span class="line"><span>postgres=# delete from jan_isolation_test where id=3;</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 2</span></span>
<span class="line"><span>postgres=# select * from jan_isolation_test;</span></span>
<span class="line"><span> id | name  | age </span></span>
<span class="line"><span>----+-------+-----</span></span>
<span class="line"><span>  1 | jan_1 |  21</span></span>
<span class="line"><span>  2 | jan_2 |  22</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# select * from jan_isolation_test;</span></span>
<span class="line"><span> id | name  | age </span></span>
<span class="line"><span>----+-------+-----</span></span>
<span class="line"><span>  1 | jan_1 |  21</span></span>
<span class="line"><span>  2 | jan_2 |  22</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# commit;</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# select * from jan_isolation_test;</span></span>
<span class="line"><span> id | name  | age </span></span>
<span class="line"><span>----+-------+-----</span></span>
<span class="line"><span>  1 | jan_1 |  21</span></span>
<span class="line"><span>  2 | jan_2 |  22</span></span></code></pre>
</div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>postgres=# select * from jan_isolation_test;</span></span>
<span class="line"><span> id | name  | age </span></span>
<span class="line"><span>----+-------+-----</span></span>
<span class="line"><span>  2 | jan_2 |  22</span></span>
<span class="line"><span>  1 | jan_1 |  21</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# begin;</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# commit;</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 2</span></span>
<span class="line"><span>postgres=# begin;</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 2</span></span>
<span class="line"><span>postgres=# insert into jan_isolation_test values(3,'jan_3',23);</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 2</span></span>
<span class="line"><span>postgres=# commit;</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span># postgres=# select * from jan_isolation_test;</span></span>
<span class="line"><span> id | name  | age </span></span>
<span class="line"><span>----+-------+-----</span></span>
<span class="line"><span>  2 | jan_2 |  22</span></span>
<span class="line"><span>  1 | jan_1 |  21</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# update jan_isolation_test set age = 66;</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# commit;</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# select * from jan_isolation_test;</span></span>
<span class="line"><span> id | name  | age </span></span>
<span class="line"><span>----+-------+-----</span></span>
<span class="line"><span>  3 | jan_3 |  23</span></span>
<span class="line"><span>  2 | jan_2 |  66</span></span>
<span class="line"><span>  1 | jan_1 |  66</span></span></code></pre>
</div><ul>
<li>Âá∫Áé∞‰∏çÂèØÈáçÂ§çËØª</li>
</ul>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# set default_transaction_isolation='READ COMMITTED';</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>postgres=# show transaction_isolation;</span></span>
<span class="line"><span> transaction_isolation </span></span>
<span class="line"><span>-----------------------</span></span>
<span class="line"><span> read committed</span></span>
<span class="line"><span>(1 row)</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 2</span></span>
<span class="line"><span>postgres=# set default_transaction_isolation='READ COMMITTED';</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 2</span></span>
<span class="line"><span>postgres=# show transaction_isolation;</span></span>
<span class="line"><span> transaction_isolation </span></span>
<span class="line"><span>-----------------------</span></span>
<span class="line"><span> read committed</span></span>
<span class="line"><span>(1 row)</span></span></code></pre>
</div><h4 id="serializableÂ∫èÂàóÂåñcaseÂÆûÈ™å" tabindex="-1">SERIALIZABLEÂ∫èÂàóÂåñCASEÂÆûÈ™å <a class="header-anchor" href="#serializableÂ∫èÂàóÂåñcaseÂÆûÈ™å" aria-label="Permalink to &quot;SERIALIZABLEÂ∫èÂàóÂåñCASEÂÆûÈ™å&quot;"></a></h4>
<h2 id="mysqlÈ™åËØÅrepeatable-read" tabindex="-1">MySQLÈ™åËØÅREPEATABLE-READ <a class="header-anchor" href="#mysqlÈ™åËØÅrepeatable-read" aria-label="Permalink to &quot;MySQLÈ™åËØÅREPEATABLE-READ&quot;"></a></h2>
<figure><img src="http://cdn.lifemini.cn/dbblog/20210114/2ea5088487414a6fa0af0a73c4973d5f.png" alt="image.png" tabindex="0"><figcaption>image.png</figcaption></figure>
<p>ÁâàÊú¨‰ø°ÊÅØ‰∏éÊûÑÈÄ†ÂÆûÈ™åÊï∞ÊçÆ</p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>mysql> select @@tx_isolation;</span></span>
<span class="line"><span>+-----------------+</span></span>
<span class="line"><span>| @@tx_isolation  |</span></span>
<span class="line"><span>+-----------------+</span></span>
<span class="line"><span>| REPEATABLE-READ |</span></span>
<span class="line"><span>+-----------------+</span></span>
<span class="line"><span>1 row in set, 1 warning (0.00 sec)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>mysql> select version();</span></span>
<span class="line"><span>+------------+</span></span>
<span class="line"><span>| version()  |</span></span>
<span class="line"><span>+------------+</span></span>
<span class="line"><span>| 5.7.32-log |</span></span>
<span class="line"><span>+------------+</span></span>
<span class="line"><span>1 row in set (0.00 sec)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>mysql> select * from jan_isolation_test;</span></span>
<span class="line"><span>+----+-------+------+</span></span>
<span class="line"><span>| id | name  | age  |</span></span>
<span class="line"><span>+----+-------+------+</span></span>
<span class="line"><span>|  1 | jan_1 |   21 |</span></span>
<span class="line"><span>|  2 | jan_2 |   22 |</span></span>
<span class="line"><span>+----+-------+------+</span></span>
<span class="line"><span>2 rows in set (0.00 sec)</span></span></code></pre>
</div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span># session 1</span></span>
<span class="line"><span>mysql> begin;</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>mysql> select * from jan_isolation_test;</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 2</span></span>
<span class="line"><span>mysql> begin;</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 2</span></span>
<span class="line"><span>mysql> insert into jan_isolation_test values(3,'jan_3',23);</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 2</span></span>
<span class="line"><span>mysql> commit;</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>mysql> select * from jan_isolation_test;</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>mysql> update jan_isolation_test set age=55;</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>mysql> commit;</span></span>
<span class="line"><span></span></span>
<span class="line"><span># session 1</span></span>
<span class="line"><span>mysql> select * from jan_isolation_test;</span></span></code></pre>
</div>]]></content:encoded>
            <enclosure url="http://cdn.lifemini.cn/dbblog/20210114/2ea5088487414a6fa0af0a73c4973d5f.png" length="0" type="image/png"/>
        </item>
        <item>
            <title><![CDATA[PaxosËß£ÂÜ≥ÁöÑÈóÆÈ¢ò]]></title>
            <link>https://askaric.com/zh/work/tidb/TiDB-Principle/Paper Reading/PaperPaxos Note.html</link>
            <guid>https://askaric.com/zh/work/tidb/TiDB-Principle/Paper Reading/PaperPaxos Note.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[PaxosÁÆóÊ≥ïÂ∏∏Ë¢´ÂºïÁî®‰∫éÂàÜÂ∏ÉÂºèÁõ∏ÂÖ≥ÊñáÁ´†ÔºåÂÄüÂä©ÈíàÂØπÂ∏åËÖäÂüéÈÇ¶ËÆÆ‰ºöÁ´ãÊ≥ïÁöÑÂú∫ÊôØÔºå‰∏ªË¶ÅÊé¢ËÆ®Âú®‰∫∫Âëò‰∏çÊñ≠ÂèòÂåñÁ≠â‰∏çÁ°ÆÂÆöÊÄßÂõ†Á¥†ÁöÑÂâçÊèê‰∏ãÂ¶Ç‰ΩïÂü∫‰∫é‰∏ÄÂÆöÁöÑËßÑÂàôËææÊàêÂÖ±ËØÜÊñπÊ≥ï„ÄÇ‰ΩúËÄÖÂÄüÁî®ÂØπÂú∫ÊôØÁöÑÊé¢ËÆ®ÈöêÂñªÂàÜÂ∏ÉÂºèËÆ°ÁÆóÊú∫Á≥ªÁªüÁöÑËß£ÂÜ≥ÂäûÊ≥ïÔºå]]></description>
            <content:encoded><![CDATA[<h3 id="paxosËß£ÂÜ≥ÁöÑÈóÆÈ¢ò" tabindex="-1">PaxosËß£ÂÜ≥ÁöÑÈóÆÈ¢ò <a class="header-anchor" href="#paxosËß£ÂÜ≥ÁöÑÈóÆÈ¢ò" aria-label="Permalink to &quot;PaxosËß£ÂÜ≥ÁöÑÈóÆÈ¢ò&quot;"></a></h3>
<p>PaxosÁÆóÊ≥ïÂ∏∏Ë¢´ÂºïÁî®‰∫éÂàÜÂ∏ÉÂºèÁõ∏ÂÖ≥ÊñáÁ´†ÔºåÂÄüÂä©ÈíàÂØπÂ∏åËÖäÂüéÈÇ¶ËÆÆ‰ºöÁ´ãÊ≥ïÁöÑÂú∫ÊôØÔºå‰∏ªË¶ÅÊé¢ËÆ®Âú®‰∫∫Âëò‰∏çÊñ≠ÂèòÂåñÁ≠â‰∏çÁ°ÆÂÆöÊÄßÂõ†Á¥†ÁöÑÂâçÊèê‰∏ãÂ¶Ç‰ΩïÂü∫‰∫é‰∏ÄÂÆöÁöÑËßÑÂàôËææÊàêÂÖ±ËØÜÊñπÊ≥ï„ÄÇ‰ΩúËÄÖÂÄüÁî®ÂØπÂú∫ÊôØÁöÑÊé¢ËÆ®ÈöêÂñªÂàÜÂ∏ÉÂºèËÆ°ÁÆóÊú∫Á≥ªÁªüÁöÑËß£ÂÜ≥ÂäûÊ≥ïÔºå‰ª•ËæÉÊòì‰∫éÁêÜËß£ÁöÑÂΩ¢ÂºèÈòêËø∞„ÄÅÂπ∂È™åËØÅ‰∫ÜËØ•ÁÆóÊ≥ïÁöÑÊ≠£Á°ÆÊÄß„ÄÇ</p>
<h3 id="„Ääpaxos-made-simple„ÄãÁÆÄËø∞" tabindex="-1">„ÄäPaxos Made Simple„ÄãÁÆÄËø∞ <a class="header-anchor" href="#„Ääpaxos-made-simple„ÄãÁÆÄËø∞" aria-label="Permalink to &quot;„ÄäPaxos Made Simple„ÄãÁÆÄËø∞&quot;"></a></h3>
<ul>
<li><strong>ÊñáÁ´†Áî±Êù•</strong></li>
</ul>
<p>PaxosÁÆóÊ≥ïÁöÑPaperÂéüÊñá‰∏∫„ÄäThe Part-Time Parliament„ÄãÔºå‰ΩÜÂõ†‰ΩúËÄÖlamportÈááÁî®ÈöêÂñªÁöÑÊñπÂºèË°®ËææÂèäÁÆóÊ≥ïÊú¨Ë∫´ÁöÑÂ§çÊùÇÊÄßÔºå‰ΩøÂæóËØ•ÁÆóÊ≥ïÈöæ‰ª•Ë¢´Â≠¶‰π†ËÄÖÊé•Âèó„ÄÇÂõ†Ê≠§Ôºå‰ΩúËÄÖÊé®Âá∫‰∫Ü„ÄäPaxos Made Simple„ÄãÂ∏ÆÂä©Â≠¶‰π†ËÄÖ‰ª¨ÁêÜËß£ÂíåÂ≠¶‰π†ÊîπÁÆóÊ≥ï„ÄÇ</p>
<ul>
<li><strong>ÊñáÁ´†ÁªìÊûÑ</strong></li>
</ul>
<p>„ÄäPaxos Made Simple„ÄãÊñáÁ´†Â§ßËá¥ÂàÜ‰∏∫Introduction„ÄÅThe Consensus Algorithm„ÄÅThe Implementation‰∏â‰∏™ÈÉ®ÂàÜÔºå‰∏ÄËá¥ÊÄßÁÆóÊ≥ïÈÉ®ÂàÜÂèØË∞ì‰∏≠ÈáçÂ∑•‰πãÈáç„ÄÇËØ•ÈÉ®ÂàÜÔºå‰∏ªË¶ÅËÆ≤Ëß£‰∫ÜÂ≠òÂú®ÁöÑÈóÆÈ¢ò„ÄÅ‰º†Êí≠Ë¢´promiseÁöÑÂÄºÔºåÂ§ÑÁêÜ„ÄÅÂÖ∑‰ΩìÁöÑÂÆûÁé∞„ÄÇ</p>
<ul>
<li><strong>ÊãúÂç†Â∫≠ÂÆπÈîôÂÖ±ËØÜÁÆóÊ≥ïÁöÑ‰∏§‰∏™ÊåáÊ†á</strong></li>
</ul>
<p>ÂÆâÂÖ®ÊÄß(safety)Ôºösafety means nothing bad happens.
ÔºàÂÆâÂÖ®ÊÄßÊÑèÂë≥ÁùÄÂ§öÁä∂ÊÄÅÊú∫ÁöÑÊúÄÁªà‰∏ÄËá¥ÊÄß„ÄÇÔºâ
Ê¥ªÊÄß(liveness)Ôºöliveness means that something good eventually happens.
ÔºàÊ¥ªÊÄßÊÑèÂë≥ÁùÄmessageÂèØ‰ª•Âª∂ËøüÂà∞ËææÔºå‰ΩÜÁªù‰∏çËÉΩ‰∏¢Â§±„ÄÇÔºâ</p>
<p>‰∏∫Á°Æ‰øùÂÆâÂÖ®ÊÄßÔºåËøòÈúÄÊª°Ë∂≥Â¶Ç‰∏ãË¶ÅÊ±ÇÔºö
Ôºà1Ôºâ ÊØèÊ¨°proposeÔºå‰ªÖ1‰∏™ÂÄºË¢´proposeÔºõ
Ôºà2Ôºâ ÊØèÊ¨°proposeÔºå‰ªÖ1‰∏™ÂÄºË¢´promiseÔºõ
Ôºà3Ôºâ ÊØèÊ¨°proposeÔºåËøõÁ®ã‰ªé‰∏çpromiseÊØîËá™Â∑±Â∞èÁöÑÂÄºÔºåÈô§ÈùûÁ≠â‰∫éËá™Â∑±ÁöÑÂÄºÔºõ</p>
<p>‰∏∫Á°Æ‰øùÊ¥ªÊÄßÔºåËøòÈúÄÊª°Ë∂≥Â¶Ç‰∏ãË¶ÅÊ±ÇÔºö</p>
<p>2312312312312</p>
<p>‰ΩúËÄÖÁêÜËÆ∫ÁöÑÂâçÊèêÊòØÔºå‰∏çÂá∫Áé∞ÊãúÂç†Â∫≠ÂÆπÈîôËØØÔºåÊó¢Ôºö‰∏ç‰∏¢Â§±Ê¥ªÊÄßÔºõ</p>
<ul>
<li><strong>ProposalÁöÑËøáÁ®ã</strong></li>
</ul>
<p>P1Êù°‰ª∂ÔºöacceptorÂøÖÈ°ªÊé•ÂèóÁ¨¨‰∏ÄÊ¨°Ë¢´proposeÁöÑÂÄºÔºõ</p>
<p>P2Êù°‰ª∂ÔºöÂ¶ÇÊûúaccepterÂ∑≤promiseËøáÁöÑvalueÔºåÈÇ£‰∏™Ë¢´promiseÁöÑÊõ¥Â§ßnumberÁöÑproposalÊê∫Â∏¶ÁöÑvalueÊòØÂêå‰∏Ä‰∏™„ÄÇ</p>
<p>P2aÊù°‰ª∂ÔºöÂ¶ÇÊûúaccepterÂ∑≤promiseËøáÁöÑvalueÔºåÈÇ£‰∏™Ë¢´promiseÁöÑÊõ¥Â§ßnumberÁöÑproposalÊê∫Â∏¶ÁöÑvalueÊòØÂêå‰∏Ä‰∏™Ôºå‰∏îË¢´ÊâÄÊúâacceptorÊâÄpromise„ÄÇÔºàÂú®Êª°Ë∂≥P1ÂíåP2ÁöÑÂâçÊèê‰∏ãÊé®ÂØºÂá∫P2aÔºâ</p>
<p>P2bÊù°‰ª∂ÔºöÂ¶ÇÊûúaccepterÂ∑≤promiseËøáÁöÑvalueÔºåÈÇ£‰∏™Ë¢´promiseÁöÑÊõ¥Â§ßnumberÁöÑproposalÊê∫Â∏¶ÁöÑvalueÊòØÂêå‰∏Ä‰∏™Ôºåproposer‰∏ç‰ºöÂèëÈÄÅÊØîÂΩìÂâçnumberÂ∞èÁöÑproposal„ÄÇÔºàÂú®Êó¢Êª°Ë∂≥ËøõÂ±ïÊÄßÔºåÂèàÊª°Ë∂≥P1Êù°‰ª∂ÁöÑÂâçÊèêÊó∂Ôºå‰ºöÂá∫Áé∞Ê¥ªÈîÅÈóÆÈ¢òËøùËÉåP2aÊù°‰ª∂ÔºåÈÄöËøáÂ¢ûÂº∫P2aÁöÑÊñπÂºèËß£ÂÜ≥Ëß£ÂÜ≥„ÄÇÔºâ</p>
<p>P2cÊù°‰ª∂ÔºöÂØπ‰∫é‰ªªÊÑèÁöÑvÂíånÔºåÂ¶ÇÊûúÊúâvalue‰∏∫v‰∏înumber‰∏∫nÁöÑproposalË¢´ÂàÜÂèëÔºåÂõ†‰∏∫acceptorÊòØÊâÄÊúâacceptor‰∏≠ÁöÑÂ§ßÂ§öÊï∞ÔºàÁÆÄÁß∞ÔºöSÔºâÔºåÂàôÂèØÊé®Êñ≠Âá∫ÂΩìÂâçÁöÑS‰∏≠ÁöÑvaluesÂÄºÔºåË¶Å‰πàÊ≤°ÊúâpromiseËøá‰ªª‰ΩïÂ∞è‰∫énÁöÑvalueÔºåË¶Å‰πàÂΩìÂâçSÊâÄpromiseËøáÁöÑÊòØproposal‰∏≠ÁöÑÊúÄÂ§ßnumberÊâÄÊê∫Â∏¶ÁöÑÂÄº„ÄÇ</p>
<p><strong>Ê≠§Â§ÑË¶ÅÊèíÂÖ•Êó∂Â∫èÂõæ</strong></p>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>Phase 1. (a) A proposer selects a proposal number n and sends a prepare</span></span>
<span class="line"><span>request with number n to a majority of acceptors.</span></span>
<span class="line"><span>(b) If an acceptor receives a prepare request with number n greater</span></span>
<span class="line"><span>than that of any prepare request to which it has already responded,</span></span>
<span class="line"><span>then it responds to the request with a promise not to accept any more</span></span>
<span class="line"><span>proposals numbered less than n and with the highest-numbered proposal (if any) that it has accepted.</span></span>
<span class="line"><span>5</span></span>
<span class="line"><span>Phase 2. (a) If the proposer receives a response to its prepare requests</span></span>
<span class="line"><span>(numbered n) from a majority of acceptors, then it sends an accept</span></span>
<span class="line"><span>request to each of those acceptors for a proposal numbered n with a</span></span>
<span class="line"><span>value v, where v is the value of the highest-numbered proposal among</span></span>
<span class="line"><span>the responses, or is any value if the responses reported no proposals.</span></span>
<span class="line"><span>(b) If an acceptor receives an accept request for a proposal numbered</span></span>
<span class="line"><span>n, it accepts the proposal unless it has already responded to a prepare</span></span>
<span class="line"><span>request having a number greater than n.</span></span></code></pre>
</div><h3 id="Ê¥ªÈîÅÈóÆÈ¢òÁêÜËß£‰∏éÂ§ÑÁêÜ" tabindex="-1">Ê¥ªÈîÅÈóÆÈ¢òÁêÜËß£‰∏éÂ§ÑÁêÜ <a class="header-anchor" href="#Ê¥ªÈîÅÈóÆÈ¢òÁêÜËß£‰∏éÂ§ÑÁêÜ" aria-label="Permalink to &quot;Ê¥ªÈîÅÈóÆÈ¢òÁêÜËß£‰∏éÂ§ÑÁêÜ&quot;"></a></h3>
<h3 id="„Ääthe-part-time-parliament„ÄãÁÆÄËø∞" tabindex="-1">„ÄäThe Part-Time Parliament„ÄãÁÆÄËø∞ <a class="header-anchor" href="#„Ääthe-part-time-parliament„ÄãÁÆÄËø∞" aria-label="Permalink to &quot;„ÄäThe Part-Time Parliament„ÄãÁÆÄËø∞&quot;"></a></h3>
<h3 id="ÂèÇËÄÉÊñáÁ´†" tabindex="-1">ÂèÇËÄÉÊñáÁ´† <a class="header-anchor" href="#ÂèÇËÄÉÊñáÁ´†" aria-label="Permalink to &quot;ÂèÇËÄÉÊñáÁ´†&quot;"></a></h3>
<p><a href="http://lamport.azurewebsites.net/pubs/pubs.html" target="_blank" rel="noreferrer"><em><strong>Leslie LamportÂçöÂÆ¢</strong></em></a>
<a href="https://courses.cs.washington.edu/courses/csep590/04wi/papers/lamport-part-time-parliament.pdf" target="_blank" rel="noreferrer"><em><strong>The Part-Time ParliamentÂéüÊñá</strong></em></a>
<a href="https://lamport.azurewebsites.net/pubs/paxos-simple.pdf" target="_blank" rel="noreferrer"><em><strong>Paxos Made SimpleÂéüÊñá</strong></em></a>
<a href="https://www.cnblogs.com/hzmark/p/The_Part-Time_Parliament.html" target="_blank" rel="noreferrer"><em><strong>The Part-Time ParliamentËØëÊñá</strong></em></a>
<a href="https://www.jianshu.com/p/67dd80555ba2" target="_blank" rel="noreferrer"><em><strong>Re-visiting of Paxos Made SimpleËØëÊñá</strong></em></a>
<a href="https://www.jianshu.com/p/21785016f412" target="_blank" rel="noreferrer"><em><strong>ÁÆÄ‰π¶-Â≠ôÂ¶ÇÁªøÂè∂ÁöÑÊãúÂç†Â∫≠ÁÆóÊ≥ïÁêÜËß£</strong></em></a>
<a href="https://zhuanlan.zhihu.com/p/111304281" target="_blank" rel="noreferrer"><em><strong>Áü•‰πé-ÊΩáÊπòÂ§úÈõ®ÁêÜËß£‰∏§Èò∂ÊÆµÊèê‰∫§</strong></em></a>
<a href="https://zhuanlan.zhihu.com/p/91288179" target="_blank" rel="noreferrer"><em><strong>Áü•‰πé-ÁâõÂêÉËçâraftÂçèËÆÆÁêÜËß£</strong></em></a>
<a href="http://blog.itpub.net/9683969/viewspace-672920/" target="_blank" rel="noreferrer"><em><strong>itpub-OracleË°åÈîÅÂèämvccÂÆûÁé∞ÂéüÁêÜ</strong></em></a>
<a href="https://zhuanlan.zhihu.com/p/31727291" target="_blank" rel="noreferrer"><em><strong>Áü•‰πé-Á••ÂÖâÁöÑÊñáÁ´†(1)Paxos„ÄÅRaftÂàÜÂ∏ÉÂºè‰∏ÄËá¥ÊÄßÁÆóÊ≥ïÂ∫îÁî®Âú∫ÊôØ</strong></em></a>
<a href="https://zhuanlan.zhihu.com/p/31780743" target="_blank" rel="noreferrer"><em><strong>Áü•‰πé-Á••ÂÖâÁöÑÊñáÁ´†(2)PaxosÁÆóÊ≥ïËØ¶Ëß£</strong></em></a>
<a href="https://www.cnblogs.com/hzmark/p/The_Part-Time_Parliament.html" target="_blank" rel="noreferrer"><em><strong>ÂçöÂÆ¢Âõ≠-Êù≠Â∑û.MarkÁöÑÊñáÁ´†</strong></em></a></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Percolator ÂàÜÂ∏ÉÂºè‰∫ãÂä°]]></title>
            <link>https://askaric.com/zh/work/tidb/TiDB-Principle/Paper Reading/Percolator Transaction.html</link>
            <guid>https://askaric.com/zh/work/tidb/TiDB-Principle/Paper Reading/Percolator Transaction.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[‰∏Ä„ÄÅËÆ∫ÊñáÊëòË¶Å

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Google ‰ª•ÂæÄ‰æùÈù†Á¶ªÁ∫øËÆ°ÁÆóÁöÑ ‚ÄúÁΩëÈ°µÁ¥¢ÂºïÊúçÂä°‚Äù Â≠òÂú®Â§ÑÁêÜÊó∂Âª∂ÈóÆÈ¢òÔºåÂΩìÊñ∞ÁöÑÊñáÊ°£Á¥¢Âºï]]></description>
            <content:encoded><![CDATA[<h1 id="percolator-ÂàÜÂ∏ÉÂºè‰∫ãÂä°" tabindex="-1">Percolator ÂàÜÂ∏ÉÂºè‰∫ãÂä° <a class="header-anchor" href="#percolator-ÂàÜÂ∏ÉÂºè‰∫ãÂä°" aria-label="Permalink to &quot;Percolator ÂàÜÂ∏ÉÂºè‰∫ãÂä°&quot;"></a></h1>
<h2 id="‰∏Ä„ÄÅËÆ∫ÊñáÊëòË¶Å" tabindex="-1">‰∏Ä„ÄÅËÆ∫ÊñáÊëòË¶Å <a class="header-anchor" href="#‰∏Ä„ÄÅËÆ∫ÊñáÊëòË¶Å" aria-label="Permalink to &quot;‰∏Ä„ÄÅËÆ∫ÊñáÊëòË¶Å&quot;"></a></h2>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Google ‰ª•ÂæÄ‰æùÈù†Á¶ªÁ∫øËÆ°ÁÆóÁöÑ ‚ÄúÁΩëÈ°µÁ¥¢ÂºïÊúçÂä°‚Äù Â≠òÂú®Â§ÑÁêÜÊó∂Âª∂ÈóÆÈ¢òÔºåÂΩìÊñ∞ÁöÑÊñáÊ°£Á¥¢ÂºïÁü©ÈòµÊõ¥Êñ∞ÂêéÔºåÈúÄË¶Å MapReduce Âíå Batch ÊâπÂ§ÑÁêÜËÆ°ÁÆóÊñ∞ÁöÑÁªìÊûú„ÄÇ‰ΩøÁî® Percolator ÁªÑ‰ª∂ÊõøÊç¢Âü∫‰∫é batch Á¶ªÁ∫øÂ§ÑÁêÜ‰ΩìÁ≥ªÔºåÊØèÂ§©Áõ∏ÂêåÂ§ÑÁêÜÊñáÊ°£ÈáèÂâçÊèê‰∏ãÔºåÂπ≥ÂùáÊñáÊ°£Âπ¥ÈæÑÈôç‰Ωé 50%Ôºå‰∏ªË¶ÅÂéüÂõ†‰æøÊòØ Percolator ÁöÑÂ¢ûÈáèÂàÜÂ∏ÉÂºè‰∫ãÂä°Â§ÑÁêÜÊ®°Âûã„ÄÇ</p>
<figure><img src="./Theory-PercolatorÂàÜÂ∏ÉÂºè‰∫ãÂä°/Percolator_overview.svg" alt="03" tabindex="0"><figcaption>03</figcaption></figure>
<p><strong>‰ºòÁÇπÔºö</strong></p>
<ol>
<li>Â¢ûÈáèÂ§ÑÁêÜÔºåÁî®Â∏¶ Timestamp Oracle ÁöÑÁ±ª Mvcc Êú∫Âà∂ÂÆûÁé∞Êï∞ÊçÆÁâàÊú¨ÈöîÁ¶ªÔºõ</li>
<li>È´òÂÆπÈáèÊâ©Â±ïÔºåTSO Êú∫Âà∂ÂíåÂª∂ËøüÊ∏ÖÈîÅÊú∫Âà∂ÔºåÂÖÅËÆ∏ÈõÜÁæ§Êâ©Â±ïËá≥‰∏äÂçÉÂè∞Êú∫Âô®Ôºõ</li>
</ol>
<p><strong>Áº∫ÁÇπÔºö</strong></p>
<ol>
<li>Âª∂Êó∂È´òÔºåÁº∫‰πèÂÖ®Â±ÄÊ≠ªÈîÅÊé¢ÊµãÂô®ÂíåÂÖ®Â±Ä‰∫ãÂä°ÁÆ°ÁêÜÂô®Ôºå‰ºöÂ¢ûÂ§ß‰∫ãÂä°ÂÜ≤Á™ÅÂíåÂª∂Êó∂Ôºõ</li>
</ol>
<h2 id="‰∫å„ÄÅÊ®°ÂûãËÆæËÆ°Ëß£Êûê" tabindex="-1">‰∫å„ÄÅÊ®°ÂûãËÆæËÆ°Ëß£Êûê <a class="header-anchor" href="#‰∫å„ÄÅÊ®°ÂûãËÆæËÆ°Ëß£Êûê" aria-label="Permalink to &quot;‰∫å„ÄÅÊ®°ÂûãËÆæËÆ°Ëß£Êûê&quot;"></a></h2>
<h3 id="_2-1-Âπ∂ÂèëÊ≠£Á°ÆÊÄßÊéßÂà∂" tabindex="-1">2.1 Âπ∂ÂèëÊ≠£Á°ÆÊÄßÊéßÂà∂ <a class="header-anchor" href="#_2-1-Âπ∂ÂèëÊ≠£Á°ÆÊÄßÊéßÂà∂" aria-label="Permalink to &quot;2.1 Âπ∂ÂèëÊ≠£Á°ÆÊÄßÊéßÂà∂&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÂéüÊúâÁöÑ MapReduce Á¶ªÁ∫øËÆ°ÁÆóÊú∫Âà∂Ëá™Âä®ÈôêÂà∂Âπ∂ÂèëÈ°∫Â∫èÔºåÂΩìÂàáÊç¢Âà∞ Percolator ÊéßÂà∂Âπ∂ÂèëÊó∂Ôºå‰æøÊ∂âÂèäÊéßÂà∂Âπ∂ÂèëËÆ°ÁÆóÁöÑÁªìÊûúÊ≠£Á°ÆÊÄß„ÄÇÁªèÂÖ∏‰æãÂ≠êÔºöPageRank ÁÆóÊ≥ï‰ºòÂåñ Google ÁΩëÈ°µÁ¥¢ÂºïÈáçË¶ÅÊÄßÊúçÂä°‰∏≠ÁöÑÂπ∂ÂèëÊéßÂà∂ÔºåÂá∫‰∫éÁÆÄËø∞ÂéüÁêÜÁõÆÁöÑ‰æø‰∏çËµòËø∞ÔºåËØ¶Ëß£ÂèØÈòÖËØª <a href="https://zhuanlan.zhihu.com/p/197877312" target="_blank" rel="noreferrer">Áü•‰πéÊñáÁ´†</a>„ÄÇ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‰∏ã‰æãÁÆÄËø∞‰∏ÄÈúÄÂπ∂ÂèëÊéßÂà∂Âú∫ÊôØÔºåÂΩìÁà¨Ëô´Áà¨ÂèñÊñ∞ÁöÑÁΩëÈ°µÂà∞Â≠òÂÇ®Â∫ì‰∏≠ÔºåÈúÄË¶Å‰æùÊñ∞Êï∞ÊçÆËÆ°ÁÆóÊñ∞Á¥¢ÂºïÈ°µÈù¢ÈáçË¶ÅÊÄßÊó∂ÔºåÊñ∞ÊóßÊ®°ÂûãÂ∑ÆÂºÇÂ¶Ç‰∏ãÔºö</p>
<ol>
<li>ÂéüÁ¶ªÁ∫øÊ®°Âûã‰ΩøÁî® MapReduce Â≠ê‰ªªÂä° Reduce ‰∏çËÆ°ÁÆóÊàêÂäüÔºåÊÄª‰ªªÂä° Map ‰æøÊó†Ê≥ïÊ±áÊÄªËÆ°ÁÆóÔºåÂ§©ÁîüÂèØÁ°Æ‰øùËÆ°ÁÆóÈ°∫Â∫è„ÄÇ</li>
<li>Êñ∞Â¢ûÈáèÂ§ÑÁêÜÊ®°Âûã Percolator ‰æøÊúâ‰∫ÜÊéßÂà∂‰∏çÂêåÊó∂Èó¥ËÆ°ÁÆóÁªìÊûúÁöÑÈúÄÊ±ÇÔºåPercolator ÈúÄË¶ÅÁâàÊú¨ÊéßÂà∂ÁâπÊÄßÁ°Æ‰øùÊï∞ÊçÆËÆ°ÁÆóÊ≠£Á°Æ„ÄÇ</li>
</ol>
<figure><img src="./Theory-PercolatorÂàÜÂ∏ÉÂºè‰∫ãÂä°/PageRank.svg" alt="02" tabindex="0"><figcaption>02</figcaption></figure>
<h3 id="_2-2-percolator-ÁªÑ‰ª∂‰ΩúÁî®" tabindex="-1">2.2 Percolator ÁªÑ‰ª∂‰ΩúÁî® <a class="header-anchor" href="#_2-2-percolator-ÁªÑ‰ª∂‰ΩúÁî®" aria-label="Permalink to &quot;2.2 Percolator ÁªÑ‰ª∂‰ΩúÁî®&quot;"></a></h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Percolator ÈÄöËøá ACID Transaction „ÄÅ observers „ÄÅtimestamp oracle„ÄÅlightweight lock Âõõ‰∏™ÊäΩË±°Ëß£ÂÜ≥ÂàÜÂ∏ÉÂºè‰∫ãÂä°‰∏≠ÈÅáÂà∞ÁöÑ <strong>Ê≠£Á°ÆÊÄßÈóÆÈ¢ò„ÄÅÊÄßËÉΩÈóÆÈ¢ò</strong>„ÄÇÁªÑ‰ª∂Èó¥ÊâßÊµÅÂÖ•Â§ßËá¥Â¶Ç‰∏ãÔºö</p>
<ol>
<li>Observers ÈìæÊé• Percolator worker Âπ∂ÂèëÈÄÅ Notification ‰ø°ÊÅØÔºåÂèëËµ∑ Job Ë∞ÉÁî®Ôºõ</li>
<li>Percolator Workers ÂèëËµ∑‰∫ãÂä°ÔºåÂèëÈÄÅËØªÂÜô RPC Ê∂àÊÅØÁªô Bigtable tablet serversÔºõ</li>
<li>Bigtable tablet servers ÂèëÈÄÅËØªÂÜô RPC Ê∂àÊÅØÁªô GFS chunkserversÔºõ</li>
<li>TSOÔºàtimestamp oracleÔºâ Êèê‰æõ‰∏•Ê†ºÁöÑÊõæÈáèÊó∂Èó¥Êà≥ÔºåÁ°Æ‰øùÂø´ÁÖßÈöîÁ¶ª‰∏ÄËá¥ÊÄßÔºõ</li>
<li>Percolator Workers ‰ΩøÁî® lightweight lock ‰ΩøÊêúÁ¥¢Ë¢´‰øÆÊîπËøáÁöÑËÑèÊï∞ÊçÆÊõ¥È´òÊïà„ÄÇ</li>
</ol>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>ACID Transaction</strong> ÔºöPercolator Êèê‰æõÂ¶Ç‰º†ÁªüÊï∞ÊçÆÂ∫ì‰ΩøÁî®ÁöÑ ACID ‰∫ãÂä°Ê®°ÂûãÔºåÁ°Æ‰øùÊé®Êñ≠Â≠òÂÇ®Â∫ìÊó∂Èó¥Áä∂ÊÄÅÔºåÁ°Æ‰øùËÆ°ÁÆóÊ≠£Á°ÆÊÄß„ÄÇ</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>observers</strong> ÔºöPercolator Êèê‰æõ observers ÂÆåÊàêÁ±ª‰ºº Job ÂäüËÉΩË∞ÉÁî®ÁöÑÁ≥ªÁªü‰ª£Á†ÅÊÆµÔºåÊØè‰∏™ËßÇÂØüËÄÖÂÆåÊàê‰∏Ä‰∏™‰ªªÂä°ÔºåÂπ∂ÈÄöËøáÂêëË°®‰∏≠ÂÜôÂÖ•ÂÜÖÂÆπ‰∏∫ ‚Äú‰∏ãÊ∏∏‚Äù ËßÇÂØüËÄÖÂàõÂª∫Êõ¥Â§öÁöÑÂ∑•‰Ωú„ÄÇ</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>timestamp oracle</strong> ÔºöPercolator Êèê‰æõ TSO ÊúçÂä°Âô®Ôºå‰∏•Ê†ºÈÄíÂ¢ûÁöÑÈ°∫Â∫èÂàÜÂèëÊó∂Èó¥Êà≥ÔºåÂ∞ÜÊúÄÂ§ßÁöÑÊó∂Èó¥Êà≥ÂÜôÂÖ•Á®≥ÂÆöÂ≠òÂÇ®Ôºå‰ªéÂÜÖÂ≠ò‰∏≠Âë®ÊúüÊÄßÂú∞ÂàÜÈÖç‰∏Ä‰∏™Êó∂Èó¥Êà≥ËåÉÂõ¥Êª°Ë∂≥Êú™Êù•ÁöÑËØ∑Ê±Ç„ÄÇÂ¶ÇÊûúoracleÈáçÊñ∞ÂêØÂä®ÔºåÊó∂Èó¥Êà≥Â∞ÜÂêëÂâçË∑≥ËΩ¨Âà∞ÊâÄÂàÜÈÖçÁöÑÊúÄÂ§ßÊó∂Èó¥Êà≥(‰ΩÜÊ∞∏Ëøú‰∏ç‰ºöÂêëÂêé)„ÄÇ</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>lightweight lock</strong> ÔºöPercolator Êèê‰æõ ‚ÄúËΩªÈáèÈîÅ‚Äù Êú∫Âà∂Á°Æ‰øù‰∏äÂçÉÂè∞Êú∫Âô®Áõ∏ËøëÊó∂Èó¥ÁÇπÁöÑÂπ∂ÂèëËÆøÈóÆÔºåÊØè‰∏™ËØªÊìç‰ΩúÈô§Ëé∑ÂèñÊï∞ÊçÆÂ§ñÔºåËøò‰ºöÂä†ËØªÈîÅÂπ∂ÂÜôÂÖ• BigTable ÂÜÖÂ≠òÂàó‰∏≠ÊåÅ‰πÖÊï∞ÊçÆÂ≠òÂÇ®„ÄÇGet() Êìç‰ΩúÈ¶ñÂÖàÊ£ÄÊü• 0ÔΩûtimestamp Êó∂Èó¥ËåÉÂõ¥ÂÜÖÁöÑÈîÅÔºåÂ¶ÇÊûúÈîÅÂ≠òÂú®ÂÖ∂‰ªñ txn Ê≠£Âú®Âπ∂ÂèëÂÜôÊ≠§Â§ÑÁêÜÂçïÂÖÉ,‰ºöÁ≠âÂæÖÂà∞ÈáäÊîæ„ÄÇÂ¶ÇÊûúÊó†ÈîÅÂÜ≤Á™ÅÔºåGet() Ëé∑ÂèñÊúÄÊñ∞ Start Timestamp ÔºåÂπ∂‰∏îËøîÂõûÂÜôÁöÑËÆ∞ÂΩïË°å„ÄÇ</p>
<figure><img src="./Theory-PercolatorÂàÜÂ∏ÉÂºè‰∫ãÂä°/Percolator_architect.svg" alt="03" tabindex="0"><figcaption>03</figcaption></figure>
<h3 id="_2-3-mvcc-‰∏é-write-skew" tabindex="-1">2.3 MVCC ‰∏é Write Skew <a class="header-anchor" href="#_2-3-mvcc-‰∏é-write-skew" aria-label="Permalink to &quot;2.3 MVCC ‰∏é Write Skew&quot;"></a></h3>
<h4 id="_2-3-1-Âø´ÁÖßÈöîÁ¶ªÂèØËßÅÊÄß" tabindex="-1">2.3.1 Âø´ÁÖßÈöîÁ¶ªÂèØËßÅÊÄß <a class="header-anchor" href="#_2-3-1-Âø´ÁÖßÈöîÁ¶ªÂèØËßÅÊÄß" aria-label="Permalink to &quot;2.3.1 Âø´ÁÖßÈöîÁ¶ªÂèØËßÅÊÄß&quot;"></a></h4>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Âø´ÁÖßÈöîÁ¶ªÁ∫ßÂà´‰ª• start timestamp ‰∏∫‰∫ãÂä°ËØªËµ∑ÁÇπÔºå‰ª• commit timestamp ‰∏∫‰∫ãÂä°ÁªàÁÇπ„ÄÇ‰∏éÂèØÂ∫èÂàóÂåñÂçèËÆÆÁõ∏ÊØîÔºåÂø´ÁÖßÈöîÁ¶ªÁöÑ‰∏ªË¶Å‰ºòÁÇπÊòØËØªÂèñÊïàÁéáÊõ¥È´ò„ÄÇÂõ†‰∏∫‰ªª‰ΩïÊó∂Èó¥Êà≥ÈÉΩ‰ª£Ë°®‰∏ÄËá¥ÁöÑÂø´ÁÖßÔºåÊâÄ‰ª•ËØªÂèñÂçïÂÖÉÊ†ºÂè™ÈúÄË¶ÅÂú®ÁªôÂÆöÁöÑÊó∂Èó¥Êà≥ÊâßË°å Bigtable Êü•Êâæ‰æøÂèØÔºåÊü•ËØ¢ÈîÅÊòØ‰∏çÂøÖË¶ÅÁöÑ„ÄÇ</p>
<ol>
<li>txn 2 Âú® txn 1 ÂêéÂºÄÂêØÔºåÂ¶ÇÊûú txn 2 ‰∏ç commit Âàô‰∏ç‰ºöÁúãÂà∞ txn1 ÂÜôÁöÑÊï∞ÊçÆÔºõ</li>
<li>txn 1 Âíå txn 2 Âπ∂Ë°åÊâßË°åÔºåÂ¶ÇÊûúÂ≠òÂú®Áõ∏ÂêåÂøÖ‰ºöÊúâÂÖ∂‰∏≠‰∏Ä‰∏™ txn ÊâßË°åÂ§±Ë¥•Ôºõ</li>
<li>txn 3 Âç≥‰ºöÁúãÂà∞ txn 1 ,‰πü‰ºöÁúãÂà∞ txn 2Ôºõ</li>
</ol>
<figure><img src="./Theory-PercolatorÂàÜÂ∏ÉÂºè‰∫ãÂä°/isolation_tso.svg" alt="" tabindex="0"><figcaption></figcaption></figure>
<h4 id="_2-3-2-Âø´ÁÖßÈöîÁ¶ªÂÜôÂÄæÊñú" tabindex="-1">2.3.2 Âø´ÁÖßÈöîÁ¶ªÂÜôÂÄæÊñú <a class="header-anchor" href="#_2-3-2-Âø´ÁÖßÈöîÁ¶ªÂÜôÂÄæÊñú" aria-label="Permalink to &quot;2.3.2 Âø´ÁÖßÈöîÁ¶ªÂÜôÂÄæÊñú&quot;"></a></h4>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Âú∫ÊôØÂÅáËÆæÂ¶Ç‰∏ãÔºö Jan_1 Âíå Jan_2 ÂùáÂÄºÁè≠‰ªäÂ§©ÁöÑ DBNEST Oncall Êó∂Èó¥ÔºåÂπ∂‰∏î Jan_1 Âíå Jan_2 ÂêåÊó∂Êúâ‰∫ãÈúÄË¶ÅÁî≥ËØ∑Ë∞ÉÁè≠ txn „ÄÇ Âπ∂ÂèëËæÉÈ´òÊó∂ÔºåÊûÅÊòì‰∫ßÁîüÊó†‰∫∫ÂÄºÁè≠ÊÉÖÂÜµ„ÄÇÂèØ‰ª•‰ΩøÁî®Ë°åÈîÅÊñπÂºèËß£ÂÜ≥Ôºå‰ΩÜ‰πü‰ºö‰∫ßÁîüÊÄßËÉΩÈôç‰Ωé„ÄÇ</p>
<p><strong>Txn 1 Jan_1:</strong></p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">//</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Êü•ËØ¢ BNEST Oncall ÊúâÂ§öÂ∞ë‰∫∫ÂÄºÁè≠Ôºü</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> COUNT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> oncall_members </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> shift_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 123456</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> AND</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> on_call </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> true;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">//</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ‰∫∫Êï∞ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, Êõ¥Êñ∞Ë∞ÉÁè≠</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">UPDATE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> oncall_members </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">SET</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> on_call </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> false </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">WHERE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> name=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'Jan_1'</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> AND</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> shift_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 123456</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span></code></pre>
</div><p><strong>Txn 2 Jan_2:</strong></p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">//</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> Êü•ËØ¢ BNEST Oncall ÊúâÂ§öÂ∞ë‰∫∫ÂÄºÁè≠Ôºü</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> COUNT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> oncall_members </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> shift_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 123456</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> AND</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> on_call </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> true;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">//</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ‰∫∫Êï∞ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">></span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, Êõ¥Êñ∞Ë∞ÉÁè≠</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">UPDATE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> oncall_members </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">SET</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> on_call </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> false </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">WHERE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> name=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'Jan_2'</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> AND</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> shift_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 123456</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span></code></pre>
</div><h3 id="_2-4-percolator-‰∏§Èò∂ÊÆµÊèê‰∫§" tabindex="-1">2.4 Percolator ‰∏§Èò∂ÊÆµÊèê‰∫§ <a class="header-anchor" href="#_2-4-percolator-‰∏§Èò∂ÊÆµÊèê‰∫§" aria-label="Permalink to &quot;2.4 Percolator ‰∏§Èò∂ÊÆµÊèê‰∫§&quot;"></a></h3>
<h4 id="_2-4-1-È¢ÑÂÜôÂÖ•Èò∂ÊÆµ" tabindex="-1">2.4.1 È¢ÑÂÜôÂÖ•Èò∂ÊÆµ <a class="header-anchor" href="#_2-4-1-È¢ÑÂÜôÂÖ•Èò∂ÊÆµ" aria-label="Permalink to &quot;2.4.1 È¢ÑÂÜôÂÖ•Èò∂ÊÆµ&quot;"></a></h4>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ËØ•Èò∂ÊÆµ‰ºöÈîÅ‰ΩèÂ§ÑÁêÜÂçïÂÖÉ‰∏≠ÊâÄÊúâË°åÔºåÂú®ÂÆ¢Êà∑Á´ØËÆæËÆ°‰∏ªÈîÆÈîÅÔºàÂêéÊñáËØ¶Ëß£ÔºâÔºå‰∫ãÂä°ÈòÖËØªÂÖÉÊï∞ÊçÆ‰ø°ÊÅØÊ£ÄÊü•ÊòØÂê¶Â≠òÂú®Ë°åÂ§ÑÁêÜÂÜ≤Á™ÅÔºåÊúâ 3 ÁßçÂ§ÑÁêÜÊÉÖÂÜµÔºö</p>
<ol>
<li>ÂÜôÂÜôÂÜ≤Á™ÅÔºöÂ¶ÇÊûú txn 1 ÂèëÁé∞ÂÖ∂‰ªñ txn ÁöÑ Start Timestamp Âú® txn 1 ‰πãÂêéÁöÑÈîÅÔºåÂàô‰∫ãÂä°Â¥©Ê∫ÉÂõûÊªöÔºõ</li>
<li>ÈîÅÈáäÊîæÊÖ¢ÔºöÂ¶ÇÊûú txn 1 ÁúãÂà∞ÂÖ∂‰ªñ txn ‰ªª‰Ωï Start Timestamp ÁöÑÈîÅÔºåÂàô‰∫ãÂä°Â¥©Ê∫ÉÂõûÊªöÔºõ</li>
<li>Ê≠£Â∏∏Â§ÑÁêÜÔºöÂ¶ÇÊûú txn 1 Êú™ÂèëÁé∞‰ªª‰ΩïÂÜ≤Á™ÅÔºå‰æø‰ª•Ëá™Â∑±ÁöÑ Start Timestamp ËøõË°åÂÜôÈîÅ„ÄÅÂÜôÊï∞ÊçÆÂ§ÑÁêÜÔºõ</li>
</ol>
<h4 id="_2-4-2-Êèê‰∫§Èò∂ÊÆµ" tabindex="-1">2.4.2 Êèê‰∫§Èò∂ÊÆµ <a class="header-anchor" href="#_2-4-2-Êèê‰∫§Èò∂ÊÆµ" aria-label="Permalink to &quot;2.4.2 Êèê‰∫§Èò∂ÊÆµ&quot;"></a></h4>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Êèê‰∫§Èò∂ÊÆµ‰∏ªË¶ÅÊìç‰ΩúÂ¶Ç‰∏ãÔºö</p>
<ol>
<li>ÂÆ¢Êà∑Á´ØÈ¶ñÂÖàËé∑Âèñ Commit TSO Âπ∂ÈáäÊîæ‰ª•‰∏ªÈîÆ‰∏∫‰∏≠ÂøÉÁöÑÈîÅÔºõ</li>
<li>Â∞ÜÂÜôÂ§ÑÁêÜÂØπÁî®Êà∑ÂèØËßÅÔºåÂÜôËÆ∞ÂΩïÂåÖÂê´‰∏Ä‰∏™ÊåáÈíàÊåáÂêë start Timestamp,‰ª•‰æøÂÖ∂‰ªñ‰∫ãÂä°ÂèØ‰ª•ËÉΩÂ§üÊâæÂà∞ÁúüÂÆûÊï∞ÊçÆÔºõ</li>
</ol>
<h3 id="_2-5-percolator-ÂàÜÂ∏ÉÂºè‰∫ãÂä°" tabindex="-1">2.5 Percolator ÂàÜÂ∏ÉÂºè‰∫ãÂä° <a class="header-anchor" href="#_2-5-percolator-ÂàÜÂ∏ÉÂºè‰∫ãÂä°" aria-label="Permalink to &quot;2.5 Percolator ÂàÜÂ∏ÉÂºè‰∫ãÂä°&quot;"></a></h3>
<h4 id="_2-5-1-ÂàÜÂ∏ÉÂºè‰∫ãÂä°‰∏é‰º†ÁªüÂπ∂Ë°å‰∫ãÂä°ÁöÑ‰∏çÂêå" tabindex="-1">2.5.1 ÂàÜÂ∏ÉÂºè‰∫ãÂä°‰∏é‰º†ÁªüÂπ∂Ë°å‰∫ãÂä°ÁöÑ‰∏çÂêåÔºö <a class="header-anchor" href="#_2-5-1-ÂàÜÂ∏ÉÂºè‰∫ãÂä°‰∏é‰º†ÁªüÂπ∂Ë°å‰∫ãÂä°ÁöÑ‰∏çÂêå" aria-label="Permalink to &quot;2.5.1 ÂàÜÂ∏ÉÂºè‰∫ãÂä°‰∏é‰º†ÁªüÂπ∂Ë°å‰∫ãÂä°ÁöÑ‰∏çÂêåÔºö&quot;"></a></h4>
<ol>
<li>‰º†ÁªüÂπ∂Ë°åÊï∞ÊçÆÂ∫ìËÆøÈóÆ‰ºöË¢´Áªü‰∏Ä‰∫ãÂä°ÁÆ°ÁêÜÂô®ÊéßÂà∂ÈõÜ‰∏≠ÊéßÂà∂ÔºåÁî±‰∫ãÂä°ÁÆ°ÁêÜÂô®ÊéßÂà∂Ëé∑ÂæóËÆøÈóÆÂ≠òÂÇ®Â±ÇÊï∞ÊçÆÁöÑÊùÉÈôêÔºõ</li>
<li>Percolator ‰∏≠ÊâÄÊúâËäÇÁÇπÂùáÁõ¥Êé•Ëé∑ÂèñÊï∞ÊçÆÔºåÊ≤°ÊúâÂæàÂ•ΩÁöÑÊñπÂºèÊà™Êñ≠ËÆøÈóÆÂπ∂ÂØπ‰∫ãÂä°Âä†ÈîÅÔºåÂõ†Ê≠§ÈîÅÂøÖÈ°ªÂú®Êú∫Âô®ÊïÖÈöúÊó∂‰πüÊåÅ‰πÖÂåñÂ≠òÂú®ÔºåÂ¶ÇÊûúÈîÅÂú®‰∏§Èò∂ÊÆµÊèê‰∫§Êó∂Ê∂àÂ§±ÔºåÈÇ£‰πàËØ¥ÊòéÂ∑≤ÁªèÂèëÁîü‰∫ÜÂÜ≤Á™ÅÔºõ</li>
</ol>
<h4 id="_2-5-2-percolator-ÈîÅËÆæËÆ°" tabindex="-1">2.5.2 Percolator ÈîÅËÆæËÆ°: <a class="header-anchor" href="#_2-5-2-percolator-ÈîÅËÆæËÆ°" aria-label="Permalink to &quot;2.5.2 Percolator ÈîÅËÆæËÆ°:&quot;"></a></h4>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‰ªéÈîÅÊ∏ÖÁêÜÊú∫Âà∂ËßíÂ∫¶ÁúãÔºåÈöæÁÇπÂú®‰∫é Percolator ÂèëËµ∑ txn A Ê∏ÖÁêÜ txn B Êó∂ÔºåÂøÖÈ°ªÂà§ÂÆö txn B ÊòØÂê¶ÁúüÁöÑÂ§±Ë¥•„ÄÇ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Percolator ÈíàÂØπ commit „ÄÅcleanup Êìç‰ΩúÔºåÂú®‰∫ãÂä°Â¢ûÂä†ÂçïÂÖÉÊ†ºÊ†áËØÜ‰ΩçÔºå‰πüË¢´Áß∞‰Ωú‰∏ªÈîÆÈîÅ„ÄÇ‰∏çÂêå‰∫ãÂä°ÊúâËá™Â∑±ÁöÑ‰∏ªÈîÆÈîÅÔºåÊâßË°å commit Âíå cleanup Êìç‰ΩúÊòØÊó∂ÔºåË¶Å‰øÆÊîπ‰∏ªÈîÆÈîÅ„ÄÇ</p>
<p><strong>ÈîÅÂÖÉÊï∞ÊçÆÊ†ºÂºè</strong></p>
<table tabindex="0">
<thead>
<tr>
<th>Column</th>
<th>Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>C:lock</td>
<td>Êú™Êèê‰∫§ txn Â∞Ü‰∏ªÈîÆ‰ΩçÁΩÆÂÜôÂÖ•Ê≠§Âàó</td>
</tr>
<tr>
<td>C:write</td>
<td>Â∑≤Êèê‰∫§ txn Â≠òÂÇ®Êï∞ÊçÆÁöÑÊó∂Èó¥Êà≥</td>
</tr>
<tr>
<td>C:data</td>
<td>Â≠òÂÇ®Êï∞ÊçÆÊú¨Ë∫´</td>
</tr>
<tr>
<td>C:notify</td>
<td>Â≠òÂÇ® hint Âî§Ëµ∑ observers ÁöÑ‰ø°ÊÅØ</td>
</tr>
<tr>
<td>C:ack_O</td>
<td>observers ÂºÄÂßãËøêË°åÂêéÔºåÂ≠òÂÇ®‰∏äÊ¨°ËøêË°åÊàêÂäüÁöÑÊó∂Èó¥Êà≥</td>
</tr>
</tbody>
</table>
<h4 id="_2-5-3-percolator-‰∫ãÂä°Â§ÑÁêÜÊµÅÁ®ã" tabindex="-1">2.5.3 Percolator ‰∫ãÂä°Â§ÑÁêÜÊµÅÁ®ã: <a class="header-anchor" href="#_2-5-3-percolator-‰∫ãÂä°Â§ÑÁêÜÊµÅÁ®ã" aria-label="Permalink to &quot;2.5.3 Percolator ‰∫ãÂä°Â§ÑÁêÜÊµÅÁ®ã:&quot;"></a></h4>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Êú¨‰æã‰ª• Bob Âà∞ Joe ‰πãÈó¥ËΩ¨Ë¥¶‰∫§Êòì‰∏∫‰æãÔºåÊèèËø∞ Percolator ‰∫ãÂä°Âä†ÂáèÈîÅÊµÅÁ®ã„ÄÇ</p>
<ol>
<li>ÂàùÂßãÁä∂ÊÄÅÔºåJoe Ë¥¶Êà∑ 2 ÁæéÂÖÉÔºåBob Ë¥¶Êà∑ 10 ÁæéÂÖÉ„ÄÇ</li>
</ol>
<table tabindex="0">
<thead>
<tr>
<th>key</th>
<th>bal:data</th>
<th>bal:lock</th>
<th>bal:write</th>
</tr>
</thead>
<tbody>
<tr>
<td>Bob</td>
<td>6: <br/> 5:$10</td>
<td>6: <br/> 5:</td>
<td>6: data@5<br/> 5:</td>
</tr>
<tr>
<td>Joe</td>
<td>6: <br/> 5:$2</td>
<td>6: <br/> 5:</td>
<td>6: data@5<br/> 5:</td>
</tr>
</tbody>
</table>
<ol start="2">
<li>ËΩ¨Ë¥¶Á¨¨‰∏ÄÊ≠•ÔºåÂ∏¶Êñ∞Êó∂Èó¥Êà≥ 7 Âêë bal:lock ÂàóÂÜôÂÖ•Êï¥‰∏™‰∫ãÂä°‰∏ªÈîÆÈîÅÁöÑ‰ΩçÁΩÆ,‰πüÂ∞±ÊòØÂ§ÑÁêÜ Bob Ë°åÔºõ</li>
</ol>
<table tabindex="0">
<thead>
<tr>
<th>key</th>
<th>bal:data</th>
<th>bal:lock</th>
<th>bal:write</th>
</tr>
</thead>
<tbody>
<tr>
<td>Bob</td>
<td>7:$3 <br/> 6: <br/> 5:$10</td>
<td>7:I am primary location <br/>6: <br/> 5:</td>
<td>7: <br/>6: data@5<br/> 5:</td>
</tr>
<tr>
<td>Joe</td>
<td>6: <br/> 5:$2</td>
<td>6: <br/> 5:</td>
<td>6: data@5<br/> 5:</td>
</tr>
</tbody>
</table>
<ol start="3">
<li>ËΩ¨Ë¥¶Á¨¨‰∫åÊ≠•ÔºåÂ∞ÜÂ∏¶ÊúâÁõ∏ÂêåÊó∂Èó¥Êà≥ 7 ÁöÑÂÖ∂‰ªñË°åÔºå‰ª•ÊåáÈíàÁöÑÂΩ¢ÂºèÊåáÂêë Bob ÁöÑ‰∏ªÈîÆÈîÅ‰ΩçÁΩÆÔºåÂΩ¢ÊàêÂØπ‰∫ãÂä°‰∏≠ÊâÄÊúâË°åÁöÑÈîÅÂÆö„ÄÇ</li>
</ol>
<table tabindex="0">
<thead>
<tr>
<th>key</th>
<th>bal:data</th>
<th>bal:lock</th>
<th>bal:write</th>
</tr>
</thead>
<tbody>
<tr>
<td>Bob</td>
<td>7:$3 <br/> 6: <br/> 5:$10</td>
<td>7: I am primary location <br/>6: <br/> 5:</td>
<td>7: <br/>6: data@5<br/> 5:</td>
</tr>
<tr>
<td>Joe</td>
<td>7:$9 <br/> 6: <br/> 5:$2</td>
<td>7: primary@Bob.bal <br/> 6: <br/> 5:</td>
<td>7:<br/> 6: data@5<br/> 5:</td>
</tr>
</tbody>
</table>
<ol start="4">
<li>ËΩ¨Ë¥¶Á¨¨‰∏âÊ≠•Ôºå‰∫ãÂä°ËøõÂÖ•Êèê‰∫§Èò∂ÊÆµÔºåÂ∏¶ÊúâÊñ∞Êó∂Èó¥Êà≥ 8 ÂÜôÂÖ•‰∏ÄÊù°Êñ∞‰ø°ÊÅØÊì¶Èô§‰∏ªÈîÆÈîÅÔºåbal:write ÂåÖÂê´ÊúÄËøë commit ÁöÑÊó∂Èó¥Êà≥ÔºåÂÖ∂‰ªñ‰∫ãÂä°‰πü‰ºöÁúãËßÅÊ≠§‰∫ãÂä°ÊâÄÂÜôÂÜÖÂÆπ„ÄÇ</li>
</ol>
<table tabindex="0">
<thead>
<tr>
<th>key</th>
<th>bal:data</th>
<th>bal:lock</th>
<th>bal:write</th>
</tr>
</thead>
<tbody>
<tr>
<td>Bob</td>
<td>8:  <br/> 7:$3 <br/> 6: <br/> 5:$10</td>
<td>8:  <br/> 7:  <br/>6: <br/> 5:</td>
<td>8: data@7<br/> 7: <br/>6: data@5<br/> 5:</td>
</tr>
<tr>
<td>Joe</td>
<td>7:$9 <br/> 6: <br/> 5:$2</td>
<td>7: primary@Bob.bal<br/> 6: <br/> 5:</td>
<td>7:<br/> 6: data@5<br/> 5:</td>
</tr>
</tbody>
</table>
<ol start="4">
<li>ÊúÄÂêéÔºåÂú® Bob ÁöÑ bal:write ÂàóÂÜôÂÖ•‰∫ãÂä°Êèê‰∫§Êó∂Èó¥Êà≥ÔºåÂπ∂Êì¶Âá∫ÊåáÂêëÂéüÊúâ‰∏ªÈîÆÈîÅÁöÑÊ¨°Á∫ßË°åÈîÅ„ÄÇ</li>
</ol>
<table tabindex="0">
<thead>
<tr>
<th>key</th>
<th>bal:data</th>
<th>bal:lock</th>
<th>bal:write</th>
</tr>
</thead>
<tbody>
<tr>
<td>Bob</td>
<td>8:  <br/> 7:$3 <br/> 6: <br/> 5:$10</td>
<td>8:  <br/> 7:  <br/>6: <br/> 5:</td>
<td>8: data@7<br/> 7: <br/>6: data@5<br/> 5:</td>
</tr>
<tr>
<td>Joe</td>
<td>8:  <br/>7:$9 <br/> 6: <br/> 5:$2</td>
<td>8:  <br/> 7: <br/> 6: <br/> 5:</td>
<td>8: data@7<br/>7:<br/> 6: data@5<br/> 5:</td>
</tr>
</tbody>
</table>
<h4 id="_2-5-2-‰∫ãÂä°ÁöÑÈîôËØØÂ§ÑÁêÜ" tabindex="-1">2.5.2 ‰∫ãÂä°ÁöÑÈîôËØØÂ§ÑÁêÜ <a class="header-anchor" href="#_2-5-2-‰∫ãÂä°ÁöÑÈîôËØØÂ§ÑÁêÜ" aria-label="Permalink to &quot;2.5.2 ‰∫ãÂä°ÁöÑÈîôËØØÂ§ÑÁêÜ&quot;"></a></h4>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ê∏ÖÁêÜ‰∏ªÈîÅÊòØÂêåÊ≠•Êìç‰ΩúÔºåÊâÄ‰ª•Ê∏ÖÁêÜÊ¥ªÂä®ÂÆ¢Êà∑Á´ØÊåÅÊúâÁöÑÈîÅÊòØÂÆâÂÖ®ÁöÑÔºå‰ΩÜÂõûÊªöÂ∞ÜËø´‰Ωø‰∫ãÂä°‰∏≠Ê≠¢Ôºå‰ºö‰∫ßÁîüÊÄßËÉΩÈóÆÈ¢ò„ÄÇÂΩì‰∫ãÂä°Ê≠£Âú®Êèê‰∫§Êó∂ÂÆ¢Êà∑Á´ØÂ¥©Ê∫ÉÔºåÈîÅ‰∏ç‰ºöÊ∏ÖÈô§Ôºå‰æùÊóßÊåÅ‰πÖÂåñÂú® tablet server ‰∏≠„ÄÇ‰∏∫Èôç‰ΩéÊ∏ÖÈîÅÂØπÊÄßËÉΩÈÄ†ÊàêÂΩ±ÂìçÔºåÈùûÈòªÂ°ûÂΩìÂâç worker ËøêË°åÊàñÊ≠ªÈîÅÊÉÖÂÜµ‰∏ã‰∏ç‰ºö‰∏ªÂä®Ê∏ÖÁêÜÊÆãÁïôÈîÅÔºåÂêåÊó∂ÂºïÂÖ•‚Äú‰ª§Áâå‚Äù„ÄÅ‚ÄúË∂ÖÊó∂‚Äù Ë°•ÂÖÖÊ∏ÖÈîÅÊÉÖÂÜµ„ÄÇ</p>
<ol>
<li>ÂºïÂÖ• ‚Äú‰ª§Áâå‚Äù ‰ΩøÁî® worker Âêë Chubby ÂÜôÂÖ• tokenÔºå Ë°®ÊòéÊâÄÂ±û‰∫éÁ≥ªÁªüÂèäÂ≠òÊ¥ªÁä∂ÊÄÅÔºåtoken Âú®ËøõÁ®ãÈÄÄÂá∫Êó∂Ëá™Âä®Âà†Èô§„ÄÇ</li>
<li>ÂºïÂÖ• ‚ÄúË∂ÖÊó∂‚Äù Á°Æ‰øùÂç≥‰Ωø worker ÁöÑ token ÊúâÊïàÔºåÂ§™‰πÖÁöÑÈîÅ‰πü‰ºöË¢´Ê∏ÖÈô§„ÄÇ</li>
</ol>
<p><strong>ÈîÅÈáäÊîæÊ≠•È™§Ôºö</strong></p>
<ol>
<li>txn B Êèê‰∫§Ââç, ÂøÖÈ°ªÊ£ÄÊü•ÊòØÂê¶‰ªçÁÑ∂ÊåÅÊúâ‰∏ªÈîÆÈîÅÔºõ</li>
<li>txn A Ê∏ÖÈô§ txn B ÊÆãÁïôÈîÅÂâçÔºåtxn A ÂøÖÈ°ªÁ°Æ‰øù txn B ÁöÑ‰∏ªÈîÆÈîÅÊ≤°ÊúâË¢´Êèê‰∫§Ôºõ</li>
<li>ÂΩìÂÆ¢Êà∑Á´Ø commit Èò∂ÊÆµÂ¥©Ê∫ÉÊó∂ÔºåÂ¶ÇÊûúÂÆ¢Êà∑Á´ØÂ∑≤ÂèëËµ∑ commit Âπ∂‰ª•‰øÆÊîπÊï∞ÊçÆÔºåÂøÖÈ°ªÂâçÊªöÊÅ¢Â§çÊï∞ÊçÆÔºõÂÖ∂‰ªñÊÉÖÂÜµÂõûÊªöÊï∞ÊçÆ„ÄÇËØ¶ÊÉÖÂ¶Ç‰∏ã:<br>
3.1 Á¨¨‰∏ÄÁßçÊÉÖÂÜµÔºöÂ¶ÇÊûú‰∏ªÈîÆÂ∑≤ÁªèÊõ¥Êç¢‰∏∫ÂÖ∂‰ªñËÆ∞ÂΩï, ËØ¥ÊòéÂÜôÈîÅÁöÑ‰∫ãÂä°Â∑≤ÁªèÊèê‰∫§ÔºåÂâçÊªö‰∫ãÂä°Âç≥ÂèØÔºõ<br>
3.2 ÂÖ∂‰ªñÊÉÖÂÜµÔºöÁõ¥Êé•Â∞Ü txn A ÂÜôÂÖ• txn B ‰∏ªÈîÆÈîÅË°åÂõûÊªö txn B ‰æøÂèØÔºåÂõ†‰∏∫‰∫ãÂä°Êèê‰∫§‰ºöÈ¶ñÂÖàÈáäÊîæ‰∏ªÈîÆÈîÅÔºõ</li>
</ol>
<h3 id="_2-4-percolator-Áé∞Â≠òÈóÆÈ¢ò" tabindex="-1">2.4 Percolator Áé∞Â≠òÈóÆÈ¢ò <a class="header-anchor" href="#_2-4-percolator-Áé∞Â≠òÈóÆÈ¢ò" aria-label="Permalink to &quot;2.4 Percolator Áé∞Â≠òÈóÆÈ¢ò&quot;"></a></h3>
<ol>
<li>PRC ÊÄßËÉΩÔºöÁõ∏ËæÉ mapreduce ËæÉ‰ΩéÊïàÁéáÁöÑÊòØÊØè‰∏™Â∑•‰ΩúÂçïÂÖÉÂèëÈÄÅÁöÑ rpc Êï∞ÈáèÔºåMapReduce ÂØπ GFS ËøõË°å‰∏ÄÊ¨°Â§ßÁöÑËØªÂèñÔºåËé∑Âèñ 10 ÔΩû 100 ‰∏™ÁΩëÈ°µÁöÑÊâÄÊúâÊï∞ÊçÆÔºåËÄå Percolator ÊâßË°åÂ§ßÁ∫¶ 50 ‰∏™ÂçïÁã¨ÁöÑ Bigtable Rpc Êìç‰ΩúÊù•Â§ÑÁêÜ‰∏Ä‰∏™ÊñáÊ°£ÔºåÂêûÂêêÂ≠òÂú®ÈóÆÈ¢ò„ÄÇ</li>
<li>ÂÜôÈîÅÊó∂Âª∂ÔºöÊØèÊ¨°ÂÜôÈîÅÂøÖÈ°ªÊâßË°åËØª„ÄÅ‰øÆÊîπ„ÄÅÂÜô‰∏â‰∏™Êìç‰ΩúÔºåÈúÄË¶Å‰∏é Bigtable ‰∏§Ê¨° rpc ‰∫§‰∫í : ‰∏ÄÊ¨°Áî®‰∫éËØªÂèñÂÜ≤Á™ÅÈîÅÔºå‰∏ÄÊ¨°Áî®‰∫éÂÜôÂÖ•Êñ∞ÈîÅ„ÄÇ<br>
2.1 ‰ºòÂåñ‰∏Ä ÊâπÈáèÔºöËôΩÁÑ∂Áõ∏Âêå Tablet server ÁöÑÂÜôÈîÅÊìç‰ΩúÂèØ‰ª• batch Â§ÑÁêÜÔºå‰ΩÜÈ´òÂπ∂Âèë‰∏ãËØ•ÈóÆÈ¢òËæÉ‰∏∫ÊòéÊòæ„ÄÇ<br>
2.2 ‰ºòÂåñ‰∫å È¢ÑÂèñÔºöÂü∫‰∫éËØª‰∏ÄË°å‰∏éËØªÂèñ‰∏§‰∏™ÊàñÂ§ö‰∏™ÂÄºÁöÑÊàêÊú¨Âü∫Êú¨Áõ∏ÂêåÔºåÈ¢ÑÂèñ‰∏éÁºìÂ≠òÁªìÂêàÂèØ‰ª•ÂáèÂ∞èËØª Bigtable ÁöÑÊ¨°Êï∞ 10 ÂÄç„ÄÇ</li>
</ol>
<h2 id="‰∏â„ÄÅÊÄßËÉΩ‰∏éÊú™Êù•" tabindex="-1">‰∏â„ÄÅÊÄßËÉΩ‰∏éÊú™Êù• <a class="header-anchor" href="#‰∏â„ÄÅÊÄßËÉΩ‰∏éÊú™Êù•" aria-label="Permalink to &quot;‰∏â„ÄÅÊÄßËÉΩ‰∏éÊú™Êù•&quot;"></a></h2>
<p><strong>ÊÄßËÉΩ</strong><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Google ÈÄöËøáÂª∫Á´ãÂíåÈÉ®ÁΩ≤ PercolatorÔºåËá™2010Âπ¥4Êúà‰ª•Êù•Áî®‰∫éÂà∂‰ΩúË∞∑Ê≠åÁöÑÁΩëÁªúÊêúÁ¥¢Á¥¢ÂºïÂÆûÁé∞‰∫ÜÂáèÂ∞ëÁ¥¢ÂºïÂçï‰∏™ÊñáÊ°£ÁöÑÂª∂ËøüÁöÑÁõÆÊ†á„ÄÇÂêåÊó∂Ôºå‰∏∫‰∫ÜÂú®Êõ¥ÂÆûÈôÖÁöÑÂ∑•‰ΩúË¥üËΩΩ‰∏äËØÑ‰º∞ Percolator ÂÆûÁé∞‰∫ÜÂü∫‰∫é TPC-EÔºàTPC-E Ê®°Êãü‰∫Ü‰∏Ä‰∏™ÁªèÁ∫™ÂÖ¨Âè∏ÔºåÂÆ¢Êà∑ÊâßË°å‰∫§Êòì„ÄÅÂ∏ÇÂú∫ÊêúÁ¥¢ÂíåÂ∏êÊà∑Êü•ËØ¢Ôºâ ÁöÑÂü∫ÂáÜÊµãËØïÁªìÊûú‰∏∫Êú™Êù•ÁöÑÁ†îÁ©∂Êèê‰æõ‰∫ÜÊñ∞ÁöÑÂâçÊôØÊñπÂêë„ÄÇÊµãËØïÁªìÊûúÂπ≥Âùá‰∫ãÂä°Âª∂ËøüÊòØ2Âà∞5ÁßíÔºåÂºÇÂ∏∏ÂÄºÂèØËÉΩÈúÄË¶ÅÂá†ÂàÜÈíü„ÄÇ</p>
<p><strong>Êú™Êù•</strong></p>
<ol>
<li>Percolator ËøôÊ†∑ÁöÑÂ∑®Â§ßÊï∞ÊçÆÈõÜÂçï‰∏™ÂÖ±‰∫´ÂÜÖÂ≠òÊú∫Âô®Â∑≤Êó†Ê≥ïÂ§ÑÁêÜÔºåÈúÄË¶ÅÊâ©Â±ïÂà∞ 1000 Âè∞Êú∫Âô®ÁöÑÂàÜÂ∏ÉÂºèËß£ÂÜ≥ÊñπÊ°àÔºåÈÄöËøáÁâ∫Áâ≤Âπ∂Ë°åÊï∞ÊçÆÂ∫ìÁöÑÈÉ®ÂàÜÁÅµÊ¥ªÊÄßÂíå‰ΩéÂª∂ËøüÔºåÊèê‰æõ‰∫Ü‰∏Ä‰∏™Ë∂≥‰ª•ÈÄÇÂ∫î‰∫íËÅîÁΩëËßÑÊ®°ÁöÑÊï∞ÊçÆÈõÜÁöÑÁ≥ªÁªüÔºåËß£ÂÜ≥‰∫ÜÁé∞ÊúâÁöÑÂπ∂Ë°åÊï∞ÊçÆÂ∫ìÂè™ËÉΩÂà©Áî®100Âè∞Êú∫Âô®ÁöÑËäÇÁÇπÁì∂È¢à„ÄÇ</li>
<li>Percolator ÊòØ‰∏Ä‰∏™Êï∞ÊçÆËΩ¨Êç¢Á≥ªÁªüÔºåËÄå‰∏ç‰ªÖ‰ªÖÊòØ‰∏Ä‰∏™Êï∞ÊçÆÂ≠òÂÇ®Á≥ªÁªüÔºå‰∏é NewSQL„ÄÅRocksDB Á≠âÈ´òÊïàÂ≠òÂÇ®ÂºïÊìéÁªÑÂêàÂú®‰∏ÄËµ∑Ôºå‰ºöÊØî‰º†ÁªüÊï∞ÊçÆÂ∫ìÊèê‰æõÊõ¥È´òÁöÑÊÄßËÉΩÂíåÊõ¥Â•ΩÁöÑ‰º∏Áº©ÊÄß„ÄÇ</li>
</ol>
<h2 id="Âõõ„ÄÅÂèÇËÄÉÊñáÁ´†" tabindex="-1">Âõõ„ÄÅÂèÇËÄÉÊñáÁ´† <a class="header-anchor" href="#Âõõ„ÄÅÂèÇËÄÉÊñáÁ´†" aria-label="Permalink to &quot;Âõõ„ÄÅÂèÇËÄÉÊñáÁ´†&quot;"></a></h2>
<p><a href="http://notes.stephenholiday.com/Percolator.pdf" target="_blank" rel="noreferrer">Paper -- Large-scale Incremental Processing
Using Distributed Transactions and Notifications</a><br>
<a href="https://pingcap.com/zh/blog/percolator-and-txn" target="_blank" rel="noreferrer">PingCAP Blog -- Percolator Âíå TiDB ‰∫ãÂä°ÁÆóÊ≥ï</a></p>
]]></content:encoded>
            <enclosure url="https://askaric.com/Theory-Percolator%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1/Percolator_overview.svg" length="0" type="image/svg"/>
        </item>
        <item>
            <title><![CDATA[What's Logical Optimizing in TiDB]]></title>
            <link>https://askaric.com/zh/work/tidb/TiDB-Principle/TiDB ‰ºòÂåñÂô®/Logical Optimizing in TiDB.html</link>
            <guid>https://askaric.com/zh/work/tidb/TiDB-Principle/TiDB ‰ºòÂåñÂô®/Logical Optimizing in TiDB.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[# What's Logical Optimizing in TiDB

## First of all

Actually, every logical rule struct has a method named `optimize()`

## rules of logical

From [here](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/optimizer.go#L597), we can see logical optimizing items will be applied on by one.  

```go
var optRuleList = []logicalOptRule{
 &gcSubstituter{},
 &columnPruner{},
 &resultReorder{},
 &buildKeySolver{},
 &decorrelateSolver{},
 &semiJoinRewriter{},
 &aggregationEliminator{},
 &skewDistinctAggRewriter{},
 &projectionEliminator{},
 &maxMinEliminator{},
 &ppdSolver{},
 &outerJoinEliminator{},
 &partitionProcessor{},
 &collectPredicateColumnsPoint{},
 &aggregationPushDownSolver{},
 &pushDownTopNOptimizer{},
 &syncWaitStatsLoadPoint{},
 &joinReOrderSolver{},
 &columnPruner{}, // column pruning again at last, note it will mess up the results of buildKeySolver
}
```

## gcSubstituter

By [mysql reference](https://dev.mysql.com/doc/refman/8.0/en/generated-column-index-optimizations.html) of `Generated Column(in short: gc)`, we can see what the function of gc is. And from [here](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/rule_generate_column_substitute.go#L97), you can figure out how tidb implment `gc` in period of logical plan. There are four parts of operands, (Selection, Projection, Sort, Aggregation), will subtitute gc as index.

1. LogicalSelection:  

    LogicalSelection represents a where or having predicate.
    firstly, in generated column function, index wouldn't none. Because of every calculating is based on index expression.
    secondly, when predicate operands are `=`, `>`, `>=`, `<`, `<=`, `like`, `or`, `and`, `not`. TiDB'll deal with it using generated column.  However, when predicate is `in`, there is a limition that all of scalars are the same type.  

2. LogicalProjection:

    LogicalProjection represents a select fields plan and TiDB'll loop every field(selected colums from SQL) and try subsitiuting generated column.  

3. LogicalSort:  

    LogicalSort stands for the order by plan. if there are any `sort` item in a query.

4. LogicalAggregation:

    LogicalAggregation represents an aggregate plan. And all agg functions are [here](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/parser/ast/functions.go#L701). if there any field could be subtitiuted into one genereated colum, it'd be done.

    ```go
    // AggFuncCount is the name of Count function.
    AggFuncCount = "count"
    // AggFuncSum is the name of Sum function.
    AggFuncSum = "sum"
    // AggFuncAvg is the name of Avg function.
    AggFuncAvg = "avg"
    // AggFuncFirstRow is the name of FirstRowColumn function.
    AggFuncFirstRow = "firstrow"
    // AggFuncMax is the name of max function.
    AggFuncMax = "max"
    // AggFuncMin is the name of min function.
    AggFuncMin = "min"
    // AggFuncGroupConcat is the name of group_concat function.
    AggFuncGroupConcat = "group_concat"
    // AggFuncBitOr is the name of bit_or function.
    AggFuncBitOr = "bit_or"
    // AggFuncBitXor is the name of bit_xor function.
    AggFuncBitXor = "bit_xor"
    // AggFuncBitAnd is the name of bit_and function.
    AggFuncBitAnd = "bit_and"
    // AggFuncVarPop is the name of var_pop function
    AggFuncVarPop = "var_pop"
    // AggFuncVarSamp is the name of var_samp function
    AggFuncVarSamp = "var_samp"
    // AggFuncStddevPop is the name of stddev_pop/std/stddev function
    AggFuncStddevPop = "stddev_pop"
    // AggFuncStddevSamp is the name of stddev_samp function
    AggFuncStddevSamp = "stddev_samp"
    // AggFuncJsonArrayagg is the name of json_arrayagg function
    AggFuncJsonArrayagg = "json_arrayagg"
    // AggFuncJsonObjectAgg is the name of json_objectagg function
    AggFuncJsonObjectAgg = "json_objectagg"
    // AggFuncApproxCountDistinct is the name of approx_count_distinct function.
    AggFuncApproxCountDistinct = "approx_count_distinct"
    // AggFuncApproxPercentile is the name of approx_percentile function.
    AggFuncApproxPercentile = "approx_percentile"
    ```

## columnPruner

1. Actually, there are too many operands implmented `pruneCoumns`, you can PTAL at [it's interface](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan.go#L258). After parsing AST, TiDB has already had a basic logic plan and column info without any tuning, when we step in here. I'll choose `LogicalSelection` which is one of the easiest to take a look deeply.  
2. That just deals with every column selected in sql or filterd in predicate and prunes part of columns which don't need. In `LogicalSelection`, as result of `func filter` is nil, so result is equal to columns selected plus predicate for filtering.

    ```go
    func extractColumns(result []*Column, expr Expression, filter func(*Column) bool) []*Column {
     switch v := expr.(type) {
     case *Column:
      if filter == nil || filter(v) {
       result = append(result, v)
      }
     case *ScalarFunction:
      for _, arg := range v.GetArgs() {
       result = extractColumns(result, arg, filter)
      }
     }
     return result
    }
    ```

## resultReorder

1. ResultReorder reorder query results, which is not a common rule for all queries, it's specially implemented for a few customers. And here is a short comment in code place.  

    ```go
    /*
    Results of some queries are not ordered, for example:

        create table t (a int); insert into t values (1), (2); select a from t;

    In the case above, the result can be `1 2` or `2 1`, which is not ordered.
    This rule reorders results by modifying or injecting a Sort operator:
     1. iterate the plan from the root, and ignore all input-order operators (Sel/Proj/Limit);
     2. when meeting the first non-input-order operator,
        2.1. if it's a Sort, update it by appending all output columns into its order-by list,
        2.2. otherwise, inject a new Sort upon this operator.
    */
    ```

2. At [here](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/rule_result_reorder.go#L43), based on the such clear comment, TiDB'll do `1`, `2.1` and `2.2` by `func completeSort` and `func injectSort`. PTAL at [#pr](https://github.com/pingcap/tidb/pull/25971) for details.

## buildKeyInfo

BuildKeyInfo as their name will collect the information of unique keys into schema(`selfSchema` and `childSchema`) and check keys of schema from query input coule be used. in addition, that to check if a query returns no more than one row is also an important action inside of this step. [more details](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan.go#L274)

## decorrelateSolver

1. what's apply? from comments, `LogicalApply` gets one row from outer executor and gets one row from inner executor according to outer row.  
2. which means, there wouldn't have optimization without `Apply` operand logic.
3. if `innerPlan` is `LogicalSelection`, action is set new apply-plan children and reoptimize it using the same `decorrelateSolver` rule, you can see [here](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/rule_decorrelate.go#L150).
4. if `innerPlan` is `LogicalMaxOneRow`, action is the same as `LogicalSelection`.
5. if `innerPlan` is `LogicalProjection` and `JoinType` is `LeftOuterJoin`, action is it doesn't have optimization, because of below comments, every comparation will return 1 since the projection is evaluated after the join. And when an `Apply` is `apply.JoinType != SemiJoin && apply.JoinType != LeftOuterSemiJoin && apply.JoinType != AntiSemiJoin && apply.JoinType != AntiLeftOuterSemiJoin`, it'll step to next step and try to substitute the all the schema with new expressions which maybe have been optimized by `columnPruner`, which mainly it does is substitued all expressions or columns like `gcSubstitute`.
6. if `innerPlan` is `LogicalAggregation`,

    ```sql
    select (select 1 from t1 where t1.a=t2.a) from t2;
    -- when t1.a=t2.a is false, the result should be null
    -- after decorrelateSolver, it'll be a format below
    select t1.* from t2 left outer join (select distinct(t1.a) as a from t1) as sub on t2.a = sub.a;
    -- | t2.a |      | t1.a |        | t2.a | t1.a | join result |      | join result |
    -- |   1  | join |  0   |  -->   |   1  |   0  |     nll     | -->  | 1 | 1 |  1  |
    -- |   2  |      |  1   |        |   1  |   1  |      1      |
    --                               |   2  |   1  |     null    |
    --                               |   2  |   1  |     null    |
    ```

7. if `innerPlan` is `LogicalLimit` and `apply.JoinType != SemiJoin && apply.JoinType != LeftOuterSemiJoin && apply.JoinType != AntiSemiJoin && apply.JoinType != AntiLeftOuterSemiJoin`, that means if `LogicalLimit` is not SemiJoin, the output of it might be expanded even though we are `limit 1`. because of function of `semi join` below, if we did expanding, we'd get `semi join` the result of limit number of rows.

    ```sql
    select * from sale_detail;
    --ËøîÂõûÁªìÊûú„ÄÇ
    +]]></description>
            <content:encoded><![CDATA[<h1 id="what-s-logical-optimizing-in-tidb" tabindex="-1">What's Logical Optimizing in TiDB <a class="header-anchor" href="#what-s-logical-optimizing-in-tidb" aria-label="Permalink to &quot;What's Logical Optimizing in TiDB&quot;"></a></h1>
<h2 id="first-of-all" tabindex="-1">First of all <a class="header-anchor" href="#first-of-all" aria-label="Permalink to &quot;First of all&quot;"></a></h2>
<p>Actually, every logical rule struct has a method named <code>optimize()</code></p>
<h2 id="rules-of-logical" tabindex="-1">rules of logical <a class="header-anchor" href="#rules-of-logical" aria-label="Permalink to &quot;rules of logical&quot;"></a></h2>
<p>From <a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/optimizer.go#L597" target="_blank" rel="noreferrer">here</a>, we can see logical optimizing items will be applied on by one.</p>
<div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> optRuleList </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> []</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">logicalOptRule</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> &#x26;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">gcSubstituter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{},</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> &#x26;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">columnPruner</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{},</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> &#x26;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">resultReorder</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{},</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> &#x26;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">buildKeySolver</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{},</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> &#x26;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">decorrelateSolver</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{},</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> &#x26;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">semiJoinRewriter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{},</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> &#x26;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">aggregationEliminator</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{},</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> &#x26;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">skewDistinctAggRewriter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{},</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> &#x26;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">projectionEliminator</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{},</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> &#x26;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">maxMinEliminator</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{},</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> &#x26;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ppdSolver</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{},</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> &#x26;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">outerJoinEliminator</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{},</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> &#x26;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">partitionProcessor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{},</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> &#x26;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">collectPredicateColumnsPoint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{},</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> &#x26;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">aggregationPushDownSolver</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{},</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> &#x26;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">pushDownTopNOptimizer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{},</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> &#x26;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">syncWaitStatsLoadPoint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{},</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> &#x26;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">joinReOrderSolver</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{},</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> &#x26;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">columnPruner</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{}, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// column pruning again at last, note it will mess up the results of buildKeySolver</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
</div><h2 id="gcsubstituter" tabindex="-1">gcSubstituter <a class="header-anchor" href="#gcsubstituter" aria-label="Permalink to &quot;gcSubstituter&quot;"></a></h2>
<p>By <a href="https://dev.mysql.com/doc/refman/8.0/en/generated-column-index-optimizations.html" target="_blank" rel="noreferrer">mysql reference</a> of <code>Generated Column(in short: gc)</code>, we can see what the function of gc is. And from <a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/rule_generate_column_substitute.go#L97" target="_blank" rel="noreferrer">here</a>, you can figure out how tidb implment <code>gc</code> in period of logical plan. There are four parts of operands, (Selection, Projection, Sort, Aggregation), will subtitute gc as index.</p>
<ol>
<li>
<p>LogicalSelection:</p>
<p>LogicalSelection represents a where or having predicate.
firstly, in generated column function, index wouldn't none. Because of every calculating is based on index expression.
secondly, when predicate operands are <code>=</code>, <code>&gt;</code>, <code>&gt;=</code>, <code>&lt;</code>, <code>&lt;=</code>, <code>like</code>, <code>or</code>, <code>and</code>, <code>not</code>. TiDB'll deal with it using generated column.  However, when predicate is <code>in</code>, there is a limition that all of scalars are the same type.</p>
</li>
<li>
<p>LogicalProjection:</p>
<p>LogicalProjection represents a select fields plan and TiDB'll loop every field(selected colums from SQL) and try subsitiuting generated column.</p>
</li>
<li>
<p>LogicalSort:</p>
<p>LogicalSort stands for the order by plan. if there are any <code>sort</code> item in a query.</p>
</li>
<li>
<p>LogicalAggregation:</p>
<p>LogicalAggregation represents an aggregate plan. And all agg functions are <a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/parser/ast/functions.go#L701" target="_blank" rel="noreferrer">here</a>. if there any field could be subtitiuted into one genereated colum, it'd be done.</p>
<div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// AggFuncCount is the name of Count function.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">AggFuncCount </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "count"</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// AggFuncSum is the name of Sum function.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">AggFuncSum </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "sum"</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// AggFuncAvg is the name of Avg function.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">AggFuncAvg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "avg"</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// AggFuncFirstRow is the name of FirstRowColumn function.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">AggFuncFirstRow </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "firstrow"</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// AggFuncMax is the name of max function.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">AggFuncMax </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "max"</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// AggFuncMin is the name of min function.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">AggFuncMin </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "min"</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// AggFuncGroupConcat is the name of group_concat function.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">AggFuncGroupConcat </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "group_concat"</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// AggFuncBitOr is the name of bit_or function.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">AggFuncBitOr </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "bit_or"</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// AggFuncBitXor is the name of bit_xor function.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">AggFuncBitXor </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "bit_xor"</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// AggFuncBitAnd is the name of bit_and function.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">AggFuncBitAnd </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "bit_and"</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// AggFuncVarPop is the name of var_pop function</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">AggFuncVarPop </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "var_pop"</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// AggFuncVarSamp is the name of var_samp function</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">AggFuncVarSamp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "var_samp"</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// AggFuncStddevPop is the name of stddev_pop/std/stddev function</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">AggFuncStddevPop </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "stddev_pop"</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// AggFuncStddevSamp is the name of stddev_samp function</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">AggFuncStddevSamp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "stddev_samp"</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// AggFuncJsonArrayagg is the name of json_arrayagg function</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">AggFuncJsonArrayagg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "json_arrayagg"</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// AggFuncJsonObjectAgg is the name of json_objectagg function</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">AggFuncJsonObjectAgg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "json_objectagg"</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// AggFuncApproxCountDistinct is the name of approx_count_distinct function.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">AggFuncApproxCountDistinct </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "approx_count_distinct"</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// AggFuncApproxPercentile is the name of approx_percentile function.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">AggFuncApproxPercentile </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> "approx_percentile"</span></span></code></pre>
</div></li>
</ol>
<h2 id="columnpruner" tabindex="-1">columnPruner <a class="header-anchor" href="#columnpruner" aria-label="Permalink to &quot;columnPruner&quot;"></a></h2>
<ol>
<li>
<p>Actually, there are too many operands implmented <code>pruneCoumns</code>, you can PTAL at <a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan.go#L258" target="_blank" rel="noreferrer">it's interface</a>. After parsing AST, TiDB has already had a basic logic plan and column info without any tuning, when we step in here. I'll choose <code>LogicalSelection</code> which is one of the easiest to take a look deeply.</p>
</li>
<li>
<p>That just deals with every column selected in sql or filterd in predicate and prunes part of columns which don't need. In <code>LogicalSelection</code>, as result of <code>func filter</code> is nil, so result is equal to columns selected plus predicate for filtering.</p>
<div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">func</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> extractColumns</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> []</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Column</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">expr</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Expression</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">filter</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> func</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Column</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">bool</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) []</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Column</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> switch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> v </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> expr.(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> case</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> *</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Column</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> filter </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> nil</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> ||</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> filter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(v) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   result </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> append</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(result, v)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> case</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> *</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ScalarFunction</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">:</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> _, arg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> range</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> v.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">GetArgs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">() {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">   result </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> extractColumns</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(result, arg, filter)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> result</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
</div></li>
</ol>
<h2 id="resultreorder" tabindex="-1">resultReorder <a class="header-anchor" href="#resultreorder" aria-label="Permalink to &quot;resultReorder&quot;"></a></h2>
<ol>
<li>
<p>ResultReorder reorder query results, which is not a common rule for all queries, it's specially implemented for a few customers. And here is a short comment in code place.</p>
<div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">/*</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">Results of some queries are not ordered, for example:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    create table t (a int); insert into t values (1), (2); select a from t;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">In the case above, the result can be `1 2` or `2 1`, which is not ordered.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">This rule reorders results by modifying or injecting a Sort operator:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"> 1. iterate the plan from the root, and ignore all input-order operators (Sel/Proj/Limit);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D"> 2. when meeting the first non-input-order operator,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    2.1. if it's a Sort, update it by appending all output columns into its order-by list,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    2.2. otherwise, inject a new Sort upon this operator.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">*/</span></span></code></pre>
</div></li>
<li>
<p>At <a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/rule_result_reorder.go#L43" target="_blank" rel="noreferrer">here</a>, based on the such clear comment, TiDB'll do <code>1</code>, <code>2.1</code> and <code>2.2</code> by <code>func completeSort</code> and <code>func injectSort</code>. PTAL at <a href="https://github.com/pingcap/tidb/pull/25971" target="_blank" rel="noreferrer">#pr</a> for details.</p>
</li>
</ol>
<h2 id="buildkeyinfo" tabindex="-1">buildKeyInfo <a class="header-anchor" href="#buildkeyinfo" aria-label="Permalink to &quot;buildKeyInfo&quot;"></a></h2>
<p>BuildKeyInfo as their name will collect the information of unique keys into schema(<code>selfSchema</code> and <code>childSchema</code>) and check keys of schema from query input coule be used. in addition, that to check if a query returns no more than one row is also an important action inside of this step. <a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan.go#L274" target="_blank" rel="noreferrer">more details</a></p>
<h2 id="decorrelatesolver" tabindex="-1">decorrelateSolver <a class="header-anchor" href="#decorrelatesolver" aria-label="Permalink to &quot;decorrelateSolver&quot;"></a></h2>
<ol>
<li>
<p>what's apply? from comments, <code>LogicalApply</code> gets one row from outer executor and gets one row from inner executor according to outer row.</p>
</li>
<li>
<p>which means, there wouldn't have optimization without <code>Apply</code> operand logic.</p>
</li>
<li>
<p>if <code>innerPlan</code> is <code>LogicalSelection</code>, action is set new apply-plan children and reoptimize it using the same <code>decorrelateSolver</code> rule, you can see <a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/rule_decorrelate.go#L150" target="_blank" rel="noreferrer">here</a>.</p>
</li>
<li>
<p>if <code>innerPlan</code> is <code>LogicalMaxOneRow</code>, action is the same as <code>LogicalSelection</code>.</p>
</li>
<li>
<p>if <code>innerPlan</code> is <code>LogicalProjection</code> and <code>JoinType</code> is <code>LeftOuterJoin</code>, action is it doesn't have optimization, because of below comments, every comparation will return 1 since the projection is evaluated after the join. And when an <code>Apply</code> is <code>apply.JoinType != SemiJoin &amp;&amp; apply.JoinType != LeftOuterSemiJoin &amp;&amp; apply.JoinType != AntiSemiJoin &amp;&amp; apply.JoinType != AntiLeftOuterSemiJoin</code>, it'll step to next step and try to substitute the all the schema with new expressions which maybe have been optimized by <code>columnPruner</code>, which mainly it does is substitued all expressions or columns like <code>gcSubstitute</code>.</p>
</li>
<li>
<p>if <code>innerPlan</code> is <code>LogicalAggregation</code>,</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> t1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">where</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> t1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">a</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">t2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> t2;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">-- when t1.a=t2.a is false, the result should be null</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">-- after decorrelateSolver, it'll be a format below</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> t1.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> t2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">left outer join</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select distinct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">t1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> a </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> t1) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> sub </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">on</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> t2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">a</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> sub</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">-- | t2.a |      | t1.a |        | t2.a | t1.a | join result |      | join result |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">-- |   1  | join |  0   |  -->   |   1  |   0  |     nll     | -->  | 1 | 1 |  1  |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">-- |   2  |      |  1   |        |   1  |   1  |      1      |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">--                               |   2  |   1  |     null    |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">--                               |   2  |   1  |     null    |</span></span></code></pre>
</div></li>
<li>
<p>if <code>innerPlan</code> is <code>LogicalLimit</code> and <code>apply.JoinType != SemiJoin &amp;&amp; apply.JoinType != LeftOuterSemiJoin &amp;&amp; apply.JoinType != AntiSemiJoin &amp;&amp; apply.JoinType != AntiLeftOuterSemiJoin</code>, that means if <code>LogicalLimit</code> is not SemiJoin, the output of it might be expanded even though we are <code>limit 1</code>. because of function of <code>semi join</code> below, if we did expanding, we'd get <code>semi join</code> the result of limit number of rows.</p>
<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> sale_detail;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">--ËøîÂõûÁªìÊûú„ÄÇ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">------------+-------------+-------------+------------+------------+</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| shop_name  | customer_id | total_price | sale_date  | region     |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">------------+-------------+-------------+------------+------------+</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| s1         | c1          | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">       | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2013</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">       | china      |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| s2         | c2          | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">       | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2013</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">       | china      |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| s3         | c3          | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">       | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2013</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">       | china      |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">------------+-------------+-------------+------------+------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> sale_detail_sj;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">--ËøîÂõûÁªìÊûú„ÄÇ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">------------+-------------+-------------+------------+------------+</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| shop_name  | customer_id | total_price | sale_date  | region     |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">------------+-------------+-------------+------------+------------+</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| s1         | c1          | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">       | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2013</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">       | china      |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| s2         | c2          | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">       | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2013</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">       | china      |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| s5         | c2          | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">       | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2013</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">       | china      |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| s2         | c2          | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">       | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2013</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">       | china      |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">------------+-------------+-------------+------------+------------+</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> sale_detail a left semi </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">join</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> sale_detail_sj b </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">on</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">total_price</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">b</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">total_price</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">------------+-------------+-------------+------------+------------+</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| shop_name  | customer_id | total_price | sale_date  | region     |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">------------+-------------+-------------+------------+------------+</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| s2         | c2          | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">       | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2013</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">       | china      |</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">| s1         | c1          | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">       | </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2013</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">       | china      |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">------------+-------------+-------------+------------+------------+</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[right result]  </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> test t1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">where</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> exists</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> test t2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">where</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> t1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> t2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> limit</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">);  </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">[wrong result]  </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">select</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> test t1 a semi </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">join</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> test t2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">where</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> t1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> t2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> limit</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span></code></pre>
</div></li>
<li>
<p>if <code>innerPlan</code> is <code>LogicalAggregation</code>, It'll check if <code>Apply</code> can be pulled up and an aggregation can be pulled up, then, do related actions like add <code>sum</code> flag.</p>
</li>
<li>
<p>if <code>innerPlan</code> is <code>LogicalSort</code>, Since TiDB only pull up Selection, Projection, Aggregation, MaxOneRow, so there just setp in childen optimization.</p>
</li>
</ol>
<p><a href="https://zhuanlan.zhihu.com/p/52138596" target="_blank" rel="noreferrer">The text</a> may help you understand it easily.</p>
<h2 id="semijoinrewriter" tabindex="-1">semiJoinRewriter <a class="header-anchor" href="#semijoinrewriter" aria-label="Permalink to &quot;semiJoinRewriter&quot;"></a></h2>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[First of all]]></title>
            <link>https://askaric.com/zh/work/tidb/TiDB-Principle/TiDB ‰ºòÂåñÂô®/Physical Optimizing in TiDB.html</link>
            <guid>https://askaric.com/zh/work/tidb/TiDB-Principle/TiDB ‰ºòÂåñÂô®/Physical Optimizing in TiDB.html</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[

## First of all

first of all, in psysical period, [preparePossibleProperties](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/optimizer.go#L624) will get all possible order properties(column fields), which is only used for join and aggregation. Like group by a,b,c, into one slice from different level childs.  


## How to calculate physical plan 
1. [DoOptimize](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/optimizer.go#L269) is the core connection from logicalOptimize to physicalOptimize, which optimizes a logical plan to a physical plan.    
2. Function findBestTask ,in [physicalOptimize](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/optimizer.go#L619), will find out the best tasks from logical plan, and converts the logical plan to the physical plan, which's a new interface.   
3. Until 2022-11-30 TiDB master branch, TiDB optizmizer gets plan cost in the order of `DoOptimize` -> `getPlanCost` -> `getPlanCostVer1/getPlanCostVer2`.Actually, the method [getPlanCostVer1/getPlanCostVer2](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan.go#L337) of interface PhysicalPlan is use get psysical every operand cost. I mean, by their different implentation, you could figure out how it's calculated.      
4. In [here](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L39), you'll get that It figures out child cost one by one.  
 

## Why go PlanCostVer1 to PlanCostVer2   

This [PR](https://github.com/pingcap/tidb/pull/35378) indeciates sometimes optimizer cannot discern which is the best datasource,  so a new cost formular for `Selection/TableScan/IndexScan` has been merged. which are here below:  
1. Selection : rows*num-filters*cpu-factor, which Tiflash has a specific cpu-factor 
2. TableScan : rows*log(row-size)*scan-factor, which Tiflash has a specific cpu-factor   
3. indexScan : rows*log(row-size)*scan-factor  

## Formula map of operand cost
1. In the map below, you'll find a lot of factor and can get them on [Formula map of different factors](## Formula map of different factors ). 

| TaskType | version | cost calculated expression | code addr |
| - | - | - | - |
| PhysicalSelection | 2 | cost = child-cost + filter-cost | [here](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L62) |
| PhysicalProjection | 2 | cost = (child-cost + (proj-cost = rows \* len(expressions) \* cpu-factor)) / projection-concurrency  | [here](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L85) |
| PhysicalIndexScan | 2 | cost = rows * log2(row-size) * scan-factor | [here](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L109) |
| PhysicalTableScan | 2 | cost = rows * log2(row-size) * scan-factor | [here](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L126) |
| PhysicalIndexReader | 2 |  cost = (child-cost + net-cost + seek-cost) / concurrency | [here](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L150) |
| PhysicalTableReader | 2 | cost = (child-cost + (rows * row-size * net-factor) + (num-tasks * seek-factor)) / concurrency | [here](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L178) |
| PhysicalIndexLookUpReader | 2 | cost = index-side-cost + (table-side-cost + double-read-cost) / double-read-concurrency | [here](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L217) |
| PhysicalIndexMergeReader | 2 | cost = cost = table-side-cost + sum(index-side-cost) | [here](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L269) |
| PhysicalSort | 2 | cost = child-cost + sort-cpu-cost + sort-mem-cost + sort-disk-cost | [here](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L322) |
| PhysicalTopN | 2 | cost = child-cost + topn-cpu-cost + topn-mem-cost | [here](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L372) |
| PhysicalStreamAgg | 2 | cost = child-cost + agg-cost + group-cost | [here](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L402) |
| PhysicalHashAgg | 2 | child-cost + (agg-cost + group-cost + hash-build-cost + hash-probe-cost) / concurrency | [here](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L425) |
| PhysicalMergeJoin | 2 | cost = left-child-cost + right-child-cost + filter-cost + group-cost |   |
| PhysicalHashJoin | 2 | cost = build-child-cost + probe-child-cost + build-hash-cost + build-filter-cost + (probe-filter-cost + probe-hash-cost) / concurrency | [here](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L486) |
| PhysicalIndexJoin | 2 | cost = build-child-cost + build-filter-cost + (probe-cost + probe-filter-cost) / concurrency probe-cost = probe-child-cost * build-rows / batchRatio | [here](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L530) |
| PhysicalIndexHashJoin | 2 | until 2022-11-30, It's the same as PhysicalIndexJoin | [here](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L566) |
| PhysicalIndexMergeJoin | 2 | until 2022-11-30, It's the same as IndexJoin | [here](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L571) |
| PhysicalApply | 2 | cost = uild-child-cost + build-filter-cost + probe-cost + probe-filter-cost | [here](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L579) |
| PhysicalUnionAll | 2 | cost = sum(child-cost) / concurrency | [here](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L609) |
| PhysicalExchangeReceiver | 2 | cost = child-cost + net-cost | [here](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L630) |
| PointGetPlan | 2 | cost = child-cost + net-cost | [here](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L652) |
| PointGetPlan | 2 | cost = child-cost + net-cost | [here](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L652) |
| BatchPointGetPlan | 2 | cost = seek-cost + net-cost | [here](https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L676) |


## Formula map of different factors 

| function name | name | factor name |
| - | - | - |
| TiDBTemp | tidb_temp_table_factor | 0 |
| TiKVScan:     | tikv_scan_factor | 100 |
| TiKVDescScan: | tikv_desc_scan_factor | 150 |
| TiFlashScan:  | tiflash_scan_factor | 5 |
| TiDBCPU:      | tidb_cpu_factor | 30 |
| TiKVCPU:      | tikv_cpu_factor | 30 |
| TiFlashCPU:   | tiflash_cpu_factor | 5 |
| TiDB2KVNet:   | tidb_kv_net_factor | 8 |
| TiDB2FlashNet:| tidb_flash_net_factor | 4 |
| TiFlashMPPNet:| tiflash_mpp_net_factor | 4 |
| TiDBMem:      | tidb_mem_factor | 1 |
| TiKVMem:      | tikv_mem_factor | 1 |
| TiFlashMem:   | tiflash_mem_factor | 1 |
| TiDBDisk:     | tidb_disk_factor | 1000 |
| TiDBRequest:  | tidb_request_factor | 9500000 |


## PhysicalSelection 

1. If row-size belongs to the type of PointGet, the row-size is 1. And row-size of BatchPointGet will come from stats.  
2. And filter-cost indicates cost of this step which uses to calculate and filter the result, which is `row-size * float64(len(filters)) * (tidb_cpu_factor or tikv_cpu_factor or TiFlashCPU)`. 

```
plan-cost =  child-cost + filter-cost(row-size * float64(len(filters)) * (tidb_cpu_factor or tikv_cpu_factor or TiFlashCPU)) 
```

## PhysicalProjection 

1. projection-concurrency can be modified by [tidb_executor_concurrency](https://docs.pingcap.com/zh/tidb/stable/system-variables#tidb_executor_concurrency-%E4%BB%8E-v50-%E7%89%88%E6%9C%AC%E5%BC%80%E5%A7%8B%E5%BC%95%E5%85%A5)    
2. proj-cost is equal to `row-size * len(expressions) * cpu-factor)`, which expressions is the number of column this step.

```
                 child-cost + row-size * len(expressions) * cpu-factor
plan-cost =   ]]></description>
            <content:encoded><![CDATA[<h2 id="first-of-all" tabindex="-1">First of all <a class="header-anchor" href="#first-of-all" aria-label="Permalink to &quot;First of all&quot;"></a></h2>
<p>first of all, in psysical period, <a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/optimizer.go#L624" target="_blank" rel="noreferrer">preparePossibleProperties</a> will get all possible order properties(column fields), which is only used for join and aggregation. Like group by a,b,c, into one slice from different level childs.</p>
<h2 id="how-to-calculate-physical-plan" tabindex="-1">How to calculate physical plan <a class="header-anchor" href="#how-to-calculate-physical-plan" aria-label="Permalink to &quot;How to calculate physical plan&quot;"></a></h2>
<ol>
<li><a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/optimizer.go#L269" target="_blank" rel="noreferrer">DoOptimize</a> is the core connection from logicalOptimize to physicalOptimize, which optimizes a logical plan to a physical plan.</li>
<li>Function findBestTask ,in <a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/optimizer.go#L619" target="_blank" rel="noreferrer">physicalOptimize</a>, will find out the best tasks from logical plan, and converts the logical plan to the physical plan, which's a new interface.</li>
<li>Until 2022-11-30 TiDB master branch, TiDB optizmizer gets plan cost in the order of <code>DoOptimize</code> -&gt; <code>getPlanCost</code> -&gt; <code>getPlanCostVer1/getPlanCostVer2</code>.Actually, the method <a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan.go#L337" target="_blank" rel="noreferrer">getPlanCostVer1/getPlanCostVer2</a> of interface PhysicalPlan is use get psysical every operand cost. I mean, by their different implentation, you could figure out how it's calculated.</li>
<li>In <a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L39" target="_blank" rel="noreferrer">here</a>, you'll get that It figures out child cost one by one.</li>
</ol>
<h2 id="why-go-plancostver1-to-plancostver2" tabindex="-1">Why go PlanCostVer1 to PlanCostVer2 <a class="header-anchor" href="#why-go-plancostver1-to-plancostver2" aria-label="Permalink to &quot;Why go PlanCostVer1 to PlanCostVer2&quot;"></a></h2>
<p>This <a href="https://github.com/pingcap/tidb/pull/35378" target="_blank" rel="noreferrer">PR</a> indeciates sometimes optimizer cannot discern which is the best datasource,  so a new cost formular for <code>Selection/TableScan/IndexScan</code> has been merged. which are here below:</p>
<ol>
<li>Selection : rows<em>num-filters</em>cpu-factor, which Tiflash has a specific cpu-factor</li>
<li>TableScan : rows*log(row-size)*scan-factor, which Tiflash has a specific cpu-factor</li>
<li>indexScan : rows*log(row-size)*scan-factor</li>
</ol>
<h2 id="formula-map-of-operand-cost" tabindex="-1">Formula map of operand cost <a class="header-anchor" href="#formula-map-of-operand-cost" aria-label="Permalink to &quot;Formula map of operand cost&quot;"></a></h2>
<ol>
<li>In the map below, you'll find a lot of factor and can get them on [Formula map of different factors](## Formula map of different factors ).</li>
</ol>
<table tabindex="0">
<thead>
<tr>
<th>TaskType</th>
<th>version</th>
<th>cost calculated expression</th>
<th>code addr</th>
</tr>
</thead>
<tbody>
<tr>
<td>PhysicalSelection</td>
<td>2</td>
<td>cost = child-cost + filter-cost</td>
<td><a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L62" target="_blank" rel="noreferrer">here</a></td>
</tr>
<tr>
<td>PhysicalProjection</td>
<td>2</td>
<td>cost = (child-cost + (proj-cost = rows * len(expressions) * cpu-factor)) / projection-concurrency</td>
<td><a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L85" target="_blank" rel="noreferrer">here</a></td>
</tr>
<tr>
<td>PhysicalIndexScan</td>
<td>2</td>
<td>cost = rows * log2(row-size) * scan-factor</td>
<td><a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L109" target="_blank" rel="noreferrer">here</a></td>
</tr>
<tr>
<td>PhysicalTableScan</td>
<td>2</td>
<td>cost = rows * log2(row-size) * scan-factor</td>
<td><a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L126" target="_blank" rel="noreferrer">here</a></td>
</tr>
<tr>
<td>PhysicalIndexReader</td>
<td>2</td>
<td>cost = (child-cost + net-cost + seek-cost) / concurrency</td>
<td><a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L150" target="_blank" rel="noreferrer">here</a></td>
</tr>
<tr>
<td>PhysicalTableReader</td>
<td>2</td>
<td>cost = (child-cost + (rows * row-size * net-factor) + (num-tasks * seek-factor)) / concurrency</td>
<td><a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L178" target="_blank" rel="noreferrer">here</a></td>
</tr>
<tr>
<td>PhysicalIndexLookUpReader</td>
<td>2</td>
<td>cost = index-side-cost + (table-side-cost + double-read-cost) / double-read-concurrency</td>
<td><a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L217" target="_blank" rel="noreferrer">here</a></td>
</tr>
<tr>
<td>PhysicalIndexMergeReader</td>
<td>2</td>
<td>cost = cost = table-side-cost + sum(index-side-cost)</td>
<td><a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L269" target="_blank" rel="noreferrer">here</a></td>
</tr>
<tr>
<td>PhysicalSort</td>
<td>2</td>
<td>cost = child-cost + sort-cpu-cost + sort-mem-cost + sort-disk-cost</td>
<td><a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L322" target="_blank" rel="noreferrer">here</a></td>
</tr>
<tr>
<td>PhysicalTopN</td>
<td>2</td>
<td>cost = child-cost + topn-cpu-cost + topn-mem-cost</td>
<td><a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L372" target="_blank" rel="noreferrer">here</a></td>
</tr>
<tr>
<td>PhysicalStreamAgg</td>
<td>2</td>
<td>cost = child-cost + agg-cost + group-cost</td>
<td><a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L402" target="_blank" rel="noreferrer">here</a></td>
</tr>
<tr>
<td>PhysicalHashAgg</td>
<td>2</td>
<td>child-cost + (agg-cost + group-cost + hash-build-cost + hash-probe-cost) / concurrency</td>
<td><a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L425" target="_blank" rel="noreferrer">here</a></td>
</tr>
<tr>
<td>PhysicalMergeJoin</td>
<td>2</td>
<td>cost = left-child-cost + right-child-cost + filter-cost + group-cost</td>
<td></td>
</tr>
<tr>
<td>PhysicalHashJoin</td>
<td>2</td>
<td>cost = build-child-cost + probe-child-cost + build-hash-cost + build-filter-cost + (probe-filter-cost + probe-hash-cost) / concurrency</td>
<td><a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L486" target="_blank" rel="noreferrer">here</a></td>
</tr>
<tr>
<td>PhysicalIndexJoin</td>
<td>2</td>
<td>cost = build-child-cost + build-filter-cost + (probe-cost + probe-filter-cost) / concurrency probe-cost = probe-child-cost * build-rows / batchRatio</td>
<td><a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L530" target="_blank" rel="noreferrer">here</a></td>
</tr>
<tr>
<td>PhysicalIndexHashJoin</td>
<td>2</td>
<td>until 2022-11-30, It's the same as PhysicalIndexJoin</td>
<td><a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L566" target="_blank" rel="noreferrer">here</a></td>
</tr>
<tr>
<td>PhysicalIndexMergeJoin</td>
<td>2</td>
<td>until 2022-11-30, It's the same as IndexJoin</td>
<td><a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L571" target="_blank" rel="noreferrer">here</a></td>
</tr>
<tr>
<td>PhysicalApply</td>
<td>2</td>
<td>cost = uild-child-cost + build-filter-cost + probe-cost + probe-filter-cost</td>
<td><a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L579" target="_blank" rel="noreferrer">here</a></td>
</tr>
<tr>
<td>PhysicalUnionAll</td>
<td>2</td>
<td>cost = sum(child-cost) / concurrency</td>
<td><a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L609" target="_blank" rel="noreferrer">here</a></td>
</tr>
<tr>
<td>PhysicalExchangeReceiver</td>
<td>2</td>
<td>cost = child-cost + net-cost</td>
<td><a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L630" target="_blank" rel="noreferrer">here</a></td>
</tr>
<tr>
<td>PointGetPlan</td>
<td>2</td>
<td>cost = child-cost + net-cost</td>
<td><a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L652" target="_blank" rel="noreferrer">here</a></td>
</tr>
<tr>
<td>PointGetPlan</td>
<td>2</td>
<td>cost = child-cost + net-cost</td>
<td><a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L652" target="_blank" rel="noreferrer">here</a></td>
</tr>
<tr>
<td>BatchPointGetPlan</td>
<td>2</td>
<td>cost = seek-cost + net-cost</td>
<td><a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/planner/core/plan_cost_ver2.go#L676" target="_blank" rel="noreferrer">here</a></td>
</tr>
</tbody>
</table>
<h2 id="formula-map-of-different-factors" tabindex="-1">Formula map of different factors <a class="header-anchor" href="#formula-map-of-different-factors" aria-label="Permalink to &quot;Formula map of different factors&quot;"></a></h2>
<table tabindex="0">
<thead>
<tr>
<th>function name</th>
<th>name</th>
<th>factor name</th>
</tr>
</thead>
<tbody>
<tr>
<td>TiDBTemp</td>
<td>tidb_temp_table_factor</td>
<td>0</td>
</tr>
<tr>
<td>TiKVScan:</td>
<td>tikv_scan_factor</td>
<td>100</td>
</tr>
<tr>
<td>TiKVDescScan:</td>
<td>tikv_desc_scan_factor</td>
<td>150</td>
</tr>
<tr>
<td>TiFlashScan:</td>
<td>tiflash_scan_factor</td>
<td>5</td>
</tr>
<tr>
<td>TiDBCPU:</td>
<td>tidb_cpu_factor</td>
<td>30</td>
</tr>
<tr>
<td>TiKVCPU:</td>
<td>tikv_cpu_factor</td>
<td>30</td>
</tr>
<tr>
<td>TiFlashCPU:</td>
<td>tiflash_cpu_factor</td>
<td>5</td>
</tr>
<tr>
<td>TiDB2KVNet:</td>
<td>tidb_kv_net_factor</td>
<td>8</td>
</tr>
<tr>
<td>TiDB2FlashNet:</td>
<td>tidb_flash_net_factor</td>
<td>4</td>
</tr>
<tr>
<td>TiFlashMPPNet:</td>
<td>tiflash_mpp_net_factor</td>
<td>4</td>
</tr>
<tr>
<td>TiDBMem:</td>
<td>tidb_mem_factor</td>
<td>1</td>
</tr>
<tr>
<td>TiKVMem:</td>
<td>tikv_mem_factor</td>
<td>1</td>
</tr>
<tr>
<td>TiFlashMem:</td>
<td>tiflash_mem_factor</td>
<td>1</td>
</tr>
<tr>
<td>TiDBDisk:</td>
<td>tidb_disk_factor</td>
<td>1000</td>
</tr>
<tr>
<td>TiDBRequest:</td>
<td>tidb_request_factor</td>
<td>9500000</td>
</tr>
</tbody>
</table>
<h2 id="physicalselection" tabindex="-1">PhysicalSelection <a class="header-anchor" href="#physicalselection" aria-label="Permalink to &quot;PhysicalSelection&quot;"></a></h2>
<ol>
<li>If row-size belongs to the type of PointGet, the row-size is 1. And row-size of BatchPointGet will come from stats.</li>
<li>And filter-cost indicates cost of this step which uses to calculate and filter the result, which is <code>row-size * float64(len(filters)) * (tidb_cpu_factor or tikv_cpu_factor or TiFlashCPU)</code>.</li>
</ol>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>plan-cost =  child-cost + filter-cost(row-size * float64(len(filters)) * (tidb_cpu_factor or tikv_cpu_factor or TiFlashCPU))</span></span></code></pre>
</div><h2 id="physicalprojection" tabindex="-1">PhysicalProjection <a class="header-anchor" href="#physicalprojection" aria-label="Permalink to &quot;PhysicalProjection&quot;"></a></h2>
<ol>
<li>projection-concurrency can be modified by <a href="https://docs.pingcap.com/zh/tidb/stable/system-variables#tidb_executor_concurrency-%E4%BB%8E-v50-%E7%89%88%E6%9C%AC%E5%BC%80%E5%A7%8B%E5%BC%95%E5%85%A5" target="_blank" rel="noreferrer">tidb_executor_concurrency</a></li>
<li>proj-cost is equal to <code>row-size * len(expressions) * cpu-factor)</code>, which expressions is the number of column this step.</li>
</ol>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>                 child-cost + row-size * len(expressions) * cpu-factor</span></span>
<span class="line"><span>plan-cost =   ------------------------------------------------------------</span></span>
<span class="line"><span>                          projection-concurrency</span></span></code></pre>
</div><h2 id="physicalindexscan" tabindex="-1">PhysicalIndexScan <a class="header-anchor" href="#physicalindexscan" aria-label="Permalink to &quot;PhysicalIndexScan&quot;"></a></h2>
<ol>
<li>rowSize(row-size) = AvgRowSize + [tablePrefix(1) + tableID(8) + indexPrefix(2) + indexID(8)] = AvgRowSize + 19.</li>
<li>BTW, the calculation of <code>AvgRowSize</code> is really complicated. if you wanna figure out how the result value is computed, please explore the code logic. And,<a href="https://github.com/pingcap/tidb/blob/17fac8bc2883dd287481a60f019beae948191a47/statistics/table.go#L1289" target="_blank" rel="noreferrer">here</a> are the code addr.</li>
</ol>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>cost = rows * log2(row-size) * scan-factor</span></span></code></pre>
</div><h2 id="physicaltablescan" tabindex="-1">PhysicalTableScan <a class="header-anchor" href="#physicaltablescan" aria-label="Permalink to &quot;PhysicalTableScan&quot;"></a></h2>
<ol>
<li>rows is the Cardinality generated by stats;</li>
<li>The expression is equal to PhysicalIndexScan.</li>
</ol>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>cost = rows * log2(row-size) * scan-factor</span></span></code></pre>
</div><h2 id="physicalindexreader" tabindex="-1">PhysicalIndexReader <a class="header-anchor" href="#physicalindexreader" aria-label="Permalink to &quot;PhysicalIndexReader&quot;"></a></h2>
<ol>
<li>Actually, the concurrency of this step is distSQLScanConcurrency(default 15) in system varliable, and can be changed by <a href="https://docs.pingcap.com/zh/tidb/dev/system-variables#tidb_distsql_scan_concurrency" target="_blank" rel="noreferrer">tidb_distsql_scan_concurrency</a>.</li>
</ol>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>           child-cost + rows * row-size * net-factor + num-tasks * seek-factor</span></span>
<span class="line"><span>cost =  -------------------------------------------------------------------------</span></span>
<span class="line"><span>                          tidb_distsql_scan_concurrency</span></span></code></pre>
</div><h2 id="physicaltablereader" tabindex="-1">PhysicalTableReader <a class="header-anchor" href="#physicaltablereader" aria-label="Permalink to &quot;PhysicalTableReader&quot;"></a></h2>
<ol>
<li>equal to PhysicalIndexReader</li>
</ol>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>           child-cost + rows * row-size * net-factor + num-tasks * seek-factor</span></span>
<span class="line"><span>cost =  -------------------------------------------------------------------------</span></span>
<span class="line"><span>                          tidb_distsql_scan_concurrency</span></span></code></pre>
</div><h2 id="physicalindexlookupreader" tabindex="-1">PhysicalIndexLookUpReader <a class="header-anchor" href="#physicalindexlookupreader" aria-label="Permalink to &quot;PhysicalIndexLookUpReader&quot;"></a></h2>
<ol>
<li>How to change the concurrency is <a href="https://docs.pingcap.com/zh/tidb/dev/system-variables#tidb_executor_concurrency-%E4%BB%8E-v50-%E7%89%88%E6%9C%AC%E5%BC%80%E5%A7%8B%E5%BC%95%E5%85%A5" target="_blank" rel="noreferrer">tidb_index_lookup_concurrency</a> and now which named tidb_executor_concurrency.</li>
<li>index-side-cost = (index-child-cost + index-net-cost + index-seek-cost) / dist-concurrency, which is same with IndexReader</li>
<li>table-side-cost = (table-child-cost + table-net-cost + table-seek-cost) / dist-concurrency, which is same with TableReader</li>
<li>double-read-cost = double-read-seek-cost + double-read-cpu-cost</li>
<li>double-read-seek-cost = double-read-tasks * seek-factor</li>
<li>double-read-cpu-cost = index-rows * cpu-factor</li>
<li>double-read-tasks = index-rows / batch-size * task-per-batch ,and task-per-batch is a magic number 40 now</li>
</ol>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>                   (index-child-cost + index-net-cost + index-seek-cost) +                          -> index-side-cost</span></span>
<span class="line"><span>                    (table-child-cost + table-net-cost + table-seek-cost +                          -> table-side-cost</span></span>
<span class="line"><span>          ((index-rows / batch-size * task-per-batch(40)) * seek-factor + index-rows * cpu-factor)) -> double-read-cost</span></span>
<span class="line"><span>          -----------------------------------------------------------------------------------------</span></span>
<span class="line"><span>cost =                               dist-concurrency</span></span>
<span class="line"><span>      -------------------------------------------------------------------------------------------------</span></span>
<span class="line"><span>                                  double-read-concurrency</span></span></code></pre>
</div><h2 id="physicalindexmergereader" tabindex="-1">PhysicalIndexMergeReader <a class="header-anchor" href="#physicalindexmergereader" aria-label="Permalink to &quot;PhysicalIndexMergeReader&quot;"></a></h2>
<ol>
<li>The cost is made up of index-side-cost and table-side-cost, and the formar's equal to IndexReader, and the latter's the same as TableReader.</li>
<li></li>
</ol>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>          (table-child-cost + table-net-cost + table-seek-cost) + (index-child-cost + index-net-cost + index-seek-cost)</span></span>
<span class="line"><span>cost =  ----------------------------------------------------------------------------------------------------------------</span></span>
<span class="line"><span>                                                dist-concurrency</span></span></code></pre>
</div><h2 id="physicalsort" tabindex="-1">PhysicalSort <a class="header-anchor" href="#physicalsort" aria-label="Permalink to &quot;PhysicalSort&quot;"></a></h2>
<ol>
<li>cost = child-cost + sort-cpu-cost + sort-mem-cost + sort-disk-cost</li>
<li>The Spill means that you're just going to have to use oomUseTmpStorage to save enough TiDB memor, When sort action happens.<br>
a. if no spill, <code>sort-mem-cost</code> will be <code>rows * row-size * mem-factor</code> and, <code>sort-disk-cost</code> is 0;<br>
b. if spill, <code>sort-mem-cost is</code> <code>mem-quota * mem-factor</code> and, <code>sort-disk-cost</code> is <code>rows * row-size * disk-factor</code>;</li>
<li>So, It's clear that when spill happend, <code>sort-mem-cost</code> and <code>sort-disk-cost</code> will change in an appropriate way.</li>
</ol>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>cost = child-cost + (rows * log2(rows) * len(sort-items) * cpu-factor) + sort-mem-cost + sort-disk-cost</span></span></code></pre>
</div><h2 id="physicaltopn" tabindex="-1">PhysicalTopN <a class="header-anchor" href="#physicaltopn" aria-label="Permalink to &quot;PhysicalTopN&quot;"></a></h2>
<ol>
<li>child-cost + topn-cpu-cost + topn-mem-cost</li>
</ol>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>cost = child-cost + (rows * log2(N) * len(sort-items) * cpu-factor) + (N * row-size * mem-factor)</span></span></code></pre>
</div><h2 id="physicalstreamagg" tabindex="-1">PhysicalStreamAgg <a class="header-anchor" href="#physicalstreamagg" aria-label="Permalink to &quot;PhysicalStreamAgg&quot;"></a></h2>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>cost = child-cost + agg-cost + group-cost</span></span></code></pre>
</div><h2 id="physicalhashagg" tabindex="-1">PhysicalHashAgg <a class="header-anchor" href="#physicalhashagg" aria-label="Permalink to &quot;PhysicalHashAgg&quot;"></a></h2>
<ol>
<li>Default value of <a href="https://docs.pingcap.com/zh/tidb/dev/system-variables#tidb_opt_concurrency_factor" target="_blank" rel="noreferrer">tidb_opt_concurrency_factor</a> is 5.</li>
</ol>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>           child-cost + (agg-cost + group-cost + hash-build-cost + hash-probe-cost)</span></span>
<span class="line"><span>cost =    --------------------------------------------------------------------------------</span></span>
<span class="line"><span>                                tidb_opt_concurrency_factor</span></span></code></pre>
</div><h2 id="physicalmergejoin" tabindex="-1">PhysicalMergeJoin <a class="header-anchor" href="#physicalmergejoin" aria-label="Permalink to &quot;PhysicalMergeJoin&quot;"></a></h2>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>cost = left-child-cost + right-child-cost + filter-cost + group-cost</span></span></code></pre>
</div><h2 id="physicalhashjoin" tabindex="-1">PhysicalHashJoin <a class="header-anchor" href="#physicalhashjoin" aria-label="Permalink to &quot;PhysicalHashJoin&quot;"></a></h2>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>            build-child-cost + probe-child-cost + build-hash-cost + </span></span>
<span class="line"><span>cost =  build-filter-cost + (probe-filter-cost + probe-hash-cost) / concurrency</span></span></code></pre>
</div><h2 id="physicalindexjoin-physicalindexhashjoin-physicalindexmergejoin" tabindex="-1">PhysicalIndexJoin &amp; PhysicalIndexHashJoin &amp; PhysicalIndexMergeJoin <a class="header-anchor" href="#physicalindexjoin-physicalindexhashjoin-physicalindexmergejoin" aria-label="Permalink to &quot;PhysicalIndexJoin &amp; PhysicalIndexHashJoin &amp; PhysicalIndexMergeJoin&quot;"></a></h2>
<ol>
<li>They are equal to IndexJoin.</li>
</ol>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>cost =  build-child-cost + build-filter-cost +                                     </span></span>
<span class="line"><span>       (probe-child-cost * build-rows / batchRatio + probe-filter-cost) / concurrency</span></span></code></pre>
</div><h2 id="physicalapply" tabindex="-1">PhysicalApply <a class="header-anchor" href="#physicalapply" aria-label="Permalink to &quot;PhysicalApply&quot;"></a></h2>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>cost = build-child-cost + build-filter-cost + probe-child-cost * build-rows + probe-filter-cost</span></span></code></pre>
</div><h2 id="physicalunionall" tabindex="-1">PhysicalUnionAll <a class="header-anchor" href="#physicalunionall" aria-label="Permalink to &quot;PhysicalUnionAll&quot;"></a></h2>
<ol>
<li><a href="https://docs.pingcap.com/zh/tidb/dev/system-variables#tidb_opt_concurrency_factor" target="_blank" rel="noreferrer">tidb_opt_concurrency_factor</a> is the denominator below.</li>
</ol>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>cost = sum(child-cost) / concurrency</span></span></code></pre>
</div><h2 id="physicalexchangereceiver-pointgetplan-pointgetplan-batchpointgetplan" tabindex="-1">PhysicalExchangeReceiver &amp; PointGetPlan &amp; PointGetPlan &amp; BatchPointGetPlan <a class="header-anchor" href="#physicalexchangereceiver-pointgetplan-pointgetplan-batchpointgetplan" aria-label="Permalink to &quot;PhysicalExchangeReceiver &amp; PointGetPlan &amp; PointGetPlan &amp; BatchPointGetPlan&quot;"></a></h2>
<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span>cost = child-cost + net-cost</span></span></code></pre>
</div>]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[ÊàëÁöÑ TiDB Á¨îËÆ∞ÁÆÄ‰ªã]]></title>
            <link>https://askaric.com/zh/work/tidb/</link>
            <guid>https://askaric.com/zh/work/tidb/</guid>
            <pubDate>Sun, 29 Jun 2025 01:26:12 GMT</pubDate>
            <description><![CDATA[01TiDB-ÂéüÁêÜÊÄªÁªì
 02TIDB-ÈÉ®ÁΩ≤ÂÆûË∑µ
 03TiDB-ËøêÁª¥ÁÆ°ÁêÜ
 04TiDB-Ë∞É‰ºòÂÆûË∑µ
 05TiDB-ÁîüÊÄÅÂ∑•ÂÖ∑
 06TiDB-Ëß£ÂÜ≥ÊñπÊ°à
 07TiDB-Ê∫êÁ†ÅÈòÖËØª
 08TiDB-Cl]]></description>
            <content:encoded><![CDATA[<h1 id="ÊàëÁöÑ-tidb-Á¨îËÆ∞ÁÆÄ‰ªã" tabindex="-1">ÊàëÁöÑ TiDB Á¨îËÆ∞ÁÆÄ‰ªã <a class="header-anchor" href="#ÊàëÁöÑ-tidb-Á¨îËÆ∞ÁÆÄ‰ªã" aria-label="Permalink to &quot;ÊàëÁöÑ TiDB Á¨îËÆ∞ÁÆÄ‰ªã&quot;"></a></h1>
<h2 id="_01tidb-ÂéüÁêÜÊÄªÁªì" tabindex="-1">01TiDB-ÂéüÁêÜÊÄªÁªì <a class="header-anchor" href="#_01tidb-ÂéüÁêÜÊÄªÁªì" aria-label="Permalink to &quot;01TiDB-ÂéüÁêÜÊÄªÁªì&quot;"></a></h2>
<h2 id="_02tidb-ÈÉ®ÁΩ≤ÂÆûË∑µ" tabindex="-1">02TIDB-ÈÉ®ÁΩ≤ÂÆûË∑µ <a class="header-anchor" href="#_02tidb-ÈÉ®ÁΩ≤ÂÆûË∑µ" aria-label="Permalink to &quot;02TIDB-ÈÉ®ÁΩ≤ÂÆûË∑µ&quot;"></a></h2>
<h2 id="_03tidb-ËøêÁª¥ÁÆ°ÁêÜ" tabindex="-1">03TiDB-ËøêÁª¥ÁÆ°ÁêÜ <a class="header-anchor" href="#_03tidb-ËøêÁª¥ÁÆ°ÁêÜ" aria-label="Permalink to &quot;03TiDB-ËøêÁª¥ÁÆ°ÁêÜ&quot;"></a></h2>
<h2 id="_04tidb-Ë∞É‰ºòÂÆûË∑µ" tabindex="-1">04TiDB-Ë∞É‰ºòÂÆûË∑µ <a class="header-anchor" href="#_04tidb-Ë∞É‰ºòÂÆûË∑µ" aria-label="Permalink to &quot;04TiDB-Ë∞É‰ºòÂÆûË∑µ&quot;"></a></h2>
<h2 id="_05tidb-ÁîüÊÄÅÂ∑•ÂÖ∑" tabindex="-1">05TiDB-ÁîüÊÄÅÂ∑•ÂÖ∑ <a class="header-anchor" href="#_05tidb-ÁîüÊÄÅÂ∑•ÂÖ∑" aria-label="Permalink to &quot;05TiDB-ÁîüÊÄÅÂ∑•ÂÖ∑&quot;"></a></h2>
<h2 id="_06tidb-Ëß£ÂÜ≥ÊñπÊ°à" tabindex="-1">06TiDB-Ëß£ÂÜ≥ÊñπÊ°à <a class="header-anchor" href="#_06tidb-Ëß£ÂÜ≥ÊñπÊ°à" aria-label="Permalink to &quot;06TiDB-Ëß£ÂÜ≥ÊñπÊ°à&quot;"></a></h2>
<h2 id="_07tidb-Ê∫êÁ†ÅÈòÖËØª" tabindex="-1">07TiDB-Ê∫êÁ†ÅÈòÖËØª <a class="header-anchor" href="#_07tidb-Ê∫êÁ†ÅÈòÖËØª" aria-label="Permalink to &quot;07TiDB-Ê∫êÁ†ÅÈòÖËØª&quot;"></a></h2>
<h2 id="_08tidb-cloud-k8s" tabindex="-1">08TiDB-Cloud-K8S <a class="header-anchor" href="#_08tidb-cloud-k8s" aria-label="Permalink to &quot;08TiDB-Cloud-K8S&quot;"></a></h2>
<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0" v-pre=""><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan@Jan-M1-Pro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> pod</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> tidb-cluster</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                     READY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   STATUS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">      RESTARTS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   AGE</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">basic-discovery-5db6c75657-h4c2p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">         1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">          14d</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">basic-monitor-0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                          4/4</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">          14d</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">basic-pd-0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                               1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">          14d</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">basic-ticdc-0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                            1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">          60m</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">basic-ticdc-1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                            1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">          60m</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">basic-tidb-0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                             2/2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">          14d</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">basic-tikv-0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                             1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">          14d</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan-dm-dm-discovery-5c84866d6c-cwcx6</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">          14d</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan-dm-dm-master-0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                       1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">          14d</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan-dm-dm-worker-0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                       1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">          14d</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">jan-lightning-tidb-lightning-7ssfc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">       0/1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     Completed</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">   0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">          23h</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ticdc-to-mysql-deploy-85d5d498bc-wwcvb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">   1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">          67m</span></span></code></pre>
</div>]]></content:encoded>
        </item>
    </channel>
</rss>